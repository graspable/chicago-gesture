!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.gmath=e():t.gmath=e()}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="https://graspablemath.com/shared/libs/gmath-dist/",n(n.s=382)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.gmath={expressions:{},ui:{}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Node=e.Tree=void 0;var i=n(381);Object.defineProperty(i.Tree.Node.prototype,"_stringify",{get:function(){return this.stringify()}}),Object.defineProperty(i.Tree.Node.prototype,"_to_ascii",{get:function(){return this.to_ascii()}}),e.Tree=i.Tree,e.Node=i.Node},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Action=l;var i=n(0),r=n(7),o=n(1),s=n(10),a=n(380);function l(t,e){this.name=t,this.description=e,this.id=i.gmath.uid(),this.priority=0,this.node_map={},this.initial_node_map={},this.touched_nodes={},this.new_selection=null,this.timeoutID=null,this.settings={},this.is_inner_action}i.gmath.actions={},i.gmath.Action=l,l.prototype.toJSON=function(){var t={id:this.id,name:this.name,type:"Action",priority:this.priority,oldTree:this.oldTree.id,newTree:this.newTree.id,triggerType:this.triggerType,settings:this.settings};if(this.nodes&&(this.source_am&&(t.source_am=this.source_am.id),t.nodes=this.nodes[0].get_root().getSelectorOfNodes(this.nodes)),this.target)if("RelationOfAbsValAction"===this.name||"AddSubResolveCasesAction"===this.name)t.target=this.target.id;else{var e=Array.isArray(this.target)?this.target[0].get_root():this.target.get_root();t.target=e.getSelectorOfNodes(this.target),Array.isArray(this.target)&&1===this.target.length&&(t.target_is_array=!0)}return this.actor&&(t.actor=this.actor.get_root().getSelectorOfNodes(this.actor)),t},l.fromJSON=function(t,e){if(t.id in e)return e[t.id];var n=new i.gmath.actions[t.name].constructor;for(var r in t)n[r]=t[r];return n.oldTree&&(n.oldTree=e[n.oldTree]),n.newTree&&(n.newTree=e[n.newTree]),n.source_am&&(n.source_am=e[n.source_am]),n.nodes&&(n.nodes=(n.source_am?n.source_am:n.oldTree).getNodesFromSelector(n.nodes)),n.actor&&(n.actor=n.oldTree.getNodesFromSelector(n.actor)[0]),n.target&&("RelationOfAbsValAction"===n.name||"AddSubResolveCasesAction"===n.name?n.target=e[n.target]:(n.target=n.oldTree.getNodesFromSelector(n.target),n.target_is_array||1!==n.target.length||(n.target=n.target[0]))),n},l.prototype.printMap=function(t){for(var e in t&&console.log(t),this.node_map){var n=this.oldTree.get_by_id(e);console.log(n?n.to_ascii():"?","==>",this.node_map[e].map(function(t){return t.to_ascii()}).join(", "))}},l.prototype.printLeafNodePositions=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t&&console.log(t),e&&this.oldTree&&this.oldTree.printLeafNodePositions("old"),n&&this.newTree&&this.newTree.printLeafNodePositions("new")},l.prototype.printForEachLeafNode=function(t,e,n){e.get_leaf_nodes().forEach(function(e){console.log(t,e.to_ascii(),":",n.call(this,e))},this)},l.prototype.createBoundAction=function(t,e){var n=new this.constructor(e);return e.is_inner_action&&(n.is_inner_action=!0),n.oldTree=t,n.newTree=t,n},l.prototype.bindActionForEachTarget=function(t,e,n){var i=this,r=t[0].get_root();if(n){for(var o=[],s=0;s<e.length;s++){var a=e[s];0!==s&&e[s-1].rs===a||o.push(this.createBoundAction(r,{nodes:t,target:a,side:"left-of"})),o.push(this.createBoundAction(r,{nodes:t,target:a,side:"right-of"}))}return o}return e.map(function(e){return i.createBoundAction(r,{nodes:t,target:e,side:null})})},l.prototype.initSettings=function(t){t&&(this.setActorAndTarget(t),this.setSide(t.side),"drag"===this.triggerType&&(this.setDropArea(t.drop_area),this.setDropAreaHint(t.drop_area_hint),this.setDestinationHints(t.destination_hint)))},l.prototype.setActorAndTarget=function(t){var e=t.nodes,n=t.target,i=t.actor;e?(this.triggerType="drag",this.nodes=e,this.target=n):this.actor=i},l.prototype.setSide=function(t){t&&(this.settings.side=t)},l.prototype.setDropArea=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.node,n=t.side,i=t.margin,r=t.offset;this.drop_area||(this.drop_area={}),this.drop_area.node=e||this.target,this.drop_area.side=n||this.settings&&this.settings.side||"around",this.drop_area.margin=i||this.settings.margin,this.drop_area.offset=r||this.settings.offset},l.prototype.getDropArea=function(){return this.drop_area?this.drop_area:{node:this.target,side:this.settings.side,margin:this.settings.margin,offset:this.settings.offset}},l.prototype.setDropAreaHint=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.node,n=t.side,i=t.margin,r=t.offset,o=t.hidden;this.drop_area_hint||(this.drop_area_hint={}),this.drop_area_hint.side=n||this.drop_area.side,e||(e=Array.isArray(this.drop_area.node)||!this.drop_area.node.is_group("addsub","add","sub","mul","div")||"around"!==this.drop_area_hint.side&&"inside"!==this.drop_area_hint.side?this.drop_area.node:this.drop_area.node.children[1]),this.drop_area_hint.node=e,this.drop_area_hint.margin=i,this.drop_area_hint.offset=r,this.drop_area_hint.hidden=o},l.prototype.setDestinationHints=function(t){var e=this;this.destination_hints||(this.destination_hints=[]),t&&Array.isArray(t)?t.forEach(this.addDestinationHint.bind(this)):t&&t.nodes?t.nodes.forEach(function(n){return e.addDestinationHint({node:n,side:t.side,margin:t.margin,offset:t.offset})}):this.addDestinationHint(t)},l.prototype.addDestinationHint=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.node,n=t.side,i=t.margin,r=t.offset;e||(e=Array.isArray(this.target)||!this.target.is_group("addsub","add","sub","mul","div")||"around"!==this.settings.side&&"inside"!==this.settings.side?this.target:this.target.children[1]),n||(n="left-inside"===this.settings.side?"left-of":"right-inside"===this.settings.side?"right-of":this.settings.side),r||(r=this.settings.offset),this.destination_hints.push({node:e,side:n,margin:i,offset:r})},l.prototype.getSourceAndTarget=function(t){return"drag"===this.triggerType?{source:t?this.nodes:this.nodes[0],target:this.target}:{source:t?[this.actor]:this.actor,target:this.actor.ls||this.actor.rs}},l.prototype.rebind=function(t,e,n){if(this.oldTree!==n)throw"wrong old tree during rebinding an action!";var i=new l;i.node_map=e,this.oldTree=t,this.nodes&&(this.nodes=i.mapNodes(this.nodes)),this.target&&(this.target=Array.isArray(this.target)?[i.mapNodes(this.target)[0]]:i.mapNodes(this.target)[0]),this.actor&&(this.actor=i.mapNodes(this.actor)[0])},l.prototype.createAndRun=function(t,e,n){var i=new this.constructor(e);return i.oldTree=t,i.run(n),i},l.prototype.createAndDoInPlace=function(t,e,n){var i=new this.constructor(e);return e.is_inner_action&&(i.is_inner_action=!0),i.oldTree=t,i.newTree=t,i.doInPlace(n),i},l.prototype.getInverseNodeMap=function(){var t=this,e={};return this.newTree.select_all().forEach(function(n){return e[n.id]=Object.keys(t.node_map).filter(function(e){return t.node_map[e].find(function(t){return t===n})}).map(function(e){return t.oldTree.get_by_id(e)})}),e},l.prototype.initNodeMap=function(){this.is_inner_action||(this.initial_node_map=this.oldTree.children[0].get_mapping_to(this.newTree.children[0])),this.node_map=this.oldTree.children[0].get_mapping_to(this.newTree.children[0])},l.prototype.removeDeletedNodesFromNodeMap=function(){if(this.oldTree!==this.newTree){var t=this.newTree.select_all(),e=function(e){return-1!==t.indexOf(e)};for(var n in this.node_map)this.node_map[n]=this.node_map[n].filter(e)}},l.prototype.updateNodeMap=function(t,e){if(1===arguments.length)i.gmath.extend(this.node_map,t);else{var n=t;if(Array.isArray(n))for(var r=0;r<n.length;r++)this.node_map[n[r].id]=Array.isArray(e)?e:[e];else this.node_map[n.id]=Array.isArray(e)?e:[e]}},l.pushNew=function(t,e){for(var n=0;n<e.length;n++)-1===t.indexOf(e[n])?t.push(e[n]):(t.splice(t.indexOf(e[n]),1),t.push(e[n]))},l.prototype.extendNodeMap=function(t,e){if(2!==arguments.length){var n=t;for(var i in n)n.hasOwnProperty(i)&&(i in this.node_map?l.pushNew(this.node_map[i],n[i]):this.node_map[i]=n[i])}else{var r=t,o=Array.isArray(e)?e:[e];r.id in this.node_map?l.pushNew(this.node_map[r.id],o):this.node_map[r.id]=o}},l.prototype.getNewTreeNode=function(t){return this.is_inner_action?t:this.getCorrespondingNodeFromTree(t,this.newTree)},l.prototype.getOldTreeNode=function(t){return this.is_inner_action?t:this.getCorrespondingNodeFromTree(t,this.oldTree)},l.prototype.getCorrespondingNodeFromTree=function(t,e){var n=function(t){return t.get_root()===e?t:e.get_child(t.get_path())};return Array.isArray(t)?t.map(n):n(t)},l.prototype.getTargetsForHighlighting=function(){return[]},l.prototype.addTouchedNodes=function(t){var e=this;o.Tree.for_each(function(t){e.touched_nodes[t.id]=!0},t)},l.prototype.getOrInferTriggerType=function(){return this.triggerType?this.triggerType:this.actor?"tap":this.nodes?"drag":"unknown"},l.prototype.setNodesToReselectAfterAction=function(t){Array.isArray(t)?this.new_selection=t.slice():this.new_selection=[t]},l.cleanupInPlace=function(t){if(!t.cleanupAction)return!1;if(!t.cleanupAction.match(t))return!1;for(var e=t;e.parent&&"AlgebraModel"!==e.type;)e=e.parent;t.cleanupAction.createAndDoInPlace(e,{actor:t})},l.prototype.cleanup=function(t){if(!t.cleanupAction)return!1;if(!t.cleanupAction.match(t))return!1;var e=t.cleanupAction.createAndDoInPlace(this.newTree,{actor:t,is_inner_action:!0});return this.compose(e,!1),e},l.prototype.cleanup_cascade=function(t){for(var e=!1;;){var n=this.cleanup(t);if(!n)return e;e=!0;var i=n.mapNodes(t);if(0===i.length)return e;t=i[0].parent}},l.prototype.applyInnerAction=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=e.tree||e.actor||e.nodes[0].get_root(),a=s;if("AlgebraModel"!==s.type){var l=new o.Tree.Node;l.children=[s],l.type="AlgebraModel"}var u=(0,r.extend)({is_inner_action:!0},e);delete u.tree;var c=i.gmath.actions[t].createBoundAction(a,u);return!(n&&!c.rematch()||(c.doInPlace(),this.compose(c),0))},l.prototype.compose=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(var n in this.node_map){var i=this.node_map[n];this.node_map[n]=t.mapNodes(i);var r=i.filter(function(e){return!t.node_map[e.id]});if(r.length>0&&e&&!t.is_inner_action)throw"Second mapping does not mention all nodes from first mapping.";this.node_map[n]=this.node_map[n].concat(r),t.touched_nodes[n]&&(this.touched_nodes[n]=!0)}this.new_selection&&this.new_selection.some(function(e){return e.id in t.node_map})&&(this.new_selection=t.mapNodes(this.new_selection)),t.is_inner_action||(this.newTree=t.newTree)},l.prototype.run=function(t){return this.newTree=this.oldTree.clone(),this.doInPlace(t)},l.prototype.match=function(){throw"called abstract method Action.match()"},l.prototype.rematch=function(){return this.actor?this.match(this.actor):!(!this.nodes||0===this.nodes.length||!this.target||Array.isArray(this.target)&&0===this.target.length)&&(this.getAllAvailableActions?this.getAllAvailableActions(this.nodes).some(function(t){return Array.isArray(t.target)?i.gmath.array.equals(t.target,this.target):t.target===this.target},this):void 0)},l.prototype.transform=function(t){throw"called abstract method Action.transform()"},l.prototype.doInPlace=function(t){var e,n=this;try{this.initNodeMap(),e=this.transform(function(e){if(n.removeDeletedNodesFromNodeMap(),t){var i=(0,a.checkUndefinedTransformation)(n.oldTree,n.newTree);i&&(n.settings.makes_no_changes=!0),t(!i&&e)}})}catch(n){if(s.dont_catch_exceptions)throw n;console.warn("An error occurred when trying to run "+this.name),t&&t(!1),e=!1;var r=this.nodes||this.actor&&[this.actor],l=r?r.map(function(t){return t.to_ascii()}).join(";"):null,u=Array.isArray(this.target)?this.target:this.target&&[this.target],c=u?u.map(function(t){return t.to_ascii()}).join(";"):null;i.gmath.sendErrorReport("An error occurred when trying to run "+this.name+" with nodes "+l+" and target "+c+" on model "+(this.oldTree&&this.oldTree.to_ascii()),o.Tree.stringify(this.oldTree))}return e},l.prototype.wasNodeTouched=function(t){return this.touched_nodes[t.id]},l.prototype.mapNodes=function(t){var e=[],n=this;return Array.isArray(t)||(t=[t]),t.forEach(function(t){(n.node_map[t.id]||[]).forEach(function(t){-1===e.indexOf(t)&&e.push(t)})}),e},l.prototype.unmapNodes=function(t){var e=[];for(var n in Array.isArray(t)||(t=[t]),this.node_map)i.gmath.array.isPermutation(t,this.node_map[n])&&e.push(this.oldTree.get_by_id(n));return e},l.createComposedAction=function(t,e,n){var i=new l(e,n);return function(){function e(n,r,o){return o>=t.length?n:(i.touched_nodes[r]||(i.touched_nodes[r]=n.some(t[o].wasNodeTouched.bind(t[o]))),e(t[o].mapNodes(n),r,o+1))}for(var n in i.node_map={},i.touched_nodes={},t[0].node_map)i.touched_nodes[n]=t[0].touched_nodes[n],i.node_map[n]=e(t[0].node_map[n],n,1)}(),t[0].actor?i.actor=t[0].actor:t[0].nodes&&(i.nodes=t[0].nodes,i.target=t[0].target),i.oldTree=t[0].oldTree,i.newTree=t[t.length-1].newTree,i.new_selection=t[t.length-1].new_selection,i},l.prototype.defineRestrictionExpression=function(t){this.node_map={};var e=this.getOldTreeNode(t),n=this.createRestrictionModel(this.oldTree.clone(),e),i=this.createBoundAction(this.oldTree,{nodes:e,target:n});return i.node_map=this.node_map,this.initNodeMap(),{type:"derivation",model:n,action:i}},l.prototype.endKeyboardInteraction=function(t){t.visible(!1).caption("").latex("").on("done",null).on("change",null).on("cancel",null)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Var=e.Tuple=e.Sym=e.Sign=e.Radical=e.ProductFraction=e.Power=e.PlaceHolder=e.Param=e.Num=e.MulDiv=e.Inequality=e.Func=e.Exponent=e.Equals=e.Degree=e.Brackets=e.AbsVal=e.Conjunction=e.Or=e.Disjunction=e.And=e.Bool=e.Sum=e.AddSub=e.Group=e.asOperator=e.asLeaf=void 0;var i=n(36);Object.defineProperty(e,"asLeaf",{enumerable:!0,get:function(){return i.asLeaf}});var r=n(11);Object.defineProperty(e,"asOperator",{enumerable:!0,get:function(){return r.asOperator}});var o=n(9);Object.defineProperty(e,"Group",{enumerable:!0,get:function(){return o.Group}});var s=n(111);Object.defineProperty(e,"AddSub",{enumerable:!0,get:function(){return s.AddSub}}),Object.defineProperty(e,"Sum",{enumerable:!0,get:function(){return s.Sum}});var a=n(374);Object.defineProperty(e,"Bool",{enumerable:!0,get:function(){return a.Bool}});var l=n(373);Object.defineProperty(e,"And",{enumerable:!0,get:function(){return l.And}}),Object.defineProperty(e,"Disjunction",{enumerable:!0,get:function(){return l.Disjunction}});var u=n(372);Object.defineProperty(e,"Or",{enumerable:!0,get:function(){return u.Or}}),Object.defineProperty(e,"Conjunction",{enumerable:!0,get:function(){return u.Conjunction}});var c=n(371);Object.defineProperty(e,"AbsVal",{enumerable:!0,get:function(){return c.AbsVal}});var d=n(18);Object.defineProperty(e,"Brackets",{enumerable:!0,get:function(){return d.Brackets}});var h=n(110);Object.defineProperty(e,"Degree",{enumerable:!0,get:function(){return h.Degree}});var p=n(108);Object.defineProperty(e,"Equals",{enumerable:!0,get:function(){return p.Equals}});var f=n(62);Object.defineProperty(e,"Exponent",{enumerable:!0,get:function(){return f.Exponent}});var g=n(20);Object.defineProperty(e,"Func",{enumerable:!0,get:function(){return g.Func}});var m=n(60);Object.defineProperty(e,"Inequality",{enumerable:!0,get:function(){return m.Inequality}});var v=n(22);Object.defineProperty(e,"MulDiv",{enumerable:!0,get:function(){return v.MulDiv}});var y=n(15);Object.defineProperty(e,"Num",{enumerable:!0,get:function(){return y.Num}});var b=n(113);Object.defineProperty(e,"Param",{enumerable:!0,get:function(){return b.Param}});var _=n(45);Object.defineProperty(e,"PlaceHolder",{enumerable:!0,get:function(){return _.PlaceHolder}});var x=n(44);Object.defineProperty(e,"Power",{enumerable:!0,get:function(){return x.Power}});var w=n(112);Object.defineProperty(e,"ProductFraction",{enumerable:!0,get:function(){return w.ProductFraction}});var A=n(109);Object.defineProperty(e,"Radical",{enumerable:!0,get:function(){return A.Radical}});var k=n(26);Object.defineProperty(e,"Sign",{enumerable:!0,get:function(){return k.Sign}});var T=n(16);Object.defineProperty(e,"Sym",{enumerable:!0,get:function(){return T.Sym}});var S=n(63);Object.defineProperty(e,"Tuple",{enumerable:!0,get:function(){return S.Tuple}});var M=n(31);Object.defineProperty(e,"Var",{enumerable:!0,get:function(){return M.Var}}),n(370)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=new t;i.gmath.actions[n.name]=n,e&&r.AlgebraModel.prototype.move_actions.push(n);for(var o=arguments.length,s=Array(o>2?o-2:0),a=2;a<o;a++)s[a-2]=arguments[a];s.length>0&&s.forEach(function(t){return t.prototype.add_action_handler(n)})};var i=n(0),r=n(5)},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.AlgebraModel=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=n(1),s=n(64),a=n(46),l=n(18),u=n(26),c=n(15),d=n(20),h=n(61),p=n(2),f=n(10),g=n(361);o.Tree.Node.prototype.match=function(){return m.match(this,arguments,!1)},o.Tree.Node.prototype.matchInner=function(){return m.match(this,arguments,!0)};var m=e.AlgebraModel=function(e){function n(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return o.type="AlgebraModel",o.id=r.gmath.uid(),o.events=t.dispatch("create","change","spawn","mistake","start-of-interaction","end-of-interaction","scrubbability-changed","restraint"),o.settings=new f.Settings("AlgebraModel"),o.settings.setExisting(i),o.hide_rules=[],o.watchedAspects=[],o.parser=o.settings.get("parser")||n.getDefaultParser(),o.init_hide_rules(),o.parseAndSet(e,!0),o.setLocked(o.settings.get("locked")),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,o.Tree.Node),i(n,[{key:"toJSON",value:function(){var t=this.settings.getModified();return t.parser===n.getDefaultParser()&&delete t.parser,{id:this.id,type:"AlgebraModel",settings:t,ascii:this.to_ascii()}}},{key:"clone",value:function(t,e){var i=new n(null,this.settings.getAll());return i.hide_rules=this.hide_rules.slice(),o.Tree.append(i,n.cloneNodes(this.children[0],t,e)),i}},{key:"isTheSameAs",value:function(t){return n.areTheSame(this,t)}},{key:"printLeafNodePositions",value:function(t){this.printForEachLeafNode(t,function(t){return{x:t.x,y:t.y,x0:t.x0,y0:t.y0}})}},{key:"printForEachLeafNode",value:function(t,e){this.get_leaf_nodes().forEach(function(n){console.log((t+" "||"")+n.to_ascii()+" :",e(n))})}},{key:"init_hide_rules",value:function(){for(var t=0;t<this.parser.symbols.length;t++){var e=r.gmath.expressions[this.parser.symbols[t]];e.hide_rule&&this.hide_rules.push(e.hide_rule)}}},{key:"parseAndSet",value:function(t,e,i){var r=this.children[0];this.children=[];var s=this.parser.parse(t);if(!s)return!1;o.Tree.append(this,s),e||this.remove_brackets(),this.hide_nodes(),this.setLocked(this.settings.get("locked"));var a=null;try{r&&(a=r.get_mapping_to(this.children[0]))}catch(t){console.log("could not auto-map",r.to_ascii(),"to",this.to_ascii())}finally{return this.events.change(new n.ChangeEvent({model:this,node_map:a,no_anim:!0,sender:i})),!0}}},{key:"replace_with",value:function(t,e){var i,r;t instanceof n?(i=t).setLocked(this.settings.get("locked")):i=new n(t,this.settings.getAll());try{r=this.children[0].get_1to1_mapping_to(i.children[0],!1)}catch(t){console.log("could not auto-map",this.to_ascii(),"to",i.to_ascii())}finally{return this.events.change(new n.ChangeEvent({model:this,new_model:i,node_map:r,no_anim:!0,sender:e})),i}}},{key:"parse",value:function(t,e){var n=this.parser.parse(t);return n?(e||this.remove_brackets([n]),n):null}},{key:"to_ascii",value:function(t){return n.to_ascii(this.children,t)}},{key:"to_latex",value:function(t){return n.to_latex(this.children,t)}},{key:"getRanges",value:function(t,e,i){return n.getRanges(t,e,i||this.children)}},{key:"getNodes",value:function(t,e,i){return n.getNodes(t,e,i||this.children)}},{key:"getNodesStringified",value:function(t,e,i){return n.getNodesStringified(t,e,i||this.children)}},{key:"setLocked",value:function(t){this.settings.set("locked",t),this.for_each(function(e){e.locked=t}),this.events["scrubbability-changed"]({type:"scrubbability-changed"})}},{key:"created",value:function(t,e){this.events.create({type:"create",term:t&&t.newTree&&t.newTree.to_ascii(),action:t,sender_id:e||this.id})}},{key:"startInteraction",value:function(){this.events["start-of-interaction"]({type:"start-of-interaction",source:this,model:this,time:Date.now()})}},{key:"finishInteraction",value:function(t){var e={type:"end-of-interaction",source:this,time:Date.now()};if(t)this.events["end-of-interaction"](e);else{var i=this.children[0].filter(function(t){return t.simplify});if(0!==i.length){var o=r.gmath.actions.PostInteractionSimplificationAction.createBoundAction(this,{nodes:i,auto_simplify_distributions:this.settings.get("auto_simplify_distributions"),auto_simplify_vector_additions:this.settings.get("auto_simplify_vector_additions"),auto_simplify_multiplicative_identities:this.settings.get("auto_simplify_multiplicative_identities"),auto_simplify_additive_identities:this.settings.get("auto_simplify_additive_identities"),auto_simplify_multiplicative_annihilators:this.settings.get("auto_simplify_multiplicative_annihilators")}),s=this;(this.settings.get("no_history")?o.doInPlace():o.run())&&(s=o.newTree,o.newTree.hide_nodes(),o.newTree===o.oldTree?this.events.change(new n.ChangeEvent({model:this,action:o})):this.created(o)),i.forEach(function(t){t.simplify=!1}),e.source=s,this.events["end-of-interaction"](e)}else this.events["end-of-interaction"](e)}}},{key:"root",value:function(){return this.children[0]}},{key:"is_group",value:function(){return!1}},{key:"numeric_value",value:function(t,e,i){var r,s=this.to_ascii(),a=this.stringify(),l=this.getSelectorOfNodes(t),d=t,h=t.parent;if(t instanceof c.Num&&h&&(h.is_group("sign")||h.is_group("add")||h.is_group("sub"))&&(t=h),r=c.Num.get_value(t),isNaN(r))return NaN;var p=n.get_parent_of_product_with_leading_num(t),f=p&&p.is_group("add")?p:null,g=p&&p.is_group("sub")?p:null;if(g&&(r=-r),arguments.length<2)return r;var m=r>0||0===r&&(t instanceof c.Num||t.is_group("add")),v=e>0||0===e&&(t instanceof c.Num||t.is_group("add")),y=this.children[0].get_mapping_to(this.children[0]);if(m&&!v)if(t.is_group("add"))t.invert(),this.hide_nodes();else if(f)f.invert(),this.hide_nodes();else{var b=o.Tree.remove(t),_=new u.Sign(t);_.children[0].no_anim=!0,o.Tree.insert(h,b,_),_.selected=t.selected,t=_}else if(!m&&v)if(t.is_group("sign")){var x=t.children[1];y[t.children[0].id]=[x],y[t.id]=[x],o.Tree.replace(t,x),t.children[0].no_anim=!0,x.selected=t.selected,t=x}else t.is_group("sub")?(t.invert(),this.hide_nodes()):g&&(g.invert(),this.hide_nodes());else if(this.f_eqls(r,e))return t;return t.is_group()?t.children[1].value=Math.abs(e):t.value=Math.abs(e),y[d.id]=[t],this.events.change(new n.ChangeEvent({model:this,node_map:y,no_anim:!0,old_model_ascii:s,old_model_string:a,sel:l,sender:i})),t}},{key:"f_eqls",value:function(t,e){return Math.abs(t-e)<1e-6}},{key:"remove_brackets",value:function(t){o.Tree.for_each(function(t){t.is_group("fraction")&&t.parent.is_group("brackets")&&l.Brackets.handle(t.parent,!0)},t||this.children)}},{key:"process_operator",value:function(t,e,n){return this.performAction(this.getBestMatchingBoundAction(t,n),e)}},{key:"getBestMatchingBoundAction",value:function(t,e){var n=t;if(n.fixed)return null;for(;!n.getBestMatchingAction&&n.parent&&(!n.parent.is_group("equals","lt","lte","gt","gte")||1===n.get_idx());)n=n.parent;var i=null;return!n.getBestMatchingAction||!n.parent||"AlgebraModel"===n.parent.type||n.is_group("fraction","power","radical")||n.parent.is_group("equals","lt","lte","gt","gte")&&1!==n.get_idx()||(i=n.getBestMatchingAction(e,this.settings.get("action_blacklist")))||(n=n.parent),l.Brackets.areHidden(n)&&(n=n.parent,i=null),n.getBestMatchingAction&&(i=i||n.getBestMatchingAction(e,this.settings.get("action_blacklist")))?i.createBoundAction(this,r.gmath.extend({actor:n},this.settings.getAllIncludingDefaults())):null}},{key:"performAction",value:function(t,e,i,o){var s=[t];if(r.gmath.ui&&r.gmath.ui.Keyboard&&t&&t.settings.asynchronous&&r.gmath.ui.Keyboard().abort(),t&&t.settings&&t.settings.makes_no_changes)return t.doInPlace(),t.elements&&t.elements.length>0&&this.events.spawn(t),e&&e(t),t;void 0===i&&(i=this.settings.get("no_history"));var a=this,l=function(t){if(t)if(i?(a.hide_nodes(),a.events.change(new n.ChangeEvent({model:a,action:t}))):(t.newTree.hide_nodes(),a.created(t)),t.elements&&t.elements.length>0&&a.events.spawn(t),!o&&t.settings.restraint&&a.events.restraint(t.settings.restraint),t.followup){var r=t.newTree.performAction(t.followup,e,i);s=s.concat(r)}else e&&e(t);else e&&e(t)};return t?(i?t.doInPlace(l):t.run(l),1===s.length?s[0]:p.Action.createComposedAction(s,s[0].name,s[0].description)):(l(),null)}},{key:"hide_nodes",value:function(){return this.hideNodesAction.doInPlace(this)}},{key:"performSplitAction",value:function(t){(new h.SplitHandler).split(this,t||this.children)}},{key:"getMoveActions",value:function(t,e){if(0===t.length)return[];if(t.some(function(t){return t.fixed}))return[];e=e||this.move_actions;for(var n=[],i=0;i<e.length;i++){var s=e[i];try{if(s.name&&-1!==this.settings.get("action_blacklist").indexOf(s.name))continue;n=n.concat(e[i].getAllAvailableActions(t,this))}catch(e){console.warn("An error occurred when trying to match "+s.name),r.gmath.sendErrorReport("An error occurred when trying to match "+(s&&s.name)+" on "+t.map(function(t){return t.to_ascii()}).join(";"),o.Tree.stringify(t[0].get_root()))}}return n}},{key:"make_flat",value:function(){var t=o.Tree.get_leaf_nodes(this),e=new Group("flat",0);e.commutative=!0,t.forEach(function(t){t.hidden||(t.commutative=!0,t.associative=!0,o.Tree.append(e,t))}),this.children=[],o.Tree.append(this,e),this.events.change(new n.ChangeEvent({model:this}))}},{key:"getSelectorOfNodes",value:function(t){Array.isArray(t)||(t=[t]);for(var e=[],n=0;n<t.length;n++){var i=t[n];if(i===this)e.push(this.to_ascii());else{var r=this.getNodes(i.to_ascii()).indexOf(i);-1===r?e.push(""):0===r?e.push(i.to_ascii()):e.push(i.to_ascii()+":"+r)}}return e.join(";")}},{key:"getNodesFromSelector",value:function(t){var e=this;return t.split(";").map(function(t){var n=t.split(":");return e.getNodes(n[0],+n[1]||0)}).filter(function(t){return t})}}],[{key:"fromJSON",value:function(t,e,i){t.settings.parser&&(t.settings.parser=(0,s.AlgebraParser)(t.settings.parser));var r=new n(t.ascii,t.settings);return r.id=t.id,r}},{key:"getDefaultParser",value:function(){return n.defaultParser||(n.defaultParser=(0,s.AlgebraParser)(["num","var","sym","brackets","sign","add-sub","mul-div","exponent","equals","inequality","param","func","abs-val","radical","degree","latex"])),n.defaultParser}},{key:"cloneNodes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return o.Tree.clone(t,e,n||["id","value","name","bp","associative","commutative","vertical_notation","locked","fixed","hidden","simplify","do_not_map_on_simplify","deleted","precision","color","size","width","height","x","y","x0","y0","rel_x","rel_y","lmar","rmar","is_leaf_node"])}},{key:"isParsable",value:function(t){try{return!!n.getDefaultParser().parse(t)}catch(t){return!1}}},{key:"areTheSame",value:function(t,e){if(!t||!e)return!1;var i=t instanceof n?t.children[0]:n.getDefaultParser().parse(t),r=e instanceof n?e.children[0]:n.getDefaultParser().parse(e);return!(!i||!r)&&i.to_ascii()===r.to_ascii()}},{key:"is_top_most",value:function(t){return!t.parent||t.parent instanceof n}},{key:"to_ascii",value:function(t,e){return Array.isArray(t)||(t=[t]),t.map(function(t){return t.to_ascii(e)}).join("")}},{key:"to_latex",value:function(t,e){return Array.isArray(t)||(t=[t]),t.map(function(t){return t.to_latex(e)}).join("")}},{key:"select_range_by_value",value:function(t,e){return function(i){return!(!i[0].parent||i[0].parent.parent&&n.range_contains_all_siblings(i)||n.rangeToAscii(i)!==t&&n.rangeToAsciiNoLeadingOp(i,e)!==t&&(1!==i.length||n.fractionToAscii(i[0])!==t))}}},{key:"rangeToAscii",value:function(t){return 1===t.length&&t[0].hidden?"":t.map(function(t){return t.to_ascii()}).join("")}},{key:"isLeadingCommutativeOp",value:function(t){return t.is_group()&&t.commutative&&t.associative}},{key:"rangeToAsciiNoLeadingOp",value:function(t,e){if(0===t.length)return"";if(1===t.length&&t[0].hidden)return"";var i=t.map(function(t){return t.to_ascii()}).join("");return(1!==t.length||e)&&n.isLeadingCommutativeOp(t[0])?i.substring(t[0].children[0].to_ascii().length):i}},{key:"fractionToAscii",value:function(t){if(!t.is_group("fraction"))return"";var e=t.to_ascii();return"("===e.slice(0,1)&&")"===e.slice(e.length-1,e.length)&&(e=e.substr(1,e.length-2)),e}},{key:"range_contains_all_siblings",value:function(t){return t[0]&&t[0].parent&&!t[0].parent.is_group("exponent")&&t.length===t[0].parent.children.length}},{key:"select_node_by_value",value:function(t){return function(e){return"AlgebraModel"!==e.type&&!e.hidden&&!e.fixed&&e.to_ascii()===t}}},{key:"getRanges",value:function(t,e,i){var r=o.Tree.filterRange(n.select_range_by_value(t),i);return"number"==typeof e?r[e]:r}},{key:"getNodes",value:function(t,e,i){var r=o.Tree.filter(n.select_node_by_value(t,!0),i);return"number"==typeof e?r[e]:r}},{key:"select_node_by_stringified_value",value:function(t){return function(e){return!e.is_root()&&!e.hidden&&e.stringify()===t}}},{key:"getNodesStringified",value:function(t,e,i){var r=o.Tree.filter(n.select_node_by_stringified_value(t),i);return"number"==typeof e?r[e]:r}},{key:"get_parent_of_product_with_leading_num",value:function(t){var e=t.parent;return!!(t instanceof c.Num&&e.is_group("mul")&&!e.ls&&e.parent.is_group("product"))&&e.parent.parent}},{key:"get_numeric_value",value:function(t){var e,i=t.parent;if(t instanceof c.Num&&i&&(i.is_group("sign")||i.is_group("add")||i.is_group("sub"))&&(t=i),e=c.Num.get_value(t),isNaN(e))return NaN;var r=n.get_parent_of_product_with_leading_num(t);return r&&r.is_group("add"),(r&&r.is_group("sub")?r:null)&&(e=-e),e}},{key:"groupNodeRanges",value:function(t){return n.groupNodes(t,function(t,e){return t[t.length-1].rs===e})}},{key:"groupNodes",value:function(t,e){if(!t.length)return[];var n=[],i=[t[0]];n.push(i);for(var r=1;r<t.length;r++)e(i,t[r])?i.push(t[r]):(i=[t[r]],n.push(i));return n}},{key:"match",value:function(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=n.__reg_exp_cache,o=0;o<e.length;o++){var s=e[o];r[s]||(r[s]=new a.AlgebraRegExp(s));var l=i?r[s].matchSubExpressions(t):r[s].match(t);if(l)return l}return!1}},{key:"evalExpression",value:function(t,e){var i=function(t,e){return t+e},r=function(t,e){return t*e};e=e||{},t&&t instanceof n&&(t=t.children[0]);var s=function t(n){return n?c.Num.is_num(n)?c.Num.get_value(n):n.is_group("mul","add","brackets")?t(n.children[1]):n.is_group("sign","sub")?-t(n.children[1]):n.is_group("div")?1/t(n.children[1]):n.is_group("exponent")?t(n.children[0]):"//"===n.value?1:n.is_group("product","fraction")?n.children.map(t).reduce(r,1):n.is_group("sum")?n.children.map(t).reduce(i,0):n.is_group("power")?Math.pow(t(n.children[0]),t(n.children[1])):d.Func.Trig.is_trig_func(n)?d.Func.Trig.evaluate(n):n.is_group("var")&&n.get_value()in e?e[n.get_value()]:NaN:NaN};return Array.isArray(t)?o.Tree.is_range(t)?t[0].get_parent(1).is_group("product","fraction")?t.map(s).reduce(r,1):t[0].get_parent(1).is_group("sum")?t.map(s).reduce(i,0):NaN:NaN:s(t)}}]),n}();m.ChangeEvent=g.ChangeEvent,m.__reg_exp_cache={},m.prototype.move_actions=[],new f.SettingsType("AlgebraModel").defaults.setAll({hide_mult_op:!0,hide_leading_op:!0,parser:null,no_history:!1,auto_simplify_distributions:!0,auto_simplify_vector_additions:!0,auto_simplify_additive_identities:!0,auto_simplify_multiplicative_identities:!0,auto_simplify_multiplicative_annihilators:!0,locked:!1,action_blacklist:[],hide_implicit_multiplication_setting:"hideUnlessAmbiguous"})}).call(this,n(6))},function(t,e,n){var i,r;!function(){var o={version:"3.5.17"},s=[].slice,a=function(t){return s.call(t)},l=this.document;function u(t){return t&&(t.ownerDocument||t.document||t).documentElement}function c(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}if(l)try{a(l.documentElement.childNodes)[0].nodeType}catch(t){a=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}if(Date.now||(Date.now=function(){return+new Date}),l)try{l.createElement("DIV").style.setProperty("opacity",0,"")}catch(t){var d=this.Element.prototype,h=d.setAttribute,p=d.setAttributeNS,f=this.CSSStyleDeclaration.prototype,g=f.setProperty;d.setAttribute=function(t,e){h.call(this,t,e+"")},d.setAttributeNS=function(t,e,n){p.call(this,t,e,n+"")},f.setProperty=function(t,e,n){g.call(this,t,e+"",n)}}function m(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function v(t){return null===t?NaN:+t}function y(t){return!isNaN(t)}function b(t){return{left:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);i<r;){var o=i+r>>>1;t(e[o],n)<0?i=o+1:r=o}return i},right:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);i<r;){var o=i+r>>>1;t(e[o],n)>0?r=o:i=o+1}return i}}}o.ascending=m,o.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},o.min=function(t,e){var n,i,r=-1,o=t.length;if(1===arguments.length){for(;++r<o;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<o;)null!=(i=t[r])&&n>i&&(n=i)}else{for(;++r<o;)if(null!=(i=e.call(t,t[r],r))&&i>=i){n=i;break}for(;++r<o;)null!=(i=e.call(t,t[r],r))&&n>i&&(n=i)}return n},o.max=function(t,e){var n,i,r=-1,o=t.length;if(1===arguments.length){for(;++r<o;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<o;)null!=(i=t[r])&&i>n&&(n=i)}else{for(;++r<o;)if(null!=(i=e.call(t,t[r],r))&&i>=i){n=i;break}for(;++r<o;)null!=(i=e.call(t,t[r],r))&&i>n&&(n=i)}return n},o.extent=function(t,e){var n,i,r,o=-1,s=t.length;if(1===arguments.length){for(;++o<s;)if(null!=(i=t[o])&&i>=i){n=r=i;break}for(;++o<s;)null!=(i=t[o])&&(n>i&&(n=i),r<i&&(r=i))}else{for(;++o<s;)if(null!=(i=e.call(t,t[o],o))&&i>=i){n=r=i;break}for(;++o<s;)null!=(i=e.call(t,t[o],o))&&(n>i&&(n=i),r<i&&(r=i))}return[n,r]},o.sum=function(t,e){var n,i=0,r=t.length,o=-1;if(1===arguments.length)for(;++o<r;)y(n=+t[o])&&(i+=n);else for(;++o<r;)y(n=+e.call(t,t[o],o))&&(i+=n);return i},o.mean=function(t,e){var n,i=0,r=t.length,o=-1,s=r;if(1===arguments.length)for(;++o<r;)y(n=v(t[o]))?i+=n:--s;else for(;++o<r;)y(n=v(e.call(t,t[o],o)))?i+=n:--s;if(s)return i/s},o.quantile=function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),r=+t[i-1],o=n-i;return o?r+o*(t[i]-r):r},o.median=function(t,e){var n,i=[],r=t.length,s=-1;if(1===arguments.length)for(;++s<r;)y(n=v(t[s]))&&i.push(n);else for(;++s<r;)y(n=v(e.call(t,t[s],s)))&&i.push(n);if(i.length)return o.quantile(i.sort(m),.5)},o.variance=function(t,e){var n,i,r=t.length,o=0,s=0,a=-1,l=0;if(1===arguments.length)for(;++a<r;)y(n=v(t[a]))&&(s+=(i=n-o)*(n-(o+=i/++l)));else for(;++a<r;)y(n=v(e.call(t,t[a],a)))&&(s+=(i=n-o)*(n-(o+=i/++l)));if(l>1)return s/(l-1)},o.deviation=function(){var t=o.variance.apply(this,arguments);return t?Math.sqrt(t):t};var _=b(m);function x(t){return t.length}o.bisectLeft=_.left,o.bisect=o.bisectRight=_.right,o.bisector=function(t){return b(1===t.length?function(e,n){return m(t(e),n)}:t)},o.shuffle=function(t,e,n){(o=arguments.length)<3&&(n=t.length,o<2&&(e=0));for(var i,r,o=n-e;o;)r=Math.random()*o--|0,i=t[o+e],t[o+e]=t[r+e],t[r+e]=i;return t},o.permute=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},o.pairs=function(t){for(var e=0,n=t.length-1,i=t[0],r=new Array(n<0?0:n);e<n;)r[e]=[i,i=t[++e]];return r},o.transpose=function(t){if(!(r=t.length))return[];for(var e=-1,n=o.min(t,x),i=new Array(n);++e<n;)for(var r,s=-1,a=i[e]=new Array(r);++s<r;)a[s]=t[s][e];return i},o.zip=function(){return o.transpose(arguments)},o.keys=function(t){var e=[];for(var n in t)e.push(n);return e},o.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},o.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},o.merge=function(t){for(var e,n,i,r=t.length,o=-1,s=0;++o<r;)s+=t[o].length;for(n=new Array(s);--r>=0;)for(e=(i=t[r]).length;--e>=0;)n[--s]=i[e];return n};var w=Math.abs;function A(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function k(){this._=Object.create(null)}o.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n==1/0)throw new Error("infinite range");var i,r=[],o=function(t){for(var e=1;t*e%1;)e*=10;return e}(w(n)),s=-1;if(t*=o,e*=o,(n*=o)<0)for(;(i=t+n*++s)>e;)r.push(i/o);else for(;(i=t+n*++s)<e;)r.push(i/o);return r},o.map=function(t,e){var n=new k;if(t instanceof k)t.forEach(function(t,e){n.set(t,e)});else if(Array.isArray(t)){var i,r=-1,o=t.length;if(1===arguments.length)for(;++r<o;)n.set(r,t[r]);else for(;++r<o;)n.set(e.call(t,i=t[r],r),i)}else for(var s in t)n.set(s,t[s]);return n};var T="__proto__",S="\0";function M(t){return(t+="")===T||t[0]===S?S+t:t}function E(t){return(t+="")[0]===S?t.slice(1):t}function N(t){return M(t)in this._}function O(t){return(t=M(t))in this._&&delete this._[t]}function q(){var t=[];for(var e in this._)t.push(E(e));return t}function C(){var t=0;for(var e in this._)++t;return t}function P(){for(var t in this._)return!1;return!0}function j(){this._=Object.create(null)}function D(t){return t}function I(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}function F(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,i=L.length;n<i;++n){var r=L[n]+e;if(r in t)return r}}A(k,{has:N,get:function(t){return this._[M(t)]},set:function(t,e){return this._[M(t)]=e},remove:O,keys:q,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:E(e),value:this._[e]});return t},size:C,empty:P,forEach:function(t){for(var e in this._)t.call(this,E(e),this._[e])}}),o.nest=function(){var t,e,n={},i=[],r=[];function s(r,o,a){if(a>=i.length)return e?e.call(n,o):t?o.sort(t):o;for(var l,u,c,d,h=-1,p=o.length,f=i[a++],g=new k;++h<p;)(d=g.get(l=f(u=o[h])))?d.push(u):g.set(l,[u]);return r?(u=r(),c=function(t,e){u.set(t,s(r,e,a))}):(u={},c=function(t,e){u[t]=s(r,e,a)}),g.forEach(c),u}return n.map=function(t,e){return s(e,t,0)},n.entries=function(t){return function t(e,n){if(n>=i.length)return e;var o=[],s=r[n++];return e.forEach(function(e,i){o.push({key:e,values:t(i,n)})}),s?o.sort(function(t,e){return s(t.key,e.key)}):o}(s(o.map,t,0),0)},n.key=function(t){return i.push(t),n},n.sortKeys=function(t){return r[i.length-1]=t,n},n.sortValues=function(e){return t=e,n},n.rollup=function(t){return e=t,n},n},o.set=function(t){var e=new j;if(t)for(var n=0,i=t.length;n<i;++n)e.add(t[n]);return e},A(j,{has:N,add:function(t){return this._[M(t+="")]=!0,t},remove:O,values:q,size:C,empty:P,forEach:function(t){for(var e in this._)t.call(this,E(e))}}),o.behavior={},o.rebind=function(t,e){for(var n,i=1,r=arguments.length;++i<r;)t[n=arguments[i]]=I(t,e,e[n]);return t};var L=["webkit","ms","moz","Moz","o","O"];function z(){}function R(){}function B(t){var e=[],n=new k;function i(){for(var n,i=e,r=-1,o=i.length;++r<o;)(n=i[r].on)&&n.apply(this,arguments);return t}return i.on=function(i,r){var o,s=n.get(i);return arguments.length<2?s&&s.on:(s&&(s.on=null,e=e.slice(0,o=e.indexOf(s)).concat(e.slice(o+1)),n.remove(i)),r&&e.push(n.set(i,{on:r})),t)},i}function H(){o.event.preventDefault()}function G(){for(var t,e=o.event;t=e.sourceEvent;)e=t;return e}function V(t){for(var e=new R,n=0,i=arguments.length;++n<i;)e[arguments[n]]=B(e);return e.of=function(n,i){return function(r){try{var s=r.sourceEvent=o.event;r.target=t,o.event=r,e[r.type].apply(n,i)}finally{o.event=s}}},e}o.dispatch=function(){for(var t=new R,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=B(t);return t},R.prototype.on=function(t,e){var n=t.indexOf("."),i="";if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(i):this[t].on(i,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(i,null);return this}},o.event=null,o.requote=function(t){return t.replace(U,"\\$&")};var U=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,W={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]};function Q(t){return W(t,Z),t}var $=function(t,e){return e.querySelector(t)},K=function(t,e){return e.querySelectorAll(t)},J=function(t,e){var n=t.matches||t[F(t,"matchesSelector")];return(J=function(t,e){return n.call(t,e)})(t,e)};"function"==typeof Sizzle&&($=function(t,e){return Sizzle(t,e)[0]||null},K=Sizzle,J=Sizzle.matchesSelector),o.selection=function(){return o.select(l.documentElement)};var Z=o.selection.prototype=[];function Y(t){return"function"==typeof t?t:function(){return $(t,this)}}function X(t){return"function"==typeof t?t:function(){return K(t,this)}}Z.select=function(t){var e,n,i,r,o=[];t=Y(t);for(var s=-1,a=this.length;++s<a;){o.push(e=[]),e.parentNode=(i=this[s]).parentNode;for(var l=-1,u=i.length;++l<u;)(r=i[l])?(e.push(n=t.call(r,r.__data__,l,s)),n&&"__data__"in r&&(n.__data__=r.__data__)):e.push(null)}return Q(o)},Z.selectAll=function(t){var e,n,i=[];t=X(t);for(var r=-1,o=this.length;++r<o;)for(var s=this[r],l=-1,u=s.length;++l<u;)(n=s[l])&&(i.push(e=a(t.call(n,n.__data__,l,r))),e.parentNode=n);return Q(i)};var tt="http://www.w3.org/1999/xhtml",et={svg:"http://www.w3.org/2000/svg",xhtml:tt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function nt(t,e){return t=o.ns.qualify(t),null==e?t.local?function(){this.removeAttributeNS(t.space,t.local)}:function(){this.removeAttribute(t)}:"function"==typeof e?t.local?function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}:function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}:t.local?function(){this.setAttributeNS(t.space,t.local,e)}:function(){this.setAttribute(t,e)}}function it(t){return t.trim().replace(/\s+/g," ")}function rt(t){return new RegExp("(?:^|\\s+)"+o.requote(t)+"(?:\\s+|$)","g")}function ot(t){return(t+"").trim().split(/^|\s+/)}function st(t,e){var n=(t=ot(t).map(at)).length;return"function"==typeof e?function(){for(var i=-1,r=e.apply(this,arguments);++i<n;)t[i](this,r)}:function(){for(var i=-1;++i<n;)t[i](this,e)}}function at(t){var e=rt(t);return function(n,i){if(r=n.classList)return i?r.add(t):r.remove(t);var r=n.getAttribute("class")||"";i?(e.lastIndex=0,e.test(r)||n.setAttribute("class",it(r+" "+t))):n.setAttribute("class",it(r.replace(e," ")))}}function lt(t,e,n){return null==e?function(){this.style.removeProperty(t)}:"function"==typeof e?function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}:function(){this.style.setProperty(t,e,n)}}function ut(t,e){return null==e?function(){delete this[t]}:"function"==typeof e?function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}:function(){this[t]=e}}function ct(t){return"function"==typeof t?t:(t=o.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){var e=this.ownerDocument,n=this.namespaceURI;return n===tt&&e.documentElement.namespaceURI===tt?e.createElement(t):e.createElementNS(n,t)}}function dt(){var t=this.parentNode;t&&t.removeChild(this)}function ht(t){return{__data__:t}}function pt(t){return function(){return J(this,t)}}function ft(t,e){for(var n=0,i=t.length;n<i;n++)for(var r,o=t[n],s=0,a=o.length;s<a;s++)(r=o[s])&&e(r,s,n);return t}function gt(t){return W(t,mt),t}o.ns={prefix:et,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),et.hasOwnProperty(n)?{space:et[n],local:t}:t}},Z.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return(t=o.ns.qualify(t)).local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(nt(e,t[e]));return this}return this.each(nt(t,e))},Z.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),i=(t=ot(t)).length,r=-1;if(e=n.classList){for(;++r<i;)if(!e.contains(t[r]))return!1}else for(e=n.getAttribute("class");++r<i;)if(!rt(t[r]).test(e))return!1;return!0}for(e in t)this.each(st(e,t[e]));return this}return this.each(st(t,e))},Z.style=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=""),t)this.each(lt(n,t[n],e));return this}if(i<2){var r=this.node();return c(r).getComputedStyle(r,null).getPropertyValue(t)}n=""}return this.each(lt(t,e,n))},Z.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(ut(e,t[e]));return this}return this.each(ut(t,e))},Z.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},Z.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},Z.append=function(t){return t=ct(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},Z.insert=function(t,e){return t=ct(t),e=Y(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},Z.remove=function(){return this.each(dt)},Z.data=function(t,e){var n,i,r=-1,o=this.length;if(!arguments.length){for(t=new Array(o=(n=this[0]).length);++r<o;)(i=n[r])&&(t[r]=i.__data__);return t}function s(t,n){var i,r,o,s=t.length,c=n.length,d=Math.min(s,c),h=new Array(c),p=new Array(c),f=new Array(s);if(e){var g,m=new k,v=new Array(s);for(i=-1;++i<s;)(r=t[i])&&(m.has(g=e.call(r,r.__data__,i))?f[i]=r:m.set(g,r),v[i]=g);for(i=-1;++i<c;)(r=m.get(g=e.call(n,o=n[i],i)))?!0!==r&&(h[i]=r,r.__data__=o):p[i]=ht(o),m.set(g,!0);for(i=-1;++i<s;)i in v&&!0!==m.get(v[i])&&(f[i]=t[i])}else{for(i=-1;++i<d;)r=t[i],o=n[i],r?(r.__data__=o,h[i]=r):p[i]=ht(o);for(;i<c;++i)p[i]=ht(n[i]);for(;i<s;++i)f[i]=t[i]}p.update=h,p.parentNode=h.parentNode=f.parentNode=t.parentNode,a.push(p),l.push(h),u.push(f)}var a=gt([]),l=Q([]),u=Q([]);if("function"==typeof t)for(;++r<o;)s(n=this[r],t.call(n,n.parentNode.__data__,r));else for(;++r<o;)s(n=this[r],t);return l.enter=function(){return a},l.exit=function(){return u},l},Z.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},Z.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=pt(t));for(var o=0,s=this.length;o<s;o++){r.push(e=[]),e.parentNode=(n=this[o]).parentNode;for(var a=0,l=n.length;a<l;a++)(i=n[a])&&t.call(i,i.__data__,a,o)&&e.push(i)}return Q(r)},Z.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,i=this[t],r=i.length-1,o=i[r];--r>=0;)(n=i[r])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},Z.sort=function(t){t=function(t){return arguments.length||(t=m),function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},Z.each=function(t){return ft(this,function(e,n,i){t.call(e,e.__data__,n,i)})},Z.call=function(t){var e=a(arguments);return t.apply(e[0]=this,e),this},Z.empty=function(){return!this.node()},Z.node=function(){for(var t=0,e=this.length;t<e;t++)for(var n=this[t],i=0,r=n.length;i<r;i++){var o=n[i];if(o)return o}return null},Z.size=function(){var t=0;return ft(this,function(){++t}),t};var mt=[];function vt(t,e,n){var i="__on"+t,r=t.indexOf("."),s=bt;r>0&&(t=t.slice(0,r));var l=yt.get(t);function u(){var e=this[i];e&&(this.removeEventListener(t,e,e.$),delete this[i])}return l&&(t=l,s=_t),r?e?function(){var r=s(e,a(arguments));u.call(this),this.addEventListener(t,this[i]=r,r.$=n),r._=e}:u:e?z:function(){var e,n=new RegExp("^__on([^.]+)"+o.requote(t)+"$");for(var i in this)if(e=i.match(n)){var r=this[i];this.removeEventListener(e[1],r,r.$),delete this[i]}}}o.selection.enter=gt,o.selection.enter.prototype=mt,mt.append=Z.append,mt.empty=Z.empty,mt.node=Z.node,mt.call=Z.call,mt.size=Z.size,mt.select=function(t){for(var e,n,i,r,o,s=[],a=-1,l=this.length;++a<l;){i=(r=this[a]).update,s.push(e=[]),e.parentNode=r.parentNode;for(var u=-1,c=r.length;++u<c;)(o=r[u])?(e.push(i[u]=n=t.call(r.parentNode,o.__data__,u,a)),n.__data__=o.__data__):e.push(null)}return Q(s)},mt.insert=function(t,e){var n,i,r;return arguments.length<2&&(n=this,e=function(t,e,o){var s,a=n[o].update,l=a.length;for(o!=r&&(r=o,i=0),e>=i&&(i=e+1);!(s=a[i])&&++i<l;);return s}),Z.insert.call(this,t,e)},o.select=function(t){var e;return"string"==typeof t?(e=[$(t,l)]).parentNode=l.documentElement:(e=[t]).parentNode=u(t),Q([e])},o.selectAll=function(t){var e;return"string"==typeof t?(e=a(K(t,l))).parentNode=l.documentElement:(e=a(t)).parentNode=null,Q([e])},Z.on=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=!1),t)this.each(vt(n,t[n],e));return this}if(i<2)return(i=this.node()["__on"+t])&&i._;n=!1}return this.each(vt(t,e,n))};var yt=o.map({mouseenter:"mouseover",mouseleave:"mouseout"});function bt(t,e){return function(n){var i=o.event;o.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{o.event=i}}}function _t(t,e){var n=bt(t,e);return function(t){var e=t.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||n.call(this,t)}}l&&yt.forEach(function(t){"on"+t in l&&yt.remove(t)});var xt,wt=0;function At(t){var e=".dragsuppress-"+ ++wt,n="click"+e,i=o.select(c(t)).on("touchmove"+e,H).on("dragstart"+e,H).on("selectstart"+e,H);if(null==xt&&(xt=!("onselectstart"in t)&&F(t.style,"userSelect")),xt){var r=u(t).style,s=r[xt];r[xt]="none"}return function(t){if(i.on(e,null),xt&&(r[xt]=s),t){var o=function(){i.on(n,null)};i.on(n,function(){H(),o()},!0),setTimeout(o,0)}}}o.mouse=function(t){return Tt(t,G())};var kt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function Tt(t,e){e.changedTouches&&(e=e.changedTouches[0]);var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();if(kt<0){var r=c(t);if(r.scrollX||r.scrollY){var s=(n=o.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();kt=!(s.f||s.e),n.remove()}}return kt?(i.x=e.pageX,i.y=e.pageY):(i.x=e.clientX,i.y=e.clientY),[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}function St(){return o.event.changedTouches[0].identifier}o.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=G().changedTouches),e)for(var i,r=0,o=e.length;r<o;++r)if((i=e[r]).identifier===n)return Tt(t,i)},o.behavior.drag=function(){var t=V(r,"drag","dragstart","dragend"),e=null,n=s(z,o.mouse,c,"mousemove","mouseup"),i=s(St,o.touch,D,"touchmove","touchend");function r(){this.on("mousedown.drag",n).on("touchstart.drag",i)}function s(n,i,r,s,a){return function(){var l,u=o.event.target.correspondingElement||o.event.target,c=this.parentNode,d=t.of(this,arguments),h=0,p=n(),f=".drag"+(null==p?"":"-"+p),g=o.select(r(u)).on(s+f,function(){var t,e,n=i(c,p);n&&(t=n[0]-v[0],e=n[1]-v[1],h|=t|e,v=n,d({type:"drag",x:n[0]+l[0],y:n[1]+l[1],dx:t,dy:e}))}).on(a+f,function(){i(c,p)&&(g.on(s+f,null).on(a+f,null),m(h),d({type:"dragend"}))}),m=At(u),v=i(c,p);l=e?[(l=e.apply(this,arguments)).x-v[0],l.y-v[1]]:[0,0],d({type:"dragstart"})}}return r.origin=function(t){return arguments.length?(e=t,r):e},o.rebind(r,t,"on")},o.touches=function(t,e){return arguments.length<2&&(e=G().touches),e?a(e).map(function(e){var n=Tt(t,e);return n.identifier=e.identifier,n}):[]};var Mt=1e-6,Et=Mt*Mt,Nt=Math.PI,Ot=2*Nt,qt=Ot-Mt,Ct=Nt/2,Pt=Nt/180,jt=180/Nt;function Dt(t){return t>0?1:t<0?-1:0}function It(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function Ft(t){return t>1?0:t<-1?Nt:Math.acos(t)}function Lt(t){return t>1?Ct:t<-1?-Ct:Math.asin(t)}function zt(t){return((t=Math.exp(t))+1/t)/2}function Rt(t){return(t=Math.sin(t/2))*t}var Bt=Math.SQRT2;o.interpolateZoom=function(t,e){var n,i,r=t[0],o=t[1],s=t[2],a=e[0],l=e[1],u=e[2],c=a-r,d=l-o,h=c*c+d*d;if(h<Et)i=Math.log(u/s)/Bt,n=function(t){return[r+t*c,o+t*d,s*Math.exp(Bt*t*i)]};else{var p=Math.sqrt(h),f=(u*u-s*s+4*h)/(2*s*2*p),g=(u*u-s*s-4*h)/(2*u*2*p),m=Math.log(Math.sqrt(f*f+1)-f),v=Math.log(Math.sqrt(g*g+1)-g);i=(v-m)/Bt,n=function(t){var e,n=t*i,a=zt(m),l=s/(2*p)*(a*(e=Bt*n+m,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(m));return[r+l*c,o+l*d,s*a/zt(Bt*n+m)]}}return n.duration=1e3*i,n},o.behavior.zoom=function(){var t,e,n,i,r,s,a,u,d,h={x:0,y:0,k:1},p=[960,500],f=Vt,g=250,m=0,v="mousedown.zoom",y="mousemove.zoom",b="mouseup.zoom",_="touchstart.zoom",x=V(w,"zoomstart","zoom","zoomend");function w(t){t.on(v,q).on(Gt+".zoom",P).on("dblclick.zoom",j).on(_,C)}function A(t){return[(t[0]-h.x)/h.k,(t[1]-h.y)/h.k]}function k(t){h.k=Math.max(f[0],Math.min(f[1],t))}function T(t,e){e=function(t){return[t[0]*h.k+h.x,t[1]*h.k+h.y]}(e),h.x+=t[0]-e[0],h.y+=t[1]-e[1]}function S(t,n,i,r){t.__chart__={x:h.x,y:h.y,k:h.k},k(Math.pow(2,r)),T(e=n,i),t=o.select(t),g>0&&(t=t.transition().duration(g)),t.call(w.event)}function M(){a&&a.domain(s.range().map(function(t){return(t-h.x)/h.k}).map(s.invert)),d&&d.domain(u.range().map(function(t){return(t-h.y)/h.k}).map(u.invert))}function E(t){m++||t({type:"zoomstart"})}function N(t){M(),t({type:"zoom",scale:h.k,translate:[h.x,h.y]})}function O(t){--m||(t({type:"zoomend"}),e=null)}function q(){var t=this,e=x.of(t,arguments),n=0,i=o.select(c(t)).on(y,function(){n=1,T(o.mouse(t),r),N(e)}).on(b,function(){i.on(y,null).on(b,null),s(n),O(e)}),r=A(o.mouse(t)),s=At(t);ca.call(t),E(e)}function C(){var t,e=this,n=x.of(e,arguments),i={},s=0,a=".zoom-"+o.event.changedTouches[0].identifier,l="touchmove"+a,u="touchend"+a,c=[],d=o.select(e),p=At(e);function f(){var n=o.touches(e);return t=h.k,n.forEach(function(t){t.identifier in i&&(i[t.identifier]=A(t))}),n}function g(){var t=o.event.target;o.select(t).on(l,m).on(u,y),c.push(t);for(var n=o.event.changedTouches,a=0,d=n.length;a<d;++a)i[n[a].identifier]=null;var p=f(),g=Date.now();if(1===p.length){if(g-r<500){var v=p[0];S(e,v,i[v.identifier],Math.floor(Math.log(h.k)/Math.LN2)+1),H()}r=g}else if(p.length>1){v=p[0];var b=p[1],_=v[0]-b[0],x=v[1]-b[1];s=_*_+x*x}}function m(){var a,l,u,c,d=o.touches(e);ca.call(e);for(var h=0,p=d.length;h<p;++h,c=null)if(u=d[h],c=i[u.identifier]){if(l)break;a=u,l=c}if(c){var f=(f=u[0]-a[0])*f+(f=u[1]-a[1])*f,g=s&&Math.sqrt(f/s);a=[(a[0]+u[0])/2,(a[1]+u[1])/2],l=[(l[0]+c[0])/2,(l[1]+c[1])/2],k(g*t)}r=null,T(a,l),N(n)}function y(){if(o.event.touches.length){for(var t=o.event.changedTouches,e=0,r=t.length;e<r;++e)delete i[t[e].identifier];for(var s in i)return void f()}o.selectAll(c).on(a,null),d.on(v,q).on(_,C),p(),O(n)}g(),E(n),d.on(v,null).on(_,g)}function P(){var r=x.of(this,arguments);i?clearTimeout(i):(ca.call(this),t=A(e=n||o.mouse(this)),E(r)),i=setTimeout(function(){i=null,O(r)},50),H(),k(Math.pow(2,.002*Ht())*h.k),T(e,t),N(r)}function j(){var t=o.mouse(this),e=Math.log(h.k)/Math.LN2;S(this,t,A(t),o.event.shiftKey?Math.ceil(e)-1:Math.floor(e)+1)}return Gt||(Gt="onwheel"in l?(Ht=function(){return-o.event.deltaY*(o.event.deltaMode?120:1)},"wheel"):"onmousewheel"in l?(Ht=function(){return o.event.wheelDelta},"mousewheel"):(Ht=function(){return-o.event.detail},"MozMousePixelScroll")),w.event=function(t){t.each(function(){var t=x.of(this,arguments),n=h;pa?o.select(this).transition().each("start.zoom",function(){h=this.__chart__||{x:0,y:0,k:1},E(t)}).tween("zoom:zoom",function(){var i=p[0],r=p[1],s=e?e[0]:i/2,a=e?e[1]:r/2,l=o.interpolateZoom([(s-h.x)/h.k,(a-h.y)/h.k,i/h.k],[(s-n.x)/n.k,(a-n.y)/n.k,i/n.k]);return function(e){var n=l(e),r=i/n[2];this.__chart__=h={x:s-n[0]*r,y:a-n[1]*r,k:r},N(t)}}).each("interrupt.zoom",function(){O(t)}).each("end.zoom",function(){O(t)}):(this.__chart__=h,E(t),N(t),O(t))})},w.translate=function(t){return arguments.length?(h={x:+t[0],y:+t[1],k:h.k},M(),w):[h.x,h.y]},w.scale=function(t){return arguments.length?(h={x:h.x,y:h.y,k:null},k(+t),M(),w):h.k},w.scaleExtent=function(t){return arguments.length?(f=null==t?Vt:[+t[0],+t[1]],w):f},w.center=function(t){return arguments.length?(n=t&&[+t[0],+t[1]],w):n},w.size=function(t){return arguments.length?(p=t&&[+t[0],+t[1]],w):p},w.duration=function(t){return arguments.length?(g=+t,w):g},w.x=function(t){return arguments.length?(a=t,s=t.copy(),h={x:0,y:0,k:1},w):a},w.y=function(t){return arguments.length?(d=t,u=t.copy(),h={x:0,y:0,k:1},w):d},o.rebind(w,x,"on")};var Ht,Gt,Vt=[0,1/0];function Ut(){}function Wt(t,e,n){return this instanceof Wt?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof Wt?new Wt(t.h,t.s,t.l):pe(""+t,fe,Wt):new Wt(t,e,n)}o.color=Ut,Ut.prototype.toString=function(){return this.rgb()+""},o.hsl=Wt;var Qt=Wt.prototype=new Ut;function $t(t,e,n){var i,r;function o(t){return Math.round(255*function(t){return t>360?t-=360:t<0&&(t+=360),t<60?i+(r-i)*t/60:t<180?r:t<240?i+(r-i)*(240-t)/60:i}(t))}return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:e<0?0:e>1?1:e,i=2*(n=n<0?0:n>1?1:n)-(r=n<=.5?n*(1+e):n+e-n*e),new le(o(t+120),o(t),o(t-120))}function Kt(t,e,n){return this instanceof Kt?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof Kt?new Kt(t.h,t.c,t.l):function(t,e,n){return t>0?new Kt(Math.atan2(n,e)*jt,Math.sqrt(e*e+n*n),t):new Kt(NaN,NaN,t)}(t instanceof Yt?t.l:(t=ge((t=o.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new Kt(t,e,n)}Qt.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new Wt(this.h,this.s,this.l/t)},Qt.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new Wt(this.h,this.s,t*this.l)},Qt.rgb=function(){return $t(this.h,this.s,this.l)},o.hcl=Kt;var Jt=Kt.prototype=new Ut;function Zt(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new Yt(n,Math.cos(t*=Pt)*e,Math.sin(t)*e)}function Yt(t,e,n){return this instanceof Yt?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof Yt?new Yt(t.l,t.a,t.b):t instanceof Kt?Zt(t.h,t.c,t.l):ge((t=le(t)).r,t.g,t.b):new Yt(t,e,n)}Jt.brighter=function(t){return new Kt(this.h,this.c,Math.min(100,this.l+Xt*(arguments.length?t:1)))},Jt.darker=function(t){return new Kt(this.h,this.c,Math.max(0,this.l-Xt*(arguments.length?t:1)))},Jt.rgb=function(){return Zt(this.h,this.c,this.l).rgb()},o.lab=Yt;var Xt=18,te=.95047,ee=1,ne=1.08883,ie=Yt.prototype=new Ut;function re(t,e,n){var i=(t+16)/116,r=i+e/500,o=i-n/200;return new le(ae(3.2404542*(r=oe(r)*te)-1.5371385*(i=oe(i)*ee)-.4985314*(o=oe(o)*ne)),ae(-.969266*r+1.8760108*i+.041556*o),ae(.0556434*r-.2040259*i+1.0572252*o))}function oe(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function se(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function ae(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function le(t,e,n){return this instanceof le?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof le?new le(t.r,t.g,t.b):pe(""+t,le,$t):new le(t,e,n)}function ue(t){return new le(t>>16,t>>8&255,255&t)}function ce(t){return ue(t)+""}ie.brighter=function(t){return new Yt(Math.min(100,this.l+Xt*(arguments.length?t:1)),this.a,this.b)},ie.darker=function(t){return new Yt(Math.max(0,this.l-Xt*(arguments.length?t:1)),this.a,this.b)},ie.rgb=function(){return re(this.l,this.a,this.b)},o.rgb=le;var de=le.prototype=new Ut;function he(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function pe(t,e,n){var i,r,o,s=0,a=0,l=0;if(i=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase()))switch(r=i[2].split(","),i[1]){case"hsl":return n(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(ve(r[0]),ve(r[1]),ve(r[2]))}return(o=ye.get(t))?e(o.r,o.g,o.b):(null==t||"#"!==t.charAt(0)||isNaN(o=parseInt(t.slice(1),16))||(4===t.length?(s=(3840&o)>>4,s|=s>>4,a=240&o,a|=a>>4,l=15&o,l|=l<<4):7===t.length&&(s=(16711680&o)>>16,a=(65280&o)>>8,l=255&o)),e(s,a,l))}function fe(t,e,n){var i,r,o=Math.min(t/=255,e/=255,n/=255),s=Math.max(t,e,n),a=s-o,l=(s+o)/2;return a?(r=l<.5?a/(s+o):a/(2-s-o),i=t==s?(e-n)/a+(e<n?6:0):e==s?(n-t)/a+2:(t-e)/a+4,i*=60):(i=NaN,r=l>0&&l<1?0:i),new Wt(i,r,l)}function ge(t,e,n){var i=se((.4124564*(t=me(t))+.3575761*(e=me(e))+.1804375*(n=me(n)))/te),r=se((.2126729*t+.7151522*e+.072175*n)/ee);return Yt(116*r-16,500*(i-r),200*(r-se((.0193339*t+.119192*e+.9503041*n)/ne)))}function me(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ve(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}de.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,i=this.b,r=30;return e||n||i?(e&&e<r&&(e=r),n&&n<r&&(n=r),i&&i<r&&(i=r),new le(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,i/t))):new le(r,r,r)},de.darker=function(t){return new le((t=Math.pow(.7,arguments.length?t:1))*this.r,t*this.g,t*this.b)},de.hsl=function(){return fe(this.r,this.g,this.b)},de.toString=function(){return"#"+he(this.r)+he(this.g)+he(this.b)};var ye=o.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function be(t){return"function"==typeof t?t:function(){return t}}function _e(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=null),xe(e,n,t,i)}}function xe(t,e,n,i){var r={},s=o.dispatch("beforesend","progress","load","error"),l={},u=new XMLHttpRequest,c=null;function d(){var t,e=u.status;if(!e&&function(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}(u)||e>=200&&e<300||304===e){try{t=n.call(r,u)}catch(t){return void s.error.call(r,t)}s.load.call(r,t)}else s.error.call(r,u)}return!this.XDomainRequest||"withCredentials"in u||!/^(http(s)?:)?\/\//.test(t)||(u=new XDomainRequest),"onload"in u?u.onload=u.onerror=d:u.onreadystatechange=function(){u.readyState>3&&d()},u.onprogress=function(t){var e=o.event;o.event=t;try{s.progress.call(r,u)}finally{o.event=e}},r.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?l[t]:(null==e?delete l[t]:l[t]=e+"",r)},r.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",r):e},r.responseType=function(t){return arguments.length?(c=t,r):c},r.response=function(t){return n=t,r},["get","post"].forEach(function(t){r[t]=function(){return r.send.apply(r,[t].concat(a(arguments)))}}),r.send=function(n,i,o){if(2===arguments.length&&"function"==typeof i&&(o=i,i=null),u.open(n,t,!0),null==e||"accept"in l||(l.accept=e+",*/*"),u.setRequestHeader)for(var a in l)u.setRequestHeader(a,l[a]);return null!=e&&u.overrideMimeType&&u.overrideMimeType(e),null!=c&&(u.responseType=c),null!=o&&r.on("error",o).on("load",function(t){o(null,t)}),s.beforesend.call(r,u),u.send(null==i?null:i),r},r.abort=function(){return u.abort(),r},o.rebind(r,s,"on"),null==i?r:r.get(function(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}(i))}ye.forEach(function(t,e){ye.set(t,ue(e))}),o.functor=be,o.xhr=_e(D),o.dsv=function(t,e){var n=new RegExp('["'+t+"\n]"),i=t.charCodeAt(0);function r(t,n,i){arguments.length<3&&(i=n,n=null);var r=xe(t,e,null==n?o:s(n),i);return r.row=function(t){return arguments.length?r.response(null==(n=t)?o:s(t)):n},r}function o(t){return r.parse(t.responseText)}function s(t){return function(e){return r.parse(e.responseText,t)}}function a(e){return e.map(l).join(t)}function l(t){return n.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}return r.parse=function(t,e){var n;return r.parseRows(t,function(t,i){if(n)return n(t,i-1);var r=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");n=e?function(t,n){return e(r(t),n)}:r})},r.parseRows=function(t,e){var n,r,o={},s={},a=[],l=t.length,u=0,c=0;function d(){if(u>=l)return s;if(r)return r=!1,o;var e=u;if(34===t.charCodeAt(e)){for(var n=e;n++<l;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}return u=n+2,13===(a=t.charCodeAt(n+1))?(r=!0,10===t.charCodeAt(n+2)&&++u):10===a&&(r=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;u<l;){var a,c=1;if(10===(a=t.charCodeAt(u++)))r=!0;else if(13===a)r=!0,10===t.charCodeAt(u)&&(++u,++c);else if(a!==i)continue;return t.slice(e,u-c)}return t.slice(e)}for(;(n=d())!==s;){for(var h=[];n!==o&&n!==s;)h.push(n),n=d();e&&null==(h=e(h,c++))||a.push(h)}return a},r.format=function(e){if(Array.isArray(e[0]))return r.formatRows(e);var n=new j,i=[];return e.forEach(function(t){for(var e in t)n.has(e)||i.push(n.add(e))}),[i.map(l).join(t)].concat(e.map(function(e){return i.map(function(t){return l(e[t])}).join(t)})).join("\n")},r.formatRows=function(t){return t.map(a).join("\n")},r},o.csv=o.dsv(",","text/csv"),o.tsv=o.dsv("\t","text/tab-separated-values");var we,Ae,ke,Te,Se=this[F(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};function Me(t,e,n){var i=arguments.length;i<2&&(e=0),i<3&&(n=Date.now());var r={c:t,t:n+e,n:null};return Ae?Ae.n=r:we=r,Ae=r,ke||(Te=clearTimeout(Te),ke=1,Se(Ee)),r}function Ee(){var t=Ne(),e=Oe()-t;e>24?(isFinite(e)&&(clearTimeout(Te),Te=setTimeout(Ee,e)),ke=0):(ke=1,Se(Ee))}function Ne(){for(var t=Date.now(),e=we;e;)t>=e.t&&e.c(t-e.t)&&(e.c=null),e=e.n;return t}function Oe(){for(var t,e=we,n=1/0;e;)e.c?(e.t<n&&(n=e.t),e=(t=e).n):e=t?t.n=e.n:we=e.n;return Ae=t,n}function qe(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}o.timer=function(){Me.apply(this,arguments)},o.timer.flush=function(){Ne(),Oe()},o.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var Ce=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(function(t,e){var n=Math.pow(10,3*w(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}});o.formatPrefix=function(t,e){var n=0;return(t=+t)&&(t<0&&(t*=-1),e&&(t=o.round(t,qe(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),Ce[8+n/3]};var Pe=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,je=o.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=o.round(t,qe(t,e))).toFixed(Math.max(0,Math.min(20,qe(t*(1+1e-15),e))))}});function De(t){return t+""}var Ie=o.time={},Fe=Date;function Le(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}Le.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){ze.setUTCDate.apply(this._,arguments)},setDay:function(){ze.setUTCDay.apply(this._,arguments)},setFullYear:function(){ze.setUTCFullYear.apply(this._,arguments)},setHours:function(){ze.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){ze.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){ze.setUTCMinutes.apply(this._,arguments)},setMonth:function(){ze.setUTCMonth.apply(this._,arguments)},setSeconds:function(){ze.setUTCSeconds.apply(this._,arguments)},setTime:function(){ze.setTime.apply(this._,arguments)}};var ze=Date.prototype;function Re(t,e,n){function i(e){var n=t(e),i=o(n,1);return e-n<i-e?n:i}function r(n){return e(n=t(new Fe(n-1)),1),n}function o(t,n){return e(t=new Fe(+t),n),t}function s(t,i,o){var s=r(t),a=[];if(o>1)for(;s<i;)n(s)%o||a.push(new Date(+s)),e(s,1);else for(;s<i;)a.push(new Date(+s)),e(s,1);return a}t.floor=t,t.round=i,t.ceil=r,t.offset=o,t.range=s;var a=t.utc=Be(t);return a.floor=a,a.round=Be(i),a.ceil=Be(r),a.offset=Be(o),a.range=function(t,e,n){try{Fe=Le;var i=new Le;return i._=t,s(i,e,n)}finally{Fe=Date}},t}function Be(t){return function(e,n){try{Fe=Le;var i=new Le;return i._=e,t(i,n)._}finally{Fe=Date}}}Ie.year=Re(function(t){return(t=Ie.day(t)).setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),Ie.years=Ie.year.range,Ie.years.utc=Ie.year.utc.range,Ie.day=Re(function(t){var e=new Fe(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),Ie.days=Ie.day.range,Ie.days.utc=Ie.day.utc.range,Ie.dayOfYear=function(t){var e=Ie.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var n=Ie[t]=Re(function(t){return(t=Ie.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=Ie.year(t).getDay();return Math.floor((Ie.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});Ie[t+"s"]=n.range,Ie[t+"s"].utc=n.utc.range,Ie[t+"OfYear"]=function(t){var n=Ie.year(t).getDay();return Math.floor((Ie.dayOfYear(t)+(n+e)%7)/7)}}),Ie.week=Ie.sunday,Ie.weeks=Ie.sunday.range,Ie.weeks.utc=Ie.sunday.utc.range,Ie.weekOfYear=Ie.sundayOfYear;var He={"-":"",_:" ",0:"0"},Ge=/^\s*\d+/,Ve=/^%/;function Ue(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(e)+r:r)}function We(t){return new RegExp("^(?:"+t.map(o.requote).join("|")+")","i")}function Qe(t){for(var e=new k,n=-1,i=t.length;++n<i;)e.set(t[n].toLowerCase(),n);return e}function $e(t,e,n){Ge.lastIndex=0;var i=Ge.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Ke(t,e,n){Ge.lastIndex=0;var i=Ge.exec(e.slice(n));return i?(t.U=+i[0],n+i[0].length):-1}function Je(t,e,n){Ge.lastIndex=0;var i=Ge.exec(e.slice(n));return i?(t.W=+i[0],n+i[0].length):-1}function Ze(t,e,n){Ge.lastIndex=0;var i=Ge.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Ye(t,e,n){Ge.lastIndex=0;var i,r=Ge.exec(e.slice(n,n+2));return r?(t.y=(i=+r[0])+(i>68?1900:2e3),n+r[0].length):-1}function Xe(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function tn(t,e,n){Ge.lastIndex=0;var i=Ge.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function en(t,e,n){Ge.lastIndex=0;var i=Ge.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function nn(t,e,n){Ge.lastIndex=0;var i=Ge.exec(e.slice(n,n+3));return i?(t.j=+i[0],n+i[0].length):-1}function rn(t,e,n){Ge.lastIndex=0;var i=Ge.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function on(t,e,n){Ge.lastIndex=0;var i=Ge.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function sn(t,e,n){Ge.lastIndex=0;var i=Ge.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function an(t,e,n){Ge.lastIndex=0;var i=Ge.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function ln(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",i=w(e)/60|0,r=w(e)%60;return n+Ue(i,"0",2)+Ue(r,"0",2)}function un(t,e,n){Ve.lastIndex=0;var i=Ve.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function cn(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,i=t[n];!i[1](e);)i=t[++n];return i[0](e)}}o.locale=function(t){return{numberFormat:function(t){var e=t.decimal,n=t.thousands,i=t.grouping,r=t.currency,s=i&&n?function(t,e){for(var r=t.length,o=[],s=0,a=i[0],l=0;r>0&&a>0&&(l+a+1>e&&(a=Math.max(1,e-l)),o.push(t.substring(r-=a,r+a)),!((l+=a+1)>e));)a=i[s=(s+1)%i.length];return o.reverse().join(n)}:D;return function(t){var n=Pe.exec(t),i=n[1]||" ",a=n[2]||">",l=n[3]||"-",u=n[4]||"",c=n[5],d=+n[6],h=n[7],p=n[8],f=n[9],g=1,m="",v="",y=!1,b=!0;switch(p&&(p=+p.substring(1)),(c||"0"===i&&"="===a)&&(c=i="0",a="="),f){case"n":h=!0,f="g";break;case"%":g=100,v="%",f="f";break;case"p":g=100,v="%",f="r";break;case"b":case"o":case"x":case"X":"#"===u&&(m="0"+f.toLowerCase());case"c":b=!1;case"d":y=!0,p=0;break;case"s":g=-1,f="r"}"$"===u&&(m=r[0],v=r[1]),"r"!=f||p||(f="g"),null!=p&&("g"==f?p=Math.max(1,Math.min(21,p)):"e"!=f&&"f"!=f||(p=Math.max(0,Math.min(20,p)))),f=je.get(f)||De;var _=c&&h;return function(t){var n=v;if(y&&t%1)return"";var r=t<0||0===t&&1/t<0?(t=-t,"-"):"-"===l?"":l;if(g<0){var u=o.formatPrefix(t,p);t=u.scale(t),n=u.symbol+v}else t*=g;var x,w,A=(t=f(t,p)).lastIndexOf(".");if(A<0){var k=b?t.lastIndexOf("e"):-1;k<0?(x=t,w=""):(x=t.substring(0,k),w=t.substring(k))}else x=t.substring(0,A),w=e+t.substring(A+1);!c&&h&&(x=s(x,1/0));var T=m.length+x.length+w.length+(_?0:r.length),S=T<d?new Array(T=d-T+1).join(i):"";return _&&(x=s(S+x,S.length?d-w.length:1/0)),r+=m,t=x+w,("<"===a?r+t+S:">"===a?S+r+t:"^"===a?S.substring(0,T>>=1)+r+t+S.substring(T):r+(_?t:S+t))+n}}}(t),timeFormat:function(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,s=t.days,a=t.shortDays,l=t.months,u=t.shortMonths;function c(t){var e=t.length;function n(n){for(var i,r,o,s=[],a=-1,l=0;++a<e;)37===t.charCodeAt(a)&&(s.push(t.slice(l,a)),null!=(r=He[i=t.charAt(++a)])&&(i=t.charAt(++a)),(o=x[i])&&(i=o(n,null==r?"e"===i?" ":"0":r)),s.push(i),l=a+1);return s.push(t.slice(l,a)),s.join("")}return n.parse=function(e){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(d(n,t,e,0)!=e.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var i=null!=n.Z&&Fe!==Le,r=new(i?Le:Fe);return"j"in n?r.setFullYear(n.y,0,n.j):"W"in n||"U"in n?("w"in n||(n.w="W"in n?1:0),r.setFullYear(n.y,0,1),r.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(r.getDay()+5)%7:n.w+7*n.U-(r.getDay()+6)%7)):r.setFullYear(n.y,n.m,n.d),r.setHours(n.H+(n.Z/100|0),n.M+n.Z%100,n.S,n.L),i?r._:r},n.toString=function(){return t},n}function d(t,e,n,i){for(var r,o,s,a=0,l=e.length,u=n.length;a<l;){if(i>=u)return-1;if(37===(r=e.charCodeAt(a++))){if(s=e.charAt(a++),!(o=w[s in He?e.charAt(a++):s])||(i=o(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}c.utc=function(t){var e=c(t);function n(t){try{var n=new(Fe=Le);return n._=t,e(n)}finally{Fe=Date}}return n.parse=function(t){try{Fe=Le;var n=e.parse(t);return n&&n._}finally{Fe=Date}},n.toString=e.toString,n},c.multi=c.utc.multi=cn;var h=o.map(),p=We(s),f=Qe(s),g=We(a),m=Qe(a),v=We(l),y=Qe(l),b=We(u),_=Qe(u);r.forEach(function(t,e){h.set(t.toLowerCase(),e)});var x={a:function(t){return a[t.getDay()]},A:function(t){return s[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return l[t.getMonth()]},c:c(e),d:function(t,e){return Ue(t.getDate(),e,2)},e:function(t,e){return Ue(t.getDate(),e,2)},H:function(t,e){return Ue(t.getHours(),e,2)},I:function(t,e){return Ue(t.getHours()%12||12,e,2)},j:function(t,e){return Ue(1+Ie.dayOfYear(t),e,3)},L:function(t,e){return Ue(t.getMilliseconds(),e,3)},m:function(t,e){return Ue(t.getMonth()+1,e,2)},M:function(t,e){return Ue(t.getMinutes(),e,2)},p:function(t){return r[+(t.getHours()>=12)]},S:function(t,e){return Ue(t.getSeconds(),e,2)},U:function(t,e){return Ue(Ie.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return Ue(Ie.mondayOfYear(t),e,2)},x:c(n),X:c(i),y:function(t,e){return Ue(t.getFullYear()%100,e,2)},Y:function(t,e){return Ue(t.getFullYear()%1e4,e,4)},Z:ln,"%":function(){return"%"}},w={a:function(t,e,n){g.lastIndex=0;var i=g.exec(e.slice(n));return i?(t.w=m.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(t,e,n){p.lastIndex=0;var i=p.exec(e.slice(n));return i?(t.w=f.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(t,e,n){b.lastIndex=0;var i=b.exec(e.slice(n));return i?(t.m=_.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(t,e,n){v.lastIndex=0;var i=v.exec(e.slice(n));return i?(t.m=y.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(t,e,n){return d(t,x.c.toString(),e,n)},d:en,e:en,H:rn,I:rn,j:nn,L:an,m:tn,M:on,p:function(t,e,n){var i=h.get(e.slice(n,n+=2).toLowerCase());return null==i?-1:(t.p=i,n)},S:sn,U:Ke,w:$e,W:Je,x:function(t,e,n){return d(t,x.x.toString(),e,n)},X:function(t,e,n){return d(t,x.X.toString(),e,n)},y:Ye,Y:Ze,Z:Xe,"%":un};return c}(t)}};var dn=o.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function hn(){}o.format=dn.numberFormat,o.geo={},hn.prototype={s:0,t:0,add:function(t){fn(t,this.t,pn),fn(pn.s,this.s,this),this.s?this.t+=pn.t:this.s=pn.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var pn=new hn;function fn(t,e,n){var i=n.s=t+e,r=i-t,o=i-r;n.t=t-o+(e-r)}function gn(t,e){t&&vn.hasOwnProperty(t.type)&&vn[t.type](t,e)}o.geo.stream=function(t,e){t&&mn.hasOwnProperty(t.type)?mn[t.type](t,e):gn(t,e)};var mn={Feature:function(t,e){gn(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)gn(n[i].geometry,e)}},vn={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){yn(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)yn(n[i],e,0)},Polygon:function(t,e){bn(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)bn(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)gn(n[i],e)}};function yn(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function bn(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)yn(t[n],e,1);e.polygonEnd()}o.geo.area=function(t){return _n=0,o.geo.stream(t,Pn),_n};var _n,xn,wn,An,kn,Tn,Sn,Mn,En,Nn,On,qn,Cn=new hn,Pn={sphere:function(){_n+=4*Nt},point:z,lineStart:z,lineEnd:z,polygonStart:function(){Cn.reset(),Pn.lineStart=jn},polygonEnd:function(){var t=2*Cn;_n+=t<0?4*Nt+t:t,Pn.lineStart=Pn.lineEnd=Pn.point=z}};function jn(){var t,e,n,i,r;function o(t,e){e=e*Pt/2+Nt/4;var o=(t*=Pt)-n,s=o>=0?1:-1,a=s*o,l=Math.cos(e),u=Math.sin(e),c=r*u,d=i*l+c*Math.cos(a),h=c*s*Math.sin(a);Cn.add(Math.atan2(h,d)),n=t,i=l,r=u}Pn.point=function(s,a){Pn.point=o,n=(t=s)*Pt,i=Math.cos(a=(e=a)*Pt/2+Nt/4),r=Math.sin(a)},Pn.lineEnd=function(){o(t,e)}}function Dn(t){var e=t[0],n=t[1],i=Math.cos(n);return[i*Math.cos(e),i*Math.sin(e),Math.sin(n)]}function In(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Fn(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Ln(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function zn(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Rn(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Bn(t){return[Math.atan2(t[1],t[0]),Lt(t[2])]}function Hn(t,e){return w(t[0]-e[0])<Mt&&w(t[1]-e[1])<Mt}o.geo.bounds=function(){var t,e,n,i,r,s,a,l,u,c,d,h={point:p,lineStart:g,lineEnd:m,polygonStart:function(){h.point=v,h.lineStart=y,h.lineEnd=b,u=0,Pn.polygonStart()},polygonEnd:function(){Pn.polygonEnd(),h.point=p,h.lineStart=g,h.lineEnd=m,Cn<0?(t=-(n=180),e=-(i=90)):u>Mt?i=90:u<-Mt&&(e=-90),d[0]=t,d[1]=n}};function p(r,o){c.push(d=[t=r,n=r]),o<e&&(e=o),o>i&&(i=o)}function f(o,s){var a=Dn([o*Pt,s*Pt]);if(l){var u=Fn(l,a),c=Fn([u[1],-u[0],0],u);Rn(c),c=Bn(c);var d=o-r,h=d>0?1:-1,f=c[0]*jt*h,g=w(d)>180;if(g^(h*r<f&&f<h*o))(m=c[1]*jt)>i&&(i=m);else if(g^(h*r<(f=(f+360)%360-180)&&f<h*o)){var m;(m=-c[1]*jt)<e&&(e=m)}else s<e&&(e=s),s>i&&(i=s);g?o<r?_(t,o)>_(t,n)&&(n=o):_(o,n)>_(t,n)&&(t=o):n>=t?(o<t&&(t=o),o>n&&(n=o)):o>r?_(t,o)>_(t,n)&&(n=o):_(o,n)>_(t,n)&&(t=o)}else p(o,s);l=a,r=o}function g(){h.point=f}function m(){d[0]=t,d[1]=n,h.point=p,l=null}function v(t,e){if(l){var n=t-r;u+=w(n)>180?n+(n>0?360:-360):n}else s=t,a=e;Pn.point(t,e),f(t,e)}function y(){Pn.lineStart()}function b(){v(s,a),Pn.lineEnd(),w(u)>Mt&&(t=-(n=180)),d[0]=t,d[1]=n,l=null}function _(t,e){return(e-=t)<0?e+360:e}function x(t,e){return t[0]-e[0]}function A(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}return function(r){if(i=n=-(t=e=1/0),c=[],o.geo.stream(r,h),u=c.length){c.sort(x);for(var s=1,a=[g=c[0]];s<u;++s)A((p=c[s])[0],g)||A(p[1],g)?(_(g[0],p[1])>_(g[0],g[1])&&(g[1]=p[1]),_(p[0],g[1])>_(g[0],g[1])&&(g[0]=p[0])):a.push(g=p);for(var l,u,p,f=-1/0,g=(s=0,a[u=a.length-1]);s<=u;g=p,++s)p=a[s],(l=_(g[1],p[0]))>f&&(f=l,t=p[0],n=g[1])}return c=d=null,t===1/0||e===1/0?[[NaN,NaN],[NaN,NaN]]:[[t,e],[n,i]]}}(),o.geo.centroid=function(t){xn=wn=An=kn=Tn=Sn=Mn=En=Nn=On=qn=0,o.geo.stream(t,Gn);var e=Nn,n=On,i=qn,r=e*e+n*n+i*i;return r<Et&&(e=Sn,n=Mn,i=En,wn<Mt&&(e=An,n=kn,i=Tn),(r=e*e+n*n+i*i)<Et)?[NaN,NaN]:[Math.atan2(n,e)*jt,Lt(i/Math.sqrt(r))*jt]};var Gn={sphere:z,point:Vn,lineStart:Wn,lineEnd:Qn,polygonStart:function(){Gn.lineStart=$n},polygonEnd:function(){Gn.lineStart=Wn}};function Vn(t,e){t*=Pt;var n=Math.cos(e*=Pt);Un(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function Un(t,e,n){An+=(t-An)/++xn,kn+=(e-kn)/xn,Tn+=(n-Tn)/xn}function Wn(){var t,e,n;function i(i,r){i*=Pt;var o=Math.cos(r*=Pt),s=o*Math.cos(i),a=o*Math.sin(i),l=Math.sin(r),u=Math.atan2(Math.sqrt((u=e*l-n*a)*u+(u=n*s-t*l)*u+(u=t*a-e*s)*u),t*s+e*a+n*l);wn+=u,Sn+=u*(t+(t=s)),Mn+=u*(e+(e=a)),En+=u*(n+(n=l)),Un(t,e,n)}Gn.point=function(r,o){r*=Pt;var s=Math.cos(o*=Pt);t=s*Math.cos(r),e=s*Math.sin(r),n=Math.sin(o),Gn.point=i,Un(t,e,n)}}function Qn(){Gn.point=Vn}function $n(){var t,e,n,i,r;function o(t,e){t*=Pt;var o=Math.cos(e*=Pt),s=o*Math.cos(t),a=o*Math.sin(t),l=Math.sin(e),u=i*l-r*a,c=r*s-n*l,d=n*a-i*s,h=Math.sqrt(u*u+c*c+d*d),p=n*s+i*a+r*l,f=h&&-Ft(p)/h,g=Math.atan2(h,p);Nn+=f*u,On+=f*c,qn+=f*d,wn+=g,Sn+=g*(n+(n=s)),Mn+=g*(i+(i=a)),En+=g*(r+(r=l)),Un(n,i,r)}Gn.point=function(s,a){t=s,e=a,Gn.point=o,s*=Pt;var l=Math.cos(a*=Pt);n=l*Math.cos(s),i=l*Math.sin(s),r=Math.sin(a),Un(n,i,r)},Gn.lineEnd=function(){o(t,e),Gn.lineEnd=Qn,Gn.point=Vn}}function Kn(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n}function Jn(){return!0}function Zn(t,e,n,i,r){var o=[],s=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],i=t[e];if(Hn(n,i)){r.lineStart();for(var a=0;a<e;++a)r.point((n=t[a])[0],n[1]);r.lineEnd()}else{var l=new Xn(n,t,null,!0),u=new Xn(n,null,l,!1);l.o=u,o.push(l),s.push(u),u=new Xn(i,null,l=new Xn(i,t,null,!1),!0),l.o=u,o.push(l),s.push(u)}}}),s.sort(e),Yn(o),Yn(s),o.length){for(var a=0,l=n,u=s.length;a<u;++a)s[a].e=l=!l;for(var c,d,h=o[0];;){for(var p=h,f=!0;p.v;)if((p=p.n)===h)return;c=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(a=0,u=c.length;a<u;++a)r.point((d=c[a])[0],d[1]);else i(p.x,p.n.x,1,r);p=p.n}else{if(f)for(a=(c=p.p.z).length-1;a>=0;--a)r.point((d=c[a])[0],d[1]);else i(p.x,p.p.x,-1,r);p=p.p}c=(p=p.o).z,f=!f}while(!p.v);r.lineEnd()}}}function Yn(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function Xn(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function ti(t,e,n,i){return function(r,s){var a,l=e(s),u=r.invert(i[0],i[1]),c={point:d,lineStart:p,lineEnd:f,polygonStart:function(){c.point=_,c.lineStart=x,c.lineEnd=w,a=[],g=[]},polygonEnd:function(){c.point=d,c.lineStart=p,c.lineEnd=f,a=o.merge(a);var t=function(t,e){var n=t[0],i=t[1],r=[Math.sin(n),-Math.cos(n),0],o=0,s=0;Cn.reset();for(var a=0,l=e.length;a<l;++a){var u=e[a],c=u.length;if(c)for(var d=u[0],h=d[0],p=d[1]/2+Nt/4,f=Math.sin(p),g=Math.cos(p),m=1;;){m===c&&(m=0);var v=(t=u[m])[0],y=t[1]/2+Nt/4,b=Math.sin(y),_=Math.cos(y),x=v-h,w=x>=0?1:-1,A=w*x,k=A>Nt,T=f*b;if(Cn.add(Math.atan2(T*w*Math.sin(A),g*_+T*Math.cos(A))),o+=k?x+w*Ot:x,k^h>=n^v>=n){var S=Fn(Dn(d),Dn(t));Rn(S);var M=Fn(r,S);Rn(M);var E=(k^x>=0?-1:1)*Lt(M[2]);(i>E||i===E&&(S[0]||S[1]))&&(s+=k^x>=0?1:-1)}if(!m++)break;h=v,f=b,g=_,d=t}}return(o<-Mt||o<Mt&&Cn<-Mt)^1&s}(u,g);a.length?(b||(s.polygonStart(),b=!0),Zn(a,ii,t,n,s)):t&&(b||(s.polygonStart(),b=!0),s.lineStart(),n(null,null,1,s),s.lineEnd()),b&&(s.polygonEnd(),b=!1),a=g=null},sphere:function(){s.polygonStart(),s.lineStart(),n(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function d(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&s.point(e,n)}function h(t,e){var n=r(t,e);l.point(n[0],n[1])}function p(){c.point=h,l.lineStart()}function f(){c.point=d,l.lineEnd()}var g,m,v=ni(),y=e(v),b=!1;function _(t,e){m.push([t,e]);var n=r(t,e);y.point(n[0],n[1])}function x(){y.lineStart(),m=[]}function w(){_(m[0][0],m[0][1]),y.lineEnd();var t,e=y.clean(),n=v.buffer(),i=n.length;if(m.pop(),g.push(m),m=null,i)if(1&e){var r,o=-1;if((i=(t=n[0]).length-1)>0){for(b||(s.polygonStart(),b=!0),s.lineStart();++o<i;)s.point((r=t[o])[0],r[1]);s.lineEnd()}}else i>1&&2&e&&n.push(n.pop().concat(n.shift())),a.push(n.filter(ei))}return c}}function ei(t){return t.length>1}function ni(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:z,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function ii(t,e){return((t=t.x)[0]<0?t[1]-Ct-Mt:Ct-t[1])-((e=e.x)[0]<0?e[1]-Ct-Mt:Ct-e[1])}var ri=ti(Jn,function(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?Nt:-Nt,l=w(o-n);w(l-Nt)<Mt?(t.point(n,i=(i+s)/2>0?Ct:-Ct),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),t.point(o,i),e=0):r!==a&&l>=Nt&&(w(n-r)<Mt&&(n-=r*Mt),w(o-a)<Mt&&(o-=a*Mt),i=function(t,e,n,i){var r,o,s=Math.sin(t-n);return w(s)>Mt?Math.atan((Math.sin(e)*(o=Math.cos(i))*Math.sin(n)-Math.sin(i)*(r=Math.cos(e))*Math.sin(t))/(r*o*s)):(e+i)/2}(n,i,o,s),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),e=0),t.point(n=o,i=s),r=a},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}},function(t,e,n,i){var r;if(null==t)r=n*Ct,i.point(-Nt,r),i.point(0,r),i.point(Nt,r),i.point(Nt,0),i.point(Nt,-r),i.point(0,-r),i.point(-Nt,-r),i.point(-Nt,0),i.point(-Nt,r);else if(w(t[0]-e[0])>Mt){var o=t[0]<e[0]?Nt:-Nt;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])},[-Nt,-Nt/2]);function oi(t,e,n,i){return function(r){var o,s=r.a,a=r.b,l=s.x,u=s.y,c=0,d=1,h=a.x-l,p=a.y-u;if(o=t-l,h||!(o>0)){if(o/=h,h<0){if(o<c)return;o<d&&(d=o)}else if(h>0){if(o>d)return;o>c&&(c=o)}if(o=n-l,h||!(o<0)){if(o/=h,h<0){if(o>d)return;o>c&&(c=o)}else if(h>0){if(o<c)return;o<d&&(d=o)}if(o=e-u,p||!(o>0)){if(o/=p,p<0){if(o<c)return;o<d&&(d=o)}else if(p>0){if(o>d)return;o>c&&(c=o)}if(o=i-u,p||!(o<0)){if(o/=p,p<0){if(o>d)return;o>c&&(c=o)}else if(p>0){if(o<c)return;o<d&&(d=o)}return c>0&&(r.a={x:l+c*h,y:u+c*p}),d<1&&(r.b={x:l+d*h,y:u+d*p}),r}}}}}}var si=1e9;function ai(t,e,n,i){return function(l){var u,c,d,h,p,f,g,m,v,y,b,_=l,x=ni(),w=oi(t,e,n,i),A={point:S,lineStart:function(){A.point=M,c&&c.push(d=[]),y=!0,v=!1,g=m=NaN},lineEnd:function(){u&&(M(h,p),f&&v&&x.rejoin(),u.push(x.buffer())),A.point=S,v&&l.lineEnd()},polygonStart:function(){l=x,u=[],c=[],b=!0},polygonEnd:function(){l=_,u=o.merge(u);var e=function(t){for(var e=0,n=c.length,i=t[1],r=0;r<n;++r)for(var o,s=1,a=c[r],l=a.length,u=a[0];s<l;++s)o=a[s],u[1]<=i?o[1]>i&&It(u,o,t)>0&&++e:o[1]<=i&&It(u,o,t)<0&&--e,u=o;return 0!==e}([t,i]),n=b&&e,r=u.length;(n||r)&&(l.polygonStart(),n&&(l.lineStart(),k(null,null,1,l),l.lineEnd()),r&&Zn(u,s,e,k,l),l.polygonEnd()),u=c=d=null}};function k(o,s,l,u){var c=0,d=0;if(null==o||(c=r(o,l))!==(d=r(s,l))||a(o,s)<0^l>0)do{u.point(0===c||3===c?t:n,c>1?i:e)}while((c=(c+l+4)%4)!==d);else u.point(s[0],s[1])}function T(r,o){return t<=r&&r<=n&&e<=o&&o<=i}function S(t,e){T(t,e)&&l.point(t,e)}function M(t,e){var n=T(t=Math.max(-si,Math.min(si,t)),e=Math.max(-si,Math.min(si,e)));if(c&&d.push([t,e]),y)h=t,p=e,f=n,y=!1,n&&(l.lineStart(),l.point(t,e));else if(n&&v)l.point(t,e);else{var i={a:{x:g,y:m},b:{x:t,y:e}};w(i)?(v||(l.lineStart(),l.point(i.a.x,i.a.y)),l.point(i.b.x,i.b.y),n||l.lineEnd(),b=!1):n&&(l.lineStart(),l.point(t,e),b=!1)}g=t,m=e,v=n}return A};function r(i,r){return w(i[0]-t)<Mt?r>0?0:3:w(i[0]-n)<Mt?r>0?2:1:w(i[1]-e)<Mt?r>0?1:0:r>0?3:2}function s(t,e){return a(t.x,e.x)}function a(t,e){var n=r(t,1),i=r(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}}function li(t){var e=0,n=Nt/3,i=Oi(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*Nt/180,n=t[1]*Nt/180):[e/Nt*180,n/Nt*180]},r}function ui(t,e){var n=Math.sin(t),i=(n+Math.sin(e))/2,r=1+n*(2*i-n),o=Math.sqrt(r)/i;function s(t,e){var n=Math.sqrt(r-2*i*Math.sin(e))/i;return[n*Math.sin(t*=i),o-n*Math.cos(t)]}return s.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/i,Lt((r-(t*t+n*n)*i*i)/(2*i))]},s}o.geo.clipExtent=function(){var t,e,n,i,r,o,s={stream:function(t){return r&&(r.valid=!1),(r=o(t)).valid=!0,r},extent:function(a){return arguments.length?(o=ai(t=+a[0][0],e=+a[0][1],n=+a[1][0],i=+a[1][1]),r&&(r.valid=!1,r=null),s):[[t,e],[n,i]]}};return s.extent([[0,0],[960,500]])},(o.geo.conicEqualArea=function(){return li(ui)}).raw=ui,o.geo.albers=function(){return o.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},o.geo.albersUsa=function(){var t,e,n,i,r=o.geo.albers(),s=o.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a=o.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(e,n){t=[e,n]}};function u(r){var o=r[0],s=r[1];return t=null,e(o,s),t||(n(o,s),t)||i(o,s),t}return u.invert=function(t){var e=r.scale(),n=r.translate(),i=(t[0]-n[0])/e,o=(t[1]-n[1])/e;return(o>=.12&&o<.234&&i>=-.425&&i<-.214?s:o>=.166&&o<.234&&i>=-.214&&i<-.115?a:r).invert(t)},u.stream=function(t){var e=r.stream(t),n=s.stream(t),i=a.stream(t);return{point:function(t,r){e.point(t,r),n.point(t,r),i.point(t,r)},sphere:function(){e.sphere(),n.sphere(),i.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),i.polygonEnd()}}},u.precision=function(t){return arguments.length?(r.precision(t),s.precision(t),a.precision(t),u):r.precision()},u.scale=function(t){return arguments.length?(r.scale(t),s.scale(.35*t),a.scale(t),u.translate(r.translate())):r.scale()},u.translate=function(t){if(!arguments.length)return r.translate();var o=r.scale(),c=+t[0],d=+t[1];return e=r.translate(t).clipExtent([[c-.455*o,d-.238*o],[c+.455*o,d+.238*o]]).stream(l).point,n=s.translate([c-.307*o,d+.201*o]).clipExtent([[c-.425*o+Mt,d+.12*o+Mt],[c-.214*o-Mt,d+.234*o-Mt]]).stream(l).point,i=a.translate([c-.205*o,d+.212*o]).clipExtent([[c-.214*o+Mt,d+.166*o+Mt],[c-.115*o-Mt,d+.234*o-Mt]]).stream(l).point,u},u.scale(1070)};var ci,di,hi,pi,fi,gi,mi={point:z,lineStart:z,lineEnd:z,polygonStart:function(){di=0,mi.lineStart=vi},polygonEnd:function(){mi.lineStart=mi.lineEnd=mi.point=z,ci+=w(di/2)}};function vi(){var t,e,n,i;function r(t,e){di+=i*t-n*e,n=t,i=e}mi.point=function(o,s){mi.point=r,t=n=o,e=i=s},mi.lineEnd=function(){r(t,e)}}var yi={point:function(t,e){t<hi&&(hi=t),t>fi&&(fi=t),e<pi&&(pi=e),e>gi&&(gi=e)},lineStart:z,lineEnd:z,polygonStart:z,polygonEnd:z};function bi(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}var _i,xi={point:wi,lineStart:Ai,lineEnd:ki,polygonStart:function(){xi.lineStart=Ti},polygonEnd:function(){xi.point=wi,xi.lineStart=Ai,xi.lineEnd=ki}};function wi(t,e){An+=t,kn+=e,++Tn}function Ai(){var t,e;function n(n,i){var r=n-t,o=i-e,s=Math.sqrt(r*r+o*o);Sn+=s*(t+n)/2,Mn+=s*(e+i)/2,En+=s,wi(t=n,e=i)}xi.point=function(i,r){xi.point=n,wi(t=i,e=r)}}function ki(){xi.point=wi}function Ti(){var t,e,n,i;function r(t,e){var r=t-n,o=e-i,s=Math.sqrt(r*r+o*o);Sn+=s*(n+t)/2,Mn+=s*(i+e)/2,En+=s,Nn+=(s=i*t-n*e)*(n+t),On+=s*(i+e),qn+=3*s,wi(n=t,i=e)}xi.point=function(o,s){xi.point=r,wi(t=n=o,e=i=s)},xi.lineEnd=function(){r(t,e)}}function Si(t){var e=.5,n=Math.cos(30*Pt),i=16;function r(e){return(i?function(e){var n,r,s,a,l,u,c,d,h,p,f,g,m={point:v,lineStart:y,lineEnd:_,polygonStart:function(){e.polygonStart(),m.lineStart=x},polygonEnd:function(){e.polygonEnd(),m.lineStart=y}};function v(n,i){n=t(n,i),e.point(n[0],n[1])}function y(){d=NaN,m.point=b,e.lineStart()}function b(n,r){var s=Dn([n,r]),a=t(n,r);o(d,h,c,p,f,g,d=a[0],h=a[1],c=n,p=s[0],f=s[1],g=s[2],i,e),e.point(d,h)}function _(){m.point=v,e.lineEnd()}function x(){y(),m.point=w,m.lineEnd=A}function w(t,e){b(n=t,e),r=d,s=h,a=p,l=f,u=g,m.point=b}function A(){o(d,h,c,p,f,g,r,s,n,a,l,u,i,e),m.lineEnd=_,_()}return m}:function(e){return Ei(e,function(n,i){n=t(n,i),e.point(n[0],n[1])})})(e)}function o(i,r,s,a,l,u,c,d,h,p,f,g,m,v){var y=c-i,b=d-r,_=y*y+b*b;if(_>4*e&&m--){var x=a+p,A=l+f,k=u+g,T=Math.sqrt(x*x+A*A+k*k),S=Math.asin(k/=T),M=w(w(k)-1)<Mt||w(s-h)<Mt?(s+h)/2:Math.atan2(A,x),E=t(M,S),N=E[0],O=E[1],q=N-i,C=O-r,P=b*q-y*C;(P*P/_>e||w((y*q+b*C)/_-.5)>.3||a*p+l*f+u*g<n)&&(o(i,r,s,a,l,u,N,O,M,x/=T,A/=T,k,m,v),v.point(N,O),o(N,O,M,x,A,k,c,d,h,p,f,g,m,v))}}return r.precision=function(t){return arguments.length?(i=(e=t*t)>0&&16,r):Math.sqrt(e)},r}function Mi(t){this.stream=t}function Ei(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function Ni(t){return Oi(function(){return t})()}function Oi(t){var e,n,i,r,s,a,l=Si(function(t,n){return[(t=e(t,n))[0]*u+r,s-t[1]*u]}),u=150,c=480,d=250,h=0,p=0,f=0,g=0,m=0,v=ri,y=D,b=null,_=null;function x(t){return[(t=i(t[0]*Pt,t[1]*Pt))[0]*u+r,s-t[1]*u]}function A(t){return(t=i.invert((t[0]-r)/u,(s-t[1])/u))&&[t[0]*jt,t[1]*jt]}function k(){i=Kn(n=ji(f,g,m),e);var t=e(h,p);return r=c-t[0]*u,s=d+t[1]*u,T()}function T(){return a&&(a.valid=!1,a=null),x}return x.stream=function(t){return a&&(a.valid=!1),(a=qi(v(n,l(y(t))))).valid=!0,a},x.clipAngle=function(t){return arguments.length?(v=null==t?(b=t,ri):function(t){var e=Math.cos(t),n=e>0,i=w(e)>Mt;return ti(r,function(t){var e,a,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(d,h){var p,f=[d,h],g=r(d,h),m=n?g?0:s(d,h):g?s(d+(d<0?Nt:-Nt),h):0;if(!e&&(u=l=g)&&t.lineStart(),g!==l&&(p=o(e,f),(Hn(e,p)||Hn(f,p))&&(f[0]+=Mt,f[1]+=Mt,g=r(f[0],f[1]))),g!==l)c=0,g?(t.lineStart(),p=o(f,e),t.point(p[0],p[1])):(p=o(e,f),t.point(p[0],p[1]),t.lineEnd()),e=p;else if(i&&e&&n^g){var v;m&a||!(v=o(f,e,!0))||(c=0,n?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1])))}!g||e&&Hn(e,f)||t.point(f[0],f[1]),e=f,l=g,a=m},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}},Li(t,6*Pt),n?[0,-t]:[-Nt,t-Nt]);function r(t,n){return Math.cos(t)*Math.cos(n)>e}function o(t,n,i){var r=[1,0,0],o=Fn(Dn(t),Dn(n)),s=In(o,o),a=o[0],l=s-a*a;if(!l)return!i&&t;var u=e*s/l,c=-e*a/l,d=Fn(r,o),h=zn(r,u);Ln(h,zn(o,c));var p=d,f=In(h,p),g=In(p,p),m=f*f-g*(In(h,h)-1);if(!(m<0)){var v=Math.sqrt(m),y=zn(p,(-f-v)/g);if(Ln(y,h),y=Bn(y),!i)return y;var b,_=t[0],x=n[0],A=t[1],k=n[1];x<_&&(b=_,_=x,x=b);var T=x-_,S=w(T-Nt)<Mt;if(!S&&k<A&&(b=A,A=k,k=b),S||T<Mt?S?A+k>0^y[1]<(w(y[0]-_)<Mt?A:k):A<=y[1]&&y[1]<=k:T>Nt^(_<=y[0]&&y[0]<=x)){var M=zn(p,(-f+v)/g);return Ln(M,h),[y,Bn(M)]}}}function s(e,i){var r=n?t:Nt-t,o=0;return e<-r?o|=1:e>r&&(o|=2),i<-r?o|=4:i>r&&(o|=8),o}}((b=+t)*Pt),T()):b},x.clipExtent=function(t){return arguments.length?(_=t,y=t?ai(t[0][0],t[0][1],t[1][0],t[1][1]):D,T()):_},x.scale=function(t){return arguments.length?(u=+t,k()):u},x.translate=function(t){return arguments.length?(c=+t[0],d=+t[1],k()):[c,d]},x.center=function(t){return arguments.length?(h=t[0]%360*Pt,p=t[1]%360*Pt,k()):[h*jt,p*jt]},x.rotate=function(t){return arguments.length?(f=t[0]%360*Pt,g=t[1]%360*Pt,m=t.length>2?t[2]%360*Pt:0,k()):[f*jt,g*jt,m*jt]},o.rebind(x,l,"precision"),function(){return e=t.apply(this,arguments),x.invert=e.invert&&A,k()}}function qi(t){return Ei(t,function(e,n){t.point(e*Pt,n*Pt)})}function Ci(t,e){return[t,e]}function Pi(t,e){return[t>Nt?t-Ot:t<-Nt?t+Ot:t,e]}function ji(t,e,n){return t?e||n?Kn(Ii(t),Fi(e,n)):Ii(t):e||n?Fi(e,n):Pi}function Di(t){return function(e,n){return[(e+=t)>Nt?e-Ot:e<-Nt?e+Ot:e,n]}}function Ii(t){var e=Di(t);return e.invert=Di(-t),e}function Fi(t,e){var n=Math.cos(t),i=Math.sin(t),r=Math.cos(e),o=Math.sin(e);function s(t,e){var s=Math.cos(e),a=Math.cos(t)*s,l=Math.sin(t)*s,u=Math.sin(e),c=u*n+a*i;return[Math.atan2(l*r-c*o,a*n-u*i),Lt(c*r+l*o)]}return s.invert=function(t,e){var s=Math.cos(e),a=Math.cos(t)*s,l=Math.sin(t)*s,u=Math.sin(e),c=u*r-l*o;return[Math.atan2(l*r+u*o,a*n+c*i),Lt(c*n-a*i)]},s}function Li(t,e){var n=Math.cos(t),i=Math.sin(t);return function(r,o,s,a){var l=s*e;null!=r?(r=zi(n,r),o=zi(n,o),(s>0?r<o:r>o)&&(r+=s*Ot)):(r=t+s*Ot,o=t-.5*l);for(var u,c=r;s>0?c>o:c<o;c-=l)a.point((u=Bn([n,-i*Math.cos(c),-i*Math.sin(c)]))[0],u[1])}}function zi(t,e){var n=Dn(e);n[0]-=t,Rn(n);var i=Ft(-n[1]);return((-n[2]<0?-i:i)+2*Math.PI-Mt)%(2*Math.PI)}function Ri(t,e,n){var i=o.range(t,e-Mt,n).concat(e);return function(t){return i.map(function(e){return[t,e]})}}function Bi(t,e,n){var i=o.range(t,e-Mt,n).concat(e);return function(t){return i.map(function(e){return[e,t]})}}function Hi(t){return t.source}function Gi(t){return t.target}o.geo.path=function(){var t,e,n,i,r,s=4.5;function a(t){return t&&("function"==typeof s&&i.pointRadius(+s.apply(this,arguments)),r&&r.valid||(r=n(i)),o.geo.stream(t,r)),i.result()}function l(){return r=null,a}return a.area=function(t){return ci=0,o.geo.stream(t,n(mi)),ci},a.centroid=function(t){return An=kn=Tn=Sn=Mn=En=Nn=On=qn=0,o.geo.stream(t,n(xi)),qn?[Nn/qn,On/qn]:En?[Sn/En,Mn/En]:Tn?[An/Tn,kn/Tn]:[NaN,NaN]},a.bounds=function(t){return fi=gi=-(hi=pi=1/0),o.geo.stream(t,n(yi)),[[hi,pi],[fi,gi]]},a.projection=function(e){return arguments.length?(n=(t=e)?e.stream||(i=e,r=Si(function(t,e){return i([t*jt,e*jt])}),function(t){return qi(r(t))}):D,l()):t;var i,r},a.context=function(t){return arguments.length?(i=null==(e=t)?new function(){var t=bi(4.5),e=[],n={point:i,lineStart:function(){n.point=r},lineEnd:s,polygonStart:function(){n.lineEnd=a},polygonEnd:function(){n.lineEnd=s,n.point=i},pointRadius:function(e){return t=bi(e),n},result:function(){if(e.length){var t=e.join("");return e=[],t}}};function i(n,i){e.push("M",n,",",i,t)}function r(t,i){e.push("M",t,",",i),n.point=o}function o(t,n){e.push("L",t,",",n)}function s(){n.point=i}function a(){e.push("Z")}return n}:new function(t){var e=4.5,n={point:i,lineStart:function(){n.point=r},lineEnd:s,polygonStart:function(){n.lineEnd=a},polygonEnd:function(){n.lineEnd=s,n.point=i},pointRadius:function(t){return e=t,n},result:z};function i(n,i){t.moveTo(n+e,i),t.arc(n,i,e,0,Ot)}function r(e,i){t.moveTo(e,i),n.point=o}function o(e,n){t.lineTo(e,n)}function s(){n.point=i}function a(){t.closePath()}return n}(t),"function"!=typeof s&&i.pointRadius(s),l()):e},a.pointRadius=function(t){return arguments.length?(s="function"==typeof t?t:(i.pointRadius(+t),+t),a):s},a.projection(o.geo.albersUsa()).context(null)},o.geo.transform=function(t){return{stream:function(e){var n=new Mi(e);for(var i in t)n[i]=t[i];return n}}},Mi.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},o.geo.projection=Ni,o.geo.projectionMutator=Oi,(o.geo.equirectangular=function(){return Ni(Ci)}).raw=Ci.invert=Ci,o.geo.rotation=function(t){function e(e){return(e=t(e[0]*Pt,e[1]*Pt))[0]*=jt,e[1]*=jt,e}return t=ji(t[0]%360*Pt,t[1]*Pt,t.length>2?t[2]*Pt:0),e.invert=function(e){return(e=t.invert(e[0]*Pt,e[1]*Pt))[0]*=jt,e[1]*=jt,e},e},Pi.invert=Ci,o.geo.circle=function(){var t,e,n=[0,0],i=6;function r(){var t="function"==typeof n?n.apply(this,arguments):n,i=ji(-t[0]*Pt,-t[1]*Pt,0).invert,r=[];return e(null,null,1,{point:function(t,e){r.push(t=i(t,e)),t[0]*=jt,t[1]*=jt}}),{type:"Polygon",coordinates:[r]}}return r.origin=function(t){return arguments.length?(n=t,r):n},r.angle=function(n){return arguments.length?(e=Li((t=+n)*Pt,i*Pt),r):t},r.precision=function(n){return arguments.length?(e=Li(t*Pt,(i=+n)*Pt),r):i},r.angle(90)},o.geo.distance=function(t,e){var n,i=(e[0]-t[0])*Pt,r=t[1]*Pt,o=e[1]*Pt,s=Math.sin(i),a=Math.cos(i),l=Math.sin(r),u=Math.cos(r),c=Math.sin(o),d=Math.cos(o);return Math.atan2(Math.sqrt((n=d*s)*n+(n=u*c-l*d*a)*n),l*c+u*d*a)},o.geo.graticule=function(){var t,e,n,i,r,s,a,l,u,c,d,h,p=10,f=p,g=90,m=360,v=2.5;function y(){return{type:"MultiLineString",coordinates:b()}}function b(){return o.range(Math.ceil(i/g)*g,n,g).map(d).concat(o.range(Math.ceil(l/m)*m,a,m).map(h)).concat(o.range(Math.ceil(e/p)*p,t,p).filter(function(t){return w(t%g)>Mt}).map(u)).concat(o.range(Math.ceil(s/f)*f,r,f).filter(function(t){return w(t%m)>Mt}).map(c))}return y.lines=function(){return b().map(function(t){return{type:"LineString",coordinates:t}})},y.outline=function(){return{type:"Polygon",coordinates:[d(i).concat(h(a).slice(1),d(n).reverse().slice(1),h(l).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.majorExtent(t).minorExtent(t):y.minorExtent()},y.majorExtent=function(t){return arguments.length?(i=+t[0][0],n=+t[1][0],l=+t[0][1],a=+t[1][1],i>n&&(t=i,i=n,n=t),l>a&&(t=l,l=a,a=t),y.precision(v)):[[i,l],[n,a]]},y.minorExtent=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],s=+n[0][1],r=+n[1][1],e>t&&(n=e,e=t,t=n),s>r&&(n=s,s=r,r=n),y.precision(v)):[[e,s],[t,r]]},y.step=function(t){return arguments.length?y.majorStep(t).minorStep(t):y.minorStep()},y.majorStep=function(t){return arguments.length?(g=+t[0],m=+t[1],y):[g,m]},y.minorStep=function(t){return arguments.length?(p=+t[0],f=+t[1],y):[p,f]},y.precision=function(o){return arguments.length?(v=+o,u=Ri(s,r,90),c=Bi(e,t,v),d=Ri(l,a,90),h=Bi(i,n,v),y):v},y.majorExtent([[-180,-90+Mt],[180,90-Mt]]).minorExtent([[-180,-80-Mt],[180,80+Mt]])},o.geo.greatArc=function(){var t,e,n=Hi,i=Gi;function r(){return{type:"LineString",coordinates:[t||n.apply(this,arguments),e||i.apply(this,arguments)]}}return r.distance=function(){return o.geo.distance(t||n.apply(this,arguments),e||i.apply(this,arguments))},r.source=function(e){return arguments.length?(n=e,t="function"==typeof e?null:e,r):n},r.target=function(t){return arguments.length?(i=t,e="function"==typeof t?null:t,r):i},r.precision=function(){return arguments.length?r:0},r},o.geo.interpolate=function(t,e){return n=t[0]*Pt,i=t[1]*Pt,r=e[0]*Pt,o=e[1]*Pt,s=Math.cos(i),a=Math.sin(i),l=Math.cos(o),u=Math.sin(o),c=s*Math.cos(n),d=s*Math.sin(n),h=l*Math.cos(r),p=l*Math.sin(r),f=2*Math.asin(Math.sqrt(Rt(o-i)+s*l*Rt(r-n))),g=1/Math.sin(f),(m=f?function(t){var e=Math.sin(t*=f)*g,n=Math.sin(f-t)*g,i=n*c+e*h,r=n*d+e*p,o=n*a+e*u;return[Math.atan2(r,i)*jt,Math.atan2(o,Math.sqrt(i*i+r*r))*jt]}:function(){return[n*jt,i*jt]}).distance=f,m;var n,i,r,o,s,a,l,u,c,d,h,p,f,g,m},o.geo.length=function(t){return _i=0,o.geo.stream(t,Vi),_i};var Vi={sphere:z,point:z,lineStart:function(){var t,e,n;function i(i,r){var o=Math.sin(r*=Pt),s=Math.cos(r),a=w((i*=Pt)-t),l=Math.cos(a);_i+=Math.atan2(Math.sqrt((a=s*Math.sin(a))*a+(a=n*o-e*s*l)*a),e*o+n*s*l),t=i,e=o,n=s}Vi.point=function(r,o){t=r*Pt,e=Math.sin(o*=Pt),n=Math.cos(o),Vi.point=i},Vi.lineEnd=function(){Vi.point=Vi.lineEnd=z}},lineEnd:z,polygonStart:z,polygonEnd:z};function Ui(t,e){function n(e,n){var i=Math.cos(e),r=Math.cos(n),o=t(i*r);return[o*r*Math.sin(e),o*Math.sin(n)]}return n.invert=function(t,n){var i=Math.sqrt(t*t+n*n),r=e(i),o=Math.sin(r),s=Math.cos(r);return[Math.atan2(t*o,i*s),Math.asin(i&&n*o/i)]},n}var Wi=Ui(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(o.geo.azimuthalEqualArea=function(){return Ni(Wi)}).raw=Wi;var Qi=Ui(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},D);function $i(t,e){var n=Math.cos(t),i=function(t){return Math.tan(Nt/4+t/2)},r=t===e?Math.sin(t):Math.log(n/Math.cos(e))/Math.log(i(e)/i(t)),o=n*Math.pow(i(t),r)/r;if(!r)return Zi;function s(t,e){o>0?e<-Ct+Mt&&(e=-Ct+Mt):e>Ct-Mt&&(e=Ct-Mt);var n=o/Math.pow(i(e),r);return[n*Math.sin(r*t),o-n*Math.cos(r*t)]}return s.invert=function(t,e){var n=o-e,i=Dt(r)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/r,2*Math.atan(Math.pow(o/i,1/r))-Ct]},s}function Ki(t,e){var n=Math.cos(t),i=t===e?Math.sin(t):(n-Math.cos(e))/(e-t),r=n/i+t;if(w(i)<Mt)return Ci;function o(t,e){var n=r-e;return[n*Math.sin(i*t),r-n*Math.cos(i*t)]}return o.invert=function(t,e){var n=r-e;return[Math.atan2(t,n)/i,r-Dt(i)*Math.sqrt(t*t+n*n)]},o}(o.geo.azimuthalEquidistant=function(){return Ni(Qi)}).raw=Qi,(o.geo.conicConformal=function(){return li($i)}).raw=$i,(o.geo.conicEquidistant=function(){return li(Ki)}).raw=Ki;var Ji=Ui(function(t){return 1/t},Math.atan);function Zi(t,e){return[t,Math.log(Math.tan(Nt/4+e/2))]}function Yi(t){var e,n=Ni(t),i=n.scale,r=n.translate,o=n.clipExtent;return n.scale=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var s=o.apply(n,arguments);if(s===n){if(e=null==t){var a=Nt*i(),l=r();o([[l[0]-a,l[1]-a],[l[0]+a,l[1]+a]])}}else e&&(s=null);return s},n.clipExtent(null)}(o.geo.gnomonic=function(){return Ni(Ji)}).raw=Ji,Zi.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Ct]},(o.geo.mercator=function(){return Yi(Zi)}).raw=Zi;var Xi=Ui(function(){return 1},Math.asin);(o.geo.orthographic=function(){return Ni(Xi)}).raw=Xi;var tr=Ui(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});function er(t,e){return[Math.log(Math.tan(Nt/4+e/2)),-t]}function nr(t){return t[0]}function ir(t){return t[1]}function rr(t){for(var e=t.length,n=[0,1],i=2,r=2;r<e;r++){for(;i>1&&It(t[n[i-2]],t[n[i-1]],t[r])<=0;)--i;n[i++]=r}return n.slice(0,i)}function or(t,e){return t[0]-e[0]||t[1]-e[1]}(o.geo.stereographic=function(){return Ni(tr)}).raw=tr,er.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-Ct]},(o.geo.transverseMercator=function(){var t=Yi(er),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90])}).raw=er,o.geom={},o.geom.hull=function(t){var e=nr,n=ir;if(arguments.length)return i(t);function i(t){if(t.length<3)return[];var i,r=be(e),o=be(n),s=t.length,a=[],l=[];for(i=0;i<s;i++)a.push([+r.call(this,t[i],i),+o.call(this,t[i],i),i]);for(a.sort(or),i=0;i<s;i++)l.push([a[i][0],-a[i][1]]);var u=rr(a),c=rr(l),d=c[0]===u[0],h=c[c.length-1]===u[u.length-1],p=[];for(i=u.length-1;i>=0;--i)p.push(t[a[u[i]][2]]);for(i=+d;i<c.length-h;++i)p.push(t[a[c[i]][2]]);return p}return i.x=function(t){return arguments.length?(e=t,i):e},i.y=function(t){return arguments.length?(n=t,i):n},i},o.geom.polygon=function(t){return W(t,sr),t};var sr=o.geom.polygon.prototype=[];function ar(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function lr(t,e,n,i){var r=t[0],o=n[0],s=e[0]-r,a=i[0]-o,l=t[1],u=n[1],c=e[1]-l,d=i[1]-u,h=(a*(l-u)-d*(r-o))/(d*s-a*c);return[r+h*s,l+h*c]}function ur(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}sr.area=function(){for(var t,e=-1,n=this.length,i=this[n-1],r=0;++e<n;)t=i,i=this[e],r+=t[1]*i[0]-t[0]*i[1];return.5*r},sr.centroid=function(t){var e,n,i=-1,r=this.length,o=0,s=0,a=this[r-1];for(arguments.length||(t=-1/(6*this.area()));++i<r;)e=a,a=this[i],n=e[0]*a[1]-a[0]*e[1],o+=(e[0]+a[0])*n,s+=(e[1]+a[1])*n;return[o*t,s*t]},sr.clip=function(t){for(var e,n,i,r,o,s,a=ur(t),l=-1,u=this.length-ur(this),c=this[u-1];++l<u;){for(e=t.slice(),t.length=0,r=this[l],o=e[(i=e.length-a)-1],n=-1;++n<i;)ar(s=e[n],c,r)?(ar(o,c,r)||t.push(lr(o,s,c,r)),t.push(s)):ar(o,c,r)&&t.push(lr(o,s,c,r)),o=s;a&&t.push(t[0]),c=r}return t};var cr,dr,hr,pr,fr,gr=[],mr=[];function vr(t){var e=gr.pop()||new function(){Pr(this),this.edge=this.site=this.circle=null};return e.site=t,e}function yr(t){Sr(t),hr.remove(t),gr.push(t),Pr(t)}function br(t){var e=t.circle,n=e.x,i=e.cy,r={x:n,y:i},o=t.P,s=t.N,a=[t];yr(t);for(var l=o;l.circle&&w(n-l.circle.x)<Mt&&w(i-l.circle.cy)<Mt;)o=l.P,a.unshift(l),yr(l),l=o;a.unshift(l),Sr(l);for(var u=s;u.circle&&w(n-u.circle.x)<Mt&&w(i-u.circle.cy)<Mt;)s=u.N,a.push(u),yr(u),u=s;a.push(u),Sr(u);var c,d=a.length;for(c=1;c<d;++c)u=a[c],l=a[c-1],Or(u.edge,l.site,u.site,r);l=a[0],(u=a[d-1]).edge=Nr(l.site,u.site,null,r),Tr(l),Tr(u)}function _r(t){for(var e,n,i,r,o=t.x,s=t.y,a=hr._;a;)if((i=xr(a,s)-o)>Mt)a=a.L;else{if(!((r=o-wr(a,s))>Mt)){i>-Mt?(e=a.P,n=a):r>-Mt?(e=a,n=a.N):e=n=a;break}if(!a.R){e=a;break}a=a.R}var l=vr(t);if(hr.insert(e,l),e||n){if(e===n)return Sr(e),n=vr(e.site),hr.insert(l,n),l.edge=n.edge=Nr(e.site,l.site),Tr(e),void Tr(n);if(n){Sr(e),Sr(n);var u=e.site,c=u.x,d=u.y,h=t.x-c,p=t.y-d,f=n.site,g=f.x-c,m=f.y-d,v=2*(h*m-p*g),y=h*h+p*p,b=g*g+m*m,_={x:(m*y-p*b)/v+c,y:(h*b-g*y)/v+d};Or(n.edge,u,f,_),l.edge=Nr(u,t,null,_),n.edge=Nr(t,f,null,_),Tr(e),Tr(n)}else l.edge=Nr(e.site,l.site)}}function xr(t,e){var n=t.site,i=n.x,r=n.y,o=r-e;if(!o)return i;var s=t.P;if(!s)return-1/0;var a=(n=s.site).x,l=n.y,u=l-e;if(!u)return a;var c=a-i,d=1/o-1/u,h=c/u;return d?(-h+Math.sqrt(h*h-2*d*(c*c/(-2*u)-l+u/2+r-o/2)))/d+i:(i+a)/2}function wr(t,e){var n=t.N;if(n)return xr(n,e);var i=t.site;return i.y===e?i.x:1/0}function Ar(t){this.site=t,this.edges=[]}function kr(t,e){return e.angle-t.angle}function Tr(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,o=n.site;if(i!==o){var s=r.x,a=r.y,l=i.x-s,u=i.y-a,c=o.x-s,d=2*(l*(m=o.y-a)-u*c);if(!(d>=-Et)){var h=l*l+u*u,p=c*c+m*m,f=(m*h-u*p)/d,g=(l*p-c*h)/d,m=g+a,v=mr.pop()||new function(){Pr(this),this.x=this.y=this.arc=this.site=this.cy=null};v.arc=t,v.site=r,v.x=f+s,v.y=m+Math.sqrt(f*f+g*g),v.cy=m,t.circle=v;for(var y=null,b=fr._;b;)if(v.y<b.y||v.y===b.y&&v.x<=b.x){if(!b.L){y=b.P;break}b=b.L}else{if(!b.R){y=b;break}b=b.R}fr.insert(y,v),y||(pr=v)}}}}function Sr(t){var e=t.circle;e&&(e.P||(pr=e.N),fr.remove(e),mr.push(e),Pr(e),t.circle=null)}function Mr(t,e){var n=t.b;if(n)return!0;var i,r,o=t.a,s=e[0][0],a=e[1][0],l=e[0][1],u=e[1][1],c=t.l,d=t.r,h=c.x,p=c.y,f=d.x,g=d.y,m=(h+f)/2,v=(p+g)/2;if(g===p){if(m<s||m>=a)return;if(h>f){if(o){if(o.y>=u)return}else o={x:m,y:l};n={x:m,y:u}}else{if(o){if(o.y<l)return}else o={x:m,y:u};n={x:m,y:l}}}else if(r=v-(i=(h-f)/(g-p))*m,i<-1||i>1)if(h>f){if(o){if(o.y>=u)return}else o={x:(l-r)/i,y:l};n={x:(u-r)/i,y:u}}else{if(o){if(o.y<l)return}else o={x:(u-r)/i,y:u};n={x:(l-r)/i,y:l}}else if(p<g){if(o){if(o.x>=a)return}else o={x:s,y:i*s+r};n={x:a,y:i*a+r}}else{if(o){if(o.x<s)return}else o={x:a,y:i*a+r};n={x:s,y:i*s+r}}return t.a=o,t.b=n,!0}function Er(t,e){this.l=t,this.r=e,this.a=this.b=null}function Nr(t,e,n,i){var r=new Er(t,e);return cr.push(r),n&&Or(r,t,e,n),i&&Or(r,e,t,i),dr[t.i].edges.push(new qr(r,t,e)),dr[e.i].edges.push(new qr(r,e,t)),r}function Or(t,e,n,i){t.a||t.b?t.l===n?t.b=i:t.a=i:(t.a=i,t.l=e,t.r=n)}function qr(t,e,n){var i=t.a,r=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(r.x-i.x,i.y-r.y):Math.atan2(i.x-r.x,r.y-i.y)}function Cr(){this._=null}function Pr(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function jr(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function Dr(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function Ir(t){for(;t.L;)t=t.L;return t}function Fr(t,e){var n,i,r,o=t.sort(Lr).pop();for(cr=[],dr=new Array(t.length),hr=new Cr,fr=new Cr;;)if(r=pr,o&&(!r||o.y<r.y||o.y===r.y&&o.x<r.x))o.x===n&&o.y===i||(dr[o.i]=new Ar(o),_r(o),n=o.x,i=o.y),o=t.pop();else{if(!r)break;br(r.arc)}e&&(function(t){for(var e,n=cr,i=oi(t[0][0],t[0][1],t[1][0],t[1][1]),r=n.length;r--;)(!Mr(e=n[r],t)||!i(e)||w(e.a.x-e.b.x)<Mt&&w(e.a.y-e.b.y)<Mt)&&(e.a=e.b=null,n.splice(r,1))}(e),function(t){for(var e,n,i,r,o,s,a,l,u,c,d=t[0][0],h=t[1][0],p=t[0][1],f=t[1][1],g=dr,m=g.length;m--;)if((o=g[m])&&o.prepare())for(l=(a=o.edges).length,s=0;s<l;)i=(c=a[s].end()).x,r=c.y,e=(u=a[++s%l].start()).x,n=u.y,(w(i-e)>Mt||w(r-n)>Mt)&&(a.splice(s,0,new qr((v=o.site,y=c,b=w(i-d)<Mt&&f-r>Mt?{x:d,y:w(e-d)<Mt?n:f}:w(r-f)<Mt&&h-i>Mt?{x:w(n-f)<Mt?e:h,y:f}:w(i-h)<Mt&&r-p>Mt?{x:h,y:w(e-h)<Mt?n:p}:w(r-p)<Mt&&i-d>Mt?{x:w(n-p)<Mt?e:d,y:p}:null,_=void 0,(_=new Er(v,null)).a=y,_.b=b,cr.push(_),_),o.site,null)),++l);var v,y,b,_}(e));var s={cells:dr,edges:cr};return hr=fr=cr=dr=null,s}function Lr(t,e){return e.y-t.y||e.x-t.x}Ar.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)(t=e[n].edge).b&&t.a||e.splice(n,1);return e.sort(kr),e.length},qr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Cr.prototype={insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Ir(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(jr(this,n),n=(t=n).U),n.C=!1,i.C=!0,Dr(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(Dr(this,n),n=(t=n).U),n.C=!1,i.C=!0,jr(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,o=t.L,s=t.R;if(n=o?s?Ir(s):o:s,r?r.L===t?r.L=n:r.R=n:this._=n,o&&s?(i=n.C,n.C=t.C,n.L=o,o.U=n,n!==s?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=s,s.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,jr(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Dr(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,jr(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,Dr(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,jr(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,Dr(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}},o.geom.voronoi=function(t){var e=nr,n=ir,i=e,r=n,o=zr;if(t)return s(t);function s(t){var e=new Array(t.length),n=o[0][0],i=o[0][1],r=o[1][0],s=o[1][1];return Fr(a(t),o).cells.forEach(function(o,a){var l=o.edges,u=o.site;(e[a]=l.length?l.map(function(t){var e=t.start();return[e.x,e.y]}):u.x>=n&&u.x<=r&&u.y>=i&&u.y<=s?[[n,s],[r,s],[r,i],[n,i]]:[]).point=t[a]}),e}function a(t){return t.map(function(t,e){return{x:Math.round(i(t,e)/Mt)*Mt,y:Math.round(r(t,e)/Mt)*Mt,i:e}})}return s.links=function(t){return Fr(a(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},s.triangles=function(t){var e=[];return Fr(a(t)).cells.forEach(function(n,i){for(var r,o,s,a,l=n.site,u=n.edges.sort(kr),c=-1,d=u.length,h=u[d-1].edge,p=h.l===l?h.r:h.l;++c<d;)r=p,p=(h=u[c].edge).l===l?h.r:h.l,i<r.i&&i<p.i&&(s=r,a=p,((o=l).x-a.x)*(s.y-o.y)-(o.x-s.x)*(a.y-o.y)<0)&&e.push([t[i],t[r.i],t[p.i]])}),e},s.x=function(t){return arguments.length?(i=be(e=t),s):e},s.y=function(t){return arguments.length?(r=be(n=t),s):n},s.clipExtent=function(t){return arguments.length?(o=null==t?zr:t,s):o===zr?null:o},s.size=function(t){return arguments.length?s.clipExtent(t&&[[0,0],t]):o===zr?null:o&&o[1]},s};var zr=[[-1e6,-1e6],[1e6,1e6]];function Rr(t){return t.x}function Br(t){return t.y}function Hr(t,e){t=o.rgb(t),e=o.rgb(e);var n=t.r,i=t.g,r=t.b,s=e.r-n,a=e.g-i,l=e.b-r;return function(t){return"#"+he(Math.round(n+s*t))+he(Math.round(i+a*t))+he(Math.round(r+l*t))}}function Gr(t,e){var n,i={},r={};for(n in t)n in e?i[n]=$r(t[n],e[n]):r[n]=t[n];for(n in e)n in t||(r[n]=e[n]);return function(t){for(n in i)r[n]=i[n](t);return r}}function Vr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Ur(t,e){var n,i,r,o=Wr.lastIndex=Qr.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(n=Wr.exec(t))&&(i=Qr.exec(e));)(r=i.index)>o&&(r=e.slice(o,r),a[s]?a[s]+=r:a[++s]=r),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,l.push({i:s,x:Vr(n,i)})),o=Qr.lastIndex;return o<e.length&&(r=e.slice(o),a[s]?a[s]+=r:a[++s]=r),a.length<2?l[0]?(e=l[0].x,function(t){return e(t)+""}):function(){return e}:(e=l.length,function(t){for(var n,i=0;i<e;++i)a[(n=l[i]).i]=n.x(t);return a.join("")})}o.geom.delaunay=function(t){return o.geom.voronoi().triangles(t)},o.geom.quadtree=function(t,e,n,i,r){var o,s=nr,a=ir;if(o=arguments.length)return s=Rr,a=Br,3===o&&(r=n,i=e,n=e=0),l(t);function l(t){var l,u,c,d,h,p,f,g,m,v=be(s),y=be(a);if(null!=e)p=e,f=n,g=i,m=r;else if(g=m=-(p=f=1/0),u=[],c=[],h=t.length,o)for(d=0;d<h;++d)(l=t[d]).x<p&&(p=l.x),l.y<f&&(f=l.y),l.x>g&&(g=l.x),l.y>m&&(m=l.y),u.push(l.x),c.push(l.y);else for(d=0;d<h;++d){var b=+v(l=t[d],d),_=+y(l,d);b<p&&(p=b),_<f&&(f=_),b>g&&(g=b),_>m&&(m=_),u.push(b),c.push(_)}var x=g-p,A=m-f;function k(t,e,n,i,r,o,s,a){if(!isNaN(n)&&!isNaN(i))if(t.leaf){var l=t.x,u=t.y;if(null!=l)if(w(l-n)+w(u-i)<.01)T(t,e,n,i,r,o,s,a);else{var c=t.point;t.x=t.y=t.point=null,T(t,c,l,u,r,o,s,a),T(t,e,n,i,r,o,s,a)}else t.x=n,t.y=i,t.point=e}else T(t,e,n,i,r,o,s,a)}function T(t,e,n,i,r,o,s,a){var l=.5*(r+s),u=.5*(o+a),c=n>=l,d=i>=u,h=d<<1|c;t.leaf=!1,t=t.nodes[h]||(t.nodes[h]={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(t){k(S,t,+v(t,++d),+y(t,d),p,f,g,m)}}),c?r=l:s=l,d?o=u:a=u,k(t,e,n,i,r,o,s,a)}x>A?m=f+x:g=p+A;var S={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(t){k(S,t,+v(t,++d),+y(t,d),p,f,g,m)},visit:function(t){!function t(e,n,i,r,o,s){if(!e(n,i,r,o,s)){var a=.5*(i+o),l=.5*(r+s),u=n.nodes;u[0]&&t(e,u[0],i,r,a,l),u[1]&&t(e,u[1],a,r,o,l),u[2]&&t(e,u[2],i,l,a,s),u[3]&&t(e,u[3],a,l,o,s)}}(t,S,p,f,g,m)},find:function(t){return function(t,e,n,i,r,o,s){var a,l=1/0;return function t(u,c,d,h,p){if(!(c>o||d>s||h<i||p<r)){if(f=u.point){var f,g=e-u.x,m=n-u.y,v=g*g+m*m;if(v<l){var y=Math.sqrt(l=v);i=e-y,r=n-y,o=e+y,s=n+y,a=f}}for(var b=u.nodes,_=.5*(c+h),x=.5*(d+p),w=(n>=x)<<1|e>=_,A=w+4;w<A;++w)if(u=b[3&w])switch(3&w){case 0:t(u,c,d,_,x);break;case 1:t(u,_,d,h,x);break;case 2:t(u,c,x,_,p);break;case 3:t(u,_,x,h,p)}}}(t,i,r,o,s),a}(S,t[0],t[1],p,f,g,m)}};if(d=-1,null==e){for(;++d<h;)k(S,t[d],u[d],c[d],p,f,g,m);--d}else t.forEach(S.add);return u=c=t=l=null,S}return l.x=function(t){return arguments.length?(s=t,l):s},l.y=function(t){return arguments.length?(a=t,l):a},l.extent=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),l):null==e?null:[[e,n],[i,r]]},l.size=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=n=0,i=+t[0],r=+t[1]),l):null==e?null:[i-e,r-n]},l},o.interpolateRgb=Hr,o.interpolateObject=Gr,o.interpolateNumber=Vr,o.interpolateString=Ur;var Wr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Qr=new RegExp(Wr.source,"g");function $r(t,e){for(var n,i=o.interpolators.length;--i>=0&&!(n=o.interpolators[i](t,e)););return n}function Kr(t,e){var n,i=[],r=[],o=t.length,s=e.length,a=Math.min(t.length,e.length);for(n=0;n<a;++n)i.push($r(t[n],e[n]));for(;n<o;++n)r[n]=t[n];for(;n<s;++n)r[n]=e[n];return function(t){for(n=0;n<a;++n)r[n]=i[n](t);return r}}o.interpolate=$r,o.interpolators=[function(t,e){var n=typeof e;return("string"===n?ye.has(e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(e)?Hr:Ur:e instanceof Ut?Hr:Array.isArray(e)?Kr:"object"===n&&isNaN(e)?Gr:Vr)(t,e)}],o.interpolateArray=Kr;var Jr=function(){return D},Zr=o.map({linear:Jr,poly:function(t){return function(e){return Math.pow(e,t)}},quad:function(){return eo},cubic:function(){return no},sin:function(){return ro},exp:function(){return oo},circle:function(){return so},elastic:function(t,e){var n;return arguments.length<2&&(e=.45),arguments.length?n=e/Ot*Math.asin(1/t):(t=1,n=e/4),function(i){return 1+t*Math.pow(2,-10*i)*Math.sin((i-n)*Ot/e)}},back:function(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}},bounce:function(){return ao}}),Yr=o.map({in:D,out:Xr,"in-out":to,"out-in":function(t){return to(Xr(t))}});function Xr(t){return function(e){return 1-t(1-e)}}function to(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}}function eo(t){return t*t}function no(t){return t*t*t}function io(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function ro(t){return 1-Math.cos(t*Ct)}function oo(t){return Math.pow(2,10*(t-1))}function so(t){return 1-Math.sqrt(1-t*t)}function ao(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function lo(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function uo(t){var e,n,i,r=[t.a,t.b],o=[t.c,t.d],s=ho(r),a=co(r,o),l=ho(((e=o)[0]+=(i=-a)*(n=r)[0],e[1]+=i*n[1],e))||0;r[0]*o[1]<o[0]*r[1]&&(r[0]*=-1,r[1]*=-1,s*=-1,a*=-1),this.rotate=(s?Math.atan2(r[1],r[0]):Math.atan2(-o[0],o[1]))*jt,this.translate=[t.e,t.f],this.scale=[s,l],this.skew=l?Math.atan2(a,l)*jt:0}function co(t,e){return t[0]*e[0]+t[1]*e[1]}function ho(t){var e=Math.sqrt(co(t,t));return e&&(t[0]/=e,t[1]/=e),e}o.ease=function(t){var e,n=t.indexOf("-"),i=n>=0?t.slice(0,n):t,r=n>=0?t.slice(n+1):"in";return i=Zr.get(i)||Jr,r=Yr.get(r)||D,e=r(i.apply(null,s.call(arguments,1))),function(t){return t<=0?0:t>=1?1:e(t)}},o.interpolateHcl=function(t,e){t=o.hcl(t),e=o.hcl(e);var n=t.h,i=t.c,r=t.l,s=e.h-n,a=e.c-i,l=e.l-r;return isNaN(a)&&(a=0,i=isNaN(i)?e.c:i),isNaN(s)?(s=0,n=isNaN(n)?e.h:n):s>180?s-=360:s<-180&&(s+=360),function(t){return Zt(n+s*t,i+a*t,r+l*t)+""}},o.interpolateHsl=function(t,e){t=o.hsl(t),e=o.hsl(e);var n=t.h,i=t.s,r=t.l,s=e.h-n,a=e.s-i,l=e.l-r;return isNaN(a)&&(a=0,i=isNaN(i)?e.s:i),isNaN(s)?(s=0,n=isNaN(n)?e.h:n):s>180?s-=360:s<-180&&(s+=360),function(t){return $t(n+s*t,i+a*t,r+l*t)+""}},o.interpolateLab=function(t,e){t=o.lab(t),e=o.lab(e);var n=t.l,i=t.a,r=t.b,s=e.l-n,a=e.a-i,l=e.b-r;return function(t){return re(n+s*t,i+a*t,r+l*t)+""}},o.interpolateRound=lo,o.transform=function(t){var e=l.createElementNS(o.ns.prefix.svg,"g");return(o.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new uo(n?n.matrix:po)})(t)},uo.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var po={a:1,b:0,c:0,d:1,e:0,f:0};function fo(t){return t.length?t.pop()+",":""}function go(t,e){var n=[],i=[];return t=o.transform(t),e=o.transform(e),function(t,e,n,i){if(t[0]!==e[0]||t[1]!==e[1]){var r=n.push("translate(",null,",",null,")");i.push({i:r-4,x:Vr(t[0],e[0])},{i:r-2,x:Vr(t[1],e[1])})}else(e[0]||e[1])&&n.push("translate("+e+")")}(t.translate,e.translate,n,i),function(t,e,n,i){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),i.push({i:n.push(fo(n)+"rotate(",null,")")-2,x:Vr(t,e)})):e&&n.push(fo(n)+"rotate("+e+")")}(t.rotate,e.rotate,n,i),function(t,e,n,i){t!==e?i.push({i:n.push(fo(n)+"skewX(",null,")")-2,x:Vr(t,e)}):e&&n.push(fo(n)+"skewX("+e+")")}(t.skew,e.skew,n,i),function(t,e,n,i){if(t[0]!==e[0]||t[1]!==e[1]){var r=n.push(fo(n)+"scale(",null,",",null,")");i.push({i:r-4,x:Vr(t[0],e[0])},{i:r-2,x:Vr(t[1],e[1])})}else 1===e[0]&&1===e[1]||n.push(fo(n)+"scale("+e+")")}(t.scale,e.scale,n,i),t=e=null,function(t){for(var e,r=-1,o=i.length;++r<o;)n[(e=i[r]).i]=e.x(t);return n.join("")}}function mo(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function vo(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function yo(t){for(var e=t.source,n=t.target,i=function(t,e){if(t===e)return t;for(var n=bo(t),i=bo(e),r=n.pop(),o=i.pop(),s=null;r===o;)s=r,r=n.pop(),o=i.pop();return s}(e,n),r=[e];e!==i;)e=e.parent,r.push(e);for(var o=r.length;n!==i;)r.splice(o,0,n),n=n.parent;return r}function bo(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function _o(t){t.fixed|=2}function xo(t){t.fixed&=-7}function wo(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Ao(t){t.fixed&=-5}o.interpolateTransform=go,o.layout={},o.layout.bundle=function(){return function(t){for(var e=[],n=-1,i=t.length;++n<i;)e.push(yo(t[n]));return e}},o.layout.chord=function(){var t,e,n,i,r,s,a,l={},u=0;function c(){var l,c,h,p,f,g={},m=[],v=o.range(i),y=[];for(t=[],e=[],l=0,p=-1;++p<i;){for(c=0,f=-1;++f<i;)c+=n[p][f];m.push(c),y.push(o.range(i)),l+=c}for(r&&v.sort(function(t,e){return r(m[t],m[e])}),s&&y.forEach(function(t,e){t.sort(function(t,i){return s(n[e][t],n[e][i])})}),l=(Ot-u*i)/l,c=0,p=-1;++p<i;){for(h=c,f=-1;++f<i;){var b=v[p],_=y[b][f],x=n[b][_],w=c,A=c+=x*l;g[b+"-"+_]={index:b,subindex:_,startAngle:w,endAngle:A,value:x}}e[b]={index:b,startAngle:h,endAngle:c,value:m[b]},c+=u}for(p=-1;++p<i;)for(f=p-1;++f<i;){var k=g[p+"-"+f],T=g[f+"-"+p];(k.value||T.value)&&t.push(k.value<T.value?{source:T,target:k}:{source:k,target:T})}a&&d()}function d(){t.sort(function(t,e){return a((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}return l.matrix=function(r){return arguments.length?(i=(n=r)&&n.length,t=e=null,l):n},l.padding=function(n){return arguments.length?(u=n,t=e=null,l):u},l.sortGroups=function(n){return arguments.length?(r=n,t=e=null,l):r},l.sortSubgroups=function(e){return arguments.length?(s=e,t=null,l):s},l.sortChords=function(e){return arguments.length?(a=e,t&&d(),l):a},l.chords=function(){return t||c(),t},l.groups=function(){return e||c(),e},l},o.layout.force=function(){var t,e,n,i,r,s,a={},l=o.dispatch("start","tick","end"),u=[1,1],c=.9,d=ko,h=To,p=-30,f=So,g=.1,m=.64,v=[],y=[];function b(t){return function(e,n,i,r){if(e.point!==t){var o=e.cx-t.x,s=e.cy-t.y,a=r-n,l=o*o+s*s;if(a*a/m<l){if(l<f){var u=e.charge/l;t.px-=o*u,t.py-=s*u}return!0}e.point&&l&&l<f&&(u=e.pointCharge/l,t.px-=o*u,t.py-=s*u)}return!e.charge}}function _(t){t.px=o.event.x,t.py=o.event.y,a.resume()}return a.tick=function(){if((n*=.99)<.005)return t=null,l.end({type:"end",alpha:n=0}),!0;var e,a,d,h,f,m,_,x,w,A=v.length,k=y.length;for(a=0;a<k;++a)h=(d=y[a]).source,(m=(x=(f=d.target).x-h.x)*x+(w=f.y-h.y)*w)&&(x*=m=n*r[a]*((m=Math.sqrt(m))-i[a])/m,w*=m,f.x-=x*(_=h.weight+f.weight?h.weight/(h.weight+f.weight):.5),f.y-=w*_,h.x+=x*(_=1-_),h.y+=w*_);if((_=n*g)&&(x=u[0]/2,w=u[1]/2,a=-1,_))for(;++a<A;)(d=v[a]).x+=(x-d.x)*_,d.y+=(w-d.y)*_;if(p)for(function t(e,n,i){var r=0,o=0;if(e.charge=0,!e.leaf)for(var s,a=e.nodes,l=a.length,u=-1;++u<l;)null!=(s=a[u])&&(t(s,n,i),e.charge+=s.charge,r+=s.charge*s.cx,o+=s.charge*s.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var c=n*i[e.point.index];e.charge+=e.pointCharge=c,r+=c*e.point.x,o+=c*e.point.y}e.cx=r/e.charge,e.cy=o/e.charge}(e=o.geom.quadtree(v),n,s),a=-1;++a<A;)(d=v[a]).fixed||e.visit(b(d));for(a=-1;++a<A;)(d=v[a]).fixed?(d.x=d.px,d.y=d.py):(d.x-=(d.px-(d.px=d.x))*c,d.y-=(d.py-(d.py=d.y))*c);l.tick({type:"tick",alpha:n})},a.nodes=function(t){return arguments.length?(v=t,a):v},a.links=function(t){return arguments.length?(y=t,a):y},a.size=function(t){return arguments.length?(u=t,a):u},a.linkDistance=function(t){return arguments.length?(d="function"==typeof t?t:+t,a):d},a.distance=a.linkDistance,a.linkStrength=function(t){return arguments.length?(h="function"==typeof t?t:+t,a):h},a.friction=function(t){return arguments.length?(c=+t,a):c},a.charge=function(t){return arguments.length?(p="function"==typeof t?t:+t,a):p},a.chargeDistance=function(t){return arguments.length?(f=t*t,a):Math.sqrt(f)},a.gravity=function(t){return arguments.length?(g=+t,a):g},a.theta=function(t){return arguments.length?(m=t*t,a):Math.sqrt(m)},a.alpha=function(e){return arguments.length?(e=+e,n?e>0?n=e:(t.c=null,t.t=NaN,t=null,l.end({type:"end",alpha:n=0})):e>0&&(l.start({type:"start",alpha:n=e}),t=Me(a.tick)),a):n},a.start=function(){var t,e,n,o=v.length,l=y.length,c=u[0],f=u[1];for(t=0;t<o;++t)(n=v[t]).index=t,n.weight=0;for(t=0;t<l;++t)"number"==typeof(n=y[t]).source&&(n.source=v[n.source]),"number"==typeof n.target&&(n.target=v[n.target]),++n.source.weight,++n.target.weight;for(t=0;t<o;++t)n=v[t],isNaN(n.x)&&(n.x=g("x",c)),isNaN(n.y)&&(n.y=g("y",f)),isNaN(n.px)&&(n.px=n.x),isNaN(n.py)&&(n.py=n.y);if(i=[],"function"==typeof d)for(t=0;t<l;++t)i[t]=+d.call(this,y[t],t);else for(t=0;t<l;++t)i[t]=d;if(r=[],"function"==typeof h)for(t=0;t<l;++t)r[t]=+h.call(this,y[t],t);else for(t=0;t<l;++t)r[t]=h;if(s=[],"function"==typeof p)for(t=0;t<o;++t)s[t]=+p.call(this,v[t],t);else for(t=0;t<o;++t)s[t]=p;function g(n,i){if(!e){for(e=new Array(o),u=0;u<o;++u)e[u]=[];for(u=0;u<l;++u){var r=y[u];e[r.source.index].push(r.target),e[r.target.index].push(r.source)}}for(var s,a=e[t],u=-1,c=a.length;++u<c;)if(!isNaN(s=a[u][n]))return s;return Math.random()*i}return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){if(e||(e=o.behavior.drag().origin(D).on("dragstart.force",_o).on("drag.force",_).on("dragend.force",xo)),!arguments.length)return e;this.on("mouseover.force",wo).on("mouseout.force",Ao).call(e)},o.rebind(a,l,"on")};var ko=20,To=1,So=1/0;function Mo(t,e){return o.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=Po,t}function Eo(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(r=t.children)&&(i=r.length))for(var i,r;--i>=0;)n.push(r[i])}function No(t,e){for(var n=[t],i=[];null!=(t=n.pop());)if(i.push(t),(o=t.children)&&(r=o.length))for(var r,o,s=-1;++s<r;)n.push(o[s]);for(;null!=(t=i.pop());)e(t)}function Oo(t){return t.children}function qo(t){return t.value}function Co(t,e){return e.value-t.value}function Po(t){return o.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}o.layout.hierarchy=function(){var t=Co,e=Oo,n=qo;function i(r){var o,s=[r],a=[];for(r.depth=0;null!=(o=s.pop());)if(a.push(o),(u=e.call(i,o,o.depth))&&(l=u.length)){for(var l,u,c;--l>=0;)s.push(c=u[l]),c.parent=o,c.depth=o.depth+1;n&&(o.value=0),o.children=u}else n&&(o.value=+n.call(i,o,o.depth)||0),delete o.children;return No(r,function(e){var i,r;t&&(i=e.children)&&i.sort(t),n&&(r=e.parent)&&(r.value+=e.value)}),a}return i.sort=function(e){return arguments.length?(t=e,i):t},i.children=function(t){return arguments.length?(e=t,i):e},i.value=function(t){return arguments.length?(n=t,i):n},i.revalue=function(t){return n&&(Eo(t,function(t){t.children&&(t.value=0)}),No(t,function(t){var e;t.children||(t.value=+n.call(i,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)})),t},i},o.layout.partition=function(){var t=o.layout.hierarchy(),e=[1,1];function n(n,i){var r=t.call(this,n,i);return function t(e,n,i,r){var o=e.children;if(e.x=n,e.y=e.depth*r,e.dx=i,e.dy=r,o&&(s=o.length)){var s,a,l,u=-1;for(i=e.value?i/e.value:0;++u<s;)t(a=o[u],n,l=a.value*i,r),n+=l}}(r[0],0,e[0],e[1]/function t(e){var n=e.children,i=0;if(n&&(r=n.length))for(var r,o=-1;++o<r;)i=Math.max(i,t(n[o]));return 1+i}(r[0])),r}return n.size=function(t){return arguments.length?(e=t,n):e},Mo(n,t)},o.layout.pie=function(){var t=Number,e=jo,n=0,i=Ot,r=0;function s(a){var l,u=a.length,c=a.map(function(e,n){return+t.call(s,e,n)}),d=+("function"==typeof n?n.apply(this,arguments):n),h=("function"==typeof i?i.apply(this,arguments):i)-d,p=Math.min(Math.abs(h)/u,+("function"==typeof r?r.apply(this,arguments):r)),f=p*(h<0?-1:1),g=o.sum(c),m=g?(h-u*f)/g:0,v=o.range(u),y=[];return null!=e&&v.sort(e===jo?function(t,e){return c[e]-c[t]}:function(t,n){return e(a[t],a[n])}),v.forEach(function(t){y[t]={data:a[t],value:l=c[t],startAngle:d,endAngle:d+=l*m+f,padAngle:p}}),y}return s.value=function(e){return arguments.length?(t=e,s):t},s.sort=function(t){return arguments.length?(e=t,s):e},s.startAngle=function(t){return arguments.length?(n=t,s):n},s.endAngle=function(t){return arguments.length?(i=t,s):i},s.padAngle=function(t){return arguments.length?(r=t,s):r},s};var jo={};function Do(t){return t.x}function Io(t){return t.y}function Fo(t,e,n){t.y0=e,t.y=n}o.layout.stack=function(){var t=D,e=Ro,n=Bo,i=Fo,r=Do,s=Io;function a(l,u){if(!(p=l.length))return l;var c=l.map(function(e,n){return t.call(a,e,n)}),d=c.map(function(t){return t.map(function(t,e){return[r.call(a,t,e),s.call(a,t,e)]})}),h=e.call(a,d,u);c=o.permute(c,h),d=o.permute(d,h);var p,f,g,m,v=n.call(a,d,u),y=c[0].length;for(g=0;g<y;++g)for(i.call(a,c[0][g],m=v[g],d[0][g][1]),f=1;f<p;++f)i.call(a,c[f][g],m+=d[f-1][g][1],d[f][g][1]);return l}return a.values=function(e){return arguments.length?(t=e,a):t},a.order=function(t){return arguments.length?(e="function"==typeof t?t:Lo.get(t)||Ro,a):e},a.offset=function(t){return arguments.length?(n="function"==typeof t?t:zo.get(t)||Bo,a):n},a.x=function(t){return arguments.length?(r=t,a):r},a.y=function(t){return arguments.length?(s=t,a):s},a.out=function(t){return arguments.length?(i=t,a):i},a};var Lo=o.map({"inside-out":function(t){var e,n,i=t.length,r=t.map(Ho),s=t.map(Go),a=o.range(i).sort(function(t,e){return r[t]-r[e]}),l=0,u=0,c=[],d=[];for(e=0;e<i;++e)n=a[e],l<u?(l+=s[n],c.push(n)):(u+=s[n],d.push(n));return d.reverse().concat(c)},reverse:function(t){return o.range(t.length).reverse()},default:Ro}),zo=o.map({silhouette:function(t){var e,n,i,r=t.length,o=t[0].length,s=[],a=0,l=[];for(n=0;n<o;++n){for(e=0,i=0;e<r;e++)i+=t[e][n][1];i>a&&(a=i),s.push(i)}for(n=0;n<o;++n)l[n]=(a-s[n])/2;return l},wiggle:function(t){var e,n,i,r,o,s,a,l,u,c=t.length,d=t[0],h=d.length,p=[];for(p[0]=l=u=0,n=1;n<h;++n){for(e=0,r=0;e<c;++e)r+=t[e][n][1];for(e=0,o=0,a=d[n][0]-d[n-1][0];e<c;++e){for(i=0,s=(t[e][n][1]-t[e][n-1][1])/(2*a);i<e;++i)s+=(t[i][n][1]-t[i][n-1][1])/a;o+=s*t[e][n][1]}p[n]=l-=r?o/r*a:0,l<u&&(u=l)}for(n=0;n<h;++n)p[n]-=u;return p},expand:function(t){var e,n,i,r=t.length,o=t[0].length,s=1/r,a=[];for(n=0;n<o;++n){for(e=0,i=0;e<r;e++)i+=t[e][n][1];if(i)for(e=0;e<r;e++)t[e][n][1]/=i;else for(e=0;e<r;e++)t[e][n][1]=s}for(n=0;n<o;++n)a[n]=0;return a},zero:Bo});function Ro(t){return o.range(t.length)}function Bo(t){for(var e=-1,n=t[0].length,i=[];++e<n;)i[e]=0;return i}function Ho(t){for(var e,n=1,i=0,r=t[0][1],o=t.length;n<o;++n)(e=t[n][1])>r&&(i=n,r=e);return i}function Go(t){return t.reduce(Vo,0)}function Vo(t,e){return t+e[1]}function Uo(t,e){return Wo(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function Wo(t,e){for(var n=-1,i=+t[0],r=(t[1]-i)/e,o=[];++n<=e;)o[n]=r*n+i;return o}function Qo(t){return[o.min(t),o.max(t)]}function $o(t,e){return t.value-e.value}function Ko(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function Jo(t,e){t._pack_next=e,e._pack_prev=t}function Zo(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r+e.r;return.999*r*r>n*n+i*i}function Yo(t){if((e=t.children)&&(l=e.length)){var e,n,i,r,o,s,a,l,u=1/0,c=-1/0,d=1/0,h=-1/0;if(e.forEach(Xo),(n=e[0]).x=-n.r,n.y=0,b(n),l>1&&((i=e[1]).x=i.r,i.y=0,b(i),l>2))for(es(n,i,r=e[2]),b(r),Ko(n,r),n._pack_prev=r,Ko(r,i),i=n._pack_next,o=3;o<l;o++){es(n,i,r=e[o]);var p=0,f=1,g=1;for(s=i._pack_next;s!==i;s=s._pack_next,f++)if(Zo(s,r)){p=1;break}if(1==p)for(a=n._pack_prev;a!==s._pack_prev&&!Zo(a,r);a=a._pack_prev,g++);p?(f<g||f==g&&i.r<n.r?Jo(n,i=s):Jo(n=a,i),o--):(Ko(n,r),i=r,b(r))}var m=(u+c)/2,v=(d+h)/2,y=0;for(o=0;o<l;o++)(r=e[o]).x-=m,r.y-=v,y=Math.max(y,r.r+Math.sqrt(r.x*r.x+r.y*r.y));t.r=y,e.forEach(ts)}function b(t){u=Math.min(t.x-t.r,u),c=Math.max(t.x+t.r,c),d=Math.min(t.y-t.r,d),h=Math.max(t.y+t.r,h)}}function Xo(t){t._pack_next=t._pack_prev=t}function ts(t){delete t._pack_next,delete t._pack_prev}function es(t,e,n){var i=t.r+n.r,r=e.x-t.x,o=e.y-t.y;if(i&&(r||o)){var s=e.r+n.r,a=r*r+o*o,l=.5+((i*=i)-(s*=s))/(2*a),u=Math.sqrt(Math.max(0,2*s*(i+a)-(i-=a)*i-s*s))/(2*a);n.x=t.x+l*r+u*o,n.y=t.y+l*o-u*r}else n.x=t.x+i,n.y=t.y}function ns(t,e){return t.parent==e.parent?1:2}function is(t){var e=t.children;return e.length?e[0]:t.t}function rs(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function os(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function ss(t,e,n){return t.a.parent===e.parent?t.a:n}function as(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function ls(t,e){var n=t.x+e[3],i=t.y+e[0],r=t.dx-e[1]-e[3],o=t.dy-e[0]-e[2];return r<0&&(n+=r/2,r=0),o<0&&(i+=o/2,o=0),{x:n,y:i,dx:r,dy:o}}function us(t){var e=t[0],n=t[t.length-1];return e<n?[e,n]:[n,e]}function cs(t){return t.rangeExtent?t.rangeExtent():us(t.range())}function ds(t,e,n,i){var r=n(t[0],t[1]),o=i(e[0],e[1]);return function(t){return o(r(t))}}function hs(t,e){var n,i=0,r=t.length-1,o=t[i],s=t[r];return s<o&&(n=i,i=r,r=n,n=o,o=s,s=n),t[i]=e.floor(o),t[r]=e.ceil(s),t}function ps(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:fs}o.layout.histogram=function(){var t=!0,e=Number,n=Qo,i=Uo;function r(r,s){for(var a,l,u=[],c=r.map(e,this),d=n.call(this,c,s),h=i.call(this,d,c,s),p=(s=-1,c.length),f=h.length-1,g=t?1:1/p;++s<f;)(a=u[s]=[]).dx=h[s+1]-(a.x=h[s]),a.y=0;if(f>0)for(s=-1;++s<p;)(l=c[s])>=d[0]&&l<=d[1]&&((a=u[o.bisect(h,l,1,f)-1]).y+=g,a.push(r[s]));return u}return r.value=function(t){return arguments.length?(e=t,r):e},r.range=function(t){return arguments.length?(n=be(t),r):n},r.bins=function(t){return arguments.length?(i="number"==typeof t?function(e){return Wo(e,t)}:be(t),r):i},r.frequency=function(e){return arguments.length?(t=!!e,r):t},r},o.layout.pack=function(){var t,e=o.layout.hierarchy().sort($o),n=0,i=[1,1];function r(r,o){var s=e.call(this,r,o),a=s[0],l=i[0],u=i[1],c=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(a.x=a.y=0,No(a,function(t){t.r=+c(t.value)}),No(a,Yo),n){var d=n*(t?1:Math.max(2*a.r/l,2*a.r/u))/2;No(a,function(t){t.r+=d}),No(a,Yo),No(a,function(t){t.r-=d})}return function t(e,n,i,r){var o=e.children;if(e.x=n+=r*e.x,e.y=i+=r*e.y,e.r*=r,o)for(var s=-1,a=o.length;++s<a;)t(o[s],n,i,r)}(a,l/2,u/2,t?1:1/Math.max(2*a.r/l,2*a.r/u)),s}return r.size=function(t){return arguments.length?(i=t,r):i},r.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,r):t},r.padding=function(t){return arguments.length?(n=+t,r):n},Mo(r,e)},o.layout.tree=function(){var t=o.layout.hierarchy().sort(null).value(null),e=ns,n=[1,1],i=null;function r(r,o){var u=t.call(this,r,o),c=u[0],d=function(t){for(var e,n={A:null,children:[c]},i=[n];null!=(e=i.pop());)for(var r,o=e.children,s=0,a=o.length;s<a;++s)i.push((o[s]=r={_:o[s],parent:e,children:(r=o[s].children)&&r.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:s}).a=r);return n.children[0]}();if(No(d,s),d.parent.m=-d.z,Eo(d,a),i)Eo(c,l);else{var h=c,p=c,f=c;Eo(c,function(t){t.x<h.x&&(h=t),t.x>p.x&&(p=t),t.depth>f.depth&&(f=t)});var g=e(h,p)/2-h.x,m=n[0]/(p.x+e(p,h)/2+g),v=n[1]/(f.depth||1);Eo(c,function(t){t.x=(t.x+g)*m,t.y=t.depth*v})}return u}function s(t){var n=t.children,i=t.parent.children,r=t.i?i[t.i-1]:null;if(n.length){!function(t){for(var e,n=0,i=0,r=t.children,o=r.length;--o>=0;)(e=r[o]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}(t);var o=(n[0].z+n[n.length-1].z)/2;r?(t.z=r.z+e(t._,r._),t.m=t.z-o):t.z=o}else r&&(t.z=r.z+e(t._,r._));t.parent.A=function(t,n,i){if(n){for(var r,o=t,s=t,a=n,l=o.parent.children[0],u=o.m,c=s.m,d=a.m,h=l.m;a=rs(a),o=is(o),a&&o;)l=is(l),(s=rs(s)).a=t,(r=a.z+d-o.z-u+e(a._,o._))>0&&(os(ss(a,t,i),t,r),u+=r,c+=r),d+=a.m,u+=o.m,h+=l.m,c+=s.m;a&&!rs(s)&&(s.t=a,s.m+=d-c),o&&!is(l)&&(l.t=o,l.m+=u-h,i=t)}return i}(t,r,t.parent.A||i[0])}function a(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function l(t){t.x*=n[0],t.y=t.depth*n[1]}return r.separation=function(t){return arguments.length?(e=t,r):e},r.size=function(t){return arguments.length?(i=null==(n=t)?l:null,r):i?null:n},r.nodeSize=function(t){return arguments.length?(i=null==(n=t)?null:l,r):i?n:null},Mo(r,t)},o.layout.cluster=function(){var t=o.layout.hierarchy().sort(null).value(null),e=ns,n=[1,1],i=!1;function r(r,s){var a,l=t.call(this,r,s),u=l[0],c=0;No(u,function(t){var n=t.children;n&&n.length?(t.x=function(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}(n),t.y=function(t){return 1+o.max(t,function(t){return t.y})}(n)):(t.x=a?c+=e(t,a):0,t.y=0,a=t)});var d=function t(e){var n=e.children;return n&&n.length?t(n[0]):e}(u),h=function t(e){var n,i=e.children;return i&&(n=i.length)?t(i[n-1]):e}(u),p=d.x-e(d,h)/2,f=h.x+e(h,d)/2;return No(u,i?function(t){t.x=(t.x-u.x)*n[0],t.y=(u.y-t.y)*n[1]}:function(t){t.x=(t.x-p)/(f-p)*n[0],t.y=(1-(u.y?t.y/u.y:1))*n[1]}),l}return r.separation=function(t){return arguments.length?(e=t,r):e},r.size=function(t){return arguments.length?(i=null==(n=t),r):i?null:n},r.nodeSize=function(t){return arguments.length?(i=null!=(n=t),r):i?n:null},Mo(r,t)},o.layout.treemap=function(){var t,e=o.layout.hierarchy(),n=Math.round,i=[1,1],r=null,s=as,a=!1,l="squarify",u=.5*(1+Math.sqrt(5));function c(t,e){for(var n,i,r=-1,o=t.length;++r<o;)i=(n=t[r]).value*(e<0?0:e),n.area=isNaN(i)||i<=0?0:i}function d(t){var e=t.children;if(e&&e.length){var n,i,r,o=s(t),a=[],u=e.slice(),h=1/0,g="slice"===l?o.dx:"dice"===l?o.dy:"slice-dice"===l?1&t.depth?o.dy:o.dx:Math.min(o.dx,o.dy);for(c(u,o.dx*o.dy/t.value),a.area=0;(r=u.length)>0;)a.push(n=u[r-1]),a.area+=n.area,"squarify"!==l||(i=p(a,g))<=h?(u.pop(),h=i):(a.area-=a.pop().area,f(a,g,o,!1),g=Math.min(o.dx,o.dy),a.length=a.area=0,h=1/0);a.length&&(f(a,g,o,!0),a.length=a.area=0),e.forEach(d)}}function h(t){var e=t.children;if(e&&e.length){var n,i=s(t),r=e.slice(),o=[];for(c(r,i.dx*i.dy/t.value),o.area=0;n=r.pop();)o.push(n),o.area+=n.area,null!=n.z&&(f(o,n.z?i.dx:i.dy,i,!r.length),o.length=o.area=0);e.forEach(h)}}function p(t,e){for(var n,i=t.area,r=0,o=1/0,s=-1,a=t.length;++s<a;)(n=t[s].area)&&(n<o&&(o=n),n>r&&(r=n));return e*=e,(i*=i)?Math.max(e*r*u/i,i/(e*o*u)):1/0}function f(t,e,i,r){var o,s=-1,a=t.length,l=i.x,u=i.y,c=e?n(t.area/e):0;if(e==i.dx){for((r||c>i.dy)&&(c=i.dy);++s<a;)(o=t[s]).x=l,o.y=u,o.dy=c,l+=o.dx=Math.min(i.x+i.dx-l,c?n(o.area/c):0);o.z=!0,o.dx+=i.x+i.dx-l,i.y+=c,i.dy-=c}else{for((r||c>i.dx)&&(c=i.dx);++s<a;)(o=t[s]).x=l,o.y=u,o.dx=c,u+=o.dy=Math.min(i.y+i.dy-u,c?n(o.area/c):0);o.z=!1,o.dy+=i.y+i.dy-u,i.x+=c,i.dx-=c}}function g(n){var r=t||e(n),o=r[0];return o.x=o.y=0,o.value?(o.dx=i[0],o.dy=i[1]):o.dx=o.dy=0,t&&e.revalue(o),c([o],o.dx*o.dy/o.value),(t?h:d)(o),a&&(t=r),r}return g.size=function(t){return arguments.length?(i=t,g):i},g.padding=function(t){if(!arguments.length)return r;function e(e){return ls(e,t)}var n;return s=null==(r=t)?as:"function"==(n=typeof t)?function(e){var n=t.call(g,e,e.depth);return null==n?as(e):ls(e,"number"==typeof n?[n,n,n,n]:n)}:"number"===n?(t=[t,t,t,t],e):e,g},g.round=function(t){return arguments.length?(n=t?Math.round:Number,g):n!=Number},g.sticky=function(e){return arguments.length?(a=e,t=null,g):a},g.ratio=function(t){return arguments.length?(u=t,g):u},g.mode=function(t){return arguments.length?(l=t+"",g):l},Mo(g,e)},o.random={normal:function(t,e){var n=arguments.length;return n<2&&(e=1),n<1&&(t=0),function(){var n,i,r;do{r=(n=2*Math.random()-1)*n+(i=2*Math.random()-1)*i}while(!r||r>1);return t+e*n*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var t=o.random.normal.apply(o,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=o.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;n<t;n++)e+=Math.random();return e}}},o.scale={};var fs={floor:D,ceil:D};function gs(t,e,n,i){var r=[],s=[],a=0,l=Math.min(t.length,e.length)-1;for(t[l]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<=l;)r.push(n(t[a-1],t[a])),s.push(i(e[a-1],e[a]));return function(e){var n=o.bisect(t,e,1,l)-1;return s[n](r[n](e))}}function ms(t,e){return o.rebind(t,e,"range","rangeRound","interpolate","clamp")}function vs(t,e){return hs(t,ps(ys(t,e)[2])),hs(t,ps(ys(t,e)[2])),t}function ys(t,e){null==e&&(e=10);var n=us(t),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),o=e/i*r;return o<=.15?r*=10:o<=.35?r*=5:o<=.75&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function bs(t,e){return o.range.apply(o,ys(t,e))}function _s(t,e,n){var i=ys(t,e);if(n){var r=Pe.exec(n);if(r.shift(),"s"===r[8]){var s=o.formatPrefix(Math.max(w(i[0]),w(i[1])));return r[7]||(r[7]="."+ws(s.scale(i[2]))),r[8]="f",n=o.format(r.join("")),function(t){return n(s.scale(t))+s.symbol}}r[7]||(r[7]="."+function(t,e){var n=ws(e[2]);return t in xs?Math.abs(n-ws(Math.max(w(e[0]),w(e[1]))))+ +("e"!==t):n-2*("%"===t)}(r[8],i)),n=r.join("")}else n=",."+ws(i[2])+"f";return o.format(n)}o.scale.linear=function(){return function t(e,n,i,r){var o,s;function a(){var t=Math.min(e.length,n.length)>2?gs:ds,a=r?vo:mo;return o=t(e,n,a,i),s=t(n,e,a,$r),l}function l(t){return o(t)}return l.invert=function(t){return s(t)},l.domain=function(t){return arguments.length?(e=t.map(Number),a()):e},l.range=function(t){return arguments.length?(n=t,a()):n},l.rangeRound=function(t){return l.range(t).interpolate(lo)},l.clamp=function(t){return arguments.length?(r=t,a()):r},l.interpolate=function(t){return arguments.length?(i=t,a()):i},l.ticks=function(t){return bs(e,t)},l.tickFormat=function(t,n){return _s(e,t,n)},l.nice=function(t){return vs(e,t),a()},l.copy=function(){return t(e,n,i,r)},a()}([0,1],[0,1],$r,!1)};var xs={s:1,g:1,p:1,r:1,e:1};function ws(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}o.scale.log=function(){return function t(e,n,i,r){function s(t){return(i?Math.log(t<0?0:t):-Math.log(t>0?0:-t))/Math.log(n)}function a(t){return i?Math.pow(n,t):-Math.pow(n,-t)}function l(t){return e(s(t))}return l.invert=function(t){return a(e.invert(t))},l.domain=function(t){return arguments.length?(i=t[0]>=0,e.domain((r=t.map(Number)).map(s)),l):r},l.base=function(t){return arguments.length?(n=+t,e.domain(r.map(s)),l):n},l.nice=function(){var t=hs(r.map(s),i?Math:ks);return e.domain(t),r=t.map(a),l},l.ticks=function(){var t=us(r),e=[],o=t[0],l=t[1],u=Math.floor(s(o)),c=Math.ceil(s(l)),d=n%1?2:n;if(isFinite(c-u)){if(i){for(;u<c;u++)for(var h=1;h<d;h++)e.push(a(u)*h);e.push(a(u))}else for(e.push(a(u));u++<c;)for(h=d-1;h>0;h--)e.push(a(u)*h);for(u=0;e[u]<o;u++);for(c=e.length;e[c-1]>l;c--);e=e.slice(u,c)}return e},l.tickFormat=function(t,e){if(!arguments.length)return As;arguments.length<2?e=As:"function"!=typeof e&&(e=o.format(e));var i=Math.max(1,n*t/l.ticks().length);return function(t){var r=t/a(Math.round(s(t)));return r*n<n-.5&&(r*=n),r<=i?e(t):""}},l.copy=function(){return t(e.copy(),n,i,r)},ms(l,e)}(o.scale.linear().domain([0,1]),10,!0,[1,10])};var As=o.format(".0e"),ks={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};function Ts(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}o.scale.pow=function(){return function t(e,n,i){var r=Ts(n),o=Ts(1/n);function s(t){return e(r(t))}return s.invert=function(t){return o(e.invert(t))},s.domain=function(t){return arguments.length?(e.domain((i=t.map(Number)).map(r)),s):i},s.ticks=function(t){return bs(i,t)},s.tickFormat=function(t,e){return _s(i,t,e)},s.nice=function(t){return s.domain(vs(i,t))},s.exponent=function(t){return arguments.length?(r=Ts(n=t),o=Ts(1/n),e.domain(i.map(r)),s):n},s.copy=function(){return t(e.copy(),n,i)},ms(s,e)}(o.scale.linear(),1,[0,1])},o.scale.sqrt=function(){return o.scale.pow().exponent(.5)},o.scale.ordinal=function(){return function t(e,n){var i,r,s;function a(t){return r[((i.get(t)||("range"===n.t?i.set(t,e.push(t)):NaN))-1)%r.length]}function l(t,n){return o.range(e.length).map(function(e){return t+n*e})}return a.domain=function(t){if(!arguments.length)return e;e=[],i=new k;for(var r,o=-1,s=t.length;++o<s;)i.has(r=t[o])||i.set(r,e.push(r));return a[n.t].apply(a,n.a)},a.range=function(t){return arguments.length?(r=t,s=0,n={t:"range",a:arguments},a):r},a.rangePoints=function(t,i){arguments.length<2&&(i=0);var o=t[0],u=t[1],c=e.length<2?(o=(o+u)/2,0):(u-o)/(e.length-1+i);return r=l(o+c*i/2,c),s=0,n={t:"rangePoints",a:arguments},a},a.rangeRoundPoints=function(t,i){arguments.length<2&&(i=0);var o=t[0],u=t[1],c=e.length<2?(o=u=Math.round((o+u)/2),0):(u-o)/(e.length-1+i)|0;return r=l(o+Math.round(c*i/2+(u-o-(e.length-1+i)*c)/2),c),s=0,n={t:"rangeRoundPoints",a:arguments},a},a.rangeBands=function(t,i,o){arguments.length<2&&(i=0),arguments.length<3&&(o=i);var u=t[1]<t[0],c=t[u-0],d=(t[1-u]-c)/(e.length-i+2*o);return r=l(c+d*o,d),u&&r.reverse(),s=d*(1-i),n={t:"rangeBands",a:arguments},a},a.rangeRoundBands=function(t,i,o){arguments.length<2&&(i=0),arguments.length<3&&(o=i);var u=t[1]<t[0],c=t[u-0],d=t[1-u],h=Math.floor((d-c)/(e.length-i+2*o));return r=l(c+Math.round((d-c-(e.length-i)*h)/2),h),u&&r.reverse(),s=Math.round(h*(1-i)),n={t:"rangeRoundBands",a:arguments},a},a.rangeBand=function(){return s},a.rangeExtent=function(){return us(n.a[0])},a.copy=function(){return t(e,n)},a.domain(e)}([],{t:"range",a:[[]]})},o.scale.category10=function(){return o.scale.ordinal().range(Ss)},o.scale.category20=function(){return o.scale.ordinal().range(Ms)},o.scale.category20b=function(){return o.scale.ordinal().range(Es)},o.scale.category20c=function(){return o.scale.ordinal().range(Ns)};var Ss=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ce),Ms=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ce),Es=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ce),Ns=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ce);function Os(){return 0}o.scale.quantile=function(){return function t(e,n){var i;function r(){var t=0,r=n.length;for(i=[];++t<r;)i[t-1]=o.quantile(e,t/r);return s}function s(t){if(!isNaN(t=+t))return n[o.bisect(i,t)]}return s.domain=function(t){return arguments.length?(e=t.map(v).filter(y).sort(m),r()):e},s.range=function(t){return arguments.length?(n=t,r()):n},s.quantiles=function(){return i},s.invertExtent=function(t){return(t=n.indexOf(t))<0?[NaN,NaN]:[t>0?i[t-1]:e[0],t<i.length?i[t]:e[e.length-1]]},s.copy=function(){return t(e,n)},r()}([],[])},o.scale.quantize=function(){return function t(e,n,i){var r,o;function s(t){return i[Math.max(0,Math.min(o,Math.floor(r*(t-e))))]}function a(){return r=i.length/(n-e),o=i.length-1,s}return s.domain=function(t){return arguments.length?(e=+t[0],n=+t[t.length-1],a()):[e,n]},s.range=function(t){return arguments.length?(i=t,a()):i},s.invertExtent=function(t){return[t=(t=i.indexOf(t))<0?NaN:t/r+e,t+1/r]},s.copy=function(){return t(e,n,i)},a()}(0,1,[0,1])},o.scale.threshold=function(){return function t(e,n){function i(t){if(t<=t)return n[o.bisect(e,t)]}return i.domain=function(t){return arguments.length?(e=t,i):e},i.range=function(t){return arguments.length?(n=t,i):n},i.invertExtent=function(t){return t=n.indexOf(t),[e[t-1],e[t]]},i.copy=function(){return t(e,n)},i}([.5],[0,1])},o.scale.identity=function(){return function t(e){function n(t){return+t}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=t.map(n),n):e},n.ticks=function(t){return bs(e,t)},n.tickFormat=function(t,n){return _s(e,t,n)},n.copy=function(){return t(e)},n}([0,1])},o.svg={},o.svg.arc=function(){var t=Cs,e=Ps,n=Os,i=qs,r=js,o=Ds,s=Is;function a(){var a=Math.max(0,+t.apply(this,arguments)),u=Math.max(0,+e.apply(this,arguments)),c=r.apply(this,arguments)-Ct,d=o.apply(this,arguments)-Ct,h=Math.abs(d-c),p=c>d?0:1;if(u<a&&(f=u,u=a,a=f),h>=qt)return l(u,p)+(a?l(a,1-p):"")+"Z";var f,g,m,v,y,b,_,x,w,A,k,T,S=0,M=0,E=[];if((v=(+s.apply(this,arguments)||0)/2)&&(m=i===qs?Math.sqrt(a*a+u*u):+i.apply(this,arguments),p||(M*=-1),u&&(M=Lt(m/u*Math.sin(v))),a&&(S=Lt(m/a*Math.sin(v)))),u){y=u*Math.cos(c+M),b=u*Math.sin(c+M),_=u*Math.cos(d-M),x=u*Math.sin(d-M);var N=Math.abs(d-c-2*M)<=Nt?0:1;if(M&&Fs(y,b,_,x)===p^N){var O=(c+d)/2;y=u*Math.cos(O),b=u*Math.sin(O),_=x=null}}else y=b=0;if(a){w=a*Math.cos(d-S),A=a*Math.sin(d-S),k=a*Math.cos(c+S),T=a*Math.sin(c+S);var q=Math.abs(c-d+2*S)<=Nt?0:1;if(S&&Fs(w,A,k,T)===1-p^q){var C=(c+d)/2;w=a*Math.cos(C),A=a*Math.sin(C),k=T=null}}else w=A=0;if(h>Mt&&(f=Math.min(Math.abs(u-a)/2,+n.apply(this,arguments)))>.001){g=a<u^p?0:1;var P=f,j=f;if(h<Nt){var D=null==k?[w,A]:null==_?[y,b]:lr([y,b],[k,T],[_,x],[w,A]),I=y-D[0],F=b-D[1],L=_-D[0],z=x-D[1],R=1/Math.sin(Math.acos((I*L+F*z)/(Math.sqrt(I*I+F*F)*Math.sqrt(L*L+z*z)))/2),B=Math.sqrt(D[0]*D[0]+D[1]*D[1]);j=Math.min(f,(a-B)/(R-1)),P=Math.min(f,(u-B)/(R+1))}if(null!=_){var H=Ls(null==k?[w,A]:[k,T],[y,b],u,P,p),G=Ls([_,x],[w,A],u,P,p);f===P?E.push("M",H[0],"A",P,",",P," 0 0,",g," ",H[1],"A",u,",",u," 0 ",1-p^Fs(H[1][0],H[1][1],G[1][0],G[1][1]),",",p," ",G[1],"A",P,",",P," 0 0,",g," ",G[0]):E.push("M",H[0],"A",P,",",P," 0 1,",g," ",G[0])}else E.push("M",y,",",b);if(null!=k){var V=Ls([y,b],[k,T],a,-j,p),U=Ls([w,A],null==_?[y,b]:[_,x],a,-j,p);f===j?E.push("L",U[0],"A",j,",",j," 0 0,",g," ",U[1],"A",a,",",a," 0 ",p^Fs(U[1][0],U[1][1],V[1][0],V[1][1]),",",1-p," ",V[1],"A",j,",",j," 0 0,",g," ",V[0]):E.push("L",U[0],"A",j,",",j," 0 0,",g," ",V[0])}else E.push("L",w,",",A)}else E.push("M",y,",",b),null!=_&&E.push("A",u,",",u," 0 ",N,",",p," ",_,",",x),E.push("L",w,",",A),null!=k&&E.push("A",a,",",a," 0 ",q,",",1-p," ",k,",",T);return E.push("Z"),E.join("")}function l(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}return a.innerRadius=function(e){return arguments.length?(t=be(e),a):t},a.outerRadius=function(t){return arguments.length?(e=be(t),a):e},a.cornerRadius=function(t){return arguments.length?(n=be(t),a):n},a.padRadius=function(t){return arguments.length?(i=t==qs?qs:be(t),a):i},a.startAngle=function(t){return arguments.length?(r=be(t),a):r},a.endAngle=function(t){return arguments.length?(o=be(t),a):o},a.padAngle=function(t){return arguments.length?(s=be(t),a):s},a.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +o.apply(this,arguments))/2-Ct;return[Math.cos(i)*n,Math.sin(i)*n]},a};var qs="auto";function Cs(t){return t.innerRadius}function Ps(t){return t.outerRadius}function js(t){return t.startAngle}function Ds(t){return t.endAngle}function Is(t){return t&&t.padAngle}function Fs(t,e,n,i){return(t-n)*e-(e-i)*t>0?0:1}function Ls(t,e,n,i,r){var o=t[0]-e[0],s=t[1]-e[1],a=(r?i:-i)/Math.sqrt(o*o+s*s),l=a*s,u=-a*o,c=t[0]+l,d=t[1]+u,h=e[0]+l,p=e[1]+u,f=(c+h)/2,g=(d+p)/2,m=h-c,v=p-d,y=m*m+v*v,b=n-i,_=c*p-h*d,x=(v<0?-1:1)*Math.sqrt(Math.max(0,b*b*y-_*_)),w=(_*v-m*x)/y,A=(-_*m-v*x)/y,k=(_*v+m*x)/y,T=(-_*m+v*x)/y,S=w-f,M=A-g,E=k-f,N=T-g;return S*S+M*M>E*E+N*N&&(w=k,A=T),[[w-l,A-u],[w*n/b,A*n/b]]}function zs(t){var e=nr,n=ir,i=Jn,r=Bs,o=r.key,s=.7;function a(o){var a,l=[],u=[],c=-1,d=o.length,h=be(e),p=be(n);function f(){l.push("M",r(t(u),s))}for(;++c<d;)i.call(this,a=o[c],c)?u.push([+h.call(this,a,c),+p.call(this,a,c)]):u.length&&(f(),u=[]);return u.length&&f(),l.length?l.join(""):null}return a.x=function(t){return arguments.length?(e=t,a):e},a.y=function(t){return arguments.length?(n=t,a):n},a.defined=function(t){return arguments.length?(i=t,a):i},a.interpolate=function(t){return arguments.length?(o="function"==typeof t?r=t:(r=Rs.get(t)||Bs).key,a):o},a.tension=function(t){return arguments.length?(s=t,a):s},a}o.svg.line=function(){return zs(D)};var Rs=o.map({linear:Bs,"linear-closed":Hs,step:function(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i[0]+(i=t[e])[0])/2,"V",i[1]);return n>1&&r.push("H",i[0]),r.join("")},"step-before":Gs,"step-after":Vs,basis:Qs,"basis-open":function(t){if(t.length<4)return Bs(t);for(var e,n=[],i=-1,r=t.length,o=[0],s=[0];++i<3;)e=t[i],o.push(e[0]),s.push(e[1]);for(n.push($s(Zs,o)+","+$s(Zs,s)),--i;++i<r;)e=t[i],o.shift(),o.push(e[0]),s.shift(),s.push(e[1]),Ys(n,o,s);return n.join("")},"basis-closed":function(t){for(var e,n,i=-1,r=t.length,o=r+4,s=[],a=[];++i<4;)n=t[i%r],s.push(n[0]),a.push(n[1]);for(e=[$s(Zs,s),",",$s(Zs,a)],--i;++i<o;)n=t[i%r],s.shift(),s.push(n[0]),a.shift(),a.push(n[1]),Ys(e,s,a);return e.join("")},bundle:function(t,e){var n=t.length-1;if(n)for(var i,r,o=t[0][0],s=t[0][1],a=t[n][0]-o,l=t[n][1]-s,u=-1;++u<=n;)r=u/n,(i=t[u])[0]=e*i[0]+(1-e)*(o+r*a),i[1]=e*i[1]+(1-e)*(s+r*l);return Qs(t)},cardinal:function(t,e){return t.length<3?Bs(t):t[0]+Us(t,Ws(t,e))},"cardinal-open":function(t,e){return t.length<4?Bs(t):t[1]+Us(t.slice(1,-1),Ws(t,e))},"cardinal-closed":function(t,e){return t.length<3?Hs(t):t[0]+Us((t.push(t[0]),t),Ws([t[t.length-2]].concat(t,[t[1]]),e))},monotone:function(t){return t.length<3?Bs(t):t[0]+Us(t,function(t){for(var e,n,i,r,o=[],s=function(t){for(var e=0,n=t.length-1,i=[],r=t[0],o=t[1],s=i[0]=Xs(r,o);++e<n;)i[e]=(s+(s=Xs(r=o,o=t[e+1])))/2;return i[e]=s,i}(t),a=-1,l=t.length-1;++a<l;)e=Xs(t[a],t[a+1]),w(e)<Mt?s[a]=s[a+1]=0:(r=(n=s[a]/e)*n+(i=s[a+1]/e)*i)>9&&(r=3*e/Math.sqrt(r),s[a]=r*n,s[a+1]=r*i);for(a=-1;++a<=l;)r=(t[Math.min(l,a+1)][0]-t[Math.max(0,a-1)][0])/(6*(1+s[a]*s[a])),o.push([r||0,s[a]*r||0]);return o}(t))}});function Bs(t){return t.length>1?t.join("L"):t+"Z"}function Hs(t){return t.join("L")+"Z"}function Gs(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("V",(i=t[e])[1],"H",i[0]);return r.join("")}function Vs(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i=t[e])[0],"V",i[1]);return r.join("")}function Us(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return Bs(t);var n=t.length!=e.length,i="",r=t[0],o=t[1],s=e[0],a=s,l=1;if(n&&(i+="Q"+(o[0]-2*s[0]/3)+","+(o[1]-2*s[1]/3)+","+o[0]+","+o[1],r=t[1],l=2),e.length>1){a=e[1],o=t[l],l++,i+="C"+(r[0]+s[0])+","+(r[1]+s[1])+","+(o[0]-a[0])+","+(o[1]-a[1])+","+o[0]+","+o[1];for(var u=2;u<e.length;u++,l++)o=t[l],a=e[u],i+="S"+(o[0]-a[0])+","+(o[1]-a[1])+","+o[0]+","+o[1]}if(n){var c=t[l];i+="Q"+(o[0]+2*a[0]/3)+","+(o[1]+2*a[1]/3)+","+c[0]+","+c[1]}return i}function Ws(t,e){for(var n,i=[],r=(1-e)/2,o=t[0],s=t[1],a=1,l=t.length;++a<l;)n=o,o=s,s=t[a],i.push([r*(s[0]-n[0]),r*(s[1]-n[1])]);return i}function Qs(t){if(t.length<3)return Bs(t);var e=1,n=t.length,i=t[0],r=i[0],o=i[1],s=[r,r,r,(i=t[1])[0]],a=[o,o,o,i[1]],l=[r,",",o,"L",$s(Zs,s),",",$s(Zs,a)];for(t.push(t[n-1]);++e<=n;)i=t[e],s.shift(),s.push(i[0]),a.shift(),a.push(i[1]),Ys(l,s,a);return t.pop(),l.push("L",i),l.join("")}function $s(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}Rs.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var Ks=[0,2/3,1/3,0],Js=[0,1/3,2/3,0],Zs=[0,1/6,2/3,1/6];function Ys(t,e,n){t.push("C",$s(Ks,e),",",$s(Ks,n),",",$s(Js,e),",",$s(Js,n),",",$s(Zs,e),",",$s(Zs,n))}function Xs(t,e){return(e[1]-t[1])/(e[0]-t[0])}function ta(t){for(var e,n,i,r=-1,o=t.length;++r<o;)n=(e=t[r])[0],i=e[1]-Ct,e[0]=n*Math.cos(i),e[1]=n*Math.sin(i);return t}function ea(t){var e=nr,n=nr,i=0,r=ir,o=Jn,s=Bs,a=s.key,l=s,u="L",c=.7;function d(a){var d,h,p,f=[],g=[],m=[],v=-1,y=a.length,b=be(e),_=be(i),x=e===n?function(){return h}:be(n),w=i===r?function(){return p}:be(r);function A(){f.push("M",s(t(m),c),u,l(t(g.reverse()),c),"Z")}for(;++v<y;)o.call(this,d=a[v],v)?(g.push([h=+b.call(this,d,v),p=+_.call(this,d,v)]),m.push([+x.call(this,d,v),+w.call(this,d,v)])):g.length&&(A(),g=[],m=[]);return g.length&&A(),f.length?f.join(""):null}return d.x=function(t){return arguments.length?(e=n=t,d):n},d.x0=function(t){return arguments.length?(e=t,d):e},d.x1=function(t){return arguments.length?(n=t,d):n},d.y=function(t){return arguments.length?(i=r=t,d):r},d.y0=function(t){return arguments.length?(i=t,d):i},d.y1=function(t){return arguments.length?(r=t,d):r},d.defined=function(t){return arguments.length?(o=t,d):o},d.interpolate=function(t){return arguments.length?(a="function"==typeof t?s=t:(s=Rs.get(t)||Bs).key,l=s.reverse||s,u=s.closed?"M":"L",d):a},d.tension=function(t){return arguments.length?(c=t,d):c},d}function na(t){return t.radius}function ia(t){return[t.x,t.y]}function ra(){return 64}function oa(){return"circle"}function sa(t){var e=Math.sqrt(t/Nt);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}o.svg.line.radial=function(){var t=zs(ta);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},Gs.reverse=Vs,Vs.reverse=Gs,o.svg.area=function(){return ea(D)},o.svg.area.radial=function(){var t=ea(ta);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},o.svg.chord=function(){var t=Hi,e=Gi,n=na,i=js,r=Ds;function o(n,i){var r,o,u=s(this,t,n,i),c=s(this,e,n,i);return"M"+u.p0+a(u.r,u.p1,u.a1-u.a0)+(o=c,(r=u).a0==o.a0&&r.a1==o.a1?l(u.r,u.p1,u.r,u.p0):l(u.r,u.p1,c.r,c.p0)+a(c.r,c.p1,c.a1-c.a0)+l(c.r,c.p1,u.r,u.p0))+"Z"}function s(t,e,o,s){var a=e.call(t,o,s),l=n.call(t,a,s),u=i.call(t,a,s)-Ct,c=r.call(t,a,s)-Ct;return{r:l,a0:u,a1:c,p0:[l*Math.cos(u),l*Math.sin(u)],p1:[l*Math.cos(c),l*Math.sin(c)]}}function a(t,e,n){return"A"+t+","+t+" 0 "+ +(n>Nt)+",1 "+e}function l(t,e,n,i){return"Q 0,0 "+i}return o.radius=function(t){return arguments.length?(n=be(t),o):n},o.source=function(e){return arguments.length?(t=be(e),o):t},o.target=function(t){return arguments.length?(e=be(t),o):e},o.startAngle=function(t){return arguments.length?(i=be(t),o):i},o.endAngle=function(t){return arguments.length?(r=be(t),o):r},o},o.svg.diagonal=function(){var t=Hi,e=Gi,n=ia;function i(i,r){var o=t.call(this,i,r),s=e.call(this,i,r),a=(o.y+s.y)/2,l=[o,{x:o.x,y:a},{x:s.x,y:a},s];return"M"+(l=l.map(n))[0]+"C"+l[1]+" "+l[2]+" "+l[3]}return i.source=function(e){return arguments.length?(t=be(e),i):t},i.target=function(t){return arguments.length?(e=be(t),i):e},i.projection=function(t){return arguments.length?(n=t,i):n},i},o.svg.diagonal.radial=function(){var t=o.svg.diagonal(),e=ia,n=t.projection;return t.projection=function(t){return arguments.length?n(function(t){return function(){var e=t.apply(this,arguments),n=e[0],i=e[1]-Ct;return[n*Math.cos(i),n*Math.sin(i)]}}(e=t)):e},t},o.svg.symbol=function(){var t=oa,e=ra;function n(n,i){return(aa.get(t.call(this,n,i))||sa)(e.call(this,n,i))}return n.type=function(e){return arguments.length?(t=be(e),n):t},n.size=function(t){return arguments.length?(e=be(t),n):e},n};var aa=o.map({circle:sa,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*ua)),n=e*ua;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/la),n=e*la/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/la),n=e*la/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});o.svg.symbolTypes=aa.keys();var la=Math.sqrt(3),ua=Math.tan(30*Pt);Z.transition=function(t){for(var e,n,i=pa||++ma,r=ba(t),o=[],s=fa||{time:Date.now(),ease:io,delay:0,duration:250},a=-1,l=this.length;++a<l;){o.push(e=[]);for(var u=this[a],c=-1,d=u.length;++c<d;)(n=u[c])&&_a(n,c,r,i,s),e.push(n)}return ha(o,r,i)},Z.interrupt=function(t){return this.each(null==t?ca:da(ba(t)))};var ca=da(ba());function da(t){return function(){var e,n,i;(e=this[t])&&(i=e[n=e.active])&&(i.timer.c=null,i.timer.t=NaN,--e.count?delete e[n]:delete this[t],e.active+=.5,i.event&&i.event.interrupt.call(this,this.__data__,i.index))}}function ha(t,e,n){return W(t,ga),t.namespace=e,t.id=n,t}var pa,fa,ga=[],ma=0;function va(t,e,n,i){var r=t.id,o=t.namespace;return ft(t,"function"==typeof n?function(t,s,a){t[o][r].tween.set(e,i(n.call(t,t.__data__,s,a)))}:(n=i(n),function(t){t[o][r].tween.set(e,n)}))}function ya(t){return null==t&&(t=""),function(){this.textContent=t}}function ba(t){return null==t?"__transition__":"__transition_"+t+"__"}function _a(t,e,n,i,r){var o,s,a,l,u,c=t[n]||(t[n]={active:0,count:0}),d=c[i];function h(n){var r=c.active,h=c[r];for(var f in h&&(h.timer.c=null,h.timer.t=NaN,--c.count,delete c[r],h.event&&h.event.interrupt.call(t,t.__data__,h.index)),c)if(+f<i){var g=c[f];g.timer.c=null,g.timer.t=NaN,--c.count,delete c[f]}s.c=p,Me(function(){return s.c&&p(n||1)&&(s.c=null,s.t=NaN),1},0,o),c.active=i,d.event&&d.event.start.call(t,t.__data__,e),u=[],d.tween.forEach(function(n,i){(i=i.call(t,t.__data__,e))&&u.push(i)}),l=d.ease,a=d.duration}function p(r){for(var o=r/a,s=l(o),h=u.length;h>0;)u[--h].call(t,s);if(o>=1)return d.event&&d.event.end.call(t,t.__data__,e),--c.count?delete c[i]:delete t[n],1}d||(o=r.time,s=Me(function(t){var e=d.delay;if(s.t=e+o,e<=t)return h(t-e);s.c=h},0,o),d=c[i]={tween:new k,time:o,timer:s,delay:r.delay,duration:r.duration,ease:r.ease,index:e},r=null,++c.count)}ga.call=Z.call,ga.empty=Z.empty,ga.node=Z.node,ga.size=Z.size,o.transition=function(t,e){return t&&t.transition?pa?t.transition(e):t:o.selection().transition(t)},o.transition.prototype=ga,ga.select=function(t){var e,n,i,r=this.id,o=this.namespace,s=[];t=Y(t);for(var a=-1,l=this.length;++a<l;){s.push(e=[]);for(var u=this[a],c=-1,d=u.length;++c<d;)(i=u[c])&&(n=t.call(i,i.__data__,c,a))?("__data__"in i&&(n.__data__=i.__data__),_a(n,c,o,r,i[o][r]),e.push(n)):e.push(null)}return ha(s,o,r)},ga.selectAll=function(t){var e,n,i,r,o,s=this.id,a=this.namespace,l=[];t=X(t);for(var u=-1,c=this.length;++u<c;)for(var d=this[u],h=-1,p=d.length;++h<p;)if(i=d[h]){o=i[a][s],n=t.call(i,i.__data__,h,u),l.push(e=[]);for(var f=-1,g=n.length;++f<g;)(r=n[f])&&_a(r,f,a,s,o),e.push(r)}return ha(l,a,s)},ga.filter=function(t){var e,n,i=[];"function"!=typeof t&&(t=pt(t));for(var r=0,o=this.length;r<o;r++){i.push(e=[]);for(var s,a=0,l=(s=this[r]).length;a<l;a++)(n=s[a])&&t.call(n,n.__data__,a,r)&&e.push(n)}return ha(i,this.namespace,this.id)},ga.tween=function(t,e){var n=this.id,i=this.namespace;return arguments.length<2?this.node()[i][n].tween.get(t):ft(this,null==e?function(e){e[i][n].tween.remove(t)}:function(r){r[i][n].tween.set(t,e)})},ga.attr=function(t,e){if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var n="transform"==t?go:$r,i=o.ns.qualify(t);function r(){this.removeAttribute(i)}function s(){this.removeAttributeNS(i.space,i.local)}return va(this,"attr."+t,e,i.local?function(t){return null==t?s:(t+="",function(){var e,r=this.getAttributeNS(i.space,i.local);return r!==t&&(e=n(r,t),function(t){this.setAttributeNS(i.space,i.local,e(t))})})}:function(t){return null==t?r:(t+="",function(){var e,r=this.getAttribute(i);return r!==t&&(e=n(r,t),function(t){this.setAttribute(i,e(t))})})})},ga.attrTween=function(t,e){var n=o.ns.qualify(t);return this.tween("attr."+t,n.local?function(t,i){var r=e.call(this,t,i,this.getAttributeNS(n.space,n.local));return r&&function(t){this.setAttributeNS(n.space,n.local,r(t))}}:function(t,i){var r=e.call(this,t,i,this.getAttribute(n));return r&&function(t){this.setAttribute(n,r(t))}})},ga.style=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=""),t)this.style(n,t[n],e);return this}n=""}function r(){this.style.removeProperty(t)}return va(this,"style."+t,e,function(e){return null==e?r:(e+="",function(){var i,r=c(this).getComputedStyle(this,null).getPropertyValue(t);return r!==e&&(i=$r(r,e),function(e){this.style.setProperty(t,i(e),n)})})})},ga.styleTween=function(t,e,n){return arguments.length<3&&(n=""),this.tween("style."+t,function(i,r){var o=e.call(this,i,r,c(this).getComputedStyle(this,null).getPropertyValue(t));return o&&function(e){this.style.setProperty(t,o(e),n)}})},ga.text=function(t){return va(this,"text",t,ya)},ga.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var e;this[t].count<2&&(e=this.parentNode)&&e.removeChild(this)})},ga.ease=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].ease:("function"!=typeof t&&(t=o.ease.apply(o,arguments)),ft(this,function(i){i[n][e].ease=t}))},ga.delay=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].delay:ft(this,"function"==typeof t?function(i,r,o){i[n][e].delay=+t.call(i,i.__data__,r,o)}:(t=+t,function(i){i[n][e].delay=t}))},ga.duration=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].duration:ft(this,"function"==typeof t?function(i,r,o){i[n][e].duration=Math.max(1,t.call(i,i.__data__,r,o))}:(t=Math.max(1,t),function(i){i[n][e].duration=t}))},ga.each=function(t,e){var n=this.id,i=this.namespace;if(arguments.length<2){var r=fa,s=pa;try{pa=n,ft(this,function(e,r,o){fa=e[i][n],t.call(e,e.__data__,r,o)})}finally{fa=r,pa=s}}else ft(this,function(r){var s=r[i][n];(s.event||(s.event=o.dispatch("start","end","interrupt"))).on(t,e)});return this},ga.transition=function(){for(var t,e,n,i=this.id,r=++ma,o=this.namespace,s=[],a=0,l=this.length;a<l;a++){s.push(t=[]);for(var u,c=0,d=(u=this[a]).length;c<d;c++)(e=u[c])&&_a(e,c,o,r,{time:(n=e[o][i]).time,ease:n.ease,delay:n.delay+n.duration,duration:n.duration}),t.push(e)}return ha(s,o,r)},o.svg.axis=function(){var t,e=o.scale.linear(),n=xa,i=6,r=6,s=3,l=[10],u=null;function c(a){a.each(function(){var a,c=o.select(this),d=this.__chart__||e,h=this.__chart__=e.copy(),p=null==u?h.ticks?h.ticks.apply(h,l):h.domain():u,f=null==t?h.tickFormat?h.tickFormat.apply(h,l):D:t,g=c.selectAll(".tick").data(p,h),m=g.enter().insert("g",".domain").attr("class","tick").style("opacity",Mt),v=o.transition(g.exit()).style("opacity",Mt).remove(),y=o.transition(g.order()).style("opacity",1),b=Math.max(i,0)+s,_=cs(h),x=c.selectAll(".domain").data([0]),w=(x.enter().append("path").attr("class","domain"),o.transition(x));m.append("line"),m.append("text");var A,k,T,S,M=m.select("line"),E=y.select("line"),N=g.select("text").text(f),O=m.select("text"),q=y.select("text"),C="top"===n||"left"===n?-1:1;if("bottom"===n||"top"===n?(a=Aa,A="x",T="y",k="x2",S="y2",N.attr("dy",C<0?"0em":".71em").style("text-anchor","middle"),w.attr("d","M"+_[0]+","+C*r+"V0H"+_[1]+"V"+C*r)):(a=ka,A="y",T="x",k="y2",S="x2",N.attr("dy",".32em").style("text-anchor",C<0?"end":"start"),w.attr("d","M"+C*r+","+_[0]+"H0V"+_[1]+"H"+C*r)),M.attr(S,C*i),O.attr(T,C*b),E.attr(k,0).attr(S,C*i),q.attr(A,0).attr(T,C*b),h.rangeBand){var P=h,j=P.rangeBand()/2;d=h=function(t){return P(t)+j}}else d.rangeBand?d=h:v.call(a,h,d);m.call(a,d,h),y.call(a,h,h)})}return c.scale=function(t){return arguments.length?(e=t,c):e},c.orient=function(t){return arguments.length?(n=t in wa?t+"":xa,c):n},c.ticks=function(){return arguments.length?(l=a(arguments),c):l},c.tickValues=function(t){return arguments.length?(u=t,c):u},c.tickFormat=function(e){return arguments.length?(t=e,c):t},c.tickSize=function(t){var e=arguments.length;return e?(i=+t,r=+arguments[e-1],c):i},c.innerTickSize=function(t){return arguments.length?(i=+t,c):i},c.outerTickSize=function(t){return arguments.length?(r=+t,c):r},c.tickPadding=function(t){return arguments.length?(s=+t,c):s},c.tickSubdivide=function(){return arguments.length&&c},c};var xa="bottom",wa={top:1,right:1,bottom:1,left:1};function Aa(t,e,n){t.attr("transform",function(t){var i=e(t);return"translate("+(isFinite(i)?i:n(t))+",0)"})}function ka(t,e,n){t.attr("transform",function(t){var i=e(t);return"translate(0,"+(isFinite(i)?i:n(t))+")"})}o.svg.brush=function(){var t,e,n=V(h,"brushstart","brush","brushend"),i=null,r=null,s=[0,0],a=[0,0],l=!0,u=!0,d=Sa[0];function h(t){t.each(function(){var t=o.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",m).on("touchstart.brush",m),e=t.selectAll(".background").data([0]);e.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var n=t.selectAll(".resize").data(d,D);n.exit().remove(),n.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Ta[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),n.style("display",h.empty()?"none":null);var s,a=o.transition(t),l=o.transition(e);i&&(s=cs(i),l.attr("x",s[0]).attr("width",s[1]-s[0]),f(a)),r&&(s=cs(r),l.attr("y",s[0]).attr("height",s[1]-s[0]),g(a)),p(a)})}function p(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+s[+/e$/.test(t)]+","+a[+/^s/.test(t)]+")"})}function f(t){t.select(".extent").attr("x",s[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",s[1]-s[0])}function g(t){t.select(".extent").attr("y",a[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",a[1]-a[0])}function m(){var d,m,v=this,y=o.select(o.event.target),b=n.of(v,arguments),_=o.select(v),x=y.datum(),w=!/^(n|s)$/.test(x)&&i,A=!/^(e|w)$/.test(x)&&r,k=y.classed("extent"),T=At(v),S=o.mouse(v),M=o.select(c(v)).on("keydown.brush",function(){32==o.event.keyCode&&(k||(d=null,S[0]-=s[1],S[1]-=a[1],k=2),H())}).on("keyup.brush",function(){32==o.event.keyCode&&2==k&&(S[0]+=s[1],S[1]+=a[1],k=0,H())});if(o.event.changedTouches?M.on("touchmove.brush",O).on("touchend.brush",C):M.on("mousemove.brush",O).on("mouseup.brush",C),_.interrupt().selectAll("*").interrupt(),k)S[0]=s[0]-S[0],S[1]=a[0]-S[1];else if(x){var E=+/w$/.test(x),N=+/^n/.test(x);m=[s[1-E]-S[0],a[1-N]-S[1]],S[0]=s[E],S[1]=a[N]}else o.event.altKey&&(d=S.slice());function O(){var t=o.mouse(v),e=!1;m&&(t[0]+=m[0],t[1]+=m[1]),k||(o.event.altKey?(d||(d=[(s[0]+s[1])/2,(a[0]+a[1])/2]),S[0]=s[+(t[0]<d[0])],S[1]=a[+(t[1]<d[1])]):d=null),w&&q(t,i,0)&&(f(_),e=!0),A&&q(t,r,1)&&(g(_),e=!0),e&&(p(_),b({type:"brush",mode:k?"move":"resize"}))}function q(n,i,r){var o,c,h=cs(i),p=h[0],f=h[1],g=S[r],m=r?a:s,v=m[1]-m[0];if(k&&(p-=g,f-=v+g),o=(r?u:l)?Math.max(p,Math.min(f,n[r])):n[r],k?c=(o+=g)+v:(d&&(g=Math.max(p,Math.min(f,2*d[r]-o))),g<o?(c=o,o=g):c=g),m[0]!=o||m[1]!=c)return r?e=null:t=null,m[0]=o,m[1]=c,!0}function C(){O(),_.style("pointer-events","all").selectAll(".resize").style("display",h.empty()?"none":null),o.select("body").style("cursor",null),M.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),T(),b({type:"brushend"})}_.style("pointer-events","none").selectAll(".resize").style("display",null),o.select("body").style("cursor",y.style("cursor")),b({type:"brushstart"}),O()}return h.event=function(i){i.each(function(){var i=n.of(this,arguments),r={x:s,y:a,i:t,j:e},l=this.__chart__||r;this.__chart__=r,pa?o.select(this).transition().each("start.brush",function(){t=l.i,e=l.j,s=l.x,a=l.y,i({type:"brushstart"})}).tween("brush:brush",function(){var n=Kr(s,r.x),o=Kr(a,r.y);return t=e=null,function(t){s=r.x=n(t),a=r.y=o(t),i({type:"brush",mode:"resize"})}}).each("end.brush",function(){t=r.i,e=r.j,i({type:"brush",mode:"resize"}),i({type:"brushend"})}):(i({type:"brushstart"}),i({type:"brush",mode:"resize"}),i({type:"brushend"}))})},h.x=function(t){return arguments.length?(d=Sa[!(i=t)<<1|!r],h):i},h.y=function(t){return arguments.length?(d=Sa[!i<<1|!(r=t)],h):r},h.clamp=function(t){return arguments.length?(i&&r?(l=!!t[0],u=!!t[1]):i?l=!!t:r&&(u=!!t),h):i&&r?[l,u]:i?l:r?u:null},h.extent=function(n){var o,l,u,c,d;return arguments.length?(i&&(o=n[0],l=n[1],r&&(o=o[0],l=l[0]),t=[o,l],i.invert&&(o=i(o),l=i(l)),l<o&&(d=o,o=l,l=d),o==s[0]&&l==s[1]||(s=[o,l])),r&&(u=n[0],c=n[1],i&&(u=u[1],c=c[1]),e=[u,c],r.invert&&(u=r(u),c=r(c)),c<u&&(d=u,u=c,c=d),u==a[0]&&c==a[1]||(a=[u,c])),h):(i&&(t?(o=t[0],l=t[1]):(o=s[0],l=s[1],i.invert&&(o=i.invert(o),l=i.invert(l)),l<o&&(d=o,o=l,l=d))),r&&(e?(u=e[0],c=e[1]):(u=a[0],c=a[1],r.invert&&(u=r.invert(u),c=r.invert(c)),c<u&&(d=u,u=c,c=d))),i&&r?[[o,u],[l,c]]:i?[o,l]:r&&[u,c])},h.clear=function(){return h.empty()||(s=[0,0],a=[0,0],t=e=null),h},h.empty=function(){return!!i&&s[0]==s[1]||!!r&&a[0]==a[1]},o.rebind(h,n,"on")};var Ta={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Sa=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ma=Ie.format=dn.timeFormat,Ea=Ma.utc,Na=Ea("%Y-%m-%dT%H:%M:%S.%LZ");function Oa(t){return t.toISOString()}function qa(t,e,n){function i(e){return t(e)}function r(t,n){var i=(t[1]-t[0])/n,r=o.bisect(Pa,i);return r==Pa.length?[e.year,ys(t.map(function(t){return t/31536e6}),n)[2]]:r?e[i/Pa[r-1]<Pa[r]/i?r-1:r]:[Ia,ys(t,n)[2]]}return i.invert=function(e){return Ca(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain().map(Ca)},i.nice=function(t,e){var n=i.domain(),o=us(n),s=null==t?r(o,10):"number"==typeof t&&r(o,t);function a(n){return!isNaN(n)&&!t.range(n,Ca(+n+1),e).length}return s&&(t=s[0],e=s[1]),i.domain(hs(n,e>1?{floor:function(e){for(;a(e=t.floor(e));)e=Ca(e-1);return e},ceil:function(e){for(;a(e=t.ceil(e));)e=Ca(+e+1);return e}}:t))},i.ticks=function(t,e){var n=us(i.domain()),o=null==t?r(n,10):"number"==typeof t?r(n,t):!t.range&&[{range:t},e];return o&&(t=o[0],e=o[1]),t.range(n[0],Ca(+n[1]+1),e<1?1:e)},i.tickFormat=function(){return n},i.copy=function(){return qa(t.copy(),e,n)},ms(i,t)}function Ca(t){return new Date(t)}Ma.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Oa:Na,Oa.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Oa.toString=Na.toString,Ie.second=Re(function(t){return new Fe(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),Ie.seconds=Ie.second.range,Ie.seconds.utc=Ie.second.utc.range,Ie.minute=Re(function(t){return new Fe(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),Ie.minutes=Ie.minute.range,Ie.minutes.utc=Ie.minute.utc.range,Ie.hour=Re(function(t){var e=t.getTimezoneOffset()/60;return new Fe(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),Ie.hours=Ie.hour.range,Ie.hours.utc=Ie.hour.utc.range,Ie.month=Re(function(t){return(t=Ie.day(t)).setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),Ie.months=Ie.month.range,Ie.months.utc=Ie.month.utc.range;var Pa=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],ja=[[Ie.second,1],[Ie.second,5],[Ie.second,15],[Ie.second,30],[Ie.minute,1],[Ie.minute,5],[Ie.minute,15],[Ie.minute,30],[Ie.hour,1],[Ie.hour,3],[Ie.hour,6],[Ie.hour,12],[Ie.day,1],[Ie.day,2],[Ie.week,1],[Ie.month,1],[Ie.month,3],[Ie.year,1]],Da=Ma.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Jn]]),Ia={range:function(t,e,n){return o.range(Math.ceil(t/n)*n,+e,n).map(Ca)},floor:D,ceil:D};ja.year=Ie.year,Ie.scale=function(){return qa(o.scale.linear(),ja,Da)};var Fa=ja.map(function(t){return[t[0].utc,t[1]]}),La=Ea.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Jn]]);function za(t){return JSON.parse(t.responseText)}function Ra(t){var e=l.createRange();return e.selectNode(l.body),e.createContextualFragment(t.responseText)}Fa.year=Ie.year.utc,Ie.scale.utc=function(){return qa(o.scale.linear(),Fa,La)},o.text=_e(function(t){return t.responseText}),o.json=function(t,e){return xe(t,"application/json",za,e)},o.html=function(t,e){return xe(t,"text/html",Ra,e)},o.xml=_e(function(t){return t.responseXML}),this.d3=o,void 0===(r="function"==typeof(i=o)?i.call(e,n,e,t):i)||(t.exports=r)}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.array=e.deepEquals=e.deepCopy=e.extendExisting=e.extend=e.object=e.uid=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.inherit=c,e.find=h,e.findIndex=p,e.getURLParameter=g,e.getAllURLParameters=function(){var t={};return""===location.search?t:(location.search.substr(1).split("&").forEach(function(e){var n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}),t)},e.byteLength=m,e.termsToAlgebriteString=v,e.loadScripts=y,e.getStackTrace=function(){var t={};return"undefined"!=typeof Error&&Error.captureStackTrace&&Error.captureStackTrace(t),t.stack};var r,o,s,a=n(0),l=n(1),u=e.uid=(r=15,o=[],s=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],function(){var t=0,e=4294967296*Math.random();return o[t++]=s[e&r],o[t++]=s[e>>>4&r],o[t++]=s[e>>>8&r],o[t++]=s[e>>>12&r],o[t++]=s[e>>>16&r],o[t++]=s[e>>>20&r],o[t++]=s[e>>>24&r],o[t++]=s[e>>>28&r],e=4294967296*Math.random(),o[t++]=s[e&r],o[t++]=s[e>>>4&r],o[t++]=s[e>>>8&r],o[t++]=s[e>>>12&r],o[t++]=s[e>>>16&r],o[t++]=s[e>>>20&r],o[t++]=s[e>>>24&r],o[t++]=s[e>>>28&r],"_"+o.join("")});function c(t,e){var n=e.prototype;for(var i in e.prototype=Object.create(t.prototype),n)e.prototype[i]=n[i];e.prototype.constructor=e,Object.defineProperty(e.prototype,"constructor",{enumerable:!1,value:e})}a.gmath.uid=u,a.gmath.inherit=c;var d=e.object={};function h(t,e){for(var n=0;n<t.length;n++)if(e(t[n],n,t))return t[n]}function p(t,e){for(var n=0;n<t.length;n++)if(e(t[n],n,t))return n;return-1}a.gmath.object=d,d.extend=function(t,e){if("object"===(void 0===e?"undefined":i(e))&&e)for(var n in e)t[n]=e[n];return t},a.gmath.extend=d.extend,e.extend=d.extend,d.extendExisting=function(t,e){for(var n in t)n in e&&(t[n]=e[n]);return t},e.extendExisting=d.extendExisting,d.extendChanged=function(t,e,n){for(var i in e)i in n&&!d.deepEquals(n[i],e[i])&&(t[i]=e[i]);return t},d.extendDifferent=function(t,e,n){for(var i in e)i in n&&d.deepEquals(n[i],e[i])||(t[i]=e[i]);return t},d.merged=function(t,e){return a.gmath.object.extend(a.gmath.object.extend({},t),e)},d.deepCopy=function(t){var e=t;if(Array.isArray(t)){e=[];for(var n=0;n<t.length;n++)e[n]=a.gmath.deepCopy(t[n])}else if("object"===(void 0===t?"undefined":i(t))&&t)for(var r in e={},t)t.hasOwnProperty(r)&&(e[r]=a.gmath.deepCopy(t[r]));return e},a.gmath.deepCopy=d.deepCopy,e.deepCopy=d.deepCopy,d.deepEquals=function(t,e){if(t===e)return!0;if(Array.isArray(t)){if(!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!d.deepEquals(t[n],e[n]))return!1;return!0}if("object"===(void 0===t?"undefined":i(t))&&t){if("object"===!(void 0===e||i(e))||!e)return!1;for(var r in t)if(t.hasOwnProperty(r)){if(!e.hasOwnProperty(r))return!1;if(!d.deepEquals(t[r],e[r]))return!1}return!0}return!1},a.gmath.deepEquals=d.deepEquals,e.deepEquals=d.deepEquals,a.gmath.find=h,a.gmath.findIndex=p;var f=e.array={};function g(t){var e=RegExp("(&|\\?)"+encodeURIComponent(t)+"=(.+?)(&|$)").exec(location.search);return e?decodeURIComponent(e[2]):null}function m(t){for(var e=t.length,n=t.length-1;n>=0;n--){var i=t.charCodeAt(n);i>127&&i<=2047?e++:i>2047&&i<=65535&&(e+=2),i>=56320&&i<=57343&&n--}return e}function v(t){var e={roots_as_powers:!0,bracketed_negatives:!0,subscripts_as_long_names:!0,var_subscripts_only:!0,rationalize_reals:!0,greek_symbols_to_latex:!0,absval_as_fn:!0,quote_placeholders:!0,parenthesisForFunctions:!0,normalizeSynonymsForFunctionLabels:!0};return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).eval_to_real&&(e.rationalize_reals=!1,e.integers_as_reals=!0),Array.isArray(t)||(t=[t]),l.Tree.is_range(t)&&t[0].is_group("div","mul")?t.map(function(t){return t.children[1].to_ascii(e)}).join("*"):t.map(function(t){return t.to_ascii(e)}).join("")}function y(t,e){t&&!Array.isArray(t)&&(t=[t]);var n=t.length;t.forEach(function(t,i){var r=document.createElement("script");r.type="text/javascript",e&&i===n-1&&(r.readyState?r.onreadystatechange=function(){"loaded"!=r.readyState&&"complete"!=r.readyState||(r.onreadystatechange=null,e&&e())}:r.onload=function(){e&&e()}),r.src=t,r.async=!1,document.head.appendChild(r)})}a.gmath.array=f,f.containsAll=function(t,e){if(e.length>t.length)return!1;for(var n=0;n<e.length;n++)if(-1===t.indexOf(e[n]))return!1;return!0},f.remove=function(t,e){var n=t.indexOf(e);return-1===n?[]:t.splice(n,1)},f.equals=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0},f.isPermutation=function(t,e){if(t=t.slice(),e.length!==t.length)return!1;for(var n=0;n<e.length;n++){var i=t.indexOf(e[n]);if(-1===i)return!1;t[i]=void 0}return!0},f.mergedNew=function(t,e){for(var n=t.slice(),i=0;i<e.length;i++)-1===t.indexOf(e[i])&&n.push(e[i]);return n},f.xor=function(t,e){for(var n=[],i=0;i<t.length;i++)-1===e.indexOf(t[i])&&n.push(t[i]);for(i=0;i<e.length;i++)-1===t.indexOf(e[i])&&n.push(e[i]);return n},f.flatten=function(t){for(var e=[],n=0;n<t.length;n++)e=e.concat(t[n]);return e},f.includes=function(t,e){return-1!==t.indexOf(e)},a.gmath.getURLParameter=g,a.gmath.byteLength=m,a.gmath.termsToAlgebriteString=v,a.gmath.loadScripts=y},function(t,e,n){var i;
/*!
 * jQuery JavaScript Library v3.2.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2017-03-20T18:59Z
 */
/*!
 * jQuery JavaScript Library v3.2.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2017-03-20T18:59Z
 */!function(e,n){"use strict";"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:this,function(n,r){"use strict";var o=[],s=n.document,a=Object.getPrototypeOf,l=o.slice,u=o.concat,c=o.push,d=o.indexOf,h={},p=h.toString,f=h.hasOwnProperty,g=f.toString,m=g.call(Object),v={};function y(t,e){var n=(e=e||s).createElement("script");n.text=t,e.head.appendChild(n).parentNode.removeChild(n)}var b=function(t,e){return new b.fn.init(t,e)},_=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,x=/^-ms-/,w=/-([a-z])/g,A=function(t,e){return e.toUpperCase()};function k(t){var e=!!t&&"length"in t&&t.length,n=b.type(t);return"function"!==n&&!b.isWindow(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}b.fn=b.prototype={jquery:"3.2.1",constructor:b,length:0,toArray:function(){return l.call(this)},get:function(t){return null==t?l.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=b.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return b.each(this,t)},map:function(t){return this.pushStack(b.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(l.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:o.sort,splice:o.splice},b.extend=b.fn.extend=function(){var t,e,n,i,r,o,s=arguments[0]||{},a=1,l=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[a]||{},a++),"object"==typeof s||b.isFunction(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)n=s[e],s!==(i=t[e])&&(u&&i&&(b.isPlainObject(i)||(r=Array.isArray(i)))?(r?(r=!1,o=n&&Array.isArray(n)?n:[]):o=n&&b.isPlainObject(n)?n:{},s[e]=b.extend(u,o,i)):void 0!==i&&(s[e]=i));return s},b.extend({expando:"jQuery"+("3.2.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===b.type(t)},isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=b.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==p.call(t)||(e=a(t))&&("function"!=typeof(n=f.call(e,"constructor")&&e.constructor)||g.call(n)!==m))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?h[p.call(t)]||"object":typeof t},globalEval:function(t){y(t)},camelCase:function(t){return t.replace(x,"ms-").replace(w,A)},each:function(t,e){var n,i=0;if(k(t))for(n=t.length;i<n&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},trim:function(t){return null==t?"":(t+"").replace(_,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(k(Object(t))?b.merge(n,"string"==typeof t?[t]:t):c.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:d.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;i<n;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i=[],r=0,o=t.length,s=!n;r<o;r++)!e(t[r],r)!==s&&i.push(t[r]);return i},map:function(t,e,n){var i,r,o=0,s=[];if(k(t))for(i=t.length;o<i;o++)null!=(r=e(t[o],o,n))&&s.push(r);else for(o in t)null!=(r=e(t[o],o,n))&&s.push(r);return u.apply([],s)},guid:1,proxy:function(t,e){var n,i,r;if("string"==typeof e&&(n=t[e],e=t,t=n),b.isFunction(t))return i=l.call(arguments,2),(r=function(){return t.apply(e||this,i.concat(l.call(arguments)))}).guid=t.guid=t.guid||b.guid++,r},now:Date.now,support:v}),"function"==typeof Symbol&&(b.fn[Symbol.iterator]=o[Symbol.iterator]),b.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){h["[object "+e+"]"]=e.toLowerCase()});var T=
/*!
 * Sizzle CSS Selector Engine v2.3.3
 * https://sizzlejs.com/
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2016-08-08
 */
function(t){var e,n,i,r,o,s,a,l,u,c,d,h,p,f,g,m,v,y,b,_="sizzle"+1*new Date,x=t.document,w=0,A=0,k=st(),T=st(),S=st(),M=function(t,e){return t===e&&(d=!0),0},E={}.hasOwnProperty,N=[],O=N.pop,q=N.push,C=N.push,P=N.slice,j=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},D="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",I="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",L="\\["+I+"*("+F+")(?:"+I+"*([*^$|!~]?=)"+I+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+I+"*\\]",z=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+L+")*)|.*)\\)|)",R=new RegExp(I+"+","g"),B=new RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),H=new RegExp("^"+I+"*,"+I+"*"),G=new RegExp("^"+I+"*([>+~]|"+I+")"+I+"*"),V=new RegExp("="+I+"*([^\\]'\"]*?)"+I+"*\\]","g"),U=new RegExp(z),W=new RegExp("^"+F+"$"),Q={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F+"|[*])"),ATTR:new RegExp("^"+L),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),bool:new RegExp("^(?:"+D+")$","i"),needsContext:new RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},$=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Y=/[+~]/,X=new RegExp("\\\\([\\da-f]{1,6}"+I+"?|("+I+")|.)","ig"),tt=function(t,e,n){var i="0x"+e-65536;return i!=i||n?e:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},et=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,nt=function(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},it=function(){h()},rt=yt(function(t){return!0===t.disabled&&("form"in t||"label"in t)},{dir:"parentNode",next:"legend"});try{C.apply(N=P.call(x.childNodes),x.childNodes),N[x.childNodes.length].nodeType}catch(t){C={apply:N.length?function(t,e){q.apply(t,P.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}function ot(t,e,i,r){var o,a,u,c,d,f,v,y=e&&e.ownerDocument,w=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==w&&9!==w&&11!==w)return i;if(!r&&((e?e.ownerDocument||e:x)!==p&&h(e),e=e||p,g)){if(11!==w&&(d=Z.exec(t)))if(o=d[1]){if(9===w){if(!(u=e.getElementById(o)))return i;if(u.id===o)return i.push(u),i}else if(y&&(u=y.getElementById(o))&&b(e,u)&&u.id===o)return i.push(u),i}else{if(d[2])return C.apply(i,e.getElementsByTagName(t)),i;if((o=d[3])&&n.getElementsByClassName&&e.getElementsByClassName)return C.apply(i,e.getElementsByClassName(o)),i}if(n.qsa&&!S[t+" "]&&(!m||!m.test(t))){if(1!==w)y=e,v=t;else if("object"!==e.nodeName.toLowerCase()){for((c=e.getAttribute("id"))?c=c.replace(et,nt):e.setAttribute("id",c=_),a=(f=s(t)).length;a--;)f[a]="#"+c+" "+vt(f[a]);v=f.join(","),y=Y.test(t)&&gt(e.parentNode)||e}if(v)try{return C.apply(i,y.querySelectorAll(v)),i}catch(t){}finally{c===_&&e.removeAttribute("id")}}}return l(t.replace(B,"$1"),e,i,r)}function st(){var t=[];return function e(n,r){return t.push(n+" ")>i.cacheLength&&delete e[t.shift()],e[n+" "]=r}}function at(t){return t[_]=!0,t}function lt(t){var e=p.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ut(t,e){for(var n=t.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=e}function ct(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function dt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ht(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function pt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&rt(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function ft(t){return at(function(e){return e=+e,at(function(n,i){for(var r,o=t([],n.length,e),s=o.length;s--;)n[r=o[s]]&&(n[r]=!(i[r]=n[r]))})})}function gt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=ot.support={},o=ot.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},h=ot.setDocument=function(t){var e,r,s=t?t.ownerDocument||t:x;return s!==p&&9===s.nodeType&&s.documentElement?(f=(p=s).documentElement,g=!o(p),x!==p&&(r=p.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",it,!1):r.attachEvent&&r.attachEvent("onunload",it)),n.attributes=lt(function(t){return t.className="i",!t.getAttribute("className")}),n.getElementsByTagName=lt(function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length}),n.getElementsByClassName=J.test(p.getElementsByClassName),n.getById=lt(function(t){return f.appendChild(t).id=_,!p.getElementsByName||!p.getElementsByName(_).length}),n.getById?(i.filter.ID=function(t){var e=t.replace(X,tt);return function(t){return t.getAttribute("id")===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n=e.getElementById(t);return n?[n]:[]}}):(i.filter.ID=function(t){var e=t.replace(X,tt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n,i,r,o=e.getElementById(t);if(o){if((n=o.getAttributeNode("id"))&&n.value===t)return[o];for(r=e.getElementsByName(t),i=0;o=r[i++];)if((n=o.getAttributeNode("id"))&&n.value===t)return[o]}return[]}}),i.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},i.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&g)return e.getElementsByClassName(t)},v=[],m=[],(n.qsa=J.test(p.querySelectorAll))&&(lt(function(t){f.appendChild(t).innerHTML="<a id='"+_+"'></a><select id='"+_+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+I+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\["+I+"*(?:value|"+D+")"),t.querySelectorAll("[id~="+_+"-]").length||m.push("~="),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+_+"+*").length||m.push(".#.+[+~]")}),lt(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name"+I+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),f.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")})),(n.matchesSelector=J.test(y=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&lt(function(t){n.disconnectedMatch=y.call(t,"*"),y.call(t,"[s!='']:x"),v.push("!=",z)}),m=m.length&&new RegExp(m.join("|")),v=v.length&&new RegExp(v.join("|")),e=J.test(f.compareDocumentPosition),b=e||J.test(f.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},M=e?function(t,e){if(t===e)return d=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===i?t===p||t.ownerDocument===x&&b(x,t)?-1:e===p||e.ownerDocument===x&&b(x,e)?1:c?j(c,t)-j(c,e):0:4&i?-1:1)}:function(t,e){if(t===e)return d=!0,0;var n,i=0,r=t.parentNode,o=e.parentNode,s=[t],a=[e];if(!r||!o)return t===p?-1:e===p?1:r?-1:o?1:c?j(c,t)-j(c,e):0;if(r===o)return ct(t,e);for(n=t;n=n.parentNode;)s.unshift(n);for(n=e;n=n.parentNode;)a.unshift(n);for(;s[i]===a[i];)i++;return i?ct(s[i],a[i]):s[i]===x?-1:a[i]===x?1:0},p):p},ot.matches=function(t,e){return ot(t,null,null,e)},ot.matchesSelector=function(t,e){if((t.ownerDocument||t)!==p&&h(t),e=e.replace(V,"='$1']"),n.matchesSelector&&g&&!S[e+" "]&&(!v||!v.test(e))&&(!m||!m.test(e)))try{var i=y.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){}return ot(e,p,null,[t]).length>0},ot.contains=function(t,e){return(t.ownerDocument||t)!==p&&h(t),b(t,e)},ot.attr=function(t,e){(t.ownerDocument||t)!==p&&h(t);var r=i.attrHandle[e.toLowerCase()],o=r&&E.call(i.attrHandle,e.toLowerCase())?r(t,e,!g):void 0;return void 0!==o?o:n.attributes||!g?t.getAttribute(e):(o=t.getAttributeNode(e))&&o.specified?o.value:null},ot.escape=function(t){return(t+"").replace(et,nt)},ot.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},ot.uniqueSort=function(t){var e,i=[],r=0,o=0;if(d=!n.detectDuplicates,c=!n.sortStable&&t.slice(0),t.sort(M),d){for(;e=t[o++];)e===t[o]&&(r=i.push(o));for(;r--;)t.splice(i[r],1)}return c=null,t},r=ot.getText=function(t){var e,n="",i=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=r(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[i++];)n+=r(e);return n},(i=ot.selectors={cacheLength:50,createPseudo:at,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(X,tt),t[3]=(t[3]||t[4]||t[5]||"").replace(X,tt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||ot.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&ot.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return Q.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&U.test(n)&&(e=s(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(X,tt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=k[t+" "];return e||(e=new RegExp("(^|"+I+")"+t+"("+I+"|$)"))&&k(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(i){var r=ot.attr(i,t);return null==r?"!="===e:!e||(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&r.indexOf(n)>-1:"$="===e?n&&r.slice(-n.length)===n:"~="===e?(" "+r.replace(R," ")+" ").indexOf(n)>-1:"|="===e&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,l){var u,c,d,h,p,f,g=o!==s?"nextSibling":"previousSibling",m=e.parentNode,v=a&&e.nodeName.toLowerCase(),y=!l&&!a,b=!1;if(m){if(o){for(;g;){for(h=e;h=h[g];)if(a?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[s?m.firstChild:m.lastChild],s&&y){for(b=(p=(u=(c=(d=(h=m)[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[t]||[])[0]===w&&u[1])&&u[2],h=p&&m.childNodes[p];h=++p&&h&&h[g]||(b=p=0)||f.pop();)if(1===h.nodeType&&++b&&h===e){c[t]=[w,p,b];break}}else if(y&&(b=p=(u=(c=(d=(h=e)[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[t]||[])[0]===w&&u[1]),!1===b)for(;(h=++p&&h&&h[g]||(b=p=0)||f.pop())&&((a?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++b||(y&&((c=(d=h[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[t]=[w,b]),h!==e)););return(b-=r)===i||b%i==0&&b/i>=0}}},PSEUDO:function(t,e){var n,r=i.pseudos[t]||i.setFilters[t.toLowerCase()]||ot.error("unsupported pseudo: "+t);return r[_]?r(e):r.length>1?(n=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?at(function(t,n){for(var i,o=r(t,e),s=o.length;s--;)t[i=j(t,o[s])]=!(n[i]=o[s])}):function(t){return r(t,0,n)}):r}},pseudos:{not:at(function(t){var e=[],n=[],i=a(t.replace(B,"$1"));return i[_]?at(function(t,e,n,r){for(var o,s=i(t,null,r,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))}):function(t,r,o){return e[0]=t,i(e,null,o,n),e[0]=null,!n.pop()}}),has:at(function(t){return function(e){return ot(t,e).length>0}}),contains:at(function(t){return t=t.replace(X,tt),function(e){return(e.textContent||e.innerText||r(e)).indexOf(t)>-1}}),lang:at(function(t){return W.test(t||"")||ot.error("unsupported lang: "+t),t=t.replace(X,tt).toLowerCase(),function(e){var n;do{if(n=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:pt(!1),disabled:pt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return K.test(t.nodeName)},input:function(t){return $.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:ft(function(){return[0]}),last:ft(function(t,e){return[e-1]}),eq:ft(function(t,e,n){return[n<0?n+e:n]}),even:ft(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:ft(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:ft(function(t,e,n){for(var i=n<0?n+e:n;--i>=0;)t.push(i);return t}),gt:ft(function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t})}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=dt(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=ht(e);function mt(){}function vt(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function yt(t,e,n){var i=e.dir,r=e.next,o=r||i,s=n&&"parentNode"===o,a=A++;return e.first?function(e,n,r){for(;e=e[i];)if(1===e.nodeType||s)return t(e,n,r);return!1}:function(e,n,l){var u,c,d,h=[w,a];if(l){for(;e=e[i];)if((1===e.nodeType||s)&&t(e,n,l))return!0}else for(;e=e[i];)if(1===e.nodeType||s)if(c=(d=e[_]||(e[_]={}))[e.uniqueID]||(d[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[i]||e;else{if((u=c[o])&&u[0]===w&&u[1]===a)return h[2]=u[2];if(c[o]=h,h[2]=t(e,n,l))return!0}return!1}}function bt(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function _t(t,e,n,i,r){for(var o,s=[],a=0,l=t.length,u=null!=e;a<l;a++)(o=t[a])&&(n&&!n(o,i,r)||(s.push(o),u&&e.push(a)));return s}function xt(t,e,n,i,r,o){return i&&!i[_]&&(i=xt(i)),r&&!r[_]&&(r=xt(r,o)),at(function(o,s,a,l){var u,c,d,h=[],p=[],f=s.length,g=o||function(t,e,n){for(var i=0,r=e.length;i<r;i++)ot(t,e[i],n);return n}(e||"*",a.nodeType?[a]:a,[]),m=!t||!o&&e?g:_t(g,h,t,a,l),v=n?r||(o?t:f||i)?[]:s:m;if(n&&n(m,v,a,l),i)for(u=_t(v,p),i(u,[],a,l),c=u.length;c--;)(d=u[c])&&(v[p[c]]=!(m[p[c]]=d));if(o){if(r||t){if(r){for(u=[],c=v.length;c--;)(d=v[c])&&u.push(m[c]=d);r(null,v=[],u,l)}for(c=v.length;c--;)(d=v[c])&&(u=r?j(o,d):h[c])>-1&&(o[u]=!(s[u]=d))}}else v=_t(v===s?v.splice(f,v.length):v),r?r(null,s,v,l):C.apply(s,v)})}function wt(t){for(var e,n,r,o=t.length,s=i.relative[t[0].type],a=s||i.relative[" "],l=s?1:0,c=yt(function(t){return t===e},a,!0),d=yt(function(t){return j(e,t)>-1},a,!0),h=[function(t,n,i){var r=!s&&(i||n!==u)||((e=n).nodeType?c(t,n,i):d(t,n,i));return e=null,r}];l<o;l++)if(n=i.relative[t[l].type])h=[yt(bt(h),n)];else{if((n=i.filter[t[l].type].apply(null,t[l].matches))[_]){for(r=++l;r<o&&!i.relative[t[r].type];r++);return xt(l>1&&bt(h),l>1&&vt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(B,"$1"),n,l<r&&wt(t.slice(l,r)),r<o&&wt(t=t.slice(r)),r<o&&vt(t))}h.push(n)}return bt(h)}return mt.prototype=i.filters=i.pseudos,i.setFilters=new mt,s=ot.tokenize=function(t,e){var n,r,o,s,a,l,u,c=T[t+" "];if(c)return e?0:c.slice(0);for(a=t,l=[],u=i.preFilter;a;){for(s in n&&!(r=H.exec(a))||(r&&(a=a.slice(r[0].length)||a),l.push(o=[])),n=!1,(r=G.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(B," ")}),a=a.slice(n.length)),i.filter)!(r=Q[s].exec(a))||u[s]&&!(r=u[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return e?a.length:a?ot.error(t):T(t,l).slice(0)},a=ot.compile=function(t,e){var n,r=[],o=[],a=S[t+" "];if(!a){for(e||(e=s(t)),n=e.length;n--;)(a=wt(e[n]))[_]?r.push(a):o.push(a);(a=S(t,function(t,e){var n=e.length>0,r=t.length>0,o=function(o,s,a,l,c){var d,f,m,v=0,y="0",b=o&&[],_=[],x=u,A=o||r&&i.find.TAG("*",c),k=w+=null==x?1:Math.random()||.1,T=A.length;for(c&&(u=s===p||s||c);y!==T&&null!=(d=A[y]);y++){if(r&&d){for(f=0,s||d.ownerDocument===p||(h(d),a=!g);m=t[f++];)if(m(d,s||p,a)){l.push(d);break}c&&(w=k)}n&&((d=!m&&d)&&v--,o&&b.push(d))}if(v+=y,n&&y!==v){for(f=0;m=e[f++];)m(b,_,s,a);if(o){if(v>0)for(;y--;)b[y]||_[y]||(_[y]=O.call(l));_=_t(_)}C.apply(l,_),c&&!o&&_.length>0&&v+e.length>1&&ot.uniqueSort(l)}return c&&(w=k,u=x),b};return n?at(o):o}(o,r))).selector=t}return a},l=ot.select=function(t,e,n,r){var o,l,u,c,d,h="function"==typeof t&&t,p=!r&&s(t=h.selector||t);if(n=n||[],1===p.length){if((l=p[0]=p[0].slice(0)).length>2&&"ID"===(u=l[0]).type&&9===e.nodeType&&g&&i.relative[l[1].type]){if(!(e=(i.find.ID(u.matches[0].replace(X,tt),e)||[])[0]))return n;h&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(o=Q.needsContext.test(t)?0:l.length;o--&&(u=l[o],!i.relative[c=u.type]);)if((d=i.find[c])&&(r=d(u.matches[0].replace(X,tt),Y.test(l[0].type)&&gt(e.parentNode)||e))){if(l.splice(o,1),!(t=r.length&&vt(l)))return C.apply(n,r),n;break}}return(h||a(t,p))(r,e,!g,n,!e||Y.test(t)&&gt(e.parentNode)||e),n},n.sortStable=_.split("").sort(M).join("")===_,n.detectDuplicates=!!d,h(),n.sortDetached=lt(function(t){return 1&t.compareDocumentPosition(p.createElement("fieldset"))}),lt(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||ut("type|href|height|width",function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),n.attributes&&lt(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||ut("value",function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),lt(function(t){return null==t.getAttribute("disabled")})||ut(D,function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),ot}(n);b.find=T,b.expr=T.selectors,b.expr[":"]=b.expr.pseudos,b.uniqueSort=b.unique=T.uniqueSort,b.text=T.getText,b.isXMLDoc=T.isXML,b.contains=T.contains,b.escapeSelector=T.escape;var S=function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&b(t).is(n))break;i.push(t)}return i},M=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},E=b.expr.match.needsContext;function N(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var O=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,q=/^.[^:#\[\.,]*$/;function C(t,e,n){return b.isFunction(e)?b.grep(t,function(t,i){return!!e.call(t,i,t)!==n}):e.nodeType?b.grep(t,function(t){return t===e!==n}):"string"!=typeof e?b.grep(t,function(t){return d.call(e,t)>-1!==n}):q.test(e)?b.filter(e,t,n):(e=b.filter(e,t),b.grep(t,function(t){return d.call(e,t)>-1!==n&&1===t.nodeType}))}b.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?b.find.matchesSelector(i,t)?[i]:[]:b.find.matches(t,b.grep(e,function(t){return 1===t.nodeType}))},b.fn.extend({find:function(t){var e,n,i=this.length,r=this;if("string"!=typeof t)return this.pushStack(b(t).filter(function(){for(e=0;e<i;e++)if(b.contains(r[e],this))return!0}));for(n=this.pushStack([]),e=0;e<i;e++)b.find(t,r[e],n);return i>1?b.uniqueSort(n):n},filter:function(t){return this.pushStack(C(this,t||[],!1))},not:function(t){return this.pushStack(C(this,t||[],!0))},is:function(t){return!!C(this,"string"==typeof t&&E.test(t)?b(t):t||[],!1).length}});var P,j=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(b.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||P,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:j.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof b?e[0]:e,b.merge(this,b.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:s,!0)),O.test(i[1])&&b.isPlainObject(e))for(i in e)b.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(r=s.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):b.isFunction(t)?void 0!==n.ready?n.ready(t):t(b):b.makeArray(t,this)}).prototype=b.fn,P=b(s);var D=/^(?:parents|prev(?:Until|All))/,I={children:!0,contents:!0,next:!0,prev:!0};function F(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}b.fn.extend({has:function(t){var e=b(t,this),n=e.length;return this.filter(function(){for(var t=0;t<n;t++)if(b.contains(this,e[t]))return!0})},closest:function(t,e){var n,i=0,r=this.length,o=[],s="string"!=typeof t&&b(t);if(!E.test(t))for(;i<r;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&b.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?b.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?d.call(b(t),this[0]):d.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(b.uniqueSort(b.merge(this.get(),b(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),b.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return S(t,"parentNode")},parentsUntil:function(t,e,n){return S(t,"parentNode",n)},next:function(t){return F(t,"nextSibling")},prev:function(t){return F(t,"previousSibling")},nextAll:function(t){return S(t,"nextSibling")},prevAll:function(t){return S(t,"previousSibling")},nextUntil:function(t,e,n){return S(t,"nextSibling",n)},prevUntil:function(t,e,n){return S(t,"previousSibling",n)},siblings:function(t){return M((t.parentNode||{}).firstChild,t)},children:function(t){return M(t.firstChild)},contents:function(t){return N(t,"iframe")?t.contentDocument:(N(t,"template")&&(t=t.content||t),b.merge([],t.childNodes))}},function(t,e){b.fn[t]=function(n,i){var r=b.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=b.filter(i,r)),this.length>1&&(I[t]||b.uniqueSort(r),D.test(t)&&r.reverse()),this.pushStack(r)}});var L=/[^\x20\t\r\n\f]+/g;function z(t){return t}function R(t){throw t}function B(t,e,n,i){var r;try{t&&b.isFunction(r=t.promise)?r.call(t).done(e).fail(n):t&&b.isFunction(r=t.then)?r.call(t,e,n):e.apply(void 0,[t].slice(i))}catch(t){n.apply(void 0,[t])}}b.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return b.each(t.match(L)||[],function(t,n){e[n]=!0}),e}(t):b.extend({},t);var e,n,i,r,o=[],s=[],a=-1,l=function(){for(r=r||t.once,i=e=!0;s.length;a=-1)for(n=s.shift();++a<o.length;)!1===o[a].apply(n[0],n[1])&&t.stopOnFalse&&(a=o.length,n=!1);t.memory||(n=!1),e=!1,r&&(o=n?[]:"")},u={add:function(){return o&&(n&&!e&&(a=o.length-1,s.push(n)),function e(n){b.each(n,function(n,i){b.isFunction(i)?t.unique&&u.has(i)||o.push(i):i&&i.length&&"string"!==b.type(i)&&e(i)})}(arguments),n&&!e&&l()),this},remove:function(){return b.each(arguments,function(t,e){for(var n;(n=b.inArray(e,o,n))>-1;)o.splice(n,1),n<=a&&a--}),this},has:function(t){return t?b.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=s=[],o=n="",this},disabled:function(){return!o},lock:function(){return r=s=[],n||e||(o=n=""),this},locked:function(){return!!r},fireWith:function(t,n){return r||(n=[t,(n=n||[]).slice?n.slice():n],s.push(n),e||l()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},b.extend({Deferred:function(t){var e=[["notify","progress",b.Callbacks("memory"),b.Callbacks("memory"),2],["resolve","done",b.Callbacks("once memory"),b.Callbacks("once memory"),0,"resolved"],["reject","fail",b.Callbacks("once memory"),b.Callbacks("once memory"),1,"rejected"]],i="pending",r={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return b.Deferred(function(n){b.each(e,function(e,i){var r=b.isFunction(t[i[4]])&&t[i[4]];o[i[1]](function(){var t=r&&r.apply(this,arguments);t&&b.isFunction(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,r?[t]:arguments)})}),t=null}).promise()},then:function(t,i,r){var o=0;function s(t,e,i,r){return function(){var a=this,l=arguments,u=function(){var n,u;if(!(t<o)){if((n=i.apply(a,l))===e.promise())throw new TypeError("Thenable self-resolution");u=n&&("object"==typeof n||"function"==typeof n)&&n.then,b.isFunction(u)?r?u.call(n,s(o,e,z,r),s(o,e,R,r)):(o++,u.call(n,s(o,e,z,r),s(o,e,R,r),s(o,e,z,e.notifyWith))):(i!==z&&(a=void 0,l=[n]),(r||e.resolveWith)(a,l))}},c=r?u:function(){try{u()}catch(n){b.Deferred.exceptionHook&&b.Deferred.exceptionHook(n,c.stackTrace),t+1>=o&&(i!==R&&(a=void 0,l=[n]),e.rejectWith(a,l))}};t?c():(b.Deferred.getStackHook&&(c.stackTrace=b.Deferred.getStackHook()),n.setTimeout(c))}}return b.Deferred(function(n){e[0][3].add(s(0,n,b.isFunction(r)?r:z,n.notifyWith)),e[1][3].add(s(0,n,b.isFunction(t)?t:z)),e[2][3].add(s(0,n,b.isFunction(i)?i:R))}).promise()},promise:function(t){return null!=t?b.extend(t,r):r}},o={};return b.each(e,function(t,n){var s=n[2],a=n[5];r[n[1]]=s.add,a&&s.add(function(){i=a},e[3-t][2].disable,e[0][2].lock),s.add(n[3].fire),o[n[0]]=function(){return o[n[0]+"With"](this===o?void 0:this,arguments),this},o[n[0]+"With"]=s.fireWith}),r.promise(o),t&&t.call(o,o),o},when:function(t){var e=arguments.length,n=e,i=Array(n),r=l.call(arguments),o=b.Deferred(),s=function(t){return function(n){i[t]=this,r[t]=arguments.length>1?l.call(arguments):n,--e||o.resolveWith(i,r)}};if(e<=1&&(B(t,o.done(s(n)).resolve,o.reject,!e),"pending"===o.state()||b.isFunction(r[n]&&r[n].then)))return o.then();for(;n--;)B(r[n],s(n),o.reject);return o.promise()}});var H=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;b.Deferred.exceptionHook=function(t,e){n.console&&n.console.warn&&t&&H.test(t.name)&&n.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},b.readyException=function(t){n.setTimeout(function(){throw t})};var G=b.Deferred();function V(){s.removeEventListener("DOMContentLoaded",V),n.removeEventListener("load",V),b.ready()}b.fn.ready=function(t){return G.then(t).catch(function(t){b.readyException(t)}),this},b.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--b.readyWait:b.isReady)||(b.isReady=!0,!0!==t&&--b.readyWait>0||G.resolveWith(s,[b]))}}),b.ready.then=G.then,"complete"===s.readyState||"loading"!==s.readyState&&!s.documentElement.doScroll?n.setTimeout(b.ready):(s.addEventListener("DOMContentLoaded",V),n.addEventListener("load",V));var U=function(t,e,n,i,r,o,s){var a=0,l=t.length,u=null==n;if("object"===b.type(n))for(a in r=!0,n)U(t,e,a,n[a],!0,o,s);else if(void 0!==i&&(r=!0,b.isFunction(i)||(s=!0),u&&(s?(e.call(t,i),e=null):(u=e,e=function(t,e,n){return u.call(b(t),n)})),e))for(;a<l;a++)e(t[a],n,s?i:i.call(t[a],a,e(t[a],n)));return r?t:u?e.call(t):l?e(t[0],n):o},W=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function Q(){this.expando=b.expando+Q.uid++}Q.uid=1,Q.prototype={cache:function(t){var e=t[this.expando];return e||(e={},W(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,r=this.cache(t);if("string"==typeof e)r[b.camelCase(e)]=n;else for(i in e)r[b.camelCase(i)]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][b.camelCase(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i=t[this.expando];if(void 0!==i){if(void 0!==e){n=(e=Array.isArray(e)?e.map(b.camelCase):(e=b.camelCase(e))in i?[e]:e.match(L)||[]).length;for(;n--;)delete i[e[n]]}(void 0===e||b.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!b.isEmptyObject(e)}};var $=new Q,K=new Q,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Z=/[A-Z]/g;function Y(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(Z,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:J.test(t)?JSON.parse(t):t)}(n)}catch(t){}K.set(t,e,n)}else n=void 0;return n}b.extend({hasData:function(t){return K.hasData(t)||$.hasData(t)},data:function(t,e,n){return K.access(t,e,n)},removeData:function(t,e){K.remove(t,e)},_data:function(t,e,n){return $.access(t,e,n)},_removeData:function(t,e){$.remove(t,e)}}),b.fn.extend({data:function(t,e){var n,i,r,o=this[0],s=o&&o.attributes;if(void 0===t){if(this.length&&(r=K.get(o),1===o.nodeType&&!$.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(i=s[n].name).indexOf("data-")&&(i=b.camelCase(i.slice(5)),Y(o,i,r[i]));$.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each(function(){K.set(this,t)}):U(this,function(e){var n;if(o&&void 0===e)return void 0!==(n=K.get(o,t))?n:void 0!==(n=Y(o,t))?n:void 0;this.each(function(){K.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){K.remove(this,t)})}}),b.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=$.get(t,e),n&&(!i||Array.isArray(n)?i=$.access(t,e,b.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=b.queue(t,e),i=n.length,r=n.shift(),o=b._queueHooks(t,e);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,function(){b.dequeue(t,e)},o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return $.get(t,n)||$.access(t,n,{empty:b.Callbacks("once memory").add(function(){$.remove(t,[e+"queue",n])})})}}),b.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?b.queue(this[0],t):void 0===e?this:this.each(function(){var n=b.queue(this,t,e);b._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&b.dequeue(this,t)})},dequeue:function(t){return this.each(function(){b.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=b.Deferred(),o=this,s=this.length,a=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(n=$.get(o[s],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),r.promise(e)}});var X=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,tt=new RegExp("^(?:([+-])=|)("+X+")([a-z%]*)$","i"),et=["Top","Right","Bottom","Left"],nt=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&b.contains(t.ownerDocument,t)&&"none"===b.css(t,"display")},it=function(t,e,n,i){var r,o,s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];for(o in r=n.apply(t,i||[]),e)t.style[o]=s[o];return r};function rt(t,e,n,i){var r,o=1,s=20,a=i?function(){return i.cur()}:function(){return b.css(t,e,"")},l=a(),u=n&&n[3]||(b.cssNumber[e]?"":"px"),c=(b.cssNumber[e]||"px"!==u&&+l)&&tt.exec(b.css(t,e));if(c&&c[3]!==u){u=u||c[3],n=n||[],c=+l||1;do{c/=o=o||".5",b.style(t,e,c+u)}while(o!==(o=a()/l)&&1!==o&&--s)}return n&&(c=+c||+l||0,r=n[1]?c+(n[1]+1)*n[2]:+n[2],i&&(i.unit=u,i.start=c,i.end=r)),r}var ot={};function st(t){var e,n=t.ownerDocument,i=t.nodeName,r=ot[i];return r||(e=n.body.appendChild(n.createElement(i)),r=b.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),ot[i]=r,r)}function at(t,e){for(var n,i,r=[],o=0,s=t.length;o<s;o++)(i=t[o]).style&&(n=i.style.display,e?("none"===n&&(r[o]=$.get(i,"display")||null,r[o]||(i.style.display="")),""===i.style.display&&nt(i)&&(r[o]=st(i))):"none"!==n&&(r[o]="none",$.set(i,"display",n)));for(o=0;o<s;o++)null!=r[o]&&(t[o].style.display=r[o]);return t}b.fn.extend({show:function(){return at(this,!0)},hide:function(){return at(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){nt(this)?b(this).show():b(this).hide()})}});var lt=/^(?:checkbox|radio)$/i,ut=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,ct=/^$|\/(?:java|ecma)script/i,dt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ht(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&N(t,e)?b.merge([t],n):n}function pt(t,e){for(var n=0,i=t.length;n<i;n++)$.set(t[n],"globalEval",!e||$.get(e[n],"globalEval"))}dt.optgroup=dt.option,dt.tbody=dt.tfoot=dt.colgroup=dt.caption=dt.thead,dt.th=dt.td;var ft,gt,mt=/<|&#?\w+;/;function vt(t,e,n,i,r){for(var o,s,a,l,u,c,d=e.createDocumentFragment(),h=[],p=0,f=t.length;p<f;p++)if((o=t[p])||0===o)if("object"===b.type(o))b.merge(h,o.nodeType?[o]:o);else if(mt.test(o)){for(s=s||d.appendChild(e.createElement("div")),a=(ut.exec(o)||["",""])[1].toLowerCase(),l=dt[a]||dt._default,s.innerHTML=l[1]+b.htmlPrefilter(o)+l[2],c=l[0];c--;)s=s.lastChild;b.merge(h,s.childNodes),(s=d.firstChild).textContent=""}else h.push(e.createTextNode(o));for(d.textContent="",p=0;o=h[p++];)if(i&&b.inArray(o,i)>-1)r&&r.push(o);else if(u=b.contains(o.ownerDocument,o),s=ht(d.appendChild(o),"script"),u&&pt(s),n)for(c=0;o=s[c++];)ct.test(o.type||"")&&n.push(o);return d}ft=s.createDocumentFragment().appendChild(s.createElement("div")),(gt=s.createElement("input")).setAttribute("type","radio"),gt.setAttribute("checked","checked"),gt.setAttribute("name","t"),ft.appendChild(gt),v.checkClone=ft.cloneNode(!0).cloneNode(!0).lastChild.checked,ft.innerHTML="<textarea>x</textarea>",v.noCloneChecked=!!ft.cloneNode(!0).lastChild.defaultValue;var yt=s.documentElement,bt=/^key/,_t=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,xt=/^([^.]*)(?:\.(.+)|)/;function wt(){return!0}function At(){return!1}function kt(){try{return s.activeElement}catch(t){}}function Tt(t,e,n,i,r,o){var s,a;if("object"==typeof e){for(a in"string"!=typeof n&&(i=i||n,n=void 0),e)Tt(t,a,n,i,e[a],o);return t}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=At;else if(!r)return t;return 1===o&&(s=r,(r=function(t){return b().off(t),s.apply(this,arguments)}).guid=s.guid||(s.guid=b.guid++)),t.each(function(){b.event.add(this,e,r,i,n)})}b.event={global:{},add:function(t,e,n,i,r){var o,s,a,l,u,c,d,h,p,f,g,m=$.get(t);if(m)for(n.handler&&(n=(o=n).handler,r=o.selector),r&&b.find.matchesSelector(yt,r),n.guid||(n.guid=b.guid++),(l=m.events)||(l=m.events={}),(s=m.handle)||(s=m.handle=function(e){return void 0!==b&&b.event.triggered!==e.type?b.event.dispatch.apply(t,arguments):void 0}),u=(e=(e||"").match(L)||[""]).length;u--;)p=g=(a=xt.exec(e[u])||[])[1],f=(a[2]||"").split(".").sort(),p&&(d=b.event.special[p]||{},p=(r?d.delegateType:d.bindType)||p,d=b.event.special[p]||{},c=b.extend({type:p,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&b.expr.match.needsContext.test(r),namespace:f.join(".")},o),(h=l[p])||((h=l[p]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(t,i,f,s)||t.addEventListener&&t.addEventListener(p,s)),d.add&&(d.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),r?h.splice(h.delegateCount++,0,c):h.push(c),b.event.global[p]=!0)},remove:function(t,e,n,i,r){var o,s,a,l,u,c,d,h,p,f,g,m=$.hasData(t)&&$.get(t);if(m&&(l=m.events)){for(u=(e=(e||"").match(L)||[""]).length;u--;)if(p=g=(a=xt.exec(e[u])||[])[1],f=(a[2]||"").split(".").sort(),p){for(d=b.event.special[p]||{},h=l[p=(i?d.delegateType:d.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=h.length;o--;)c=h[o],!r&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(h.splice(o,1),c.selector&&h.delegateCount--,d.remove&&d.remove.call(t,c));s&&!h.length&&(d.teardown&&!1!==d.teardown.call(t,f,m.handle)||b.removeEvent(t,p,m.handle),delete l[p])}else for(p in l)b.event.remove(t,p+e[u],n,i,!0);b.isEmptyObject(l)&&$.remove(t,"handle events")}},dispatch:function(t){var e,n,i,r,o,s,a=b.event.fix(t),l=new Array(arguments.length),u=($.get(this,"events")||{})[a.type]||[],c=b.event.special[a.type]||{};for(l[0]=a,e=1;e<arguments.length;e++)l[e]=arguments[e];if(a.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,a)){for(s=b.event.handlers.call(this,a,u),e=0;(r=s[e++])&&!a.isPropagationStopped();)for(a.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(o.namespace)||(a.handleObj=o,a.data=o.data,void 0!==(i=((b.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,l))&&!1===(a.result=i)&&(a.preventDefault(),a.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,a),a.result}},handlers:function(t,e){var n,i,r,o,s,a=[],l=e.delegateCount,u=t.target;if(l&&u.nodeType&&!("click"===t.type&&t.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==t.type||!0!==u.disabled)){for(o=[],s={},n=0;n<l;n++)void 0===s[r=(i=e[n]).selector+" "]&&(s[r]=i.needsContext?b(r,this).index(u)>-1:b.find(r,this,null,[u]).length),s[r]&&o.push(i);o.length&&a.push({elem:u,handlers:o})}return u=this,l<e.length&&a.push({elem:u,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(b.Event.prototype,t,{enumerable:!0,configurable:!0,get:b.isFunction(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[b.expando]?t:new b.Event(t)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==kt()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===kt()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&N(this,"input"))return this.click(),!1},_default:function(t){return N(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},b.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},b.Event=function(t,e){if(!(this instanceof b.Event))return new b.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?wt:At,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&b.extend(this,e),this.timeStamp=t&&t.timeStamp||b.now(),this[b.expando]=!0},b.Event.prototype={constructor:b.Event,isDefaultPrevented:At,isPropagationStopped:At,isImmediatePropagationStopped:At,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=wt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=wt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=wt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},b.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&bt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&_t.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},b.event.addProp),b.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){b.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=t.relatedTarget,r=t.handleObj;return i&&(i===this||b.contains(this,i))||(t.type=r.origType,n=r.handler.apply(this,arguments),t.type=e),n}}}),b.fn.extend({on:function(t,e,n,i){return Tt(this,t,e,n,i)},one:function(t,e,n,i){return Tt(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,b(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=At),this.each(function(){b.event.remove(this,t,n,e)})}});var St=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Mt=/<script|<style|<link/i,Et=/checked\s*(?:[^=]|=\s*.checked.)/i,Nt=/^true\/(.*)/,Ot=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function qt(t,e){return N(t,"table")&&N(11!==e.nodeType?e:e.firstChild,"tr")&&b(">tbody",t)[0]||t}function Ct(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Pt(t){var e=Nt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function jt(t,e){var n,i,r,o,s,a,l,u;if(1===e.nodeType){if($.hasData(t)&&(o=$.access(t),s=$.set(e,o),u=o.events))for(r in delete s.handle,s.events={},u)for(n=0,i=u[r].length;n<i;n++)b.event.add(e,r,u[r][n]);K.hasData(t)&&(a=K.access(t),l=b.extend({},a),K.set(e,l))}}function Dt(t,e,n,i){e=u.apply([],e);var r,o,s,a,l,c,d=0,h=t.length,p=h-1,f=e[0],g=b.isFunction(f);if(g||h>1&&"string"==typeof f&&!v.checkClone&&Et.test(f))return t.each(function(r){var o=t.eq(r);g&&(e[0]=f.call(this,r,o.html())),Dt(o,e,n,i)});if(h&&(o=(r=vt(e,t[0].ownerDocument,!1,t,i)).firstChild,1===r.childNodes.length&&(r=o),o||i)){for(a=(s=b.map(ht(r,"script"),Ct)).length;d<h;d++)l=r,d!==p&&(l=b.clone(l,!0,!0),a&&b.merge(s,ht(l,"script"))),n.call(t[d],l,d);if(a)for(c=s[s.length-1].ownerDocument,b.map(s,Pt),d=0;d<a;d++)l=s[d],ct.test(l.type||"")&&!$.access(l,"globalEval")&&b.contains(c,l)&&(l.src?b._evalUrl&&b._evalUrl(l.src):y(l.textContent.replace(Ot,""),c))}return t}function It(t,e,n){for(var i,r=e?b.filter(e,t):t,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||b.cleanData(ht(i)),i.parentNode&&(n&&b.contains(i.ownerDocument,i)&&pt(ht(i,"script")),i.parentNode.removeChild(i));return t}b.extend({htmlPrefilter:function(t){return t.replace(St,"<$1></$2>")},clone:function(t,e,n){var i,r,o,s,a,l,u,c=t.cloneNode(!0),d=b.contains(t.ownerDocument,t);if(!(v.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||b.isXMLDoc(t)))for(s=ht(c),i=0,r=(o=ht(t)).length;i<r;i++)a=o[i],"input"===(u=(l=s[i]).nodeName.toLowerCase())&&lt.test(a.type)?l.checked=a.checked:"input"!==u&&"textarea"!==u||(l.defaultValue=a.defaultValue);if(e)if(n)for(o=o||ht(t),s=s||ht(c),i=0,r=o.length;i<r;i++)jt(o[i],s[i]);else jt(t,c);return(s=ht(c,"script")).length>0&&pt(s,!d&&ht(t,"script")),c},cleanData:function(t){for(var e,n,i,r=b.event.special,o=0;void 0!==(n=t[o]);o++)if(W(n)){if(e=n[$.expando]){if(e.events)for(i in e.events)r[i]?b.event.remove(n,i):b.removeEvent(n,i,e.handle);n[$.expando]=void 0}n[K.expando]&&(n[K.expando]=void 0)}}}),b.fn.extend({detach:function(t){return It(this,t,!0)},remove:function(t){return It(this,t)},text:function(t){return U(this,function(t){return void 0===t?b.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return Dt(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||qt(this,t).appendChild(t)})},prepend:function(){return Dt(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=qt(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return Dt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return Dt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(b.cleanData(ht(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return b.clone(this,t,e)})},html:function(t){return U(this,function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Mt.test(t)&&!dt[(ut.exec(t)||["",""])[1].toLowerCase()]){t=b.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(b.cleanData(ht(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return Dt(this,arguments,function(e){var n=this.parentNode;b.inArray(this,t)<0&&(b.cleanData(ht(this)),n&&n.replaceChild(e,this))},t)}}),b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){b.fn[t]=function(t){for(var n,i=[],r=b(t),o=r.length-1,s=0;s<=o;s++)n=s===o?this:this.clone(!0),b(r[s])[e](n),c.apply(i,n.get());return this.pushStack(i)}});var Ft=/^margin/,Lt=new RegExp("^("+X+")(?!px)[a-z%]+$","i"),zt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=n),e.getComputedStyle(t)};function Rt(t,e,n){var i,r,o,s,a=t.style;return(n=n||zt(t))&&(""!==(s=n.getPropertyValue(e)||n[e])||b.contains(t.ownerDocument,t)||(s=b.style(t,e)),!v.pixelMarginRight()&&Lt.test(s)&&Ft.test(e)&&(i=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=i,a.minWidth=r,a.maxWidth=o)),void 0!==s?s+"":s}function Bt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(l){l.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",l.innerHTML="",yt.appendChild(a);var t=n.getComputedStyle(l);e="1%"!==t.top,o="2px"===t.marginLeft,i="4px"===t.width,l.style.marginRight="50%",r="4px"===t.marginRight,yt.removeChild(a),l=null}}var e,i,r,o,a=s.createElement("div"),l=s.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",v.clearCloneStyle="content-box"===l.style.backgroundClip,a.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",a.appendChild(l),b.extend(v,{pixelPosition:function(){return t(),e},boxSizingReliable:function(){return t(),i},pixelMarginRight:function(){return t(),r},reliableMarginLeft:function(){return t(),o}}))}();var Ht=/^(none|table(?!-c[ea]).+)/,Gt=/^--/,Vt={position:"absolute",visibility:"hidden",display:"block"},Ut={letterSpacing:"0",fontWeight:"400"},Wt=["Webkit","Moz","ms"],Qt=s.createElement("div").style;function $t(t){var e=b.cssProps[t];return e||(e=b.cssProps[t]=function(t){if(t in Qt)return t;for(var e=t[0].toUpperCase()+t.slice(1),n=Wt.length;n--;)if((t=Wt[n]+e)in Qt)return t}(t)||t),e}function Kt(t,e,n){var i=tt.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function Jt(t,e,n,i,r){var o,s=0;for(o=n===(i?"border":"content")?4:"width"===e?1:0;o<4;o+=2)"margin"===n&&(s+=b.css(t,n+et[o],!0,r)),i?("content"===n&&(s-=b.css(t,"padding"+et[o],!0,r)),"margin"!==n&&(s-=b.css(t,"border"+et[o]+"Width",!0,r))):(s+=b.css(t,"padding"+et[o],!0,r),"padding"!==n&&(s+=b.css(t,"border"+et[o]+"Width",!0,r)));return s}function Zt(t,e,n){var i,r=zt(t),o=Rt(t,e,r),s="border-box"===b.css(t,"boxSizing",!1,r);return Lt.test(o)?o:(i=s&&(v.boxSizingReliable()||o===t.style[e]),"auto"===o&&(o=t["offset"+e[0].toUpperCase()+e.slice(1)]),(o=parseFloat(o)||0)+Jt(t,e,n||(s?"border":"content"),i,r)+"px")}function Yt(t,e,n,i,r){return new Yt.prototype.init(t,e,n,i,r)}b.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Rt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,s,a=b.camelCase(e),l=Gt.test(e),u=t.style;if(l||(e=$t(a)),s=b.cssHooks[e]||b.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(r=s.get(t,!1,i))?r:u[e];"string"==(o=typeof n)&&(r=tt.exec(n))&&r[1]&&(n=rt(t,e,r),o="number"),null!=n&&n==n&&("number"===o&&(n+=r&&r[3]||(b.cssNumber[a]?"":"px")),v.clearCloneStyle||""!==n||0!==e.indexOf("background")||(u[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,i))||(l?u.setProperty(e,n):u[e]=n))}},css:function(t,e,n,i){var r,o,s,a=b.camelCase(e);return Gt.test(e)||(e=$t(a)),(s=b.cssHooks[e]||b.cssHooks[a])&&"get"in s&&(r=s.get(t,!0,n)),void 0===r&&(r=Rt(t,e,i)),"normal"===r&&e in Ut&&(r=Ut[e]),""===n||n?(o=parseFloat(r),!0===n||isFinite(o)?o||0:r):r}}),b.each(["height","width"],function(t,e){b.cssHooks[e]={get:function(t,n,i){if(n)return!Ht.test(b.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?Zt(t,e,i):it(t,Vt,function(){return Zt(t,e,i)})},set:function(t,n,i){var r,o=i&&zt(t),s=i&&Jt(t,e,i,"border-box"===b.css(t,"boxSizing",!1,o),o);return s&&(r=tt.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=b.css(t,e)),Kt(0,n,s)}}}),b.cssHooks.marginLeft=Bt(v.reliableMarginLeft,function(t,e){if(e)return(parseFloat(Rt(t,"marginLeft"))||t.getBoundingClientRect().left-it(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),b.each({margin:"",padding:"",border:"Width"},function(t,e){b.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[t+et[i]+e]=o[i]||o[i-2]||o[0];return r}},Ft.test(t)||(b.cssHooks[t+e].set=Kt)}),b.fn.extend({css:function(t,e){return U(this,function(t,e,n){var i,r,o={},s=0;if(Array.isArray(e)){for(i=zt(t),r=e.length;s<r;s++)o[e[s]]=b.css(t,e[s],!1,i);return o}return void 0!==n?b.style(t,e,n):b.css(t,e)},t,e,arguments.length>1)}}),b.Tween=Yt,Yt.prototype={constructor:Yt,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||b.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(b.cssNumber[n]?"":"px")},cur:function(){var t=Yt.propHooks[this.prop];return t&&t.get?t.get(this):Yt.propHooks._default.get(this)},run:function(t){var e,n=Yt.propHooks[this.prop];return this.options.duration?this.pos=e=b.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Yt.propHooks._default.set(this),this}},Yt.prototype.init.prototype=Yt.prototype,Yt.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=b.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){b.fx.step[t.prop]?b.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[b.cssProps[t.prop]]&&!b.cssHooks[t.prop]?t.elem[t.prop]=t.now:b.style(t.elem,t.prop,t.now+t.unit)}}},Yt.propHooks.scrollTop=Yt.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},b.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},b.fx=Yt.prototype.init,b.fx.step={};var Xt,te,ee=/^(?:toggle|show|hide)$/,ne=/queueHooks$/;function ie(){te&&(!1===s.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(ie):n.setTimeout(ie,b.fx.interval),b.fx.tick())}function re(){return n.setTimeout(function(){Xt=void 0}),Xt=b.now()}function oe(t,e){var n,i=0,r={height:t};for(e=e?1:0;i<4;i+=2-e)r["margin"+(n=et[i])]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function se(t,e,n){for(var i,r=(ae.tweeners[e]||[]).concat(ae.tweeners["*"]),o=0,s=r.length;o<s;o++)if(i=r[o].call(n,e,t))return i}function ae(t,e,n){var i,r,o=0,s=ae.prefilters.length,a=b.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var e=Xt||re(),n=Math.max(0,u.startTime+u.duration-e),i=1-(n/u.duration||0),o=0,s=u.tweens.length;o<s;o++)u.tweens[o].run(i);return a.notifyWith(t,[u,i,n]),i<1&&s?n:(s||a.notifyWith(t,[u,1,0]),a.resolveWith(t,[u]),!1)},u=a.promise({elem:t,props:b.extend({},e),opts:b.extend(!0,{specialEasing:{},easing:b.easing._default},n),originalProperties:e,originalOptions:n,startTime:Xt||re(),duration:n.duration,tweens:[],createTween:function(e,n){var i=b.Tween(t,u.opts,e,n,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(i),i},stop:function(e){var n=0,i=e?u.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)u.tweens[n].run(1);return e?(a.notifyWith(t,[u,1,0]),a.resolveWith(t,[u,e])):a.rejectWith(t,[u,e]),this}}),c=u.props;for(function(t,e){var n,i,r,o,s;for(n in t)if(r=e[i=b.camelCase(n)],o=t[n],Array.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),(s=b.cssHooks[i])&&"expand"in s)for(n in o=s.expand(o),delete t[i],o)n in t||(t[n]=o[n],e[n]=r);else e[i]=r}(c,u.opts.specialEasing);o<s;o++)if(i=ae.prefilters[o].call(u,t,c,u.opts))return b.isFunction(i.stop)&&(b._queueHooks(u.elem,u.opts.queue).stop=b.proxy(i.stop,i)),i;return b.map(c,se,u),b.isFunction(u.opts.start)&&u.opts.start.call(t,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),b.fx.timer(b.extend(l,{elem:t,anim:u,queue:u.opts.queue})),u}b.Animation=b.extend(ae,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return rt(n.elem,t,tt.exec(e),n),n}]},tweener:function(t,e){b.isFunction(t)?(e=t,t=["*"]):t=t.match(L);for(var n,i=0,r=t.length;i<r;i++)n=t[i],ae.tweeners[n]=ae.tweeners[n]||[],ae.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var i,r,o,s,a,l,u,c,d="width"in e||"height"in e,h=this,p={},f=t.style,g=t.nodeType&&nt(t),m=$.get(t,"fxshow");for(i in n.queue||(null==(s=b._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,h.always(function(){h.always(function(){s.unqueued--,b.queue(t,"fx").length||s.empty.fire()})})),e)if(r=e[i],ee.test(r)){if(delete e[i],o=o||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;g=!0}p[i]=m&&m[i]||b.style(t,i)}if((l=!b.isEmptyObject(e))||!b.isEmptyObject(p))for(i in d&&1===t.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],null==(u=m&&m.display)&&(u=$.get(t,"display")),"none"===(c=b.css(t,"display"))&&(u?c=u:(at([t],!0),u=t.style.display||u,c=b.css(t,"display"),at([t]))),("inline"===c||"inline-block"===c&&null!=u)&&"none"===b.css(t,"float")&&(l||(h.done(function(){f.display=u}),null==u&&(c=f.display,u="none"===c?"":c)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",h.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]})),l=!1,p)l||(m?"hidden"in m&&(g=m.hidden):m=$.access(t,"fxshow",{display:u}),o&&(m.hidden=!g),g&&at([t],!0),h.done(function(){for(i in g||at([t]),$.remove(t,"fxshow"),p)b.style(t,i,p[i])})),l=se(g?m[i]:0,i,h),i in m||(m[i]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?ae.prefilters.unshift(t):ae.prefilters.push(t)}}),b.speed=function(t,e,n){var i=t&&"object"==typeof t?b.extend({},t):{complete:n||!n&&e||b.isFunction(t)&&t,duration:t,easing:n&&e||e&&!b.isFunction(e)&&e};return b.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in b.fx.speeds?i.duration=b.fx.speeds[i.duration]:i.duration=b.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){b.isFunction(i.old)&&i.old.call(this),i.queue&&b.dequeue(this,i.queue)},i},b.fn.extend({fadeTo:function(t,e,n,i){return this.filter(nt).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=b.isEmptyObject(t),o=b.speed(e,n,i),s=function(){var e=ae(this,b.extend({},t),o);(r||$.get(this,"finish"))&&e.stop(!0)};return s.finish=s,r||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=b.timers,s=$.get(this);if(r)s[r]&&s[r].stop&&i(s[r]);else for(r in s)s[r]&&s[r].stop&&ne.test(r)&&i(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(n),e=!1,o.splice(r,1));!e&&n||b.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,n=$.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=b.timers,s=i?i.length:0;for(n.finish=!0,b.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),b.each(["toggle","show","hide"],function(t,e){var n=b.fn[e];b.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(oe(e,!0),t,i,r)}}),b.each({slideDown:oe("show"),slideUp:oe("hide"),slideToggle:oe("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){b.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),b.timers=[],b.fx.tick=function(){var t,e=0,n=b.timers;for(Xt=b.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||b.fx.stop(),Xt=void 0},b.fx.timer=function(t){b.timers.push(t),b.fx.start()},b.fx.interval=13,b.fx.start=function(){te||(te=!0,ie())},b.fx.stop=function(){te=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fn.delay=function(t,e){return t=b.fx&&b.fx.speeds[t]||t,e=e||"fx",this.queue(e,function(e,i){var r=n.setTimeout(e,t);i.stop=function(){n.clearTimeout(r)}})},function(){var t=s.createElement("input"),e=s.createElement("select").appendChild(s.createElement("option"));t.type="checkbox",v.checkOn=""!==t.value,v.optSelected=e.selected,(t=s.createElement("input")).value="t",t.type="radio",v.radioValue="t"===t.value}();var le,ue=b.expr.attrHandle;b.fn.extend({attr:function(t,e){return U(this,b.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){b.removeAttr(this,t)})}}),b.extend({attr:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?b.prop(t,e,n):(1===o&&b.isXMLDoc(t)||(r=b.attrHooks[e.toLowerCase()]||(b.expr.match.bool.test(e)?le:void 0)),void 0!==n?null===n?void b.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:null==(i=b.find.attr(t,e))?void 0:i)},attrHooks:{type:{set:function(t,e){if(!v.radioValue&&"radio"===e&&N(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i=0,r=e&&e.match(L);if(r&&1===t.nodeType)for(;n=r[i++];)t.removeAttribute(n)}}),le={set:function(t,e,n){return!1===e?b.removeAttr(t,n):t.setAttribute(n,n),n}},b.each(b.expr.match.bool.source.match(/\w+/g),function(t,e){var n=ue[e]||b.find.attr;ue[e]=function(t,e,i){var r,o,s=e.toLowerCase();return i||(o=ue[s],ue[s]=r,r=null!=n(t,e,i)?s:null,ue[s]=o),r}});var ce=/^(?:input|select|textarea|button)$/i,de=/^(?:a|area)$/i;function he(t){return(t.match(L)||[]).join(" ")}function pe(t){return t.getAttribute&&t.getAttribute("class")||""}b.fn.extend({prop:function(t,e){return U(this,b.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[b.propFix[t]||t]})}}),b.extend({prop:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&b.isXMLDoc(t)||(e=b.propFix[e]||e,r=b.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=b.find.attr(t,"tabindex");return e?parseInt(e,10):ce.test(t.nodeName)||de.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),v.optSelected||(b.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),b.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){b.propFix[this.toLowerCase()]=this}),b.fn.extend({addClass:function(t){var e,n,i,r,o,s,a,l=0;if(b.isFunction(t))return this.each(function(e){b(this).addClass(t.call(this,e,pe(this)))});if("string"==typeof t&&t)for(e=t.match(L)||[];n=this[l++];)if(r=pe(n),i=1===n.nodeType&&" "+he(r)+" "){for(s=0;o=e[s++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");r!==(a=he(i))&&n.setAttribute("class",a)}return this},removeClass:function(t){var e,n,i,r,o,s,a,l=0;if(b.isFunction(t))return this.each(function(e){b(this).removeClass(t.call(this,e,pe(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(L)||[];n=this[l++];)if(r=pe(n),i=1===n.nodeType&&" "+he(r)+" "){for(s=0;o=e[s++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");r!==(a=he(i))&&n.setAttribute("class",a)}return this},toggleClass:function(t,e){var n=typeof t;return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):b.isFunction(t)?this.each(function(n){b(this).toggleClass(t.call(this,n,pe(this),e),e)}):this.each(function(){var e,i,r,o;if("string"===n)for(i=0,r=b(this),o=t.match(L)||[];e=o[i++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else void 0!==t&&"boolean"!==n||((e=pe(this))&&$.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":$.get(this,"__className__")||""))})},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+he(pe(n))+" ").indexOf(e)>-1)return!0;return!1}});var fe=/\r/g;b.fn.extend({val:function(t){var e,n,i,r=this[0];return arguments.length?(i=b.isFunction(t),this.each(function(n){var r;1===this.nodeType&&(null==(r=i?t.call(this,n,b(this).val()):t)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=b.map(r,function(t){return null==t?"":t+""})),(e=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))})):r?(e=b.valHooks[r.type]||b.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(fe,""):null==n?"":n:void 0}}),b.extend({valHooks:{option:{get:function(t){var e=b.find.attr(t,"value");return null!=e?e:he(b.text(t))}},select:{get:function(t){var e,n,i,r=t.options,o=t.selectedIndex,s="select-one"===t.type,a=s?null:[],l=s?o+1:r.length;for(i=o<0?l:s?o:0;i<l;i++)if(((n=r[i]).selected||i===o)&&!n.disabled&&(!n.parentNode.disabled||!N(n.parentNode,"optgroup"))){if(e=b(n).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var n,i,r=t.options,o=b.makeArray(e),s=r.length;s--;)((i=r[s]).selected=b.inArray(b.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),b.each(["radio","checkbox"],function(){b.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=b.inArray(b(t).val(),e)>-1}},v.checkOn||(b.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var ge=/^(?:focusinfocus|focusoutblur)$/;b.extend(b.event,{trigger:function(t,e,i,r){var o,a,l,u,c,d,h,p=[i||s],g=f.call(t,"type")?t.type:t,m=f.call(t,"namespace")?t.namespace.split("."):[];if(a=l=i=i||s,3!==i.nodeType&&8!==i.nodeType&&!ge.test(g+b.event.triggered)&&(g.indexOf(".")>-1&&(g=(m=g.split(".")).shift(),m.sort()),c=g.indexOf(":")<0&&"on"+g,(t=t[b.expando]?t:new b.Event(g,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=m.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:b.makeArray(e,[t]),h=b.event.special[g]||{},r||!h.trigger||!1!==h.trigger.apply(i,e))){if(!r&&!h.noBubble&&!b.isWindow(i)){for(u=h.delegateType||g,ge.test(u+g)||(a=a.parentNode);a;a=a.parentNode)p.push(a),l=a;l===(i.ownerDocument||s)&&p.push(l.defaultView||l.parentWindow||n)}for(o=0;(a=p[o++])&&!t.isPropagationStopped();)t.type=o>1?u:h.bindType||g,(d=($.get(a,"events")||{})[t.type]&&$.get(a,"handle"))&&d.apply(a,e),(d=c&&a[c])&&d.apply&&W(a)&&(t.result=d.apply(a,e),!1===t.result&&t.preventDefault());return t.type=g,r||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(p.pop(),e)||!W(i)||c&&b.isFunction(i[g])&&!b.isWindow(i)&&((l=i[c])&&(i[c]=null),b.event.triggered=g,i[g](),b.event.triggered=void 0,l&&(i[c]=l)),t.result}},simulate:function(t,e,n){var i=b.extend(new b.Event,n,{type:t,isSimulated:!0});b.event.trigger(i,null,e)}}),b.fn.extend({trigger:function(t,e){return this.each(function(){b.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];if(n)return b.event.trigger(t,e,n,!0)}}),b.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){b.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),b.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),v.focusin="onfocusin"in n,v.focusin||b.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){b.event.simulate(e,t.target,b.event.fix(t))};b.event.special[e]={setup:function(){var i=this.ownerDocument||this,r=$.access(i,e);r||i.addEventListener(t,n,!0),$.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=$.access(i,e)-1;r?$.access(i,e,r):(i.removeEventListener(t,n,!0),$.remove(i,e))}}});var me=n.location,ve=b.now(),ye=/\?/;b.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new n.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||b.error("Invalid XML: "+t),e};var be=/\[\]$/,_e=/\r?\n/g,xe=/^(?:submit|button|image|reset|file)$/i,we=/^(?:input|select|textarea|keygen)/i;function Ae(t,e,n,i){var r;if(Array.isArray(e))b.each(e,function(e,r){n||be.test(t)?i(t,r):Ae(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,n,i)});else if(n||"object"!==b.type(e))i(t,e);else for(r in e)Ae(t+"["+r+"]",e[r],n,i)}b.param=function(t,e){var n,i=[],r=function(t,e){var n=b.isFunction(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(t)||t.jquery&&!b.isPlainObject(t))b.each(t,function(){r(this.name,this.value)});else for(n in t)Ae(n,t[n],e,r);return i.join("&")},b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=b.prop(this,"elements");return t?b.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!b(this).is(":disabled")&&we.test(this.nodeName)&&!xe.test(t)&&(this.checked||!lt.test(t))}).map(function(t,e){var n=b(this).val();return null==n?null:Array.isArray(n)?b.map(n,function(t){return{name:e.name,value:t.replace(_e,"\r\n")}}):{name:e.name,value:n.replace(_e,"\r\n")}}).get()}});var ke=/%20/g,Te=/#.*$/,Se=/([?&])_=[^&]*/,Me=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ee=/^(?:GET|HEAD)$/,Ne=/^\/\//,Oe={},qe={},Ce="*/".concat("*"),Pe=s.createElement("a");function je(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(L)||[];if(b.isFunction(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function De(t,e,n,i){var r={},o=t===qe;function s(a){var l;return r[a]=!0,b.each(t[a]||[],function(t,a){var u=a(e,n,i);return"string"!=typeof u||o||r[u]?o?!(l=u):void 0:(e.dataTypes.unshift(u),s(u),!1)}),l}return s(e.dataTypes[0])||!r["*"]&&s("*")}function Ie(t,e){var n,i,r=b.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&b.extend(!0,t,i),t}Pe.href=me.href,b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:me.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(me.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ce,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Ie(Ie(t,b.ajaxSettings),e):Ie(b.ajaxSettings,t)},ajaxPrefilter:je(Oe),ajaxTransport:je(qe),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,r,o,a,l,u,c,d,h,p,f=b.ajaxSetup({},e),g=f.context||f,m=f.context&&(g.nodeType||g.jquery)?b(g):b.event,v=b.Deferred(),y=b.Callbacks("once memory"),_=f.statusCode||{},x={},w={},A="canceled",k={readyState:0,getResponseHeader:function(t){var e;if(c){if(!a)for(a={};e=Me.exec(o);)a[e[1].toLowerCase()]=e[2];e=a[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return c?o:null},setRequestHeader:function(t,e){return null==c&&(t=w[t.toLowerCase()]=w[t.toLowerCase()]||t,x[t]=e),this},overrideMimeType:function(t){return null==c&&(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)k.always(t[k.status]);else for(e in t)_[e]=[_[e],t[e]];return this},abort:function(t){var e=t||A;return i&&i.abort(e),T(0,e),this}};if(v.promise(k),f.url=((t||f.url||me.href)+"").replace(Ne,me.protocol+"//"),f.type=e.method||e.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(L)||[""],null==f.crossDomain){u=s.createElement("a");try{u.href=f.url,u.href=u.href,f.crossDomain=Pe.protocol+"//"+Pe.host!=u.protocol+"//"+u.host}catch(t){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=b.param(f.data,f.traditional)),De(Oe,f,e,k),c)return k;for(h in(d=b.event&&f.global)&&0==b.active++&&b.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Ee.test(f.type),r=f.url.replace(Te,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(ke,"+")):(p=f.url.slice(r.length),f.data&&(r+=(ye.test(r)?"&":"?")+f.data,delete f.data),!1===f.cache&&(r=r.replace(Se,"$1"),p=(ye.test(r)?"&":"?")+"_="+ve+++p),f.url=r+p),f.ifModified&&(b.lastModified[r]&&k.setRequestHeader("If-Modified-Since",b.lastModified[r]),b.etag[r]&&k.setRequestHeader("If-None-Match",b.etag[r])),(f.data&&f.hasContent&&!1!==f.contentType||e.contentType)&&k.setRequestHeader("Content-Type",f.contentType),k.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Ce+"; q=0.01":""):f.accepts["*"]),f.headers)k.setRequestHeader(h,f.headers[h]);if(f.beforeSend&&(!1===f.beforeSend.call(g,k,f)||c))return k.abort();if(A="abort",y.add(f.complete),k.done(f.success),k.fail(f.error),i=De(qe,f,e,k)){if(k.readyState=1,d&&m.trigger("ajaxSend",[k,f]),c)return k;f.async&&f.timeout>0&&(l=n.setTimeout(function(){k.abort("timeout")},f.timeout));try{c=!1,i.send(x,T)}catch(t){if(c)throw t;T(-1,t)}}else T(-1,"No Transport");function T(t,e,s,a){var u,h,p,x,w,A=e;c||(c=!0,l&&n.clearTimeout(l),i=void 0,o=a||"",k.readyState=t>0?4:0,u=t>=200&&t<300||304===t,s&&(x=function(t,e,n){for(var i,r,o,s,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||t.converters[r+" "+l[0]]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==l[0]&&l.unshift(o),n[o]}(f,k,s)),x=function(t,e,n,i){var r,o,s,a,l,u={},c=t.dataTypes.slice();if(c[1])for(s in t.converters)u[s.toLowerCase()]=t.converters[s];for(o=c.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(s=u[l+" "+o]||u["* "+o]))for(r in u)if((a=r.split(" "))[1]===o&&(s=u[l+" "+a[0]]||u["* "+a[0]])){!0===s?s=u[r]:!0!==u[r]&&(o=a[0],c.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}(f,x,k,u),u?(f.ifModified&&((w=k.getResponseHeader("Last-Modified"))&&(b.lastModified[r]=w),(w=k.getResponseHeader("etag"))&&(b.etag[r]=w)),204===t||"HEAD"===f.type?A="nocontent":304===t?A="notmodified":(A=x.state,h=x.data,u=!(p=x.error))):(p=A,!t&&A||(A="error",t<0&&(t=0))),k.status=t,k.statusText=(e||A)+"",u?v.resolveWith(g,[h,A,k]):v.rejectWith(g,[k,A,p]),k.statusCode(_),_=void 0,d&&m.trigger(u?"ajaxSuccess":"ajaxError",[k,f,u?h:p]),y.fireWith(g,[k,A]),d&&(m.trigger("ajaxComplete",[k,f]),--b.active||b.event.trigger("ajaxStop")))}return k},getJSON:function(t,e,n){return b.get(t,e,n,"json")},getScript:function(t,e){return b.get(t,void 0,e,"script")}}),b.each(["get","post"],function(t,e){b[e]=function(t,n,i,r){return b.isFunction(n)&&(r=r||i,i=n,n=void 0),b.ajax(b.extend({url:t,type:e,dataType:r,data:n,success:i},b.isPlainObject(t)&&t))}}),b._evalUrl=function(t){return b.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},b.fn.extend({wrapAll:function(t){var e;return this[0]&&(b.isFunction(t)&&(t=t.call(this[0])),e=b(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return b.isFunction(t)?this.each(function(e){b(this).wrapInner(t.call(this,e))}):this.each(function(){var e=b(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=b.isFunction(t);return this.each(function(n){b(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){b(this).replaceWith(this.childNodes)}),this}}),b.expr.pseudos.hidden=function(t){return!b.expr.pseudos.visible(t)},b.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},b.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(t){}};var Fe={0:200,1223:204},Le=b.ajaxSettings.xhr();v.cors=!!Le&&"withCredentials"in Le,v.ajax=Le=!!Le,b.ajaxTransport(function(t){var e,i;if(v.cors||Le&&!t.crossDomain)return{send:function(r,o){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];for(s in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)a.setRequestHeader(s,r[s]);e=function(t){return function(){e&&(e=i=a.onload=a.onerror=a.onabort=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Fe[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=e(),i=a.onerror=e("error"),void 0!==a.onabort?a.onabort=i:a.onreadystatechange=function(){4===a.readyState&&n.setTimeout(function(){e&&i()})},e=e("abort");try{a.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}}),b.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return b.globalEval(t),t}}}),b.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),b.ajaxTransport("script",function(t){var e,n;if(t.crossDomain)return{send:function(i,r){e=b("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),s.head.appendChild(e[0])},abort:function(){n&&n()}}});var ze,Re=[],Be=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Re.pop()||b.expando+"_"+ve++;return this[t]=!0,t}}),b.ajaxPrefilter("json jsonp",function(t,e,i){var r,o,s,a=!1!==t.jsonp&&(Be.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Be.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=b.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Be,"$1"+r):!1!==t.jsonp&&(t.url+=(ye.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return s||b.error(r+" was not called"),s[0]},t.dataTypes[0]="json",o=n[r],n[r]=function(){s=arguments},i.always(function(){void 0===o?b(n).removeProp(r):n[r]=o,t[r]&&(t.jsonpCallback=e.jsonpCallback,Re.push(r)),s&&b.isFunction(o)&&o(s[0]),s=o=void 0}),"script"}),v.createHTMLDocument=((ze=s.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===ze.childNodes.length),b.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(v.createHTMLDocument?((i=(e=s.implementation.createHTMLDocument("")).createElement("base")).href=s.location.href,e.head.appendChild(i)):e=s),r=O.exec(t),o=!n&&[],r?[e.createElement(r[1])]:(r=vt([t],e,o),o&&o.length&&b(o).remove(),b.merge([],r.childNodes)));var i,r,o},b.fn.load=function(t,e,n){var i,r,o,s=this,a=t.indexOf(" ");return a>-1&&(i=he(t.slice(a)),t=t.slice(0,a)),b.isFunction(e)?(n=e,e=void 0):e&&"object"==typeof e&&(r="POST"),s.length>0&&b.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){o=arguments,s.html(i?b("<div>").append(b.parseHTML(t)).find(i):t)}).always(n&&function(t,e){s.each(function(){n.apply(this,o||[t.responseText,e,t])})}),this},b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){b.fn[e]=function(t){return this.on(e,t)}}),b.expr.pseudos.animated=function(t){return b.grep(b.timers,function(e){return t===e.elem}).length},b.offset={setOffset:function(t,e,n){var i,r,o,s,a,l,u=b.css(t,"position"),c=b(t),d={};"static"===u&&(t.style.position="relative"),a=c.offset(),o=b.css(t,"top"),l=b.css(t,"left"),("absolute"===u||"fixed"===u)&&(o+l).indexOf("auto")>-1?(s=(i=c.position()).top,r=i.left):(s=parseFloat(o)||0,r=parseFloat(l)||0),b.isFunction(e)&&(e=e.call(t,n,b.extend({},a))),null!=e.top&&(d.top=e.top-a.top+s),null!=e.left&&(d.left=e.left-a.left+r),"using"in e?e.using.call(t,d):c.css(d)}},b.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){b.offset.setOffset(this,t,e)});var e,n,i,r,o=this[0];return o?o.getClientRects().length?(i=o.getBoundingClientRect(),n=(e=o.ownerDocument).documentElement,r=e.defaultView,{top:i.top+r.pageYOffset-n.clientTop,left:i.left+r.pageXOffset-n.clientLeft}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n=this[0],i={top:0,left:0};return"fixed"===b.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),N(t[0],"html")||(i=t.offset()),i={top:i.top+b.css(t[0],"borderTopWidth",!0),left:i.left+b.css(t[0],"borderLeftWidth",!0)}),{top:e.top-i.top-b.css(n,"marginTop",!0),left:e.left-i.left-b.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===b.css(t,"position");)t=t.offsetParent;return t||yt})}}),b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n="pageYOffset"===e;b.fn[t]=function(i){return U(this,function(t,i,r){var o;if(b.isWindow(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===r)return o?o[e]:t[i];o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):t[i]=r},t,i,arguments.length)}}),b.each(["top","left"],function(t,e){b.cssHooks[e]=Bt(v.pixelPosition,function(t,n){if(n)return n=Rt(t,e),Lt.test(n)?b(t).position()[e]+"px":n})}),b.each({Height:"height",Width:"width"},function(t,e){b.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,i){b.fn[i]=function(r,o){var s=arguments.length&&(n||"boolean"!=typeof r),a=n||(!0===r||!0===o?"margin":"border");return U(this,function(e,n,r){var o;return b.isWindow(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===r?b.css(e,n,a):b.style(e,n,r,a)},e,s?r:void 0,s)}})}),b.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}}),b.holdReady=function(t){t?b.readyWait++:b.ready(!0)},b.isArray=Array.isArray,b.parseJSON=JSON.parse,b.nodeName=N,void 0===(i=function(){return b}.apply(e,[]))||(t.exports=i);var He=n.jQuery,Ge=n.$;return b.noConflict=function(t){return n.$===b&&(n.$=Ge),t&&n.jQuery===b&&(n.jQuery=He),b},r||(n.jQuery=n.$=b),b})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Group=void 0;var i=n(1),r=n(0),o=e.Group=function(t,e){i.Tree.Node.call(this),arguments.length>1&&(this.bp=e),arguments.length>0&&(this.value=t)};r.gmath.inherit(i.Tree.Node,o),o.prototype.to_ascii=function(t){return this.children.map(function(e){return e.is_group()&&e.commutative&&!e.ls&&e.associative?e.children[1].to_ascii(t):e.to_ascii(t)}).join("")},o.prototype.to_latex=function(t){return this.children.map(function(e){return e.is_group()&&e.commutative&&!e.ls&&e.associative?e.children[1].to_latex(t):e.to_latex(t)}).join("")},o.prototype.is_group=function(t){if(0===arguments.length)return!0;for(var e=0;e<arguments.length;e++)if(this.value===arguments[e])return!0;return!1},o.prototype.get_last_child=function(){return this.children[this.children.length-1]},o.get_siblings=function(t){for(var e=Array.isArray(t)?t:[t],n=[],i=e[0];i.ls;)i=i.ls,n.unshift(i);for(i=e[e.length-1];i.rs;)i=i.rs,n.push(i);return n},o.prototype.is_leaf_node=!1,o.prototype.has_script=function(){return!1}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Settings=e.SettingsType=e.dont_catch_exceptions=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(7);function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.dont_catch_exceptions=!1;var s={},a=(e.SettingsType=function(){function t(e){if(o(this,t),e in s)throw"SettingsType with name "+e+" already exists.";s[e]=this,this.name=e,this.defaults=new a,this.user=new a,this.user.parent=this.defaults,this.doc=new a,this.doc.parent=this.user}return i(t,[{key:"get",value:function(t){return this.doc.get(t)}}],[{key:"get",value:function(t){return s[t]}},{key:"getAll",value:function(){return r.object.extend({},s)}},{key:"docSettingsToJSON",value:function(){var t={};for(var e in s)t[e]=s[e].doc.getAll();return t}},{key:"userSettingsToJSON",value:function(){var t={};for(var e in s){var n=s[e].user;n&&(t[e]=n.getModified())}return t}}]),t}(),e.Settings=function(){function t(e){o(this,t),this.state={},this.setParent(e)}return i(t,[{key:"setParent",value:function(t){this.settings_type=t,t&&(this.parent=s[t].doc)}},{key:"unsetAll",value:function(){return this.state={},this}},{key:"set",value:function(t,e){return this.state[t]=e,this}},{key:"unset",value:function(t){return delete this.state[t],this}},{key:"setAll",value:function(t){var e=this;return Object.keys(t).forEach(function(n){return e.set(n,t[n])}),this}},{key:"setExisting",value:function(t){var e=this;return Object.keys(t).forEach(function(n){e.has(n)&&e.set(n,t[n])}),this}},{key:"exists",value:function(t){return t in this.state}},{key:"has",value:function(t){return t in this.state||this.parent&&this.parent.has(t)}},{key:"get",value:function(t){return t in this.state?this.state[t]:this.parent&&this.parent.get(t)}},{key:"getModified",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,n={};return Object.keys(e).forEach(function(i){t.parent&&t.parent.has(i)&&r.object.deepEquals(t.parent.get(i),e[i])||(n[i]=e[i])}),n}},{key:"getIfExists",value:function(t,e){return t in this.state?this.state[t]:this.parent?this.parent.getIfExists(t,e):e}},{key:"getAll",value:function(){return r.object.extend({},this.state)}},{key:"getAllIncludingDefaults",value:function(){if(!this.parent)return this.state;var t=this.parent.getAllIncludingDefaults();return r.object.merged(t,this.state)}}]),t}())},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.asOperator=function(t,e){r.gmath.inherit(o.Group,this),this.prototype.bp=e.bp||0,this.prototype.associative=e.associative||!1,this.prototype.commutative=e.commutative||!1,this.prototype.has_inverse=e.has_inverse||!1,this.prototype.inverse_group_name=e.inverse_group_name,this.prototype.group_name=e.group_name||e.group_class&&e.group_class.prototype.name,this.prototype.group_class=e.group_class,this.prototype.value=t,this.prototype.name=t,this.prototype.action_handlers=[],this.prototype.vertical_notation=e.vertical_notation||!1,this.prototype.add_action_handler=function(t){-1==this.action_handlers.indexOf(t)&&this.action_handlers.push(t)},this.prototype.getBestMatchingAction=function(t,e){e||(e=[]);for(var n=null,o=0;o<this.action_handlers.length;o++){var s=this.action_handlers[o];try{if(s.name&&-1!==e.indexOf(s.name))continue;if(s.triggerType!==t&&("tap"!==t||s.triggerType))continue;if(!s.match(this))continue;(null===n||s.priority>n.priority)&&(n=s)}catch(t){console.warn("An error occurred when trying to match "+s.name),r.gmath.sendErrorReport("An error occurred when trying to match the operator "+this.name+" on "+this.to_ascii(),i.Tree.stringify(this.get_root()))}}return n},this.prototype.createParentGroup=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(this.group_class,[null].concat(e)))},this.prototype.createSameNode=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(r.gmath.expressions[this.name],[null].concat(e)))},this.prototype.getInverse=function(){return this.inverse&&r.gmath.expressions[this.inverse]},r.gmath.expressions[t]=this};var i=n(1),r=n(0),o=n(9)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MathSettings=void 0;var i=n(10);(e.MathSettings=new i.SettingsType("Math")).defaults.setAll({substitution_on:!0,only_integer_division:!1,use_simple_keyboard_layout:!1,only_simple_rewrites:!1,enable_shake_trigger_type:!0,second_child_eq_inversion:!1,cancel_powers:!0,tap_to_cancel:!0,factor_after_finding_gcf:!0,cancel_common_terms_after_finding_gcf:!0,simplify_sum_after_canceling_powers:!0,auto_simplify_signs:!0,allow_term_flipping:!0,flip_powers_only:!0,allow_non_equivalent_keyboard_rewrite:!0,allow_drag_across_relation:!0,simplify_after_drag_across_relation:!1,enable_polynomial_distribution:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(82))&&i.__esModule?i:{default:i},s=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.div=e.append("div"),this.registeredListeners=[],this.initSettings(n)}return r(t,[{key:"initSettings",value:function(t){this.settings=new o.default(t)}},{key:"getSettingName",value:function(){if(this.settings)return this.settings.getName();throw"[SettingForm] Attempting to get the setting name before instantiation."}},{key:"render",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.setHTML(this.compileHTML(),t)}},{key:"setBackgroundColor",value:function(t){this.div.style("background",t)}},{key:"compileHTML",value:function(){return"\n            <h4>"+this.getTitle()+"</h4>\n            <div>"+this.getHTML()+"</div>\n        "}},{key:"setHTML",value:function(t,e){return this.div.html(t).attr("class","modal-body "+(e?"form-horizontal":"form"))}},{key:"getTitle",value:function(){throw'[SettingForm] Must define "getTitle" method on child class.'}},{key:"getHTML",value:function(){throw'[SettingForm] Must define "getHTML" method on child class.'}},{key:"writeData",value:function(){if(!this.settings)throw"[SettingsForm] Form not correctly instantiated, no configured settings library.";this.settings.set(this.getFormValue())}},{key:"getFormValue",value:function(){return this.div.select("input.setting-value").node().checked}},{key:"getInputElements",value:function(){return this.div.selectAll("input.setting-value")}},{key:"onChange",value:function(t,e){var n=this;this.registeredListeners.push(t),this.getInputElements().on("change."+t,function(){e(n.getFormValue())})}},{key:"setFormValue",value:function(t){if(t.hasOwnProperty(this.settings.getName())){var e=this.div.select("input.setting-value"),n=t[this.settings.getName()];e.property("checked",n),this.registeredListeners.forEach(function(t){e.on("change."+t)(n)})}}},{key:"saveCurrentSettingsOntoDocument",value:function(){this.settings.saveCurrentSettingsOntoDocument()}},{key:"isUserSetting",get:function(){return this.settings.isUserSetting}}]),t}();e.default=s},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.preloadFonts=e.AlgebraView=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=n(116),s=n(107),a=n(104),l=n(1),u=n(15),c=n(10),d=n(5),h=n(7),p=e.AlgebraView=function(){function e(n,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=r.gmath.uid(),this.model=n,this.derivation=o.derivation||null,this.events=t.dispatch("updated"),this.model.events.on("change."+this.id,this.onChange.bind(this)),this.model.events.on("scrubbability-changed."+this.id,this.update_scrub.bind(this)),this.container=t.select(i),this.main=null,this.initializeSettings(o),this.input_mode="mouse",this.is_animating=0,this.afterAnimationCallbacks=[],this.normal_sel=null,this.shadow_sel=null,this.smoosh_sel=null,this.interaction_handler=null,this.registerInputModeListener(),this.init(s)}return i(e,[{key:"scaleToSize",value:function(t){var e=this.getBBox();if(e.height&&e.width){var n=t.width?t.width/e.width:1/0,i=t.height?t.height/e.height:1/0,r=this.settings.get("font_size")*Math.min(i,n);t.min_font_size&&(r=Math.max(r,t.min_font_size)),t.max_font_size&&(r=Math.min(r,t.max_font_size)),this.settings.set("font_size",r),this.render(!1)}else console.warn("Calling scaleToSize before AlgebraView is initialized.")}},{key:"scaleToContainer",value:function(t){var e=this.container.node();this.scaleToSize(h.object.extend(t,{width:e.clientWidth,height:e.clientHeight}));var n=0,i=0;"right"===t.h_align?n=e.clientWidth:"center"===t.h_align&&(n=e.clientWidth/2),"top"===t.v_align?i=e.clientHeight:"middle"===t.v_align&&(i=e.clientHeight/2),this.main.style("transform",f()({x:n,y:i}))}},{key:"loadSizes",value:function(){this.fontloader.loadSizes()}},{key:"wrongFontSize",value:function(){return Object.values(Object.values(this.fontloader.map)[0]).some(function(t){return"/"!==t.char&&t.width>113})}},{key:"bindToModel",value:function(e,n){if(this.model&&(this.model.events.on("change."+this.id,null),this.model.events.on("scrubbability-changed."+this.id,null),this.model.events.on("end-of-interaction."+this.id,null)),this.model=e,this.model.events.on("change."+this.id,this.onChange.bind(this)),n&&this.main){var i=[];this.main.selectAll("div.gm-shadow").each(function(e){var r=n[e.id];this.__delete_me__||!r||1!==r.length||r[0].has_children()||-1!==i.indexOf(r[0])||(t.select(this).datum(r[0]),i.push(r[0]))})}this.model.events.on("scrubbability-changed."+this.id,this.update_scrub.bind(this))}},{key:"registerInputModeListener",value:function(){var t=this,e=this.derivation&&this.derivation.canvas_model;e&&(e.on("input_mode."+this.id,function(e){return t.input_mode=e.mode}),this.input_mode=e.inputMode())}},{key:"onChange",value:function(t){t.old_model!==t.new_model?(this.bindToModel(t.new_model,t.node_map),this.settings.get("auto_update")&&this.render(!1)):this.settings.get("auto_update")&&this.render(!t.no_anim),t.no_anim&&this.removeOldNodes()}},{key:"removeOldNodes",value:function(){this.normal_sel.filter(function(){return this.__delete_me__}).remove(),this.normal_sel=this.main.selectAll(".gm-math"),this.shadow_sel.filter(function(){return this.__delete_me__}).remove(),this.shadow_sel=this.main.selectAll(".gm-shadow")}},{key:"callAfterAnimation",value:function(t){this.is_animating?this.afterAnimationCallbacks.push(t):t()}},{key:"animationFinished",value:function(){this.is_animating=Math.max(0,this.is_animating-1),this.is_animating>0||(this.afterAnimationCallbacks.forEach(function(t){t()}),this.afterAnimationCallbacks=[],this.removeOldNodes())}},{key:"initializeSettings",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.settings=new c.Settings("AlgebraView").setExisting(t),this.font_settings=new c.Settings(s.fontPresets[this.settings.get("font_preset")]),this.settings.get("use_arithmetic_multiplication_symbol")?(this.settings.get("symbol_mappings")["*"]="×",this.settings.get("symbol_mappings")["/"]="×"):(this.settings.get("symbol_mappings")["*"]="·",this.settings.get("symbol_mappings")["/"]="·");var e=this.settings.get("padding");"number"==typeof e&&this.settings.set("padding",{left:e,right:e,top:e,bottom:e}),window&&window.canvas&&window.canvas.screen_size.width>10&&this.settings.set("drag_dy_on_touch",0)}},{key:"init",value:function(n){var i=this;this.main=this.container.append("div").attr("id",this.settings.get("id")).attr("class","main").style("transform",f()(this.settings.get("pos"))).style("-webkit-transform",f()(this.settings.get("pos"))).style("position",this.settings.get("inline_display")?"relative":"absolute"),this.normal_sel=this.main.selectAll(".gm-math"),this.shadow_sel=this.main.selectAll(".gm-shadow"),this.smooshed_sel=this.main.selectAll(".gm-smooshed"),this.border_rect=this.main.append("div").style("border-radius",this.settings.get("border_radius")).style("background",this.settings.get("background_color")).style("border-color",this.settings.get("border_color")).style("position","absolute").style("opacity",this.settings.get("bg_visible")?1:0).style("pointer-events","all"),this.settings.get("event_receiver")?this.event_receiver=t.select(this.settings.get("event_receiver")):(this.event_receiver=this.main,this.event_receiver.style("pointer-events","all")),this.renderer=new o.NodeRenderer(this,this.settings.get("h_align"),this.settings.get("v_align")),this.settings.get("fixed")||(this.interaction_handler=new a.InteractionHandler(this,this.settings.get("interactive")),this.interaction_handler.only_synchronous_actions=this.settings.get("only_synchronous_actions"),this.main.classed("interactive",this.settings.get("interactive")));var r=[this.font_settings.get("normal_font"),this.font_settings.get("italic_font")];e.fontloader?(this.fontloader=e.fontloader,this.fontloader.add_fonts(r)):(e.fontloader=(0,s.FontLoader)(r,2e3),this.fontloader=e.fontloader),this.fontloader.on_fonts_loaded(function(){i.render(!1),n&&n(i)})}},{key:"interactive",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return 0===arguments.length?!this.settings.get("fixed")&&this.settings.get("interactive"):(this.settings.set("interactive",t),!t&&e?this.settings.set("mute",!0):this.settings.set("mute",!1),this.settings.get("fixed")||(this.interaction_handler.set_interactive(t),this.main.classed("interactive",this.settings.get("interactive"))),this)}},{key:"muted",value:function(){return this.settings.get("mute")}},{key:"wiggle",value:function(t,e){Array.isArray(t)||(t=[t]);for(var n=[],i=0;i<t.length;i++){var o=t[i].split(":"),s=1===o.length?this.model.getRanges(o[0]):this.model.getRanges(o[0],Number(o[1])-1);s&&(n=n.concat(s))}var a=r.gmath.array.flatten(n);0!==a.length&&(this.wiggleNodes(a,e),this.settings.get("fixed")||this.interaction_handler.events.on("touch."+this.id,this.wiggleNodes.bind(this,null,!1)))}},{key:"wiggleNodes",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this._getDivsThatCanBeWiggled(e);i.style("transform-origin",function(t){return(t.sel_box.x+t.sel_box.width/2).toFixed(2)+"px "+(t.sel_box.y+t.sel_box.height/2).toFixed(2)+"px"}).style("-webkit-transform-origin",function(t){return(t.sel_box.x+t.sel_box.width/2).toFixed(2)+"px "+(t.sel_box.y+t.sel_box.height/2).toFixed(2)+"px"});var r=this.settings.get("wiggle_dur"),o=this.settings.get("wiggle_deg"),s=this.settings.get("wiggle_random_delay"),a=function(e,n){var i=t.interpolate(e,n);return function(t){return function(t){return"rotate("+i(t)+"deg)"}}};n?i.transition().delay(function(){return Math.random()*s}).duration(r/2).styleTween("transform",a(0,o)).styleTween("-webkit-transform",a(0,o)).each("end",function e(n){t.select(this).transition().duration(r).styleTween("transform",a(o,-o)).styleTween("-webkit-transform",a(o,-o)).transition().duration(r).styleTween("transform",a(-o,o)).styleTween("-webkit-transform",a(-o,o)).each("end",e)}):i.interrupt().transition().style("transform",null).style("-webkit-transform",null)}},{key:"shakeNodes",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this._getDivsThatCanBeWiggled(e),r=function(e,n){var i=t.interpolateString("translateX("+e+"px)","translateX("+n+"px)");return function(t){return i}};n?i.transition().ease("quadratic-out").duration(60).styleTween("transform",r(0,5)).styleTween("-webkit-transform",r(0,5)).each("end",function e(n){t.select(this).transition().ease("quadratic-in-out").duration(120).styleTween("transform",r(5,-5)).styleTween("-webkit-transform",r(5,-5)).transition().ease("quadratic-in-out").duration(120).styleTween("transform",r(-5,5)).styleTween("-webkit-transform",r(-5,5)).each("end",e)}):i.interrupt().transition().style("transform",null).style("-webkit-transform",null)}},{key:"_getDivsThatCanBeWiggled",value:function(t){t||(t=this.model.children),Array.isArray(t)||(t=[t]);var e=[];return t.forEach(function(t){return e=e.concat(t.get_leaf_nodes())}),this.normal_sel.filter(function(t){return-1!==e.indexOf(t)}).select(".inner")}},{key:"reposition",value:function(t){this.renderer.set_position(this.model),this.update_existing()}},{key:"getSmooshedNodesSelection",value:function(t){return this.main.selectAll("div.gm-smooshed").data(l.Tree.get_leaf_nodes(t),function(t){return t.id})}},{key:"enterSmooshed",value:function(t){var e=this,n=this.getSmooshedNodesSelection(t).enter().insert("div",".gm-math").classed("gm-smooshed",!0).style("transform",f()).style("-webkit-transform",f()).style("opacity",1);n.append("div").classed("inner",!0).style("position","absolute"),n.select("div.inner").append("div"),n.filter(function(t){return"//"===t.value}).select("div.inner").classed("line",!0).style("position","absolute").call(m.bind(this),this.settings.get("slanted_div_bar")).style("width",function(t){return t.width*e.settings.get("smooshed_nodes_shrink_factor")+"px"}).style("background",function(t){return e.settings.get("selection_color")}).style("opacity",function(t){return 1});var i={sym_map:this.settings.get("symbol_mappings"),precision:this.settings.get("number_display_precision")};n.select("div.inner").style("display","block").style("font-family",function(t){return e.get_font(t).family}).style("font-weight",function(t){return e.get_font(t).weight}).style("font-style",function(t){return e.get_font(t).style}).style("font-size",function(t){return t.size+"px"}).style("color",function(t){return t.color}).style("user-select","none").style("opacity",function(t){return t.hidden?1e-5:1}).text(function(t){return t.to_string(i)}).transition().duration(this.settings.get("dur")).ease(this.settings.get("easing_fn")).style("font-size",function(t){return t.size*e.settings.get("smooshed_nodes_shrink_factor")+"px"}).style("color",this.settings.get("selection_color"))}},{key:"updateSmooshed",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.getSmooshedNodesSelection(t).transition().duration(e?this.settings.get("dur_dragging"):this.settings.get("dur")).ease(e?"circle-out":this.settings.get("easing_fn")).style("transform",f()).style("-webkit-transform",f())}},{key:"exitSmooshed",value:function(){this.main.selectAll("div.gm-smooshed").remove()}},{key:"render",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.renderer.set_style(this.model.children),this.renderer.set_position(this.model),e&&e.newTree!==e.oldTree?this.renderActionAnimation(t,e):(this.enter_and_exit(t),this.update_existing(t)),this.events.updated({type:"updated",source:this,sender_id:this.id}),this.is_animating++,t?setTimeout(this.animationFinished.bind(this),t?this.settings.get("dur"):0):this.animationFinished()}},{key:"renderActionAnimation",value:function(t,e){var n=this.analyzeNodeMap(e),i=this.normal_sel.filter(function(t){return n.exit[t.id]}).each(function(t){t.x0=n.exit[t.id].x0,t.y0=n.exit[t.id].y0});i.filter(function(t){return t._set_vis_at_start}).style("opacity",0),this._exit(i,"normal",t);var r=this.normal_sel.filter(function(t){return n.update[t.id]}).each(function(t){this.__data__=n.update[t.id]});this._updateType(r,"normal",!1,t);var o=e.newTree.get_leaf_nodes().filter(function(t){var e=n.enter[t.id];return e&&(t._anim_use_base_pos?(t.x=e.x0,t.y=e.y0):(t.x=e.x,t.y=e.y)),e}),s=this.main.selectAll(".math-new").data(o).enter();this._enter(s,"normal",t),o.forEach(function(t){t.x=t.x0,t.y=t.y0}),this.normal_sel=this.main.selectAll(".gm-math"),this.normal_sel.each(function(t){delete t._set_vis_at_start,delete t._set_vis_at_end})}},{key:"analyzeNodeMap",value:function(t){var e={},n={},i={},r=t.getInverseNodeMap(),o=t.node_map,s=t.oldTree.get_leaf_nodes(),a=t.newTree.get_leaf_nodes();return r=this.filterNodesInMap(r,a,s),o=this.filterNodesInMap(o,s,a),Object.keys(o).forEach(function(t){var a=o[t],l=s.find(function(e){return e.id===t});if(0===a.length)i[t]=l;else if(1===a.length){var u=a[0].id,c=r[u];1===c.length?e[t]=a[0]:c.length>1&&(i[t]=a[0],n[u]=a[0])}else a.length>1&&a.every(function(e){if(!(r[e.id].length>1))return!0;i[t]=l})}),Object.keys(r).forEach(function(t){var e=r[t],s=a.find(function(e){return e.id===t});if(0===e.length)n[t]=s;else if(1===e.length){var l=e[0].id;o[l].length>1&&(n[t]=e[0],i[l]=e[0],s._set_vis_at_start=!0,e[0]._set_vis_at_start=!0)}else e.length>1&&e.every(function(e){if(!(o[e.id].length>1))return!0;n[t]=e})}),{update:e,enter:n,exit:i}}},{key:"filterNodesInMap",value:function(t,e,n){var i={};return Object.keys(t).forEach(function(r){e.find(function(t){return t.id===r})&&(i[r]=t[r].filter(function(t){return-1!==n.indexOf(t)}))}),i}},{key:"enter_and_exit",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";if("both"===e||"normal"===e){var n=this.normal_sel.data(l.Tree.get_leaf_nodes(this.model.children),function(t){return t.id});this._enter(n.enter(),"normal",t),this._exit(n.exit(),"normal",t),this.normal_sel=this.main.selectAll(".gm-math")}if("both"===e||"shadow"===e){var i=this.shadow_sel.data(l.Tree.get_leaf_nodes(this.model.filter(function(t){return t.dragging})),function(t){return t.id});this._enter(i.enter(),"shadow",t),this._exit(i.exit(),"shadow",t),this.shadow_sel=this.main.selectAll(".gm-shadow")}}},{key:"hideExitingNodes",value:function(){this.normal_sel.filter(function(){return this.__delete_me__}).style("display","none")}},{key:"getNormalNodesSelection",value:function(){return this.main.selectAll("div.gm-math").data(l.Tree.get_leaf_nodes(this.model.children),function(t){return t.id})}},{key:"getShadowNodesSelection",value:function(){if(!this.settings.get("show_node_targets"))return[];var t=this.model.filter(function(t){return t.dragging}),e=l.Tree.filter(function(t){return!t.has_children()},t);return this.main.selectAll("div.gm-shadow").data(e,function(t){return t.id})}},{key:"_enter",value:function(e,n){var i=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o="shadow"===n;if(0!==e.size()){var s=o?e.insert("div",".gm-smooshed,.gm-math"):e.append("div");s.classed("gm-math",!o).classed("gm-shadow",o).attr("id",function(t){return t.id}).style("position","absolute").style("transform-origin","center top").style("-webkit-transform-origin","center top");var a=s.append("div").style("position","absolute").classed("inner",!0).style("pointer-events","none").append("div").attr("class",function(t){return"//"===t.value?"line":"text"}).style("position","absolute"),l=(a.filter(function(t){return"//"===t.value}),a.filter(function(t){return"//"!==t.value}));if(this._updateType(s,n,!1,!1),o||this.enterTraceBackgrounds(s),l.style("font-family",function(t){return i.get_font(t).family}).style("font-weight",function(t){return i.get_font(t).weight}).style("font-style",function(t){return i.get_font(t).style}),o&&l.style("color",this.settings.get("shadow_node_color")).style("text-shadow",this.settings.get("shadow_node_shadow")),r){this._get_transition(s,!0).style("transform",f("x0","y0")).style("-webkit-transform",f("x0","y0"));var u=a.filter(function(t){return t._set_vis_at_end});u.style("opacity",1e-5),this._get_transition(u,!0,"linear").each("end",function(e){t.select(this).call(g,o)});var c=a.filter(function(t){return!t._set_vis_at_start&&!t._set_vis_at_end});c.style("opacity",1e-5),this._get_transition(c,!0,"linear").call(g,o)}this.settings.get("debug_draw")&&this.debugDraw(s)}}},{key:"enterTraceBackgrounds",value:function(t){this.settings.get("trace_syms")||(t=t.filter(function(t){return!t.is_group("sym")})),(t=t.select(".inner").selectAll(".bg-rect")).data(function(t){return[t]}).enter().insert("div","*").classed("bg-rect",!0).style("position","absolute").style({"border-radius":this.settings.get("trace_rect_radius")+"px",background:this.settings.get("trace_color"),visibility:"hidden"}).style({left:function(t){return t.sel_box.x+"px"},top:function(t){return t.sel_box.y/(t.scale_y||1)+"px"},width:function(t){return t.sel_box.width+"px"},height:function(t){return t.sel_box.height/(t.scale_y||1)+"px"}})}},{key:"updateTraceBackgrounds",value:function(t){t.selectAll(".bg-rect").data(function(t){return[t]}).style({left:function(t){return t.sel_box.x+"px"},top:function(t){return t.sel_box.y/(t.scale_y||1)+"px"},width:function(t){return t.sel_box.width+"px"},height:function(t){return t.sel_box.height/(t.scale_y||1)+"px"}})}},{key:"_exit",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];0!==t.size()&&(t.each(function(){this.__delete_me__=!0}),n?(this._get_transition(t).style("transform",f("x0","y0")).style("-webkit-transform",f("x0","y0")).each("end",function(){this.style.display="none"}),this._get_transition(t.select("div").filter(function(t){return!t._set_vis_at_end}),!0,"linear").style("opacity",1e-5)):t.style("display","none"))}},{key:"_get_transition",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e&&this.settings.get("dur")?t.transition().duration(e?this.settings.get("dur"):0).ease(n||this.settings.get("easing_fn")):(t.interrupt().transition(),t)}},{key:"_updateType",value:function(t,e,n,i){if(0!==t.size()){var r="shadow"===e,o=t.select(".text");if(!n){var s={sym_map:this.settings.get("symbol_mappings"),precision:this.settings.get("number_display_precision")};this._get_transition(t,i).style("transform",f(r?"x0":"x",r?"y0":"y")).style("-webkit-transform",f(r?"x0":"x",r?"y0":"y")),o.text(function(t){return t.to_string(s)})}var a=this._get_transition(o,i).style("font-size",function(t){return t.size+"px"}).call(g,r);r||(a.style("color",function(t){return t.color}),this.updateTraceBackgrounds(t)),this._get_transition(t.select(".line"),i).call(m.bind(this),this.settings.get("slanted_div_bar"),r),n||this.update_background()}}},{key:"update_style",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";"both"!==e&&"normal"!==e||this._updateType(this.normal_sel.filter(function(){return!this.__delete_me__}),"normal",!0,t),"both"!==e&&"shadow"!==e||this._updateType(this.normal_sel.filter(function(){return!this.__delete_me__}),"shadow",!0,t)}},{key:"update_existing",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";"both"!==e&&"normal"!==e||(this._updateType(this.normal_sel.filter(function(){return!this.__delete_me__}),"normal",!1,t),this.update_scrub()),"both"!==e&&"shadow"!==e||this._updateType(this.shadow_sel.filter(function(){return!this.__delete_me__}),"shadow",!1,t)}},{key:"update_scrub",value:function(){this.settings.get("visualize_scrubbable_nodes")&&"inspect"===this.settings.get("interaction_mode")?this.normal_sel.each(function(e){var n=t.select(this),i=n.selectAll(".scrub");0!==i.size()||!u.Num.is_num(e)||e.fixed||e.locked||(n.selectAll(".scrub").data(["top","bottom"]).enter().append("div").classed("scrub",!0).text(function(t){return"top"===t?"▲":"▼"}).style({opacity:.5,position:"absolute"}),i=n.selectAll(".scrub")),i.style("visibility",e.locked||e.hidden?"hidden":"visible"),i.style("font-size",e.size/4+"px"),i.each(function(n){var i="matrix(1.3, 0, 0, 1, "+(e.sel_box.x+e.sel_box.width/2)+"\n  , "+("top"===n?e.sel_box.y:e.sel_box.y+e.sel_box.height)+")translate(-42%,-50%)";t.select(this).style("transform",i).style("-webkit-transform",i)})}):this.normal_sel.selectAll(".scrub").remove()}},{key:"setMode",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.settings.get("interaction_mode")!==t&&(this.settings.set("interaction_mode",t),e&&this.update_existing(),this.interaction_handler&&this.interaction_handler.modeChanged(t))}},{key:"update_background",value:function(t){var e=this.model.children[0],n=this.getBBox();e&&!e.dragging&&(this.border_rect.style("border-radius",this.settings.get("border_radius")).style("background",this.settings.get("background_color")).style("border-color",this.settings.get("border_color")).style({left:n.x+"px",top:n.y+"px",width:n.width+"px",height:n.height+"px"}),this.settings.get("inline_display")&&this.main.style({left:n.x+"px",top:n.y+"px",width:n.width+"px",height:n.height+"px"}))}},{key:"set_background_visible",value:function(t){this.settings.set("bg_visible",!!t),this.border_rect.style("opacity",t?1:0)}},{key:"getBBox",value:function(t){t=t||{};var e=this.model.children[0];if(!e||!e.sel_box)return{x:0,y:0,width:0,height:0};var n={},i=this.settings.get("padding");return n.x=e.sel_box.x+(e.dragging?e.x0:e.x)-(t.no_padding?0:i.left),n.y=e.sel_box.y+(e.dragging?e.y0:e.y)-(t.no_padding?0:i.top),n.width=e.sel_box.width+(t.no_padding?0:i.left+i.right),n.height=e.sel_box.height+(t.no_padding?0:i.top+i.bottom),n}},{key:"updateDraggedNodes",value:function(t){var e="touch"===this.input_mode?this.settings.get("drag_dy_on_touch"):0;e*=this.model.children[0].size,this.normal_sel.filter(function(e){return-1!==t.indexOf(e)}).transition().duration(this.settings.get("dur_dragging")).ease("circle-out").style("transform",function(t){return"matrix(1, 0, 0, "+(t.scale_y||1)+", "+t.x+", "+(t.y+e)+")"}).style("-webkit-transform",function(t){return"matrix(1, 0, 0, "+(t.scale_y||1)+", "+t.x+", "+(t.y+e)+")"})}},{key:"get_font",value:function(t){return t&&t.is_group&&t.is_group("var")?this.font_settings.get("italic_font"):this.font_settings.get("normal_font")}},{key:"debugDraw",value:function(t){var e=this,n=t.select(".inner");n.append("div").style("position","absolute").style("opacity",function(t){return t.hidden?.3:1}).style("border","1px solid silver").style({left:function(t){return t.sel_box.x+.5+"px"},top:function(t){return t.sel_box.y/(t.scale_y||1)+.5+"px"},width:function(t){return t.sel_box.width-1+"px"},height:function(t){return t.sel_box.height/(t.scale_y||1)-1+"px"}}),n.append("div").style("position","absolute").style("opacity",function(t){return t.hidden?.3:1}).style("background","gray").filter(function(t){return t.sel_box}).style({left:function(t){return t.sel_box.x+"px"},width:function(t){return t.sel_box.width+"px"},top:function(t){return"-0.5px"},height:"1px"}),n.append("div").style("position","absolute").style("opacity",function(t){return t.hidden?.3:1}).style("background","orange").filter(function(t){return t.sel_box}).style({left:function(t){return t.sel_box.x+"px"},width:function(t){return t.sel_box.width+"px"},top:function(t){return t.descent/(t.scale_y||1)-.5+"px"},height:"1px"}),n.append("div").style("position","absolute").style("opacity",function(t){return t.hidden?.3:1}).style("background","green").filter(function(t){return t.sel_box}).style({left:function(t){return t.sel_box.x+"px"},width:function(t){return t.sel_box.width+"px"},top:function(t){return-t.ascent/(t.scale_y||1)-.5+"px"},height:"1px"}),n.append("div").style("position","absolute").style("opacity",function(t){return t.hidden?.3:1}).style("background","blue").filter(function(t){return t.sel_box}).style({left:function(t){return t.sel_box.x+"px"},width:function(t){return t.sel_box.width+"px"},top:function(t){return-t.size*e.font_settings.get("font_center")-.5+"px"},height:"1px"}),n.append("div").style("position","absolute").style("opacity",function(t){return t.hidden?.3:1}).style("background","pink").filter(function(t){return t.sel_box}).style({left:function(t){return t.sel_box.x+"px"},width:function(t){return t.sel_box.width+"px"},top:function(t){return-t.size*e.font_settings.get("font_dominant_baseline")-.5+"px"},height:"1px"})}}],[{key:"preloadFonts",value:function(t){e.fontloader?e.fontloader.add_fonts(t):e.fontloader=new s.FontLoader(t)}},{key:"createStaticExpression",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"string"==typeof t&&(t=document.querySelector(t));var r=new d.AlgebraModel(n,i),o=h.object.merged({interactive:!1,inactive_color:"#000000",v_align:"bottom",h_align:"left",inline_display:!0},i);return new e(r,t,o,function(t){t.scaleToContainer(o)})}}]),e}();function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"x",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y";return function(n){return"matrix(1, 0, 0, "+(n.scale_y||1)+", "+n[t]+", "+n[e]+")"}}function g(t,e){t.style("opacity",function(t){return e?t.hidden||t.hide_after_drop?1e-5:1:t.hidden||t.smooshing?1e-5:t.hide_after_drop?.4:1})}function m(e,n,i){var r=this;e.style("border-radius",function(t){return t.height+"px"}).style("left",0).style("width",function(t){return t.width+"px"}).style("height",function(t){return t.height+"px"}).style("background",function(t){return i?r.settings.get("shadow_node_color"):t.color}).style("box-shadow",i?this.settings.get("shadow_node_shadow"):null).call(g,i),n&&e.each(function(e){var n=.3*e.height,i=-Math.atan2(n,e.width),r=Math.cos(i),o=Math.sin(i),s="matrix("+r+", "+o+", "+-o+", "+r+", 0, 0)";t.select(this).style("transform",s).style("-webkit-transform",s)})}e.preloadFonts=p.preloadFonts,new c.SettingsType("AlgebraView").defaults.setAll({font_size:80,font_preset:"Kalam",auto_update:!0,color:"#333",selection_color:"#4682b4",inverse_selection_color:"#957946",only_synchronous_actions:!1,show_drag_indicator:!0,inactive_color:"#676965",mute:!1,hold_area_feedback:!0,fraction_size_factor:.75,exp_size_factor:.6,degree_size_factor:.5,brackets_size_factor:1.15,subscript_size_factor:.6,smooshed_nodes_shrink_factor:.5,debug_draw:!1,dur:750,dur_dragging:300,easing_fn:"cubic-in-out",pos:{x:0,y:0},inline_display:!1,interaction_mode:"edit",v_align:"alphabetic",h_align:"center",background_color:"none",bg_visible:!1,shadow_filter:null,border_color:"none",shadow_color:"none",border_radius:0,padding:{left:0,right:0,top:0,bottom:0},interactive:!0,event_receiver:null,symbol_mappings:{"-":"−","*":"·","/":"·"},use_arithmetic_multiplication_symbol:!1,wiggle_dur:200,wiggle_deg:10,wiggle_random_delay:100,show_node_targets:!0,shadow_node_color:"white",shadow_node_shadow:"0 0 1px gray, 0 0 1px black",enable_drag_to_join:!0,visualize_scrubbable_nodes:!0,rubber_band_selection:!0,hide_mouse_cursor:!0,hold_time:1500,trigger_delay_minimum:150,trigger_delay_factor:.8,fixed:!1,drag_dy_on_touch:0,trace_syms:!1,trace_color:"rgb(194, 219, 179)",trace_rect_radius:6,number_display_precision:3})}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Num=l;var i=n(0),r=n(1),o=n(36),s=n(26),a=n(22);function l(t){if(r.Tree.Node.call(this),this.max_precision=12,this.scrub_precision=0,"number"!=typeof t&&(t=0),!(t>=0))return new s.Sign(new l(-t));this.value=t}i.gmath.inherit(r.Tree.Node,l),o.asLeaf.call(l,"num"),l.is_num=function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?t.is_group("num")||t.is_group("sign","plusminus","addsub","add","sub")&&t.children[1]&&t.children[1].is_group("num"):t.is_group("num")||t.is_group("sign","add","sub")&&t.children[1]&&t.children[1].is_group("num")},l.get_value=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return NaN;for(var n=0,i=!1;;){if(t instanceof l)return i?t.get_base().value:t.get_base().value*Math.pow(-1,n);if(!t)return NaN;if(t.is_group("sign","sub"))n++;else if(e&&t.is_group("plusminus","addsub"))i=!0;else if(!t.is_group("add"))return NaN;t=t.children[1]}},l.is_equal_to=function(t){for(var e=l.get_value(t),n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return!isNaN(e)&&i.some(function(t){return t===e})},l.is_inequal_to=function(t,e,n){var i=l.get_value(t);if(isNaN(i))return!1;if("<"===e||"lt"===e)return i<n;if(">"===e||"gt"===e)return i>n;if("<="===e||"lte"===e)return i<=n;if(">="===e||"gte"===e)return i>=n;throw"(Num:is_inequal_to) Comparator not accepted."},l.prototype.get_signed_value=function(){var t=this.parent;if(!t)return this.get_base().value;var e=this.get_base().value;return t&&t.is_group("sign","sub")?-e:l.is_leading_num_in_sub_product(this)?-e:e},l.is_leading_num_in_sub_product=function(t){var e=t.parent;return!!(t instanceof l&&e.is_group("mul")&&!e.ls&&e.parent.is_group("product")&&e.parent.parent.is_group("sub"))&&e.parent.parent},l.apply_precision=function(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n},l.prototype.decimal_count=function(){var t=this.get_base().to_ascii(),e=t.indexOf(".");return-1===e?0:t.length-e-1},l.prototype.to_string=function(t){var e=t.precision,n=void 0===e?3:e;if(this.value===1/0)return"∞";var i=this.value;if(this.scrubbingThisNum){var r=Math.pow(10,-this.scrub_precision),o=Math.abs(i%r),s=r-o>r/10&&o>r/10;return i.toFixed(Math.max(0,this.scrub_precision+(s?1:0)))}return l.apply_precision(i,n).toString()},l.prototype.to_ascii=function(t){var e=l.apply_precision(this.get_base().value,this.max_precision),n=this.superAndSubscriptText("to_ascii",t),i=void 0;if(t&&t.rationalize_reals)if(Math.round(e)===e)i=e+n;else{var r=e.toString().split(".");i="("+("0"===r[0]?r[1]:r[0]+r[1])+"/1"+Array(r[1].length+1).join("0")+")"}else i=t&&t.integers_as_reals?""+e.toFixed(this.max_precision)+n:""+e+n;return n.length>0&&t&&t.subscripts_as_long_names?'"'+i+'"':i},l.prototype.to_latex=function(t){return(""+l.apply_precision(this.get_base().value,this.max_precision)).replace("Infinity","∞")+this.superAndSubscriptText("to_latex")},l.registerAtParser=function(t){var e=t.registerSymbol("(number)",30);e.nud=function(){return new l(this.value)},e.led=function(e){var n=t.parseExpression(a.MulDiv.prototype.bp,this);return a.MulDiv.createProduct(e,n)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sym=l;var i=n(0),r=n(1),o=n(36),s=n(20),a=n(31);function l(t){r.Tree.Node.call(this,"sym"),this.value=t}i.gmath.inherit(r.Tree.Node,l),o.asLeaf.call(l,"sym"),l.mappings={"-":"−","*":"·","/":"·","//":""},l.prototype.to_string=function(t){var e=t.sym_map;return""+this.to_string_value_modifier(this.get_base().value,e)+this.superAndSubscriptText("to_string")},l.prototype.to_latex=function(t){return this.hidden?"":""+this.to_latex_value_modifier(this.get_base().value)+this.superAndSubscriptText("to_latex")},l.prototype.to_ascii=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=void 0;e=this.isFunctionLabel&&this.parent.isCustomFunction?a.Var.prototype.to_ascii_value_modifier.apply(this,[this.get_base().value,t]):t.normalizeSynonymsForFunctionLabels&&this.isFunctionLabel?this.parent.value:this.get_base().value;var n=t.normalizeSynonymsForFunctionLabels&&this.isFunctionLabel&&s.Func.Trig.is_inverse_trig(this.parent)?"":this.superAndSubscriptText("to_ascii",t);return n.length>0&&t.subscripts_as_long_names?'"'+e+n+'"':e.toString()+n},l.prototype.to_string_value_modifier=function(t,e){var n=e||l.mappings;return"-"===t&&this.parent&&this.parent.is_group("sign")?"-":t in n?n[t]:t},l.prototype.to_latex_value_modifier=function(t){return this.isFunctionLabel&&this.parent.isCustomFunction?t.length>1?"\\text{"+t+"}":t:"/"===t?"\\cdot ":"*"===t?"\\cdot ":"("===t?"\\left(":")"===t?"\\right)":"["===t?"\\left[":"]"===t?"\\right]":"±"===t?"\\pm ":t},Object.defineProperty(l.prototype,"isFunctionLabel",{get:function(){return this.parent instanceof s.Func&&this.parent.getFunctionLabel()===this}})},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.user=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.Xhr=u;var o=n(10),s=n(40),a=function(){function e(){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.user_id=null,this.server="https://graspablemath.com",this.display_name="",this.email="",this.auth_token=null,this.logged_in=!1,this.readSettingsFromBrowserStorage(),this.events=t.dispatch("login","logout"),this.auth_token&&setTimeout(function(){return n.fetchUserInfo()},0)}return r(e,[{key:"logout",value:function(){this.logged_in=!1,this.auth_token=null,this.id=null,this.user_id=null,window.localStorage&&window.localStorage.removeItem("gm-auth-token"),this.events.logout({type:"logout",user:this})}},{key:"login",value:function(t){this.logged_in=!0,t&&(this.id=t.id,this.user_id=t.user_id,this.display_name=t.display_name,this.email=t.email,this.auth_token=t.auth_token||this.auth_token),this.updateSettings(t.settings),this.saveSettings(!0),this.events.login({type:"login",user:this})}},{key:"loginWithGoogle",value:function(t,e){var n=this;return console.log("called loginWithGoogle"),Promise.resolve(s.googleAuth.signIn(t)).then(function(){return n.authorizeWithGoogleIdToken(s.googleAuth.getIdToken())}).then(function(t){"function"==typeof e&&e(null,t)},function(t){if("function"!=typeof e)throw t;e(t,void 0)})}},{key:"silentLoginWithGoogle",value:function(t){s.googleAuth.isSignedIn()?this.authorizeWithGoogleIdToken(s.googleAuth.getIdToken()).then(function(e){"function"==typeof t&&t(null,e)},function(e){if("function"!=typeof t)throw e;t(e,void 0)}):"function"==typeof t&&t("Not logged in with Google account.")}},{key:"authorizeWithGoogleIdToken",value:function(t){var e=this;return console.log("called authorizeWithGoogleIdToken"),new Promise(function(n,i){u(e.server+"/auth/google/id-token?access_token="+t).contentType("application/json").parseResult(!0).run().then(function(t){e.login(t),n()},function(t){return console.log("failed",t)})})}},{key:"fetchUserInfo",value:function(){var t=this;return console.log("called authorizeWithGoogleIdToken"),new Promise(function(e,n){u(t.server+"/api/user").contentType("application/json").parseResult(!0).run().then(function(n){t.login(n),e()},function(t){return console.log("failed",t)})})}},{key:"getSettingsOfType",value:function(t){return o.SettingsType.get(t)&&o.SettingsType.get(t).user}},{key:"getAllSettings",value:function(){var t=o.SettingsType.getAll();for(var e in t)t[e]=t[e].user;return t}},{key:"updateSettings",value:function(t){if(t){var e=this.getAllSettings();for(var n in e)n in t&&e[n].setAll(t[n])}}},{key:"readSettingsFromBrowserStorage",value:function(){if("undefined"!=typeof localStorage&&(this.auth_token=localStorage.getItem("gm-auth-token")||this.auth_token,localStorage.getItem("gm-settings")))try{var t=JSON.parse(localStorage.getItem("gm-settings"));this.updateSettings(t)}catch(t){console.warn("Error reading the local gm-settings ",localStorage.getItem("gm-settings"))}}},{key:"writeSettingsToBrowserStorage",value:function(t){"undefined"!=typeof localStorage&&(localStorage.setItem("gm-auth-token",this.auth_token),localStorage.setItem("gm-settings",JSON.stringify(t)))}},{key:"saveSettings",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=o.SettingsType.userSettingsToJSON();this.writeSettingsToBrowserStorage(e),t||this.writeSettingsToServer(e)}},{key:"writeSettingsToServer",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.server+"/api/user/settings";t.xhr(i).header("Content-Type","application/json").post(JSON.stringify({settings:e}),function(t,e){n&&n(t,e)})}}]),e}(),l=e.user=new a;function u(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var e="get",n=null,r=!0,o=!1,s=null,a=new window.XMLHttpRequest,u={xhr:a,requestType:function(t){return e=t,u},contentType:function(t){return n=t,u},useAuthorization:function(t){return r=t,u},parseResult:function(t){return o=t,u},body:function(t){return s=(void 0===t?"undefined":i(t))===String?t:JSON.stringify(t),u},run:function(){return new Promise(function(i,u){a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status)if(o)try{i(JSON.parse(a.responseText))}catch(t){u(t)}else i(a.responseText);else u(a.responseText)},a.open(e,t),n&&a.setRequestHeader("Content-Type",n),r&&l.auth_token&&a.setRequestHeader("Authorization","Bearer "+l.auth_token),a.send(s)})}};return u}}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Brackets=p;var i=n(1),r=n(5),o=n(46),s=n(11),a=n(20),l=n(9),u=n(16),c=n(22),d=n(15),h=n(44);function p(t,e,n){l.Group.call(this),t&&(i.Tree.append(this,new u.Sym(e||"(")),i.Tree.append(this,t),i.Tree.append(this,new u.Sym(n||")")))}function f(t){return t.is_group("var")||o.AlgebraRegExp.isVarPlaceholder(t)}n(31),s.asOperator.call(p,"brackets",{bp:0}),p.prototype.to_latex=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p.areHidden(this)?this.children[1].to_latex(t):!t.parenthesisForFunctions&&this.parent instanceof a.Func&&this.parent.isCustomFunction?"\\left["+this.children[1].to_latex(t)+"\\right]":"\\left"+this.children[0].value+this.children[1].to_latex(t)+"\\right"+this.children[2].value},p.prototype.to_ascii=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!t.parenthesisForFunctions&&this.parent instanceof a.Func&&this.parent.isCustomFunction?"["+this.children[1].to_ascii(t)+"]":this.children[0].value+this.children[1].to_ascii(t)+this.children[2].value},p.registerAtParser=function(t){var e=t.registerSymbol("[",45);e.nud=function(){var e=t.parseExpression(0);return t.advance("\\right",!0),t.advance("]"),new p(e,"[","]")},e.led=o,t.registerSymbol("]");var n=t.registerSymbol("(",c.MulDiv.prototype.bp);n.nud=function(){var e=t.parseExpression(0);return t.advance("\\right",!0),t.advance(")"),new p(e)},n.led=function(e){var n=t.parseExpression(c.MulDiv.prototype.bp,this);return c.MulDiv.createProduct(e,n)},t.registerSymbol(")");var i=t.registerSymbol("\\left",45);i.nud=function(){if(t.match_current_token("[","(","|"))return t.parseExpression(30);throw this},i.led=function(e){if(t.match_current_token("["))return o(e);if(t.match_current_token("(","|")){var n=t.parseExpression(30);return c.MulDiv.createProduct(e,n)}throw this},t.registerSymbol("\\right");var r=t.registerSymbol("{",30);function o(e){var n=e;if(e instanceof h.Power&&f(e.children[0])){var i=e;if(i.match("\\VAR^{-1}")){(n=i.children[0]).set_script(new d.Num(-1),"superscript",!0);var r=t.parseExpression(a.Func.prototype.bp,this);return new a.Func(n,r)}(n=i.children[0]).remove();var o=t.parseExpression(a.Func.prototype.bp,this),s=new a.Func(n,o);return i.insert(0,s),i}if(f(n)){var l=t.parseExpression(a.Func.prototype.bp,this);return new a.Func(n,l)}var u=t.parseExpression(c.MulDiv.prototype.bp,this);return c.MulDiv.createProduct(e,u)}r.nud=function(){var e=t.parseExpression(0);return e.user_grouped=!0,t.advance("}"),e},r.led=n.led,t.registerSymbol("}")},p.areHidden=function(t){return t&&t.is_group("brackets")&&t.children[0].hidden},p.handle=function(t,e){if(t.is_group("brackets"))return!(!e||!p.is_optional(t))&&(i.Tree.replace(t,t.children[1]),"removed");if(!p.is_optional(t)){var n=t.parent,r=i.Tree.remove(t);return i.Tree.insert(n,r,new p(t)),"added"}return!1},p.is_optional=function(t,e){if(t.is_group("brackets")&&t.children[1].is_group("brackets"))return!0;var n=t.is_group("brackets")?t.children[1]:t;return!((e=e||t.parent)&&(n.is_group("tuple")&&!e.is_group("func")||!e.is_group("tuple")&&!n.is_group("abs-val")&&n.has_children()&&!(e instanceof r.AlgebraModel)&&!e.is_group("subscript","superscript")&&!t.is_group("subscript","superscript")&&(!e.is_group("sign","plusminus")||!n.is_group("fraction"))&&(e.is_group("func")&&n.is_group("tuple")||e.bp>n.bp||!n.is_group("sign","plusminus")&&!(e.bp<n.bp)&&(!e.is_group("sign")||!n.is_group("sign"))&&(!e.associative||!n.is_group(e.group_name))&&(!n.commutative||!e.is_group(n.group_name))&&(!n.is_group("mul","div")||!e.is_group("fraction"))&&!(n.is_group("product")&&e.is_group("div")&&e.parent&&e.parent.is_group("fraction"))&&(!n.is_group("fraction")||!e.is_group("mul","div")))))},p.prototype.changeBracketType=function(t,e){this.children[0].value=t,this.children[this.children.length-1].value=e}},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasElement=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=n(10);e.CanvasElement=function(){function e(n,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"CanvasElement";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=o.id||r.gmath.uid(),this.type="canvas-element",this.canvas_model=n,this.element_div=null,this.events=t.dispatch("start-of-interaction","end-of-interaction","active","move","resize","moved","resized"),this.mouse_events=t.dispatch("touch","drag","release"),this.dragging=!1,this.initCanvasElementSettings(o,s),this.initElement(i),this.initCanvasElementProperties(),this.enterMode(this.mode,!0),this.settings.get("select_on_create")&&this.setDragging(!0)}return i(e,[{key:"emitEvent",value:function(t,e){var n={type:t,source:this,time:Date.now()};e&&(n=r.gmath.extend(n,e)),this.events[t](n)}},{key:"initCanvasElementSettings",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];this.settings=new o.Settings(e),this.settings.setExisting(t)}},{key:"initElement",value:function(e){if(this.settings.get("visualized"))return 0===arguments.length?this.containing_group.node():(this.containing_group=t.select(e),this.updateContainerDims(),this.element_div?this.containing_group.node().appendChild(this.element_div.node()):this.element_div=this.containing_group.append("div").classed("canvas-element",!0).attr("id",this.id).datum(this).on("mouseenter."+this.id,this.mouseHovering.bind(this,!0)).on("mouseleave."+this.id,this.mouseHovering.bind(this,!1)).style("pointer-events","all").style("position","absolute"),this.delete_grp&&this.delete_grp.selectAll("rect").style("fill",this.settings.get("delete_btn_color")),this)}},{key:"initCanvasElementProperties",value:function(){this.mode=this.settings.get("mode"),this.active=this.settings.get("active"),this.settings.get("visualized")&&(this.size=r.gmath.extend({},this.settings.get("size")),this.pos=this.alignmentToPosition(this.settings.get("pos")),this.translateElement(this.pos),this.element_div.style("height",this.size.height+"px").style("width",this.size.width+"px"),this.updateBGStyle())}},{key:"setMode",value:function(t){if(this.settings.get("visualized"))return t?t!==this.mode&&(this.settings.get("modes").every(function(e){return e!==t})&&this.setMode("edit"),this.exitMode(t),this.enterMode(t),this.mode=t,this.updateBGStyle(),!0):this.mode}},{key:"exitMode",value:function(t){this.exitSubTypeMode(t),"arrange"===this.mode&&this.exitArrangeMode(),"arrange"!==this.mode&&"arrange"===t&&this.exitEditMode()}},{key:"exitSubTypeMode",value:function(){}},{key:"enterMode",value:function(t,e){this.settings.get("visualized")&&("arrange"===t?this.enterArrangeMode():this.enterEditMode(),this.enterSubTypeMode(t))}},{key:"enterSubTypeMode",value:function(t){}},{key:"enterEditMode",value:function(){if(this.edit_mtouch?this.edit_mtouch.connected(!0):(this.edit_mtouch=r.gmath.mtouch_events(),this.edit_mtouch.origin(function(t){return[t.pos.x,t.pos.y]}).on("touch."+this.id,this.touch.bind(this,null)).on("drag."+this.id,this.drag.bind(this,null)).on("release."+this.id,this.release.bind(this,null))),!this.edit_move_div&&this.settings.get("draggable")){var t=this.settings.get("edit_mode_drag_box_width")<0,e=(t?-1:1)*this.settings.get("edit_mode_drag_box_width");this.edit_move_div=this.element_div.append("div").style({position:"absolute",left:t?-e+"px":0,top:0,bottom:0,width:e+"px"}).style("cursor",this.settings.get("draggable")?"move":null).call(this.edit_mtouch)}else this.edit_move_div&&this.edit_move_div.style("display",null)}},{key:"exitEditMode",value:function(){this.edit_mtouch&&this.edit_mtouch.connected(!1),this.edit_move_div&&this.edit_move_div.style("display","none")}},{key:"enterArrangeMode",value:function(){this.initMoveControls(),this.initDeleteControls(),this.initResizeControls()}},{key:"initMoveControls",value:function(){this.arrange_mtouch||(this.arrange_mtouch=r.gmath.mtouch_events().origin(function(t){return[t.pos.x,t.pos.y]}).on("touch."+this.id,this.touch.bind(this,null)).on("drag."+this.id,this.drag.bind(this,null)).on("release."+this.id,this.release.bind(this,null))),this.arrange_mode_div||(this.arrange_mode_div=this.element_div.append("div").classed("canvas-element-arrange-pane",!0).datum(this).style({position:"absolute",left:0,right:0,top:0,bottom:0}).style("pointer-events","all").style("cursor",this.settings.get("draggable")?"move":null).call(this.arrange_mtouch))}},{key:"initDeleteControls",value:function(){var e=this;if(this.delete_mtouch||(this.delete_mtouch=r.gmath.mtouch_events().on("release",function(){this.contains(t.event.sourceEvent.target)&&(e.emitEvent("start-of-interaction"),e.canvas_model.removeElement(e),e.emitEvent("end-of-interaction"))})),!this.delete_grp){var n=this.settings.get("delete_btn_size");this.delete_grp=this.element_div.append("svg").style({position:"absolute",width:n+10+"px",height:n+10+"px",right:"-3px",top:"-3px","z-index":65}).call(this.delete_mtouch),this.delete_icon=this.delete_grp.append("g").style("mouse-events","all").on("mouseenter",function(){t.select(this).selectAll("rect").style("fill","red")}).on("mouseleave",function(){t.select(this).selectAll("rect").style("fill",e.settings.get("delete_btn_color"))}).attr("transform","translate("+[n/2+5,n/2+5]+")rotate(45)"),this.delete_icon.append("circle").attr({r:n/2+5}).style("opacity",0),this.delete_icon.append("rect").attr({width:n,height:n/3.5,x:-n/2,y:-n/7}).style("fill",this.settings.get("delete_btn_color")).style("stroke","none"),this.delete_icon.append("rect").attr({width:n/3.5,height:n,x:-n/7,y:-n/2}).style("fill",this.settings.get("delete_btn_color")).style("stroke","none")}}},{key:"initResizeControls",value:function(){var e=this;if(this.settings.get("resizable").x||this.settings.get("resizable").y){if(this.resize_grp&&this.resize_grp.style("display",null),this.resize_mtouch||(this.resize_mtouch=r.gmath.mtouch_events().origin(function(){return[e.size.width,e.size.height]}).on("touch."+this.id+"_resize",function(){e.emitEvent("start-of-interaction",{size:{width:e.size.width,height:e.size.height}})}).on("drag."+this.id+"_resize",function(){e.resize({width:t.event.x,height:t.event.y})}).on("release."+this.id+"_resize",function(){var t={size:{width:e.size.width,height:e.size.height}};e.emitEvent("end-of-interaction",t),e.emitEvent("resized",t)})),!this.resize_grp){var n;n=this.settings.get("resizable").x&&this.settings.get("resizable").y?"nwse-resize":this.settings.get("resizable").x?"ew-resize":"ns-resize";var i=this.settings.get("resize_tab_size");this.resize_grp=this.element_div.append("svg").style({position:"absolute",width:i+10+"px",height:i+10+"px",right:"-5px",bottom:"-5px"}).call(this.resize_mtouch),this.resize_icon=this.resize_grp.append("g").style("mouse-events","all").attr("transform","translate("+[i+5,i+5]+")").style("cursor",n),this.resize_icon.append("circle").attr({r:i/2+5,cx:-i/3,cy:-i/3}).style("opacity",0),this.resize_icon.append("path").attr("d","M"+[-i,0]+"L"+[0,0]+"L"+[0,-i]+"Z").style("fill",this.settings.get("resize_tab_color")).style("stroke","none")}}else this.resize_grp&&this.resize_grp.style("display","none")}},{key:"exitArrangeMode",value:function(){this.arrange_mode_div&&(this.arrange_mode_div.remove(),delete this.arrange_mode_div),this.arrange_mtouch&&(this.arrange_mtouch.connected(!1),delete this.arrange_mtouch),this.delete_grp&&(this.delete_grp.remove(),delete this.delete_grp),this.delete_mtouch&&(this.delete_mtouch.connected(!1),delete this.delete_mtouch),this.resize_grp&&(this.resize_grp.remove(),delete this.resize_grp),this.resize_mtouch&&(this.resize_mtouch.connected(!1),delete this.resize_mtouch)}},{key:"touch",value:function(e){this.emitEvent("start-of-interaction",{pos:r.gmath.deepCopy(this.pos)}),e||t.event,this.updateContainerDims(),this.setDragging(!0),"arrange"!==this.mode&&this.setActive(!0)}},{key:"drag",value:function(e){var n=e||t.event;this.settings.get("draggable")&&(this.settings.get("keep_in_container")&&(this.canvas_model.horizontalScrollEnabled()||(n.x=Math.min(this.container_size.width-this.size.width,n.x)),n.x=Math.max(0,n.x),this.canvas_model.verticalScrollEnabled()||(n.y=Math.min(this.container_size.height-this.size.height,n.y)),n.y=Math.max(0,n.y)),this.translateElement(n))}},{key:"release",value:function(t){this.setDragging(!1);var e={pos:{x:this.pos.x,y:this.pos.y}};this.emitEvent("end-of-interaction",e),this.emitEvent("moved",e)}},{key:"setDragging",value:function(t){this.dragging!==t&&(this.dragging=t,this.updateBGStyle())}},{key:"resize",value:function(t){if(this.settings.get("resizable").x||!this.settings.get("resizable").y){var e=Math.max(this.settings.get("min_size").width,t.width),n=Math.max(this.settings.get("min_size").height,t.height);e=Math.min(e,e-(t.width+this.pos.x-this.container_size.width)),n=Math.min(n,n-(t.height+this.pos.y-this.container_size.height)),this.settings.get("resizable").x||(e=this.size.width),this.settings.get("resizable").y||(n=this.size.height),this.resizeElement({width:e,height:n})}}},{key:"resizeElement",value:function(t){this.size.width===t.width&&this.size.height===t.height||(this.size.width=t.width,this.size.height=t.height,this.element_div.style("width",this.size.width+"px").style("height",this.size.height+"px"),this.subTypeResize(),this.events.resize({type:"resize",size:{width:this.size.width,height:this.size.height}}))}},{key:"subTypeResize",value:function(){}},{key:"updateContainerDims",value:function(){this.canvas_model?(this.container_size=this.canvas_model.size(),this.container_view=this.canvas_model.viewport()):(this.container_size=this.containing_group.node().getBoundingClientRect(),this.container_view=this.container_size)}},{key:"initPosition",value:function(t){"auto"===this.settings.get("pos")?this.canvas_model.moveToFreeSpace(this,t):(this.pos=this.alignmentToPosition(this.settings.get("pos")),this.translateElement(this.pos,t))}},{key:"alignmentToPosition",value:function(t){var e=t.x,n=t.y;return"center"===e?e=this.container_view.width/2-this.size.width/2:"left"===e?e=0:"right"===e&&(e=this.container_view.width-this.size.width),"center"===n?n=this.container_view.height/2-this.size.height/2:"top"===n?n=0:"bottom"===n&&(n=this.container_view.height-this.size.height),{x:e,y:n}}},{key:"translateElement",value:function(t,e){if(this.settings.get("visualized")){this.pos.x=t.x,this.pos.y=t.y;var n=this.settings.get("graphics_caching")?"translate3d("+[Math.round(this.pos.x)+"px",Math.round(this.pos.y)+"px",0]+")":"translate("+[Math.round(this.pos.x)+"px",Math.round(this.pos.y)+"px"]+")",i=this.element_div;e&&(i=i.transition().duration(this.settings.get("dur")).ease(this.settings.get("easing_fn"))),i.style("transform",n),i.style("-webkit-transform",n),this.events.move({type:"move",animated:e,pos:{x:this.pos.x,y:this.pos.y}})}}},{key:"moveElement",value:function(t,e){var n={x:this.pos.x+t.x,y:this.pos.y+t.y};this.translateElement(n,e)}},{key:"mouseHovering",value:function(t){this.canvas_model?this.canvas_model.setActive(this,t):this.setActive(t)}},{key:"setActive",value:function(t){this.active!==t&&(this.active=t,this.updateBGStyle(),"arrange"!==this.mode&&this.setSubTypeActive(),this.emitEvent("active",{active:t}))}},{key:"setSubTypeActive",value:function(){}},{key:"updateBGStyle",value:function(){if(this.settings.get("show_bg")){var t=["bg"];t.push("arrange"!==this.mode?"edit":"arrange"),this.dragging?t.push("dragging"):this.active&&t.push("active"),t.push("style"),this.element_div.style("visibility",null).style(this.settings.get(t.join("_")))}}},{key:"removeElement",value:function(){this.element_div.remove()}},{key:"getBoundingClientRect",value:function(){return this.element_div.node().getBoundingClientRect()}},{key:"getBBox",value:function(){return{x:this.pos.x,y:this.pos.y,width:this.size.width,height:this.size.height}}},{key:"overlapsWithRegion",value:function(t){r.gmath.HitTester.overlaps({x:this.pos.x,y:this.pos.y,width:this.size.width,height:this.size.height},t)}},{key:"hitTest",value:function(t){return t.x>=this.pos.x&&t.x<=this.pos.x+this.size.width&&t.y>=this.pos.y&&t.y<=this.pos.y+this.size.height}},{key:"getDistanceTo",value:function(t){var e=this.size.width/2,n=this.size.height/2,i=Math.max(Math.abs(this.pos.x+e-t.x)-e,0),r=Math.max(Math.abs(this.pos.y+n-t.y)-n,0);return i*i+r*r}}]),e}(),new o.SettingsType("CanvasElement").defaults.setAll({visualized:!0,pos:{x:"center",y:"center"},min_size:{width:30,height:50},size:{width:100,height:100},active:!1,mode:"edit",modes:["edit","arrange"],resizable:{x:!0,y:!0},draggable:!0,keep_in_container:!0,send_events:!0,dont_log_events:!1,graphics_caching:!0,delete_btn_size:20,delete_btn_color:"silver",resize_tab_size:25,resize_tab_color:"#c6c6c6",dur:300,easing_fn:"cubic-in-out",edit_mode_drag_box_width:20,show_bg:!0,bg_edit_style:{"background-color":"transparent","box-shadow":"none","border-radius":"2px"},bg_edit_active_style:{"background-color":"rgba(255,255,255,0.9)","box-shadow":"none"},bg_edit_dragging_style:{"background-color":"rgba(255,255,255,0.9)","box-shadow":"0 3px 6px rgba(0,0,0,0.23)"},bg_arrange_style:{"background-color":"rgba(255,255,255,0.9)","box-shadow":"0 3px 6px rgba(0,0,0,0.23)"},bg_arrange_active_style:{"background-color":"rgba(255,255,255,0.9)","box-shadow":"0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23)"},bg_arrange_dragging_style:{"background-color":"rgba(255,255,255,0.9)","box-shadow":"0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23)"}})}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Func=m;var i=n(0),r=n(1),o=n(11),s=n(9),a=n(18),l=n(63),u=n(16),c=n(31),d=n(15),h=(n(45),n(22)),p=n(62),f=n(44),g=n(26);function m(t,e){var n;s.Group.call(this),t?t instanceof u.Sym?(this.value=(n=t,v.some(function(t){return n.value==="arc"+t})?b(n.value.substr(3)):n.value),r.Tree.append(this,t)):(this.value="func",r.Tree.append(this,t)):this.value="func",void 0!==e&&this.set_arg(e)}i.gmath.inherit(s.Group,m),o.asOperator.call(m,"func",{bp:60,commutative:!1}),m.prototype.is_leaf_node=!1,m.prototype.is_group=function(){if(0===arguments.length)return!0;for(var t=0;t<arguments.length;t++){if("func"===arguments[t])return!0;if(arguments[t]===this.value)return!0}return!1},m.prototype.to_string=function(){return this.value},m.prototype.set_arg=function(t){if(Array.isArray(t))this.append(new a.Brackets(new l.Tuple(t)));else if(t.is_group("tuple"))this.append(t),a.Brackets.handle(this.children[1]);else if(t.is_group("brackets")&&t.children[1].is_group("tuple"))this.append(t);else if(t.is_group("brackets")&&!t.children[1].is_group("tuple")){var e=t,n=e.children[1];e.insert(n.remove(),new l.Tuple(n)),this.append(e)}else this.append(new l.Tuple(t)),a.Brackets.handle(this.children[1]);this.children[1].changeBracketType("(",")")},m.prototype.arg_length=function(){var t=this.children[1];return(t.is_group("tuple")?t:t.children[1]).children.length},m.prototype.get_arg=function(){var t=this.children[1];return t.get_child(t.is_group("brackets")?[1,0,1]:[0,1])},m.prototype.map_to_func=function(t,e,n){var i=n?t.updateNodeMap.bind(t):t.extendNodeMap.bind(t);i(this,e),i(this.children[0].get_mapping_to(e.children[0]));var r=this.children[1],o=e.children[1];r.is_group("brackets")&&o.is_group("brackets")&&(i(r,o),i(r.children[0],o.children[0]),i(r.children[2],o.children[2]),r=r.children[1],o=o.children[1]),i(r,o)},m.prototype.map_to_group=function(t,e,n){var i=n?t.updateNodeMap.bind(t):t.extendNodeMap.bind(t),r=[];this.for_each(function(t){r.push(t)},this),r.forEach(function(t){i(t,e)}),i=t.extendNodeMap.bind(t),e.children.forEach(function(t){t.for_each(function(t){r.forEach(function(e){i(e,t)})},this)},this)},m.prototype.getFunctionLabel=function(){return this.children[0]},m.prototype.isInverseOf=function(t){if(!t.is_group("func"))return!1;if(1!==this.arg_length())return!1;if(1!==t.arg_length())return!1;if(this.isCustomFunction){var e=/(.*)\^(\(-1\)|{-1}|-1)$/,n=t.children[0].to_ascii().match(e);if(n){var i=this.children[0].value;return 1===i.length?i===n[1]:'"'+i+'"'===n[1]}if(n=this.children[0].to_ascii().match(e)){var r=t.children[0].value;return 1===r.length?r===n[1]:'"'+r+'"'===n[1]}return!1}return!t.isCustomFunction&&(m.Trig.is_trig(this)?b(this.value)===t.value:!!m.Trig.is_inverse_trig(this)&&this.value===b(t.value))},Object.defineProperty(m.prototype,"isCustomFunction",{get:function(){return"func"===this.value}}),m.Trig={},m.Trig.evaluate=function(t){var e=d.Num.get_value(t.get_arg());return Number.isNaN(e)?NaN:Math[t.value](e)},m.Trig.is_trig_func=function(t){return t&&(m.Trig.is_trig(t)||m.Trig.is_inverse_trig(t))},m.Trig.is_trig=function(t){return t.is_group("func")&&v.some(function(e){return t.value===e})},m.Trig.is_inverse_trig=function(t){return t.is_group("func")&&v.some(function(e){return t.value===b(e)})},m.Logs={},m.Logs.is_log_func=function(t){return t&&t.is_group("func")&&("log"===t.value||"ln"===t.value)},m.Logs.get_log_base=function(t,e){var n;return t.children[0].has_script("subscript")&&(n=t.children[0].get_script("subscript").children[0]),n||e||(n=m.Logs.get_implied_subscript(t)),n},m.Logs.get_implied_subscript=function(t){var e=t.children[0].get_value();return"log"===e?new d.Num(10):"ln"===e?new c.Var("e"):null},m.Logs.within_domain=function(t){return d.Num.is_inequal_to(t,"gt",0)||c.Var.is_var(t)&&"e"===t.get_value()},m.Logs.evaluate=function(t){var e=m.Logs.get_log_base(t).get_value(),n=t.get_arg().get_value();return"e"===n&&(n=Math.E),"e"===e&&(e=Math.E),Math.log(n)/Math.log(e)};var v=["sin","cos","tan","sinh","cosh","tanh"],y=["log","ln"].concat(v).concat(v.map(function(t){return b(t,"arc")})).concat(v.map(function(t){return b(t)}));function b(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"a")+t}m.preprogrammedFunctions=y.concat("sqrt"),m.isTriggerableFuncPart=function(t){function e(t,e,n){var i=t.get_parent(e);return i&&i.is_group(n)}return e(t,1,"func")?t.parent:t.is_group("sym")&&e(t,1,"brackets")&&e(t,2,"func")?t.get_parent(2):!!(e(t,1,"param")&&e(t,2,"tuple")&&e(t,3,"brackets")&&e(t,4,"func"))&&t.get_parent(4)},m.getImmediateParentFunctionIfExists=function(t){var e=t.get_parent(4);return e&&e.is_group("func")?e:null},m.registerAtParser=function(t){var e=function(){var e,n="\\"===this.value[0]?this.value.substr(1):this.value;(e=n.match("operatorname{(.*)}"))&&(n=e[1]);var i=new m(new u.Sym(n));!function(e){if(t.advance("_",!0)){var n=e.children[0].value,i=t.parseExpression(99);("ln"===n&&d.Num.is_num(i)||"ln"===n&&c.Var.is_var(i)&&"e"!==i.value)&&(e.value="log",e.children[0].value="log"),e.children[0].set_script(i,"subscript",!1)}}(i);var r=void 0;if(t.advance("^",!0)){var o=t.parseExpression(p.Exponent.prototype.bp-1);switch(o.to_ascii()){case"-1":case"(-1)":case"[-1]":case"{-1}":if(i.children[0].set_script(new g.Sign(new d.Num(1)),"superscript",!1),!v.some(function(t){return t===i.value}))throw"We do not support parsing "+i.value+"^-1";i.value=b(i.value);break;default:r=o}}var s=t.parseExpression(m.prototype.bp);if(s.is_group("brackets")&&s.children[1].is_group("tuple")&&s.children[1].children.length>1)throw"Supported functions cannot have multiple arguments";return i.set_arg(s),r?new f.Power(i,r):i},n=function(e){var n=t.parseExpression(h.MulDiv.prototype.bp,this);return h.MulDiv.createProduct(e,n)},i=function(i){var r=t.registerSymbol(i,m.prototype.bp);r.nud=e,r.led=n};y.forEach(i),y.forEach(function(t){return i("\\"+t)}),y.forEach(function(t){return i("\\operatorname{"+t+"}")})}},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.LinkCoordinator=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.linkCoordinator=s;var r=n(7),o=new(e.LinkCoordinator=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=(0,r.uid)(),this.links=[],this.groups=[],this.node_to_group={},this.unlinked_nodes=[],this.events=t.dispatch("link_added","link_removed"),this.auto_update_scrubbability=!0}return i(e,[{key:"toJSON",value:function(){return{type:"LinkCoordinator",links:this.links,auto_update_scrubbability:this.auto_update_scrubbability}}},{key:"addLinks",value:function(t,e){var n=this;t.forEach(function(t){return n.addLink(t,e)})}},{key:"addLink",value:function(t,e){this.links.push(t),this.registerLink(t,e),this.events.link_added({link:t})}},{key:"registerLink",value:function(t,e){var n=this.getGroup(t.source),i=this.getGroup(t.target);if(t.bidirectional){if(n!==i){var r=this.mergeGroups(n,i);this.auto_update_scrubbability&&!e&&this.setLocked(r)}}else{if(n===i)throw"unidirectional linking between bidirectionally linked nodes!";i.deps+=1,this.auto_update_scrubbability&&!e&&this.setLocked(i)}}},{key:"getGroup",value:function(t){var e=this.node_to_group[t.id];return e||(e={deps:0,nodes:[t]},this.groups.push(e),this.node_to_group[t.id]=e),e}},{key:"replaceNode",value:function(t,e){if(this.node_to_group[t.id]){var n=this.node_to_group[t.id];delete this.node_to_group[t.id],this.node_to_group[e.id]=n;var i=n.nodes.indexOf(t);n.nodes[i]=e}}},{key:"unlinkCanvasModel",value:function(t,e){var n=this;t.dls().forEach(function(t){return n.unlinkDL(t,!0)}),t.getElementsOfType("graph").forEach(function(t){return n.unlinkGraph(t,!0)}),this.auto_update_scrubbability&&!e&&this.updateAll()}},{key:"unlinkDL",value:function(t,e){return this.unlinkContainer(t.rows,"model",e)}},{key:"unlinkGraph",value:function(t,e){return this.unlinkContainer(t.geoms,null,e)}},{key:"unlinkContainer",value:function(t,e,n){var i=this,r=[];return t.forEach(function(t){r=r.concat(i.unlinkElement(e?t[e]:t,!0))}),this.auto_update_scrubbability&&!n&&this.updateAll(),r}},{key:"unlinkElement",value:function(t,e){var n=this,i=[];return this.links=this.links.filter(function(e){if(e.source===t||e.target===t){var r=e.source===t?e.target:e.source;return-1===n.unlinked_nodes.indexOf(r)&&n.unlinked_nodes.push(r),i.push(e),!1}return!0}),-1===this.unlinked_nodes.indexOf(t)&&this.unlinked_nodes.push(t),this.auto_update_scrubbability&&!e&&this.updateAll(),i}},{key:"updateAll",value:function(){this.groups=[],this.node_to_group={};for(var t=0;t<this.unlinked_nodes.length;t++)this.getGroup(this.unlinked_nodes[t]);this.unlinked_nodes=[];for(var e=0;e<this.links.length;e++)this.registerLink(this.links[e],!0);for(var n=0;n<this.groups.length;n++)this.setLocked(this.groups[n])}},{key:"setLocked",value:function(t){t.nodes.forEach(function(e){return e.setLocked(t.deps>0)})}},{key:"mergeGroups",value:function(t,e){var n=this,i=this.groups.indexOf(e);return this.groups.splice(i,1),e.nodes.forEach(function(e){return n.node_to_group[e.id]=t}),t.nodes=t.nodes.concat(e.nodes),t.deps+=e.deps,t}}],[{key:"fromJSON",value:function(t,e){var n=s();return n.links=n.links.concat(t.links),n.updateAll(),n}}]),e}());function s(t){return arguments.length>0&&(o=t),o}}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MulDiv=h;var i=n(1),r=n(11),o=n(9),s=n(112),a=n(18),l=n(16),u=n(15),c=n(31),d=n(26);function h(t,e){o.Group.call(this),this.value="div"==e?"div":"mul",t&&(i.Tree.append(this,new l.Sym("mul"==this.value?"*":"/")),i.Tree.append(this,t),a.Brackets.handle(t)),this.associative="mul"==this.value,this.bp=(this.value,30)}r.asOperator.call(h,"mul-div",{group_class:s.ProductFraction,bp:30,associative:!0,commutative:!0,has_inverse:!0}),h.createProduct=function(t,e){if(t.is_group("product"))return e.is_group("product")?e.children.map(function(e){e.remove(),t.append(e)}):t.append(new h(e)),t;if(e.is_group("product"))return e.insert(0,new h(t)),e;var n=h.prototype.createParentGroup();return n.append(new h(t)),n.append(new h(e)),n},h.registerAtParser=function(t){var e=t.registerSymbol("*",h.prototype.bp);e.led=function(e){var n=t.parseExpression(h.prototype.bp);return h.createProduct(e,n)},t.registerSymbol("\\cdot",h.prototype.bp).led=e.led,t.registerSymbol("\\times",h.prototype.bp).led=e.led,t.registerSymbol("/",h.prototype.bp+1).led=function(e){var n,i=t.parseExpression(h.prototype.bp+1);if(e.is_group("brackets")&&e.children[1].is_group("product","fraction")&&(e.user_grouped||((e=e.children[1]).children[0].children[1].user_grouped=!0)),e.is_group("product")?n=e:(n=h.prototype.createParentGroup()).append(new h(e)),i.is_group("brackets")&&i.children[1].is_group("product","fraction")&&(i.user_grouped||(i=i.children[1])),i.is_group("product"))for(var r=i.children,o=0;o<r.length;o++)r[o].invert(),n.append(r[o]);else n.append(new h(i,"div"));return n};var n=function(){var e,n=t.parseExpression(100),i=t.parseExpression(100);return n.is_group("product")?(e=n,n.children[0].children[1].user_grouped=!0):(e=h.prototype.createParentGroup()).append(new h(n)),i.is_group("product")?i.children.forEach(function(t){t.invert(),e.append(t)}):e.append(new h(i,"div")),e};t.registerSymbol("\\frac").nud=n,t.registerSymbol("\\dfrac").nud=n,t.registerSymbol("\\tfrac").nud=n},h.hide_rule={name:"hide multiplication sign when appropriate",disabled:!1,apply:function(t,e){if(!(t instanceof l.Sym)||"*"!==t.value&&"/"!==t.value)return!1;var n=t.parent;if(!n||!n.is_group("mul")&&!n.is_group("div"))return!1;if(!n.ls||n.ls.value!==n.value||!t.rs)return!1;var i=n.ls.children[1];function r(e){n.dragging?t.hide_after_drop=!e:t.hidden=!e}function o(){return u.Num.is_num(t.rs)||t.rs.is_group("power")&&u.Num.is_num(t.rs.getBase())}function s(){return t.rs.is_group("fraction")}"hideBetweenNumAndVarAndBetweenVarAndVar"==e.hide_implicit_multiplication_setting?(t.rs.is_group("var")||t.rs.is_group("power")&&t.rs.children[0].is_group("var"))&&(u.Num.is_num(i)||i.is_group("var")||i.is_group("sign")&&i.children[1].is_group("var"))&&r(!1):"hideUnlessAmbiguous"==e.hide_implicit_multiplication_setting?t.rs instanceof d.Sign?r(!0):function(){if(u.Num.is_num(i))return!0;var t=i;return!!(i instanceof d.Sign&&(t=i.getDescendentWithoutSigns(),u.Num.is_num(t)))||!!t.is_group("power")&&u.Num.is_num(t.children[0])}()?o()||s()?r(!0):r(!1):i.is_group("fraction")||i instanceof d.Sign&&i.getDescendentWithoutSigns().is_group("fraction")?o()||s()?r(!0):r(!1):(c.Var.is_var(i)||i instanceof d.Sign&&c.Var.is_var(i.getDescendentWithoutSigns()))&&(t.rs.is_group("brackets")||t.rs.is_group("power")&&t.rs.getBase().is_group("brackets"))?r(!0):r(!1):r(!0)}},h.prototype.invert=function(){"mul"==this.value?(this.value="div",this.children[0]&&(this.children[0].value="/"),this.associative=!1,this.bp=30):(this.value="mul",this.children[0]&&(this.children[0].value="*"),this.associative=!0,this.bp=30)},h.groupWithSiblings=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],i=[],r=t[0],o=t[t.length-1];r.ls&&r.ls.is_group(t[0].value)&&(!e||r.symIsHidden());)n.unshift(r.ls),r=r.ls;for(;o.rs&&o.rs.is_group(t[0].value)&&(!e||o.rs.symIsHidden());)i.push(o.rs),o=o.rs;return n.concat(t).concat(i)},h.prototype.symIsHidden=function(){return this.children[0].hidden||this.children[0].hide_after_drop},h.prototype.map_group_and_sym=function(t,e,n){var i=n?t.updateNodeMap.bind(t):t.extendNodeMap.bind(t);i(this,e),i(this.children[0],e.children[0])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){return t.layout(i.MathSettings.get("use_simple_keyboard_layout")?"simple":"num").extra_keys(n||["a","x","b","y","c","z"]),e&&t.latex(e),t.visible(!0),t};var i=n(12)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.bypassNegatives=function(t){for(;t.is_group("sign");)t=t.get_child([1]);return t},e.factorableMulDiv=function(t){var e=t;if(e.get_parent(1).is_group("fraction")&&e.get_parent(2).is_group("mul")&&(e=e.get_parent(2)),!e.is_group("mul","div"))return!1;var n=e.get_parent(1);if(!n.is_group("product","fraction"))return!1;var i=n.get_parent(1);if(!i.is_group("add","sub","addsub"))return!1;var r=i.get_parent(1);return!!r.is_group("sum")&&{ancestor_sum:r,addsub_idx:i.get_idx()}},e.val1IsAMultipleOfVal2=o,e.getGCF=s,e.numbersAreMultiples=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=r.Num.get_value(t),a=r.Num.get_value(e);return!(!i||!a)&&(!!o(i,a)||!!o(a,i)||!n&&1!==s(i,a))},e.operatorRangesArePermutations=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.length!==e.length)return!1;if(!t.concat(e).every(function(t){return t.is_group("add","sub","addsub","mul","div")}))return!1;var o=t.map(function(t){return"%"+t.value+"%"+t.children[1].to_ascii()}),s=e.map(function(t){var e=t.value;return"mul"===e&&n?e="div":"div"===e&&n?e="mul":"add"===e&&r?e="sub":"sub"===e&&r&&(e="add"),"%"+e+"%"+t.children[1].to_ascii()});return i.gmath.array.isPermutation(o,s)},e.findTopLevelGroupForCanceling=function(t){return a(t[0])||l(t[0])||u(t[0])},e.nodesAreInAFractionWithinAProduct=a,e.getParentProductContainingFraction=l,e.getParentFraction=u,e.nodeIsAncestorOfNodes=function(t,e){return e.every(function(e){for(var n=e;n;){if(n===t)return!0;n=n.parent}return!1})};var i=n(0),r=(n(1),n(2),n(5),n(3));function o(t,e){return Math.abs(t)>=Math.abs(e)&&1!==Math.abs(e)&&t%e==0}function s(t,e){if(!Number.isInteger(t)||!Number.isInteger(e))return 1;if(t<0&&(t=-t),e<0&&(e=-e),e>t){var n=t;t=e,e=n}if(0===e)return t;for(;;){if(0==(t%=e))return e;if(0==(e%=t))return t}}function a(t){var e=t.parent;return!!(e.is_group("fraction")&&e.parent&&e.parent.is_group("mul")&&e.parent.parent.is_group("product"))&&e.parent.parent}function l(t){var e=t.parent;return!(!e.is_group("product")||!e.children.some(function(t){return t.children[1].is_group("fraction")}))&&e}function u(t){var e=t.parent;return e.is_group("fraction")?e:null}},function(t,e,n){(function(){var t,i,r,o,s,a,l,u,c,d,h,p,f,g,m,v,y,b,_,x,w,A,k,T,S,M,E,N,O,q,C,P,j,D,I,F,L,z,R,B,H,G,V,U,W,Q,$,K,J,Z,Y,X,tt,et,nt,it,rt,ot,st,at,lt,ut,ct,dt,ht,pt,ft,gt,mt,vt,yt,bt,_t,xt,wt,At,kt,Tt,St,Mt,Et,Nt,Ot,qt,Ct,Pt,jt,Dt,It,Ft,Lt,zt,Rt,Bt,Ht,Gt,Vt,Ut,Wt,Qt,$t,Kt,Jt,Zt,Yt,Xt,te,ee,ne,ie,re,oe,se,ae,le,ue,ce,de,he,pe,fe,ge,me,ve,ye,be,_e,xe,we,Ae,ke,Te,Se,Me,Ee,Ne,Oe,qe,Ce,Pe,je,De,Ie,Fe,Le,ze,Re,Be,He,Ge,Ve,Ue,We,Qe,$e,Ke,Je,Ze,Ye,Xe,tn,en,nn,rn,on,sn,an,ln,un,cn,dn,hn,pn,fn,gn,mn,vn,bn,_n,xn,wn,An,kn,Tn,Sn,Mn,En,Nn,On,qn,Cn,Pn,Dn,In,Fn,Ln,zn,Rn,Bn,Hn,Gn,Vn,Un,Wn,Qn,$n,Kn,Jn,Zn,Yn,Xn,ti,ei,ni,ii,ri,oi,si,ai,li,ui,ci,di,hi,pi,fi,gi,mi,vi,yi,bi,_i,xi,wi,Ai,ki,Ti,Si,Mi,Ei,Ni,Oi,qi,Ci,Pi,ji,Di,Ii,Fi,Li,zi,Ri,Bi,Hi,Gi,Vi,Ui,Wi,Qi,$i,Ki,Ji,Zi,Yi,Xi,tr,er,nr,ir,rr,or,sr,ar,lr,ur,cr,dr,hr,pr,fr,gr,mr,vr,yr,br,_r,xr,wr,Ar,kr,Tr,Sr,Mr,Er,Nr,Or,qr,Cr,Pr,jr,Dr,Ir,Fr,Lr,zr,Rr,Br,Hr,Gr,Vr,Ur,Wr,Qr,$r,Kr,Jr,Zr,Yr,Xr,to,eo,no,io,ro,oo,so,ao,lo,uo,co,ho,po,fo,go,mo,vo,yo,bo,_o,xo,wo,Ao,ko,To,So,Mo,Eo,No,Oo,qo,Co,Po,jo,Do,Io,Fo,Lo,zo,Ro,Bo,Ho,Go,Vo,Uo,Wo,Qo,$o,Ko,Jo,Zo,Yo,Xo,ts,es,ns,is,rs,os,ss,as,ls,us,cs,ds,hs,ps,fs,gs,ms,vs,ys,bs,_s,xs,ws,As,ks,Ts,Ss,Ms,Es,Ns,Os,qs,Cs,Ps,js,Ds,Is,Fs,Ls,zs,Rs,Bs,Hs,Gs,Vs,Us,Ws,Qs,$s,Ks,Js,Zs,Ys,Xs,ta,ea,na,ia,ra,oa,sa,aa,la,ua,ca,da,ha,pa,fa,ga,ma,va,ya,ba,_a,xa,wa,Aa,ka,Ta,Sa,Ma,Ea,Na,Oa,qa,Ca,Pa,ja,Da,Ia,Fa,La,za,Ra,Ba,Ha,Ga,Va,Ua,Wa,Qa,$a,Ka,Ja,Za,Ya,Xa,tl,el,nl,il,rl,ol,sl,al,ll,ul,cl,dl,hl,pl,fl,gl,ml,vl,yl,bl,_l,xl,wl,Al,kl,Tl,Sl,Ml,El,Nl,Ol,ql,Cl,Pl,jl,Dl,Il,Fl,Ll,zl,Rl,Bl,Hl,Gl,Vl,Ul,Wl,Ql,$l,Kl,Jl,Zl,Yl,Xl,tu,eu,nu,iu,ru,ou,su,au,lu,uu,cu,du,hu,pu,fu,gu,mu,vu,yu,bu,_u,xu,wu,Au,ku,Tu,Su,Mu,Eu,Nu,Ou,qu,Cu,Pu,ju,Du,Iu,Fu,Lu,zu,Ru,Bu,Hu,Gu,Vu,Uu,Wu,Qu,$u,Ku,Ju,Zu,Yu,Xu,tc,ec,nc,ic,rc,oc,sc,ac,lc,uc,cc,dc,hc,pc,fc,gc,mc,vc,yc,bc,_c,xc,wc,Ac,kc,Tc,Sc,Mc,Ec,Nc,Oc,qc,Cc,Pc,jc,Dc,Ic,Fc,Lc,zc,Rc,Bc,Hc,Gc,Vc,Uc,Wc,Qc,$c,Kc,Jc,Zc,Yc,Xc,td,ed,nd,id,rd,od,sd,ad,ld,ud,cd,dd,hd,pd,fd,gd,md,vd,yd,bd,_d,xd,wd,Ad,kd,Td,Sd,Md,Ed,Nd,Od,qd,Cd,Pd,jd,Dd,Id,Fd,Ld,zd,Rd,Bd,Hd,Gd,Vd,Ud,Wd,Qd,$d,Kd,Jd,Zd,Yd,Xd,th,eh,nh,ih,rh,oh,sh,ah,lh,uh,ch,dh,hh,ph,fh,gh,mh,vh,yh,bh,_h,xh,wh,Ah,kh,Th,Sh,Mh,Eh,Nh,Oh,qh,Ch,Ph,jh,Dh,Ih,Fh,Lh,zh,Rh,Bh,Hh,Gh,Vh,Uh,Wh,Qh,$h,Kh,Jh,Zh,Yh,Xh,tp,ep,np,ip,rp,op,sp,ap,lp,up,cp,dp,hp,pp,fp,gp,mp,vp,yp,bp,_p,xp,wp,Ap,kp,Tp,Sp,Mp,Ep,Np,Op,qp,Cp,Pp,jp,Dp,Ip,Fp,Lp,zp,Rp,Bp,Hp,Gp,Vp,Up,Wp,Qp,$p,Kp,Jp,Zp,Yp,Xp,tf,ef,nf,rf,of,sf,af,lf,uf,cf,df,hf,pf,ff,gf,mf,vf,yf,bf,_f,xf,wf,Af,kf,Tf,Sf,Mf,Ef,Nf,Of,qf,Cf,Pf,jf,Df,If,Ff,Lf,zf,Rf,Bf,Hf,Gf,Vf,Uf,Wf,Qf,$f,Kf,Jf,Zf,Yf,Xf,tg,eg,ng,ig,rg,og,sg,ag,lg,ug,cg,dg,hg,pg,fg,gg,mg,vg,yg,bg,_g,xg,wg=[].slice;for(mo=n(378),H=!1,tp=function(){function t(){}return t.prototype.a=null,t.prototype.b=null,t}(),Mr=function(){function t(){this.cons={},this.cons.car=null,this.cons.cdr=null,this.q=new tp}return t.prototype.cons=null,t.prototype.printname="",t.prototype.str="",t.prototype.tensor=null,t.prototype.q=null,t.prototype.d=0,t.prototype.k=0,t.prototype.tag=0,t.prototype.toString=function(){return ps(this)},t}(),ll="",Cs=0,i=Cs++,r=Cs++,o=Cs++,s=Cs++,a=Cs++,l=Cs++,u=Cs++,c=Cs++,d=Cs++,h=Cs++,p=Cs++,f=Cs++,v=Cs++,y=Cs++,b=Cs++,_=Cs++,E=Cs++,N=Cs++,O=Cs++,q=Cs++,C=Cs++,P=Cs++,j=Cs++,D=Cs++,I=Cs++,F=Cs++,L=Cs++,z=Cs++,R=Cs++,G=Cs++,V=Cs++,U=Cs++,W=Cs++,Q=Cs++,$=Cs++,J=Cs++,Z=Cs++,Y=Cs++,X=Cs++,tt=Cs++,et=Cs++,nt=Cs++,rt=Cs++,st=Cs++,at=Cs++,lt=Cs++,pt=Cs++,ft=Cs++,gt=Cs++,mt=Cs++,vt=Cs++,yt=Cs++,bt=Cs++,Fn=Cs++,Ln=Cs++,zn=Cs++,Rn=Cs++,Bn=Cs++,Hn=Cs++,Gn=Cs++,Un=Cs++,Wn=Cs++,Qn=Cs++,$n=Cs++,Kn=Cs++,Jn=Cs++,Zn=Cs++,Yn=Cs++,Xn=Cs++,ti=Cs++,ii=Cs++,ri=Cs++,oi=Cs++,ai=Cs++,li=Cs++,ui=Cs++,ci=Cs++,hi=Cs++,yi=Cs++,_i=Cs++,Ai=Cs++,ki=Cs++,Ei=Cs++,Ni=Cs++,Oi=Cs++,qi=Cs++,Ci=Cs++,ji=Cs++,Di=Cs++,Ii=Cs++,Fi=Cs++,Li=Cs++,zi=Cs++,Ri=Cs++,Bi=Cs++,Hi=Cs++,Gi=Cs++,Or=Cs++,Vi=Cs++,Wi=Cs++,Qi=Cs++,Ki=Cs++,Ji=Cs++,Zi=Cs++,$i=Cs++,Yi=Cs++,Xi=Cs++,tr=Cs++,er=Cs++,gr=Cs++,mr=Cs++,vr=Cs++,yr=Cs++,br=Cs++,_r=Cs++,xr=Cs++,wr=Cs++,Ar=Cs++,Tr=Cs++,Er=Cs++,qr=Cs++,wi=Cs++,g=Cs++,m=Cs++,si=Cs++,kr=Cs++,Sr=Cs++,Nr=Cs++,it=Cs++,gi=Cs++,mi=Cs++,vi=Cs++,Ui=Cs++,Pi=Cs++,nr=Cs++,ir=Cs++,rr=Cs++,or=Cs++,sr=Cs++,ar=Cs++,lr=Cs++,ur=Cs++,cr=Cs++,dr=Cs++,hr=Cs++,pr=Cs++,fr=Cs++,w=Cs++,A=Cs++,k=Cs++,T=Cs++,S=Cs++,M=Cs++,Cs++,ot=Nr,pi=24,_f=function(){function t(){this.dim=function(){var t,e,n;for(n=[],t=0,e=pi;0<=e?t<=e:t>=e;0<=e?t++:t--)n.push(0);return n}(),this.elem=[]}return t.prototype.ndim=0,t.prototype.dim=null,t.prototype.nelem=0,t.prototype.elem=null,t}(),function(){function t(){}return t.prototype.h=0,t.prototype.w=0,t.prototype.n=0,t.prototype.a=[],t}(),function(){function t(){}t.prototype.ascent=0,t.prototype.descent=0,t.prototype.width=0}(),Mf=0,yl=0,vh=function(){var t,e,n,i;for(i=[2],e=3;i.length<1e4;){for(n=0,t=Math.sqrt(e);n<i.length&&i[n]<=t;){if(e%i[n]==0){n=-1;break}n++}-1!==n&&i.push(e),e+=2}return i[1e4]=0,i}(),ul=0,Of=0,vf=[],Ao=[],uo=[],rf=[],Jl=0,Ud=null,Wd=null,Qd=null,$d=null,Kd=null,Jd=null,Zd=null,Yd=null,Xd=null,th=null,xg=null,Hd=null,wu=null,vf=[],gf=function(t){return vf[t]},Uu=function(t){return 0===t.k},kc=function(t){return 1===t.k},$u=function(t){return 2===t.k},pc=function(t){return kc(t)||$u(t)},Sc=function(t){return 3===t.k},Nc=function(t){if(null!=t)return 4===t.k},Mc=function(t){return 5===t.k},rc=function(t){return Mc(t)&&mf(t)<wi},zo=function(t){return Uu(t)?t.cons.car:gf(wi)},Ko=function(t){return Uu(t)?t.cons.cdr:gf(wi)},Eo=function(t){return zo(zo(t))},Lo=function(t){return zo(Ko(t))},Ho=function(t){return Ko(zo(t))},$o=function(t){return Ko(Ko(t))},Mo=function(t){return zo(zo(Ko(t)))},Fo=function(t){return zo(Ko(Ko(t)))},qo=function(t){return zo(Ko(zo(t)))},Bo=function(t){return Ko(zo(Ko(t)))},Vo=function(t){return Ko(Ko(zo(t)))},Qo=function(t){return Ko(Ko(Ko(t)))},So=function(t){return zo(zo(Ko(Ko(t))))},Oo=function(t){return zo(Ko(zo(Ko(t))))},jo=function(t){return zo(Ko(Ko(zo(t))))},Ro=function(t){return Ko(zo(Ko(Ko(t))))},Io=function(t){return zo(Ko(Ko(Ko(t))))},Wo=function(t){return Ko(Ko(Ko(Ko(t))))},Do=function(t){return zo(Ko(Ko(Ko(Ko(t)))))},No=function(t){return zo(Ko(zo(Ko(Ko(t)))))},Go=function(t){return Ko(Ko(zo(Ko(Ko(t)))))},Po=function(t){return zo(Ko(Ko(zo(Ko(t)))))},Uo=function(t){return Ko(Ko(Ko(zo(Ko(Ko(t))))))},Co=function(t){return zo(Ko(Ko(zo(Ko(Ko(t))))))},Bu=function(t){return zo(t)===gf(r)},ac=function(t){return zo(t)===gf(_i)},wc=function(t){return zo(t)===gf(Di)},Zu=function(t){return zo(t)===gf(Ln)},bi=function(t){return t.isPositive()?1:t.isZero()?0:-1},xi=function(t){return t.isZero()},fi=function(t,e){return t.equals(e)},(t=void 0!==e&&null!==e?e:this).isadd=Bu,t.ismultiply=ac,t.ispower=wc,t.isfactorial=Zu,t.car=zo,t.cdr=Ko,t.caar=Eo,t.cadr=Lo,t.cdar=Ho,t.cddr=$o,t.caadr=Mo,t.caddr=Fo,t.cadar=qo,t.cdadr=Bo,t.cddar=Vo,t.cdddr=Qo,t.caaddr=So,t.cadadr=Oo,t.caddar=jo,t.cdaddr=Ro,t.cadddr=Io,t.cddddr=Wo,t.caddddr=Do,t.cadaddr=No,t.cddaddr=Go,t.caddadr=Po,t.cdddaddr=Uo,t.caddaddr=Co,t.symbol=gf,t.iscons=Uu,t.isrational=kc,t.isdouble=$u,t.isnum=pc,t.isstr=Sc,t.istensor=Nc,t.issymbol=Mc,t.iskeyword=rc,t.CONS=0,t.NUM=1,t.DOUBLE=2,t.STR=3,t.TENSOR=4,t.SYM=5,wt=function(){return Fh(Lo(Wd)),_t(),Vr()},Vr=function(){var t;if(t=0,gp(),Wd=uh(),Nc(Wd))return Ur(),void lp();if(pc(Wd))return Fh(Wd),uc(Wd)&&wd(),void lp();if(Vu(Wd))return Fh(Wd),Fh(Wd),xs(),pd(),Hh(1,2),ph(),void lp();if(zo(Wd)===gf(Di)&&cc(Fo(Wd)))return Fh(Wd),rp(),Vr(),rp(),void lp();if(zo(Wd)===gf(_i)){for(t=Mf,Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),Vr(),Wd=Ko(Wd);return fd(Mf-t),void lp()}return(cc(Wd)||zo(Wd)===gf(r)&&cc(Lo(Wd)))&&(Fh(Wd),wd(),Wd=uh()),Gh(i),Fh(Wd),Rc(2),lp()},Ur=function(){return 1!==Wd.tensor.ndim&&uf("abs(tensor) with tensor rank > 1"),Fh(Wd),Fh(Wd),xs(),Mu(),Hh(1,2),ph(),Wp(),_t()},Kl=0,At=function(){var t;for(t=Mf,Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),_t(),Qd=uh(),Uh(Qd),Wd=Ko(Wd);return Zr(Mf-t)},of=0,Zr=function(t){var e,n,i,o,s,a,l,u,c;if(of++,o=0,i=Mf-t,H&&console.log("stack before adding terms #"+of),H)for(o=s=0,a=Mf;0<=a?s<a:s>a;o=0<=a?++s:--s)yh(rf[o]);for(o=e=0;e<10&&!(t<2)&&(Kl=0,(c=rf.slice(i,i+t)).sort(cs),rf=rf.slice(0,i).concat(c).concat(rf.slice(i+t)),0!==Kl);o=++e)t=gs(i,t);switch(Mf=i+t,t){case 0:Bh(0);break;case 1:break;default:Rc(t),Wd=uh(),Gh(r),Fh(Wd),ws()}if(H&&console.log("stack after adding terms #"+of),H){for(u=[],o=n=0,l=Mf;0<=l?n<l:n>l;o=0<=l?++n:--n)u.push(yh(rf[o]));return u}},cs=function(t,e){var n,i,r,o;if(n=0,pc(t)&&pc(e))return Kl=1,0;if(Nc(t)&&Nc(e)){if(t.tensor.ndim<e.tensor.ndim)return-1;if(t.tensor.ndim>e.tensor.ndim)return 1;for(n=i=0,r=t.tensor.ndim;0<=r?i<r:i>r;n=0<=r?++i:--i){if(t.tensor.dim[n]<e.tensor.dim[n])return-1;if(t.tensor.dim[n]>e.tensor.dim[n])return 1}return Kl=1,0}return zo(t)===gf(_i)&&(t=Ko(t),pc(zo(t))&&(t=Ko(t),Ko(t)===gf(wi)&&(t=zo(t)))),zo(e)===gf(_i)&&(e=Ko(e),pc(zo(e))&&(e=Ko(e),Ko(e)===gf(wi)&&(e=zo(e)))),0===(o=us(t,e))&&(Kl=1),o},gs=function(t,e){var n,i,r,o,s,a,l,u,c,d,h,p,f,g,m,v,y,b;for(s=0;s<e-1;)if(Xo(),$d=rf[t+s],Kd=rf[t+s+1],Nc($d)&&Nc(Kd)){if(Fh($d),Fh(Kd),xf(),(Wd=uh())!==gf(wi)){for(rf[t+s]=Wd,a=l=u=s+1,c=e-1;u<=c?l<c:l>c;a=u<=c?++l:--l)rf[t+a]=rf[t+a+1];e--,s--}s++}else if(Nc($d)||Nc(Kd))s++;else if(pc($d)&&pc(Kd)){if(Fh($d),Fh(Kd),Jr(),Wd=uh(),Oc(Wd)){for(a=n=d=s,h=e-2;d<=h?n<h:n>h;a=d<=h?++n:--n)rf[t+a]=rf[t+a+2];e-=2}else{for(rf[t+s]=Wd,a=i=p=s+1,f=e-1;p<=f?i<f:i>f;a=p<=f?++i:--i)rf[t+a]=rf[t+a+1];e--}s--,s++}else if(pc($d)||pc(Kd))s++;else if(Wd=Hd,Qd=Hd,b=0,zo($d)===gf(_i)&&($d=Ko($d),b=1,pc(zo($d))&&(Wd=zo($d),$d=Ko($d),Ko($d)===gf(wi)&&($d=zo($d),b=0))),zo(Kd)===gf(_i)&&(Kd=Ko(Kd),pc(zo(Kd))&&(Qd=zo(Kd),Kd=Ko(Kd),Ko(Kd)===gf(wi)&&(Kd=zo(Kd)))),rl($d,Kd))if(Fh(Wd),Fh(Qd),Jr(),Wd=uh(),Oc(Wd)){for(a=r=g=s,m=e-2;g<=m?r<m:r>m;a=g<=m?++r:--r)rf[t+a]=rf[t+a+2];e-=2,s--,s++}else{for(Fh(Wd),b?(Fh(gf(_i)),Fh($d),ws()):Fh($d),pd(),rf[t+s]=uh(),a=o=v=s+1,y=e-1;v<=y?o<y:o>y;a=v<=y?++o:--o)rf[t+a]=rf[t+a+1];e--,s--,s++}else s++;return e},Uh=function(t){var e;if(zo(t)===gf(r)){for(t=Ko(t),e=[];Uu(t);)Fh(zo(t)),e.push(t=Ko(t));return e}if(!Oc(t))return Fh(t)},$r=function(){var t;return gp(),Qd=uh(),Wd=uh(),t=Mf,Uh(Wd),Uh(Qd),Zr(Mf-t),lp()},Kr=function(t){var e,n,i,r,o;for(n=0,gp(),o=Mf-t,e=Mf,n=i=0,r=t;0<=r?i<r:i>r;n=0<=r?++i:--i)Uh(rf[o+n]);return Zr(Mf-e),Wd=uh(),Mf-=t,Fh(Wd),lp()},pf=function(){return wd(),$r()},kt=function(){return Fh(Lo(Wd)),_t(),Yr()},Yr=function(){var t,e,n,i,r,o,s;for(e=0,n=0,gp(),Wd=uh(),Nc(Wd)&&2===Wd.tensor.ndim&&Wd.tensor.dim[0]===Wd.tensor.dim[1]||uf("adj: square matrix expected"),i=Wd.tensor.dim[0],(Qd=Xr(i*i)).tensor.ndim=2,Qd.tensor.dim[0]=i,Qd.tensor.dim[1]=i,e=r=0,o=i;0<=o?r<o:r>o;e=0<=o?++r:--r)for(n=t=0,s=i;0<=s?t<s:t>s;n=0<=s?++t:--t)hs(Wd,i,e,n),Qd.tensor.elem[i*n+e]=uh();return Fh(Qd),lp()},St=function(){return Fh(Lo(Wd)),_t(),no()},no=function(){var t,e;if(t=0,gp(),Wd=uh(),zo(Wd)===gf(z))return Fh(Lo(Wd)),void lp();if($u(Wd))return e=0,t=Math.acos(Wd.d),e&&uf("arccos function argument is not in the interval [-1,1]"),Lh(t),void lp();if(gc(Wd))return Hh(1,4),Gh(Pi),pd(),void lp();if(sc(Wd))return Hh(3,4),Gh(Pi),pd(),void lp();if(!kc(Wd))return Gh(a),Fh(Wd),Rc(2),void lp();switch(Fh(Wd),Bh(2),pd(),hh()){case-2:Gh(Pi);break;case-1:Hh(2,3),Gh(Pi),pd();break;case 0:Hh(1,2),Gh(Pi),pd();break;case 1:Hh(1,3),Gh(Pi),pd();break;case 2:Fh(xg);break;default:Gh(a),Fh(Wd),Rc(2)}return lp()},Mt=function(){return Fh(Lo(Wd)),_t(),io()},io=function(){var t;return t=0,gp(),Wd=uh(),zo(Wd)===gf(R)?(Fh(Lo(Wd)),void lp()):$u(Wd)?((t=Wd.d)<1&&uf("arccosh function argument is less than 1.0"),t=Math.log(t+Math.sqrt(t*t-1)),Lh(t),void lp()):mc(Wd)?(Fh(xg),void lp()):(Gh(l),Fh(Wd),Rc(2),lp())},Et=function(){return Fh(Lo(Wd)),_t(),ro()},ro=function(){var t,e;if(t=0,gp(),Wd=uh(),zo(Wd)===gf(Ji))return Fh(Lo(Wd)),void lp();if($u(Wd))return e=0,t=Math.asin(Wd.d),e&&uf("arcsin function argument is not in the interval [-1,1]"),Lh(t),void lp();if(gc(Wd))return Hh(1,4),Gh(Pi),pd(),void lp();if(sc(Wd))return Hh(-1,4),Gh(Pi),pd(),void lp();if(!kc(Wd))return Gh(u),Fh(Wd),Rc(2),void lp();switch(Fh(Wd),Bh(2),pd(),hh()){case-2:Hh(-1,2),Gh(Pi),pd();break;case-1:Hh(-1,6),Gh(Pi),pd();break;case 0:Fh(xg);break;case 1:Hh(1,6),Gh(Pi),pd();break;case 2:Hh(1,2),Gh(Pi),pd();break;default:Gh(u),Fh(Wd),Rc(2)}return lp()},Nt=function(){return Fh(Lo(Wd)),_t(),oo()},oo=function(){var t;return t=0,gp(),Wd=uh(),zo(Wd)===gf(Zi)?(Fh(Lo(Wd)),void lp()):$u(Wd)?(t=Wd.d,t=Math.log(t+Math.sqrt(t*t+1)),Lh(t),void lp()):Oc(Wd)?(Fh(xg),void lp()):(Gh(c),Fh(Wd),Rc(2),lp())},Ot=function(){return Fh(Lo(Wd)),_t(),so()},so=function(){var t,e;return t=0,gp(),Wd=uh(),zo(Wd)===gf(gr)?(Fh(Lo(Wd)),void lp()):$u(Wd)?(e=0,t=Math.atan(Wd.d),e&&uf("arctan function error"),Lh(t),void lp()):Oc(Wd)?(Fh(xg),void lp()):lc(Wd)?(Fh(Wd),wd(),so(),wd(),void lp()):Vn(Wd,gf(Ji))&&Vn(Wd,gf(z))&&(Fh(Wd),zd(),Qd=uh(),Fh(Wd),oa(),$d=uh(),zo(Qd)===gf(Ji)&&zo($d)===gf(z)&&rl(Lo(Qd),Lo($d)))?(Fh(Lo(Qd)),void lp()):zo(Wd)===gf(Di)&&ol(Lo(Wd),3)&&sl(Fo(Wd),-1,2)?(Hh(1,6),Fh(gf(Pi)),pd(),void lp()):ol(Wd,1)?(Hh(1,4),Fh(gf(Pi)),pd(),void lp()):zo(Wd)===gf(Di)&&ol(Lo(Wd),3)&&sl(Fo(Wd),1,2)?(Hh(1,3),Fh(gf(Pi)),pd(),void lp()):(Gh(d),Fh(Wd),Rc(2),lp())},qt=function(){return Fh(Lo(Wd)),_t(),ao()},ao=function(){var t;return t=0,gp(),Wd=uh(),zo(Wd)===gf(mr)?(Fh(Lo(Wd)),void lp()):$u(Wd)?(((t=Wd.d)<-1||t>1)&&uf("arctanh function argument is not in the interval [-1,1]"),t=Math.log((1+t)/(1-t))/2,Lh(t),void lp()):Oc(Wd)?(Fh(xg),void lp()):(Gh(h),Fh(Wd),Rc(2),lp())},Ct=function(){return Fh(Lo(Wd)),_t(),lo()},lo=function(){return gp(),Wd=uh(),Fh(Wd),zd(),Uf(),Fh(Wd),oa(),Uf(),pf(),lp()},Uf=function(){if(gp(),Wd=uh(),uc(Wd))Fh(gf(Pi)),wd();else if(zo(Wd)===gf(Di)&&ol(Lo(Wd),-1))Fh(gf(Pi)),Fh(Fo(Wd)),pd();else if(zo(Wd)===gf(Di)&&Lo(Wd)===gf(ot))Fh(Fo(Wd)),xu();else if(zo(Wd)===gf(_i))for(Bh(0),Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),lo(),$r(),Wd=Ko(Wd);else zo(Wd)===gf(r)?(Fh(Wd),op(),Wd=uh(),Fh(Wd),ip(),Qd=uh(),Fh(Wd),xu(),$d=uh(),Oc(Qd)?(Fh(gf(Pi)),lc($d)&&wd()):(Fh($d),Fh(Qd),ga(),so(),lc(Qd)&&(Gh(Pi),lc($d)?pf():$r()))):Bh(0);return lp()},co=function(){var t,e,n,i,r,o;if(t=0,yl++,gp(),Wd=uh(),e=vc(Wd,gf(cr)),n=vc(Wd,gf(dr)),i=vc(Wd,gf(hr)),r=vc(Wd,gf(pr)),o=vc(Wd,gf(fr)),1===e&&0===n&&0===i&&0===r&&0===o)Qd=gf(cr),ho();else if(0===e&&1===n&&0===i&&0===r&&0===o)Qd=gf(dr),ho();else if(0===e&&0===n&&1===i&&0===r&&0===o)Qd=gf(hr),ho();else if(0===e&&0===n&&0===i&&1===r&&0===o)Qd=gf(pr),ho();else if(0===e&&0===n&&0===i&&0===r&&1===o)Qd=gf(fr),ho();else if(Uu(Wd)){for(t=Mf,Fh(zo(Wd)),Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),co(),Wd=Ko(Wd);Rc(Mf-t)}else Fh(Wd);return lp(),yl--},lh=function(){var t;if(t=0,gp(),Qd=uh(),Wd=uh(),vc(Wd,Qd))ho();else if(Uu(Wd)){for(t=Mf,Fh(zo(Wd)),Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),Fh(Qd),lh(),Wd=Ko(Wd);Rc(Mf-t)}else Fh(Wd);return lp()},ho=function(){var t,e,n,i,o,s;for(n=0,t=Mf,Fh(Wd),Fh(Qd),i=ds(),e=Mf,n=s=i-1;s>=0;n=s+=-1)Wd=rf[t+n],po(n);return(o=Mf-e)>1&&(Rc(o),Fh(gf(r)),ff(),ws()),Wd=uh(),Mf-=i,Fh(Wd)},po=function(t){var e,n;if(!Oc(Wd)){if(0!==t){if(e=Mf,zo(Wd)===gf(_i))for(Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),Wd=Ko(Wd);else ol(Wd,1)||Fh(Wd);return 1===t?Fh(Qd):(Fh(gf(Di)),Fh(Qd),Bh(t),Rc(3)),(n=Mf-e)>1?(Rc(n),Fh(gf(_i)),ff(),ws()):void 0}if(zo(Wd)===gf(r))for(Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),Wd=Ko(Wd);else Fh(Wd)}},Pt=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),fo()},fo=function(){return gp(),Wf(),lp()},Wf=function(){var t,e;if(t=0,Qd=uh(),Wd=uh(),Fh(Qd),e=hh(),$u(Wd)&&2147483648!==e)return t=jn(e,Wd.d),void Lh(t);if(Oc(Wd)&&Oc(Qd))Bh(1);else{if(!Oc(Wd)||2147483648===e)return 1===Qd.k&&fi(Qd.q.b,2)?fi(Qd.q.a,1)?(Bh(2),Gh(Pi),ga(),Fh(Wd),ga(),Hh(1,2),ph(),Fh(Wd),Yp(),void pd()):fi(Qd.q.a,-1)?(Bh(2),Gh(Pi),ga(),Fh(Wd),ga(),Hh(1,2),ph(),Fh(Wd),Ms(),void pd()):(Bh(bi(Qd.q.a)),$d=uh(),Bh(2),Fh(Wd),ga(),Fh(Qd),Fh($d),pf(),pd(),Fh(Wd),Fh(Qd),Fh($d),pf(),fo(),pd(),Fh(Wd),Fh(Qd),Bh(2),Fh($d),pd(),pf(),fo(),void pf()):cc(Wd)?(Fh(Wd),wd(),Fh(Qd),ph(),Fh(Wd),Fh(Qd),wd(),ph(),pd(),Gh(v),Fh(Wd),wd(),Fh(Qd),Rc(3),void pd()):cc(Qd)?(Bh(-1),Fh(Qd),ph(),Gh(v),Fh(Wd),Fh(Qd),wd(),Rc(3),void pd()):(Fh(gf(v)),Fh(Wd),Fh(Qd),Rc(3));Bh(0)}},jt=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),go()},go=function(){return gp(),Qf(),lp()},Qf=function(){var t,e;return t=0,Qd=uh(),Wd=uh(),Fh(Qd),e=hh(),$u(Wd)&&2147483648!==e?(t=yn(e,Wd.d),void Lh(t)):cc(Qd)?(Bh(-1),Fh(Qd),ph(),Gh(y),Fh(Wd),Fh(Qd),wd(),Rc(3),void pd()):(Gh(y),Fh(Wd),Fh(Qd),void Rc(3))},td=function(t){return mo(t)},Pp=function(t,e){if(t.isPositive()){if(e<0)return t.multiply(mo(-1))}else if(e>0)return t.multiply(mo(-1));return t},Qc=function(t,e){if(t.isPositive()){if(e.isNegative())return t.multiply(mo(-1))}else if(e.isPositive())return t.multiply(mo(-1));return t},Wc=function(t){return t.isNegative()?t.multiply(mo(-1)):t},Jr=function(){var t,e;if(t=1,e=1,!kc(rf[Mf-1])||!kc(rf[Mf-2]))return gp(),Qd=uh(),Wd=uh(),t=$u(Wd)?Wd.d:Ts(Wd),e=$u(Qd)?Qd.d:Ts(Qd),Lh(t+e),lp();Qh()},_d=function(){var t,e;if(t=0,e=0,!kc(rf[Mf-1])||!kc(rf[Mf-2]))return gp(),Qd=uh(),Wd=uh(),t=$u(Wd)?Wd.d:Ts(Wd),e=$u(Qd)?Qd.d:Ts(Qd),Lh(t*e),lp();Kh()},ma=function(){var t,e;if(t=0,e=0,!kc(rf[Mf-1])||!kc(rf[Mf-2]))return gp(),Qd=uh(),Wd=uh(),Oc(Qd)&&uf("divide by zero"),t=$u(Wd)?Wd.d:Ts(Wd),e=$u(Qd)?Qd.d:Ts(Qd),Lh(t/e),lp();$h()},Iu=function(){var t,e;return gp(),Wd=uh(),Oc(Wd)&&uf("divide by zero"),$u(Wd)?(Lh(1/Wd.d),void lp()):(t=mo(Wd.q.a),e=mo(Wd.q.b),e=Qc(e,t),t=Pp(t,1),(Wd=new Mr).k=1,Wd.q.a=e,Wd.q.b=t,Fh(Wd),lp())},vs=function(t,e){var n,i;return n=nd(t.q.a,e.q.b),i=nd(t.q.b,e.q.a),$c(n,i)},ms=function(t,e){var n,i;return n=0,i=0,kc(t)&&kc(e)?vs(t,e):(n=$u(t)?t.d:Ts(t))<(i=$u(e)?e.d:Ts(e))?-1:n>i?1:0},kd=function(){if(gp(),Wd=uh(),Oc(Wd))return Fh(Wd),void lp();switch(Wd.k){case 1:(Qd=new Mr).k=1,Qd.q.a=mo(Wd.q.a.multiply(mo.minusOne)),Qd.q.b=mo(Wd.q.b),Fh(Qd);break;case 2:Lh(-Wd.d);break;default:uf("bug caught in mp_negate_number")}return lp()},wo=function(){var t;return gp(),Wd=uh(),t=Kc(Wd.q.a,Wd.q.b),(Wd=new Mr).k=1,Wd.q.a=t,Wd.q.b=mo(1),Fh(Wd),lp()},ad=function(){return gp(),1!==(Wd=uh()).k?(Fh(Hd),void lp()):((Qd=new Mr).k=1,Qd.q.a=mo(Wd.q.a),Qd.q.b=mo(1),Fh(Qd),lp())},sd=function(){return gp(),1!==(Wd=uh()).k?(Fh(Hd),void lp()):((Qd=new Mr).k=1,Qd.q.a=mo(Wd.q.b),Qd.q.b=mo(1),Fh(Qd),lp())},bo=function(t){var e,n,i;return gp(),Wd=uh(),e=ld(Wd.q.a,Math.abs(t)),n=ld(Wd.q.b,Math.abs(t)),t<0&&(i=e,e=Qc(e=n,n=i),n=Pp(n,1)),(Wd=new Mr).k=1,Wd.q.a=e,Wd.q.b=n,Fh(Wd),lp()},Ts=function(t){var e;return t.q,(e=t.q.a.divmod(t.q.b)).quotient+e.remainder/t.q.b.toJSNumber()},Bh=function(t){return H&&console.log("pushing integer "+t),gp(),(Wd=new Mr).k=1,Wd.q.a=mo(t),Wd.q.b=mo(1),Fh(Wd),lp()},Lh=function(t){return gp(),(Wd=new Mr).k=2,Wd.d=t,Fh(Wd),lp()},Hh=function(t,e){var n;return(n=new Mr).k=1,n.q.a=mo(t),n.q.b=mo(e),Fh(n)},hh=function(){var t;switch(t=0,gp(),(Wd=uh()).k){case 1:t=nc(Wd)&&Wd.q.a.isSmall?Wd.q.a.toJSNumber():2147483648;break;case 2:t=Math.floor(Wd.q.a);break;default:t=2147483648}return lp(),t},xo=function(t){var e,n,i;return gp(),"+"!==(i=t[n=0])&&"-"!==i||n++,e=mo(t.substring(n)),(Wd=new Mr).k=1,Wd.q.a=e,Wd.q.b=mo(1),Fh(Wd),"-"===i&&wd(),lp()},_o=function(t){return Lh(parseFloat(t))},Mh=function(t,e){var n,i;switch(null==e&&(e=""),i="",t.k){case 1:"-"===(n=t.q.a.toString())[0]&&(n=n.substring(1)),e+=n,df+=n,Xu(t)&&(e+="/",df+="/",e+=i=t.q.b.toString(),df+=i);break;case 2:"-"===(n=""+xa(t.d))[0]&&(n=n.substring(1)),e+=n,df+=n}return e},ou=function(){return gp(),Qd=uh(),Wd=uh(),($d=new Mr).k=1,$d.q.a=Yc(Wd.q.a,Qd.q.a),$d.q.b=Yc(Wd.q.b,Qd.q.b),$d.q.a=Pp($d.q.a,1),Fh($d),lp()},ch=function(){var t;switch(t=0,gp(),(Wd=uh()).k){case 1:t=Ts(Wd);break;case 2:t=Wd.d;break;default:t=0}return lp(),t},yo=function(){var t;return t=Ts(uh()),Lh(t)},vo=function(t){return gp(),(Wd=new Mr).k=1,Wd.q.a=Dr(t),Wd.q.b=mo(1),Fh(Wd),lp()},Dr=function(t){var e,n,i,r,o;if(i=0,0===t||1===t)return mo(1);if(e=mo(2),n=mo(0),3<=t)for(i=r=3,o=t;3<=o?r<=o:r>=o;i=3<=o?++r:--r)n=mo(i),e=nd(e,n);return e},[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648],It=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),ko()},ko=function(){return gp(),Ff(),lp()},Ff=function(){if(Qd=uh(),Wd=uh(),0!==x())return Fh(Wd),Fl(),Fh(Qd),Fl(),ga(),Fh(Wd),Fh(Qd),pf(),Fl(),ga();Fh(xg)},x=function(){return pc(Wd)&&Lc(Wd,xg)?0:pc(Qd)&&Lc(Qd,xg)?0:pc(Wd)&&pc(Qd)&&Lc(Wd,Qd)?0:1},Ft=function(){return Fh(Lo(Wd)),_t(),Jo()},Jo=function(){return gp(),$f(),lp()},$f=function(){var t;return t=0,Wd=uh(),pc(Wd)?$u(Wd)?(t=Math.ceil(Wd.d),void Lh(t)):nc(Wd)?void Fh(Wd):(($d=new Mr).k=1,$d.q.a=Kc(Wd.q.a,Wd.q.b),$d.q.b=td(1),Fh($d),uc(Wd)?1:(Bh(1),$r())):(Gh(E),Fh(Wd),void Rc(2))},zt=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),es()},es=function(){return gp(),Qd=uh(),Wd=uh(),0===ns()?(Bh(0),void lp()):(Fh(Wd),Fl(),Fh(Qd),Fl(),ga(),Fh(Wd),Fh(Qd),pf(),Fl(),ga(),lp())},ns=function(){return pc(Wd)&&Lc(Wd,xg)?0:pc(Qd)&&Lc(Qd,xg)?0:pc(Wd)&&pc(Qd)&&Lc(Wd,Qd)?0:1},Rt=function(){return Fh(Lo(Wd)),_t(),is(),_t()},is=function(){var t,e,n,i;if(e=0,t=0,gp(),Wd=uh(),zo(Wd)===gf(z))return Fh(Lo(Wd)),bl(),void lp();if(zo(Wd)===gf(Ji))return Fh(Lo(Wd)),wl(),void lp();if(zo(Wd)===gf(gr))return Wd=Lo(Wd),Fh(wu),Fh(Wd),pd(),_l(),Qd=uh(),Fh(wu),Fh(Wd),pd(),wd(),_l(),$d=uh(),Fh($d),Fh(Qd),pf(),Fh(wu),pd(),Fh(Qd),Fh($d),$r(),ga(),void lp();if(zo(Wd)===gf(R))return Wd=Lo(Wd),Fh(Wd),_l(),Fh(Wd),wd(),_l(),$r(),Hh(1,2),pd(),void lp();if(zo(Wd)===gf(Zi))return Wd=Lo(Wd),Fh(Wd),_l(),Fh(Wd),wd(),_l(),pf(),Hh(1,2),pd(),void lp();if(zo(Wd)===gf(mr))return Wd=Lo(Wd),Fh(Wd),Bh(2),pd(),_l(),Wd=uh(),Fh(Wd),Bh(1),pf(),Fh(Wd),Bh(1),$r(),ga(),void lp();if(Uu(Wd)){for(t=Mf;Uu(Wd);)Fh(zo(Wd)),is(),Wd=Ko(Wd);return Rc(Mf-t),void lp()}if(4===Wd.k){for(Fh(Wd),Ss(),e=n=0,i=(Wd=uh()).tensor.nelem;0<=i?n<i:n>i;e=0<=i?++n:--n)Fh(Wd.tensor.elem[e]),is(),Wd.tensor.elem[e]=uh();return Fh(Wd),void lp()}return Fh(Wd),lp()},Bt=function(){return os(),rs(),na(),Fh(gf(wi))},Ht=function(){return Fh(Lo(Wd)),_t(),ss()},ss=function(){return gp(),Wd=uh(),Fh(Wd),Uc(),Bh(-1),Fh(Wd),lo(),Fh(gf(Pi)),ga(),ph(),pd(),lp()},Gt=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),Fh(Io(Wd)),_t(),$d=uh(),Qd=uh(),Wd=uh(),$d===gf(wi)&&($d=Qd,Qd=gf(hr)),Fh(Wd),Fh(Qd),Fh($d),ph(),ga(),Fh(Qd),Bl()},ds=function(){var t,e;for(gp(),Qd=uh(),Wd=uh(),t=Mf;;){if(Fh(Wd),Fh(Qd),Fh(xg),hf(),_t(),$d=uh(),Fh($d),Fh(Wd),Fh($d),pf(),Wd=uh(),rl(Wd,xg))return e=Mf-t,lp(),e;Fh(Wd),Fh(Qd),ga(),Wd=uh()}},Vt=function(){var t,e,n;return Fh(Lo(Wd)),_t(),Qd=uh(),Nc(Qd)&&2===Qd.tensor.ndim&&Qd.tensor.dim[0]===Qd.tensor.dim[1]||uf("cofactor: 1st arg: square matrix expected"),n=Qd.tensor.dim[0],Fh(Fo(Wd)),_t(),((t=hh())<1||t>n)&&uf("cofactor: 2nd arg: row index expected"),Fh(Io(Wd)),_t(),((e=hh())<1||e>n)&&uf("cofactor: 3rd arg: column index expected"),hs(Qd,n,t-1,e-1)},hs=function(t,e,n,i){var r,o,s,a,l,u;for(o=0,s=0,o=a=0,l=e;0<=l?a<l:a>l;o=0<=l?++a:--a)for(s=r=0,u=e;0<=u?r<u:r>u;s=0<=u?++r:--r)o!==n&&s!==i&&Fh(t.tensor.elem[e*o+s]);if(da(e-1),(n+i)%2)return wd()},Ut=function(){return Fh(Lo(Wd)),_t(),B()},B=function(){var t;return t=yl,gp(),Kf(),lp(),yl=t},Kf=function(){if(yl=0,Wd=uh(),zo(Wd)===gf(r)){for($d=Ko(Wd),Fh(zo($d)),$d=Ko($d);Uu($d);)Fh(zo($d)),tu(),$d=Ko($d);for(Du(),Qd=uh(),Fh(xg),$d=Ko(Wd);Uu($d);)Fh(Qd),Fh(zo($d)),pd(),$r(),$d=Ko($d);return ig(),Fh(Qd),ga()}Fh(Wd)},Wt=function(){return Fh(Lo(Wd)),_t(),Wd=uh(),Fh(Wd),Vn(Wd,wu)?xs():(sh(),xs(),ss())},xs=function(){return Fh(wu),Fh(wu),wd(),hf(),_t()},As=0,ws=function(){var t;return As++,H&&console.log("cons tos: "+Mf+" # "+As),(t=new Mr).k=0,t.cons.cdr=uh(),t===t.cons.cdr&&console.log("something wrong p == its cdr"),t.cons.car=uh(),Fh(t)},$t=function(){return Fh(Lo(Wd)),_t(),$o(Wd)===gf(wi)?(Bh(1),Bh(2)):(Fh(Fo(Wd)),_t(),Fh(Io(Wd)),_t()),ks()},ks=function(){return gp(),Jf(),lp()},Jf=function(){var t,e,n,i,r,o,s,a,l,u,c,d,h,p,f,g,m,v,y,b,_,x,w,A,k,T,S;if(c=0,d=0,h=0,p=0,f=0,g=0,y=0,a=[],l=[],$d=uh(),Qd=uh(),Wd=uh(),!Nc(Wd))return Oc(Wd)||uf("contract: tensor expected, 1st arg is not a tensor"),void Fh(xg);for(Fh(Qd),f=hh(),Fh($d),g=hh(),v=Wd.tensor.ndim,(f<1||f>v||g<1||g>v||f===g||Wd.tensor.dim[f-1]!==Wd.tensor.dim[g-1])&&uf("contract: index out of range"),f--,g--,m=Wd.tensor.dim[f],y=1,d=b=0,_=v;0<=_?b<_:b>_;d=0<=_?++b:--b)d!==f&&d!==g&&(y*=Wd.tensor.dim[d]);for((Qd=Xr(y)).tensor.ndim=v-2,h=0,d=e=0,x=v;0<=x?e<x:e>x;d=0<=x?++e:--e)d!==f&&d!==g&&(Qd.tensor.dim[h++]=Wd.tensor.dim[d]);for(t=Wd.tensor.elem,u=Qd.tensor.elem,d=n=0,w=v;0<=w?n<w:n>w;d=0<=w?++n:--n)a[d]=0,l[d]=Wd.tensor.dim[d];for(d=i=0,A=y;0<=A?i<A:i>A;d=0<=A?++i:--i){for(Fh(xg),h=r=0,k=m;0<=k?r<k:r>k;h=0<=k?++r:--r){for(a[f]=h,a[g]=h,c=0,p=o=0,T=v;0<=T?o<T:o>T;p=0<=T?++o:--o)c=c*l[p]+a[p];Fh(t[c]),$r()}for(u[d]=uh(),h=s=S=v-1;S<=0?s<=0:s>=0;h=S<=0?++s:--s)if(h!==f&&h!==g){if(++a[h]<l[h])break;a[h]=0}}return Fh(1===y?u[0]:Qd)},Kt=function(){return Fh(Lo(Wd)),_t(),Ms()},Ms=function(){return gp(),Wd=uh(),zo(Wd)===gf(r)?Ns():Es(),lp()},Ns=function(){for(Qd=Ko(Wd);Uu(Qd);){if(Kd=zo(Qd),hc(Kd))return Fh(Wd),Fh(Kd),pf(),$d=uh(),Fh($d),Ms(),Fh(Kd),Ms(),pd(),Fh($d),Yp(),Fh(Kd),Yp(),pd(),void pf();Qd=Ko(Qd)}return Es()},Es=function(){var t,e;if(zo(Wd)!==gf(a)){if($u(Wd))return t=Math.cos(Wd.d),Math.abs(t)<1e-10&&(t=0),void Lh(t);if(lc(Wd)&&(Fh(Wd),wd(),Wd=uh()),zo(Wd)===gf(d))return Bh(1),Fh(Lo(Wd)),Bh(2),ph(),$r(),Hh(-1,2),void ph();if(Fh(Wd),Bh(180),pd(),Gh(Pi),ga(),(e=hh())<0||2147483648===e)return Fh(gf(z)),Fh(Wd),void Rc(2);switch(e%360){case 90:case 270:return Bh(0);case 60:case 300:return Hh(1,2);case 120:case 240:return Hh(-1,2);case 45:case 315:return Hh(1,2),Bh(2),Hh(1,2),ph(),pd();case 135:case 225:return Hh(-1,2),Bh(2),Hh(1,2),ph(),pd();case 30:case 330:return Hh(1,2),Bh(3),Hh(1,2),ph(),pd();case 150:case 210:return Hh(-1,2),Bh(3),Hh(1,2),ph(),pd();case 0:return Bh(1);case 180:return Bh(-1);default:return Fh(gf(z)),Fh(Wd),Rc(2)}}else Fh(Lo(Wd))},Jt=function(){return Fh(Lo(Wd)),_t(),Lf()},Lf=function(){return gp(),Zf(),lp()},Zf=function(){var t;if(t=0,Wd=uh(),zo(Wd)!==gf(l)){if($u(Wd))return t=Math.cosh(Wd.d),Math.abs(t)<1e-10&&(t=0),void Lh(t);if(!Oc(Wd))return Gh(R),Fh(Wd),Rc(2);Fh(Hd)}else Fh(Lo(Wd))},Zt=function(){var t;return t=Mf,Fh(gf(wi)),Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),(Wd=uh())===gf(wi)?vu():Fh(Wd),Ys(),Rc(Mf-t)},Ys=function(){if(gp(),Qd=uh(),Wd=uh(),0===Vn(Wd,Qd))return Fh(Wd),void lp();if(Bu(Wd))return ta(),void lp();if(zo(Wd)===gf(_i))return Xs(),void lp();for($d=Ko(Wd);Uu($d);)Fh(zo($d)),Fh(Qd),Ys(),$d=Ko($d);return lp()},ta=function(){var t;for($d=Ko(Wd);Uu($d);)Vn(zo($d),Qd)&&(Fh(zo($d)),Fh(Qd),Ys()),$d=Ko($d);for(t=Mf,$d=Ko(Wd);Uu($d);)0===Vn(zo($d),Qd)&&Fh(zo($d)),$d=Ko($d);if(Mf-t)return Kr(Mf-t),$d=uh(),Fh($d),Fh($d),wd()},Xs=function(){var t;for($d=Ko(Wd);Uu($d);)Vn(zo($d),Qd)&&(Fh(zo($d)),Fh(Qd),Ys()),$d=Ko($d);for(t=Mf,$d=Ko(Wd);Uu($d);)0===Vn(zo($d),Qd)&&Fh(zo($d)),$d=Ko($d);if(Mf-t)return fd(Mf-t)},ea=function(){return $d=Mo(Wd),Kd=Bo(Wd),Jd=Fo(Wd),Mc($d)||uf("function name?"),zo(Jd)===gf(gt)&&(Fh(Lo(Jd)),_t(),Jd=uh()),Dp($d,Jd,Kd),Gh(wi)},Yt=function(){for(Fh(Lo(Wd)),_t(),Qd=uh(),Wd=$o(Wd);Uu(Wd);)Fh(zo(Wd)),Wd=Ko(Wd),_t(),$d=uh(),Fh(zo(Wd)),Wd=Ko(Wd),_t(),Kd=uh(),Fh(zo(Wd)),Wd=Ko(Wd),_t(),Jd=uh(),Fh(Qd),Fh($d),Ou(),Qd=uh(),Fh(Qd),Fh($d),Fh(Jd),hf(),_t(),Fh(Qd),Fh($d),Fh(Kd),hf(),_t(),pf(),Qd=uh();return Fh(Qd)},Xt=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),(Wd=uh())===gf(wi)?vu():Fh(Wd),ra()},ra=function(){return gp(),Qd=uh(),Wd=uh(),$d=xg,Yf(Wd),Fh($d),lp()},Yf=function(t){var e;if(rl(t,Qd)){if(Oc($d))return $d=Hd}else if(zo(t)===gf(Di)){if(rl(Lo(t),Qd)&&pc(Fo(t))&&Lc($d,Fo(t)))return $d=Fo(t)}else if(Uu(t)){for(t=Ko(t),e=[];Uu(t);)Yf(zo(t)),e.push(t=Ko(t));return e}},te=function(){return Fh(Lo(Wd)),_t(),oa()},oa=function(){var t;if(t=0,gp(),Wd=uh(),zo(Wd)===gf(r)&&(Fh(Wd),ep(),Wd=uh()),zo(Wd)===gf(_i)){for(t=Mf,Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),oa(),Wd=Ko(Wd);fd(Mf-t)}else kc(Wd)?(Fh(Wd),sd()):zo(Wd)===gf(Di)&&cc(Fo(Wd))?(Fh(Wd),rp()):Fh(Hd);return lp()},ee=function(){var t,e,n,i,r;for(Wd=Ko(Wd),Fh(zo(Wd)),_t(),Wd=Ko(Wd),Fh(zo(Wd)),_t(),(Qd=uh())===gf(wi)?(vu(),Fh(gf(wi))):pc(Qd)?(vu(),Fh(Qd)):(Fh(Qd),Wd=Ko(Wd),Fh(zo(Wd)),_t()),Jd=uh(),Kd=uh(),$d=uh();;){if(pc(Jd)?(Fh(Jd),2147483648===(e=hh())&&uf("nth derivative: check n")):e=1,Fh($d),e>=0)for(n=0,i=e;0<=i?n<i:n>i;0<=i?++n:--n)Fh(Kd),la();else for(t=0,r=e=-e;0<=r?t<r:t>r;0<=r?++t:--t)Fh(Kd),Ou();if($d=uh(),Jd===gf(wi))break;if(pc(Jd)){if(Wd=Ko(Wd),Fh(zo(Wd)),_t(),(Jd=uh())===gf(wi))break;pc(Jd)||(Kd=Jd,Wd=Ko(Wd),Fh(zo(Wd)),_t(),Jd=uh())}else Kd=Jd,Wd=Ko(Wd),Fh(zo(Wd)),_t(),Jd=uh()}return Fh($d)},la=function(){return gp(),Qd=uh(),Wd=uh(),pc(Qd)&&uf("undefined function"),Nc(Wd)?Nc(Qd)?Fs():Is():Nc(Qd)?Ds():Ps(),lp()},Ps=function(){return Mc(Qd)?js():(Fh(Wd),Fh(Qd),Fh(gf(Ui)),hf(),Fh(gf(Ui)),la(),Fh(gf(Ui)),Fh(Qd),hf())},js=function(){if(rl(Wd,Qd))Fh(Hd);else if(Uu(Wd))if(Bu(Wd))Ea();else if(zo(Wd)!==gf(_i))if(zo(Wd)!==gf(Di))if(zo(Wd)!==gf(Q))if(zo(Wd)!==gf(ci))if(zo(Wd)!==gf(Ji))if(zo(Wd)!==gf(z))if(zo(Wd)!==gf(gr))if(zo(Wd)!==gf(u))if(zo(Wd)!==gf(a))if(zo(Wd)!==gf(d))if(zo(Wd)!==gf(Zi))if(zo(Wd)!==gf(R))if(zo(Wd)!==gf(mr))if(zo(Wd)!==gf(c))if(zo(Wd)!==gf(l))if(zo(Wd)!==gf(h))if(zo(Wd)!==gf(i))if(zo(Wd)!==gf(Qi))if(zo(Wd)!==gf(Qn))if(zo(Wd)!==gf(pt))if(zo(Wd)!==gf(ft))if(zo(Wd)!==gf(v))if(zo(Wd)!==gf(y)){if(zo(Wd)!==gf(Yn)||Fo(Wd)!==Qd)return ha();ua()}else Oc(Fo(Wd))?Qs():$s();else Oc(Fo(Wd))?Us():Ws();else aa();else sa();else pa();else Ta();else Ls();else Vs();else Rs();else Hs();else Oa();else Js();else Ma();else Gs();else zs();else Bs();else Na();else Ks();else Sa();else _a();else Zs();else Aa();else ka();else Fh(xg)},Ea=function(){var t;for(t=Mf,Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),Fh(Qd),la(),Wd=Ko(Wd);return Kr(Mf-t)},ka=function(){var t,e,n,i,r,o,s;for(e=0,n=0,e=r=0,o=i=Fc(Wd)-1;0<=o?r<o:r>o;e=0<=o?++r:--r){for($d=Ko(Wd),n=t=0,s=i;0<=s?t<s:t>s;n=0<=s?++t:--t)Fh(zo($d)),e===n&&(Fh(Qd),la()),$d=Ko($d);fd(i)}return Kr(i)},Aa=function(){return Fh(Fo(Wd)),Fh(Lo(Wd)),ga(),Fh(Lo(Wd)),Fh(Qd),la(),pd(),Fh(Lo(Wd)),Bc(),Fh(Fo(Wd)),Fh(Qd),la(),pd(),$r(),Fh(Wd),pd()},_a=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),ga()},Zs=function(){return Fh(Lo(Wd)),Fh(Qd),la(),$d=uh(),zo($d)===gf(Q)?(Gh(Q),Gh(Q),Fh(Lo($d)),Lc(Fo($d),Fo(Wd))?(Fh(Fo($d)),Rc(3),Fh(Fo(Wd))):(Fh(Fo(Wd)),Rc(3),Fh(Fo($d))),Rc(3)):(Fh($d),Fh(Fo(Wd)),la())},ha=function(){return($d=Ko(Wd))===gf(wi)||Vn($d,Qd)?(Gh(Q),Fh(Wd),Fh(Qd),Rc(3)):Fh(xg)},Sa=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),Ms(),pd()},Ks=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),Yp(),pd(),wd()},Na=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),Ms(),Bh(-2),ph(),pd()},Bs=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Bh(1),Fh(Lo(Wd)),Bh(2),ph(),pf(),Hh(-1,2),ph(),pd()},zs=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Bh(1),Fh(Lo(Wd)),Bh(2),ph(),pf(),Hh(-1,2),ph(),pd(),wd()},Gs=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Bh(1),Fh(Lo(Wd)),Bh(2),ph(),$r(),Du(),pd(),Wp()},Ma=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),Lf(),pd()},Js=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),Vf(),pd()},Oa=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),Lf(),Bh(-2),ph(),pd()},Hs=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),Bh(2),ph(),Bh(1),$r(),Hh(-1,2),ph(),pd()},Rs=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),Bh(2),ph(),Bh(-1),$r(),Hh(-1,2),ph(),pd()},Vs=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Bh(1),Fh(Lo(Wd)),Bh(2),ph(),pf(),Du(),pd()},Ls=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),Rp(),pd()},Ta=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),fa(),pd(),Bh(2),pd()},pa=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Bh(2),Fh(Fo(Wd)),pd(),pd(),Fh(Lo(Wd)),Fh(Fo(Wd)),Bh(-1),$r(),bu(),pd()},sa=function(){return Fh(Lo(Wd)),Bh(2),ph(),Bh(-1),pd(),_l(),Gh(Pi),Hh(-1,2),ph(),pd(),Bh(2),pd(),Fh(Lo(Wd)),Fh(Qd),la(),pd()},aa=function(){return Fh(Lo(Wd)),Bh(2),ph(),Bh(-1),pd(),_l(),Gh(Pi),Hh(-1,2),ph(),pd(),Bh(-2),pd(),Fh(Lo(Wd)),Fh(Qd),la(),pd()},Us=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),Bh(1),fo(),pd(),Bh(-1),pd()},Ws=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),Fh(Fo(Wd)),Bh(-1),$r(),fo(),Fh(Fo(Wd)),Bh(-1),pd(),Fh(Lo(Wd)),ga(),Fh(Lo(Wd)),Fh(Fo(Wd)),fo(),pd(),$r(),pd()},Qs=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),Bh(1),fo(),pd(),Bh(-1),pd()},$s=function(){return Fh(Lo(Wd)),Fh(Qd),la(),Fh(Lo(Wd)),Fh(Fo(Wd)),Bh(-1),$r(),go(),Fh(Fo(Wd)),Bh(-1),pd(),Fh(Lo(Wd)),ga(),Fh(Lo(Wd)),Fh(Fo(Wd)),go(),pd(),$r(),pd()},ua=function(){return Fh(Lo(Wd))},K=function(){return Nc(Wd)?2!==Wd.tensor.ndim?0:Wd.tensor.dim[0]!==Wd.tensor.dim[1]?0:1:0},ca=function(){var t,e,n,i,r,o,s;if(n=0,gp(),Wd=uh(),0===K())return Gh($),Fh(Wd),Rc(2),void lp();for(i=Wd.tensor.nelem,t=Wd.tensor.elem,n=r=0,o=i;(0<=o?r<o:r>o)&&pc(t[n]);n=0<=o?++r:--r);if(n===i)Xf();else{for(n=e=0,s=Wd.tensor.nelem;0<=s?e<s:e>s;n=0<=s?++e:--e)Fh(Wd.tensor.elem[n]);da(Wd.tensor.dim[0])}return lp()},da=function(t){var e,n,i,r,o,s,a,l,u,c,d,h,p,f;for(o=0,s=0,a=0,u=0,h=0,p=0,f=0,e=[],r=Mf-t*t,o=l=0,c=t;0<=c?l<c:l>c;o=0<=c?++l:--l)e[o]=o,e[o+t]=0,e[o+t+t]=1;for(p=1,Fh(xg);;){for(Bh(1===p?1:-1),o=n=0,d=t;0<=d?n<d:n>d;o=0<=d?++n:--n)a=t*e[o]+o,Fh(rf[r+a]),pd();for($r(),s=t-1,h=0,i=!1;;)if((u=e[t+s]+e[t+t+s])<0)e[t+t+s]=-e[t+t+s],s--;else{if(u!==s+1)break;if(0===s){i=!0;break}h++,e[t+t+s]=-e[t+t+s],s--}if(i)break;f=e[s-e[t+s]+h],e[s-e[t+s]+h]=e[s-u+h],e[s-u+h]=f,e[t+s]=u,p=-p}return rf[r]=rf[Mf-1],Mf=r+1},Xf=function(){var t,e,n,i;for(t=0,t=n=0,i=(e=Wd.tensor.dim[0])*e;0<=i?n<i:n>i;t=0<=i?++n:--n)Fh(Wd.tensor.elem[t]);return Gc(e),Mf-=e*e,Fh(Wd)},di=function(t,e,n,i){return rf[t+e*n+i]},Cp=function(t,e,n,i,r){return rf[t+e*n+i]=r},Gc=function(t){var e,n,i,r,o,s,a,l,u,c,d,h,p,f,g,m,v,y;for(o=0,a=0,l=0,s=Mf-t*t,Wd=Hd,o=u=0,c=t-1;0<=c?u<c:u>c;o=0<=c?++u:--u){if(rl(di(s,t,o,o),xg)){for(a=e=d=o+1,h=t;(d<=h?e<h:e>h)&&rl(di(s,t,a,o),xg);a=d<=h?++e:--e);if(a===t){Wd=xg;break}for(l=n=p=o,f=t;p<=f?n<f:n>f;l=p<=f?++n:--n)Qd=di(s,t,o,l),Cp(s,t,o,l,di(s,t,a,l)),Cp(s,t,a,l,Qd);Fh(Wd),wd(),Wd=uh()}for(Fh(Wd),Fh(di(s,t,o,o)),pd(),Wd=uh(),a=i=g=o+1,m=t;g<=m?i<m:i>m;a=g<=m?++i:--i)for(Fh(di(s,t,a,o)),Fh(di(s,t,o,o)),ga(),wd(),Qd=uh(),Cp(s,t,a,o,xg),l=r=v=o+1,y=t;v<=y?r<y:r>y;l=v<=y?++r:--r)Fh(di(s,t,o,l)),Fh(Qd),pd(),Fh(di(s,t,a,l)),$r(),Cp(s,t,a,l,uh())}return Fh(Wd),Fh(di(s,t,t-1,t-1)),pd(),Wd=uh()},re=function(){return Fh(Lo(Wd)),_t(),fa()},fa=function(){return gp(),zf(),lp()},zf=function(){return Wd=uh(),$u(Wd)?0===Wd.d?void Bh(1):void Bh(0):kc(Wd)?xi(nd(Wd.q.a,Wd.q.b))?void Bh(1):void Bh(0):zo(Wd)===gf(Di)?(Gh(Z),Fh(Lo(Wd)),void Rc(2)):cc(Wd)?(Gh(Z),Fh(Wd),wd(),void Rc(2)):((cc(Wd)||zo(Wd)===gf(r)&&cc(Lo(Wd)))&&(Fh(Wd),wd(),Wd=uh()),Gh(Z),Fh(Wd),Rc(2))},va=function(){var t,e,n,i,r,o;for(e=0,gp(),t=Mf-1,ya(),n=Mf-t,(o=rf.slice(t,t+n)).sort(us),rf=rf.slice(0,t).concat(o).concat(rf.slice(t+n)),(Wd=Xr(n)).tensor.ndim=1,Wd.tensor.dim[0]=n,e=i=0,r=n;0<=r?i<r:i>r;e=0<=r?++i:--i)Wd.tensor.elem[e]=rf[t+e];return Mf=t,Fh(Wd),lp()},ya=function(){var t,e,n,i,o,s;if(e=0,gp(),Wd=uh(),t=Mf,pc(Wd))Fh(Wd),Dl();else if(zo(Wd)===gf(r))Fh(Wd),jr();else if(zo(Wd)===gf(_i))for(Wd=Ko(Wd),pc(zo(Wd))&&(Fh(zo(Wd)),Dl(),Wd=Ko(Wd));Uu(Wd);)Qd=zo(Wd),zo(Qd)===gf(Di)?(Fh(Lo(Qd)),Fh(Fo(Qd))):(Fh(Qd),Fh(Hd)),Wd=Ko(Wd);else zo(Wd)===gf(Di)?(Fh(Lo(Wd)),Fh(Fo(Wd))):(Fh(Wd),Fh(Hd));for(n=Mf,Fh(Hd),lu(t,n),e=o=0,s=i=Mf-n;0<=s?o<s:o>s;e=0<=s?++o:--o)rf[t+e]=rf[n+e];return Mf=t+i,lp()},lu=function(t,e){var n,i,r,o;if(i=0,gp(),Wd=uh(),t===e)return Fh(Wd),void lp();if(Qd=rf[t+0],$d=rf[t+1],Fh($d),2147483648!==(n=hh()))for(i=r=0,o=Math.abs(n);0<=o?r<=o:r>=o;i=0<=o?++r:--r)Fh(Wd),Fh(Qd),Bh(Hp(n)*i),ph(),pd(),lu(t+2,e);return lp()},jr=function(){for(gp(),Wd=uh(),$d=Ko(Wd),Fh(zo($d)),$d=Ko($d);Uu($d);)Fh(zo($d)),tu(),$d=Ko($d);if(Qd=uh(),mc(Qd))return Fh(Wd),Fh(Hd),void lp();if(pc(Qd))Fh(Qd),Dl();else if(zo(Qd)===gf(_i))for($d=Ko(Qd),pc(zo($d))?(Fh(zo($d)),Dl()):(Fh(zo($d)),Fh(Hd)),$d=Ko($d);Uu($d);)Fh(zo($d)),Fh(Hd),$d=Ko($d);else Fh(Qd),Fh(Hd);for(Fh(Qd),Du(),Qd=uh(),Fh(xg),$d=Ko(Wd);Uu($d);)Fh(Qd),Fh(zo($d)),pd(),$r(),$d=Ko($d);return Fh(Hd),lp()},wa=function(){var t,e,n,i,r,o;return t=0,e=0,r=0,i=ch(),0===(n=ch())&&i<0&&uf("divide by zero"),n>=0||i%1==0?(r=Math.pow(n,i),void Lh(r)):(r=Math.pow(Math.abs(n),i),o=Math.PI*i,i%.5==0?(t=0,e=Math.sin(o)):(t=Math.cos(o),e=Math.sin(o)),Lh(t*r),Lh(e*r),Fh(wu),pd(),$r())},ut=0,dt=[],ht=[],le=function(){return 0===ct()&&uf("eigen: argument is not a square matrix"),Ca(st),Wd=Df("D"),jp(Wd,Qd),Wd=Df("Q"),jp(Wd,$d),Fh(gf(wi))},ue=function(){return 0===ct()?(Gh(at),Fh(Wd),void Rc(2)):(Ca(at),Fh(Qd))},ce=function(){return 0===ct()?(Gh(lt),Fh(Wd),void Rc(2)):(Ca(lt),Fh($d))},ct=function(){var t,e,n,i,r,o,s,a,l,u,c;if(i=0,r=0,Fh(Lo(Wd)),_t(),og(),_t(),Wd=uh(),!Nc(Wd))return 0;for(2===Wd.tensor.ndim&&Wd.tensor.dim[0]===Wd.tensor.dim[1]||uf("eigen: argument is not a square matrix"),i=o=0,s=ut=Wd.tensor.dim[0];0<=s?o<s:o>s;i=0<=s?++o:--o)for(r=t=0,a=ut;0<=a?t<a:t>a;r=0<=a?++t:--t)$u(Wd.tensor.elem[ut*i+r])||uf("eigen: matrix is not numerical");for(i=e=0,l=ut-1;0<=l?e<l:e>l;i=0<=l?++e:--e)for(r=n=u=i+1,c=ut;u<=c?n<c:n>c;r=u<=c?++n:--n)Math.abs(Wd.tensor.elem[ut*i+r].d-Wd.tensor.elem[ut*r+i].d)>1e-10&&uf("eigen: matrix is not symmetrical");return 1},Ca=function(t){var e,n,i,r,o,s,a,l,u,c,d,h,p,f,g,m,v,y,b,_,x,w,A,k;for(c=0,d=0,c=h=0,p=ut*ut;0<=p?h<p:h>p;c=0<=p?++h:--h)dt[c]=0;for(c=e=0,f=ut*ut;0<=f?e<f:e>f;c=0<=f?++e:--e)ht[c]=0;for(c=n=0,m=ut;0<=m?n<m:n>m;c=0<=m?++n:--n)for(dt[ut*c+c]=Wd.tensor.elem[ut*c+c].d,d=i=v=c+1,y=ut;v<=y?i<y:i>y;d=v<=y?++i:--i)dt[ut*c+d]=Wd.tensor.elem[ut*c+d].d,dt[ut*d+c]=Wd.tensor.elem[ut*c+d].d;for(c=r=0,b=ut;0<=b?r<b:r>b;c=0<=b?++r:--r)for(ht[ut*c+c]=1,d=o=_=c+1,x=ut;_<=x?o<x:o>x;d=_<=x?++o:--o)ht[ut*c+d]=0,ht[ut*d+c]=0;for(c=s=0;s<100&&0!==af();c=++s);if(100===c&&printstr("\nnote: eigen did not converge\n"),t===st||t===at)for(Fh(Wd),Ss(),Qd=uh(),c=a=0,w=ut;0<=w?a<w:a>w;c=0<=w?++a:--a)for(d=l=0,A=ut;0<=A?l<A:l>A;d=0<=A?++l:--l)Lh(dt[ut*c+d]),Qd.tensor.elem[ut*c+d]=uh();if(t===st||t===lt){for(Fh(Wd),Ss(),$d=uh(),k=[],c=u=0,g=ut;0<=g?u<g:u>g;c=0<=g?++u:--u)k.push(function(){var t,e,n;for(n=[],d=t=0,e=ut;0<=e?t<e:t>e;d=0<=e?++t:--t)Lh(ht[ut*c+d]),n.push($d.tensor.elem[ut*c+d]=uh());return n}());return k}},af=function(){var t,e,n,i,r,o,s,a;for(n=0,i=0,e=0,n=r=0,o=ut-1;0<=o?r<o:r>o;n=0<=o?++r:--r)for(i=t=s=n+1,a=ut;s<=a?t<a:t>a;i=s<=a?++t:--t)0!==dt[ut*n+i]&&(lf(n,i),e++);return e},lf=function(t,e){var n,i,r,o,s,a,l,u,c,d,h,p,f;for(s=0,p=0,o=0,h=0,f=.5*(dt[ut*t+t]-dt[ut*e+e])/dt[ut*t+e],p=1/(Math.abs(f)+Math.sqrt(f*f+1)),f<0&&(p=-p),d=p*(r=1/Math.sqrt(p*p+1)),s=a=0,l=ut;0<=l?a<l:a>l;s=0<=l?++a:--a)o=dt[ut*t+s],h=dt[ut*e+s],dt[ut*t+s]=r*o+d*h,dt[ut*e+s]=r*h-d*o;for(s=n=0,u=ut;0<=u?n<u:n>u;s=0<=u?++n:--n)o=dt[ut*s+t],h=dt[ut*s+e],dt[ut*s+t]=r*o+d*h,dt[ut*s+e]=r*h-d*o;for(s=i=0,c=ut;0<=c?i<c:i>c;s=0<=c?++i:--i)o=ht[ut*t+s],h=ht[ut*e+s],ht[ut*t+s]=r*o+d*h,ht[ut*e+s]=r*h-d*o;return dt[ut*t+e]=0,dt[ut*e+t]=0},de=function(){return Fh(Lo(Wd)),_t(),Rf()},Rf=function(){return gp(),eg(),lp()},eg=function(){var t;return t=0,Wd=uh(),$u(Wd)?(t=1-al(Wd.d),void Lh(t)):cc(Wd)?(Gh(pt),Fh(Wd),wd(),Rc(2),void wd()):(Gh(pt),Fh(Wd),void Rc(2))},he=function(){return Fh(Lo(Wd)),_t(),Bf()},Bf=function(){return gp(),ng(),lp()},ng=function(){var t;if(t=0,Wd=uh(),$u(Wd))return t=al(Wd.d),void Lh(t);Gh(ft),Fh(Wd),Rc(2)},al=function(t){var e,n,i;return e=(n=1/(1+.5*(i=Math.abs(t))))*Math.exp(-i*i-1.26551223+n*(1.00002368+n*(.37409196+n*(.09678418+n*(n*(.27886807+n*(n*(1.48851587+n*(.17087277*n-.82215223))-1.13520398))-.18628806))))),t>=0?e:2-e},_t=function(){switch(Xo(),gp(),(Wd=uh()).k){case 0:Qt();break;case 1:case 2:case 3:Fh(Wd);break;case 4:kn();break;case 5:_n();break;default:uf("atom?")}return lp()},_n=function(){return rc(Wd)?(Fh(Wd),Fh(gf(si)),Rc(2),void _t()):(Qd=cu(Wd),Fh(Qd),Wd!==Qd?_t():void 0)},Qt=function(){switch(Mc(zo(Wd))||uf("cons?"),mf(zo(Wd))){case i:return wt();case r:return At();case o:return kt();case s:return Tt();case a:return St();case l:return Mt();case u:return Et();case c:return Nt();case d:return Ot();case h:return qt();case p:return Ct();case f:return Eval_atomize();case v:return Pt();case y:return jt();case b:return Dt();case _:return It();case E:return Ft();case N:return Lt();case O:return zt();case q:return Rt();case C:return Bt();case P:return Ht();case j:return Gt();case D:return Vt();case I:return Ut();case F:return Wt();case L:return $t();case z:return Kt();case R:return Jt();case G:return Zt();case U:return Xt();case V:return Yt();case W:return te();case Q:return ee();case $:return ne();case J:return ie();case Z:return re();case Y:return Eval_display();case X:return oe();case tt:return se();case et:return Oe();case nt:return Eval_draw();case rt:return ae();case st:return le();case at:return ue();case lt:return ce();case pt:return de();case ft:return he();case gt:return xt();case mt:return pe();case vt:return fe();case yt:return ge();case bt:return me();case Fn:return ve();case Ln:return ye();case zn:return be();case Rn:return _e();case Bn:return xe();case Hn:return we();case Gn:return Ae();case Un:return ke();case Wn:return Te();case Qn:return Se();case $n:return Me();case Kn:return Ee();case Jn:return Ne();case Zn:return Oe();case Yn:return qe();case Xn:return Ce();case ti:return Pe();case ii:return je();case ri:return De();case oi:return Ie();case ai:return Fe();case li:return Le();case ui:return ze();case ci:return Re();case hi:return Be();case yi:return He();case _i:return Ge();case Ai:return Ve();case ki:return Ue();case Ei:return We();case Ni:return Qe();case Oi:return $e();case qi:return Ke();case Ci:return Je();case ji:return Ze();case Di:return Ye();case Ii:return tn();case Fi:return Eval_display();case Li:return en();case zi:return nn();case Ri:return rn();case Bi:return on();case Hi:return sn();case Gi:return an();case Or:return ln();case Vi:return un();case Wi:return cn();case Qi:return dn();case Ki:return pn();case Ji:return fn();case Zi:return gn();case $i:return hn();case Yi:return mn();case Xi:return vn();case tr:return bn();case er:return Eval_sum();case gr:return xn();case mr:return wn();case vr:return An();case yr:return Tn();case br:return Sn();case _r:return Mn();case xr:return En();case wr:return Nn();case Ar:return On();case Tr:return qn();case Er:return Cn();case qr:return Dn();default:return Pn()}},Dt=function(){return Fh(cu(Lo(Wd)))},Lt=function(){return Fh(Lo(Wd)),Xe(),Wd=uh(),Oc(Wd)&&uf("check(arg): arg is zero"),Fh(gf(wi))},ne=function(){return Fh(Lo(Wd)),_t(),ca()},ie=function(){var t;return Fh(Lo(Wd)),_t(),Qd=uh(),Uu($o(Wd))?(Fh(Fo(Wd)),_t(),t=hh()):t=1,Nc(Qd)?t<1||t>Qd.tensor.ndim?Fh(Wd):Bh(Qd.tensor.dim[t-1]):Bh(1)},oe=function(){return Fh(Lo(Wd)),_t(),va()},se=function(){var t;for(Fh(zo(Wd)),Wd=Ko(Wd),t=[];Uu(Wd);)uh(),Fh(zo(Wd)),_t(),t.push(Wd=Ko(Wd));return t},ae=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),Fh(Io(Wd)),_t(),dsolve()},xt=function(){for(Fh(Lo(Wd)),_t(),Wd=$o(Wd);Uu(Wd);)Fh(zo(Wd)),_t(),Fh(Lo(Wd)),_t(),hf(),Wd=$o(Wd);return _t()},pe=function(){return Fh(Lo(Wd)),_t(),_l()},ye=function(){return Fh(Lo(Wd)),_t(),Fl()},be=function(){var t;for(Wd=Ko(Wd),Fh(zo(Wd)),_t(),Wd=Ko(Wd),Fh(zo(Wd)),_t(),Ll(),Wd=Ko(Wd),t=[];Uu(Wd);)Fh(zo(Wd)),_t(),Ll(),t.push(Wd=Ko(Wd));return t},Se=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),bu()},Me=function(){return Fh(Lo(Wd)),_t(),_u()},Ne=function(){var t;for(t=Mf,Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),_t(),Wd=Ko(Wd);return Au(Mf-t)},Ce=function(){return Fh(Lo(Wd)),_t(),ju()},Pe=function(){return Fh(Lo(Wd)),_t(),Fu()},je=function(){if(Fh(Lo(Wd)),_t(),Wd=uh(),kc(Wd))nc(Wd)?Fh(Hd):Fh(xg);else{if(!$u(Wd))return Gh(ii),Fh(Wd),Rc(2);Math.floor(Wd.d)===Wd.d?Fh(Hd):Fh(xg)}},Ge=function(){var t;for(Fh(Lo(Wd)),_t(),Wd=$o(Wd),t=[];Uu(Wd);)Fh(zo(Wd)),_t(),pd(),t.push(Wd=Ko(Wd));return t},We=function(){return Fh(Lo(Wd)),_t(),1===(Wd=uh()).k||2===Wd.k?Bh(1):Bh(0)},$e=function(){var t;for(t=Mf,Gh(Oi),Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),_t(),Wd=Ko(Wd);return Rc(Mf-t)},nn=function(){return Fh(Lo(Wd))},on=function(){return Fh(Lo(Wd)),_t(),Wd=uh(),Nc(Wd)?Bh(Wd.tensor.ndim):Fh(xg)},Fp=function(){var t;for(Kd=Oo(Wd),Mc(Kd)||uf("indexed assignment: error in symbol"),t=Mf,Fh(Fo(Wd)),_t(),Qd=Bo(Wd);Uu(Qd);)Fh(zo(Qd)),_t(),Qd=Ko(Qd);return Ip(Mf-t),$d=uh(),jp(Kd,$d),Fh(gf(wi))},cn=function(){if(Mo(Wd)!==gf(Jn)){if(!Uu(Lo(Wd)))return Mc(Lo(Wd))||uf("symbol assignment: error in symbol"),Fh(Fo(Wd)),_t(),Qd=uh(),jp(Lo(Wd),Qd),Fh(gf(wi));ea()}else Fp()},mn=function(){return Fh(Lo(Wd)),_t(),Hh(1,2),ph()},vn=function(){return uf("user stop")},bn=function(){return Fh(Io(Wd)),_t(),Fh(Fo(Wd)),_t(),Fh(Lo(Wd)),_t(),hf(),_t()},Cn=function(){var t,e,n,i;if(t=0,Fh(Lo(Wd)),_t(),!((e=hh())<2)){for((Wd=Xr(e*e)).tensor.ndim=2,Wd.tensor.dim[0]=e,Wd.tensor.dim[1]=e,t=n=0,i=e;0<=i?n<i:n>i;t=0<=i?++n:--n)Wd.tensor.elem[e*t+t]=Hd;return Wd.tensor.nelem!==Wd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Fh(Wd)}Fh(Wd)},Xe=function(){return gp(),Wd=uh(),zo(Wd)===gf(Wi)?Sn():(Fh(Wd),_t()),lp()},fe=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),(Qd=uh())===gf(wi)?vu():Fh(Qd),dl()},dl=function(){if(gp(),th=uh(),Jd=uh(),Nc(Jd))return vl(),void lp();if(zo(Jd)!==gf(r))return Fh(Jd),zd(),$d=uh(),Fh(Jd),oa(),Qd=uh(),sp(),Fh($d),Fh(Qd),Fh(th),!isone($d)&&!isone(Qd)||vc(Qd,th)&&!isone(Qd)?(ba(),Yd=uh(),Fh($d),Fh(Qd),Fh(Yd),pd(),pf(),$d=uh(),Oc($d)?(Fh(Yd),void lp()):(Fh(Qd),Fh(th),Ll(),Qd=uh(),gl(),fl(),hl(),Nc(Kd)?(Fh(Kd),ju(),Fh($d),Mu(),Fh(Qd),Mu()):(Fh($d),Fh(Kd),ga(),Fh(Qd),pd()),Fh(Yd),$r(),lp())):(uh(),uh(),uh(),Fh(Jd),void lp());for(Bh(0),Wd=Ko(Jd);Uu(Wd);)Fh(zo(Wd)),Fh(th),dl(),$r(),Wd=Ko(Wd);lp()},vl=function(){var t,e,n;for(t=0,Fh(Jd),Ss(),t=e=0,n=(Jd=uh()).tensor.nelem;0<=n?e<n:e>n;t=0<=n?++e:--e)Fh(Jd.tensor.elem[t]),Fh(th),dl(),Jd.tensor.elem[t]=uh();return Fh(Jd)},sp=function(){var t,e,n,i,r,o;for(e=0,n=0,i=0,t=Mf,zl(Qd),zl($d),n=0,e=r=0,o=Mf-t;0<=o?r<o:r>o;e=0<=o?++r:--r)Wd=rf[t+e],zo(Wd)===gf(Di)&&Lo(Wd)===th&&(Fh(Fo(Wd)),2147483648!==(i=hh())&&i<n&&(n=i));if(Mf=t,0!==n)return Fh(Qd),Fh(th),Bh(-n),ph(),pd(),Qd=uh(),Fh($d),Fh(th),Bh(-n),ph(),pd(),$d=uh()},gl=function(){var t,e,n,i,r,o,s,a,l;if(i=0,r=0,n=Mf,zo(Qd)===gf(_i))for(Wd=Ko(Qd);Uu(Wd);)Jd=zo(Wd),ml(),Wd=Ko(Wd);else Jd=Qd,ml();if(1!=(o=Mf-n)){for((Kd=Xr(o*o)).tensor.ndim=2,Kd.tensor.dim[0]=o,Kd.tensor.dim[1]=o,t=n,i=s=0,a=o;0<=a?s<a:s>a;i=0<=a?++s:--s)for(r=e=0,l=o;0<=l?e<l:e>l;r=0<=l?++e:--e)Fh(rf[t+r]),Fh(th),Bh(i),ph(),ga(),Fh(th),Bl(),Kd.tensor.elem[o*i+r]=uh();return Mf-=o}Kd=uh()},ml=function(){var t,e,n,i,r,o,s;if(e=0,n=0,i=0,Vn(Jd,th)){for(qf(),zo(Jd)===gf(Di)?(Fh(Fo(Jd)),i=hh(),Zd=Lo(Jd)):(i=1,Zd=Jd),Fh(Zd),Fh(th),ra(),t=hh(),s=[],e=r=0,o=i;0<=o?r<o:r>o;e=0<=o?++r:--r)s.push(function(){var i,r,o;for(o=[],n=i=0,r=t;0<=r?i<r:i>r;n=0<=r?++i:--i)Fh(Xd),Fh(Zd),Bh(e),ph(),pd(),Fh(th),Bh(n),ph(),o.push(pd());return o}());return s}},qf=function(){var t;if(t=0,zo(Qd)===gf(_i)){for(t=Mf,Ud=Ko(Qd);Uu(Ud);)rl(zo(Ud),Jd)||(Fh(zo(Ud)),_t()),Ud=Ko(Ud);fd(Mf-t)}else Bh(1);return Xd=uh()},fl=function(){var t,e,n,i;if(t=0,Nc(Kd)){for(e=Kd.tensor.dim[0],(Xd=Xr(e)).tensor.ndim=1,Xd.tensor.dim[0]=e,t=n=0,i=e;0<=i?n<i:n>i;t=0<=i?++n:--n)Fh($d),Fh(th),Bh(t),ph(),ga(),Fh(th),Bl(),Xd.tensor.elem[t]=uh();return $d=Xd}},hl=function(){var t,e,n,i,r;if(e=0,!Nc(Kd))return Fh(Qd),rp(),void(Qd=uh());if(t=Mf,zo(Qd)===gf(_i))for(Xd=Ko(Qd);Uu(Xd);)Jd=zo(Xd),pl(),Xd=Ko(Xd);else Jd=Qd,pl();for((Xd=Xr(n=Mf-t)).tensor.ndim=1,Xd.tensor.dim[0]=n,e=i=0,r=n;0<=r?i<r:i>r;e=0<=r?++i:--i)Xd.tensor.elem[e]=rf[t+e];return Mf=t,Qd=Xd},pl=function(){var t,e,n,i,r,o,s;if(e=0,n=0,i=1,Vn(Jd,th)){for(zo(Jd)===gf(Di)&&(Fh(Fo(Jd)),i=hh(),Jd=Lo(Jd)),Fh(Jd),Fh(th),ra(),t=hh(),s=[],e=r=o=i;o<=0?r<0:r>0;e=o<=0?++r:--r)s.push(function(){var i,r,o;for(o=[],n=i=0,r=t;0<=r?i<r:i>r;n=0<=r?++i:--i)Fh(Jd),Bh(e),ph(),rp(),Fh(th),Bh(n),ph(),o.push(pd());return o}());return s}},ge=function(){return Fh(Lo(Wd)),_t(),bl()},bl=function(){return gp(),Wd=uh(),Fh(wu),Fh(Wd),pd(),_l(),Hh(1,2),pd(),Fh(wu),wd(),Fh(Wd),pd(),_l(),Hh(1,2),pd(),$r(),lp()},me=function(){return Fh(Lo(Wd)),_t(),wl()},wl=function(){return gp(),Wd=uh(),Fh(wu),Fh(Wd),pd(),_l(),Fh(wu),ga(),Hh(1,2),pd(),Fh(wu),wd(),Fh(Wd),pd(),_l(),Fh(wu),ga(),Hh(1,2),pd(),pf(),lp()},ve=function(){var t;for(Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),(Qd=uh())===gf(wi)?vu():Fh(Qd),Ol(),Wd=Qo(Wd),t=[];Uu(Wd);)Fh(zo(Wd)),_t(),Cl(),t.push(Wd=Ko(Wd));return t},Cl=function(){var t,e;if(gp(),Qd=uh(),Wd=uh(),t=Mf,zo(Wd)===gf(_i))for(Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),Fh(Qd),Il(),Wd=Ko(Wd);else Fh(Wd),Fh(Qd),Il();return(e=Mf-t)>1&&gd(e),lp()},Il=function(){if(gp(),Ll(),Wd=uh(),zo(Wd)===gf(_i))for(Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),Wd=Ko(Wd);else Fh(Wd);return lp()},Ol=function(){return gp(),Qd=uh(),Wd=uh(),nc(Wd)?(Fh(Wd),jl()):(Fh(Wd),Fh(Qd),Ll()),lp()},Dl=function(){var t,e,n,i,r;for(n=0,gp(),2147483648===(i=hh())&&uf("number too big to factor"),i<0&&(i=-i),n=r=0;r<1e4&&!((t=vh[n])>i/t);n=++r){for(e=0;i%t==0;)i/=t,e++;e&&(Bh(t),Bh(e))}return i>1&&(Bh(i),Bh(1)),lp()},Fl=function(){var t;return gp(),Wd=uh(),Fh(Wd),(t=hh())<0||2147483648===t?(Gh(Ln),Fh(Wd),Rc(2),void lp()):(vo(t),lp())},Zp=function(){var t;if(gp(),t=yl,yl=0,Wd=uh(),zo(Wd)===gf(r)){for(Fh(xg),Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),Zp(),$r(),Wd=Ko(Wd);return yl=t,void lp()}return zo(Wd)===gf(_i)?(Lp(),yl=t,void lp()):(Fh(Wd),yl=t,lp())},Lp=function(){var t,e,n,i,r,o,s,a,l,u,c;for(n=0,i=0,r=0,c=Mf,Wd=Ko(Wd),r=0;Uu(Wd);)Fh(zo(Wd)),Wd=Ko(Wd),r++;for(n=o=0,s=r-1;0<=s?o<s:o>s;n=0<=s?++o:--o)if(rf[c+n]!==gf(wi))for(i=t=a=n+1,l=r;a<=l?t<l:t>l;i=a<=l?++t:--t)rf[c+i]!==gf(wi)&&zp(c,n,i);for(Fh(Hd),n=e=0,u=r;0<=u?e<u:e>u;n=0<=u?++e:--e)rf[c+n]!==gf(wi)&&(Fh(rf[c+n]),pd());return Wd=uh(),Mf-=r,Fh(Wd)},zp=function(t,e,n){var i,r,o,s;if(i=0,r=0,Wd=rf[t+e],Qd=rf[t+n],wc(Wd)?($d=Fo(Wd),Wd=Lo(Wd)):$d=Hd,wc(Qd)?(Kd=Fo(Qd),Qd=Lo(Qd)):Kd=Hd,Zu(Wd)&&Zu(Qd)){if(Fh($d),Fh(Kd),$r(),ig(),0!==(r=hh()))return;if(Fh(Lo(Wd)),Fh(Lo(Qd)),pf(),ig(),0===(r=hh())||2147483648===r)return;for(r<0&&(r=-r,Jd=Wd,Wd=Qd,Qd=Jd,Jd=$d,$d=Kd,Kd=Jd),Fh(Hd),i=o=1,s=r;1<=s?o<=s:o>=s;i=1<=s?++o:--o)Fh(Lo(Qd)),Bh(i),$r(),Fh($d),ph(),pd();return rf[t+e]=uh(),rf[t+n]=gf(wi)}},ah=0,Rl=0,Ll=function(){return gp(),Qd=uh(),Wd=uh(),Vn(Wd,Qd)&&vc(Wd,Qd)&&Mc(Qd)?(Fh(Wd),Fh(Qd),rg(),lp()):(Fh(Wd),void lp())},rg=function(){var t,e,n,i;for(e=0,gp(),Qd=uh(),Wd=uh(),t=Mf,Yu(Wd)&&uf("floating point numbers in polynomial"),ah=Mf,Fh(Wd),Fh(Qd),Rl=ds()-1,np(t);Rl>0;){if(Oc(rf[ah+0]))Bh(1),Kd=uh(),Bh(0),Jd=uh();else if(0===du())break;for(Fh(Kd),Fh(Qd),pd(),Fh(Jd),$r(),Xd=uh(),Fh(Yd),Fh(Xd),bd(),Yd=uh(),tg();Rl&&Oc(rf[ah+Rl]);)Rl--}for(Fh(xg),e=n=0,i=Rl;0<=i?n<=i:n>=i;e=0<=i?++n:--n)Fh(rf[ah+e]),Fh(Qd),Bh(e),ph(),pd(),$r();return Wd=uh(),Rl>0&&cc(rf[ah+Rl])&&(Fh(Wd),wd(),Wd=uh(),Fh(Yd),Ad(),Yd=uh()),Fh(Yd),Fh(Wd),bd(),Yd=uh(),rf[t]=Yd,Mf=t+1,lp()},np=function(t){var e,n,i,r,o,s,a;for(n=0,Yd=Hd,n=i=r=t,o=Mf;r<=o?i<o:i>o;n=r<=o?++i:--i)Fh(rf[n]),oa(),Fh(Yd),jc(),Yd=uh();for(n=e=s=t,a=Mf;s<=a?e<a:e>a;n=s<=a?++e:--e)Fh(Yd),Fh(rf[n]),pd(),rf[n]=uh();if(Fh(Yd),rp(),Yd=uh(),H)return console.log("rationalize_coefficients result")},du=function(){var t,e,n,i,r,o,s,a,l,u,c;for(r=Mf,i=Mf,Fh(rf[ah+Rl]),ya(),s=Mf-i,t=Mf,Fh(rf[ah+0]),ya(),o=Mf-t,u=e=0,a=s;0<=a?e<a:e>a;u=0<=a?++e:--e)for(c=n=0,l=o;0<=l?n<l:n>l;c=0<=l?++n:--n){if(Kd=rf[i+u],Jd=rf[t+c],Fh(Jd),Fh(Kd),ga(),wd(),$d=uh(),In(),Oc(Zd))return Mf=r,H&&console.log("get_factor returning 1"),1;if(Fh(Jd),wd(),Jd=uh(),Fh($d),wd(),$d=uh(),In(),Oc(Zd))return Mf=r,H&&console.log("get_factor returning 1"),1}return Mf=r,H&&console.log("get_factor returning 0"),0},tg=function(){var t,e,n;for(t=0,Zd=xg,t=e=n=Rl;n<=0?e<0:e>0;t=n<=0?++e:--e)Fh(rf[ah+t]),rf[ah+t]=Zd,Fh(Kd),ga(),Zd=uh(),Fh(rf[ah+t-1]),Fh(Zd),Fh(Jd),pd(),pf(),rf[ah+t-1]=uh();if(rf[ah+0]=Zd,H)return console.log("yydivpoly Q:")},In=function(){var t,e,n;for(t=0,Fh(xg),t=e=n=Rl;n<=0?e<=0:e>=0;t=n<=0?++e:--e)Fh($d),pd(),Fh(rf[ah+t]),H&&(console.log("Evalpoly top of stack:"),yh(rf[Mf-t])),$r();return Zd=uh()},zl=function(t){var e;if(e=Mf,zo(t)===gf(r))for(t=Ko(t);Uu(t);)Vh(zo(t)),t=Ko(t);else Vh(t);return Mf-e},Vh=function(t){var e;if(zo(t)===gf(_i)){for(t=Ko(t),e=[];Uu(t);)Fh(zo(t)),e.push(t=Ko(t));return e}return Fh(t)},_e=function(){var t;for(Wd=Ko(Wd),Fh(zo(Wd)),_t(),Wd=Ko(Wd),t=[];Uu(Wd);)Fh(zo(Wd)),_t(),Bl(),t.push(Wd=Ko(Wd));return t},Bl=function(){return gp(),Qd=uh(),Wd=uh(),Hl(),lp()},Hl=function(){return zo(Wd)===gf(r)?Gl():Nc(Wd)?Vl():Vn(Wd,Qd)?Bh(0):Fh(Wd)},Gl=function(){var t;for(Bh(0),Wd=Ko(Wd),t=[];Uu(Wd);)Fh(zo(Wd)),Fh(Qd),Bl(),$r(),t.push(Wd=Ko(Wd));return t},Vl=function(){var t,e,n,i,r,o;for(e=0,n=Wd.tensor.nelem,($d=Xr(n)).tensor.ndim=Wd.tensor.ndim,e=i=0,r=Wd.tensor.ndim;0<=r?i<r:i>r;e=0<=r?++i:--i)$d.tensor.dim[e]=Wd.tensor.dim[e];for(e=t=0,o=n;0<=o?t<o:t>o;e=0<=o?++t:--t)Fh(Wd.tensor.elem[e]),Fh(Qd),Bl(),$d.tensor.elem[e]=uh();return Fh($d)},xe=function(){return Fh(Lo(Wd)),_t(),og(),_t()},og=function(){var t,e,n,i;if(e=0,t=0,gp(),Wd=uh(),Uu(Wd)){for(t=Mf;Uu(Wd);)Fh(zo(Wd)),og(),Wd=Ko(Wd);Rc(Mf-t)}else if(4===Wd.k){for(Fh(Wd),Ss(),e=n=0,i=(Wd=uh()).tensor.nelem;0<=i?n<i:n>i;e=0<=i?++n:--n)Fh(Wd.tensor.elem[e]),og(),Wd.tensor.elem[e]=uh();Fh(Wd)}else 1===Wd.k?(Fh(Wd),yo()):Wd===gf(Pi)?Lh(Math.PI):Wd===gf(ot)?Lh(Math.E):Fh(Wd);return lp()},we=function(){return Fh(Lo(Wd)),_t(),Hf()},Hf=function(){return gp(),sg(),lp()},sg=function(){var t;return t=0,Wd=uh(),pc(Wd)?$u(Wd)?(t=Math.floor(Wd.d),void Lh(t)):nc(Wd)?void Fh(Wd):(($d=new Mr).k=1,$d.q.a=Kc(Wd.q.a,Wd.q.b),$d.q.b=td(1),Fh($d),uc(Wd)?(Bh(-1),$r()):void 0):(Gh(Hn),Fh(Wd),void Rc(2))},Ae=function(){var t,e,n,i,r,o;for(t=0,Zd=Lo(Wd),Mc(Zd)||uf("for: 1st arg?"),Fh(Fo(Wd)),_t(),2147483648===(e=hh())&&uf("for: 2nd arg?"),Fh(Io(Wd)),_t(),2147483648===(n=hh())&&uf("for: 3rd arg?"),Wd=Wo(Wd),Kd=cu(Zd),$d=uu(Zd),t=i=r=e,o=n;r<=o?i<=o:i>=o;t=r<=o?++i:--i)for(Bh(t),Jd=uh(),jp(Zd,Jd),Qd=Wd;Uu(Qd);)Fh(zo(Qd)),_t(),uh(),Qd=Ko(Qd);return Dp(Zd,Kd,$d),Gh(wi)},ke=function(){return Fh(Lo(Wd)),_t(),Zl()},Zl=function(){return gp(),Xl(),lp()},Xl=function(){return Wd=uh(),kc(Wd)&&fi(Wd.q.a,1)&&fi(Wd.q.b,2)?(Gh(Pi),Hh(1,2),void ph()):kc(Wd)&&fi(Wd.q.a,3)&&fi(Wd.q.b,2)?(Gh(Pi),Hh(1,2),ph(),Hh(1,2),void pd()):cc(Wd)?(Gh(Pi),Bh(-1),pd(),Gh(Pi),Fh(Wd),pd(),Yp(),Fh(Wd),pd(),Fh(Wd),wd(),Zl(),pd(),void ga()):void(zo(Wd)!==gf(r)?(Gh(Un),Fh(Wd),Rc(2)):Yl())},Yl=function(){return $d=Ko(Wd),kc(zo($d))&&fi(zo($d).q.a,1)&&fi(zo($d).q.b,1)?(Fh(Lo($d)),Fh(Lo($d)),Zl(),pd()):kc(zo($d))&&fi(zo($d).q.a,-1)&&fi(zo($d).q.b,1)?(Fh(Lo($d)),Zl(),Fh(Lo($d)),Bh(-1),$r(),ga()):(Gh(Un),Fh(Wd),void Rc(2))},Te=function(){var t;for(Wd=Ko(Wd),Fh(zo(Wd)),_t(),Wd=Ko(Wd),t=[];Uu(Wd);)Fh(zo(Wd)),_t(),tu(),t.push(Wd=Ko(Wd));return t},tu=function(){var t;return t=yl,gp(),ru(),lp(),yl=t},ru=function(){if(yl=1,Qd=uh(),Wd=uh(),rl(Wd,Qd))Fh(Wd);else{if(kc(Wd)&&kc(Qd))return Fh(Wd),Fh(Qd),void ou();if(zo(Wd)!==gf(r)||zo(Qd)!==gf(r))if(zo(Wd)===gf(r)&&(eu(Wd),Wd=uh()),zo(Qd)===gf(r)&&(eu(Qd),Qd=uh()),zo(Wd)!==gf(_i)||zo(Qd)!==gf(_i))if(zo(Wd)!==gf(_i))if(zo(Qd)!==gf(_i))if(zo(Wd)===gf(Di)?($d=Fo(Wd),Wd=Lo(Wd)):$d=Hd,zo(Qd)===gf(Di)?(Kd=Fo(Qd),Qd=Lo(Qd)):Kd=Hd,rl(Wd,Qd)){if(pc($d)&&pc(Kd))return Fh(Wd),Lc($d,Kd)?Fh($d):Fh(Kd),void ph();if(Fh($d),Fh(Kd),ga(),Jd=uh(),pc(Jd))return Fh(Wd),Jd=zo($d)===gf(_i)&&pc(Lo($d))?Lo($d):Hd,Zd=zo(Kd)===gf(_i)&&pc(Lo(Kd))?Lo(Kd):Hd,Lc(Jd,Zd)?Fh($d):Fh(Kd),void ph();if(Fh($d),Fh(Kd),pf(),Jd=uh(),pc(Jd))return Fh(Wd),uc(Jd)?Fh($d):Fh(Kd),ph();Fh(Hd)}else Fh(Hd);else iu();else su();else au();else nu()}},nu=function(){if(Fc(Wd)===Fc(Qd)){for($d=Ko(Wd),Fh(zo($d)),$d=Ko($d);Uu($d);)Fh(zo($d)),tu(),$d=Ko($d);for($d=uh(),Kd=Ko(Qd),Fh(zo(Kd)),Kd=Ko(Kd);Uu(Kd);)Fh(zo(Kd)),tu(),Kd=Ko(Kd);return Kd=uh(),Fh(Wd),Fh($d),ga(),Jd=uh(),Fh(Qd),Fh(Kd),ga(),Zd=uh(),rl(Jd,Zd)?(Fh(Jd),Fh($d),Fh(Kd),tu(),pd()):Fh(Hd)}Fh(Hd)},eu=function(t){var e;for(t=Ko(t),Fh(zo(t)),t=Ko(t),e=[];Uu(t);)Fh(zo(t)),tu(),e.push(t=Ko(t));return e},au=function(){var t;for(Fh(Hd),$d=Ko(Wd),t=[];Uu($d);){for(Kd=Ko(Qd);Uu(Kd);)Fh(zo($d)),Fh(zo(Kd)),tu(),pd(),Kd=Ko(Kd);t.push($d=Ko($d))}return t},su=function(){var t;for(Fh(Hd),$d=Ko(Wd),t=[];Uu($d);)Fh(zo($d)),Fh(Qd),tu(),pd(),t.push($d=Ko($d));return t},iu=function(){var t;for(Fh(Hd),Kd=Ko(Qd),t=[];Uu(Kd);)Fh(Wd),Fh(zo(Kd)),tu(),pd(),t.push(Kd=Ko(Kd));return t},vu=function(){var t;return t=uh(),Fh(t),Vn(t,gf(hr))?Gh(hr):Vn(t,gf(pr))?Gh(pr):Vn(t,gf(fr))?Gh(fr):Vn(t,gf(dr))?Gh(dr):Vn(t,gf(cr))?Gh(cr):Gh(hr)},bu=function(){return gp(),ag(),lp()},ag=function(){var t;return Qd=uh(),Wd=uh(),Fh(Qd),(t=hh())<0||2147483648===t?(Gh(Qn),Fh(Wd),Fh(Qd),void Rc(3)):Mc(Wd)?lg(t):($d=Wd,Wd=gf(Ui),lg(t),Wd=$d,Fh(gf(Ui)),Fh(Wd),hf(),_t())},lg=function(t){var e,n,i,r;for(e=0,Bh(1),Bh(0),Kd=uh(),r=[],e=n=0,i=t;0<=i?n<i:n>i;e=0<=i?++n:--n)Jd=Kd,Kd=uh(),Fh(Wd),Fh(Kd),pd(),Bh(e),Fh(Jd),pd(),pf(),Bh(2),r.push(pd());return r},_u=function(){var t,e,n,i,r,o,s;if(e=0,n=0,gp(),Qd=uh(),Fh(Qd),(i=hh())<2)return Gh($n),Fh(Qd),Rc(2),void lp();for(Wh(i,i),Wd=uh(),e=r=0,o=i;0<=o?r<o:r>o;e=0<=o?++r:--r)for(n=t=0,s=i;0<=s?t<s:t>s;n=0<=s?++t:--t)Bh(e+n+1),Du(),Wd.tensor.elem[e*i+n]=uh();return Fh(Wd),lp()},Ee=function(){return Fh(Lo(Wd)),_t(),xu()},xu=function(){return gp(),op(),Wd=uh(),Fh(Wd),Fh(Wd),xs(),pf(),Bh(2),ga(),Fh(wu),ga(),lp()},Au=function(t){var e,n,i,r,o,s,a,l,u,c,d,h,p,f,g,m,v,y,b,_;if(o=0,s=0,u=0,_=0,gp(),Wd=rf[b=Mf-t],!Nc(Wd))return Mf-=t,Fh(Wd),void lp();for((a=t-1)>(l=Wd.tensor.ndim)&&uf("too many indices for tensor"),s=0,o=c=0,d=a;0<=d?c<d:c>d;o=0<=d?++c:--c)Fh(rf[b+o+1]),((_=hh())<1||_>Wd.tensor.dim[o])&&uf("index out of range"),s=s*Wd.tensor.dim[o]+_-1;if(l===a)return Mf-=t,Fh(Wd.tensor.elem[s]),void lp();for(o=e=h=a,p=l;h<=p?e<p:e>p;o=h<=p?++e:--e)s=s*Wd.tensor.dim[o]+0;for(u=1,o=n=f=a,g=l;f<=g?n<g:n>g;o=f<=g?++n:--n)u*=Wd.tensor.dim[o];for((Qd=Xr(u)).tensor.ndim=l-a,o=i=m=a,v=l;m<=v?i<v:i>v;o=m<=v?++i:--i)Qd.tensor.dim[o-a]=Wd.tensor.dim[o];for(o=r=0,y=u;0<=y?r<y:r>y;o=0<=y?++r:--r)Qd.tensor.elem[o]=Wd.tensor.elem[s+o];return Wd.tensor.nelem!==Wd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Qd.tensor.nelem!==Qd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Mf-=t,Fh(Qd),lp()},Ip=function(t){var e,n,i,r,o,s,a,l,u,c,d,h,p,f,g,m,v,y,b;for(s=0,a=0,b=0,gp(),t<3&&uf("error in indexed assign"),Qd=rf[y=Mf-t],Wd=rf[y+1],Nc(Wd)||uf("error in indexed assign"),(l=t-2)>(u=Wd.tensor.ndim)&&uf("error in indexed assign"),a=0,s=c=0,d=l;0<=d?c<d:c>d;s=0<=d?++c:--c)Fh(rf[y+s+2]),((b=hh())<1||b>Wd.tensor.dim[s])&&uf("error in indexed assign\n"),a=a*Wd.tensor.dim[s]+b-1;for(s=e=h=l,p=u;h<=p?e<p:e>p;s=h<=p?++e:--e)a=a*Wd.tensor.dim[s]+0;for(($d=Xr(Wd.tensor.nelem)).tensor.ndim=Wd.tensor.ndim,s=n=0,f=Wd.tensor.ndim;0<=f?n<f:n>f;s=0<=f?++n:--n)$d.tensor.dim[s]=Wd.tensor.dim[s];for(s=i=0,g=Wd.tensor.nelem;0<=g?i<g:i>g;s=0<=g?++i:--i)$d.tensor.elem[s]=Wd.tensor.elem[s];if(Wd.tensor.nelem!==Wd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),$d.tensor.nelem!==$d.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Wd=$d,u===l)return Nc(Qd)&&uf("error in indexed assign"),Wd.tensor.elem[a]=Qd,Wd.tensor.nelem!==Wd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Mf-=t,Fh(Wd),void lp();for(Nc(Qd)||uf("error in indexed assign"),u-l!==Qd.tensor.ndim&&uf("error in indexed assign"),s=r=0,m=Qd.tensor.ndim;0<=m?r<m:r>m;s=0<=m?++r:--r)Wd.tensor.dim[l+s]!==Qd.tensor.dim[s]&&uf("error in indexed assign");for(s=o=0,v=Qd.tensor.nelem;0<=v?o<v:o>v;s=0<=v?++o:--o)Wd.tensor.elem[a+s]=Qd.tensor.elem[s];return Wd.tensor.nelem!==Wd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Qd.tensor.nelem!==Qd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Mf-=t,Fh(Wd),lp()},Oe=function(){var t;for(Wd=Ko(Wd),Fh(zo(Wd)),_t(),Wd=Ko(Wd),t=[];Uu(Wd);)Fh(zo(Wd)),_t(),Mu(),t.push(Wd=Ko(Wd));return t},Mu=function(){return gp(),Qd=uh(),Wd=uh(),Nc(Wd)&&Nc(Qd)?Eu():(Fh(Wd),Fh(Qd),Nc(Wd)?wf():Nc(Qd)?mp():pd()),lp()},Eu=function(){var t,e,n,i,r,o,s,a,l,u,c,d,h,p,f,g,m,v,y,b,_,x,w,A;for(d=0,(f=Wd.tensor.dim[Wd.tensor.ndim-1])!==Qd.tensor.dim[0]&&uf("inner: tensor dimension check"),(g=Wd.tensor.ndim+Qd.tensor.ndim-2)>pi&&uf("inner: rank of result exceeds maximum"),t=Wd.tensor.elem,l=Qd.tensor.elem,a=1,d=m=0,v=Wd.tensor.ndim-1;0<=v?m<v:m>v;d=0<=v?++m:--m)a*=Wd.tensor.dim[d];for(u=1,d=e=1,y=Qd.tensor.ndim;1<=y?e<y:e>y;d=1<=y?++e:--e)u*=Qd.tensor.dim[d];for(c=($d=Xr(a*u)).tensor.elem,d=n=0,b=a;0<=b?n<b:n>b;d=0<=b?++n:--n)for(h=i=0,_=f;0<=_?i<_:i>_;h=0<=_?++i:--i)if(!Oc(t[d*f+h]))for(p=r=0,x=u;0<=x?r<x:r>x;p=0<=x?++r:--r)Fh(t[d*f+h]),Fh(l[h*u+p]),pd(),Fh(c[d*u+p]),$r(),c[d*u+p]=uh();if(0===g)return Fh($d.tensor.elem[0]);for($d.tensor.ndim=g,h=0,d=o=0,w=Wd.tensor.ndim-1;0<=w?o<w:o>w;d=0<=w?++o:--o)$d.tensor.dim[d]=Wd.tensor.dim[d];for(h=Wd.tensor.ndim-1,d=s=0,A=Qd.tensor.ndim-1;0<=A?s<A:s>A;d=0<=A?++s:--s)$d.tensor.dim[h+d]=Qd.tensor.dim[d+1];return Fh($d)},qc=["f(a,a*x)","f(1/x,log(x))","f(x^a,x^(a+1)/(a+1))","f(exp(a*x),1/a*exp(a*x))","f(exp(a*x+b),1/a*exp(a*x+b))","f(x*exp(a*x^2),exp(a*x^2)/(2*a))","f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))","f(log(a*x),x*log(a*x)-x)","f(a^x,a^x/log(a),or(not(number(a)),a>0))","f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/(a+b*x),1/b*log(a+b*x))","f(1/(a+b*x)^2,-1/(b*(a+b*x)))","f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)","f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)","f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))","f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))","f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))","f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))","f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))","f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))","f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))","f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))","f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))","f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))","f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))","f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))","f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))","f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))","f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))","f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))","f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))","f(1/(a+b*x^4),1/2*1/a*(a/b/4)^(1/4)*(1/2*log((x^2+2*(a/b/4)^(1/4)*x+2*(a/b/4)^(1/2))/(x^2-2*(a/b/4)^(1/4)*x+2*(a/b/4)^(1/2)))+arctan(2*(a/b/4)^(1/4)*x/(2*(a/b/4)^(1/2)-x^2))),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^4),1/2*(-a/b)^(1/4)/a*(1/2*log((x+(-a/b)^(1/4))/(x-(-a/b)^(1/4)))+arctan(x*(-a/b)^(-1/4))),or(not(number(a*b)),a*b<0))","f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))","f(x^2/(a+b*x^4),1/4*1/b*(a/b/4)^(-1/4)*(1/2*log((x^2-2*(a/b/4)^(1/4)*x+2*sqrt(a/b/4))/(x^2+2*(a/b/4)^(1/4)*x+2*sqrt(a/b/4)))+arctan(2*(a/b/4)^(1/4)*x/(2*sqrt(a/b/4)-x^2))),or(not(number(a*b)),a*b>0))","f(x^2/(a+b*x^4),1/4*1/b*(-a/b)^(-1/4)*(log((x-(-a/b)^(1/4))/(x+(-a/b)^(1/4)))+2*arctan(x*(-a/b)^(-1/4))),or(not(number(a*b)),a*b<0))","f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))","f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))","f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)","f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)","f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))","f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)","f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)","f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)","f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))","f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))","f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))","f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))","f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))","f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))","f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))","f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))","f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))","f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(x/sqrt(a-x^2),-sqrt(a-x^2))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))","f(sin(a*x),-cos(a*x)/a)","f(cos(a*x),sin(a*x)/a)","f(tan(a*x),-log(cos(a*x))/a)","f(1/tan(a*x),log(sin(a*x))/a)","f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)","f(1/sin(a*x),log(tan(a*x/2))/a)","f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))","f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))","f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(1/sin(a*x)^2,-1/(a*tan(a*x)))","f(1/cos(a*x)^2,tan(a*x)/a)","f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))","f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)","f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))","f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)","f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))","f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)","f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)","f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)","f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))","f(sin(a+b*x),-cos(a+b*x)/b)","f(cos(a+b*x),sin(a+b*x)/b)","f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)","f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)","f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)","f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)","f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)","f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)","f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)","f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)","f(log(a*x),x*log(a*x)-x)","f(x*log(a*x),x^2*log(a*x)/2-x^2/4)","f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)","f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)","f(1/x*1/(a+log(x)),log(a+log(x)))","f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)","f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)","f(sinh(x),cosh(x))","f(cosh(x),sinh(x))","f(tanh(x),log(cosh(x)))","f(x*sinh(x),x*cosh(x)-sinh(x))","f(x*cosh(x),x*sinh(x)-cosh(x))","f(sinh(x)^2,sinh(2*x)/4-x/2)","f(tanh(x)^2,x-tanh(x))","f(cosh(x)^2,sinh(2*x)/4+x/2)","f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)","f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)","f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)","f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))","f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)","f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)","f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))","f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))","f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))","f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))",0],qe=function(){var t,e,n,i,r;for(e=0,Wd=Ko(Wd),Fh(zo(Wd)),_t(),Wd=Ko(Wd),Fh(zo(Wd)),_t(),(Qd=uh())===gf(wi)?(vu(),Fh(gf(wi))):pc(Qd)?(vu(),Fh(Qd)):(Fh(Qd),Wd=Ko(Wd),Fh(zo(Wd)),_t()),Jd=uh(),Kd=uh(),$d=uh();;){if(pc(Jd)?(Fh(Jd),2147483648===(e=hh())&&uf("nth integral: check n")):e=1,Fh($d),e>=0)for(n=0,i=e;0<=i?n<i:n>i;0<=i?++n:--n)Fh(Kd),Ou();else for(t=0,r=e=-e;0<=r?t<r:t>r;0<=r?++t:--t)Fh(Kd),la();if($d=uh(),Jd===gf(wi))break;if(pc(Jd)){if(Wd=Ko(Wd),Fh(zo(Wd)),_t(),(Jd=uh())===gf(wi))break;pc(Jd)||(Kd=Jd,Wd=Ko(Wd),Fh(zo(Wd)),_t(),Jd=uh())}else Kd=Jd,Wd=Ko(Wd),Fh(zo(Wd)),_t(),Jd=uh()}return Fh($d)},Ou=function(){return gp(),Qd=uh(),Wd=uh(),zo(Wd)===gf(r)?Pu():zo(Wd)===gf(_i)?Cu():qu(),Wd=uh(),Vn(Wd,gf(Yn))&&uf("integral: sorry, could not find a solution"),Fh(Wd),Wp(),_t(),lp()},Pu=function(){var t;for(Wd=Ko(Wd),Fh(zo(Wd)),Fh(Qd),Ou(),Wd=Ko(Wd),t=[];Uu(Wd);)Fh(zo(Wd)),Fh(Qd),Ou(),$r(),t.push(Wd=Ko(Wd));return t},Cu=function(){return Fh(Wd),Fh(Qd),oh(),Wd=uh(),qu(),pd()},qu=function(){return Fh(Wd),Fh(Qd),Ef(qc),($d=uh())===gf(wi)?(Gh(Yn),Fh(Wd),Fh(Qd),Rc(3)):Fh($d)},ei=function(){return Nc(Wd)?2!==Wd.tensor.ndim?0:Wd.tensor.dim[0]!==Wd.tensor.dim[1]?0:1:0},ju=function(){var t,e,n,i,r;if(e=0,gp(),Wd=uh(),0===ei())return Gh(Xn),Fh(Wd),Rc(2),void lp();for(n=Wd.tensor.nelem,t=Wd.tensor.elem,e=i=0,r=n;(0<=r?i<r:i>r)&&pc(t[e]);e=0<=r?++i:--i);return e===n?ug():(Fh(Wd),Yr(),Fh(Wd),ca(),Qd=uh(),Oc(Qd)&&uf("inverse of singular matrix"),Fh(Qd),ga()),lp()},Fu=function(){return gp(),Wd=uh(),0===ei()?(Gh(ti),Fh(Wd),Rc(2),void lp()):(ug(),lp())},ug=function(){var t,e,n,i,r,o,s,a,l,u,c,d;for(r=0,o=0,s=Wd.tensor.dim[0],i=Mf,r=a=0,l=s;0<=l?a<l:a>l;r=0<=l?++a:--a)for(o=t=0,u=s;0<=u?t<u:t>u;o=0<=u?++t:--t)Fh(r===o?Hd:xg);for(r=e=0,c=s*s;0<=c?e<c:e>c;r=0<=c?++e:--e)Fh(Wd.tensor.elem[r]);for(ni(s),(Wd=Xr(s*s)).tensor.ndim=2,Wd.tensor.dim[0]=s,Wd.tensor.dim[1]=s,r=n=0,d=s*s;0<=d?n<d:n>d;r=0<=d?++n:--n)Wd.tensor.elem[r]=rf[i+r];return Mf-=2*s*s,Fh(Wd)},ni=function(t){var e,n,i,r,o,s,a,l,u,c,d,h,p,f,g;for(o=0,s=0,a=0,g=(e=Mf-t*t)-t*t,f=[],o=l=0,u=t;0<=u?l<u:l>u;o=0<=u?++l:--l){if(rl(rf[e+t*o+o],xg)){for(s=n=c=o+1,d=t;(c<=d?n<d:n>d)&&rl(rf[e+t*s+o],xg);s=c<=d?++n:--n);for(s===t&&uf("inverse of singular matrix"),a=i=0,h=t;0<=h?i<h:i>h;a=0<=h?++i:--i)Qd=rf[e+t*o+a],rf[e+t*o+a]=rf[e+t*s+a],rf[e+t*s+a]=Qd,Qd=rf[g+t*o+a],rf[g+t*o+a]=rf[g+t*s+a],rf[g+t*s+a]=Qd}for(Qd=rf[e+t*o+o],a=r=0,p=t;0<=p?r<p:r>p;a=0<=p?++r:--r)a>o&&(Fh(rf[e+t*o+a]),Fh(Qd),ga(),rf[e+t*o+a]=uh()),Fh(rf[g+t*o+a]),Fh(Qd),ga(),rf[g+t*o+a]=uh();f.push(function(){var n,i,r;for(r=[],s=n=0,i=t;0<=i?n<i:n>i;s=0<=i?++n:--n)s!==o&&(Qd=rf[e+t*s+o],r.push(function(){var n,i,r;for(r=[],a=n=0,i=t;0<=i?n<i:n>i;a=0<=i?++n:--n)a>o&&(Fh(rf[e+t*s+a]),Fh(rf[e+t*o+a]),Fh(Qd),pd(),pf(),rf[e+t*s+a]=uh()),Fh(rf[g+t*s+a]),Fh(rf[g+t*o+a]),Fh(Qd),pd(),pf(),r.push(rf[g+t*s+a]=uh());return r}()));return r}())}return f},Oc=function(t){var e,n,i;switch(e=0,t.k){case 1:if(xi(t.q.a))return 1;break;case 2:if(0===t.d)return 1;break;case 4:for(e=n=0,i=t.tensor.nelem;0<=i?n<i:n>i;e=0<=i?++n:--n)if(!Oc(t.tensor.elem[e]))return 0;return 1}return 0},uc=function(t){switch(t.k){case 1:if(-1===bi(t.q.a))return 1;break;case 2:if(t.d<0)return 1}return 0},mc=function(t){switch(t.k){case 1:if(fi(t.q.a,1)&&fi(t.q.b,1))return 1;break;case 2:if(1===t.d)return 1}return 0},oc=function(t){switch(t.k){case 1:if(fi(t.q.a,-1)&&fi(t.q.b,1))return 1;break;case 2:if(-1===t.d)return 1}return 0},nc=function(t){return 1===t.k&&fi(t.q.b,1)?1:0},dc=function(t){return kc(t)&&fi(t.q.b,1)&&1===bi(t.q.a)?1:0},xc=function(t){return nc(t)&&1===bi(t.q.a)?1:0},vc=function(t,e){return Vn(t,e)?yc(t,e):0},yc=function(t,e){if(zo(t)===gf(r)){for(t=Ko(t);Uu(t);){if(!_c(zo(t),e))return 0;t=Ko(t)}return 1}return _c(t,e)},_c=function(t,e){if(zo(t)===gf(_i)){for(t=Ko(t);Uu(t);){if(!bc(zo(t),e))return 0;t=Ko(t)}return 1}return bc(t,e)},bc=function(t,e){return rl(t,e)?1:zo(t)===gf(Di)&&rl(Lo(t),e)?xc(Fo(t))?1:0:Vn(t,e)?0:1},cc=function(t){return uc(t)?1:zo(t)===gf(_i)&&uc(Lo(t))?1:0},tc=function(t){return zo(t)===gf(_i)&&3===Fc(t)&&pc(Lo(t))&&rl(Fo(t),wu)||rl(t,wu)?1:0},Vu=function(t){return zo(t)===gf(r)&&3===Fc(t)&&pc(Lo(t))&&tc(Fo(t))||tc(t)?1:0},Ku=function(t){return nc(t)&&t.q.a.isEven()?1:0},lc=function(t){return zo(t)===gf(r)&&cc(Lo(t))?1:cc(t)?1:0},Ec=function(t){if(Mc(t))return 1;for(;Uu(t);){if(Ec(zo(t)))return 1;t=Ko(t)}return 0},ic=function(t){return nc(t)||zo(t)===gf(Di)&&nc(Lo(t))&&nc(Fo(t))?1:0},fc=function(t){return zo(t)===gf(Di)&&oc(Fo(t))?1:0},Xu=function(t){return 1!==t.k||fi(t.q.b,1)?0:1},ol=function(t,e){switch(t.k){case 1:if(fi(t.q.a,e)&&fi(t.q.b,1))return 1;break;case 2:if(t.d===e)return 1}return 0},sl=function(t,e,n){switch(t.k){case 1:if(fi(t.q.a,e)&&fi(t.q.b,n))return 1;break;case 2:if(t.d===e/n)return 1}return 0},gc=function(t){return zo(t)===gf(Di)&&ol(Lo(t),2)&&sl(Fo(t),-1,2)?1:0},sc=function(t){return zo(t)===gf(_i)&&ol(Lo(t),-1)&&gc(Fo(t))&&3===Fc(t)?1:0},Yu=function(t){if(2===t.k)return 1;for(;Uu(t);){if(Yu(zo(t)))return 1;t=Ko(t)}return 0},ec=function(t){return rl(t,wu)?1:0},Ac=function(t){var e,n;if(n=0,e=0,zo(t)!==gf(_i))return 0;if(rl(Lo(t),wu))return Fo(t)!==gf(Pi)?0:3!==Fc(t)?0:2;if(!pc(Lo(t)))return 0;if(!rl(Fo(t),wu))return 0;if(Io(t)!==gf(Pi))return 0;if(4!==Fc(t))return 0;if(Fh(Lo(t)),Bh(2),pd(),2147483648===(n=hh()))return 0;switch(n<1&&(e=1,n=-n),n%4){case 0:n=1;break;case 1:n=e?4:3;break;case 2:n=2;break;case 3:n=e?3:4}return n},hc=function(t){var e;return e=0,t===gf(Pi)?2:zo(t)===gf(_i)&&pc(Lo(t))&&Fo(t)===gf(Pi)&&3===Fc(t)?(Fh(Lo(t)),Bh(2),pd(),2147483648===(e=hh())?0:e=e<0?4- -e%4:1+(e-1)%4):0},t.iszero=Oc,t.isnegativenumber=uc,t.isplusone=mc,t.isminusone=oc,t.isinteger=nc,t.isnonnegativeinteger=dc,t.isposint=xc,t.isnegativeterm=cc,t.isimaginarynumber=tc,t.iscomplexnumber=Vu,t.iseveninteger=Ku,t.isnegative=lc,t.issymbolic=Ec,t.isintegerfactor=ic,t.isoneover=fc,t.isfraction=Xu,t.isoneoversqrttwo=gc,t.isminusoneoversqrttwo=sc,t.isfloating=Yu,t.isimaginaryunit=ec,t.isquarterturn=Ac,t.isnpi=hc,De=function(){return Fh(Lo(Wd)),_t(),Wd=uh(),dc(Wd)&&ud(Wd.q.a)?Bh(1):Bh(0)},Ie=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),Fh(Io(Wd)),_t(),(Qd=uh())===gf(wi)?Bh(0):Fh(Qd),Cc()},Cc=function(){var t;return gp(),$d=uh(),Qd=uh(),Wd=uh(),Fh(Qd),(t=hh())<0||2147483648===t?(Gh(oi),Fh(Wd),Fh(Qd),Fh($d),Rc(4),void lp()):(Mc(Wd)?Pc(t):(Kd=Wd,Wd=gf(Ui),Pc(t),Wd=Kd,Fh(gf(Ui)),Fh(Wd),hf(),_t()),lp())},Pc=function(t){var e,n,i,r;for(e=0,Bh(1),Bh(0),Zd=uh(),r=[],e=n=0,i=t;0<=i?n<i:n>i;e=0<=i?++n:--n)Jd=Zd,Zd=uh(),Bh(2*e+1),Fh(Wd),pf(),Fh($d),$r(),Fh(Zd),pd(),Bh(e),Fh($d),$r(),Fh(Jd),pd(),pf(),Bh(e+1),r.push(ga());return r},Fe=function(){var t;for(Wd=Ko(Wd),Fh(zo(Wd)),_t(),Wd=Ko(Wd),t=[];Uu(Wd);)Fh(zo(Wd)),_t(),jc(),t.push(Wd=Ko(Wd));return t},jc=function(){var t;return t=yl,gp(),cg(),lp(),yl=t},cg=function(){return yl=1,Qd=uh(),Wd=uh(),Fh(Wd),Fh(Qd),tu(),Fh(Wd),ga(),Fh(Qd),ga(),Du()},Le=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),(Wd=uh())===gf(wi)?vu():Fh(Wd),Dc()},Dc=function(){return gp(),Qd=uh(),Wd=uh(),Fh(Wd),Fh(Qd),ra(),$d=uh(),Fh(Wd),Fh(Qd),Fh($d),ph(),ga(),Fh(Qd),Bl(),lp()},ze=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),Fh(Io(Wd)),_t(),(Qd=uh())===gf(wi)?Bh(0):Fh(Qd),Ic()},Ic=function(){return gp(),zr(),lp()},zr=function(){var t,e;return $d=uh(),Qd=uh(),Wd=uh(),Fh(Qd),e=hh(),Fh($d),t=hh(),e<0||2147483648===e||t<0||2147483648===t?(Gh(ui),Fh(Wd),Fh(Qd),Fh($d),void Rc(4)):(Mc(Wd)?Rr(e,t):(Kd=Wd,Wd=gf(Ui),Rr(e,t),Wd=Kd,Fh(gf(Ui)),Fh(Wd),hf(),_t()),Br(t))},Rr=function(t,e){var n,i,r,o,s,a;for(i=0,Bh(1),Bh(0),Zd=uh(),i=r=0,o=t;0<=o?r<o:r>o;i=0<=o?++r:--r)Jd=Zd,Zd=uh(),Bh(2*i+1),Fh(Wd),pd(),Fh(Zd),pd(),Bh(i),Fh(Jd),pd(),pf(),Bh(i+1),ga();for(a=[],i=n=0,s=e;0<=s?n<s:n>s;i=0<=s?++n:--n)Fh(Wd),a.push(la());return a},Br=function(t){if(0!==t)return zo(Wd)===gf(z)?(Fh(Lo(Wd)),Yp(),nf()):zo(Wd)===gf(Ji)?(Fh(Lo(Wd)),Ms(),nf()):(Bh(1),Fh(Wd),nf(),pf()),Bh(t),Hh(1,2),pd(),ph(),pd(),t%2?wd():void 0},Rc=function(t){var e,n,i;for(Fh(gf(wi)),i=[],e=0,n=t;0<=n?e<n:e>n;0<=n?++e:--e)i.push(ws());return i},Re=function(){return Fh(Lo(Wd)),_t(),Bc()},Bc=function(){return gp(),dg(),lp()},dg=function(){var t;if(t=0,(Wd=uh())!==gf(ot))if(ol(Wd,1))Bh(0);else{if(uc(Wd))return Fh(Wd),wd(),Bc(),Fh(wu),Gh(Pi),pd(),void $r();if($u(Wd))return t=Math.log(Wd.d),void Lh(t);if(Xu(Wd))return Fh(Wd),zd(),Bc(),Fh(Wd),oa(),Bc(),void pf();if(zo(Wd)===gf(Di))return Fh(Fo(Wd)),Fh(Lo(Wd)),Bc(),void pd();if(zo(Wd)!==gf(_i))return Gh(ci),Fh(Wd),Rc(2);for(Bh(0),Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),Bc(),$r(),Wd=Ko(Wd)}else Bh(1)},Vc=function(t,e){return t.add(e)},dd=function(t,e){return t.subtract(e)},Be=function(){return Fh(Lo(Wd)),_t(),Uc()},Uc=function(){return gp(),Wd=uh(),Fh(Wd),zd(),hg(),Fh(Wd),oa(),hg(),ga(),lp()},hg=function(){if(gp(),Wd=uh(),uc(Wd))Fh(Wd),wd();else if(zo(Wd)===gf(Di)&&ol(Lo(Wd),-1))Bh(1);else if(zo(Wd)===gf(Di)&&Lo(Wd)===gf(ot))Fh(Fo(Wd)),ip(),_l();else if(zo(Wd)===gf(_i))for(Bh(1),Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),Uc(),pd(),Wd=Ko(Wd);else zo(Wd)===gf(r)?(Fh(Wd),op(),Wd=uh(),Fh(Wd),ip(),Bh(2),ph(),Fh(Wd),xu(),Bh(2),ph(),$r(),Hh(1,2),ph(),Jp()):Fh(Wd);return lp()},Yc=function(t,e){return mo.gcd(t,e)},Td=function(t){return gp(),(Wd=new Mr).k=3,Wd.str=t,Fh(Wd),lp()},Wh=function(t,e){return Fh(Xr(t*e)),rf[Mf-1].tensor.ndim=2,rf[Mf-1].tensor.dim[0]=t,rf[Mf-1].tensor.dim[1]=e},rl=function(t,e){return 0===us(t,e)?1:0},Lc=function(t,e){return us(t,e)<0?1:0},Hp=function(t){return t<0?-1:t>0?1:0},us=function(t,e){var n;if(n=0,t===e)return 0;if(t===gf(wi))return-1;if(e===gf(wi))return 1;if(pc(t)&&pc(e))return Hp(ms(t,e));if(pc(t))return-1;if(pc(e))return 1;if(Sc(t)&&Sc(e))return Hp(cf(t.str,e.str));if(Sc(t))return-1;if(Sc(e))return 1;if(Mc(t)&&Mc(e))return Hp(cf(pu(t),pu(e)));if(Mc(t))return-1;if(Mc(e))return 1;if(Nc(t)&&Nc(e))return ys(t,e);if(Nc(t))return-1;if(Nc(e))return 1;for(;Uu(t)&&Uu(e);){if(0!==(n=us(zo(t),zo(e))))return n;t=Ko(t),e=Ko(e)}return Uu(e)?-1:Uu(t)?1:0},Fc=function(t){var e;for(e=0;Uu(t);)t=Ko(t),e++;return e},Pf=function(t){if(Sc(t))Wd===gf(wi)?Wd=t:t!==Wd&&(Qd=t);else for(;Uu(t);){if(Pf(zo(t)),Qd!==gf(wi))return;t=Ko(t)}},ig=function(){var t;return t=yl,yl=1,_t(),yl=t},_l=function(){return Gh(ot),ff(),ph()},nf=function(){return Bh(2),ph()},ef=function(t){var e,n;return e=Mf-t,(n=rf.slice(e,e+t)).sort(us),rf=rf.slice(0,e).concat(n).concat(rf.slice(e+t))},t.equal=rl,t.length=Fc,nd=function(t,e){return t.multiply(e)},Kc=function(t,e){return t.divide(e)},ed=function(t,e){return t.mod(e)},Jc=function(t,e){var n;return[(n=t.divmod(e)).quotient,n.remainder]},He=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),id()},id=function(){var t;return t=0,gp(),Qd=uh(),Wd=uh(),Oc(Qd)&&uf("mod function: divide by zero"),pc(Wd)&&pc(Qd)?($u(Wd)&&(Fh(Wd),2147483648===(t=hh())&&uf("mod function: cannot convert float value to integer"),Bh(t),Wd=uh()),$u(Qd)&&(Fh(Qd),2147483648===(t=hh())&&uf("mod function: cannot convert float value to integer"),Bh(t),Qd=uh()),nc(Wd)&&nc(Qd)||uf("mod function: integer arguments expected"),($d=new Mr).k=1,$d.q.a=ed(Wd.q.a,Qd.q.a),$d.q.b=td(1),Fh($d),lp()):(Gh(yi),Fh(Wd),Fh(Qd),Rc(3),void lp())},ld=function(t,e){return t.pow(e)},ud=function(t){return t.isProbablePrime()},cd=function(t,e){var n,i,r,o,s,a,l;for(t=t.abs(),n=0,r=0,0===e&&uf("root index is zero"),r=0;t.shiftRight(r)>0;)r++;if(0===r)return td(0);for(r=Math.floor((r-1)/e),i=Math.floor(r/32+1),a=mo(i),n=o=0,s=i;0<=s?o<s:o>s;n=0<=s?++o:--o)a=a.and(mo(1).shiftLeft(n).not());for(;r>=0;){switch(a=a.or(mo(1).shiftLeft(r)),l=ld(a,e),$c(l,t)){case 0:return a;case 1:a=a.and(mo(1).shiftLeft(r).not())}r--}return 0},pd=function(){return ul&&uf("escape key stop"),pc(rf[Mf-2])&&pc(rf[Mf-1])?_d():(gp(),pg(),lp())},pg=function(){var t,e,n,i,r,o;if(e=0,Qd=uh(),Wd=uh(),t=Mf,Oc(Wd)||Oc(Qd))Fh(xg);else if(yl&&Bu(Wd))for(Wd=Ko(Wd),Fh(xg);Uu(Wd);)Fh(zo(Wd)),Fh(Qd),pd(),$r(),Wd=Ko(Wd);else if(yl&&Bu(Qd))for(Qd=Ko(Qd),Fh(xg);Uu(Qd);)Fh(Wd),Fh(zo(Qd)),pd(),$r(),Qd=Ko(Qd);else{if(!Nc(Wd)&&Nc(Qd))return Fh(Wd),Fh(Qd),void mp();if(Nc(Wd)&&!Nc(Qd))return Fh(Wd),Fh(Qd),void wf();for(zo(Wd)===gf(_i)?Wd=Ko(Wd):(Fh(Wd),Rc(1),Wd=uh()),zo(Qd)===gf(_i)?Qd=Ko(Qd):(Fh(Qd),Rc(1),Qd=uh()),pc(zo(Wd))&&pc(zo(Qd))?(Fh(zo(Wd)),Fh(zo(Qd)),_d(),Wd=Ko(Wd),Qd=Ko(Qd)):pc(zo(Wd))?(Fh(zo(Wd)),Wd=Ko(Wd)):pc(zo(Qd))?(Fh(zo(Qd)),Qd=Ko(Qd)):Fh(Hd),ih(),rh();Uu(Wd)&&Uu(Qd);)if(Eo(Wd)!==gf(Oi)||Eo(Qd)!==gf(Oi))switch(us($d,Kd)){case-1:Fh(zo(Wd)),Wd=Ko(Wd),ih();break;case 1:Fh(zo(Qd)),Qd=Ko(Qd),rh();break;case 0:fs(t),Wd=Ko(Wd),Qd=Ko(Qd),ih(),rh();break;default:uf("internal error 2")}else Gh(Oi),Fh(Ho(Wd)),Fh(Ho(Qd)),append(),ws(),Wd=Ko(Wd),Qd=Ko(Qd),ih(),rh();for(;Uu(Wd);)Fh(zo(Wd)),Wd=Ko(Wd);for(;Uu(Qd);)Fh(zo(Qd)),Qd=Ko(Qd);if(Hr(t),yl)for(e=i=r=t,o=Mf;r<=o?i<o:i>o;e=r<=o?++i:--i)if(Bu(rf[e]))return void fd(Mf-t);if(1!=(n=Mf-t)){if(!kc(rf[t])||!ol(rf[t],1))return Rc(n),Yd=uh(),Gh(_i),Fh(Yd),ws();2===n?(Yd=uh(),uh(),Fh(Yd)):(rf[t]=gf(_i),Rc(n))}}},ih=function(){if($d=zo(Wd),Jd=Hd,zo($d)===gf(Di))return Jd=Fo($d),$d=Lo($d)},rh=function(){if(Kd=zo(Qd),Zd=Hd,zo(Kd)===gf(Di))return Zd=Fo(Kd),Kd=Lo(Kd)},fs=function(t){return Fh(Kd),Fh(Jd),Fh(Zd),$r(),ph(),Yd=uh(),pc(Yd)?(Fh(rf[t]),Fh(Yd),_d(),rf[t]=uh()):zo(Yd)===gf(_i)&&pc(Lo(Yd))&&Qo(Yd)===gf(wi)?(Fh(rf[t]),Fh(Lo(Yd)),_d(),rf[t]=uh(),Fh(Fo(Yd))):Fh(Yd)},[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,1,-6,-7,-8,-3,-4,-5,13,14,15,-16,9,10,11,-12],[0,0,6,-1,-11,10,-2,-15,14,12,-5,4,-9,16,-8,7,-13],[0,0,7,11,-1,-9,15,-2,-13,5,12,-3,-10,8,16,-6,-14],[0,0,8,-10,9,-1,-14,13,-2,-4,3,12,-11,-7,6,16,-15],[0,0,3,2,15,-14,1,11,-10,16,-8,7,13,12,-5,4,9],[0,0,4,-15,2,13,-11,1,9,8,16,-6,14,5,12,-3,10],[0,0,5,14,-13,2,10,-9,1,-7,6,16,15,-4,3,12,11],[0,0,13,12,-5,4,16,-8,7,-1,-11,10,-3,-2,-15,14,-6],[0,0,14,5,12,-3,8,16,-6,11,-1,-9,-4,15,-2,-13,-7],[0,0,15,-4,3,12,-7,6,16,-10,9,-1,-5,-14,13,-2,-8],[0,0,16,-9,-10,-11,-13,-14,-15,-3,-4,-5,1,-6,-7,-8,2],[0,0,9,-16,8,-7,-12,5,-4,-2,-15,14,6,-1,-11,10,3],[0,0,10,-8,-16,6,-5,-12,3,15,-2,-13,7,11,-1,-9,4],[0,0,11,7,-6,-16,4,-3,-12,-14,13,-2,8,-10,9,-1,5],[0,0,12,13,14,15,9,10,11,-6,-7,-8,-2,-3,-4,-5,-1]],bd=function(){var t;return t=yl,yl=0,pd(),yl=t},fd=function(t){var e,n,i,r;if(n=0,1!==t){if(0!==t){for(Fh(rf[e=Mf-t]),n=i=1,r=t;1<=r?i<r:i>r;n=1<=r?++i:--i)Fh(rf[e+n]),pd();return rf[e]=uh(),Mf=e+1}Fh(Hd)}},gd=function(t){var e;return e=yl,yl=0,fd(t),yl=e},ga=function(){return pc(rf[Mf-2])&&pc(rf[Mf-1])?ma():(Du(),pd())},Du=function(){return pc(rf[Mf-1])?Iu():(Bh(-1),ph())},rp=function(){return pc(rf[Mf-1])?Iu():(Bh(-1),ph())},wd=function(){return pc(rf[Mf-1])?kd():(Bh(-1),pd())},Ad=function(){var t;return t=yl,yl=0,wd(),yl=t},Hr=function(t){var e,n,i,r,o,s,a,l,u,c;if(i=0,!(mc(rf[t])||oc(rf[t])||$u(rf[t]))){for(i=r=o=t+1,s=Mf;(o<=s?r<s:r>s)&&!Fr(rf[i]);i=o<=s?++r:--r);if(i!==Mf){for(gp(),Fh(rf[t]),ad(),Wd=uh(),i=e=a=t+1,l=Mf;(a<=l?e<l:e>l)&&!mc(Wd)&&!oc(Wd);i=a<=l?++e:--e)Fr(rf[i])&&($d=Lo(rf[i]),Kd=Fo(rf[i]),uc(Kd)&&(Fh(Wd),Fh($d),ga(),Jd=uh(),nc(Jd)&&(Wd=Jd,Gh(Di),Fh($d),Fh(Hd),Fh(Kd),$r(),Rc(3),rf[i]=uh())));for(Fh(rf[t]),sd(),Qd=uh(),i=n=u=t+1,c=Mf;(u<=c?n<c:n>c)&&!mc(Qd);i=u<=c?++n:--n)Fr(rf[i])&&($d=Lo(rf[i]),Kd=Fo(rf[i]),uc(Kd)||(Fh(Qd),Fh($d),ga(),Jd=uh(),nc(Jd)&&(Qd=Jd,Gh(Di),Fh($d),Fh(Kd),Fh(Hd),pf(),Rc(3),rf[i]=uh())));return Fh(Wd),Fh(Qd),ga(),rf[t]=uh(),lp()}}},Fr=function(t){return zo(t)===gf(Di)&&pc(Lo(t))&&pc(Fo(t))&&!oc(Lo(t))?1:0},Ti=function(t){return Math.sqrt(t.r*t.r+t.i*t.i)},Si=function(){return 4*Math.random()-2},Rd=function(){function t(){}return t.prototype.r=0,t.prototype.i=0,t}(),Nd=new Rd,Od=new Rd,Id=new Rd,Fd=new Rd,jd=new Rd,Dd=new Rd,Pd=new Rd,Cd=new Rd,qd=[],Tu=Bd=0;Bd<101;Tu=++Bd)qd[Tu]=new Rd;for(Ue=function(){var t,e,n,i,r,o,s,a,l;for(r=0,o=0,s=0,Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),(Qd=uh())===gf(wi)?vu():Fh(Qd),Qd=uh(),Wd=uh(),vc(Wd,Qd)||uf("nroots: polynomial?"),i=Mf,Fh(Wd),Fh(Qd),(s=ds())>101&&uf("nroots: degree?"),r=t=0,a=s;0<=a?t<a:t>a;r=0<=a?++t:--t)Fh(rf[i+r]),ip(),og(),_t(),Wd=uh(),Fh(rf[i+r]),xu(),og(),_t(),Qd=uh(),$u(Wd)&&$u(Qd)||uf("nroots: coefficients?"),qd[r].r=Wd.d,qd[r].i=Qd.d;for(Mf=i,rd(s),o=e=s;e>1;o=e+=-1)Ul(o),Math.abs(Nd.r)<1e-6&&(Nd.r=0),Math.abs(Nd.i)<1e-6&&(Nd.i=0),Lh(Nd.r),Lh(Nd.i),Fh(wu),pd(),$r(),Mi(o);if((s=Mf-i)>1){for(ef(s),(Wd=Xr(s)).tensor.ndim=1,Wd.tensor.dim[0]=s,r=n=0,l=s;0<=l?n<l:n>l;r=0<=l?++n:--n)Wd.tensor.elem[r]=rf[i+r];return Mf=i,Fh(Wd)}},rd=function(t){var e,n,i,r;for(n=0,Fd.r=qd[t-1].r,Fd.i=qd[t-1].i,r=Fd.r*Fd.r+Fd.i*Fd.i,n=e=0,i=t-1;0<=i?e<i:e>i;n=0<=i?++e:--e)qd[n].r=(qd[n].r*Fd.r+qd[n].i*Fd.i)/r,qd[n].i=(qd[n].i*Fd.r-qd[n].r*Fd.i)/r;return qd[t-1].r=1,qd[t-1].i=0},Ul=function(t){var e,n,i,r;if(r=0,Ti(qd[0])<1e-6)return Nd.r=0,void(Nd.i=0);for(e=0;e<100;++e)for(Nd.r=Si(),Nd.i=Si(),_s(t),Od.r=Nd.r,Od.i=Nd.i,Dd.r=jd.r,Dd.i=jd.i,Nd.r=Si(),Nd.i=Si(),n=0;n<1e3;++n){if(_s(t),i=Ti(jd),H&&console.log("nrabs: "+i),i<1e-9)return;if(Ti(jd)<Ti(Dd)&&(Id.r=Nd.r,Id.i=Nd.i,Nd.r=Od.r,Nd.i=Od.i,Od.r=Id.r,Od.i=Id.i,Id.r=jd.r,Id.i=jd.i,jd.r=Dd.r,jd.i=Dd.i,Dd.r=Id.r,Dd.i=Id.i),Pd.r=Od.r-Nd.r,Pd.i=Od.i-Nd.i,Cd.r=Dd.r-jd.r,Cd.i=Dd.i-jd.i,0==(r=Cd.r*Cd.r+Cd.i*Cd.i))break;Fd.r=(Pd.r*Cd.r+Pd.i*Cd.i)/r,Fd.i=(Pd.i*Cd.r-Pd.r*Cd.i)/r,Nd.r=Od.r-(Fd.r*Dd.r-Fd.i*Dd.i),Nd.i=Od.i-(Fd.r*Dd.i+Fd.i*Dd.r)}return uf("nroots: convergence error")},_s=function(t){var e,n,i,r,o;for(n=0,o=0,Id.r=Nd.r,Id.i=Nd.i,jd.r=qd[0].r+qd[1].r*Id.r-qd[1].i*Id.i,jd.i=qd[0].i+qd[1].r*Id.i+qd[1].i*Id.r,r=[],n=e=2,i=t;2<=i?e<i:e>i;n=2<=i?++e:--e)o=Nd.r*Id.r-Nd.i*Id.i,Id.i=Nd.r*Id.i+Nd.i*Id.r,Id.r=o,jd.r+=qd[n].r*Id.r-qd[n].i*Id.i,r.push(jd.i+=qd[n].r*Id.i+qd[n].i*Id.r);return r},Mi=function(t){var e,n,i,r,o,s;for(i=0,i=e=r=t-1;r<=0?e<0:e>0;i=r<=0?++e:--e)qd[i-1].r+=qd[i].r*Nd.r-qd[i].i*Nd.i,qd[i-1].i+=qd[i].i*Nd.r+qd[i].r*Nd.i;for(Ti(qd[0])>1e-6&&uf("nroots: residual error"),s=[],i=n=0,o=t-1;0<=o?n<o:n>o;i=0<=o?++n:--n)qd[i].r=qd[i+1].r,s.push(qd[i].i=qd[i+1].i);return s},Qe=function(){return Fh(Lo(Wd)),_t(),zd()},zd=function(){var t;if(t=0,gp(),Wd=uh(),zo(Wd)===gf(r)&&(Fh(Wd),ep(),Wd=uh()),zo(Wd)===gf(_i)){for(t=Mf,Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),zd(),Wd=Ko(Wd);fd(Mf-t)}else kc(Wd)?(Fh(Wd),ad()):zo(Wd)===gf(Di)&&cc(Fo(Wd))?Fh(Hd):Fh(Wd);return lp()},Je=function(){var t;for(Wd=Ko(Wd),Fh(zo(Wd)),_t(),Wd=Ko(Wd),t=[];Uu(Wd);)Fh(zo(Wd)),_t(),Vd(),t.push(Wd=Ko(Wd));return t},Vd=function(){return gp(),Qd=uh(),Wd=uh(),Nc(Wd)&&Nc(Qd)?fg():(Fh(Wd),Fh(Qd),Nc(Wd)?wf():Nc(Qd)?mp():pd()),lp()},fg=function(){var t,e,n,i,r,o,s,a,l,u,c,d,h;for(r=0,o=0,s=0,(a=Wd.tensor.ndim+Qd.tensor.ndim)>pi&&uf("outer: rank of result exceeds maximum"),l=Wd.tensor.nelem*Qd.tensor.nelem,($d=Xr(l)).tensor.ndim=a,r=t=0,u=Wd.tensor.ndim;0<=u?t<u:t>u;r=0<=u?++t:--t)$d.tensor.dim[r]=Wd.tensor.dim[r];for(o=r,r=e=0,c=Qd.tensor.ndim;0<=c?e<c:e>c;r=0<=c?++e:--e)$d.tensor.dim[o+r]=Qd.tensor.dim[r];for(s=0,r=n=0,d=Wd.tensor.nelem;0<=d?n<d:n>d;r=0<=d?++n:--n)for(o=i=0,h=Qd.tensor.nelem;0<=h?i<h:i>h;o=0<=h?++i:--i)Fh(Wd.tensor.elem[r]),Fh(Qd.tensor.elem[o]),pd(),$d.tensor.elem[s++]=uh();return Fh($d)},oh=function(){for(gp(),Qd=uh(),Wd=uh(),Bh(1),$d=uh(),Kd=$d,Wd=Ko(Wd);Uu(Wd);)Vn(zo(Wd),Qd)?(Fh(Kd),Fh(zo(Wd)),pd(),Kd=uh()):(Fh($d),Fh(zo(Wd)),pd(),$d=uh()),Wd=Ko(Wd);return Fh($d),Fh(Kd),lp()},Ze=function(){return Fh(Lo(Wd)),_t(),sh()},sh=function(){return gp(),Wd=uh(),Fh(Wd),Uc(),Fh(wu),Fh(Wd),lo(),pd(),_l(),pd(),lp()},xd=0,jl=function(){var t;return gp(),Wd=uh(),ol(Wd,0)||ol(Wd,1)||ol(Wd,-1)?(Fh(Wd),void lp()):(xd=Wd.q.a,t=Mf,ql(),Mf-t>1&&(Rc(Mf-t),Gh(_i),ff(),ws()),lp())},ql=function(){var t,e;for(e=0,xd.isNegative()&&(xd=Pp(xd,1),Bh(-1)),e=t=0;t<1e4;e=++t)if(Cf(e),0===xd.compare(1))return;return Pl()},Cf=function(t){var e,n,i,r;for(e=0,n=td(vh[t]),e=0;;){if(0===xd.compare(1))return void(e&&zh(n,e));if(i=(r=Jc(xd,n))[0],!r[1].isZero())break;e++,xd=i}if(e&&zh(n,e),-1===$c(i,n))return zh(xd,1),xd=td(1)},Pl=function(){var t,e,n,i,r,o,s;for(n=0,i=0,t=td(1),o=td(5),s=td(2),n=1,i=1;;){if(ud(xd))return zh(xd,1),0;for(;;){if(ul&&uf("esc"),r=dd(s,o),r=Pp(r,1),e=Yc(r,xd),!fi(e,1)){if(zh(e,1),0===$c(e,xd))return-1;r=Kc(xd,e),o=r=ed(o,xd=r),s=r=ed(s,xd);break}0==--n&&(s=o,n=i*=2),r=nd(o,o),o=Vc(r,t),o=r=ed(o,xd)}}},zh=function(t,e){if((Wd=new Mr).k=1,Wd.q.a=t,Wd.q.b=td(1),Fh(Wd),e>1)return Gh(Di),ff(),(Wd=new Mr).k=1,Wd.q.a=td(e),Wd.q.b=td(1),Fh(Wd),Rc(3)},Ye=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),ph()},ph=function(){return gp(),gg(),lp()},gg=function(){var t;if(t=0,Qd=uh(),Wd=uh(),kc(Wd)&&kc(Qd))return Fh(Wd),Fh(Qd),void Jh();if(pc(Wd)&&pc(Qd))return Fh(Wd),Fh(Qd),void wa();if(Nc(Wd))gh();else if(Wd!==gf(ot)||zo(Qd)!==gf(ci))if(Wd===gf(ot)&&$u(Qd))Lh(Math.exp(Qd.d));else if(rl(Wd,Hd)||Oc(Qd))Fh(Hd);else if(rl(Qd,Hd))Fh(Wd);else if(zo(Wd)!==gf(_i)){if(zo(Wd)===gf(Di))return Fh(Lo(Wd)),Fh(Fo(Wd)),Fh(Qd),pd(),void ph();if(yl&&Bu(Wd)&&pc(Qd)&&(Fh(Qd),(t=hh())>1&&2147483648!==t))fh(t);else{if(1===Of&&zo(Wd)===gf(Ji)&&Ku(Qd))return Bh(1),Fh(Lo(Wd)),Ms(),Bh(2),ph(),pf(),Fh(Qd),Hh(1,2),pd(),void ph();if(2===Of&&zo(Wd)===gf(z)&&Ku(Qd))return Bh(1),Fh(Lo(Wd)),Yp(),Bh(2),ph(),pf(),Fh(Qd),Hh(1,2),pd(),void ph();if(Vu(Wd)){if(nc(Qd))return Fh(Wd),xs(),$d=uh(),Fh($d),Fh($d),Fh(Wd),pd(),ga(),Fh(Qd),wd(),void ph();if(pc(Qd))return Fh(Wd),Uc(),Fh(Qd),ph(),Bh(-1),Fh(Wd),lo(),Fh(Qd),pd(),Fh(gf(Pi)),ga(),ph(),void pd()}if(!$p())return Gh(Di),Fh(Wd),Fh(Qd),Rc(3)}}else for(Wd=Ko(Wd),Fh(zo(Wd)),Fh(Qd),ph(),Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),Fh(Qd),ph(),pd(),Wd=Ko(Wd);else Fh(Lo(Qd))},fh=function(t){var e,n,i,r,o,s,a,l,u,c;for(e=[],o=0,s=0,a=Fc(Wd)-1,Rh(a*(t+1)),Wd=Ko(Wd),o=n=0,l=a;0<=l?n<l:n>l;o=0<=l?++n:--n){for(s=i=0,u=t;0<=u?i<=u:i>=u;s=0<=u?++i:--i)Fh(zo(Wd)),Bh(s),ph(),rf[Jl+o*(t+1)+s]=uh();Wd=Ko(Wd)}for(Bh(t),Fl(),Wd=uh(),o=r=0,c=a;0<=c?r<c:r>c;o=0<=c?++r:--r)e[o]=0;return Fh(xg),hd(a,t,e,0,t),dh(a*(t+1))},hd=function(t,e,n,i,r){var o,s,a,l,u,c,d;if(l=0,!(i<t-1)){for(n[i]=r,Fh(Wd),l=s=0,c=t;0<=c?s<c:s>c;l=0<=c?++s:--s)Bh(n[l]),Fl(),ga();for(l=a=0,d=t;0<=d?a<d:a>d;l=0<=d?++a:--a)Fh(rf[Jl+l*(e+1)+n[l]]),pd();return $r()}for(l=o=0,u=r;0<=u?o<=u:o>=u;l=0<=u?++o:--o)n[i]=l,hd(t,e,n,i+1,r-l)},$p=function(){var t;switch(t=0,t=Ac(Qd)){case 0:break;case 1:return Bh(1),1;case 2:return Bh(-1),1;case 3:return Fh(wu),1;case 4:return Fh(wu),wd(),1}if(zo(Qd)===gf(r)){for($d=Ko(Qd);Uu($d)&&!(t=Ac(zo($d)));)$d=Ko($d);switch(t){case 0:return 0;case 1:Bh(1);break;case 2:Bh(-1);break;case 3:Fh(wu);break;case 4:Fh(wu),wd()}return Fh(Qd),Fh(zo($d)),pf(),_l(),pd(),1}return 0},tn=function(){return Fh(Lo(Wd)),_t(),mh()},mh=function(){var t;return t=0,((t=hh())<1||t>1e4)&&uf("prime: Argument out of range."),t=vh[t-1],Bh(t)},df="",Eh=function(t){return df+=t},_h=function(t){return df+=t},ps=function(t){return df="",wh(t),df},Dh=function(t){return df="",wh(t),console.log(df)},xh=function(t,e){if(gp(),Wd=Lo(t),Qd=Fo(t),1!==e||oc(Qd)||_h("("),Xu(Wd)||zo(Wd)===gf(r)||zo(Wd)===gf(_i)||zo(Wd)===gf(Di)||Lc(Wd,xg)?(_h("("),wh(Wd),_h(")")):wh(Wd),!oc(Qd))return Eh("^"),Fh(Qd),wd(),Qd=uh(),Xu(Qd)||zo(Qd)===gf(r)||zo(Qd)===gf(_i)||zo(Qd)===gf(Di)?(_h("("),wh(Qd),_h(")")):wh(Qd),1===e&&_h(")"),lp();lp()},bh=function(t){var e,n;for(Kl=0,n=0,e=0,gp(),n=0,e=0,Wd=Ko(t),Qd=zo(Wd),kc(Qd)?(Fh(Qd),ad(),Vr(),$d=uh(),Fh(Qd),sd(),Kd=uh(),mc($d)||n++,mc(Kd)||e++,Wd=Ko(Wd)):($d=Hd,Kd=Hd);Uu(Wd);)Qd=zo(Wd),Lu(Qd)?e++:n++,Wd=Ko(Wd);if(0===n)_h("1");else for(Kl=0,Wd=Ko(t),kc(zo(Wd))&&(Wd=Ko(Wd)),mc($d)||(Ah($d),Kl=1);Uu(Wd);)Qd=zo(Wd),Lu(Qd)||(Kl&&Sh(),Ah(Qd),Kl=1),Wd=Ko(Wd);for(Eh(" / "),e>1&&_h("("),Kl=0,Wd=Ko(t),kc(zo(Wd))&&(Wd=Ko(Wd)),mc(Kd)||(Ah(Kd),Kl=1);Uu(Wd);)Qd=zo(Wd),Lu(Qd)&&(Kl&&Sh(),xh(Qd,e),Kl=1),Wd=Ko(Wd);return e>1&&_h(")"),lp()},wh=function(t){var e;if(Bu(t)){for(t=Ko(t),"-"===Gp(zo(t))&&Eh("-"),Ch(zo(t)),t=Ko(t),e=[];Uu(t);)"+"===Gp(zo(t))?Eh(" + "):Eh(" - "),Ch(zo(t)),e.push(t=Ko(t));return e}return"-"===Gp(t)&&Eh("-"),Ch(t)},Gp=function(t){return zo(t)===gf(_i)&&pc(Lo(t))&&Lc(Lo(t),xg)?"-":pc(t)&&Lc(t,xg)?"-":"+"},Ch=function(t){var e;if(zo(t)!==gf(_i)||!eo(t)){if(zo(t)===gf(_i)){for(t=Ko(t),oc(zo(t))&&(t=Ko(t)),Ah(zo(t)),t=Ko(t),e=[];Uu(t);)Sh(),Ah(zo(t)),e.push(t=Ko(t));return e}return Ah(t)}bh(t)},Nh=function(t){return _h("("),wh(t),_h(")")},kh=function(t){return t=Lo(t),zo(t)===gf(r)||zo(t)===gf(_i)||zo(t)===gf(Di)||zo(t)===gf(Ln)?Nh(t):wh(t),_h("!")},Oh=function(t){return qh(t,0,0)},qh=function(t,e,n){var i,r,o;for(r=0,Eh("("),r=i=0,o=t.tensor.dim[e];0<=o?i<o:i>o;r=0<=o?++i:--i)e+1===t.tensor.ndim?(wh(t.tensor.elem[n]),n++):n=qh(t,e+1,n),r+1<t.tensor.dim[e]&&Eh(",");return Eh(")"),n},Ah=function(t){if(pc(t))Mh(t);else{if(Sc(t))return Eh('"'),Eh(t.str),void Eh('"');if(Nc(t))Oh(t);else{if(Bu(t)||zo(t)===gf(_i))return Eh("("),wh(t),void Eh(")");if(zo(t)===gf(Di))return Lo(t)===gf(ot)?(Eh("exp("),wh(Fo(t)),void Eh(")")):oc(Fo(t))?(Eh("1 / "),void(Uu(Lo(t))?(Eh("("),wh(Lo(t)),Eh(")")):wh(Lo(t)))):(Bu(Lo(t))||Mo(t)===gf(_i)||Mo(t)===gf(Di)||uc(Lo(t))?(Eh("("),wh(Lo(t)),Eh(")")):pc(Lo(t))&&(Lc(Lo(t),xg)||Xu(Lo(t)))?(Eh("("),Ah(Lo(t)),Eh(")")):Ah(Lo(t)),Eh("^"),void(Uu(Fo(t))||Xu(Fo(t))||pc(Fo(t))&&Lc(Fo(t),xg)?(Eh("("),wh(Fo(t)),Eh(")")):Ah(Fo(t))));if(zo(t)===gf(Jn)&&Mc(Lo(t)))print_index_function(t);else if(zo(t)!==gf(Ln)){if(!Uu(t))return t===gf(Q)?_h("d"):t===gf(ot)?Eh("exp(1)"):t===gf(Pi)?Eh("pi"):Eh(pu(t));if(Ah(zo(t)),t=Ko(t),Eh("("),Uu(t))for(wh(zo(t)),t=Ko(t);Uu(t);)Eh(","),wh(zo(t)),t=Ko(t);Eh(")")}else kh(t)}}},yh=function(t,e){var n;switch(n=!1,null==e&&(n=!0,e=""),t.k){case 0:for(e+="(",e=yh(zo(t),e),t===Ko(t)&&console.log("oh no recursive!"),t=Ko(t);Uu(t);)e+=" ",e=yh(zo(t),e),(t=Ko(t))===Ko(t)&&console.log("oh no recursive!");t!==gf(wi)&&(e=yh(t,e+=" . ")),e+=")";break;case 3:e+=t.str;break;case 1:case 2:e=Mh(t,e);break;case 5:e+=pu(t);break;default:e+="<tensor>"}return n?console.log(e):e},Sh=function(){return Eh(" ")},Lu=function(t){return zo(t)===gf(Di)&&Lo(t)!==gf(ot)&&cc(Fo(t))?1:0},eo=function(t){var e;for(t=Ko(t);Uu(t);){if(e=zo(t),Lu(e))return 1;t=Ko(t)}return 0},en=function(){var t,e,n,i,r,o;for(e=0,Zd=Lo(Wd),Mc(Zd)||uf("product: 1st arg?"),Fh(Fo(Wd)),_t(),2147483648===(n=hh())&&uf("product: 2nd arg?"),Fh(Io(Wd)),_t(),2147483648===(i=hh())&&uf("product: 3rd arg?"),Wd=Do(Wd),Kd=cu(Zd),$d=uu(Zd),Bh(1),e=t=r=n,o=i;r<=o?t<=o:t>=o;e=r<=o?++t:--t)Bh(e),Jd=uh(),jp(Zd,Jd),Fh(Wd),_t(),pd();return Dp(Zd,Kd,$d)},Qh=function(){var t,e,n,i,r;return gp(),Qd=uh(),Wd=uh(),e=nd(Wd.q.a,Qd.q.b),i=nd(Wd.q.b,Qd.q.a),t=Vc(e,i),xi(t)?(Fh(xg),void lp()):(n=nd(Wd.q.b,Qd.q.b),r=Yc(t,n),r=Qc(r,n),(Wd=new Mr).k=1,Wd.q.a=Kc(t,r),Wd.q.b=Kc(n,r),Fh(Wd),lp())},$h=function(){var t,e,n;return gp(),Qd=uh(),Wd=uh(),xi(Qd.q.a)&&uf("divide by zero"),xi(Wd.q.a)?(Fh(xg),void lp()):(t=nd(Wd.q.a,Qd.q.b),e=nd(Wd.q.b,Qd.q.a),n=Yc(t,e),n=Qc(n,e),(Wd=new Mr).k=1,Wd.q.a=Kc(t,n),Wd.q.b=Kc(e,n),Fh(Wd),lp())},Kh=function(){var t,e,n;return gp(),Qd=uh(),Wd=uh(),xi(Wd.q.a)||xi(Qd.q.a)?(Fh(xg),void lp()):(t=nd(Wd.q.a,Qd.q.a),e=nd(Wd.q.b,Qd.q.b),n=Yc(t,e),n=Qc(n,e),(Wd=new Mr).k=1,Wd.q.a=Kc(t,n),Wd.q.b=Kc(e,n),Fh(Wd),lp())},Jh=function(){return gp(),Zh(),lp()},Zh=function(){var t,e,n,i,r,o;if(n=0,Qd=uh(),Wd=uh(),mc(Wd)||Oc(Qd))Bh(1);else{if(Oc(Wd))return uc(Qd)&&uf("divide by zero"),void Fh(xg);if(!mc(Qd))return nc(Qd)?(Fh(Qd),2147483648===(n=hh())?(Gh(Di),Fh(Wd),Fh(Qd),void Rc(3)):(r=ld(Wd.q.a,Math.abs(n)),o=ld(Wd.q.b,Math.abs(n)),n<0&&(i=r,r=Qc(r=o,o=i),o=Wc(o)),($d=new Mr).k=1,$d.q.a=r,$d.q.b=o,void Fh($d))):oc(Wd)?(Fh(Qd),void Ed()):uc(Wd)?(Fh(Wd),wd(),Fh(Qd),Jh(),Bh(-1),Fh(Qd),Jh(),void pd()):nc(Wd)?Ru(Wd)?(Fh(Wd),Fh(Qd),void Yh()):Qd.q.a.isSmall&&Qd.q.b.isSmall?(t=Qd.q.a,e=Qd.q.b,0===(r=cd(Wd.q.a,e))?(Gh(Di),Fh(Wd),Fh(Qd),void Rc(3)):(o=ld(r,t),($d=new Mr).k=1,Qd.q.a.isNegative()?($d.q.a=mo(1),$d.q.b=o):($d.q.a=o,$d.q.b=mo(1)),Fh($d))):(Gh(Di),Fh(Wd),Fh(Qd),void Rc(3)):(Fh(Wd),ad(),Fh(Qd),Jh(),Fh(Wd),sd(),Fh(Qd),wd(),Jh(),void pd());Fh(Wd)}},Ed=function(){return gp(),Wd=uh(),nc(Wd)?(Wd.q.a.isOdd()?Bh(-1):Bh(1),void lp()):(Fh(Wd),wo(),Qd=uh(),uc(Wd)&&(Fh(Qd),Bh(-1),$r(),Qd=uh()),Fh(Wd),Fh(Qd),pf(),$d=uh(),Gh(Di),Bh(-1),Fh($d),Rc(3),Qd.q.a.isOdd()&&wd(),lp())},Ru=function(t){return t.q.a.isSmall},Yh=function(){var t,e,n,i,r,o;for(n=0,gp(),Qd=uh(),Wd=uh(),e=Mf,Fh(Wd),Dl(),o=e,n=t=0,r=i=Mf-e;t<r;n=t+=2)Fh(rf[o+n]),Fh(rf[o+n+1]),Fh(Qd),pd(),Xh();return fd(Mf-e-i),Wd=uh(),Mf=e,Fh(Wd),lp()},Xh=function(){var t;return gp(),Qd=uh(),Wd=uh(),Fh(Qd),wo(),$d=uh(),Fh(Qd),Fh($d),pf(),Kd=uh(),Oc(Kd)||(Gh(Di),Fh(Wd),Fh(Kd),Rc(3)),Fh($d),2147483648===(t=hh())?(Gh(Di),Fh(Wd),Fh($d),Rc(3),void lp()):0!==t?(Fh(Wd),bo(t),lp()):void lp()},rn=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),Fh(Io(Wd)),_t(),(Wd=uh())===gf(wi)&&(Wd=gf(hr)),Fh(Wd),ba()},ba=function(){var t,e,n,i,r,o,s,a,l;for(r=0,o=0,l=0,gp(),$d=uh(),Qd=uh(),Wd=uh(),i=Mf,e=Mf,Fh(Wd),Fh($d),o=ds()-1,n=Mf,Fh(Qd),Fh($d),l=o-(s=ds()-1),Bh(0),Jd=uh();l>=0;){for(Fh(rf[e+o]),Fh(rf[n+s]),ga(),Kd=uh(),r=t=0,a=s;0<=a?t<=a:t>=a;r=0<=a?++t:--t)Fh(rf[e+l+r]),Fh(rf[n+r]),Fh(Kd),pd(),pf(),rf[e+l+r]=uh();Fh(Jd),Fh(Kd),Fh($d),Bh(l),ph(),pd(),$r(),Jd=uh(),o--,l--}return Mf=i,Fh(Jd),lp()},H=0,sn=function(){return Fh(Lo(Wd)),_t(),ep()},ep=function(){var t;return t=yl,gp(),mg(),lp(),yl=t},mg=function(){if(Wd=uh(),Nc(Wd))Gr();else{if(yl=0,zo(Wd)===gf(r)){for(H&&(printf("rationalize: this is the input expr:\n"),Dh(Wd)),Fh(Hd),md(Wd),Qd=uh(),H&&(printf("rationalize: this is the common denominator:\n"),Dh(Qd)),Fh(xg),$d=Ko(Wd);Uu($d);)Fh(Qd),Fh(zo($d)),pd(),$r(),$d=Ko($d);return H&&(printf("rationalize: original expr times common denominator:\n"),Dh(rf[Mf-1])),B(),H&&(printf("rationalize: after factoring:\n"),Dh(rf[Mf-1])),Fh(Qd),ga(),H?(printf("rationalize: after dividing by common denom. (and we're done):\n"),Dh(rf[Mf-1])):void 0}Fh(Wd)}},md=function(t){var e;if(zo(t)===gf(r)){for(t=Ko(t),e=[];Uu(t);)yd(zo(t)),e.push(t=Ko(t));return e}return yd(t)},yd=function(t){var e;if(zo(t)===gf(_i)){for(t=Ko(t),e=[];Uu(t);)vd(zo(t)),e.push(t=Ko(t));return e}return vd(t)},vd=function(t){if(zo(t)===gf(Di))return Fh(t),t=Fo(t),uc(t)?(Du(),void Lr()):zo(t)===gf(_i)&&uc(Lo(t))?(Du(),void Lr()):uh()},Gr=function(){var t,e,n;if(e=0,Fh(Wd),_t(),Wd=uh(),Nc(Wd)){for(e=t=0,n=Wd.tensor.nelem;0<=n?t<n:t>n;e=0<=n?++t:--t)Fh(Wd.tensor.elem[e]),ep(),Wd.tensor.elem[e]=uh();return Wd.tensor.nelem!==Wd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Fh(Wd)}Fh(Wd)},Lr=function(){return gp(),Wd=uh(),Qd=uh(),Fh(Wd),Fh(Qd),pd(),Fh(Wd),Fh(Qd),tu(),ga(),lp()},an=function(){return Fh(Lo(Wd)),_t(),ip()},ip=function(){return gp(),op(),Wd=uh(),Fh(Wd),Fh(Wd),xs(),$r(),Bh(2),ga(),lp()},ln=function(){return Fh(Lo(Wd)),_t(),op()},op=function(){if(gp(),Wd=uh(),zo(Wd)===gf(r))for(Bh(0),Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),op(),$r(),Wd=Ko(Wd);else Fh(Wd),Uc(),Fh(Wd),lo(),Wd=uh(),Fh(Wd),Ms(),Fh(wu),Fh(Wd),Yp(),pd(),$r(),pd();return lp()},un=function(){return Qd=Lo(Wd),zo(Qd)===gf(Wi)||zo(Qd)===gf(br)?(Fh(Lo(Qd)),_t(),Fh(Fo(Qd)),_t(),pf()):(Fh(Qd),_t(),Qd=uh(),zo(Qd)===gf(Wi)||zo(Qd)===gf(br)?(Fh(Lo(Qd)),_t(),Fh(Fo(Qd)),_t(),pf()):Fh(Qd)),Fh(Fo(Wd)),_t(),(Qd=uh())===gf(wi)?vu():Fh(Qd),Qd=uh(),Wd=uh(),vc(Wd,Qd)||uf("roots: 1st argument is not a polynomial"),Fh(Wd),Fh(Qd),dp()},yu=function(){var t,e,n,i;for(ah=Mf,Fh(Wd),Fh(Qd),n=!1,e=t=i=ds();t>0;e=t+=-1)if(Vu(rf[Mf-e])){n=!0;break}return Mf-=i,n},dp=function(){var t,e,n,i,r;if(n=0,e=Mf-2,hp(),0==(i=Mf-e)&&uf("roots: the polynomial is not factorable, try nroots"),1!==i){for(ef(i),gp(),(Wd=Xr(i)).tensor.ndim=1,Wd.tensor.dim[0]=i,n=t=0,r=i;0<=r?t<r:t>r;n=0<=r?++t:--t)Wd.tensor.elem[n]=rf[e+n];return Mf=e,Fh(Wd),lp()}},hp=function(){if(gp(),Qd=uh(),Wd=uh(),Fh(Wd),Fh(Qd),yu()?(uh(),uh()):(Ll(),Wd=uh()),zo(Wd)===gf(_i))for(Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),Fh(Qd),pp(),Wd=Ko(Wd);else Fh(Wd),Fh(Qd),pp();return lp()},pp=function(){return gp(),Qd=uh(),Wd=uh(),zo(Wd)===gf(Di)&&vc(Lo(Wd),Qd)&&xc(Fo(Wd))?(Fh(Lo(Wd)),Fh(Qd),Xc()):vc(Wd,Qd)&&(Fh(Wd),Fh(Qd),Xc()),lp()},Xc=function(){var t,e,n,i,r,o,s,a,l,u,c,d,h,p,f,g,m,v,y,b,_,x,w,A,k,T,S,M,E,N,O,q,C,P,j;if(gp(),Qd=uh(),Wd=uh(),Fh(Wd),Fh(Qd),2===(q=ds()))return $d=uh(),Kd=uh(),Fh(Kd),Fh($d),ga(),wd(),void lp();if(3===q)return $d=uh(),Kd=uh(),Jd=uh(),Fh(Kd),Fh(Kd),pd(),Bh(4),Fh($d),pd(),Fh(Jd),pd(),pf(),Hh(1,2),ph(),Zd=uh(),Fh(Zd),Fh(Kd),pf(),Fh($d),ga(),Hh(1,2),pd(),Fh(Zd),Fh(Kd),$r(),wd(),Fh($d),ga(),Hh(1,2),pd(),void lp();if(4===q){if($d=uh(),Kd=uh(),Jd=uh(),Zd=uh(),Fh(Jd),Fh(Jd),pd(),x=uh(),Fh(x),Fh(Jd),pd(),w=uh(),Fh(Kd),Fh(Kd),pd(),y=uh(),Fh(y),Fh(Kd),pd(),_=uh(),Fh(_),Fh(Zd),Bh(-4),pd(),pd(),S=uh(),Fh(_),Bh(2),pd(),i=uh(),Bh(3),Fh($d),pd(),r=uh(),Fh(r),Bh(9),pd(),Fh($d),pd(),Fh(Zd),pd(),n=uh(),Fh(n),Fh(Zd),pd(),wd(),k=uh(),Fh(r),Bh(2),pd(),uh(),Fh($d),Fh(Jd),pd(),v=uh(),Fh(v),Fh(Kd),pd(),m=uh(),Fh(v),Bh(3),pd(),s=uh(),Bh(-4),Fh($d),Fh(w),pd(),pd(),T=uh(),Fh(m),Bh(9),pd(),wd(),M=uh(),Fh(M),Fh(Zd),Bh(-2),pd(),pd(),e=uh(),Fh(y),Fh(s),pf(),h=uh(),Fh(y),Fh(x),pd(),b=uh(),Fh(h),Bh(3),ph(),Bh(4),pd(),a=uh(),Fh(h),Wp(),_t(),og(),_t(),Vr(),p=uh(),Fh(e),Fh(S),Fh(b),Fh(T),Fh(k),$r(),$r(),$r(),$r(),Wp(),_t(),og(),_t(),Vr(),A=uh(),Fh(i),Fh(M),Fh(n),$r(),$r(),f=uh(),Fh(f),Bh(2),ph(),Fh(a),pf(),Hh(1,2),ph(),g=uh(),Fh(Kd),wd(),Fh(r),ga(),E=uh(),Oc(A))return Oc(p)?(Fh(E),void lp()):(Fh($d),Fh(Zd),Bh(9),pd(),pd(),Fh(Kd),Fh(Jd),pd(),pf(),Fh(h),Bh(2),pd(),ga(),j=uh(),Fh(j),Fh(j),Fh(m),Bh(4),pd(),Fh($d),Fh($d),Fh(Zd),Bh(9),pd(),pd(),pd(),wd(),Fh(_),wd(),$r(),$r(),Fh($d),Fh(h),pd(),ga(),void lp());for(t=!1,N=!1;!t;)Fh(g),N&&wd(),Fh(f),$r(),Hh(1,2),pd(),Hh(1,3),ph(),u=uh(),Fh(u),Wp(),_t(),og(),_t(),Vr(),d=uh(),Oc(d)?N=!0:t=!0;return Fh(u),Fh(r),pd(),o=uh(),Fh(o),Bh(2),pd(),l=uh(),Fh(wu),Bh(3),Hh(1,2),ph(),pd(),O=uh(),Bh(1),Fh(O),$r(),P=uh(),Bh(1),Fh(O),pf(),C=uh(),Fh(u),Fh(r),ga(),c=uh(),Fh(E),Fh(c),wd(),Fh(h),Fh(o),ga(),wd(),$r(),$r(),Wp(),Fh(E),Fh(c),Fh(P),pd(),Bh(2),ga(),Fh(C),Fh(h),pd(),Fh(l),ga(),$r(),$r(),Wp(),Fh(E),Fh(c),Fh(C),pd(),Bh(2),ga(),Fh(P),Fh(h),pd(),Fh(l),ga(),$r(),$r(),Wp(),void lp()}return Mf-=q,lp()},Af="",Sd=0,Zc=0,Nu=0,Sp=0,Tf=0,kf=0,qp="",vp=function(t){return H&&console.log("#### scanning "+t),qp=t,Zc=0,yl++,Nu=0,Sp=0,hu(),""===Af?(Fh(gf(wi)),yl--,0):(Tp(),yl--,Tf-Nu)},wp=function(t){return qp=t,Zc=1,yl++,Nu=0,Sp=0,hu(),""===Af?(Fh(gf(wi)),yl--,0):(Tp(),yl--,Tf-Nu)},Tp=function(){if(kp(),"="===Af)return hu(),Gh(Wi),ff(),kp(),Rc(3)},kp=function(){switch(bp(),Af){case 1010:return Gh(br),ff(),hu(),bp(),Rc(3);case 1009:return Gh(wr),ff(),hu(),bp(),Rc(3);case 1008:return Gh(_r),ff(),hu(),bp(),Rc(3);case"<":return Gh(Ar),ff(),hu(),bp(),Rc(3);case">":return Gh(xr),ff(),hu(),bp(),Rc(3)}},bp=function(){var t;switch(t=Mf,Af){case"+":hu(),Op();break;case"-":hu(),Op(),wd();break;default:Op()}for(;0===Sd&&("+"===Af||"-"===Af);)"+"===Af?(hu(),Op()):(hu(),Op(),wd());if(Mf-t>1)return Rc(Mf-t),Gh(r),ff(),ws()},zu=function(){switch(Af){case"*":case"/":return 1;case"(":case 1003:case 1004:case 1001:case 1002:case 1007:return Sd?(Sp=Tf,0):1}return 0},Op=function(){var t;for(t=Mf,Ap(),Mf>t&&kc(rf[Mf-1])&&ol(rf[Mf-1],1)&&uh();zu();)"*"===Af?(hu(),Ap()):"/"===Af?(hu(),Ap(),Du()):Ap(),Mf>t+1&&pc(rf[Mf-2])&&pc(rf[Mf-1])&&pd(),Mf>t&&kc(rf[Mf-1])&&ol(rf[Mf-1],1)&&uh();return t===Mf?Bh(1):Mf-t>1?(Rc(Mf-t),Gh(_i),ff(),ws()):void 0},Ap=function(){if(_p(),"^"===Af)return hu(),Gh(Di),ff(),Ap(),Rc(3)},_p=function(){var t,e;if(t=Mf,"("===Af?Ep():1003===Af?Np():1004===Af?xp():1001===Af?(xo(kf),hu()):1002===Af?(_o(kf),hu()):1007===Af?Mp():yp("syntax error"),"["===Af){for(hu(),Gh(Jn),ff(),bp();","===Af;)hu(),bp();"]"!==Af&&yp("] expected"),hu(),Rc(Mf-t)}for(e=[];"!"===Af;)hu(),Gh(Ln),ff(),e.push(Rc(2));return e},Np=function(){if(1003!==Af&&yp("symbol expected"),Zc&&1===kf.length)switch(kf[0]){case"a":Fh(gf(gi));break;case"b":Fh(gf(mi));break;case"x":Fh(gf(vi));break;default:Fh(Df(kf))}else Fh(Df(kf));return hu()},Mp=function(){return Td(kf),hu()},xp=function(){var t,e;if(t=1,new Mr,e=Df(kf),Fh(e),hu(),hu(),")"!==Af)for(Tp(),t++;","===Af;)hu(),Tp(),t++;return")"!==Af&&yp(") expected"),hu(),Rc(t)},Ep=function(){var t;if(t=0,"("!==Af&&yp("( expected"),hu(),Tp(),","===Af){for(t=1;","===Af;)hu(),Tp(),t++;To(t)}return")"!==Af&&yp(") expected"),hu()},yp=function(t){for(ll="";Nu!==Sp&&("\n"!==qp[Nu]&&"\r"!==qp[Nu]||Nu+1!==Sp);)ll+=qp[Nu++];for(ll+=" ? ";qp[Nu]&&"\n"!==qp[Nu]&&"\r"!==qp[Nu];)ll+=qp[Nu++];return ll+="\n",uf(t)},To=function(t){var e,n,i;for(n=0,gp(),(Qd=Xr(t)).tensor.ndim=1,Qd.tensor.dim[0]=t,n=e=0,i=t;0<=i?e<i:e>i;n=0<=i?++e:--e)Qd.tensor.elem[n]=rf[Mf-t+n];return Qd.tensor.nelem!==Qd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Mf-=t,Fh(Qd),lp()},hu=function(){for(Sd=0;gu(),1006===Af;)Sd=1;if(H)return console.log("get_next_token token: "+Af)},gu=function(){for(;Tc(qp[Sp]);){if("\n"===qp[Sp]||"\r"===qp[Sp])return Af=1006,void Sp++;Sp++}if(Tf=Sp,Sp!==qp.length){if(!Qu(qp[Sp])&&"."!==qp[Sp]){if(Gu(qp[Sp])){for(;Hu(qp[Sp]);)Sp++;return Af="("===qp[Sp]?1004:1003,void jf(Tf,Sp)}if('"'===qp[Sp]){for(Sp++;'"'!==qp[Sp];)Sp!==qp.length&&"\n"!==qp[Sp]&&"\r"!==qp[Sp]||yp("runaway string"),Sp++;return Af=1007,void jf(Tf+1,++Sp-1)}if("#"===qp[Sp]||"-"===qp[Sp]&&"-"===qp[Sp+1]){for(;qp[Sp]&&"\n"!==qp[Sp]&&"\r"!==qp[Sp];)Sp++;return qp[Sp]&&Sp++,void(Af=1006)}return"="===qp[Sp]&&"="===qp[Sp+1]?(Sp+=2,void(Af=1010)):"<"===qp[Sp]&&"="===qp[Sp+1]?(Sp+=2,void(Af=1009)):">"===qp[Sp]&&"="===qp[Sp+1]?(Sp+=2,void(Af=1008)):Af=qp[Sp++]}for(;Qu(qp[Sp]);)Sp++;if("."===qp[Sp]){for(Sp++;Qu(qp[Sp]);)Sp++;if("e"===qp[Sp]&&("+"===qp[Sp+1]||"-"===qp[Sp+1]||Qu(qp[Sp+1])))for(Sp+=2;Qu(qp[Sp]);)Sp++;Af=1002}else Af=1001;jf(Tf,Sp)}else Af=""},jf=function(t,e){return kf=qp.substring(t,e)},t.scan=vp,dn=function(){return Fh(Lo(Wd)),_t(),Rp()},Rp=function(){return gp(),vg(),lp()},vg=function(){return Wd=uh(),$u(Wd)?Wd.d>0?void Bh(1):0===Wd.d?void Bh(1):void Bh(-1):kc(Wd)?-1===bi(nd(Wd.q.a,Wd.q.b))?void Bh(-1):xi(nd(Wd.q.a,Wd.q.b))?void Bh(0):void Bh(1):Vu(Wd)?(Bh(-1),Fh(Wd),Vr(),ph(),Fh(Wd),void pd()):cc(Wd)?(Gh(Qi),Fh(Wd),wd(),Rc(2),Bh(-1),void pd()):(Gh(Qi),Fh(Wd),Rc(2))},hn=function(){return Fh(Lo(Wd)),_t(),Bp()},Bp=function(){var t,e,n,i,r,o,s,a;for(r=0,n=[],i=[],r=t=0,s=pi;0<=s?t<s:t>s;r=0<=s?++t:--t)n[r]=0,i[r]=0;if(gp(),Wd=uh(),!Nc(Wd))return Oc(Wd)||uf("transpose: tensor expected, 1st arg is not a tensor"),Fh(xg),void lp();for(o=Wd.tensor.ndim,(Qd=Xr(o)).tensor.ndim=1,Qd.tensor.dim[0]=o,r=e=0,a=o;0<=a?e<a:e>a;r=0<=a?++e:--e)Bh(Wd.tensor.dim[r]),Qd.tensor.elem[r]=uh();return Fh(Qd),lp()},Vp=function(){var t;if(t=0,gp(),Wd=uh(),zo(Wd)===gf(r)){for(t=Mf,Wd=Ko(Wd);Wd!==gf(wi);)Fh(zo(Wd)),Up(),Wd=Ko(Wd);Kr(Mf-t)}else Fh(Wd),Up();return lp()},Up=function(){var t;if(gp(),Wd=uh(),zo(Wd)!==gf(_i))return Fh(Wd),void lp();for(t=Mf,Wd=Ko(Wd);Wd!==gf(wi);)Fh(zo(Wd)),Wd=Ko(Wd);for(;yg(t););return gd(Mf-t),lp()},yg=function(t){var e,n,i,r,o,s,a,l;for(i=0,r=0,i=e=o=t,s=Mf;o<=s?e<s:e>s;i=o<=s?++e:--e)for(Wd=rf[i],r=n=a=t,l=Mf;a<=l?n<l:n>l;r=a<=l?++n:--n)if(i!==r){if(Qd=rf[r],zo(Wd)===gf(Ln)&&zo(Qd)===gf(Di)&&oc(Fo(Qd))&&rl(Lo(Wd),Lo(Qd)))return Fh(Lo(Wd)),Fh(Hd),pf(),Fl(),rf[i]=uh(),rf[r]=Hd,1;if(zo(Qd)===gf(Di)&&oc(Fo(Qd))&&Mo(Qd)===gf(Ln)&&rl(Wd,Oo(Qd)))return Fh(Wd),Bh(-1),$r(),Fl(),rp(),rf[i]=uh(),rf[r]=Hd,1;if(zo(Qd)===gf(Ln)&&(Fh(Wd),Fh(Lo(Qd)),pf(),$d=uh(),mc($d)))return Fh(Wd),Fl(),rf[i]=uh(),rf[r]=Hd,1;if(zo(Wd)===gf(Di)&&oc(Fo(Wd))&&zo(Qd)===gf(Di)&&oc(Fo(Qd))&&Mo(Qd)===gf(Ln)&&(Fh(Lo(Wd)),Fh(Lo(Lo(Qd))),pf(),$d=uh(),mc($d)))return Fh(Lo(Wd)),Fl(),rp(),rf[i]=uh(),rf[r]=Hd,1;if(zo(Wd)===gf(Ln)&&zo(Qd)===gf(Di)&&oc(Fo(Qd))&&Mo(Qd)===gf(Ln)){if(Fh(Lo(Wd)),Fh(Lo(Lo(Qd))),pf(),$d=uh(),mc($d))return rf[i]=Lo(Wd),rf[r]=Hd,1;if(oc($d))return Fh(Lo(Lo(Qd))),rp(),rf[i]=uh(),rf[r]=Hd,1;if(ol($d,2))return rf[i]=Lo(Wd),Fh(Lo(Wd)),Bh(-1),$r(),rf[r]=uh(),1;if(ol($d,-2))return Fh(Lo(Lo(Qd))),rp(),rf[i]=uh(),Fh(Lo(Lo(Qd))),Bh(-1),$r(),rp(),rf[r]=uh(),1}}return 0},pn=function(){return Fh(Lo(Wd)),_t(),Wp()},Wp=function(){return gp(),Qp(),lp()},Qp=function(){if(Wd=uh(),!Nc(Wd))return Vn(Wd,gf(Ln))&&(Fh(Wd),Vp(),Qd=uh(),Fh(Wd),ep(),Vp(),$d=uh(),Wd=Os(Qd)<Os($d)?Qd:$d),Al(),kl(),Tl(),Sl(),Ml(),El(),Fh(Wd);Kp()},Kp=function(){var t,e,n,i,r;for(n=0,(Qd=Xr(Wd.tensor.nelem)).tensor.ndim=Wd.tensor.ndim,n=t=0,i=Wd.tensor.ndim;0<=i?t<i:t>i;n=0<=i?++t:--t)Qd.tensor.dim[n]=Wd.tensor.dim[n];for(n=e=0,r=Wd.tensor.nelem;0<=r?e<r:e>r;n=0<=r?++e:--e)Fh(Wd.tensor.elem[n]),Wp(),Qd.tensor.elem[n]=uh();return Qd.tensor.nelem!==Qd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Oc(Qd)&&(Qd=xg),Fh(Qd)},Os=function(t){var e;if(Uu(t))for(e=0;Uu(t);)e+=Os(zo(t))+1,t=Ko(t);else e=1;return e},Al=function(){if(zo(Wd)===gf(r))return Fh(Wd),ep(),Qd=uh(),Os(Qd)<Os(Wd)?Wd=Qd:void 0},kl=function(){if(zo(Wd)===gf(r))return Fh(Wd),B(),Qd=uh(),Os(Qd)<=Os(Wd)?Wd=Qd:void 0},Tl=function(){if(Fh(Wd),ep(),wd(),ep(),wd(),ep(),Qd=uh(),Os(Qd)<Os(Wd))return Wd=Qd},Sl=function(){if(!Oc(Wd))return Fh(Wd),ep(),Du(),ep(),Du(),ep(),Qd=uh(),Os(Qd)<Os(Wd)?Wd=Qd:void 0},Jp=function(){return gp(),Wd=uh(),Ml(),Fh(Wd),lp()},Ml=function(){if(0!==Vn(Wd,gf(Ji))||0!==Vn(Wd,gf(z)))return Of=1,Fh(Qd=Wd),_t(),$d=uh(),Of=2,Fh(Qd),_t(),Kd=uh(),Of=0,(Os(Kd)<Os($d)||Ld(Kd)<Ld($d))&&($d=Kd),Os($d)<Os(Wd)||Ld($d)<Ld(Wd)?Wd=$d:void 0},El=function(){if(zo(Wd)===gf(r)){for(Bh(0),Qd=Ko(Wd);Uu(Qd);)Fh(zo(Qd)),Wp(),$r(),Qd=Ko(Qd);return Qd=uh(),Os(Qd)<Os(Wd)?Wd=Qd:void 0}},Ld=function(t){return zo(t)!==gf(r)?1:Fc(t)-1},fn=function(){return Fh(Lo(Wd)),_t(),Yp()},Yp=function(){return gp(),Wd=uh(),zo(Wd)===gf(r)?tf():Xp(),lp()},tf=function(){for(Qd=Ko(Wd);Uu(Qd);){if(Kd=zo(Qd),hc(Kd))return Fh(Wd),Fh(Kd),pf(),$d=uh(),Fh($d),Yp(),Fh(Kd),Ms(),pd(),Fh($d),Ms(),Fh(Kd),Yp(),pd(),void $r();Qd=Ko(Qd)}return Xp()},Xp=function(){var t,e;if(zo(Wd)!==gf(u)){if($u(Wd))return t=Math.sin(Wd.d),Math.abs(t)<1e-10&&(t=0),void Lh(t);if(lc(Wd))return Fh(Wd),wd(),Yp(),void wd();if(zo(Wd)===gf(d))return Fh(Lo(Wd)),Bh(1),Fh(Lo(Wd)),Bh(2),ph(),$r(),Hh(-1,2),ph(),void pd();if(Fh(Wd),Bh(180),pd(),Gh(Pi),ga(),(e=hh())<0||2147483648===e)return Fh(gf(Ji)),Fh(Wd),void Rc(2);switch(e%360){case 0:case 180:return Bh(0);case 30:case 150:return Hh(1,2);case 210:case 330:return Hh(-1,2);case 45:case 135:return Hh(1,2),Bh(2),Hh(1,2),ph(),pd();case 225:case 315:return Hh(-1,2),Bh(2),Hh(1,2),ph(),pd();case 60:case 120:return Hh(1,2),Bh(3),Hh(1,2),ph(),pd();case 240:case 300:return Hh(-1,2),Bh(3),Hh(1,2),ph(),pd();case 90:return Bh(1);case 270:return Bh(-1);default:return Fh(gf(Ji)),Fh(Wd),Rc(2)}}else Fh(Lo(Wd))},gn=function(){return Fh(Lo(Wd)),_t(),Vf()},Vf=function(){return gp(),bg(),lp()},bg=function(){var t;if(t=0,Wd=uh(),zo(Wd)!==gf(c)){if($u(Wd))return t=Math.sinh(Wd.d),Math.abs(t)<1e-10&&(t=0),void Lh(t);if(!Oc(Wd))return Gh(Zi),Fh(Wd),Rc(2);Fh(xg)}else Fh(Lo(Wd))},hf=function(){var t,e,n,i,r;if(n=0,gp(),$d=uh(),(Qd=uh())!==gf(wi)&&$d!==gf(wi)){if(Wd=uh(),Nc(Wd)){for((Kd=Xr(Wd.tensor.nelem)).tensor.ndim=Wd.tensor.ndim,n=t=0,i=Wd.tensor.ndim;0<=i?t<i:t>i;n=0<=i?++t:--t)Kd.tensor.dim[n]=Wd.tensor.dim[n];for(n=e=0,r=Wd.tensor.nelem;0<=r?e<r:e>r;n=0<=r?++e:--e)Fh(Wd.tensor.elem[n]),Fh(Qd),Fh($d),hf(),Kd.tensor.elem[n]=uh(),Kd.tensor.nelem!==Kd.tensor.elem.length&&console.log("something wrong in tensor dimensions");Fh(Kd)}else rl(Wd,Qd)?Fh($d):Uu(Wd)?(Fh(zo(Wd)),Fh(Qd),Fh($d),hf(),Fh(Ko(Wd)),Fh(Qd),Fh($d),hf(),ws()):Fh(Wd);return lp()}lp()},xn=function(){return Fh(Lo(Wd)),_t(),yf()},yf=function(){return gp(),_g(),lp()},_g=function(){var t,e;if(t=0,Wd=uh(),zo(Wd)!==gf(d)){if($u(Wd))return t=Math.tan(Wd.d),Math.abs(t)<1e-10&&(t=0),void Lh(t);if(lc(Wd))return Fh(Wd),wd(),yf(),void wd();if(Fh(Wd),Bh(180),pd(),Gh(Pi),ga(),(e=hh())<0||2147483648===e)return Fh(gf(gr)),Fh(Wd),void Rc(2);switch(e%360){case 0:case 180:return Bh(0);case 30:case 210:return Hh(1,3),Bh(3),Hh(1,2),ph(),pd();case 150:case 330:return Hh(-1,3),Bh(3),Hh(1,2),ph(),pd();case 45:case 225:return Bh(1);case 135:case 315:return Bh(-1);case 60:case 240:return Bh(3),Hh(1,2),ph();case 120:case 300:return Bh(3),Hh(1,2),ph(),wd();default:return Fh(gf(gr)),Fh(Wd),Rc(2)}}else Fh(Lo(Wd))},wn=function(){var t;if(t=0,Fh(Lo(Wd)),_t(),Wd=uh(),zo(Wd)!==gf(h)){if($u(Wd))return t=Math.tanh(Wd.d),Math.abs(t)<1e-10&&(t=0),void Lh(t);if(!Oc(Wd))return Gh(mr),Fh(Wd),Rc(2);Fh(xg)}else Fh(Lo(Wd))},An=function(){return Wd=Ko(Wd),Fh(zo(Wd)),_t(),Wd=Ko(Wd),Fh(zo(Wd)),_t(),(Qd=uh())===gf(wi)?vu():Fh(Qd),Wd=Ko(Wd),Fh(zo(Wd)),_t(),(Qd=uh())===gf(wi)?Bh(24):Fh(Qd),Wd=Ko(Wd),Fh(zo(Wd)),_t(),(Qd=uh())===gf(wi)?Bh(0):Fh(Qd),bf()},bf=function(){var t,e,n,i;if(e=0,gp(),Kd=uh(),$d=uh(),Qd=uh(),Wd=uh(),Fh($d),2147483648===(n=hh()))return Gh(vr),Fh(Wd),Fh(Qd),Fh($d),Fh(Kd),Rc(5),void lp();for(Fh(Wd),Fh(Qd),Fh(Kd),hf(),_t(),Bh(1),Jd=uh(),e=t=1,i=n;(1<=i?t<=i:t>=i)&&(Fh(Wd),Fh(Qd),la(),Wd=uh(),!Oc(Wd));e=1<=i?++t:--t)Fh(Jd),Fh(Qd),Fh(Kd),pf(),pd(),Jd=uh(),Fh(Wd),Fh(Qd),Fh(Kd),hf(),_t(),Fh(Jd),pd(),Bh(e),Fl(),ga(),$r();return lp()},kn=function(){var t,e,n,i,r,o,s,a,l;for(r=0,Wd.tensor.nelem!==Wd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),s=Wd.tensor.nelem,o=Wd.tensor.ndim,(Qd=Xr(s)).tensor.ndim=o,r=e=0,a=o;0<=a?e<a:e>a;r=0<=a?++e:--e)Qd.tensor.dim[r]=Wd.tensor.dim[r];for(t=Wd.tensor.elem,i=Qd.tensor.elem,Qd.tensor.nelem!==Qd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),r=n=0,l=s;0<=l?n<l:n>l;r=0<=l?++n:--n)Fh(t[r]),_t(),i[r]=uh();return Wd.tensor.nelem!==Wd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Qd.tensor.nelem!==Qd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Fh(Qd),Ih()},xf=function(){var t,e,n,i,r,o,s,a,l,u,c,d;if(s=0,gp(),Qd=uh(),(a=(Wd=uh()).tensor.ndim)!==Qd.tensor.ndim)return Fh(gf(wi)),void lp();for(s=e=0,u=a;0<=u?e<u:e>u;s=0<=u?++e:--e)if(Wd.tensor.dim[s]!==Qd.tensor.dim[s])return Fh(gf(wi)),void lp();for(l=Wd.tensor.nelem,($d=Xr(l)).tensor.ndim=a,s=n=0,c=a;0<=c?n<c:n>c;s=0<=c?++n:--n)$d.tensor.dim[s]=Wd.tensor.dim[s];for(t=Wd.tensor.elem,r=Qd.tensor.elem,o=$d.tensor.elem,s=i=0,d=l;0<=d?i<d:i>d;s=0<=d?++i:--i)Fh(t[s]),Fh(r[s]),$r(),o[s]=uh();return Fh($d),lp()},wf=function(){var t,e,n,i,r,o,s,a,l;for(r=0,gp(),Qd=uh(),o=(Wd=uh()).tensor.ndim,s=Wd.tensor.nelem,($d=Xr(s)).tensor.ndim=o,r=e=0,a=o;0<=a?e<a:e>a;r=0<=a?++e:--e)$d.tensor.dim[r]=Wd.tensor.dim[r];for(t=Wd.tensor.elem,i=$d.tensor.elem,r=n=0,l=s;0<=l?n<l:n>l;r=0<=l?++n:--n)Fh(t[r]),Fh(Qd),pd(),i[r]=uh();return Fh($d),lp()},mp=function(){var t,e,n,i,r,o,s,a,l;for(r=0,gp(),Qd=uh(),Wd=uh(),o=Qd.tensor.ndim,s=Qd.tensor.nelem,($d=Xr(s)).tensor.ndim=o,r=e=0,a=o;0<=a?e<a:e>a;r=0<=a?++e:--e)$d.tensor.dim[r]=Qd.tensor.dim[r];for(t=Qd.tensor.elem,i=$d.tensor.elem,r=n=0,l=s;0<=l?n<l:n>l;r=0<=l?++n:--n)Fh(Wd),Fh(t[r]),pd(),i[r]=uh();return Fh($d),lp()},Fs=function(){var t,e,n,i,r,o,s,a,l,u,c,d,h;if(s=0,a=0,l=Wd.tensor.ndim,u=Wd.tensor.nelem,l+1>=pi)return Gh(Q),Fh(Wd),Fh(Qd),void Rc(3);for(($d=Xr(u*Qd.tensor.nelem)).tensor.ndim=l+1,s=e=0,c=l;0<=c?e<c:e>c;s=0<=c?++e:--e)$d.tensor.dim[s]=Wd.tensor.dim[s];for($d.tensor.dim[l]=Qd.tensor.dim[0],t=Wd.tensor.elem,r=Qd.tensor.elem,o=$d.tensor.elem,s=n=0,d=u;0<=d?n<d:n>d;s=0<=d?++n:--n)for(a=i=0,h=Qd.tensor.nelem;0<=h?i<h:i>h;a=0<=h?++i:--i)Fh(t[s]),Fh(r[a]),la(),o[s*Qd.tensor.nelem+a]=uh();return Fh($d)},Ds=function(){var t,e,n,i,r;for(($d=Xr(Qd.tensor.nelem)).tensor.ndim=1,$d.tensor.dim[0]=Qd.tensor.dim[0],t=Qd.tensor.elem,n=$d.tensor.elem,i=e=0,r=Qd.tensor.nelem;0<=r?e<r:e>r;i=0<=r?++e:--e)Fh(Wd),Fh(t[i]),la(),n[i]=uh();return Fh($d)},Is=function(){var t,e,n,i,r,o,s;for(r=0,($d=Xr(Wd.tensor.nelem)).tensor.ndim=Wd.tensor.ndim,r=e=0,o=Wd.tensor.ndim;0<=o?e<o:e>o;r=0<=o?++e:--e)$d.tensor.dim[r]=Wd.tensor.dim[r];for(t=Wd.tensor.elem,i=$d.tensor.elem,r=n=0,s=Wd.tensor.nelem;0<=s?n<s:n>s;r=0<=s?++n:--n)Fh(t[r]),Fh(Qd),la(),i[r]=uh();return Fh($d)},ys=function(t,e){var n,i,r,o,s;if(r=0,t.tensor.ndim<e.tensor.ndim)return-1;if(t.tensor.ndim>e.tensor.ndim)return 1;for(r=n=0,o=t.tensor.ndim;0<=o?n<o:n>o;r=0<=o?++n:--n){if(t.tensor.dim[r]<e.tensor.dim[r])return-1;if(t.tensor.dim[r]>e.tensor.dim[r])return 1}for(r=i=0,s=t.tensor.nelem;0<=s?i<s:i>s;r=0<=s?++i:--i)if(!rl(t.tensor.elem[r],e.tensor.elem[r]))return Lc(t.tensor.elem[r],e.tensor.elem[r])?-1:1;return 0},gh=function(){var t,e,n,i,r,o,s,a;if(n=0,r=0,i=Wd.tensor.ndim-1,Wd.tensor.dim[0]!==Wd.tensor.dim[i])return Gh(Di),Fh(Wd),Fh(Qd),void Rc(3);if(Fh(Qd),2147483648===(r=hh()))return Gh(Di),Fh(Wd),Fh(Qd),void Rc(3);if(0===r){for(2!==Wd.tensor.ndim&&uf("power(tensor,0) with tensor rank not equal to 2"),r=Wd.tensor.dim[0],(Wd=Xr(r*r)).tensor.ndim=2,Wd.tensor.dim[0]=r,Wd.tensor.dim[1]=r,n=t=0,o=r;0<=o?t<o:t>o;n=0<=o?++t:--t)Wd.tensor.elem[r*n+n]=Hd;return Wd.tensor.nelem!==Wd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),void Fh(Wd)}for(r<0&&(r=-r,Fh(Wd),ju(),Wd=uh()),Fh(Wd),a=[],n=e=1,s=r;(1<=s?e<s:e>s)&&(Fh(Wd),Mu(),!Oc(rf[Mf-1]));n=1<=s?++e:--e)a.push(void 0);return a},Ss=function(){var t,e,n,i,r;for(n=0,gp(),Wd=uh(),(Qd=Xr(Wd.tensor.nelem)).tensor.ndim=Wd.tensor.ndim,n=t=0,i=Wd.tensor.ndim;0<=i?t<i:t>i;n=0<=i?++t:--t)Qd.tensor.dim[n]=Wd.tensor.dim[n];for(n=e=0,r=Wd.tensor.nelem;0<=r?e<r:e>r;n=0<=r?++e:--e)Qd.tensor.elem[n]=Wd.tensor.elem[n];return Wd.tensor.nelem!==Wd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Qd.tensor.nelem!==Qd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Fh(Qd),lp()},Ih=function(){var t,e,n,i,r,o,s,a,l,u,c,d,h,p,f;if(o=0,s=0,a=0,gp(),Wd=uh(),!Nc(Wd))return Fh(Wd),void lp();for(Qd=Wd.tensor.elem[0],o=t=1,c=Wd.tensor.nelem;1<=c?t<c:t>c;o=1<=c?++t:--t)bs(Qd,Wd.tensor.elem[o])||uf("Cannot promote tensor due to inconsistent tensor components.");if(!Nc(Qd))return Fh(Wd),void lp();for((l=Wd.tensor.ndim+Qd.tensor.ndim)>pi&&uf("tensor rank > 24"),u=Wd.tensor.nelem*Qd.tensor.nelem,($d=Xr(u)).tensor.ndim=l,o=e=0,d=Wd.tensor.ndim;0<=d?e<d:e>d;o=0<=d?++e:--e)$d.tensor.dim[o]=Wd.tensor.dim[o];for(s=n=0,h=Qd.tensor.ndim;0<=h?n<h:n>h;s=0<=h?++n:--n)$d.tensor.dim[o+s]=Qd.tensor.dim[s];for(a=0,o=i=0,p=Wd.tensor.nelem;0<=p?i<p:i>p;o=0<=p?++i:--i)for(s=r=0,f=(Qd=Wd.tensor.elem[o]).tensor.nelem;0<=f?r<f:r>f;s=0<=f?++r:--r)$d.tensor.elem[a++]=Qd.tensor.elem[s];return Qd.tensor.nelem!==Qd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),$d.tensor.nelem!==$d.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Fh($d),lp()},bs=function(t,e){var n,i,r;if(!Nc(t)&&!Nc(e))return 1;if(!Nc(t)||!Nc(e))return 0;if(t.tensor.ndim!==e.tensor.ndim)return 0;for(i=n=0,r=t.tensor.ndim;0<=r?n<r:n>r;i=0<=r?++n:--n)if(t.tensor.dim[i]!==e.tensor.dim[i])return 0;return 1},Tn=function(){for(Wd=Ko(Wd);Uu(Wd);){if(Ko(Wd)===gf(wi))return Fh(zo(Wd)),void _t();if(Fh(zo(Wd)),Xe(),Qd=uh(),!Oc(Qd))return Fh(Lo(Wd)),void _t();Wd=$o(Wd)}return Bh(0)},Sn=function(){return Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),pf(),Wd=uh(),Oc(Wd)?Bh(1):Bh(0)},Mn=function(){return ls()>=0?Bh(1):Bh(0)},En=function(){return ls()>0?Bh(1):Bh(0)},Nn=function(){return ls()<=0?Bh(1):Bh(0)},On=function(){return ls()<0?Bh(1):Bh(0)},Ve=function(){return Fh(Lo(Wd)),Xe(),Wd=uh(),Oc(Wd)?Bh(1):Bh(0)},Tt=function(){for(Wd=Ko(Wd);Uu(Wd);){if(Fh(zo(Wd)),Xe(),Qd=uh(),Oc(Qd))return void Bh(0);Wd=Ko(Wd)}return Bh(1)},Ke=function(){for(Wd=Ko(Wd);Uu(Wd);){if(Fh(zo(Wd)),Xe(),Qd=uh(),!Oc(Qd))return void Bh(1);Wd=Ko(Wd)}return Bh(0)},ls=function(){var t;if(t=0,Fh(Lo(Wd)),_t(),Fh(Fo(Wd)),_t(),pf(),1!==(Wd=uh()).k&&2!==Wd.k&&(Fh(Wd),og(),_t(),Wd=uh()),Oc(Wd))return 0;switch(Wd.k){case 1:t=-1===bi(Wd.q.a)?-1:1;break;case 2:t=Wd.d<0?-1:1;break;default:uf("relational operator: cannot determine due to non-numerical comparison"),t=0}return t},Ef=function(t){var e,n,i,r;for(gp(),Kd=uh(),$d=uh(),Fh(cu(gf(gi))),Fh(cu(gf(mi))),Fh(cu(gf(vi))),jp(gf(vi),Kd),i=Mf,Bh(1),Fh($d),Fh(Kd),lh(),Fh(Kd),Ys(),e=0,r=t.length;e<r&&(n=t[e],H&&console.log("scanning table entry "+n),!n||(wp(n),Wd=uh(),Jd=Lo(Wd),Zd=Fo(Wd),Yd=Qo(Wd),!Nl(i)));e++);return Mf=i,n?(Fh(Zd),_t(),Wd=uh()):Wd=gf(wi),jp(gf(vi),uh()),jp(gf(mi),uh()),jp(gf(gi),uh()),Fh(Wd),lp()},Nl=function(t){var e,n,i,r,o,s,a,l;for(i=0,r=0,i=e=o=t,s=Mf;o<=s?e<s:e>s;i=o<=s?++e:--e)for(jp(gf(gi),rf[i]),r=n=a=t,l=Mf;a<=l?n<l:n>l;r=a<=l?++n:--n){for(jp(gf(mi),rf[r]),Wd=Yd;Uu(Wd)&&(Fh(zo(Wd)),_t(),Qd=uh(),!Oc(Qd));)Wd=Ko(Wd);if(!Uu(Wd)&&(Fh($d),Fh(Jd),_t(),pf(),Wd=uh(),Oc(Wd)))return 1}return 0},qn=function(){return Fh(Lo(Wd)),_t(),$o(Wd)===gf(wi)?(Bh(1),Bh(2)):(Fh(Fo(Wd)),_t(),Fh(Io(Wd)),_t()),Nf()},Nf=function(){var t,e,n,i,r,o,s,a,l,u,c,d,h,p,f,g,m,v,y,b,_,x,w,A;for(c=0,d=0,h=0,p=0,f=0,A=0,a=[],l=[],c=e=0,v=pi;0<=v?e<v:e>v;c=0<=v?++e:--e)a[c]=0,l[c]=0;if(gp(),$d=uh(),Qd=uh(),Wd=uh(),!Nc(Wd))return Oc(Wd)||uf("transpose: tensor expected, 1st arg is not a tensor"),Fh(xg),void lp();if(g=Wd.tensor.ndim,m=Wd.tensor.nelem,1===g)return Fh(Wd),void lp();for(Fh(Qd),p=hh(),Fh($d),f=hh(),(p<1||p>g||f<1||f>g)&&uf("transpose: index out of range"),p--,f--,(Qd=Xr(m)).tensor.ndim=g,c=n=0,y=g;0<=y?n<y:n>y;c=0<=y?++n:--n)Qd.tensor.dim[c]=Wd.tensor.dim[c];for(Qd.tensor.dim[p]=Wd.tensor.dim[f],Qd.tensor.dim[f]=Wd.tensor.dim[p],t=Wd.tensor.elem,u=Qd.tensor.elem,c=i=0,b=g;0<=b?i<b:i>b;c=0<=b?++i:--i)a[c]=0,l[c]=Wd.tensor.dim[c];for(c=r=0,_=m;0<=_?r<_:r>_;c=0<=_?++r:--r){for(A=a[p],a[p]=a[f],a[f]=A,A=l[p],l[p]=l[f],l[f]=A,h=0,d=o=0,x=g;0<=x?o<x:o>x;d=0<=x?++o:--o)h=h*l[d]+a[d];for(A=a[p],a[p]=a[f],a[f]=A,A=l[p],l[p]=l[f],l[f]=A,u[h]=t[c],d=s=w=g-1;(w<=0?s<=0:s>=0)&&!(++a[d]<l[d]);d=w<=0?++s:--s)a[d]=0}return Fh(Qd),lp()},Pn=function(){var t;if(zo(Wd)!==gf(or)||uu(gf(or))!==gf(wi)){if($d=cu(zo(Wd)),Kd=uu(zo(Wd)),Jd=Ko(Wd),$d!==zo(Wd)){for(Wd=Kd,Qd=Jd,t=Mf;Uu(Wd)&&Uu(Qd);)Fh(zo(Wd)),Fh(zo(Qd)),_t(),Wd=Ko(Wd),Qd=Ko(Qd);return Rc(Mf-t),Zd=uh(),Fh($d),Uu(Zd)&&(Fh(Zd),up()),_t()}for(t=Mf,Fh($d),Wd=Jd;Uu(Wd);)Fh(zo(Wd)),_t(),Wd=Ko(Wd);Rc(Mf-t)}else ee()},up=function(){var t,e;if(e=0,gp(),Qd=uh(),Wd=uh(),Nc(Wd))return e=cp(),lp(),e;if(Uu(Wd)){for(t=Mf,Fh(zo(Wd)),Wd=Ko(Wd);Uu(Wd);)Fh(zo(Wd)),Fh(Qd),e+=up(),Wd=Ko(Wd);return Rc(Mf-t),lp(),e}if(!Mc(Wd))return Fh(Wd),lp(),0;for($d=Qd;Uu($d);){if(Wd===zo($d))return Fh(Lo($d)),lp(),1;$d=$o($d)}return $d=cu(Wd),Fh($d),Wd!==$d&&(Fh(Qd),0===(e=up())&&(uh(),Fh(Wd))),lp(),e},cp=function(){var t,e,n,i;for(n=0,e=0,Fh(Wd),Ss(),e=t=0,i=(Wd=uh()).tensor.nelem;0<=i?t<i:t>i;e=0<=i?++t:--t)Fh(Wd.tensor.elem[e]),Fh(Qd),n+=up(),Wd.tensor.elem[e]=uh();return Wd.tensor.nelem!==Wd.tensor.elem.length&&console.log("something wrong in tensor dimensions"),Fh(Wd),n},Dn=function(){var t,e,n,i,r,o,s,a;for(n=0,i=[],r=0,o=0,n=t=0,s=pi;0<=s?t<s:t>s;n=0<=s?++t:--t)i[n]=0;for(r=1,o=0,Qd=Ko(Wd);Uu(Qd);){if(Fh(zo(Qd)),_t(),(n=hh())<2)return void Fh(xg);r*=n,i[o++]=n,Qd=Ko(Qd)}if(0!==o){for((Wd=Xr(r)).tensor.ndim=o,n=e=0,a=o;0<=a?e<a:e>a;n=0<=a?++e:--e)Wd.tensor.dim[n]=i[n];return Fh(Wd)}Fh(xg)},to=0,Xr=function(t){var e,n,i,r;for(n=0,(i=new Mr).k=4,i.tensor=new _f,i.tensor.nelem=t,n=e=0,r=t;0<=r?e<r:e>r;n=0<=r?++e:--e)i.tensor.elem[n]=xg;return i.tensor.allocatedId=to,to++,i.tensor.nelem!==i.tensor.elem.length&&console.log("something wrong in tensor dimensions"),i},mu=function(){function t(){}return t.prototype.c=0,t.prototype.x=0,t.prototype.y=0,t}(),Yo=[],Zo=Wr=0;Wr<1e4;Zo=++Wr)Yo[Zo]=new mu;for(Gf=0,zc=0,il=0,xl=0,jh=function(t,e){return null==e&&(e=""),e+t},Ph=function(t,e){return jh(t,e)},function(t){var e,n;return gp(),Gf=0,zc=0,il=0,el(t),(e=fu(0,Gf))[0],n=e[1],e[2],n>100?(Dh(t),void lp()):(Th(),lp())},el=function(t){return zo(t)===gf(Wi)?(Fa(Lo(t)),Pr(" = "),void Fa(Fo(t))):Nc(t)?Ya(t):Fa(t)},If=function(t){if(zc>0)return 0;if(Xu(t))return 1;if(zo(t)!==gf(_i))return 0;if(Xu(Lo(t)))return 1;for(;Uu(t);){if(Wu(zo(t)))return 1;t=Ko(t)}return 0},Fa=function(t){if(xl++,zo(t)===gf(r))for(t=Ko(t),Ir(zo(t))&&(Cr("-"),If(zo(t))&&Cr(" ")),tl(zo(t)),t=Ko(t);Uu(t);)Ir(zo(t))?(Cr(" "),Cr("-"),Cr(" ")):(Cr(" "),Cr("+"),Cr(" ")),tl(zo(t)),t=Ko(t);else Ir(t)&&(Cr("-"),If(t)&&Cr(" ")),tl(t);return xl--},nl=function(t){var e;if(zo(t)===gf(r)){for(t=Ko(t),tl(zo(t)),t=Ko(t),e=[];Uu(t);)Ir(zo(t))?(Cr(" "),Cr("-"),Cr(" ")):(Cr(" "),Cr("+"),Cr(" ")),tl(zo(t)),e.push(t=Ko(t));return e}return tl(t)},Ir=function(t){return uc(t)?1:zo(t)===gf(_i)&&uc(Lo(t))?1:0},tl=function(t){var e;return zo(t)===gf(_i)?(e=qs(t))&&0===zc?Ba(t,e):Va(t,e):La(t)},Wu=function(t){return zo(t)===gf(Di)&&Lo(t)!==gf(ot)&&Ir(Fo(t))?1:0},qs=function(t){var e;for(Os=0,t=Ko(t);Uu(t);)e=zo(t),Wu(e)&&Os++,t=Ko(t);return Os},Va=function(t,e){var n;if(0===e){for(t=Ko(t),(mc(zo(t))||oc(zo(t)))&&(t=Ko(t)),La(zo(t)),t=Ko(t),n=[];Uu(t);)Cr(" "),La(zo(t)),n.push(t=Ko(t));return n}return Wa(t),Cr("/"),e>1||Xu(Lo(t))?(Cr("("),Ia(t),Cr(")")):Ia(t)},Ba=function(t,e){var n,i,r,o;for(Os=0,r=0,gp(),$d=Hd,Kd=Hd,kc(Lo(t))&&(Fh(Lo(t)),ad(),Vr(),$d=uh(),Fh(Lo(t)),sd(),Kd=uh()),$u(Lo(t))&&(Fh(Lo(t)),Vr(),$d=uh()),r=mc($d)?0:1,Wd=Ko(t),pc(zo(Wd))&&(Wd=Ko(Wd));Uu(Wd);)Qd=zo(Wd),Wu(Qd)||r++,Wd=Ko(Wd);for(o=il,n=Gf,Os=0,mc($d)||(Ua($d,0),Os++),Wd=Ko(t),pc(zo(Wd))&&(Wd=Ko(Wd));Uu(Wd);)Qd=zo(Wd),Wu(Qd)||(Os>0&&Cr(" "),1===r?Fa(Qd):La(Qd),Os++),Wd=Ko(Wd);for(0===Os&&Cr("1"),i=Gf,Os=0,mc(Kd)||(Ua(Kd,0),Os++,e++),Wd=Ko(t),kc(zo(Wd))&&(Wd=Ko(Wd));Uu(Wd);)Qd=zo(Wd),Wu(Qd)&&(Os>0&&Cr(" "),Da(Qd,e),Os++),Wd=Ko(Wd);return Ql(o,n,i),lp()},Wa=function(t){var e;for(int(e),gp(),Wd=Hd,t=Ko(t),kc(zo(t))?(Fh(zo(t)),ad(),Vr(),Wd=uh(),t=Ko(t)):$u(zo(t))&&(Fh(zo(t)),Vr(),Wd=uh(),t=Ko(t)),e=0,mc(Wd)||(Ua(Wd,0),e++);Uu(t);)Wu(zo(t))||(e>0&&Cr(" "),La(zo(t)),e++),t=Ko(t);return 0===e&&Cr("1"),lp()},Ia=function(t){var e;for(int(e),gp(),e=0,t=Ko(t),Xu(zo(t))&&(Fh(zo(t)),sd(),Wd=uh(),Ua(Wd,0),e++,t=Ko(t));Uu(t);)Wu(zo(t))&&(e>0&&Cr(" "),Da(zo(t),0),e++),t=Ko(t);return lp()},La=function(t){Nc(t)?Ra(t):$u(t)?Ua(t,0):zo(t)!==gf(r)&&zo(t)!==gf(_i)?zo(t)!==gf(Di)?Uu(t)?Ha(t):pc(t)?0===zc?Qa(t):Ua(t,0):Mc(t)?Za(t):Sc(t)&&Ka(t):$a(t):Ja(t)},Qa=function(t){var e,n,i;return gp(),Fh(t),ad(),Vr(),$d=uh(),Fh(t),sd(),Kd=uh(),mc(Kd)?(Ua($d,0),void lp()):(i=il,e=Gf,Ua($d,0),n=Gf,Ua(Kd,0),Ql(i,e,n),lp())},Ju=function(t){return Uu(t)&&zo(t)!==gf(r)&&zo(t)!==gf(_i)&&zo(t)!==gf(Di)?1:Mc(t)?1:Xu(t)?0:uc(t)?0:pc(t)?1:0},$a=function(t){var e,n,i;return e=0,n=0,i=0,Lo(t)===gf(ot)?(Pr("exp("),Fa(Fo(t)),void Cr(")")):zc>0?void(oc(Fo(t))?(Cr("1"),Cr("/"),Ju(Lo(t))?La(Lo(t)):Ja(Lo(t))):(Ju(Lo(t))?La(Lo(t)):Ja(Lo(t)),Cr("^"),Ju(Fo(t))?La(Fo(t)):Ja(Fo(t)))):Ir(Fo(t))?(i=il,e=Gf,Cr("1"),n=Gf,Da(t,1),void Ql(i,e,n)):(e=Gf,Ju(Lo(t))?La(Lo(t)):Ja(Lo(t)),n=Gf,zc++,Fa(Fo(t)),zc--,$l(e,n))},Da=function(t,e){var n,i;if(!oc(Fo(t)))return n=Gf,Ju(Lo(t))?La(Lo(t)):Ja(Lo(t)),i=Gf,zc++,nl(Fo(t)),zc--,$l(n,i);1===e?Fa(Lo(t)):La(Lo(t))},Ha=function(t){if(zo(t)===gf(Jn)&&Mc(Lo(t)))Ga(t);else{if(zo(t)!==gf(Ln)){if(zo(t)===gf(Q)?Cr("d"):Za(zo(t)),Cr("("),t=Ko(t),Uu(t))for(Fa(zo(t)),t=Ko(t);Uu(t);)Cr(","),Fa(zo(t)),t=Ko(t);return Cr(")")}za(t)}},Ga=function(t){if(t=Ko(t),Eo(t)===gf(r)||Eo(t)===gf(_i)||Eo(t)===gf(Di)||Eo(t)===gf(Ln)?Ja(zo(t)):Fa(zo(t)),Cr("["),t=Ko(t),Uu(t))for(Fa(zo(t)),t=Ko(t);Uu(t);)Cr(","),Fa(zo(t)),t=Ko(t);return Cr("]")},za=function(t){return t=Lo(t),zo(t)===gf(r)||zo(t)===gf(_i)||zo(t)===gf(Di)||zo(t)===gf(Ln)?Ja(t):Fa(t),Cr("!")},Ja=function(t){return Cr("("),Fa(t),Cr(")")},Za=function(t){var e,n,i,r,o;if(n=0,t!==gf(ot)){for(o=[],n=e=0,r=(i=pu(t)).length;0<=r?e<r:e>r;n=0<=r?++e:--e)o.push(Cr(i[n]));return o}Pr("exp(1)")},Ka=function(t){var e,n,i,r;for(n=0,i=t.str,Cr('"'),n=e=0,r=i.length;0<=r?e<r:e>r;n=0<=r?++e:--e)Cr(i[n]);return Cr('"')},Ql=function(t,e,n){var i,r,o,s,a,l,u,c,d,h,p,f;for(r=0,c=0,o=(s=fu(e,n))[0],d=s[1],p=s[2],(a=fu(n,Gf))[0],h=a[1],f=a[2],r=h>d?(h-d)/2:0,od(e,n,++r,-(p+o-1)-1),r=h>d?-d:(d-h)/2-d,od(n,Gf,++r,1-f),c=h>d?h:d,il=t,u=[],i=0,l=c+=2;0<=l?i<l:i>l;0<=l?++i:--i)u.push(Cr("-"));return u},$l=function(t,e){var n,i,r,o,s;return n=0,(r=fu(t,e))[0],r[1],s=r[2],i=(o=fu(e,Gf))[0],o[1],n=-o[2]-i+1,od(e,Gf,0,n+=s-1)},od=function(t,e,n,i){var r,o,s,a,l;for(o=0,l=[],o=r=s=t,a=e;s<=a?r<a:r>a;o=s<=a?++r:--r)Yo[o].x+=n,l.push(Yo[o].y+=i);return l},fu=function(t,e){var n,i,r,o,s,a,l,u;for(i=0,s=Yo[t].x,r=Yo[t].x,a=Yo[t].y,o=Yo[t].y,i=n=l=t+1,u=e;l<=u?n<u:n>u;i=l<=u?++n:--n)Yo[i].x<s&&(s=Yo[i].x),Yo[i].x>r&&(r=Yo[i].x),Yo[i].y<a&&(a=Yo[i].y),Yo[i].y>o&&(o=Yo[i].y);return[o-a+1,r-s+1,a]},Cr=function(t){if(1e4!==Gf)return Yo[Gf],Yo[Gf].c=t,Yo[Gf].x=il,Yo[Gf].y=0,Gf++,il++},Pr=function(t){var e,n,i,r;for(n=0,r=[],n=e=0,i=t.length;0<=i?e<i:e>i;n=0<=i?++e:--e)r.push(Cr(t[n]));return r},Ua=function(t,e){var n,i,r,o,s,a,l,u,c,d;switch(d="",o=0,t.k){case 1:for("-"===(d=t.q.a.toString())[0]&&0===e&&(d=d.substring(1)),o=n=0,s=d.length;0<=s?n<s:n>s;o=0<=s?++n:--n)Cr(d[o]);if("1"===(d=t.q.b.toString()))break;for(Cr("/"),u=[],o=i=0,a=d.length;0<=a?i<a:i>a;o=0<=a?++i:--i)u.push(Cr(d[o]));return u;case 2:for("-"===(d=xa(t.d))[0]&&0===e&&(d=d.substring(1)),c=[],o=r=0,l=d.length;0<=l?r<l:r>l;o=0<=l?++r:--r)c.push(Cr(d[o]));return c}},as=function(t,e){return t.y<e.y?-1:t.y>e.y?1:t.x<e.x?-1:t.x>e.x?1:0},Th=function(){var t,e,n,i,r,o,s;for(n=0,t="",(r=Yo.slice(0,Gf)).sort(as),o=0,s=(Yo=[].concat(r).concat(Yo.slice(Gf)))[0].y,n=e=0,i=Gf;0<=i?e<i:e>i;n=0<=i?++e:--e){for(;Yo[n].y>s;)t=Ph("\n",t),o=0,s++;for(;Yo[n].x>o;)t=jh(" ",t),o++;t=jh(Yo[n].c,t),o++}},function(){var t,e,n,i,r,o,s;for("",i=0,e=0,(r=Yo.slice(0,Gf)).sort(as),o=0,s=(Yo=[].concat(r).concat(Yo.slice(Gf)))[0].y,e=t=0,n=Gf;0<=n?t<n:t>n;e=0<=n?++t:--t){for(;Yo[e].y>s;)""[i++]="\n",o=0,s++;for(;Yo[e].x>o;)""[i++]=" ",o++;""[i++]=Yo[e].c,o++}return""[i++]="\n"},Gd=function(){function t(){}return t.prototype.x=0,t.prototype.y=0,t.prototype.h=0,t.prototype.w=0,t.prototype.index=0,t.prototype.count=0,t}(),ja=[],Pa=Qr=0;Qr<1e4;Pa=++Qr)ja[Pa]=new Gd;Ya=function(t){var e,n,i,r,o,s,a,l,u,c,d,h,p,f,g,m,v,y,b,_,x,w;if(c=0,h=0,s=0,a=0,l=0,u=0,b=0,o=0,t.tensor.ndim>2)Ra(t);else{if(!((d=(p=t.tensor.dim[0])*(h=2===t.tensor.ndim?t.tensor.dim[1]:1))>100)){for(x=il,c=e=0,f=d;0<=f?e<f:e>f;c=0<=f?++e:--e)ja[c].index=Gf,ja[c].x=il,Fa(t.tensor.elem[c]),ja[c].count=Gf-ja[c].index,g=fu(ja[c].index,Gf),ja[c].h=g[0],ja[c].w=g[1],ja[c].y=g[2];for(l=0,u=0,c=n=0,m=d;0<=m?n<m:n>m;c=0<=m?++n:--n)ja[c].h>l&&(l=ja[c].h),ja[c].w>u&&(u=ja[c].w);for(_=h*u+3*(h-1),w=-(p*l+1*(p-1))/2,b=i=0,v=p;0<=v?i<v:i>v;b=0<=v?++i:--i)for(o=r=0,y=h;0<=y?r<y:r>y;o=0<=y?++r:--r)s=x-ja[c=b*h+o].x,a=w-ja[c].y,od(ja[c].index,ja[c].index+ja[c].count,s,a),s=0,o>0&&(s=o*(u+3)),a=0,b>0&&(a=b*(l+1)),s+=(u-ja[c].w)/2,a+=(l-ja[c].h)/2,od(ja[c].index,ja[c].index+ja[c].count,s,a);return il=x+_}Ra(t)}},Ra=function(t){return Xa(t,0,0)},Xa=function(t,e,n){var i,r,o;for(r=0,Cr("("),r=i=0,o=t.tensor.dim[e];0<=o?i<o:i>o;r=0<=o?++i:--i)e+1===t.tensor.ndim?(Fa(t.tensor.elem[n]),n+=1):n=Xa(t,e+1,n),r+1<t.tensor.dim[e]&&Cr(",");return Cr(")"),n},Vn=function(t,e){var n,i,r;if(i=0,rl(t,e))return 1;if(Nc(t)){for(i=n=0,r=t.tensor.nelem;0<=r?n<r:n>r;i=0<=r?++n:--n)if(Vn(t.tensor.elem[i],e))return 1;return 0}for(;Uu(t);){if(Vn(zo(t),e))return 1;t=Ko(t)}return 0},t.Find=Vn,ku=function(){var t,e,n;if(n=0,Mf=0,ul=0,Jl=1e5,!(Kl=0)){for(Kl=1,n=t=0;t<1e3;n=++t)vf[n]=new Mr;for(n=e=0;e<1e3;n=++e)vf[n].k=5,Ao[n]=vf[n],uo[n]=gf(wi);return Ud=gf(wi),Wd=gf(wi),Qd=gf(wi),$d=gf(wi),Kd=gf(wi),Jd=gf(wi),Zd=gf(wi),Yd=gf(wi),Xd=gf(wi),th=gf(wi),sf("abs",i),sf("add",r),sf("adj",o),sf("and",s),sf("arccos",a),sf("arccosh",l),sf("arcsin",u),sf("arcsinh",c),sf("arctan",d),sf("arctanh",h),sf("arg",p),sf("atomize",f),sf("besselj",v),sf("bessely",y),sf("binding",b),sf("binomial",_),sf("ceiling",E),sf("check",N),sf("choose",O),sf("circexp",q),sf("clear",C),sf("clock",P),sf("coeff",j),sf("cofactor",D),sf("condense",I),sf("conj",F),sf("contract",L),sf("cos",z),sf("cosh",R),sf("decomp",G),sf("defint",V),sf("deg",U),sf("denominator",W),sf("det",$),sf("derivative",Q),sf("dim",J),sf("dirac",Z),sf("display",Y),sf("divisors",X),sf("do",tt),sf("dot",et),sf("draw",nt),sf("dsolve",rt),sf("erf",pt),sf("erfc",ft),sf("eigen",st),sf("eigenval",at),sf("eigenvec",lt),sf("eval",gt),sf("exp",mt),sf("expand",vt),sf("expcos",yt),sf("expsin",bt),sf("factor",Fn),sf("factorial",Ln),sf("factorpoly",zn),sf("filter",Rn),sf("float",Bn),sf("floor",Hn),sf("for",Gn),sf("Gamma",Un),sf("gcd",Wn),sf("hermite",Qn),sf("hilbert",$n),sf("imag",Kn),sf("component",Jn),sf("inner",Zn),sf("integral",Yn),sf("inv",Xn),sf("invg",ti),sf("isinteger",ii),sf("isprime",ri),sf("laguerre",oi),sf("lcm",ai),sf("leading",li),sf("legendre",ui),sf("log",ci),sf("mag",hi),sf("mod",yi),sf("multiply",_i),sf("not",Ai),sf("nroots",ki),sf("number",Ei),sf("numerator",Ni),sf("operator",Oi),sf("or",qi),sf("outer",Ci),sf("polar",ji),sf("power",Di),sf("prime",Ii),sf("print",Fi),sf("product",Li),sf("quote",zi),sf("quotient",Ri),sf("rank",Bi),sf("rationalize",Hi),sf("real",Gi),sf("rect",Or),sf("roots",Vi),sf("equals",Wi),sf("sgn",Qi),sf("simplify",Ki),sf("sin",Ji),sf("sinh",Zi),sf("shape",$i),sf("sqrt",Yi),sf("stop",Xi),sf("subst",tr),sf("sum",er),sf("tan",gr),sf("tanh",mr),sf("taylor",vr),sf("test",yr),sf("testeq",br),sf("testge",_r),sf("testgt",xr),sf("testle",wr),sf("testlt",Ar),sf("transpose",Tr),sf("unit",Er),sf("zero",qr),sf("nil",wi),sf("autoexpand",g),sf("bake",m),sf("last",si),sf("trace",kr),sf("tty",Sr),sf("~",Nr),sf("$DRAWX",it),sf("$METAA",gi),sf("$METAB",mi),sf("$METAX",vi),sf("$SECRETX",Ui),sf("pi",Pi),sf("a",nr),sf("b",ir),sf("c",rr),sf("d",or),sf("i",sr),sf("j",ar),sf("n",lr),sf("r",ur),sf("s",cr),sf("t",dr),sf("x",hr),sf("y",pr),sf("z",fr),sf("$C1",w),sf("$C2",A),sf("$C3",k),sf("$C4",T),sf("$C5",S),sf("$C6",M),Bh(0),xg=uh(),Bh(1),Hd=uh(),Gh(Di),H&&yh(rf[Mf-1]),Bh(-1),H&&yh(rf[Mf-1]),Hh(1,2),H&&yh(rf[Mf-1]),Rc(3),H&&yh(rf[Mf-1]),wu=uh(),na()}},ia=["e=exp(1)","i=sqrt(-1)","autoexpand=1","trange=(-pi,pi)","xrange=(-10,10)","yrange=(-10,10)","last=0","trace=0","tty=0","cross(u,v)=(u[2]*v[3]-u[3]*v[2],u[3]*v[1]-u[1]*v[3],u[1]*v[2]-u[2]*v[1])","curl(v)=(d(v[3],y)-d(v[2],z),d(v[1],z)-d(v[3],x),d(v[2],x)-d(v[1],y))","div(v)=d(v[1],x)+d(v[2],y)+d(v[3],z)","ln(x)=log(x)"],na=function(){var t,e,n,i,r;for(r=[],n=t=0,i=ia.length;0<=i?t<i:t>i;n=0<=i?++t:--t)vp(e=ia[n]),H&&(console.log("... evaling "+e),console.log("top of stack:"),yh(rf[Mf-1])),_t(),r.push(uh());return r},$c=function(t,e){return t.compare(e)},cf=function(t,e){return t===e?0:t>e?1:-1},xa=function(t){return parseFloat(t.toPrecision(6))},os=function(){},Tc=function(t){return null!=t&&(" "===t||"\t"===t||"\n"===t||"\v"===t||"\f"===t||"\r"===t)},Qu=function(t){return null!=t&&/^\d+$/.test(t)},Gu=function(t){return null!=t&&-1===t.search(/[^A-Za-z]/)},Hu=function(t){return null!=t&&(Gu(t)||Qu(t))},uf=function(t){var e;throw ll+="Stop: ",e=ll+=t,ll="",Mf=0,new Error(e)},Su=!1,fp=function(t){var e,n,i,r,o;if("selftest"!==(t=t)){for(Su||(Su=!0,ku()),o=0,r=0,e="";;){try{ll="",ts(),o=vp(t.substring(r)),Wd=uh(),ts()}catch(n){e+=n.message,ku();break}if(0===o)break;r+=o,Fh(Wd);try{if(Sf(),Qd=uh(),ts(),Qd===gf(wi))continue;if(Sc(Qd)){console.log(Qd.str),console.log("\n");continue}e+=ps(Qd),e+="\n"}catch(i){e+=i.message,e+="\n",ku()}}return"\n"===e[e.length-1]&&(e=e.substring(0,e.length-1)),e}selftest()},ts=function(){if(0!==Mf&&uf("stack error"),1e5!==Jl)return uf("frame error")},Sf=function(){return H&&console.log("#### top level eval"),gp(),Of=0,Wd=gf(g),yl=Oc(cu(Wd))?0:1,Wd=uh(),Fh(Wd),_t(),(Qd=uh())===gf(wi)?(Fh(Qd),void lp()):(jp(gf(si),Qd),Oc(cu(gf(m)))||(Fh(Qd),co(),Qd=uh()),(Wd!==gf(sr)&&Wd!==gf(ar)||!ec(Qd))&&(ec(cu(gf(ar)))?(Fh(Qd),Fh(wu),Gh(ar),hf(),Qd=uh()):ec(cu(gf(sr)))&&(Fh(Qd),Fh(wu),Gh(sr),hf(),Qd=uh())),Fh(Qd),lp())},Xo=function(){if(ul)return uf("esc key")},(void 0!==e&&null!==e?e:this).run=fp,Mf=0,Md=0,Fh=function(t){return t.isZero,t===gf(wi)&&(Md++,H&&console.log("pushing symbol(NIL) #"+Md)),Mf>=Jl&&uf("stack overflow"),rf[Mf++]=t},uh=function(){return 0===Mf&&uf("stack underflow"),rf[Mf-1],rf[--Mf]},Rh=function(t){var e,n,i,r;for(n=0,(Jl-=t)<Mf&&uf("frame overflow, circular reference?"),r=[],n=e=0,i=t;0<=i?e<i:e>i;n=0<=i?++e:--e)r.push(rf[Jl+n]=gf(wi));return r},dh=function(t){if((Jl+=t)>1e5)return uf("frame underflow")},gp=function(){return(Jl-=10)<Mf&&uf("frame overflow, circular reference?"),rf[Jl+0]=Ud,rf[Jl+1]=Wd,rf[Jl+2]=Qd,rf[Jl+3]=$d,rf[Jl+4]=Kd,rf[Jl+5]=Jd,rf[Jl+6]=Zd,rf[Jl+7]=Yd,rf[Jl+8]=Xd,rf[Jl+9]=th},lp=function(){return Jl>99990&&uf("frame underflow"),Ud=rf[Jl+0],Wd=rf[Jl+1],Qd=rf[Jl+2],$d=rf[Jl+3],Kd=rf[Jl+4],Jd=rf[Jl+5],Zd=rf[Jl+6],Yd=rf[Jl+7],Xd=rf[Jl+8],th=rf[Jl+9],Jl+=10},ff=function(){var t,e;return t=uh(),e=uh(),Fh(t),Fh(e)},qa=function(){var t;return t=uh(),Fh(t),Fh(t)},t.dupl=qa,t.swap=ff,t.restore=lp,t.save=gp,t.push=Fh,t.pop=uh,sf=function(t,e){return vf[e].printname=t},Df=function(t){var e,n,i;for(n=0,n=e=0;e<1e3&&""!==vf[n].printname;n=++e)if(t===vf[n].printname)return vf[n];return 1e3===n&&uf("symbol table overflow"),(i=vf[n]).printname=t,i},pu=function(t){return 5!==t.k&&uf("symbol error"),t.printname},jp=function(t,e){var n;return 5!==t.k&&uf("symbol error"),n=vf.indexOf(t),-1!==vf.indexOf(t,n+1)&&console.log("ops, more than one element!"),H&&console.log("lookup >> set_binding lookup "+n),Ao[n]=e,uo[n]=gf(wi)},cu=function(t){var e;return 5!==t.k&&uf("symbol error"),e=vf.indexOf(t),-1!==vf.indexOf(t,e+1)&&console.log("ops, more than one element!"),H&&console.log("lookup >> get_binding lookup "+e),Ao[e]},Dp=function(t,e,n){var i;return 5!==t.k&&uf("symbol error"),i=vf.indexOf(t),-1!==vf.indexOf(t,i+1)&&console.log("ops, more than one element!"),H&&console.log("lookup >> set_binding_and_arglist lookup "+i),Ao[i]=e,uo[i]=n},uu=function(t){var e;return 5!==t.k&&uf("symbol error"),e=vf.indexOf(t),-1!==vf.indexOf(t,e+1)&&console.log("ops, more than one element!"),H&&console.log("lookup >> get_arglist lookup "+e),uo[e]},Hc=0,mf=function(t){var e;return Hc++,5!==t.k&&uf("symbol error"),e=vf.indexOf(t),-1!==vf.indexOf(t,e+1)&&console.log("ops, more than one element!"),H&&console.log("lookup >> symnum lookup "+e+" lookup # "+Hc),e},Gh=function(t){return Fh(vf[t])},rs=function(){var t,e,n;for(e=0,n=[],e=t=0;t<1e3;e=++t)Ao[e]=vf[e],n.push(uo[e]=gf(wi));return n},t.get_binding=cu,t.set_binding=jp,t.usr_symbol=Df,Su||(Su=!0,ku()),t.init=ku,nh=function(t){return"string"==typeof t?vp(t):"number"==typeof t?t%1==0?Bh(t):Lh(t):t instanceof Mr?Fh(t):(console.warn("unknown argument type",t),Fh(gf(wi)))},eh=function(t){var e,n,i;try{nh(t),e=uh(),ts()}catch(i){throw n=i,ap(),n}return e},cl=function(){var t,e,n,i,r,o,s,a,l;for(a=arguments[0],n=2<=arguments.length?wg.call(arguments,1):[],o=cu(Df(a)),ts(),Fh(o),t=0,s=n.length;t<s;t++)e=n[t],nh(e);Rc(1+n.length),Wd=uh(),Fh(Wd);try{Wl(),l=uh(),ts()}catch(r){throw i=r,ap(),i}return l},ap=function(){return Mf=0,ul=0,Jl=1e5},Wl=function(){return gp(),Of=0,Wd=gf(g),yl=Oc(cu(Wd))?0:1,Wd=uh(),Fh(Wd),_t(),(Qd=uh())===gf(wi)?(Fh(Qd),void lp()):(Oc(cu(gf(m)))||(Fh(Qd),co(),Qd=uh()),Fh(Qd),lp())},t.exec=cl,t.parse=eh,function(){var e,n,i,r,o;for(o=[],e=0,r=(n=["abs","add","adj","and","arccos","arccosh","arcsin","arcsinh","arctan","arctanh","arg","atomize","besselj","bessely","binding","binomial","ceiling","check","choose","circexp","clear","clock","coeff","cofactor","condense","conj","contract","cos","cosh","decomp","defint","deg","denominator","det","derivative","dim","dirac","display","divisors","do","dot","draw","dsolve","erf","erfc","eigen","eigenval","eigenvec","eval","exp","expand","expcos","expsin","factor","factorial","factorpoly","filter","float","floor","for","Gamma","gcd","hermite","hilbert","imag","component","inner","integral","inv","invg","isinteger","isprime","laguerre","lcm","leading","legendre","log","mag","mod","multiply","not","nroots","number","numerator","operator","or","outer","polar","power","prime","print","product","quote","quotient","rank","rationalize","real","rect","roots","equals","sgn","simplify","sin","sinh","sqrt","stop","subst","sum","tan","tanh","taylor","test","testeq","testge","testgt","testle","testlt","transpose","unit","zero"]).length;e<r;e++)i=n[e],o.push(t[i]=cl.bind(this,i))}()}).call(this)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sign=l;var i=n(1),r=n(11),o=n(9),s=n(18),a=n(16);function l(t,e){o.Group.call(this),t&&(i.Tree.append(this,new a.Sym(e?"±":"-")),i.Tree.append(this,t),s.Brackets.handle(t)),e&&(this.value="plusminus")}r.asOperator.call(l,"sign",{bp:40,associative:!0,commutative:!1,inverse:"sign"}),l.registerAtParser=function(t){t.registerSymbol("+").nud=function(){var e=t.parseExpression(l.prototype.bp);return e.had_leading_plus=!0,e};var e=t.registerSymbol("-");function n(){return new l(t.parseExpression(l.prototype.bp),!0)}e.nud=function(){return new l(t.parseExpression(l.prototype.bp))},["±","\\pm"].forEach(function(e){t.registerSymbol(e).nud=n}),t.registerSymbol("–").nud=e.nud},l.prototype.deconstruct=function(){var t=[];return t.push(this),t},l.prototype.to_ascii=function(t){var e,n=this.children[0].to_ascii(t),i=this.children[1].to_ascii(t);return e=!this.children[1].is_group("fraction")||t&&t.bracketed_negatives?n+i:n+"{"+i+"}",t&&t.bracketed_negatives?"("+e+")":e},l.wrapTerm=function(t,e){return l.invertTerm(t,!1,e)},l.analyzeSignStructure=function(t){return{count:l.countSignLevels(t),descendent:t.is_group("sign","plusminus")?t.getDescendentWithoutSigns():t,containsPlusMinus:l.containsPlusMinus(t)}},l.countSignLevels=function(t){for(var e=0;t.is_group("sign","plusminus");)e++,t=t.get_child([1]);return e},l.prototype.getDescendentWithoutSigns=function(){var t=this;do{t=t.children[1]}while(t instanceof l);return t},l.containsPlusMinus=function(t){for(;t.is_group("sign","plusminus","addsub","add","sub");){if("plusminus"===t.value||"addsub"===t.value)return!0;t=t.children[1]}return!1},l.ascendToNonSignAncestor=function(t){for(;t.is_group("sign")&&t.parent;)t=t.get_parent(1);return t},l.invertTerm=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t.is_group("product","mul","div","add","sub")){var i=t.is_group("product")?t.children[0].children[1]:t.children[1],r=i.parent,o=i.remove();if(i.is_group("sign","plusminus")&&e){var s=i.children[1];return r.insert(o,s),t}return r.insert(o,new l(i,n)),t}var a=t.parent;if(a){var u=t.remove();return a.insert(u,new l(t,n))}if(t.is_group("sign","plusminus")&&e){var c=t.children[1];return c.remove(),c.ls=null,c.rs=null,c}return new l(t)}},function(t,e){var n=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(t,e,n){var i,r,o={},s=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=i.apply(this,arguments)),r}),a=function(t){var e={};return function(t){if("function"==typeof t)return t();if(void 0===e[t]){var n=function(t){return document.querySelector(t)}.call(this,t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}}(),l=null,u=0,c=[],d=n(209);function h(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=o[i.id];if(r){r.refs++;for(var s=0;s<r.parts.length;s++)r.parts[s](i.parts[s]);for(;s<i.parts.length;s++)r.parts.push(y(i.parts[s],e))}else{var a=[];for(s=0;s<i.parts.length;s++)a.push(y(i.parts[s],e));o[i.id]={id:i.id,refs:1,parts:a}}}}function p(t,e){for(var n=[],i={},r=0;r<t.length;r++){var o=t[r],s=e.base?o[0]+e.base:o[0],a={css:o[1],media:o[2],sourceMap:o[3]};i[s]?i[s].parts.push(a):n.push(i[s]={id:s,parts:[a]})}return n}function f(t,e){var n=a(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=c[c.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),c.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=a(t.insertInto+" "+t.insertAt.before);n.insertBefore(e,r)}}function g(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=c.indexOf(t);e>=0&&c.splice(e,1)}function m(t){var e=document.createElement("style");return void 0===t.attrs.type&&(t.attrs.type="text/css"),v(e,t.attrs),f(t,e),e}function v(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function y(t,e){var n,i,r,o;if(e.transform&&t.css){if(!(o=e.transform(t.css)))return function(){};t.css=o}if(e.singleton){var s=u++;n=l||(l=m(e)),i=x.bind(null,n,s,!1),r=x.bind(null,n,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",v(e,t.attrs),f(t,e),e}(e),i=function(t,e,n){var i=n.css,r=n.sourceMap,o=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||o)&&(i=d(i)),r&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var s=new Blob([i],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}.bind(null,n,e),r=function(){g(n),n.href&&URL.revokeObjectURL(n.href)}):(n=m(e),i=function(t,e){var n=e.css,i=e.media;if(i&&t.setAttribute("media",i),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),r=function(){g(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=s()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=p(t,e);return h(n,e),function(t){for(var i=[],r=0;r<n.length;r++){var s=n[r];(a=o[s.id]).refs--,i.push(a)}for(t&&h(p(t,e),e),r=0;r<i.length;r++){var a;if(0===(a=i[r]).refs){for(var l=0;l<a.parts.length;l++)a.parts[l]();delete o[a.id]}}}};var b,_=(b=[],function(t,e){return b[t]=e,b.filter(Boolean).join("\n")});function x(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=_(e,r);else{var o=document.createTextNode(r),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n,i=t[1]||"",r=t[3];if(!r)return i;if(e&&"function"==typeof btoa){var o=(n=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),s=r.sources.map(function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"});return[i].concat(s).concat([o]).join("\n")}return[i].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<t.length;r++){var s=t[r];"number"==typeof s[0]&&i[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),e.push(s))}},e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlgebraModel=e.AlgebraModelLink=e.cleanups=e.actions=e.expressions=e.linkCoordinator=e.LinkCoordinator=void 0;var i=n(21);Object.defineProperty(e,"LinkCoordinator",{enumerable:!0,get:function(){return i.LinkCoordinator}}),Object.defineProperty(e,"linkCoordinator",{enumerable:!0,get:function(){return i.linkCoordinator}});var r=n(360);Object.defineProperty(e,"AlgebraModelLink",{enumerable:!0,get:function(){return r.AlgebraModelLink}});var o=n(5);Object.defineProperty(e,"AlgebraModel",{enumerable:!0,get:function(){return o.AlgebraModel}}),n(12),n(115),n(64),n(46),n(359);var s=u(n(355)),a=u(n(240)),l=u(n(3));function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}e.expressions=l;var c={};Object.keys(s).forEach(function(t){return c[t]=new s[t]}),e.actions=c;var d={};Object.keys(a).forEach(function(t){return d[t]=new a[t]}),e.cleanups=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Var=u;var i=n(0),r=n(1),o=n(36),s=n(22),a=n(15),l=n(45);function u(t){r.Tree.Node.call(this),this.value=t}i.gmath.inherit(r.Tree.Node,u),o.asLeaf.call(u,"var"),u.prototype.to_ascii=function(t){var e=this.to_ascii_value_modifier(this.get_base().value,t),n=this.superAndSubscriptText("to_ascii",t);return n.length>0&&t&&t.subscripts_as_long_names?'"'+e+n+'"':e.toString()+n},u.prototype.to_ascii_value_modifier=function(t,e){return e&&e.greek_symbols_to_latex&&u.unicode_to_latex[t]&&(t=u.unicode_to_latex[t]),t.length>1?'"'+t+'"':t},u.prototype.to_latex=function(t){if(this.hidden)return"";var e=this.get_base().value,n=u.latex_to_unicode[e]?u.latex_to_unicode[e]:e;return n.length>1&&(n="\\text{"+n+"}"),""+n+this.superAndSubscriptText("to_latex")},u.constant_values=["i"],u.constant_value=function(t){return Boolean(~i.gmath.findIndex(u.constant_values,function(e){return e===t}))},u.is_constant=function(t){return Boolean(t instanceof u&&u.constant_value(t.value)||t.is_group("sign")&&u.constant_value(t.children[1].value))},u.is_var=function(t){return t instanceof u||t.is_group("power")&&t.children[0]instanceof u},u.latex_to_unicode={"(name)":"","\\dottedsquare":"⬚","\\alpha":"α","\\Alpha":"Α","\\beta":"β","\\Beta":"Β","\\gamma":"γ","\\Gamma":"Γ","\\delta":"δ","\\Delta":"Δ","\\epsilon":"ε","\\Epsilon":"Ε","\\zeta":"ζ","\\Zeta":"Ζ","\\eta":"η","\\Eta":"Η","\\theta":"θ","\\Theta":"Θ","\\iota":"ι","\\Iota":"Ι","\\kappa":"κ","\\Kappa":"Κ","\\lambda":"λ","\\Lambda":"Λ","\\mu":"μ","\\Mu":"Μ","\\nu":"ν","\\Nu":"Ν","\\xi":"ξ","\\Xi":"Ξ","\\omicron":"ο","\\Omicron":"Ο","\\pi":"π","\\Pi":"Π","\\rho":"ρ","\\Rho":"Ρ","\\sigma":"σ","\\Sigma":"Σ","\\varsigma":"ς","\\tau":"τ","\\Tau":"Τ","\\upsilon":"υ","\\Upsilon":"Υ","\\phi":"φ","\\Phi":"Φ","\\chi":"χ","\\Chi":"Χ","\\psi":"ψ","\\Psi":"Ψ","\\omega":"ω","\\Omega":"Ω"},u.unicode_to_latex=function(t){var e={};for(var n in t)e[t[n]]=n;return e}(u.latex_to_unicode),u.utf8_subscripts=[{char:"₀",val:0},{char:"₁",val:1},{char:"₂",val:2},{char:"₃",val:3},{char:"₄",val:4},{char:"₅",val:5},{char:"₆",val:6},{char:"₇",val:7},{char:"₈",val:8},{char:"₉",val:9}],u.registerAtParser=function(t){var e=t.registerSymbol("_",100);function n(t){return"⬚"===t[0]?new l.PlaceHolder(t[0]):new u(t)}e.led=function(e){var n=t.parseExpression(99);if(e.is_leaf_node)e.set_script(n,"subscript",!0);else{var i=e.children[e.children.length-1];if(!i.is_leaf_node)return!1;i.set_script(n,"subscript",!0)}return e},e.nud=function(){return new u("_")},u.utf8_subscripts.forEach(function(e){t.registerSymbol(e.char,100).led=function(t){return!!t.is_leaf_node&&(t.set_script(new a.Num(e.val),"subscript",!0),t)}});var i=function(){return"name"===this.type?n(this.value):n(u.latex_to_unicode[this.value])},r=function(e){var n=t.parseExpression(s.MulDiv.prototype.bp,this);return s.MulDiv.createProduct(e,n)};for(var o in u.latex_to_unicode){var c=t.registerSymbol(o,30);c.nud=i,c.led=r}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.Derivation=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),s=n(7),a=n(19),l=n(59),u=n(30),c=n(21),d=n(10),h=(i=n(232))&&i.__esModule?i:{default:i},p=e.Derivation=function(e){function n(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments[3];!function(t,e){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,i,r,"Derivation"));return a.type="derivation",a.events=s.object.extend(a.events,t.dispatch("added_line","change","inspect_node","clone","pack_state","mistake","auto_undo","undo","redo","removed")),a.row_events=t.dispatch("drag","touch","tap","dbltap","release"),a.update_sequence=0,a.initDerivationSettings(r),a.initDerivationProperties(),a.initDerivation(o),a.initEventListeners(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,a.CanvasElement),r(n,[{key:"toJSON",value:function(){var t=this.settings.getModified();return t.id=this.id,delete t.pos,{type:"Derivation",rows:this.rows,settings:t,pos:this.pos,pack_state:this.packState}}},{key:"startUpdateSequence",value:function(){this.settings.get("visualized")&&this.update_sequence++}},{key:"isInUpdateSequence",value:function(){if(this.settings.get("visualized"))return this.update_sequence>0}},{key:"finishUpdateSequence",value:function(){if(this.settings.get("visualized")&&(this.update_sequence--,0===this.update_sequence&&this.updateDims(),this.update_sequence<0))throw"called finishUpdateSequence before startUpdateSequence"}},{key:"initDerivationSettings",value:function(t){this.settings.get("standalone")&&this.settings.set("show_bg",!1),this.canvas_model&&"touch"===this.canvas_model.inputMode()&&this.settings.set("keypad_tool_confirm_mode",!0)}},{key:"initDerivationProperties",value:function(){this.rows=[],this.active_dl_component="none",this.curr_row_operation="none",this.clone=null,this.dims={},this.mapping_nodes=[],this.setHandleProperties()}},{key:"setHandleProperties",value:function(){this.handle_size=this.settings.get("font_size")*this.settings.get("handle_size_factor"),this.handle_pos_offset=this.settings.get("font_size")*this.settings.get("handle_pos_offset_factor")}},{key:"initDerivation",value:function(t){var e=this;this.settings.get("visualized")&&(this.main=this.element_div.insert("div","*"),this.settings.get("svg_no_overflow")?this.main.style({"pointer-events":"none",overflow:"hidden",position:"absolute",left:-this.settings.get("svg_overflow_margin")+"px",top:-this.settings.get("svg_overflow_margin")+"px",width:"calc(100% + "+2*this.settings.get("svg_overflow_margin")+"px)",height:"calc(100% + "+2*this.settings.get("svg_overflow_margin")+"px)"}):this.main.style({overflow:"visible",position:"absolute",left:0,right:0,top:0,bottom:0,width:"100%",height:"100%"}),this.alignment_correction=this.main.append("div").style("position","absolute")),this.settings.get("eq").length>0&&!this.settings.get("dont_init_eq")?this.addLineFromExpressions(this.settings.get("eq").split("\\\\"),function(){e.initPosition(),e.settings.get("visualized")&&e.startWiggle(e.settings.get("wiggle")),t&&t(e)}):t&&t(this)}},{key:"initEventListeners",value:function(){this.canvas_model&&this.canvas_model.on("input_mode."+this.id,this.inputModeChanged.bind(this))}},{key:"applyViewAlignment",value:function(){this.translateElement({x:this.pos.x,y:this.pos.y+this.dims.y})}},{key:"addLineFromExpressions",value:function(t,e){if(t.length<1)e&&e(this);else for(var n=0;n<t.length;n++)this.addLineFromExpression(t[n],n===t.length-1?e:null)}},{key:"addLineFromExpression",value:function(t,e){this.rows.length>0&&this.rows[this.rows.length-1].deactivate(),this.addRowFromAscii(t,e)}},{key:"inputModeChanged",value:function(t){this.settings.set("keypad_tool_confirm_mode","touch"===t.mode),this.rows.forEach(function(t){return t.setHandleVisibility()})}},{key:"startWiggle",value:function(t){this.getLastView().wiggle(t,!0)}},{key:"setExpression",value:function(t,e,n){this.getLastModel().parseAndSet(t,e,n)}},{key:"enterSubTypeMode",value:function(t){this.rows&&(this.keypadMode("edit-keypad"===t),this.rows.forEach(function(e,n){e.view&&e.view.setMode(t,!e.hidden)},this))}},{key:"singleLineMode",value:function(t){if(0===arguments.length)return this.settings.get("collapsed_mode");if(t&&!this.settings.get("collapsed_mode")){for(var e=!1,n=0;n<this.rows.length-1;n++)this.rows[n].hidden||(e=!0,this.rows[n].hide());e&&this.layoutRows()}return this.settings.set("collapsed_mode",t),this}},{key:"keypadMode",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.splitMode(t)}},{key:"splitMode",value:function(){arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?this.keypadHandler&&(this.keypadHandler.end(),delete this.keypadHandler):(this.keypadHandler=new h.default,this.keypadHandler.start(this))}},{key:"getLastRow",value:function(){return this.rows[this.rows.length-1]}},{key:"getRowByModel",value:function(t){for(var e=0;e<this.rows.length;e++)if(this.rows[e].model===t)return this.rows[e];return null}},{key:"getLastModel",value:function(){return this.getLastRow().model}},{key:"getLastView",value:function(){return this.getLastRow().view}},{key:"updateFontSize",value:function(){if(this.settings.get("visualized")){var t=this.settings.get("font_size");this.rows.forEach(function(e){e.view&&e.view.settings.set("font_size",t)})}}},{key:"onInspect",value:function(t,e){if(e.shiftKey){var n=this.mapping_nodes.indexOf(e.node);-1===n?this.mapping_nodes.push(e.node):this.mapping_nodes.splice(n,1)}else this.mapping_nodes=[e.node];this.events.inspect_node({type:"inspect",node:e.node,dl:this,row:t.idx,shiftKey:e.shiftKey}),"touch"===this.canvas_model.inputMode()&&e.shiftKey&&this.drawTracesForTerms(this.mapping_nodes)}},{key:"onChange",value:function(t){var e=this.getRowByModel(t.old_model);e&&(t.new_model!==t.old_model&&(this.removeModelEventListeners(t.old_model),this.addModelEventListeners(t.new_model),e.model=t.new_model),setTimeout(function(){for(var t=!1,e=1;e<this.rows.length;e++){var n=this.rows[e];n.action.broken&&(t=!0),!!n.model.broken!==t&&(n.model.broken=t,n.model.for_each(function(e){e.color=t?"#E0A8A8":n.view.settings.get("color")}),n.hidden||n.view.update_existing())}}.bind(this),1),this.events.change(s.object.extend(new n.ChangeEvent(this.id,e.model,e.idx),t)))}},{key:"onCreate",value:function(t){var e=this;this.startUpdateSequence();try{this.getLastView();var i=this.getLastRow(),r=(i.el,i.handle,t.action.oldTree);if(r.for_each(function(t){t.dragging=!1,t.selected=!1}),r.hide_nodes(),t.action.new_derivation&&this.canvas_model){var o={dont_init_eq:!0,eq:t.action.newTree.to_ascii(),pos:{x:-1e3,y:-1e3}};this.canvas_model.createElement("derivation",o,"math-action",function(n){n.addRowFromModel(t.action.newTree,null,function(){e.canvas_model.moveToFreeSpace(n,!1,e)})})}else{var a=this.addRowFromAction(t.action);this.events.added_line(s.object.extend({senderDL_id:this.id,row:i.idx},t)),this.settings.get("visualized")&&i.hide(),this.events.change(new n.ChangeEvent(this.id,a.model))}(0,c.linkCoordinator)().addLink(new u.AlgebraModelLink(t.action.oldTree,t.action.newTree,t.action)),t.action.source_am&&(0,c.linkCoordinator)().addLink(new u.AlgebraModelLink(t.action.source_am,t.action.newTree,t.action))}finally{this.finishUpdateSequence()}}},{key:"onSpawn",value:function(t){this.settings.get("visualized")&&function e(n,i){var r=this;if(n){var o={pos:i};n.model?(o.eq=n.model.to_ascii(),o.dont_init_eq=!0):n.text&&(o.text=n.text,o.font_size=.7*this.settings.get("font_size"),o.size={width:2*this.settings.get("font_size")+40,height:200}),this.canvas_model.createElement(n.type,o,"auto",function(i){n.el_id=i.id,"derivation"===n.type?(n.model.hide_nodes(),i.addRowFromModel(n.model,n.action,function(i){e.call(r,t.elements[t.elements.indexOf(n)+1],{x:i.pos.x+i.size.width+1,y:i.pos.y})}),(0,c.linkCoordinator)().addLink(new u.AlgebraModelLink(t.oldTree,n.model,n.action))):e.call(r,t.elements[t.elements.indexOf(n)+1],{x:i.pos.x+i.size.width+1,y:i.pos.y})})}}.call(this,t.elements[0],{x:this.pos.x,y:this.pos.y+this.size.height+1})}},{key:"onRestraint",value:function(t){if(this.settings.get("visualized")){var e=this.pos.x+this.size.width,n=this.pos.y+this.getLastRow().pos[1];this.canvas_model.createElement("textbox",{text:t,dont_log_events:!0,pos:{x:e,y:n},undeditable:!0,resizable:{x:!1,y:!1},use_toolbar:!1,select_text_on_create:!1}),console.log(t)}}},{key:"shouldCutRow",value:function(t){return!!this.rowIsPartOfAContinuousCommutingSequence(t)}},{key:"rowIsPartOfAContinuousCommutingSequence",value:function(t){var e=this.rows[t.idx+1];if(!e)return!1;var n=t.action,i=e.action;if(!n||!i)return!1;if("CommuteAction"!==n.name||"CommuteAction"!==i.name)return!1;for(var r=0;r<n.nodes.length;r++){var o=n.nodes[r],s=i.nodes[r];if(!s)return!1;var a=n.mapNodes(o);if(a.length>1)return!1;if(a[0]!==s)return!1}return!0}},{key:"addRowFromAction",value:function(t){var e=t.newTree;if(this.settings.get("visualized")){var n=this.getLastView();n.bindToModel(e,t.initial_node_map)}var i=this.getLastRow();i.removeInteractionListeners();var r=this.createRow(e,t,i.el);return r.setView(i.view),this.settings.get("visualized")&&(r.takeHandle(i.handle),i.handle=null,n.render(!0,t),this.shouldCutRow(i)&&this.firstRowInSequence?(i.setView(null),i.hidden=!0,i.el=null,i.cut=!0):i.createView(s.object.merged(n.settings.getAll(),{interactive:!1,pos:i.pos.slice()}))),this.rowBeforeCurrActionSeq||(this.rowBeforeCurrActionSeq=i),this.firstRowInSequence||(this.firstRowInSequence=r),r}},{key:"createRow",value:function(t,e,n){var i=this.getLastRow(),r={model:t,action:e,view:null,el:n,handle:null,dims:i?s.object.extend({},i.dims):null,row_idx:this.rows.length,pos:i?i.pos.slice():[0,0],padding:this.settings.get("row_padding")},o=new l.DerivationRow(this,r);return n&&(n.datum(o),n.attr("id",t.id)),this.addModelEventListeners(t),this.rows.push(o),o}},{key:"addModelEventListeners",value:function(t){t.events.on("start-of-interaction."+this.id,this.atStartOfInteraction.bind(this)),t.events.on("end-of-interaction."+this.id,this.afterEndOfInteraction.bind(this)),t.events.on("change."+this.id,this.onChange.bind(this)),t.events.on("mistake."+this.id,this.events.mistake),t.events.on("create."+this.id,this.onCreate.bind(this)),t.events.on("spawn."+this.id,this.onSpawn.bind(this)),t.events.on("restraint."+this.id,this.onRestraint.bind(this))}},{key:"removeModelEventListeners",value:function(t){t.events.on("start-of-interaction."+this.id,null),t.events.on("end-of-interaction."+this.id,null),t.events.on("create."+this.id,null),t.events.on("mistake."+this.id,null),t.events.on("change."+this.id,null),t.events.on("spawn."+this.id,null),t.events.on("restraint."+this.id,null)}},{key:"atStartOfInteraction",value:function(t){t&&t.source&&("AlgebraModel"===t.source.type&&(this.startUpdateSequence(),this.dragging&&this.setDragging(!1)),this.events["start-of-interaction"](t),this.canvas_model&&this.canvas_model.lockActive(!0))}},{key:"afterEndOfInteraction",value:function(t){var e=this;if(t&&t.source)if(this.canvas_model&&this.canvas_model.lockActive(!1),"DerivationRow"===t.source.type)this.events["end-of-interaction"](t);else if("AlgebraModel"===t.source.type){this.isInUpdateSequence()&&this.finishUpdateSequence();var n=t.source,i=(o=this.getRowByModel(n)).view.settings.get("interaction_mode");if(this.canvas_model?this.canvas_model.setActive(this,!0):this.setActive(!0),"inspect"===i)o.updateDimensionAfterInteraction(),this.mapping_nodes=this.mapping_nodes.filter(function(t){return e.getRowByModel(t.get_root())}),this.events["end-of-interaction"](s.object.extend(t,{row:o.idx}));else if(("edit"===i||"edit-keypad"===i)&&n===this.getLastModel()&&(this.events["end-of-interaction"](t),this.rowBeforeCurrActionSeq))if(this.rowBeforeCurrActionSeq.model.stringify()===this.getLastModel().stringify()){this.rows.length;for(var r=0;this.getLastRow()!==this.rowBeforeCurrActionSeq;)this.undo(),r++;this.events.auto_undo({undos:r})}else{var o=this.rowBeforeCurrActionSeq,a=this.shouldHideRow(o);this.getLastView().callAfterAnimation(function(){this.startUpdateSequence(),a||o.unhide(),this.layoutRows(),this.finishUpdateSequence()}.bind(this))}this.rowBeforeCurrActionSeq=null,this.firstRowInSequence=null}}},{key:"addRowFromModel",value:function(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=this.getLastRow();r&&r.deactivate();var o=this.createRow(t,e),s=r?r.pos.slice():[0,0],a=this;if(this.settings.get("visualized")){var l={font_size:this.settings.get("font_size"),padding:this.settings.get("padding"),pos:s,v_align:this.settings.get("v_align"),h_align:this.settings.get("h_align")};o.createView(l,function(){a.events.added_line({type:"create",senderDL_id:a.id,action:e&&"string"!=typeof e?e:{name:"row added from model",newTree:t},row:o.idx}),i&&a.layoutRows(),n&&n(a)})}return o}},{key:"addRowFromAscii",value:function(t,e){var n={action_blacklist:this.settings.get("action_blacklist")};return this.addRowFromModel(new u.AlgebraModel(t,n),null,e)}},{key:"getRowByView",value:function(t){return this.rows.filter(function(e){return e.view===t})[0]}},{key:"updateAllRowBackgroundsAndHandles",value:function(t){for(var e=0;e<this.rows.length;e++){var n=this.rows[e];n.updateBackground(t),n.updateHandlePos(t)}}},{key:"shouldHideRow",value:function(t){var e=this.rows[t.idx+1];if(e&&e.action&&e.action.settings.layout_hint){if("same-line"===e.action.settings.layout_hint)return!0;if("new-line"===e.action.settings.layout_hint)return!1}if(this.settings.get("collapsed_mode"))return!0;if(this.settings.get("auto_collapse_repeated_actions")&&e&&t.action&&e.action&&t.action.name===e.action.name)return!0;if(this.canvas_model){var n=this.rows[this.rows.length-1],i={x:this.pos.x,y:this.pos.y+t.pos[1]+t.dims.height+this.settings.get("padding").top,width:this.dims.width,height:n.dims.height};return!this.canvas_model.isInFreeVisibleSpace(i,this)}return!1}},{key:"getFinalVerticalPos",value:function(t,e,n){n=n||0;for(var i=this.rows[n].pos[1],r=n+1;r<=t.idx;r++)this.rows[r-1].hidden&&!e||(i+=this.getVerticalAdvance(this.rows[r]));return i}},{key:"isAboveFinalVerticalPos",value:function(t){return t.pos[1]<this.getFinalVerticalPos(t)}},{key:"getUpmostPullableRow",value:function(t){var e;if(this.rows.length<2)return this.rows[0];if(this.isAboveFinalVerticalPos(this.rows[1]))e=0;else for(e=t.idx;e>=0&&(!this.rows[e].hidden||!this.rows[e].el)&&this.isAboveFinalVerticalPos(this.rows[e]);e--);return e===t.idx?null:this.rows[e+1]}},{key:"getHiddenAbove",value:function(t){var e=t.idx-1;if(this.rows[0].hidden)return this.rows[0];for(;e>=0&&(!this.rows[e].hidden||!this.rows[e].el||!this.rows[e].el);)e--;return-1===e?null:this.rows[e]}},{key:"getVisibleAbove",value:function(t){for(var e=t.idx-1;e>=0&&this.rows[e].hidden;)e--;return-1===e?null:this.rows[e]}},{key:"getVisibleRowOn",value:function(t){for(var e=t.idx,n=this.rows.length;e<n&&this.rows[e].hidden;)e++;return e===n?null:this.rows[e]}},{key:"getDistanceFromHome",value:function(t){var e=t.pos[0]-t.drag_pos[0],n=t.pos[1]-t.drag_pos[1];return Math.sqrt(e*e+n*n)}},{key:"setLastHandleVisibility",value:function(t){this.getLastRow().setHandleVisibility(t)}},{key:"updateHandleVisibilities",value:function(){for(var t=0;t<this.rows.length;t++)this.rows[t].setHandleVisibility()}},{key:"countVisibleRows",value:function(){for(var t=0,e=0;e<this.rows.length;e++)this.rows[e].hidden||t++;return t}},{key:"updateDims",value:function(){if(!this.isInUpdateSequence()){var t=1/0,e=1/0,n=-1/0,i=-1/0;this.rows.forEach(function(r){r.hidden||(t=Math.min(t,r.dims.x+r.pos[0]),e=Math.min(e,r.dims.y+r.pos[1]),n=Math.max(n,r.dims.x+r.dims.width+r.pos[0]),i=Math.max(i,r.dims.y+r.dims.height+r.pos[1]))},this),t-=this.settings.get("padding").left,n+=this.settings.get("padding").right,e-=this.settings.get("padding").top,i+=this.settings.get("padding").bottom;var r=t-this.dims.x,o=e-this.dims.y,s=this.dims.x!==t||this.dims.width!==n-t,a=this.dims.y!==e||this.dims.height!==i-e;return(s||a)&&(this.dims={x:t,y:e,width:n-t,height:i-e},this.dimsHaveChanged(r,o,s)),s||a}}},{key:"dimsHaveChanged",value:function(t,e,n){var i=[-this.dims.x+(this.settings.get("svg_no_overflow")?this.settings.get("svg_overflow_margin"):0),-this.dims.y+(this.settings.get("svg_no_overflow")?this.settings.get("svg_overflow_margin"):0)];this.alignment_correction.style({transform:"matrix(1,0,0,1,"+i[0]+","+i[1]+")","-webkit-transform":"matrix(1,0,0,1,"+i[0]+","+i[1]+")"}),(Math.abs(t)>.5||Math.abs(e)>.5)&&this.translateElement({x:this.pos.x+t,y:this.pos.y+e}),this.resizeElement(this.dims),n&&this.rows.forEach(function(t){t.updateBackground()}),this.forceIntoContainer()}},{key:"handlePackArranging",value:function(t,e,n){var i,r=this.rows[this.rows.length-1];if(n>0)if(this.isAboveFinalVerticalPos(t))i=this.getUpmostPullableRow(t);else{if(!(i=this.getHiddenAbove(t)))return;i.unhide(),this.events.pack_state(new l.DerivationRow.stateEvent(this)),i=this.rows[i.idx+1]}else{if(!(i=this.getVisibleAbove(t)))return;t.pos[1]<=i.pos[1]?(i.hide(),this.events.pack_state(new l.DerivationRow.stateEvent(this)),1===this.countVisibleRows()&&this.singleLineMode(!0)):i=this.rows[i.idx+1]}for(var o=i.idx;o<=r.idx;o++){var s=this.rows[o];s.pos[1]=Math.min(this.getFinalVerticalPos(s),s.pos[1]+n),s.pos[1]=Math.max(o>t.idx?this.getFinalVerticalPos(s,!1,t.idx):0,s.pos[1]),s.el&&(s.el.style("transform","translate("+s.pos[0]+"px,"+s.pos[1]+"px)"),s.el.style("-webkit-transform","translate("+s.pos[0]+"px,"+s.pos[1]+"px)"),this.events.pack_state(new l.DerivationRow.stateEvent(this)))}this.updateDims()}},{key:"setPackState",value:function(t){for(var e,n,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=0;r<this.rows.length;r++){var o=this.rows[r];t[r]&&!o.hidden?o.hide():!t[r]&&o.hidden&&o.unhide()}this.layoutRows(),!i&&(e=t,n=this.packState,e.length!==n.length||e.some(function(t,e){return t!==n[e]}))&&this.events.pack_state(new l.DerivationRow.stateEvent(this))}},{key:"setActiveDLComponent",value:function(t){this.active_dl_component!==t&&(this.active_dl_component=t,"none"!==this.active_dl_component&&(this.canvas_model?this.canvas_model.setActive(this):this.setActive(!0)),this.settings.get("visualized")&&(this.updateBGStyle(),this.updateHandleVisibilities()))}},{key:"setSubTypeActive",value:function(){this.settings.get("visualized")&&this.updateHandleVisibilities()}},{key:"clearTraceProperties",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(this.mapping_nodes=[]),this.rows.forEach(function(t){return t.model.for_each(function(t){delete t.trace_origin,delete t.traced})})}},{key:"updateBGStyle",value:function(){if(this.settings.get("show_bg")){var t=["bg"];t.push("arrange"!==this.mode?"edit":"arrange"),this.dragging?t.push("dragging"):this.active&&"inspect"!==this.mode&&"AV"!==this.active_dl_component&&t.push("active"),t.push("style"),this.element_div.attr("visibility",null).style(this.settings.get(t.join("_")))}}},{key:"getVerticalAdvance",value:function(t){if(0===t.idx)return 0;var e=this.settings.get("v_align");return"center"===e?this.rows[t.idx-1].dims.height/2+t.dims.height/2:"top"===e?this.rows[t.idx-1].dims.height:"bottom"===e||"alphabetic"===e?t.dims.height:void 0}},{key:"layoutRows",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.rows[0].pos,n=e[0],i=e[1];this.rows[0].idx=0;for(var r=1;r<this.rows.length;r++){var o=this.rows[r];if(o.idx=r,this.rows[r-1].hidden||(i+=this.getVerticalAdvance(o)),!o.dragging){var s=o.pos;s[0]===n&&s[1]===i||(s[0]=n,s[1]=i,s=s,o.showBackground(),o.el&&o.el.transition().duration(t?this.settings.get("row_transition_dur"):0).style("transform","matrix(1,0,0,1,"+s[0]+","+s[1]+")").style("-webkit-transform","matrix(1,0,0,1,"+s[0]+","+s[1]+")").each("end",function(t){t.hideBackground()}))}}this.element_div.selectAll(".dl-line").sort(function(t,e){return t.idx-e.idx}),this.updateDims()}},{key:"updateContainerDimensions",value:function(){this.svgDims=this.getContainerDimensions()}},{key:"getContainerDimensions",value:function(){return this.canvas_model.size()}},{key:"render",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setHandleProperties(),this.rows.forEach(function(t){t.cut||(t.view.render(!1),t.updateDims(),t.updateHandlePos(!0))}),this.updateDims(),this.layoutRows(t)}},{key:"undo",value:function(){if(!(this.rows.length<1)){var t=this.getLastRow();t.remove();for(var e=[],n=this.getLastRow();n.cut;)e.push(n),n.remove(),n=this.getLastRow();var i=(0,c.linkCoordinator)().unlinkElement(t.model),r=[];e.forEach(function(t){r.push((0,c.linkCoordinator)().unlinkElement(t.model))});var o=this.getLastRow(),s=this.settings.get("collapsed_mode");return o&&(o.unhide(),o.view.interactive(!0),o.view.render()),this.updateDims(),this.singleLineMode(s),this.updateBGStyle(),this.updateHandleVisibilities(),this.events.undo({id:this.id,derivation:this}),{undone_row:0===e.length?t:[t].concat(e),removed_links:0===r.length?i:[i].concat(r)}}}},{key:"redo",value:function(t){var e=t.undone_row,n=t.removed_links;if(Array.isArray(e)){for(;e.length>1;)this.rows.push(e.pop());e=e[0]}var i=this.addRowFromModel(e.model,e.action);if(this.settings.get("visualized")&&this.canvas_model&&i.view.setMode(this.canvas_model.getActiveTool()),this.rows.length>1&&this.settings.get("collapsed_mode")&&this.rows[this.rows.length-2].hide(),n.length>0&&Array.isArray(n[0])){for(;n.length>1;)(0,c.linkCoordinator)().addLinks(n.pop());n=n[0]}(0,c.linkCoordinator)().addLinks(n),this.events.redo({id:this.id,derivation:this}),this.updateBGStyle(),this.updateHandleVisibilities(),this.layoutRows()}},{key:"removeElement",value:function(){return a.CanvasElement.prototype.removeElement.call(this),this.events.removed({type:"removed",performee:this}),(0,c.linkCoordinator)().unlinkDL(this)}},{key:"forceIntoContainer",value:function(t){arguments.length,this.updateContainerDims();var e={x:this.pos.x,y:this.pos.y};this.canvas_model.horizontalScrollEnabled()||(e.x=Math.min(this.container_size.width-this.size.width,e.x)),e.x=Math.max(0,e.x),this.canvas_model.verticalScrollEnabled()||(e.y=Math.min(this.container_size.height-this.size.height,e.y)),e.y=Math.max(0,e.y),e.x===this.pos[0]&&e.x===this.pos[1]||this.translateElement(e)}},{key:"getAllDLs",value:function(){return this.coordinator?this.coordinator.dls:this.canvas_model?this.canvas_model.dls():[this]}},{key:"packState",get:function(){return this.rows.map(function(t){return!!t.hidden})}}],[{key:"fromJSON",value:function(t,e,n){var i=t.settings.eq;delete t.settings.eq,t.settings.font_size&&n&&n.fontSize()!==t.settings.font_size&&n.fontSize(t.settings.font_size);var r=void 0;return r=n?n.createDL(t.settings,null,"load"):new o.gmath.Derivation(null,null,o.gmath.object.merged(t.settings,{visualized:!1})),t.settings.eq=i,t.rows.forEach(function(e,n){r.addRowFromModel(e.model,e.action,function(){n===t.rows.length-1&&(r.rows.forEach(function(e,n){t.pack_state[n]&&e.hide()}),r.layoutRows(!1))},!1)}),r.translateElement(t.pos),r}},{key:"createFixedSingleLineDL",value:function(t,e,i){return(e=e||{}).keep_in_container=!1,e.draggable=!1,e.no_handles=!0,e.collapsed_mode=!0,e.show_bg=!1,e.h_align="h_align"in e?e.h_align:"center",new n(null,t,e,i)}}]),n}();new d.SettingsType("Derivation").defaults.setAll(d.SettingsType.get("CanvasElement").defaults.getAll()).setAll({eq:"",font_size:50,padding:{left:20,right:5,top:5,bottom:5},v_align:"center",h_align:"equals",action_blacklist:[],dont_init_eq:!1,pos:{x:"center",y:"center"},debug_lines:!1,border_radius:0,row_padding:{left:10,right:45,top:7,bottom:3},edit_mode_drag_box_width:30,handle_size_factor:.44,handle_pos_offset_factor:.5,handle_pos:"right",handle_stroke_color:"#ddd",row_border_color:"#ddd",row_background_color:"white",collapsed_mode:!0,draggable:!0,no_history:!1,no_handles:!1,hide_handles:!1,wiggle:[],cloning_on:!0,auto_collapse_repeated_actions:!0,auto_simplify_distributions:!0,auto_simplify_vector_additions:!0,auto_simplify_multiplicative_annihilators:!0,auto_simplify_multiplicative_identities:!0,auto_simplify_additive_identities:!0,modes:["edit","edit-keypad","inspect","arrange"],keypad_tool_confirm_mode:!1,send_events:!0,row_transition_dur:250,resizable:{x:!1,y:!1},graphics_caching:!1,svg_no_overflow:!1,svg_overflow_margin:500,trace_syms:!1,trace_color:"rgb(194, 219, 179)",trace_rect_radius:6,trace_active_border:"1px solid steelblue",trace_joint_width:16,trace_joint_length:8,trace_line_thickness:6,show_area_hints:!0,show_dest_hints:!0,show_action_names:!0,auto_trigger_actions:!1,scrub_precision:1,draw_term_traces_across_derivations:!0}),o.gmath.Derivation=p}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(107);Object.defineProperty(e,"FontLoader",{enumerable:!0,get:function(){return i.FontLoader}});var r=n(43);Object.defineProperty(e,"HitTester",{enumerable:!0,get:function(){return r.HitTester}});var o=n(369);Object.defineProperty(e,"Reselector",{enumerable:!0,get:function(){return o.Reselector}});var s=n(42);Object.defineProperty(e,"mtouch_events",{enumerable:!0,get:function(){return s.mtouch_events}});var a=n(106);Object.defineProperty(e,"drag_behavior",{enumerable:!0,get:function(){return a.drag_behavior}});var l=n(105);Object.defineProperty(e,"transform_behavior",{enumerable:!0,get:function(){return l.transform_behavior}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.asLeaf=function(t){this.prototype.name=t,this.prototype.bp=100,this.prototype.is_leaf_node=!0,i.gmath.expressions[t]=this,this.prototype.superAndSubscriptText=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r="";return!n||!this.has_script("subscript")||e&&e.var_subscripts_only&&"var"!==this.name||(r+=this.get_script("subscript")[t](e)),i&&this.has_script("superscript")&&(r+=this.get_script("superscript")[t](e)),r},this.prototype.to_string=function(){return this.value},this.prototype.to_ascii=function(t){var e=this.get_base().value,n=this.superAndSubscriptText("to_ascii",t);return n.length>0&&t&&t.subscripts_as_long_names?'"'+e+n+'"':e.toString()+n},this.prototype.to_latex=function(t){return this.hidden?"":""+this.get_base().value+this.superAndSubscriptText("to_latex",t)},this.prototype.is_group=function(){for(var t=0;t<arguments.length;t++)if(arguments[t]===this.name)return!0;return!1},this.prototype.get_value=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t&&e?this.value:t||e?this.get_base().value+this.superAndSubscriptText("to_ascii",{},t,e):this.get_base().value},this.prototype.set_value=function(t){this.has_children()?this.value=t:(this.get_base().value=t,this.value=this.to_ascii())},this.prototype.get_base=function(){return this.has_children()?this.children[0]:this},this.prototype.set_script=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"superscript",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.parent&&this.parent.is_leaf_node)throw new Error("Don't set script on base of a node with a script.");if(this.children.length>0){var r=this.get_script(e);r&&r.remove(),this.append(new i.gmath.expressions[e](t))}else this.append(new i.gmath.expressions[this.name](this.value)),this.append(new i.gmath.expressions[e](t));this.value=this.to_ascii(),n&&this.fix_scripts()},this.prototype.has_script=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"subscript";return this.children&&this.children.some(function(e){return e.is_group(t)})},this.prototype.get_script=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"subscript";return this.children&&this.children.find(function(e){return e.is_group(t)})},this.prototype.fix_scripts=function(){this.children&&this.children.forEach(function(t){return t.for_each(function(t){return t.fixed=!0})})}};var i=n(0);n(1),n(379)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=s(n(13)),o=s(n(205));function s(t){return t&&t.__esModule?t:{default:t}}var a=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.init(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),i(e,[{key:"initSettings",value:function(t){this.settings=new o.default(t)}},{key:"init",value:function(){throw'[ModeForm] Must define "init" method on child class.'}},{key:"render",value:function(){var t=this;this.identifyActiveMode();var n=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this,!1);return n.selectAll("input.gm-setting-radio").data(this.modes).property("checked",function(t){return t.active}).each(function(e,n){return e.active?t.updateHintText(n):null}),this.onChange("mode-form-input",this.updateHintText.bind(this)),n}},{key:"identifyActiveMode",value:function(){this.settings.match(this.modes)}},{key:"getSelection",value:function(){return this.div.select("input.gm-setting-radio:checked").datum()}},{key:"updateHintText",value:function(t){this.div.select("#mode-info").text(this.modes[t].effects)}},{key:"getFormValue",value:function(){return this.div.select('input[type="radio"]:checked')}},{key:"getFormValueModeIdx",value:function(){return this.getInputElements()[0].findIndex(function(t){return t.checked})}},{key:"setFormValue",value:function(t){var e=this.match(t);if(e){var n=this,i=this.div.selectAll("input.gm-setting-radio").filter(function(t){return t.name===e.name}).property("checked",!0);this.registeredListeners.forEach(function(t){i.on("change."+t)(n.modes.findIndex(function(t){return t===e}))})}}},{key:"onChange",value:function(t,e){var n=this;this.registeredListeners.push(t),this.getInputElements().on("change."+t,function(){var t=n.getFormValueModeIdx();e(t)})}},{key:"match",value:function(t){return this.modes.find(function(e){var n=e.options;return Object.keys(n).every(function(e){return t.hasOwnProperty(e)&&n[e]===t[e]})})}},{key:"writeData",value:function(){var t=this.getFormValue(),e=1===t.size()&&t.datum().options;1===t.size()&&e?this.settings.configure(e):e&&this.settings.revert(e),this.identifyActiveMode()}},{key:"getRadioInputs",value:function(){return this.div.selectAll("input.gm-setting-radio")}},{key:"getInputElements",value:function(){return this.getRadioInputs()}},{key:"saveCurrentSettingsOntoDocument",value:function(){this.settings.saveCurrentSettingsOntoDocument(this.getAffectedOptions())}},{key:"getAffectedOptions",value:function(){var t=new Set,e=!0,n=!1,i=void 0;try{for(var r,o=this.modes[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var s=r.value;for(var a in s.options)t.add(a)}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}return t}}]),e}();e.default=a},function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.ToolbarMenu=void 0;var r,o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(17),a=(r=n(85))&&r.__esModule?r:{default:r};e.ToolbarMenu=function(){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t,this.require_user=n.require_user,this.buttonLabel=n.label,this.dropdown=null,this.active=!1}return o(e,[{key:"setupMenu",value:function(e,n){var i=this;this.container=e.tools,this.dropdown=this.setupDropdown();var r=this.setupPanel(this.dropdown);return t(n).on("show.bs.dropdown",function(){i.active=!0,i.dropdown.classed("open",!0),i.checkUser(r,e)}).on("hide.bs.dropdown",this.close.bind(this)),this.dropdown.node()}},{key:"setupDropdown",value:function(){return((arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.container).append("div").classed("gm-menu-dropdown",!0).on("click",function(){return i.event.stopPropagation()})}},{key:"setupPanel",value:function(){return((arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.dropdown).append("div").classed("gm-menu-panel",!0)}},{key:"checkUser",value:function(t,e){t.selectAll("*").remove();var n=t.append("div").classed("panel-body",!0);!this.require_user||s.user.logged_in?this.loadContent(t,n,e):this.showMessage(t,null,null,e&&e.settings.get("custom_login_method"))}},{key:"showWorking",value:function(t,e){t.selectAll("*").remove(),t.attr("class","panel-body"),t.append("p").text(e||"Working...")}},{key:"showMessage",value:function(e,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"danger",a=arguments[3];e.selectAll("*").remove();var l=e.append("div").classed("panel-body gm-clear-after",!0),u=s.user.logged_in,c=u?o:"info";if(e.classed("panel-default",!1),["danger","warning","info","success"].forEach(function(t){l.classed("alert-"+t,c===t),e.classed("panel-"+t,c===t)}),u)l.append("p").html(n),l.append("button").property("type","button").classed("btn btn-default",!0).text("Ok").on("click",function(){t(r.button).trigger("click"),r.close()});else{var d=this;l.append("span").style("line-height","34px").text("Please login to access this functionality.").append("a").property("type","button").classed("btn btn-default",!0).text("Login").style("float","right").style("cursor","pointer").on("click",function(){i.event.preventDefault(),a?a():s.user.loginWithGoogle(),t(d.button).trigger("click"),d.close()})}}},{key:"showComplete",value:function(e,n){var i=this;e.selectAll("*").remove(),e.attr("class","alert alert-dismissable alert-success").text(n).style("margin-bottom",0).attr("role","alert").append("button").classed("close",!0).html("&times;").on("click",function(){t(i.button).trigger("click"),i.close()})}},{key:"close",value:function(){this.active=!1,this.dropdown.classed("open",!1)}},{key:"button",get:function(){return this.canvas.container.select("button."+(0,a.default)(this.buttonLabel)).node()}}]),e}()}).call(this,n(8),n(6))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.GeoGebraCanvasElement=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.callWhenGGBIsReady=u;var r=n(0),o=n(19),s=n(10),a=[],l=!1;function u(t){window.GGBApplet&&t?t():a.push(t),l||(l=!0,r.gmath.loadScripts(["https://tube.geogebra.org/scripts/deployggb.js"],function(){a.forEach(function(t){return t()}),a=[]}))}e.GeoGebraCanvasElement=function(e){function n(e,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(t,e){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,i,o,"GeoGebraElement"));return a.type="ggb-element",a.events=r.gmath.extend(a.events,t.dispatch("ggb_add","ggb_remove","ggb_update","ggb_rename","ggb_click","ggb_init")),a.ggb_objs=[],a.adding_ggb_object_for_row=void 0,a.dont_update=void 0,a.links=[],a.ggbApplet=null,a.init(s),a.initPosition(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,o.CanvasElement),i(n,[{key:"init",value:function(t){this.element_div.style("overflow","hidden"),this.element_div.classed("ggbApplet"+this.id,!0),this.div=this.element_div.append("div").attr("id","ggbApplet"+this.id).style("margin-left","-1px").style("margin-top","-1px");var e=window.ggbOnInit;window.ggbOnInit=function(n){this.element_div.select(".gm-center-flex-container").remove(),n===this.id?(this.settings.get("ggbBase64")&&this.ggbApplet.setBase64(this.settings.get("ggbBase64")),this.ggbApplet=this.ggbLoader.getAppletObject(),this.ggbApplet.registerUpdateListener(this.events.ggb_update.bind(this)),this.ggbApplet.registerAddListener(this.events.ggb_add.bind(this)),this.ggbApplet.registerRemoveListener(this.events.ggb_remove.bind(this)),this.ggbApplet.registerRenameListener(this.events.ggb_rename.bind(this)),this.ggbApplet.registerClickListener(this.events.ggb_click.bind(this)),setTimeout(function(){this.div.selectAll("*").style("box-sizing","content-box","important"),this.subTypeResize(),t&&t(this)}.bind(this),1),this.events.ggb_init(this)):e(n)}.bind(this),this.element_div.append("div").classed("gm-center-flex-container",!0).style("z-index",100).append("div").classed("lds-dual-ring",!0),u(function(){var t=r.gmath.object.merged(this.settings.get("ggb_params"),{width:this.size.width,height:this.size.height,id:this.id,scaleContainerClass:"ggbApplet"+this.id,appName:this.settings.get("ggb_app_name")});"classic"===this.settings.get("ggb_app_name")&&(t.showAlgebraInput=!1),this.settings.get("ggb_base64")?t.ggbBase64=this.settings.get("ggb_base64"):t.ggbBase64=this.settings.get("ggb_base64_defaults")[this.settings.get("ggb_app_name")]||"",this.ggbLoader=new GGBApplet(t,!0),this.ggbLoader.inject("ggbApplet"+this.id)}.bind(this))}},{key:"subTypeResize",value:function(){this.ggbApplet.setWidth(this.size.width),this.ggbApplet.setHeight(this.size.height)}},{key:"removeElement",value:function(){var t=this;(function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0})(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"removeElement",this).call(this);var e=this.canvas_model.elements().find(function(e){return"ggb-panel"===e.type&&e.ggbElement===t});e&&this.canvas_model.removeElement(e)}},{key:"toJSON",value:function(){return r.gmath.object.merged(this.settings.getModified(),{type:"GeoGebraCanvasElement",id:this.id,pos:r.gmath.deepCopy(this.pos),size:r.gmath.deepCopy(this.size),ggb_base64:this.ggbApplet.getBase64()})}}],[{key:"fromJSON",value:function(t,e,n){return n.createElement("ggb-element",t)}}]),n}(),new s.SettingsType("GeoGebraElement").defaults.setAll(s.SettingsType.get("CanvasElement").defaults.getAll()).setAll({type:"GeoGebraCanvasElement",resizable:{x:!0,y:!0},min_size:{width:300,height:300},edit_mode_drag_box_width:-20,bg_edit_style:{border:"1px solid silver"},ggb_app_name:"classic",ggb_params:{borderColor:null,showMenuBar:!0,allowStyleBar:!0,showAlgebraInput:!0,showToolBar:!0,showTutorialLink:!1,showResetIcon:!1,enableLabelDrags:!1,enableShiftDragZoom:!0,enableRightClick:!0,errorDialogsActive:!0,useBrowserForJS:!0,preventFocus:!0,showToolBarHelp:!1,language:"en",allowUpscale:!1},ggb_base64:"",ggb_base64_defaults:{classic:"UEsDBBQACAgIAFFJ+UwAAAAAAAAAAAAAAAAXAAAAZ2VvZ2VicmFfZGVmYXVsdHMyZC54bWztmltv2zYUx5/XT0HoaXuILcl27ARRirTAsAJpGixBsVdaOpa5UKQmUrGcT1+KlHWpL3MUdU4z5yH0kXkRf/+jw0PKF++ziKJHSAThzLOcnm0hYD4PCAs9K5Wzk4n1/vLdRQg8hGmC0YwnEZaeNcprlu2U1RuOx/k1HMee5VMsBPEtFFMs8yaetbAQygQ5Z/wGRyBi7MOdP4cIX3MfS93LXMr4vN9fLBa91Xg9noT9MJS9TAQWUvfKhGcVH85Vd41Gi4Gu7tq20//r87Xp/oQwITHzwUJqHgHMcEqlUB+BQgRMIrmMwbNiTpi0EMVToJ51m1vo11kC8JuFikYKj21dvvvlQsz5AvHp3+CrazJJoWynjX5eR339kVOeoMSzXMdCYd5alVNVnrkKE43n2LNsU5viJSToEdPyCk4l93UH+uoMUwGrumqozzwA882wqM9IpDEiIUEpoIYSMUCgP5kpOlqOpVa21p/PeRIIlHnWDb6x0LIon0ypq2g4d+SpGHJUvyqXFGp3ftEvuO5HOIAYWKAqNTA7rTCfjTXmvJia4gh5B+TTI+RtkJ3nU/7C6mzdY5zo0oU/sT8hVPdcRzw4Iu4ScdN/h/9PuLqKwSjy/yqR4VFMIeuQPSWs4nitjZK72y6/sDV2W0O3D4Lcbo08x2HgyTnxHxgIkZOt+s0//EECtXzp8bhKHIlUPTnjiekB/mENyYhSjKg6u2WYpcyXOqQUaD+myWNdi8HQPoQaVZ9di9GatGsPd7MUEOZWyeVuZVeO3S6jOzp23bEhqxxbcUolze/rE5NqFwbamcXaxB8A4ns10Bd2n2Am8q1Y08+2q5rg5S5FR0dFfzZFVzHv5itOSp1StTOYqZkFdXHbJVd1cd3RqJK3544OrfAzVoKNRNplRK/W3Z/py9241Wm7mJGvPxsx9sav2K0e1fR4xeNrYVb5xTHXe34A3ZCg40SCIJj9246HLsPaM367sks9xkaPl2ZJ3e6aeo5t/pzhme04p457aKF3I25sbm7LCxVk52WQS0d4I4/Ndpo+Z/n5+WpzYqyS4/CNBY8OUisSAjMxVyCU2bra0taNn+zizUbmaHvp6G+fHHNZt1c3npAMXZkWV6bilWuKgSmGphiVgNptPbW0sYpbtfT6u8Vh2G6/9HOFki6C7auT/T9I41kaQVILDjcru3SfkQkPqr8UGtLuEQy2+cl2rxCUBMqFIqJEOlHqRTjTKuKp4DSVcOcnAKx6zWcceUECOc+VVGPPSJa7i+kTzXlCnjiTJQ2UPwdXVL8QbJyQbHIfd1cS23DWlwVozEJaPY9XxqoUMG8AdKXvzwY3CVNnaBcIT3vuZOBMRgN77IzPRpPTPZE6kwqp+WJvoo2AU8jRZkX5ccHmWSHDra8Uo0ExYuJXZ7gDu2O3WNtN/l5eqPZBr/FgUTvMWtUfdmZIuZ+K6hzcWCWhyRvLb3CaEUpwslwf6YWZz3bCErIqw7jXRu2HDK8Q8PapKOxhdWufjFX7uYCZzIwoigxHqoEZhLAP2H8IE56yYH3V6mTqzqF9azu0KecUcBWIPqzs2mvqtTxhG6AXrAVdEfLn4D9MedZY2nbHGCKqJ+BaG7X3xxuegP1nmT9AzXmeHNwV2pzq7ftS82TtDLBf+ylVf/VzrctvUEsHCL92CiLYBAAAUCYAAFBLAwQUAAgICABRSflMAAAAAAAAAAAAAAAAFwAAAGdlb2dlYnJhX2RlZmF1bHRzM2QueG1s7ZfdbtowFMev16ewfF9ihwRKRVqh7mKT2mpTb3ZrnAN4C3Yam4/01fYOe6b5I9DQQbWibtO0cRF/nXNs//6JfRherucFWkKlhZIZph2CEUiuciGnGV6YyekZvrw4GU5BTWFcMTRR1ZyZDKfOcutnW52k33d9rCwzzAumteAYlQUzziXDK4zQWotzqW7ZHHTJONzxGczZteLM+CgzY8rzKFqtVp3NfB1VTaPp1HTWOsfIrlXqDDeVcxtux2nV9eYxITT6dHMdwp8KqQ2THDCy+8hhwhaF0bYKBcxBGmTqEuyKlRS8a+co2BiKDL+Xxm4OuFsZ4otqaf0b5wx3aUrwxcmboZ6pFVLjz9Yuw6ZawNbfNyJnY4evVKEqVGU4TlOMLFga9zEaZ9jxKsoZs7UOJeFHkwGhtEfj4F6wGiq0ZIWz9j1sYRT3EX3vhBUaNrZ27huVQxhJGnsp5p4w0gasOBQjXQLkvhZ2T7xStRe9HU9IuDN1AcjMBP8iQVv6acvJVd6JPAf37gQfEFOQSwtEVdoqTvwsNfHmD6R5xdbUt2vqRx9o6Pb+dqmVWKNR8BgFw1Ecim4oklCkWyRwL8M6tXtmuGSVfclsIO7Gh1Gj9Q+qs7XQLdFHrvl2R2jSPUpo4mUmT0X+SyU9TBc1dbB7/vb1edj+K+KsMqAFky3sV27gKffev879MEgbX0KL3wff3uFnz8Cj+A0GHmBMBx6hL7cnVPpaGLlSVa7ROhwC4Wjwz9U25IS5K6iZ5eDZuA8qORKqKuoZ5JWSj1xbXY9ouw3aY76kF98XNFwXhHo56CBuyZE0UNJBjyS95NXUOfYlP8xWgtlu9NbV2zTT/zRfRvN+wXJ/9jab/bhpt6nS4/ITkuw/QDv9VwPyK5KKvSmF6wx5Qx2Kh3gb8KVZBhr1QtEPxVkoBgczEDEvC8GFeV5KvagmNhHedyk2Q7uqJn9K1cfAv+VipD97hkethD7a/Gm4+A5QSwcIi4w0oeQCAADWDAAAUEsDBBQACAgIAFFJ+UwAAAAAAAAAAAAAAAAWAAAAZ2VvZ2VicmFfamF2YXNjcmlwdC5qc0srzUsuyczPU0hPT/LP88zLLNHQVKiuBQBQSwcI1je9uRkAAAAXAAAAUEsDBBQACAgIAFFJ+UwAAAAAAAAAAAAAAAAMAAAAZ2VvZ2VicmEueG1srVdfb9s4DH/ePgXh5zaRZMl/hmRDu9sBB+yG4Xp3ONybY6uJUMc2LKVph334IyXbSbbe0K5FIsiiKZI/kiLlxbu7bQ23urembZYRn7EIdFO2lWnWy2jnrs+z6N3b14u1btd61Rdw3fbbwi0jRZzTPlzNZJoSrei6ZVTWhbWmjKCrC0dbltE+AlMtI5awD/KXD/yccZmfS64uz/PLS3ae/cov84tMXmSxiADurHnTtJ+KrbZdUeqrcqO3xce2LJzXt3GuezOf7/f72WjZrO3X8/V6NbuzVQSIqrHLaHh4g+JONu1jzy4Y4/N/fv8YxJ+bxrqiKXUEhHhn3r5+tdibpmr3sDeV2yDOPItgo816gy6QDOHOialDP3S6dOZWW9x6tPSY3baLPFvR0PtX4QnqCU4Elbk1le7RP7OECyYZj+M0zUUi4wja3ujGDbx80DkfpS1ujd4HsfTkNUqWpxgeY82q1svouqgtojLNdY8eRYP6HS6tu6/1qujH9cEefuZ/yGK+6AFocAS+Y+yMRopDqcEDR6oVx/i5tq29ZAZfgYNiOIDncAZJihQBXIFESoaUFGKiKS4hBmLhMUiJsyQyT+idwv2KAedIBsFACBAcRIxLpUAloFLaKJA3yb0whoO40RwcMdHiGIenxRKHoCcUpIIYNELFiX9SxI3ylSDzPTHOQOaoiAgq5RCjDbhOGaDEmMRzD0IyoD8HSeJFCiIDlIe4STITPwjKsD5EZSB8E5YxKOqhoCQ4prQ8zofTkGAEGGI7o4mHSQQqC0sWh0mESYZJBR4ZdsrAGoAyGXgoXZ+HcMQXPwVfdoSPEwiMB1nvpxjIbu7tp0kOyyQsfZYxzgZqFqg5LZNngol/Cgw/0hpO5lOUTvlBpeqxKp+Ul99WiwPKJHkCymc690HXKqxJ9PfjO5Xxs2D+jMbk5OC9DGCZPVo9F9kTusCLqEzZg6UmzHyYXyYO+ePj8NyyNDlC/VjlYj4248XgBLAb4h3OsdNbS25JU0hjSMTUHRPqX0OLTAWkCtLkqFGeUatM1KFbUq/MTrqlyo5aJvbLhIip77/YpKjhhfYp5NhBz4Ye+vW7HootTx66HhpIojgAtmhIqEAO7Q+tEFMDFIp6oEgAm6QSkFAR/p9eiPfC1prJtxtdd5PXvRtN0+3c4LqBXm6r0Y2uRfai9te+YUPVljeXk7eHLbqw7lgu3pkON7Nwhzq5uL1a1MVK13j1vaJcALgtaipvXsN12zgY0gBrlxfn74gLvStrU5mi+RtjP17IPu22K92Df2wJpRdC2+HBy2QsVWAp27avru4tpgrc/av7lgqOmPFM5jlLkpgzzOX78IIn6SzPYp6yNMPii1c+WxaU4oLPUpWzPI/zlOM1kqHL7x9+x/OgV99eaecQu4XiTtvR1+veVMfPv9nLtq4mr3atadz7onO73n8xoG09Abpo1rX2XvQRxvt1ebNq7668+0QSZP153+nJv6v1+7Zue8DzJ5RChmFehdnzkGETF/M8zHOw8J6ETu95LjyHn1dh9lwY4GDaAJSPKNmoxdjwrRKdnF6fHHRZ3zXGfRwXzpQ3B6DEH0I/evBUJH8hkYv5N1m3uNF9o+uQQQ3GcdfubEjgECpvx87qz4XbXDTVH3qNx+9zQSXQoejAerC40qXZ4sZAHzxXUFT/QlMDtdLrXo8Iw3EMfh3ODdiu10VlN1q7ybshvw9sLMAZzV/Ysjcd5SGssADf6EOuVcYWWMCrI0SE1aLRJdUS9Jsjn+E36M5t2t5/VxWOKKThmNUf3uHD8e1/UEsHCGQcb6lABQAABA8AAFBLAQIUABQACAgIAFFJ+Uy/dgoi2AQAAFAmAAAXAAAAAAAAAAAAAAAAAAAAAABnZW9nZWJyYV9kZWZhdWx0czJkLnhtbFBLAQIUABQACAgIAFFJ+UyLjDSh5AIAANYMAAAXAAAAAAAAAAAAAAAAAB0FAABnZW9nZWJyYV9kZWZhdWx0czNkLnhtbFBLAQIUABQACAgIAFFJ+UzWN725GQAAABcAAAAWAAAAAAAAAAAAAAAAAEYIAABnZW9nZWJyYV9qYXZhc2NyaXB0LmpzUEsBAhQAFAAICAgAUUn5TGQcb6lABQAABA8AAAwAAAAAAAAAAAAAAAAAowgAAGdlb2dlYnJhLnhtbFBLBQYAAAAABAAEAAgBAAAdDgAAAAA="}})}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.gcAuth=e.googleAuth=e.ExternalAPI=void 0;var i=n(95);Object.defineProperty(e,"ExternalAPI",{enumerable:!0,get:function(){return i.ExternalAPI}});var r=n(225),o=n(224),s=n(56),a=e.googleAuth=new o.GoogleAuthStrategy,l=e.gcAuth=new r.GCAuthStrategy(a);l.is_ready?s.YTLoader.allowLoading():l.events.on("APIReady.aaoi6eq4=darst30d",function(){return s.YTLoader.allowLoading()})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ApplyFormulaAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),s=(n(1),n(2)),a=n(5),l=(i=n(4))&&i.__esModule?i:{default:i},u=n(3),c=n(46),d=n(114),h=e.ApplyFormulaAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"ApplyFormulaAction","apply formula"));return n.initSettings(t),t&&t.mapping&&(n.settings.mapping=t.mapping),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.Action),r(e,[{key:"toJSON",value:function(){var t=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"toJSON",this).call(this);return t.type="ApplyFormulaAction",t.nodes=this.nodes.map(function(t){return t.to_ascii()}).join(";"),t}},{key:"getAllAvailableActions",value:function(t,e){var n=this;if(2!==t.length)return[];if(t[0].parent||t[1].parent||e.parent)return[];var i=e.clone(),r=new d.NodeMap(i.get_1to1_mapping_to(e)),o=this.normalize(i),s=this.normalize(t[0].clone()),a=new c.AlgebraRegExp;return a.simple_models.push(this.turnIntoMatcherModel(s)),a.matchSubExpressions(o).map(function(i){return n.createBoundAction(e,{nodes:t,target:r.map(i.nodes)})})}},{key:"rematch",value:function(){var t=this;return!!(this.target&&this.target.length>0)&&this.getAllAvailableActions(this.nodes,this.target[0].get_root()).some(function(e){return o.gmath.array.equals(e.target,t.target)})}},{key:"rebind",value:function(t,e,n){if(this.oldTree!==n)throw"wrong old tree during rebinding an action!";var i=new d.NodeMap(e);this.oldTree=t,this.target=this.target.map(function(t){return i.map(t)[0]})}},{key:"turnIntoMatcherModel",value:function(t,e){return t.for_each(function(t){if(t instanceof u.Var){var n=new o.gmath.expressions.placeholder("any");n.match_name=t.value,t.replace_with(n),e&&e._map[t.id]&&(e._map[n.id]=e._map[t.id],delete e._map[t.id])}}),t}},{key:"autogenerateSelectorMappings",value:function(t,e){var n=[],i=[];t.filter(function(t){return t.is_group("var")}).forEach(function(e){return n.push(t.getSelectorOfNodes([e]))}),e.filter(function(t){return t.is_group("var")}).forEach(function(t){return i.push(e.getSelectorOfNodes([t]))});var r={};return n.forEach(function(t){r[t]=i.filter(function(e){return e.split(":")[0]===t.split(":")[0]}).join(";")}),r}},{key:"setupFormulaNodeMap",value:function(t,e){var n=this.settings.mapping||this.autogenerateSelectorMappings(t,e),i={};for(var r in n)i[t.getNodesFromSelector(r)[0].id]=e.getNodesFromSelector(n[r]);return new d.NodeMap(i,t,e)}},{key:"normalize",value:function(t,e){return t.for_each(function(t){if(t.is_group("sub")){var e=t.children[1];e.is_group("product")&&(e=e.get_child([0,1]));var n=e.parent;e.remove();var i=new u.Sign(e);i.normalized=!0,n.append(i),t.invert()}}),t}},{key:"replaceMatches",value:function(t,e,n,i){var r=e.clone().compose(n);return Object.keys(i).map(function(i){t.getNodes(i).forEach(function(t){var i=n.unmap(t);if(0!==i.length){var o=e.unmap(i[0])[0].clone();t.replace_with(o),u.Brackets.handle(o),i.forEach(function(t){var n=e.unmap(t)[0];r.extend(n.get_1to1_mapping_to(o))})}})}),r.removeDeletedTargetNodes(),r}},{key:"transform",value:function(t){var e=this,n=this.target.map(function(t){return e.getNewTreeNode(t)}),i=new d.NodeMap(this.node_map,this.oldTree,this.newTree);n.forEach(function(t){return e.normalize(t)});var r=this.normalize(this.nodes[0].clone()),o=this.nodes[1].clone(),s=this.setupFormulaNodeMap(r,o);this.turnIntoMatcherModel(r,s);var a=new c.AlgebraRegExp;a.simple_models.push(r);var l=a.match(n);if(!l)throw"Didn't match!";var h=a.node_map,p=this.replaceMatches(o,h,s,l),f=n[0].parent,g=Math.min.apply(null,n.map(function(t){return t.get_idx()}));n.forEach(function(t){return t.remove()});var m=o.children[0];return n.length>1&&(m=new n[0].constructor(m)).is_group("mul")&&n[0].is_group("div")&&m.invert(),f.insert(g,m),i.compose(p),this.updateNodeMap(i._map),f.parent&&"removed"===u.Brackets.handle(f,!0)&&(f=m.parent||m),this.cleanup(f)||u.Brackets.handle(m),f.for_each(function(t){if(t.normalized){delete t.normalized;var e=t.parent;e&&e.is_group("mul","div")&&(!e.ls||"//"===e.ls.value)&&e.parent.parent&&e.parent.parent.is_group("add","sub")&&(t.replace_with(t.children[1]),e.parent.parent.invert()),e&&e.is_group("add","sub")&&(t.replace_with(t.children[1]),e.invert())}}),"function"==typeof t&&t(this),!0}}],[{key:"fromJSON",value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var r=s.Action.fromJSON.apply(s.Action,[t].concat(n));return r.nodes=t.nodes.split(";").map(function(t){return new a.AlgebraModel(t)}),r}}]),e}();(0,l.default)(h)},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.mtouch_events=r,e.d3_eventDispatch=o;var i=n(0);function r(){var e=o(T,"tap","dbltap","hold","drag","mdrag","touch","release"),n=i.gmath.uid(),s=null,l=[],u={},c=[],d="mouse",h="client",p=null,f=!1,g=r.defaultOptions.input_types,m=r.defaultOptions.tap_max_time,v=r.defaultOptions.tap_max_dist,y=v*v,b=r.defaultOptions.hold_time,_=r.defaultOptions.hold_max_dist,x=_*_,w=r.defaultOptions.dbltap_max_delay,A=r.defaultOptions.dbltap_max_dist,k=r.defaultOptions.zoom;function T(){s=this,T.connected(!0)}function S(){if("buttons"in(e=t.event)?1===e.buttons:"which"in e?1===e.which:1===e.button){var e,n=t.select(window),i=this,r=arguments;n.on("mousemove.mtouch",function(){E.apply(i,r)}),n.on("mouseup.mtouch",function(){n.on("mousemove.mtouch",null),n.on("mouseup.mtouch",null),N.apply(i,r)}),M.apply(this,arguments)}}function M(){t.event.preventDefault();for(var n=e.of(this,arguments),i=q(),r=p?p.apply(this,arguments):null,o=0,s=i.length;o<s;o++){var a=new O(i[o].identifier,n,this,r);l.push(a),u[i[o].identifier]=a,n({type:"touch",finger:a,fingers:l,idx:T.idx})}}function E(){t.event.preventDefault();for(var n=e.of(this,arguments),i=q(),r=0,o=l.length;r<o;r++)l[r].changed=!1;var s=[];for(r=0,o=i.length;r<o;r++){var a=u[i[r].identifier];a&&(a.move(n),s.push(a))}n({type:"mdrag",dragged_fingers:s,fingers:l})}function N(){t.event.preventDefault();for(var n=e.of(this,arguments),i=q(),r=0,o=i.length;r<o;r++){var s=u[i[r].identifier];s&&(delete u[i[r].identifier],l=t.values(u),s.setEndTime(),n({type:"release",finger:s,fingers:l,isTapOrDoubleTap:s.isTapOrDoubleTap()}),s.end(n))}}function O(e,n,i,r){this.id=e,this.target=i,this.event=n,this.parent=i.parentNode,this.timeStamp0=t.event.timeStamp,this.timeStamp=this.timeStamp0,this.hold_timer=setTimeout(this.held.bind(this),b),this.pos=r?r.slice():C(this.id,h),this.pos0=[this.pos[0],this.pos[1]],this.pos_client=C(this.id,"client"),this.dist_x=0,this.dist_y=0,this.dx=0,this.dy=0,this.dt=0,this.changed=!0,this.gesture=null}function q(){return t.event.changedTouches||[{identifier:d}]}function C(e,n){if("client"===n){if(e===d)return[t.event.clientX/k,t.event.clientY/k];for(var i=0;i<t.event.touches.length;i++)if((r=t.event.touches[i]).identifier===e)return[r.clientX/k,r.clientY/k]}else{if(e===d)return a(n,t.event,k);for(i=0;i<t.event.touches.length;i++){var r;if((r=t.event.touches[i]).identifier===e)return a(n,r,k)}}}return T.connected=function(t){if(0==arguments.length)return f;if(!s)return this;var e="all"===g||"touch"===g,i="all"===g||"mouse"===g;return s.on("touchstart."+n,t&&e?M:null).on("mousedown."+n,t&&i?S:null).on("touchmove."+n,t&&e?E:null).on("touchend."+n,t&&e?N:null).on("touchcancel."+n,t&&e?N:null),f=t,this},T.call=function(t){return t.apply(T,arguments),this},T.input_types=function(t){return 0===arguments.length?g:(g!==t&&(g=t,T.connected(f)),this)},T.frame=function(t){return 0===arguments.length?h:(h=t,this)},T.origin=function(t){return 0===arguments.length?p:(p=t,this)},T.zoom=function(t){return 0===arguments.length?k:(k=t,this)},T.hold_time=function(t){return 0===arguments.length?b:(b=t,this)},T.fingers=function(){return l},T.hold_max_dist=function(t){return 0===arguments.length?_:(x=(_=t)*_,this)},T.dbltap_max_dist=function(t){return 0===arguments.length?A:(A=t,this)},O.prototype.cancel_hold=function(){this.hold_timer&&clearTimeout(this.hold_timer),this.hold_timer=null},O.prototype.held=function(){this.event({type:"hold",finger:this,fingers:l}),this.hold_timer=null},O.prototype.move=function(e){this.changed=!0,this.event=e;var n=C(this.id,"client"),i=t.event.timeStamp;this.dx=n[0]-this.pos_client[0],this.dy=n[1]-this.pos_client[1],this.pos[0]+=this.dx,this.pos[1]+=this.dy,this.dist_x=this.pos[0]-this.pos0[0],this.dist_y=this.pos[1]-this.pos0[1],this.pos_client=n,this.dt=i-this.timeStamp,this.timeStamp=i,this.dist_x*this.dist_x+this.dist_y*this.dist_y>x&&this.cancel_hold(),this.gesture||e({type:"drag",finger:this,x:this.pos[0],y:this.pos[1],dx:this.dx,dy:this.dy,fingers:l})},O.prototype.setEndTime=function(){this.endTimeStamp=t.event.timeStamp},O.prototype.end=function(e){this.isTapOrDoubleTap()&&(function(t,e,n){var i=-1,r=[e,n];return c=c.filter(function(e,n){var o,s;return t-e.timeStamp<=w&&(o=e.pos,s=r,Math.sqrt((o[0]-s[0])*(o[0]-s[0])+(o[1]-s[1])*(o[1]-s[1]))<=A)&&(i=n),e.timeStamp-t<=w&&i!==n}),-1===i&&c.push({timeStamp:t,pos:r}),-1!==i}(t.event.timeStamp,this.pos[0],this.pos[1])?e({type:"dbltap",finger:this,fingers:l}):e({type:"tap",finger:this,fingers:l})),this.cancel_hold()},O.prototype.isTapOrDoubleTap=function(){return this.endTimeStamp-this.timeStamp0<=m&&this.dist_x*this.dist_x+this.dist_y*this.dist_y<=y},t.rebind(T,e,"on")}function o(e){var n=t.dispatch.apply(this,Array.apply(null,arguments).slice(1));return n.of=function(i,r){return function(o){try{var s=o.sourceEvent=t.event;o.target=e,t.event=o,n[o.type].apply(i,r)}finally{t.event=s}}},n}r.defaultOptions={zoom:1,input_types:"all",tap_max_time:250,tap_max_dist:10,hold_time:500,hold_max_dist:10,dbltap_max_delay:400,dbltap_max_dist:20},i.gmath.mtouch_defaults=r.defaultOptions,i.gmath.mtouch_events=r,i.gmath.d3_eventDispatch=o;var s=0;function a(e,n,i){var r=e.ownerSVGElement||e;if(r.createSVGPoint){var o=r.createSVGPoint();if(s<0&&(window.scrollX||window.scrollY)){var a=(r=t.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();s=!(a.f||a.e),r.remove()}return s?(o.x=n.pageX,o.y=n.pageY):(o.x=n.clientX,o.y=n.clientY),[(o=o.matrixTransform(e.getScreenCTM().inverse())).x/i,o.y/i]}var l=e.getBoundingClientRect();return[(n.clientX-l.left-e.clientLeft)/i,(n.clientY-l.top-e.clientTop)/i]}"undefined"!=typeof window&&(s=/WebKit/.test(window.navigator.userAgent)?-1:0)}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HitTester=void 0;var i=n(0),r=e.HitTester={};i.gmath.HitTester=r,r.draw=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2],i=t.selectAll(".gm-target").data(e);i.enter().append("div").classed("gm-area",!0).classed("gm-target",!0),i.style("left",function(t){return t.x+"px"}).style("top",function(t){return t.y+"px"}).style("width",function(t){return t.width+"px"}).style("height",function(t){return t.height+"px"}),i.exit().remove();var r=t.selectAll(".gm-source").data(n?[n]:[]);r.enter().append("div").classed("gm-area",!0).classed("gm-source",!0),r.style("left",function(t){return t.x+"px"}).style("top",function(t){return t.y+"px"}).style("width",function(t){return t.width+"px"}).style("height",function(t){return t.height+"px"}),r.exit().remove()},r.drawDestinationHints=function(t,e){var n=t.select(".destination-main");if(e&&0!==e.destination_hint_boxes.length){0===n.size()&&(n=t.insert("div",".gm-math").classed("destination-main",!0).style("opacity",.5));var i=e.destination_hint_boxes,r=n.selectAll(".gm-destination").data(i);r.enter().insert("div",".gm-math").classed("gm-area",!0).classed("gm-destination",!0),r.style("left",function(t){return t.x+"px"}).style("top",function(t){return t.y+"px"}).style("width",function(t){return t.width+"px"}).style("height",function(t){return t.height+"px"}),r.exit().remove()}else n.remove()},r.drawDropAreaHints=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=t.select(".drop-area-main");if(0!==e.length){0===n.size()&&(n=t.insert("div",".gm-math").classed("drop-area-main",!0).style("opacity",.15));var i=n.selectAll(".gm-drop").data(e.filter(function(t){return!t.drop_area_hint.hidden&&!t.settings.dummy}));i.enter().append("div").classed("gm-area",!0).classed("gm-drop",!0).style("z-index",function(t){return t.priority}),i.style("left",function(t){return t.drop_area_hint_box.x+"px"}).style("top",function(t){return t.drop_area_hint_box.y+"px"}).style("width",function(t){return t.drop_area_hint_box.width+"px"}).style("height",function(t){return t.drop_area_hint_box.height+"px"}).style("background-color",function(t){return"outside"===t.drop_area_hint.side?"transparent":null}),i.exit().remove()}else n.remove()},r.getBoundingBox=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=1/0,r=-1/0,o=1/0,s=-1/0,a=0;a<t.length;a++){var l=t[a];if(l.sel_box&&(!l.hidden||l.smooshing)){var u=n?l.x0||0:l.x,c=n?l.y0||0:l.y;i=Math.min(i,l.sel_box.x+u),r=Math.max(r,l.sel_box.x+u+l.sel_box.width),o=Math.min(o,l.sel_box.y+c),s=Math.max(s,l.sel_box.y+c+l.sel_box.height)}}var d=r-i,h=s-o;return{x:i+d*(1-e)/2,y:o+h*(1-e)/2,width:d*e,height:h*e}},r.setTargetRegions=function(t,e,n){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];t.forEach(function(t){t.raw_target_box=r.getRawTargetBox(t.target,t.settings.side);var n=t.getDropArea(),o=r.getRawTargetBox(n.node,n.side);if(t.settings.target_group){var s=t.target.get_parent(1);if(s.is_group("fraction")&&"around"===t.settings.group_side){var a=r.getRawTargetBox(s,"around"),l=t.target.is_group("mul")?s.get_top():s.get_bottom();(o=r.getRawTargetBox(l,"around")).width=a.width,o.x=a.x}else o=r.getRawTargetBox(s,t.settings.group_side)}r.adjustTargetBox(o,n,e),i.gmath.extend(t,o),t.drop_area_hint||t.setDropAreaHint(n),t.drop_area_hint_box=r.getRawTargetBox(t.drop_area_hint.node,t.drop_area_hint.side),r.adjustTargetBox(t.drop_area_hint_box,t.drop_area_hint,e),t.destination_hints||t.setDestinationHints(),t.destination_hint_boxes=t.destination_hints.map(function(t){var n=r.getRawTargetBox(t.node,t.side);return r.adjustTargetBox(n,t,e),n})}),o&&r.extendExtremeTargetBoxes(t,n)},r.getRawTargetBox=function(t,e){var n={};switch(e){case"left-of":n.x=t.sel_box.x+t.x0-.001,n.width=1,n.y=t.sel_box.y+t.y0,n.height=t.sel_box.height;break;case"right-of":n.x=t.sel_box.x+t.x0+t.sel_box.width+.001,n.width=1,n.y=t.sel_box.y+t.y0,n.height=t.sel_box.height;break;case"right-inside":n.x=t.sel_box.x+t.x0+.001,n.width=t.sel_box.width-.001,n.y=t.sel_box.y+t.y0,n.height=t.sel_box.height;break;case"left-inside":n.x=t.sel_box.x+t.x0,n.width=t.sel_box.width-.001,n.y=t.sel_box.y+t.y0,n.height=t.sel_box.height;break;case"below":n.x=t.sel_box.x+t.x0,n.width=t.sel_box.width,n.y=t.sel_box.y+t.y0+t.sel_box.height-.5,n.height=1;break;case"above":n.x=t.sel_box.x+t.x0,n.width=t.sel_box.width,n.y=t.sel_box.y+t.y0-.5,n.height=1;break;case"squish":n.x=t.children[0].sel_box.x+t.children[0].x0,n.width=t.children[0].sel_box.width,n.y=t.children[0].sel_box.y+t.children[0].y0,n.height=t.children[0].sel_box.height;break;default:if(Array.isArray(t)){var i=r.getBoundingBox(t);n.x=i.x,n.width=i.width,n.y=i.y,n.height=i.height}else n.x=t.sel_box.x+t.x0,n.width=t.sel_box.width,n.y=t.sel_box.y+t.y0,n.height=t.sel_box.height}return n},r.adjustTargetBox=function(t,e,n){e.offset&&r.adjustTargetBoxByOffset(t,e.offset),e.margin&&r.adjustTargetBoxByMargin(t,e.margin,n)},r.adjustTargetBoxByMargin=function(t,e,n){var i=0,r=0,o=0,s=0;e.all&&(i=r=o=s=e.all),e.x&&(i=r=e.x),e.y&&(o=s=e.y),e.x1&&(i=e.x1),e.y1&&(o=e.y1),e.x2&&(r=e.x2),e.y2&&(s=e.y2),i*=n,o*=n,r*=n,s*=n,t.x+=i,t.width-=r+i,t.y+=o,t.height-=s+o,t.width<=0&&(t.x+=-i>-r?-t.width/2:t.width/2,t.width=1),t.height<=0&&(t.y+=-o>-s?-t.height/2:t.height/2,t.height=1)},r.adjustTargetBoxByOffset=function(t,e){t.x+=e.x,t.y+=e.y},r.extendExtremeTargetBoxes=function(t,e){var n=[],i=[];function o(t){return t.x+t.width}function s(t,e){return o(t)<e.x}for(var a=0;a<t.length;a++){var l=t[a],u=r.getComparableBox(l);if(!l.source_am&&(1!==l.nodes.length||"AlgebraModel"!==l.nodes[0].type)){var c=void 0;try{c=r.getBoundingBox(t[0].nodes,1,!0)}catch(t){throw'An action triggered by drag does not have a set "nodes" array.'}r.boxIsLeftOrRightOfViewBox(u,e)&&(s(u,c)?0===n.length||n.length>0&&o(u)<o(r.getComparableBox(n[0]))?n=[l]:n.length>0&&o(r.getComparableBox(n[0]))===o(u)&&n.push(l):s(c,u)&&(0===i.length||i.length>0&&r.getComparableBox(i[0]).x<u.x?i=[l]:i.length>0&&r.getComparableBox(i[0]).x===u.x&&i.push(l)))}}n.filter(function(t){return!t.settings.no_target_box_expansion}).forEach(function(t){"inside"!==t.settings.side&&"outside"!==t.settings.group_side&&(t.x-=100,t.width+=100,t.y-=50,t.height+=100)}),i.filter(function(t){return!t.settings.no_target_box_expansion}).forEach(function(t){"inside"!==t.settings.side&&"outside"!==t.settings.group_side&&(t.width+=100,t.y-=50,t.height+=100)})},r.getComparableBox=function(t){return"right-inside"===t.settings.side?r.getRawTargetBox(t.target,"right-of"):"left-inside"===t.settings.side?r.getRawTargetBox(t.target,"left-of"):t.settings.target_group&&"right-of"===t.settings.side?r.getRawTargetBox(t.target.parent,"right-of"):t.settings.target_group&&"left-of"===t.settings.side?r.getRawTargetBox(t.target.parent,"left-of"):t},r.boxIsLeftOrRightOfViewBox=function(t,e){return t.x>e.x+e.width-1||t.x+t.width<e.x+1},r.getHits=function(t,e){var n=[];return(n=n.concat(t.filter(function(t){return(!t.settings.target_group&&"outside"!==t.settings.side||t.settings.target_group&&"outside"!==t.settings.group_side)&&r.overlaps(t,e)}))).concat(t.filter(function(t){return(!t.settings.target_group&&"outside"===t.settings.side||t.settings.target_group&&"outside"===t.settings.group_side)&&!r.overlaps(t,e)}))},r.getBestHit=function(t,e){var n=r.getHits(t,e);return r.getHighestPriorityHit(n,e)},r.getEnclosingRectForSourceLineEndpoint=function(t){return{xmin:t.B.x-2,ymin:t.B.y-2,xmax:t.B.x+2,ymax:t.B.y+2}},r.overlaps=function(t,e){return(t.x>=e.x&&t.x<=e.x+e.width||t.x+t.width>=e.x&&t.x+t.width<=e.x+e.width||t.x<=e.x&&t.x+t.width>=e.x+e.width)&&(t.y>=e.y&&t.y<=e.y+e.height||t.y+t.height>=e.y&&t.y+t.height<=e.y+e.height||t.y<=e.y&&t.y+t.height>=e.y+e.height)},r.getHighestPriorityHit=function(t,e){for(var n=null,i=0;i<t.length;i++){var o=t[i];if(n){if("outside"===n.settings.side)n=o;else if(o.priority>n.priority)n=o;else if(o.priority===n.priority){var s=n.settings.target_group||n.drop_area&&n.target!==n.drop_area.node||"left-inside"===n.settings.side||"right-inside"===n.settings.side?n.raw_target_box:n,a=o.settings.target_group||o.drop_area&&o.target!==o.drop_area.node||"left-inside"===o.settings.side||"right-inside"===o.settings.side?o.raw_target_box:o;r.getCenterDist(a,e)<r.getCenterDist(s,e)&&(n=o)}}else n=o}return n},r.getCenterDist=function(t,e){var n=t.x+t.width/2-e.x-e.width/2,i=t.y+t.height/2-e.y-e.height/2;return Math.sqrt(n*n+i*i)},r.getOverlapArea=function(t,e){var n=Math.max(t.x,e.x)-Math.min(t.x+t.width,e.x+e.width),i=Math.max(t.y,e.y)-Math.min(t.y+t.height,e.y+e.height);return Math.max(0,n)*Math.max(0,i)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Power=h;var i,r=(i=n(25))&&i.__esModule?i:{default:i},o=n(0),s=n(11),a=n(5),l=n(9),u=n(62),c=n(18),d=n(15);function h(t,e){l.Group.call(this),t&&e&&(this.append(t),e.is_group("exponent")?this.append(e):this.append(new u.Exponent(e)),c.Brackets.handle(t))}s.asOperator.call(h,"power",{bp:50,vertical_notation:!1}),h.prototype.is_square_root=function(){return this.match("\\ANY^0.5","\\ANY^(1/2)")},h.prototype.get_exponent_term=function(){return this.children[1].get_term()},h.prototype.getBase=function(){return this.children[0]},h.hasEvenExponent=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!t||!t.is_group("power"))return!1;var n=t.get_exponent_term(),i=void 0;return e?i=d.Num.get_value(n):(i=a.AlgebraModel.evalExpression(n),isNaN(i)&&(i=+r.default.eval(o.gmath.termsToAlgebriteString(n)).toString())),i%2==0},h.prototype.get_exponent_value=function(){return h.getNumericalValueOfExponent(this)},h.getNumericalValueOfExponent=function(t){return t.is_group("power")||t.is_group("exponent")?(t.is_group("exponent")?t=t.children[0]:t.is_group("power")&&(t=t.get_child([1,0])),c.Brackets.areHidden(t)&&(t=t.children[1]),d.Num.get_value(t)):1},h.haveSameBase=function(t,e){return t.is_group("power")&&(t=t.children[0]),e.is_group("power")&&(e=e.children[0]),t.to_ascii()===e.to_ascii()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlaceHolder=u;var i=n(0),r=n(1),o=n(5),s=n(36),a=n(11),l=n(20);function u(t){r.Tree.Node.call(this),this.value=t}i.gmath.inherit(r.Tree.Node,u),s.asLeaf.call(u,"placeholder"),a.asOperator.call(u,"placeholder",{bp:u.prototype.bp}),u.prototype.to_string=function(){return"⬚"},u.prototype.match=function(t){return"any"===this.value||t.name===this.value||t.parent instanceof l.Func&&"sym"===t.name&&"var"===this.value},u.prototype.to_ascii=function(t){var e=this;if("⬚"===this.value){var n=0,r=this.get_root();return r instanceof o.AlgebraModel?r.select_first(function(t){return"⬚"===t.value&&n++,t===e}):n=i.gmath.uid(),"string"==typeof n||n>1?'"'+(this.value+n)+'"':t&&t.quote_placeholders?'"'+this.value+'"':this.value}return"\\"+this.value.toUpperCase()},u.prototype.to_latex=function(t){return"⬚"===this.value?"\\dottedsquare":"\\"+this.value.toUpperCase()},u.prototype.is_group=function(){for(var t=0;t<arguments.length;t++)if("placeholder"===arguments[t])return!0;return!1}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.AlgebraRegExp=c;var r=n(0),o=n(2),s=n(64),a=n(5),l=n(114),u=n(45);function c(){this.simple_models=[],this.node_map=new l.NodeMap;for(var t=0;t<arguments.length;t++){var e=new a.AlgebraModel(arguments[t],{parser:c.getRegExpParser()});this.simple_models=this.simple_models.concat(this.getVariations(e))}}r.gmath.AlgebraRegExp=c,c.getRegExpParser=function(){if(!c.regexpParser){var t=(0,s.AlgebraParser)(a.AlgebraModel.getDefaultParser().symbols);t.registerSymbol(":",1).led=function(e){var n=t.parseExpression(0),i="?"===e.value[0];return n.match_name=i?e.value.slice(1):e.value,n.match_optional=i,n},["NUM","VAR","ANY"].forEach(function(e){t.registerSymbol("\\"+e).nud=function(){return new r.gmath.expressions.placeholder(e.toLowerCase())}}),c.regexpParser=t}return c.regexpParser},c.isVarPlaceholder=function(t){return"var"===t.value&&t instanceof u.PlaceHolder},c.prototype.getVariations=function(t,e){e=e||0;var n=t.select_first(function(t){return t.match_optional});if(!n)return[t];n.match_optional=!1;var i=t.clone(!1,["id","value","name","bp","associative","commutative","vertical_notation","match_name","match_optional"]),r=this.getVariations(i,e+1),s=new o.Action;if(s.newTree=t,n.parent.commutative&&(n=n.parent),n.commutative){var a=n.parent;n.remove(),s.cleanup_cascade(a),r=r.concat(this.getVariations(t,e+1))}else if(0===e)throw"only nodes in commutative groups can be optional";return r},c.prototype.combineWith=function(t){this.simple_models=this.simple_models.concat(t.simple_models)},c.prototype.match_node=function(t,e){return!(!t.is_group("sym")||!e.is_group("sym")||"±"!==e.value||"-"!==t.value&&"+"!==t.value)||!(!t.is_group("add","sub")||!e.is_group("addsub"))||!(!t.is_group("sign")||!e.is_group("plusminus"))||t.name===e.name&&t.value===e.value&&t.children.length===e.children.length},c.prototype.checkAndSetMatch=function(t,e,n,i){var r=e.match_name;if(r)if(t[r]){if(t[r].to_ascii()!==n.to_ascii())return!1;Array.isArray(t[r])?t[r].push(n):t[r]=[t[r],n]}else t[r]=n;return this.node_map.update(i?n.select_all():n,e),!0},c.prototype.match_tree=function(t,e,n){if(e.is_group("plusminus")&&!t.is_group("sign","plusminus")){if(!this.checkAndSetMatch(n,e,t,!1))return!1;e=e.children[1]}if(e.is_group("brackets")&&e.children[1].is_group("plusminus")&&!t.is_group("brackets")){if(!this.checkAndSetMatch(n,e,t,!1))return!1;e=e.children[1].children[1]}if(e.is_group("placeholder"))return!!e.match(t)&&!!this.checkAndSetMatch(n,e,t,!0);if(!this.checkAndSetMatch(n,e,t,!1))return!1;if(!this.match_node(t,e))return!1;for(var i=0;i<t.children.length;i++)if(!this.match_tree(t.children[i],e.children[i],n))return!1;return!0},c.prototype.matchSubExpressions=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="AlgebraModel"===t.type?t.children[0]:t;this.node_map.source_model=r.parent;for(var o=(!("match_inner"in n)||n.match_inner),s=[],a=function(){for(var t=e.simple_models[u].children[0],a=t.is_group("sum","product"),c=r.filterRange(function(e){return 1===e.length||o&&a&&e.length===t.children.length&&e.length<e[0].parent.children.length}),d=function(i){var o={},a=c[i];if(e.node_map=new l.NodeMap({},r.parent||r,t.parent),(1===a.length?e.match_tree(a[0],t,o):a.every(function(n,i){return e.match_tree(n,t.children[i],o)}))&&(s.push({matches:o,nodes:a,node_map:e.node_map}),n.only_first))return{v:{v:s}}},h=0;h<c.length;h++){var p=d(h);if("object"===(void 0===p?"undefined":i(p)))return p.v}if(s.length>0)return{v:s}},u=0;u<this.simple_models.length;u++){var c=a();if("object"===(void 0===c?"undefined":i(c)))return c.v}return[]},c.prototype.match=function(t){var e=this,n="AlgebraModel"===t.type?t.children:Array.isArray(t)?t:[t];this.node_map.source_model=n[0].get_root();for(var r=function(){var t={},i=e.simple_models[o].children[0];if(e.node_map.target_model=e.simple_models[o],e.node_map.reset(),1===n.length){if(e.match_tree(n[0],i,t))return{v:t}}else if(n.length===i.children.length&&n.every(function(n,r){return e.match_tree(n,i.children[r],t)}))return{v:t}},o=0;o<this.simple_models.length;o++){var s=r();if("object"===(void 0===s?"undefined":i(s)))return s.v}return!1}},function(t,e,n){t.exports=!n(71)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(144),r=n(139);t.exports=n(47)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(33),r=n(27),o=n(48),s=n(138),a=n(69),l=function(t,e,n){var u,c,d,h,p=t&l.F,f=t&l.G,g=t&l.S,m=t&l.P,v=t&l.B,y=f?i:g?i[e]||(i[e]={}):(i[e]||{}).prototype,b=f?r:r[e]||(r[e]={}),_=b.prototype||(b.prototype={});for(u in f&&(n=e),n)d=((c=!p&&y&&void 0!==y[u])?y:n)[u],h=v&&c?a(d,i):m&&"function"==typeof d?a(Function.call,d):d,y&&s(y,u,d,t&l.U),b[u]!=d&&o(b,u,h),m&&_[u]!=d&&(_[u]=d)};i.core=r,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e){t.exports=function(t){return"string"!=typeof t?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),/["'() \t\n]/.test(t)?'"'+t.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GgbTools=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0);n(5),r.gmath.GgbTools=o;var o=e.GgbTools=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,null,[{key:"convertGmToGgbString",value:function(t){var e=t.to_ascii({parenthesisForFunctions:!0,bracketed_negatives:!0});return(e=e.replace(/log\(/g,"log_{10}(")).replace(/ln_(e|{e})\(/g,"ln(")}},{key:"convertGgbToGmString",value:function(t){var e=t.value_str.substring(t.value_str.indexOf(":")+1);if("function"===t.type||"multivariablefunction"===t.type){var n=e.split("=");e=n[0].replace("(","[").replace(")","]"),e+="="+n.slice(1).join("=")}return e=e.replace(/([⁰¹²³⁴⁵⁶⁷⁸⁹⁻]+)/g,"^{$1}"),[[/⁰/g,"0"],[/¹/g,"1"],[/²/g,"2"],[/³/g,"3"],[/⁴/g,"4"],[/⁵/g,"5"],[/⁶/g,"6"],[/⁷/g,"7"],[/⁸/g,"8"],[/⁹/g,"9"],[/⁻/g,"-"],[/ℯ/g,"e"]].forEach(function(t){return e=e.replace(t[0],t[1])}),e}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return t?i.user.getSettingsOfType(e):r.SettingsType.get(e).doc};var i=n(17),r=n(10)},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.Path=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0);(e.Path=function(){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.events=t.dispatch("change","changed"),this.container=t.select(n),this.element=null,this.id=i.id||r.gmath.uid(),this.oid=i.oid,this.points=i.points||[],this.color=i.color||"black",this.width=i.width||1,this.type="path",this.init()}return i(e,[{key:"emitChangeEvent",value:function(){this.events.change()}},{key:"emitChangedEvent",value:function(){this.events.changed()}},{key:"toJSON",value:function(){return{id:this.id,type:"Path",points:this.points,color:this.color,width:this.width}}},{key:"init",value:function(){var t=null;return this.oid&&(t="#"+this.oid),this.element=this.container.insert("path",t).attr("id",this.id).style("fill","none").style("stroke-linecap","round").style("stroke-linejoin","round"),this.update()}},{key:"update",value:function(){return this.element.attr("d",e.line(this.points)+(1===this.points.length?"Z":"")).style("stroke",this.color).style("stroke-width",this.width),this}},{key:"remove",value:function(){return this.element.remove(),this}},{key:"setContainer",value:function(t){return 0===arguments.length?this.container:(this.container=t,this)}},{key:"renderOnto",value:function(t){var e=this.element,n=this.container;this.container=t,this.element=t.select("#"+this.id),this.element.empty()?this.init():this.update(),this.container=n,this.element=e}}],[{key:"fromJSON",value:function(t,e,n){return n.createPath(t,"load")}}]),e}()).line=void 0===t||void 0===t.svg?null:t.svg.line()}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Table=e.Path=e.TextBox=e.VideoModal=e.IdentificationModal=e.getHelpEntries=e.GgbTools=e.GM_GGB_SI_Line_Link=e.GM_GGB_Link=e.GeoGebraPanel=e.GeoGebraCanvasElement=e.erase_paths=e.CanvasModelView=e.CanvasVideo=e.CanvasImage=e.CanvasElement=e.insertCanvas=e.Canvas=e.CanvasController=void 0;var i=n(92);Object.defineProperty(e,"CanvasController",{enumerable:!0,get:function(){return i.CanvasController}});var r=n(89);Object.defineProperty(e,"Canvas",{enumerable:!0,get:function(){return r.Canvas}}),Object.defineProperty(e,"insertCanvas",{enumerable:!0,get:function(){return r.insertCanvas}});var o=n(19);Object.defineProperty(e,"CanvasElement",{enumerable:!0,get:function(){return o.CanvasElement}});var s=n(76);Object.defineProperty(e,"CanvasImage",{enumerable:!0,get:function(){return s.CanvasImage}});var a=n(75);Object.defineProperty(e,"CanvasVideo",{enumerable:!0,get:function(){return a.CanvasVideo}});var l=n(81);Object.defineProperty(e,"CanvasModelView",{enumerable:!0,get:function(){return l.CanvasModelView}});var u=n(90);Object.defineProperty(e,"erase_paths",{enumerable:!0,get:function(){return u.erase_paths}});var c=n(183);Object.defineProperty(e,"GeoGebraCanvasElement",{enumerable:!0,get:function(){return c.GeoGebraCanvasElement}}),Object.defineProperty(e,"GeoGebraPanel",{enumerable:!0,get:function(){return c.GeoGebraPanel}}),Object.defineProperty(e,"GM_GGB_Link",{enumerable:!0,get:function(){return c.GM_GGB_Link}}),Object.defineProperty(e,"GM_GGB_SI_Line_Link",{enumerable:!0,get:function(){return c.GM_GGB_SI_Line_Link}}),Object.defineProperty(e,"GgbTools",{enumerable:!0,get:function(){return c.GgbTools}});var d=n(84);Object.defineProperty(e,"getHelpEntries",{enumerable:!0,get:function(){return d.getHelpEntries}});var h=n(88);Object.defineProperty(e,"IdentificationModal",{enumerable:!0,get:function(){return h.IdentificationModal}});var p=n(87);Object.defineProperty(e,"VideoModal",{enumerable:!0,get:function(){return p.VideoModal}});var f=n(77);Object.defineProperty(e,"TextBox",{enumerable:!0,get:function(){return f.TextBox}});var g=n(53);Object.defineProperty(e,"Path",{enumerable:!0,get:function(){return g.Path}});var m=n(74);Object.defineProperty(e,"Table",{enumerable:!0,get:function(){return m.Table}}),n(86),n(182),n(91),n(170),n(169)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.loadFromJSON=e.DLLogger=e.DataLogger=e.CanvasLogger=void 0;var i=n(223);Object.defineProperty(e,"CanvasLogger",{enumerable:!0,get:function(){return i.CanvasLogger}});var r=n(222);Object.defineProperty(e,"DataLogger",{enumerable:!0,get:function(){return r.DataLogger}});var o=n(94);Object.defineProperty(e,"DLLogger",{enumerable:!0,get:function(){return o.DLLogger}});var s=n(93);Object.defineProperty(e,"loadFromJSON",{enumerable:!0,get:function(){return s.loadFromJSON}}),n(168),n(167),n(166),n(165),n(164)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=e.YTLoader={is_loading:!1,loaded:!1,delay_loading:!0,ready_callbacks:[],loadYTScript:function(t){i.loaded?t&&t():(t&&i.ready_callbacks.push(t),this.delay_loading||loadNow())},loadNow:function(){if(!i.is_loading){i.is_loading=!0,window.onYouTubeIframeAPIReady=function(){console.log("YT api loaded"),i.loaded=!0,i.is_loading=!1,i.ready_callbacks.forEach(function(t){return t()}),i.ready_callbacks=[]};var t=document.createElement("script");t.src="https://www.youtube.com/iframe_api";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}},allowLoading:function(){this.delay_loading=!1,this.ready_callbacks.length>0&&this.loadNow()}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.evalExpression=function(t){Array.isArray(t)||(t=[t]);var e=o.AlgebraModel.evalExpression(t),n=(o.AlgebraModel.to_ascii(t),r.gmath.termsToAlgebriteString(t));if(Number.isNaN(e)&&void 0!==s.default)try{e=Number(s.default.eval(n).toString())}catch(t){console.log("Algebrite could not parse",n)}return e};var i,r=n(0),o=n(5),s=(i=n(25))&&i.__esModule?i:{default:i}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.applyCoefficient=function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.is_group("num"))n>=0?e.value=e.value*(o?1/n:n):(e.value=-1*e.value*(o?1/n:n),i.Sign.invertTerm(e));else if(e.is_group("add","sub","addsub","sign"))t(e.children[1],n,o);else if(e.is_group("product")){var s=e.children.find(function(t){return i.Num.is_num(t.children[1])});t(s?s.children[1]:e.children[0].children[1],n,o)}else if(e.is_group("fraction")){var a=e.get_top().find(function(t){return i.Num.is_num(t.children[1])}),l=e.get_bottom().find(function(t){return i.Num.is_num(t.children[1])});o?l?t(l.children[1],n,!1):a?t(a.children[1],n,!0):e.get_bottom().length>0?t(e.get_bottom[0].children[1],n,!1):e.append(new i.MulDiv(new i.Num(n),"div")):a?t(a.children[1],n,!1):l?t(l.children[1],n,!0):e.get_top().length>0?t(e.children[0].children[1],n,!1):e.insert(0,new i.MulDiv(new i.Num(n)))}else{var u=e.parent,c=e.remove(),d=new i.ProductFraction;d.append(new i.MulDiv(new i.Num(n),o?"div":"mul")),d.append(new i.MulDiv(e)),u.insert(c,d),r.Action.cleanupInPlace(u)}};var i=n(3),r=n(2)},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.DerivationRow=a;var i=n(0),r=n(14),o=n(30),s=n(21);function a(t,e){this.type="derivation-row",this.dl=t,this.id=i.gmath.uid(),this.action=e.action,this.model=e.model,this.handle=null,this.view=null,this.el=e.el,this.padding=e.padding,this.dims=e.dims||{},this.idx=e.row_idx,this.pos=e.pos,this.link=null,this.lpos=null,this.preview=null,this.subable=!0,this.sub=!1,this.error=null}i.gmath.DerivationRow=a,a.prototype.toJSON=function(){return{id:this.id,type:"DerivationRow",dl:this.dl.id,action:this.action&&this.action.id,model:this.model,row_idx:this.idx}},a.fromJSON=function(t,e){return new a(t.dl,t)},a.prototype.createHandle=function(){if(this.view&&!this.dl.settings.get("no_handles")){this.mtouch=this.setupInteractionListeners();var t=this.getHandlePos(),e=this.el.selectAll(".handle").data([this,this]);e.enter().append("div").classed("handle",!0).style({cursor:"pointer"}).call(this.mtouch).style("transform","translate("+t[0]+"px,"+t[1]+"px)").style("-webkit-transform","translate("+t[0]+"px,"+t[1]+"px)").style({background:"white","border-color":this.handle_color?this.handle_color:this.dl.settings.get("handle_stroke_color"),"border-width":"2px","border-style":"solid",width:this.dl.handle_size+"px",height:this.dl.handle_size+"px","border-radius":"50%",position:"absolute"}).style({"pointer-events":"all"}),this.handle=e,this.setHandleVisibility()}},a.prototype.takeHandle=function(t){this.dl.settings.get("no_handles")||(this.handle=t,this.handle.data([this,this]),this.handle_color=this.dl.settings.get("handle_stroke_color"),this.handle.style({stroke:this.handle_color}),this.handle.call(this.setupInteractionListeners()),this.bindViewToInteractionHandlerListeners())},a.prototype.setHandleColor=function(t){this.handle_color=t,this.handle&&this.handle.style("stroke",t)},a.prototype.removeHandle=function(){this.view&&(this.mtouch&&(this.mtouch.connected(!1),delete this.mtouch),this.handle&&(this.handle.remove(),delete this.handle))},a.prototype.getHandlePos=function(){if(!this.view)return[0,0];var t=this.view.getBBox({no_padding:!0});return["left"===this.dl.settings.get("handle_pos")?t.x-this.dl.handle_pos_offset-this.dl.handle_size/2:t.x+t.width+(this.dl.handle_pos_offset-this.dl.handle_size/2),t.y+(t.height/2-this.dl.handle_size/2)]},a.prototype.updateHandlePos=function(t){if(this.view&&!this.dl.settings.get("no_handles")){var e=this.getHandlePos();if(this.handle){this.handle.transition().ease(this.view.settings.get("easing_fn")).duration(t?0:this.view.settings.get("dur")).style("width",this.dl.handle_size+"px").style("height",this.dl.handle_size+"px").style("transform","translate("+e[0]+"px,"+e[1]+"px)").style("-webkit-transform","translate("+e[0]+"px, "+e[1]+"px)");var n=this.dl.handle_size+this.dl.handle_pos_offset-22-25+5;this.dl.settings.get("padding").right=n}}},a.prototype.createView=function(t,e){var n=this?this.dl.alignment_correction.insert("div","div.dl-line#"+this.model.id):this.dl.alignment_correction.append("div");n.classed("dl-line",!0).attr("id",this.model.id).style("transform","translate("+(t.pos||[0,0]).join("px,")+"px)").style("-webkit-transform","translate("+(t.pos||[0,0]).join("px,")+"px)").datum(this),this.el=n,t.pos=[0,0],t.border_color="none",t.background_color=this.dl.settings.get("row_background_color"),this.dl.settings.get("standalone")&&(t.event_receiver=this.dl.main.node()),t.derivation=this.dl,this.setView(new r.AlgebraView(this.model,n.node(),t,function(t){this.setView(t),this.bindViewToInteractionHandlerListeners(),this.createHandle(),this.updateDimensionAfterInteraction(),e&&e(this.dl)}.bind(this)))},a.prototype.setView=function(t){this.view!==t&&(this.view&&this.view.events.on("updated."+this.dl.id,null),this.view=t,this.view&&this.view.events.on("updated."+this.dl.id,this.updateDimensionAfterInteraction.bind(this)))},a.prototype.bindViewToInteractionHandlerListeners=function(){var t=this;this.view.interaction_handler.events.on("inspect_node."+this.dl.id,this.dl.onInspect.bind(this.dl,this)),this.view.interaction_handler.events.on("drag_start."+this.dl.id,this.dl.setActiveDLComponent.bind(this.dl,"AV")),this.view.interaction_handler.events.on("drag_end."+this.dl.id,this.dl.setActiveDLComponent.bind(this.dl,"none")),this.view.interaction_handler.events.on("touch."+this.dl.id,function(){t.dl.delete_mode?t.dl.canvas_model.removeElement(t.dl):(t.dl.updateBGStyle(),t.dl.updateHandleVisibilities())})},a.prototype.updateDims=function(){if(this.view){var t=this.view.getBBox({no_padding:!0});t.y-=this.padding.top,t.height+=this.padding.top+this.padding.bottom,t.x-=this.padding.left,t.width+=this.padding.left+this.padding.right;var e=this.dims.x!==t.x||this.dims.y!==t.y||this.dims.width!==t.width||this.dims.height!==t.height;return e&&(this.dims=t),e}},a.prototype.updateDimensionAfterInteraction=function(t){this.updateDims()&&(this.dl.updateDims()?this.updateHandlePos(t):(this.updateBackground(t),this.updateHandlePos(t)))},a.prototype.updateBackground=function(t){if(this.view&&this.dims){var e=this.dims.x-this.dl.dims.x+this.padding.left-this.dl.settings.get("padding").left,n=this.dl.dims.x+this.dl.dims.width-this.dims.x-this.dims.width+this.padding.right-this.dl.settings.get("padding").right;this.view.settings.set("padding",{left:e,right:n,top:this.padding.top,bottom:this.padding.bottom}),this.view.update_background(t)}},a.prototype.showBackground=function(t){this.view&&(this.view.settings.set("border_color",t?this.dl.settings.get("row_border_color"):"none"),this.updateBackground(),this.view.set_background_visible(!0))},a.prototype.hideBackground=function(){this.view&&this.view.set_background_visible(!1)},a.prototype.setHandleVisibility=function(e){if(this.view&&!this.dl.settings.get("no_handles")&&this&&this.handle){arguments.length<1&&(e=!0),this.dl.rows;var n=this.dl.settings.get("hide_handles"),i=this.getHandlePos(),r=this;this.handle.each(function(o,s){var a=t.select(this);n||!e||"AV"===r.dl.active_dl_component||!r.dl.active&&r.dl.canvas_model&&"mouse"===r.dl.canvas_model.inputMode()?a.style("visibility","hidden"):r.atLeastOneNotCutHiddenRowAbove()?(a.style("visibility","visible").style("transform","translate("+(i[0]-r.dl.handle_size/4*s)+"px,"+i[1]+"px)").style("-webkit-transform","translate("+(i[0]-r.dl.handle_size/4*s)+"px,"+i[1]+"px)"),r.representHiddenHandleColor()):(a.style("visibility",0===s?"visible":"hidden").style("transform","translate("+i[0]+"px,"+i[1]+"px)"),r.revertHandleColor())})}},a.prototype.atLeastOneNotCutHiddenRowAbove=function(){for(var t=this.dl.rows,e=this.idx-1;e>=0;e--)if(!t[e].hidden||!t[e].cut)return!!t[e].hidden;return!1},a.prototype.representHiddenHandleColor=function(){var t;this.handle_color===this.dl.settings.get("handle_stroke_color")&&(t=this.coloredHandleHiddenBeneath())&&"pack"===this.dl.curr_row_operation&&(this.setHandleColor(t),this.is_displaying_hidden_handle_color=!0)},a.prototype.revertHandleColor=function(){this.is_displaying_hidden_handle_color&&(this.setHandleColor(this.dl.settings.get("handle_stroke_color")),delete this.is_displaying_hidden_handle_color)},a.prototype.coloredHandleHiddenBeneath=function(){for(var t=this.dl.rows,e=this.idx-1;e>=0;e--)if(!t[e].hidden||!t[e].cut){if(t[e].hidden&&t[e].handle_color!==this.dl.settings.get("handle_stroke_color"))return t[e].handle_color;if(!t[e].hidden)return!1}return!1},a.prototype.hide=function(){this.view&&!this.hidden&&(this.hidden=!0,this.view&&this.view.settings.set("auto_update",!1),this.dl.settings.get("collapsed_mode")||this.dl.updateDims(),this.el.style("display","none"),this.dl.rows[this.idx+1]&&this.dl.rows[this.idx+1].setHandleVisibility())},a.prototype.unhide=function(){this.view&&this.hidden&&(this.dl.singleLineMode(!1),this.hidden=!1,this.view&&(this.view.settings.set("auto_update",!0),this.view.render(!1)),this.dl.updateDims(),this.el.style("display",null),this.dl.rows[this.idx+1]&&this.dl.updateHandleVisibilities(),this.dl.rows[this.idx].updateHandlePos(!0))},a.prototype.deactivate=function(){this.view&&(this.view.interactive(!1),this.model.for_each(function(t){t.dragging=!1,t.selected=!1}),this.view.render())},a.prototype.remove=function(){for(var t=this.idx+1;t<this.dl.rows.length;t++)this.dl.rows[t].idx--;this.dl.rows.splice(this.idx,1),this.removeHandle(),this.view&&this.el.remove(),this.model.events.on("end-of-interaction."+this.dl.id,null),this.model.events.on("change."+this.dl.id,null),this.model.events.on("create."+this.dl.id,null),this.view&&(this.view.events.on("updated."+this.dl.id,null),this.view.interaction_handler.events.on("inspect_node."+this.dl.id,null),this.view.interaction_handler.events.on("drag_start."+this.dl.id,null),this.view.interaction_handler.events.on("drag_end."+this.dl.id,null),this.view.interaction_handler.events.on("touch."+this.dl.id,null))},a.prototype.removeInteractionListeners=function(){this.mtouch&&this.mtouch.on("drag",null).on("touch",null).on("tap",null).on("dbltap",null).on("release",null)},a.prototype.setupInteractionListeners=function(){var t=this;return this.mtouch?(this.removeInteractionListeners(),this.mtouch.connected(!1)):this.mtouch=i.gmath.mtouch_events(),this.mtouch.origin(function(e){return[t.dl.pos.x+e.pos[0],t.dl.pos.y+e.pos[1]]}).on("drag",this.drag.bind(this,null)).on("touch",this.touch.bind(this,null)).on("tap",this.tap.bind(this,null)).on("dbltap",this.dbltap.bind(this,null)).on("release",this.dragend.bind(this,null)),this.mtouch},a.prototype.touch=function(){this.dl.atStartOfInteraction({type:"start-of-interaction",source:{type:"DerivationRow",id:this.dl.id,row:this.idx,model:this.model,packState:this.dl.packState},time:Date.now()}),this.dl.settings.get("send_events")&&this.dl.row_events.touch(new a.touchEvent(t.event,this.idx,this.dl.id)),this.dl.setActiveDLComponent("row"),this.dl.curr_row_operation="undecided",this.dl.updateContainerDims();for(var e=0;e<this.dl.rows.length;e++)this.dl.rows[e].showBackground(e===this.idx);this.handle.style({background:"whitesmoke"})},a.prototype.tap=function(){if(!(this.dl.rows.length>1)&&i.gmath.actions.FirstLineRewriteAction.match(this.model)){i.gmath.ui&&i.gmath.ui.Keyboard&&i.gmath.ui.Keyboard().abort(),this.model.startInteraction();var t=i.gmath.actions.FirstLineRewriteAction.createBoundAction(this.model,{actor:this.model});this.model.performAction(t,function(){this.model.finishInteraction()}.bind(this),!0)}},a.prototype.dbltap=function(){this.dl.settings.get("send_events")&&this.dl.row_events.dbltap({type:"dbltap",row:this})},a.prototype.createLinkVis=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.dl.canvas_model.foreground_svg().append("g");return i.attr("transform","translate("+(this.pos[0]+this.dl.pos.x-this.dl.dims.x+this.dl.handle_size/2)+","+(this.pos[1]+this.dl.pos.y-this.dl.dims.y+this.dl.handle_size/2)+")"),i.append("line").attr({x1:t[0],y1:t[1],x2:e[0],y2:e[1]}).style("stroke",this.handle_color?this.handle_color:this.dl.settings.get("handle_stroke_color")).style("stroke-width",2).style("stroke-linecap","round"),i.append("circle").attr({cx:t[0],cy:t[1],r:this.dl.handle_size/2}).style("fill","white").style("stroke",this.handle_color?this.handle_color:this.dl.settings.get("handle_stroke_color")).style("stroke-width",2),n&&i.append("circle").attr("id","cursor").attr({cx:e[0],cy:e[1],r:this.dl.handle_size/2}).style("fill","white").style("stroke",this.handle_color?this.handle_color:this.dl.settings.get("handle_stroke_color")).style("stroke-width",2),i},a.prototype.drag=function(e){var n,r,o;void 0!==e&&null!==e||(e=t.event),e.x,l=e.dx,n=e.y,u=e.dy,r=Math.abs(e.finger.dist_x),o=Math.abs(e.finger.dist_y),this.dl.settings.get("send_events")&&this.dl.row_events.drag(new a.dragEvent(e,this.idx,this.dl.id));var s=Math.sqrt(r*r+o*o);if(s>=10&&"link"!==this.dl.curr_row_operation&&"pack"!==this.dl.curr_row_operation&&(o/s>=.85&&0!==this.idx?(this.dl.curr_row_operation="pack",this.dl.hideAllTraces()):(this.dl.curr_row_operation="link",this.lpos=this.getHandlePos(),this.link=this.createLinkVis(this.lpos,i.gmath.extend({},this.lpos)))),"pack"===this.dl.curr_row_operation)this.dl.handlePackArranging(this,n,u);else if("link"===this.dl.curr_row_operation){var l=e.finger.dx,u=e.finger.dy;this.lpos[0]=this.lpos[0]+l,this.lpos[1]=this.lpos[1]+u,this.link.select("line").attr({x2:this.lpos[0],y2:this.lpos[1]}),this.link.select("#cursor").attr({cx:this.lpos[0],cy:this.lpos[1]});var c={x:this.dl.pos.x-this.dl.dims.x+this.pos[0]+this.lpos[0],y:this.dl.pos.y-this.dl.dims.y+this.pos[1]+this.lpos[1]},d=!0,h=!1,p=void 0;try{for(var f,g=this.dl.canvas_model.getElementsOfType("ggb-element")[Symbol.iterator]();!(d=(f=g.next()).done);d=!0){var m=f.value,v=m.element_div.selectAll(".gm-ggb-element-drop-target-adorner");m.hitTest(c)?0===v.size()&&m.element_div.append("div").classed("gm-ggb-element-drop-target-adorner",!0):v.remove()}}catch(t){h=!0,p=t}finally{try{!d&&g.return&&g.return()}finally{if(h)throw p}}}},a.prototype.dragend=function(e){void 0!==e&&null!==e||(e=t.event),this.dl.settings.get("send_events")&&this.dl.row_events.release(new a.releaseEvent(e,this.idx,this.dl.id));var n=!0,r=!1,o=void 0;try{for(var s,l=this.dl.canvas_model.getElementsOfType("ggb-element")[Symbol.iterator]();!(n=(s=l.next()).done);n=!0)s.value.element_div.selectAll(".gm-ggb-element-drop-target-adorner").remove()}catch(t){r=!0,o=t}finally{try{!n&&l.return&&l.return()}finally{if(r)throw o}}if(this.releaseRow(),"link"===this.dl.curr_row_operation){var u={x:this.dl.pos.x-this.dl.dims.x+this.pos[0]+this.lpos[0],y:this.dl.pos.y-this.dl.dims.y+this.pos[1]+this.lpos[1]},c=i.gmath.find(this.dl.canvas_model.elements(),function(t){return t.hitTest(u)}),d=c?c.type:null;if("ggb-element"===d&&(c=c.ggbPanel,d="ggb-panel"),"ggb-panel"===d)c.dropDLRow(this);else if("derivation"===d&&this.macro&&this.endingPosIsInLastRowHandle(u,c)){var h=[this.dl.rows[0].model,this.dl.getLastModel()],p=c.getLastModel(),f=i.gmath.actions.ApplyFormulaAction.getAllAvailableActions(h,p);if(f.length>0){var g=f[0];g.bindMacroDerivation(this.dl),p.performAction(g)}}else if("derivation"!==d&&!this.sub&&this.dl.settings.get("cloning_on")){var m=this.view.getBBox({no_padding:!0}),v="left"===this.dl.settings.get("handle_pos")?u.x-20:u.x-m.width-60,y=u.y-m.height/2-10;this.cloneLine(this,v,y),this.clone.setActiveDLComponent("none"),this.clone=null}this.link.remove(),this.link=null,this.lpos=null,this.subable=!1,this.sub=!1}this.dl.curr_row_operation="none",this.dl.afterEndOfInteraction({type:"end-of-interaction",source:{type:"DerivationRow",id:this.dl.id,row:this.idx,model:this.model,packState:this.dl.packState},time:Date.now()})},a.prototype.releaseRow=function(){this.dl.setActiveDLComponent("none");for(var t=0;t<this.dl.rows.length;t++)this.dl.rows[t].hideBackground();if(this.dl.settings.get("no_handles")||this.handle.style({background:"white"}),this.dl.draginfo=null,this.idx>0){var e=this.dl.getFinalVerticalPos(this)-this.pos[1],n=this.dl.getVisibleAbove(this);n&&e>0&&e>.5*n.dims.height&&n.hide(),this.dl.layoutRows()}this.dl.updateBGStyle(),this.dl.updateHandleVisibilities()},a.prototype.cloneLine=function(t,e,n){var r=i.gmath.extend({},this.dl.settings.getAll());r.pos={x:e,y:n},r.dont_init_eq=!1,r.eq=t.model.to_ascii(),r.id=i.gmath.uid(),this.dl.settings.get("send_events")&&this.dl.events.clone(new a.cloneEvent(this.dl.id,r)),this.clone=this.dl.canvas_model.createDL(r),this.clone.setActiveDLComponent("DL"),this.dl.curr_row_operation="clone";var l=i.gmath.actions.CloneAction.createBoundAction(t.model,{});l.node_map=t.model.children[0].get_mapping_to(this.clone.rows[0].model.children[0]);var u=new o.AlgebraModelLink(t.model,this.clone.rows[0].model,l);(0,s.linkCoordinator)().addLink(u)},a.prototype.handleCloneDrag=function(e,n,i){this.clone.drag(t.event);var r=this.dl.pos.x+e.pos[0]-this.clone.pos.x,o=this.dl.pos.y+e.pos[1]-this.clone.pos.y;this.clone_dist=Math.sqrt(r*r+o*o)},a.prototype.endingPosIsInLastRowHandle=function(t,e){e.getLastRow();var n=e.pos,i=e.getLastRow().pos,r=(e.getLastRow().view.getBBox({no_padding:!0}),e.getLastRow().getHandlePos()),o=n.x-e.dims.x+i[0]+r[0],s=n.y-e.dims.y+i[1]+r[1];return Math.abs(t.x-o)<20&&Math.abs(t.y-s)<20}}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Inequality=a;var i=n(1),r=n(11),o=n(9),s=n(16);function a(t,e,n){if(o.Group.call(this),this.value=n,t&&e){if("lte"!==n&&"gte"!==n&&"lt"!==n&&"gt"!==n)throw"(Inequality) Unaccepted mode type.";i.Tree.append(this,t),i.Tree.append(this,new s.Sym(a.value2sym[n])),i.Tree.append(this,e)}}a.unicode_syms=["≤","≥","<",">"],a.value2sym={lte:"≤",gte:"≥",lt:"<",gt:">"},a.sym2Ascii={"≤":"<=","≥":">=","<":"<",">":">"},r.asOperator.call(a,"inequality",{bp:10}),a.prototype.to_ascii=function(t){return this.children.map(function(e,n){return 1===n?a.sym2Ascii[e.to_ascii(t)]:e.to_ascii(t)}).join("")},a.is_inequality=function(t){return t.is_group("lte","gte","lt","gt")},a.is_relation=function(t){return t.is_group("equals")||a.is_inequality(t)},a.prototype.setValue=function(t){this.value=t,this.get_child([1]).value=a.value2sym[this.value]},a.prototype.invert=function(){"lte"===this.value?this.setValue("gte"):"gte"===this.value?this.setValue("lte"):"lt"===this.value?this.setValue("gt"):"gt"===this.value&&this.setValue("lt")},a.prototype.getOppositeSide=function(t){if("left"===t)return this.children[2];if("right"===t)return this.children[0];throw"[Inequality] Error: cannot find opposite side with this input."},a.registerAtParser=function(t){var e={"<":"lt","\\lt":"lt",">":"gt","\\gt":"gt","<=":"lte","\\le":"lte","≤":"lte",">=":"gte","\\ge":"gte","≥":"gte"};for(var n in e)t.registerSymbol(n,a.prototype.bp).led=function(e,n){var i=t.parseExpression(a.prototype.bp);if(a.is_relation(n)||a.is_relation(i))throw"More than one comparator in equation.";return new a(n,i,e)}.bind(null,e[n])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(376);Object.defineProperty(e,"ChangeNumberHandler",{enumerable:!0,get:function(){return i.ChangeNumberHandler}});var r=n(375);Object.defineProperty(e,"DragHandler",{enumerable:!0,get:function(){return r.DragHandler}});var o=n(368);Object.defineProperty(e,"InterDerivationHandler",{enumerable:!0,get:function(){return o.InterDerivationHandler}});var s=n(104);Object.defineProperty(e,"InteractionHandler",{enumerable:!0,get:function(){return s.InteractionHandler}});var a=n(364);Object.defineProperty(e,"SelectionHandler",{enumerable:!0,get:function(){return a.SelectionHandler}});var l=n(363);Object.defineProperty(e,"JoinHandler",{enumerable:!0,get:function(){return l.JoinHandler}});var u=n(362);Object.defineProperty(e,"SplitHandler",{enumerable:!0,get:function(){return u.SplitHandler}});var c=n(103);Object.defineProperty(e,"GMLHLGMHandler",{enumerable:!0,get:function(){return c.GMLHLGMHandler}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exponent=c;var i=n(1),r=n(11),o=n(9),s=n(44),a=n(31),l=n(15),u=n(18);function c(t){o.Group.call(this),t&&(i.Tree.append(this,t),u.Brackets.handle(t))}r.asOperator.call(c,"exponent",{group_class:s.Power,group_name:"power",bp:51,vertical_notation:!0}),c.prototype.get_term=function(){return u.Brackets.areHidden(this.children[0])?this.children[0].children[1]:this.children[0]},c.prototype.to_ascii=function(t){return 0===this.children.length?"":"^"+this.children[0].to_ascii(t)},c.prototype.to_latex=function(t){if(0===this.children.length)return"";var e=this.children[0].to_latex(t);return e.length<2||this.children[0].is_group("brackets","abs-val")&&!u.Brackets.areHidden(this.children[0])?"^"+e:"^{"+e+"}"},c.registerAtParser=function(t){t.registerSymbol("^",c.prototype.bp).led=function(e){var n=t.parseExpression(c.prototype.bp-1);return new s.Power(e,n)},[{char:"⁰",val:0},{char:"¹",val:1},{char:"²",val:2},{char:"³",val:3},{char:"⁴",val:4},{char:"⁵",val:5},{char:"⁶",val:6},{char:"⁷",val:7},{char:"⁸",val:8},{char:"⁹",val:9}].forEach(function(e){t.registerSymbol(e.char,c.prototype.bp).led=function(t){return new s.Power(t,new l.Num(e.val))}}),t.registerSymbol("ⁿ",c.prototype.bp).led=function(t){return new s.Power(t,new a.Var("n"))},t.registerSymbol("\\scriptscriptstyle").nud=function(){return t.parseExpression(c.prototype.bp)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tuple=s;var i=n(0),r=n(9),o=n(113);function s(){r.Group.call(this),this.bp=5,this.value="tuple";for(var t=0;t<arguments.length;t++){var e=arguments[t];e instanceof o.Param?this.append(e):this.append(new o.Param(e))}}i.gmath.inherit(r.Group,s),s.prototype.name="tuple",s.is_tuple=function(t){return t instanceof s||t.is_group("brackets")&&t.children[1]instanceof s},s.prototype.to_ascii=function(t){return this.children.map(function(e){return e.ls?e.to_ascii(t):e.children[1].to_ascii(t)}).join("")},s.prototype.to_latex=function(t){return this.children.map(function(e){return e.ls?e.to_latex(t):e.children[1].to_latex(t)}).join("")},i.gmath.expressions[s.prototype.name]=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlgebraParser=o;var i=n(0),r=n(115);function o(t){var e,n,o,s,a={},l=i.gmath.uid(),u=function(t,e){throw(e=e||this).name="SyntaxError",e.message=t,e},c=function(){this.def={}};c.prototype.find_or_define=function(t){var e=this.def[t.value];return e&&"function"!=typeof e?e:((e=Object.create(a["(name)"])).lpb=0,this.def[t.value]=e,e)};var d=function(t,i){var r,l,c,d;if(t&&e.id!==t){if(i)return;u("Expected '"+t+"'.",e)}if(!(o>=n.length))return c=n[o],o+=1,d=c.value,"name"===(r=c.type)?l=s.find_or_define(c):"operator"===r?(l=a[d])||u("Unknown operator.",c):"latex"===r?(l=a[d])||u("Unknown latex command.",c):"string"===r||"number"===r?(l=a["(number)"],r="number"):u("Unexpected token.",c),(e=Object.create(l)).from=c.from,e.to=c.to,e.value=d,e.type=r,e;e=a["(end)"]},h=function(t,n){var i,r=n||e;for(n||d(),i=r.nud();t<e.lbp;)r=e,d(),i=r.led(i);return i},p={nud:function(){u("Undefined.",this)},led:function(t){u("Missing operator.",this)}},f=function(t,e){var n=a[t];return e=e||0,n?e>n.lbp&&(n.lbp=e):((n=Object.create(p)).id=n.value=t,n.lbp=e,a[t]=n),n};f("(end)");var g={parse:function(t){if(0==(n=(0,r.tokenize)(t)).length)return null;s=new c,o=0,d();var e=h(0);return d("(end)"),e}};g.parseExpression=h,g.advance=d,g.registerSymbol=f,g.uid=l,g.match_current_token=function(){if(!e)return!1;for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];for(var r=0;r<n.length;r++)if(e.id===n[r])return!0;return!1},g.symbols=t;for(var m=0;m<t.length;m++){var v=i.gmath.expressions[t[m]];v&&v.registerAtParser&&v.registerAtParser(g)}return g}i.gmath.AlgebraParser=o},function(t,e,n){var i=n(66)("unscopables"),r=Array.prototype;void 0==r[i]&&n(48)(r,i,{}),t.exports=function(t){r[i][t]=!0}},function(t,e,n){var i=n(127)("wks"),r=n(70),o=n(33).Symbol,s="function"==typeof o;(t.exports=function(t){return i[t]||(i[t]=s&&o[t]||(s?o:r)("Symbol."+t))}).store=i},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var i=n(69),r=n(135),o=n(134),s=n(132),a=n(130);t.exports=function(t,e){var n=1==t,l=2==t,u=3==t,c=4==t,d=6==t,h=5==t||d,p=e||a;return function(e,a,f){for(var g,m,v=o(e),y=r(v),b=i(a,f,3),_=s(y.length),x=0,w=n?p(e,_):l?p(e,0):void 0;_>x;x++)if((h||x in y)&&(m=b(g=y[x],x,v),t))if(n)w[x]=m;else if(m)switch(t){case 3:return!0;case 5:return g;case 6:return x;case 2:w.push(g)}else if(c)return!1;return d?-1:u||c?c:w}}},function(t,e,n){var i=n(136);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){t.exports=n.p+"f4769f9bdb7466be65088239c12046d1.eot"},function(t,e,n){"use strict";function i(t){if(window.clipboardData&&window.clipboardData.setData)return window.clipboardData.setData("Text",t);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var e=document.createElement("textarea");e.textContent=t,e.style.position="fixed",document.body.appendChild(e),e.select();try{return document.execCommand("copy")}catch(t){return console.warn("Copy to clipboard failed.",t),!1}finally{document.body.removeChild(e)}}}Object.defineProperty(e,"__esModule",{value:!0}),e.copyToClipboard=i,n(0).gmath.copyToClipboard=i},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.Table=a;var i=n(0),r=n(19),o=n(185),s=n(39);function a(t,e,n,o){n=i.gmath.object.merged(s.GeoGebraCanvasElement.defaultOptions,n),r.CanvasElement.call(this,t,e,n),this.type="table",this.table_el=null,this.columns_row=null,this.columns_el=null,this.column_width=80,this.column_labels=n.column_labels||["x","y"],this.inputs_row=null,this.inputs_el=null,this.edit_el=null,this.remove_el=null,this.rows=[],this.rows_el=null,this.row_height=40,this.active_row=null,this.active_x=null,this.active_y=null,this.sel_y0=null,this.sel_y1=null,this.selected=null,this.dx_el=null,this.dy_el=null,this.slope_el=null,this.keyboard=null,this.target_row=null,this.target_col=null,this.graph=null,this.show=!1,this.show_el=null,this.slope=null,this.intercept=null,this.x=function(t){return(t-this.intercept)/this.slope},this.y=function(t){return this.slope*t+this.intercept},this.x_pos=0,this.y_pos=this.column_width,this.rows_addable=!0,this.initOptions(n),this.init(o)}i.gmath.inherit(r.CanvasElement,a),a.defaultOptions={type:"Table",margin:0,font_size:20,font_weight:"bold",resizable:{x:!1,y:!1},edit_mode_drag_box_width:-20},a.prototype.initOptions=function(t){t=t||{};var e=i.gmath.deepCopy(a.defaultOptions),n=i.gmath.object.extendExisting(e,t);this.options=i.gmath.extend(this.options,n)},a.prototype.getColumn=function(){return this.x_pos<=this.y_pos?"x":"y"},a.prototype.init=function(e){var n=this;function r(e){var r=n.columns_row[e+"_el"],o=e+"_pos",s=i.gmath.mtouch_events().frame(r.node()).on("touch",function(){n.setActiveRow(),n.setColIndex(e)}).on("drag",function(){n[o]+=t.event.dx,n[o]=Math.min(n.column_width,Math.max(0,n[o])),n.dragCol(e)}).on("release",function(){n[o]=n[o]<n.column_width/2?0:n.column_width,n["xy_pos".replace(e,"")]=n.column_width-n[o],n.dragCol("x",250),n.dragCol("y",250),setTimeout(function(){n.setColIndex(),n.setInputs(),n.sortRows()},250)});r.call(s)}this.table_el=this.element_div.append("div").classed("table",!0).style("box-sizing","content-box").style("border","1px solid silver"),this.columns_el=this.table_el.append("div").classed("table-columns",!0).style("position","relative"),this.columns_row=new o.TableRow(this,this.columns_el,this.column_labels[0],this.column_labels[1],0),this.columns_row.row_el.selectAll(".table-cell").style("background-color","gainsboro").style("cursor","move").style("cursor","grabbing"),this.columns_row.row_el.selectAll(".table-input").style("background-color","gainsboro").style("pointer-events","none"),r("x"),r("y"),this.rows_el=this.table_el.append("div").classed("table-rows",!0).style("position","relative");var s=i.gmath.mtouch_events().frame(this.rows_el.node()).on("touch",function(){n.sel_y0=t.event.fingers[0].pos0[1],n.sel_y1=n.sel_y0}).on("drag",function(){if(!n.inputs_row.is_selected){if(n.active_row){if(n.active_row.is_editable)return;n.setActiveRow()}if(n.sel_y1+=t.event.dy,Math.abs(n.sel_y1-n.sel_y0)>10){var e=function(t){var e=t.toString();return e.length>4&&(e=e.substring(0,4)+"..."),e},i=function(t){var e=0;return(e+=6*(t.match(/\./g)||[]).length)+10*t.match(/[0-9]/g).length};n.selected=[];var r=n.rows[n.rows.length-1],o=null,s=n.rows[0],a=null;n.rows.forEach(function(t){var e=n.row_height*t.idx,i=e+n.row_height;e<=n.sel_y0&&i>=n.sel_y0||e<=n.sel_y1&&i>=n.sel_y1||e>=n.sel_y0&&i<=n.sel_y1||e>=n.sel_y1&&i<=n.sel_y0?(n.selected.push(t),t.idx<=r.idx&&(r=t,o=e),t.idx>=s.idx&&(s=t,a=i),t.setSelected(!0)):t.setSelected(!1)});var l=n.x_pos<n.y_pos,u=a-o,c=s.x-r.x,d=s.y-r.y,h=c/d,p=e(c),f=e(d),g=e(h),m=Math.max(i(p),i(f));n.dx_el.style("left",(l?-30-m:2*n.column_width+10)+"px").style("width",20+i(p)+"px").style("text-align",l?"left":"right"),n.dx_el.select("span").html(p),n.dx_el.select(".bracket.bar").style("left",(l?14+m:4)+"px"),n.dy_el.style("left",(l?2*n.column_width+10:-30-m)+"px").style("width",20+i(f)+"px").style("text-align",l?"right":"left"),n.dy_el.select("span").html(f),n.dy_el.select(".bracket.bar").style("left",(l?4:14+m)+"px"),n.rows_el.selectAll(".range").style("top",o+"px").style("height",u+"px").style("line-height",u+"px").style("display","block"),n.slope_el.select(".top.fraction").html(f),n.slope_el.select(".btm.fraction").html(p),n.slope_el.selectAll(".fraction").style("width",10+m+"px"),n.slope_el.selectAll(".eq").filter(function(t,e){return 1==e}).style("left",90+m+"px"),n.slope_el.select(".val").html(g).style("left",110+m+"px"),n.slope_el.style("display","block"),n.selected.length>0&&n.graph&&(n.show_el.style("display","block"),n.toggleGraphElements(n.show))}}}).on("release",function(){n.sel_y0=null,n.sel_y1=null});this.rows_el.call(s),this.dx_el=this.rows_el.append("div").classed("range",!0),this.dy_el=this.rows_el.append("div").classed("range",!0);var a=this.rows_el.selectAll(".range").style("position","absolute").style("width","30px").style("display","none");a.append("span"),a.append("div").classed("bracket bar",!0).style("top","0px").style("width","2px").style("height","100%");var l=a.selectAll(".bracket.bar");l.append("div").classed("bracket end",!0).style("top","0px"),l.append("div").classed("bracket end",!0).style("bottom","0px"),this.rows_el.selectAll(".bracket").style("position","absolute").style("background-color","black"),this.rows_el.selectAll(".bracket.end").style("left","-4px").style("width","10px").style("height","2px"),this.slope_el=this.table_el.append("div").classed("slope",!0).style("left",2*this.column_width+this.options.margin+30+"px").style("top",this.options.margin+"px").style("text-align","center").style("display","none"),this.slope_el.append("div").classed("slope top formula",!0).html("y<sub>2</sub> - y<sub>1</sub>"),this.slope_el.append("div").classed("slope bar formula",!0),this.slope_el.append("div").classed("slope btm formula",!0).html("x<sub>2</sub> - x<sub>1</sub>"),this.slope_el.append("div").classed("slope eq",!0).style("left","60px"),this.slope_el.append("div").classed("slope top fraction",!0),this.slope_el.append("div").classed("slope bar fraction",!0),this.slope_el.append("div").classed("slope btm fraction",!0),this.slope_el.append("div").classed("slope eq",!0),this.slope_el.append("div").classed("slope val",!0).style("top","14px").style("width","20px"),this.table_el.selectAll(".slope").style("position","absolute"),this.slope_el.selectAll(".top").style("top","0px"),this.slope_el.selectAll(".bar").style("top","28px").style("height","2px").style("background-color","black"),this.slope_el.selectAll(".btm").style("top","28px"),this.slope_el.selectAll(".eq").style("top","14px").style("width","20px").html("="),this.slope_el.selectAll(".formula").style("left","0px").style("width","60px"),this.slope_el.selectAll(".fraction").style("text-align","center").style("left","80px"),this.edit_el=this.rows_el.append("i").classed("table-button",!0).classed("glyphicon glyphicon-pencil",!0).style("position","absolute").style("cursor","pointer").style("background-color","white").style("border","1px solid silver").style("border-radius","5px").style("text-align","center").style("display","none").on("click",function(){n.active_row.setEditable(!0)}),this.remove_el=this.rows_el.append("i").classed("table-button",!0).classed("glyphicon glyphicon-trash",!0).style("position","absolute").style("cursor","pointer").style("background-color","white").style("border","1px solid silver").style("border-radius","5px").style("text-align","center").style("display","none").on("click",function(){n.active_row.row_el.remove();var t=n.active_row.idx;n.rows.splice(t,1),n.rows.forEach(function(e){e.idx>t&&(e.idx--,e.update())}),n.update(),n.setActiveRow(),n.setInputs(),n.sortRows(),1==n.rows.length&&(n.slope=null,n.intercept=null,n.graph&&n.setGraphLine())}),this.inputs_el=this.table_el.append("div").classed("table-inputs",!0).style("position","relative"),this.inputs_row=new o.TableRow(this,this.inputs_el,0,this.y(0),0),this.inputs_row.row_el.selectAll(".table-input").style("color","silver"),this.inputs_row.setEditable(!0),this.inputs_row.events.on("focus",function(t){(n.active_row||n.selected)&&n.setActiveRow(),n.keyboard.visible()||(n.inputs_row.is_selected=!0,n.active_x=n.inputs_row.x,n.active_y=n.inputs_row.y),n.target_row&&n.target_row.setEditing(n.target_col,!1),n.inputs_row.setEditing(t,!0),n.target_row=n.inputs_row,n.target_col=t,n.connectAndShowKeyboard("")}).on("input",function(t){if(n.slope){var e=n.inputs_row;"x"==t?e.y=n.y(e.x):e.x=n.x(e.y),e.update()}}),this.setInputs(),this.keyboard=i.gmath.ui.Keyboard(),this.update(),e&&e(this)},a.prototype.connectAndShowKeyboard=function(t){this.keyboard.visible()&&this.keyboard.visible(!1),this.keyboard.latex(t).visible(!0),this.keyboard.on("change."+this.id,function(t){this.target_row[this.target_col+"_in"].html(t),this.target_row.readInput(this.target_col)}.bind(this)),this.keyboard.on("done."+this.id,function(){!this.inputs_row.is_selected||this.slope||this.hasInputs()?(this.inputs_row.is_selected&&(this.addRow(this.inputs_row.x,this.inputs_row.y),this.setActiveRow(),this.setInputs()),this.active_row&&this.active_row.is_editable&&(this.active_x=this.active_row.x,this.active_y=this.active_row.y,this.setActiveRow(),this.setInputs(),this.sortRows()),this.target_row.setEditing(this.target_col,!1),this.target_row=null,this.target_col=null,this.keyboard.visible(!1),this.disconnectKeyboard()):(this.target_row.setEditing(this.target_col,!1),this.target_col="xy".replace(this.target_col,""),this.target_row.setEditing(this.target_col,!0),this.connectAndShowKeyboard(""))}.bind(this)),this.keyboard.on("cancel."+this.id,function(){this.setActiveRow(),this.target_row.setEditing(this.target_col,!1),this.disconnectKeyboard()}.bind(this))},a.prototype.unselect=function(){this.setActiveRow()},a.prototype.disconnectKeyboard=function(){this.keyboard.visible(!1),this.keyboard.on("change."+this.id,null).on("done."+this.id,null).on("cancel."+this.id,null)},a.prototype.update=function(){var e=2*this.column_width,n=this.row_height*this.rows.length,i=n+this.row_height*(this.rows_addable?2:1),r=2*this.options.margin;this.resizeElement({width:e+r,height:i+r}),this.table_el.style("width",e+"px").style("height",i+"px").style("margin",this.options.margin+"px").style("font-size",this.options.font_size+"px").style("font-weight",this.options.font_weight),this.columns_el.style("width",e+"px").style("height",this.row_height+"px"),this.inputs_el.style("width",e+"px").style("height",this.row_height+"px").style("display",this.rows_addable?"block":"none"),this.edit_el.style("left",e+10+"px"),this.remove_el.style("left",e+15+this.row_height+"px"),this.graph&&this.show_el.style("left",-this.row_height-10+"px"),t.selectAll(".table-button").style("width",this.row_height+"px").style("height",this.row_height+"px").style("font-size",this.row_height-15+"px").style("line-height",this.row_height+"px"),this.rows_el.style("width",e+"px").style("height",n+"px")},a.prototype.setInputs=function(){this.inputs_row.x_in.html(""),this.inputs_row.y_in.html("")},a.prototype.hasInputs=function(){return""!=this.inputs_row.x_in.html()&&""!=this.inputs_row.y_in.html()},a.prototype.setRowsAddable=function(t){this.rows_addable=t,this.update()},a.prototype.setButtonMode=function(t){this.edit_el.style("display","selected"==t?"block":"none"),this.remove_el.style("display","selected"==t?"block":"none")},a.prototype.setColIndex=function(t){this.columns_row.setColIndex(t),this.inputs_row.setColIndex(t),this.rows.forEach(function(e){e.setColIndex(t)})},a.prototype.dragCol=function(t,e){e=e||0,this.columns_row.dragCol(t,e),this.inputs_row.dragCol(t,e),this.rows.forEach(function(n){n.dragCol(t,e)})},a.prototype.setColOrder=function(t){var e=this;t.forEach(function(t,n){e[t+"_pos"]=n*e.column_width,e.dragCol(t)})},a.prototype.addRow=function(t,e){for(var n=0;n<this.rows.length;n++)if((i=this.rows[n]).x==t&&i.y==e)return void[".table-cell",".table-input"].forEach(function(t){i.row_el.selectAll(t).transition(150).style("background-color","gainsboro").delay(150).transition(200).style("background-color","white")});var i,r=this;if((i=new o.TableRow(this,this.rows_el,t,e,this.rows.length)).events.on("click",function(){r.active_row!=i&&r.setActiveRow(i)}).on("focus",function(t){r.active_row==i&&(r.target_row&&r.target_row.setEditing(r.target_col,!1),i.setEditing(t,!0),r.target_row=i,r.target_col=t,r.connectAndShowKeyboard(i[t].toString()))}).on("input",function(t){r.slope&&("x"==t?i.y=r.y(i.x):i.x=r.x(i.y),i.update())}),this.rows.push(i),this.setInputs(),this.update(),this.sortRows(),!this.slope&&2==this.rows.length){var s=this.rows[1].y-this.rows[0].y,a=this.rows[1].x-this.rows[0].x;this.slope=s/a,this.intercept=this.rows[0].y-this.slope*this.rows[0].x,this.graph&&this.setGraphLine()}},a.prototype.sortRows=function(){var t=this.getColumn(),e=0;this.rows.sort(function(e,n){return e[t]-n[t]}),this.rows.every(function(t,e){return t.idx===e})||this.rows.forEach(function(t,n){t.idx=n,t.dragRow(400,40*e),e++})},a.prototype.setActiveRow=function(t){if(this.inputs_row.is_selected?(this.inputs_row.x=this.active_x,this.inputs_row.y=this.active_y,this.inputs_row.setSelected(!1),this.inputs_row.update()):this.active_row?(this.active_row.x=this.active_x,this.active_row.y=this.active_y,this.active_row.setSelected(!1),this.active_row.setEditable(!1),this.active_row.update()):this.selected&&(this.selected.forEach(function(t){t.setSelected(!1)}),this.selected=null,this.rows_el.selectAll(".range").style("display","none"),this.slope_el.style("display","none")),t){t.setSelected(!0);var e=this.row_height*t.idx+"px";this.edit_el.style("top",e),this.remove_el.style("top",e)}this.setButtonMode(t?"selected":null),this.active_row=t||null,this.active_x=t?t.x:null,this.active_y=t?t.y:null,this.setInputs(),this.graph&&(this.show_el.style("display",t?"block":"none"),this.show&&this.toggleGraphElements(!!t))},a.prototype.setGraph=function(t){var e=this;this.graph=t,this.setGraphLine(),this.graph.ggbApplet.setVisible("a",!1),this.graph.ggbApplet.setLabelVisible("g",!0),this.graph.ggbApplet.setLabelStyle("g",2),this.graph.ggbApplet.setLabelVisible("h",!0),this.graph.ggbApplet.setLabelStyle("h",2),this.graph.ggbApplet.evalCommand("p=false"),this.graph.ggbApplet.evalCommand("r=false"),this.show_el=t.element_div.append("i").classed("table-button",!0).classed("glyphicon glyphicon-eye-open",!0).style("position","absolute").style("top","0px").style("cursor","pointer").style("background-color","white").style("border","1px solid silver").style("border-radius","5px").style("text-align","center").style("display","none");var n=i.gmath.mtouch_events().frame(this.show_el.node()).on("tap",function(){e.show=!e.show,e.show_el.transition().style("background-color",e.show?"gold":"white"),e.toggleGraphElements(e.show)});this.show_el.call(n),this.update()},a.prototype.setGraphLine=function(){this.graph.ggbApplet.evalCommand("m="+(this.slope?this.slope:"false")),this.graph.ggbApplet.evalCommand("b="+(this.intercept?this.intercept:"false"))},a.prototype.toggleGraphElements=function(t){if(this.graph.ggbApplet.setVisible("a",t),this.active_row)this.graph.ggbApplet.evalCommand("G=("+this.active_row.x+","+this.active_row.y+")"),this.graph.ggbApplet.evalCommand("p="+t),this.graph.ggbApplet.evalCommand("r=false");else if(this.selected){var e=this.selected[this.selected.length-1],n=this.selected[0];this.selected.forEach(function(t){t.idx<=e.idx&&(e=t),t.idx>=n.idx&&(n=t)}),this.graph.ggbApplet.evalCommand("A=("+e.x+","+e.y+")"),this.graph.ggbApplet.evalCommand("B=("+n.x+","+n.y+")"),this.graph.ggbApplet.evalCommand("r="+t),this.graph.ggbApplet.evalCommand("p=false")}},a.prototype.toJSON=function(){return{id:this.id,type:"Table",rows:this.rows.map(function(t){return{x:t.x,y:t.y}}),pos:this.pos,graph:this.graph?this.graph.id:null}},a.fromJSON=function(t,e,n){var i=n.createElement("table",{pos:t.pos});return t.rows.forEach(function(t){i.addRow(t.x,t.y)}),i.graph=t.graph,i}}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasVideo=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=n(19),s=n(10),a=n(56);e.CanvasVideo=function(t){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i,"CanvasVideo"));return o.type="video",o.loaded=!1,o.initCanvasVideo(),o.initPosition(),r&&r(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.CanvasElement),i(e,[{key:"initCanvasVideo",value:function(){var t=this;this.video_div=this.element_div.append("div").attr("id","gm_video_div"+this.id).style("width","100%").style("height","100%"),this.settings.get("yt_video_id")?this.createPlayer():(this.video_div.html('<div class="form-group"><label for=\'yt_id'+this.id+'\'>Youtube Video ID</label>\n                           <input type="text" class="form-control" style="max-width: 15em; margin: auto" id=\'yt_id'+this.id+"'></div>\n                           <div class=\"form-group\"><label>time range</label>\n                           <input type=\"text\" style=\"max-width: 5em; margin: auto\" id='yt_from' placeholder='from'>\n                           <input type=\"text\" style=\"max-width: 5em; margin: auto\" id='yt_to' placeholder='to'>\n                           </div>\n                           <button class='btn btn-default'>Load</button>"),this.video_div.style({border:"1px solid silver",padding:"10px","text-align":"center"}),this.video_div.select("button").on("click",function(){var e=t.video_div.select("input").node().value;e&&(t.settings.set("yt_video_id",e),t.settings.set("start_time_sec",t.video_div.select("input#yt_from").node().value||!1),t.settings.set("end_time_sec",t.video_div.select("input#yt_to").node().value||!1),t.video_div.html(""),t.video_div.style({border:null,padding:null,"text-align":null}),t.createPlayer())}))}},{key:"createPlayer",value:function(){a.YTLoader.loaded?"undefined"!=typeof YT&&YT&&YT.Player?this.player=new YT.Player("gm_video_div"+this.id,{playerVars:{rel:0,enablejsapi:1,modestbranding:1,playsinline:1,origin:"https://graspablemath.com"},height:"100%",width:"100%",events:{onReady:this.onPlayerReady.bind(this),onStateChange:this.onPlayerStateChange.bind(this)}}):console.warn("Error loading Youtube player."):a.YTLoader.loadYTScript(this.createPlayer.bind(this))}},{key:"remove",value:function(){this.player&&this.player.destroy(),this.player=null,function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"remove",this).call(this),clearTimeout(this.timer)}},{key:"onPlayerStateChange",value:function(){}},{key:"onPlayerReady",value:function(){var t={videoId:this.settings.get("yt_video_id")};this.settings.get("start_time_sec")&&(t.startSeconds=this.settings.get("start_time_sec")),this.settings.get("end_time_sec")&&(t.endSeconds=this.settings.get("end_time_sec")),this.player.cueVideoById(t),this.player.setVolume(this.settings.get("volume")),this.settings.get("is_muted")?this.player.mute():this.player.unMute()}},{key:"toJSON",value:function(){return{type:"CanvasVideo",id:this.id,pos:r.gmath.deepCopy(this.pos),size:r.gmath.deepCopy(this.size),url:this.settings.get("url"),yt_video_id:this.settings.get("yt_video_id"),volume:this.player?this.player.getVolume():this.settings.get("volume"),is_muted:this.player?this.player.isMuted():this.settings.get("is_muted"),start_time_sec:this.settings.get("start_time_sec"),end_time_sec:this.settings.get("end_time_sec")}}}],[{key:"fromJSON",value:function(t,e,n){return n.createElement("video",t)}}]),e}(),new s.SettingsType("CanvasVideo").defaults.setAll(s.SettingsType.get("CanvasElement").defaults.getAll()).setAll({min_size:{width:60,height:45},size:{width:400,height:300},yt_video_id:null,volume:100,is_muted:!1,start_time_sec:!1,end_time_sec:!1})},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasImage=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=n(19),s=n(10);e.CanvasImage=function(e){function n(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(t,e){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e,i,"CanvasImage"));return o.type="image",o.initCanvasImageSettings(i),o.initCanvasImage(),o.initPosition(),r&&r(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,o.CanvasElement),i(n,[{key:"initCanvasImageSettings",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.settings.get("drop_evt")&&!this.settings.get("url")&&this.settings.set("url",this.tryGetUrl(this.settings.get("drop_evt")))}},{key:"initCanvasImage",value:function(){this.settings.get("image_data")||this.settings.get("url")?this.loadImage():this.getDataFromFile(this.settings.get("drop_evt"))}},{key:"tryGetUrl",value:function(e){if(e){if("string"==typeof e)return e;if(void 0!==e.dataTransfer){var n=e.dataTransfer.getData("text/plain");if("http"===n.slice(0,4))return n;var i=e.dataTransfer.getData("text/html"),r=t("<div>").append(i),o=t(r).find("img").attr("src");if(void 0!==o)return o}return null}}},{key:"getDataFromFile",value:function(t){if(!this.settings.get("image_data")&&t&&t.dataTransfer){var e=new FileReader;e.onload=function(t){this.canvas_image.settings.set("image_data",t.target.result),this.canvas_image.loadImage()},e.onerror=function(t){console.error("error: "+t.target.error)},e.canvas_image=this,e.readAsDataURL(t.dataTransfer.files[0])}}},{key:"loadImage",value:function(){this.image_for_aspect_ratio=new Image,this.image_for_aspect_ratio.src=this.settings.get("url")||this.settings.get("image_data"),this.image=document.createElementNS("http://www.w3.org/2000/svg","image"),this.image.addEventListener("load",this.waitForAspectRatio())}},{key:"waitForAspectRatio",value:function(){if(this.image_for_aspect_ratio.complete)this.imageLoaded();else{setTimeout(function e(){t.image_for_aspect_ratio.complete?t.imageLoaded():setTimeout(e,100)},100);var t=this}}},{key:"imageLoaded",value:function(){this.aspect_ratio=this.image_for_aspect_ratio.height/this.image_for_aspect_ratio.width;var t=this.size.width*this.aspect_ratio;if(this.settings.get("min_size").height=this.settings.get("min_size").width*this.aspect_ratio,!isNaN(this.aspect_ratio)){var e=null===this.settings.get("url")?this.settings.get("image_data"):this.settings.get("url");this.image=this.element_div.append("img").property("src",e).attr({width:this.size.width-4,height:t-4}).style({"pointer-events":"none"}),this.resizeElement({width:this.size.width,height:t})}}},{key:"resize",value:function(t){var e=Math.max(this.settings.get("min_size").width,t.width),n=(e=Math.min(e,e-(t.width+this.pos.x-this.container_size.width)))*this.aspect_ratio;this.resizeElement({width:e,height:n})}},{key:"subTypeResize",value:function(t){this.image.attr({width:this.size.width-4,height:this.size.height-4})}},{key:"toJSON",value:function(){return{type:"CanvasImage",id:this.id,pos:r.gmath.deepCopy(this.pos),size:r.gmath.deepCopy(this.size),url:this.settings.get("url")||this.settings.get("image_data")}}}],[{key:"fromJSON",value:function(t,e,n){return n.createElement("image",t)}}]),n}(),new s.SettingsType("CanvasImage").defaults.setAll(s.SettingsType.get("CanvasElement").defaults.getAll()).setAll({min_size:{width:50,height:20},size:{width:200},url:null,drop_evt:null,image_data:null})}).call(this,n(8))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.TextBox=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=n(19),s=n(10);e.TextBox=function(e){function n(e,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(t,e){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,i,o,"TextBox"));return a.type="textbox",a.events=r.gmath.extend(a.events,t.dispatch("font_size","text")),a.initTextBoxSettings(o),a.initTextBoxProperties(),a.initTextBox(),a.initPosition(),s&&s(a),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,o.CanvasElement),i(n,[{key:"initTextBoxSettings",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.settings.get("static_bg")&&(this.settings.set("bg_edit_style",this.settings.get("bg_arrange_style")),this.settings.set("bg_edit_active_style",this.settings.get("bg_arrange_style")))}},{key:"initTextBoxProperties",value:function(){this.uneditable=this.settings.get("uneditable"),this.closable=this.settings.get("closable"),this.font_size=this.settings.get("font_size"),this.element_div.style({height:this.size.height+"px",width:this.size.width+"px"})}},{key:"initTextBox",value:function(){this.uneditable||this.initToolbar(),this.initTextElement(),this.closable&&this.initCloseButton(),this.update(),this.canvas_model.setActive(this,!0),this.uneditable||("edit"===this.mode&&this.settings.get("select_text_on_create")&&this.selectAllText(),this.switchToolbarState("edit"===this.mode&&this.active))}},{key:"initToolbar",value:function(){this.toolbar_on_style={display:"inline-block",position:"fixed","margin-top":"-20px",width:"100%"},this.toolbar_off_style={display:"none"},this.toolFadeoutDelay=500,this.font_btns=[{type:"push",label:"-",icon:"glyphicon glyphicon-text-size",flip:"y"},{type:"push",label:"+",icon:"glyphicon glyphicon-text-size"}],this.tools=this.element_div.append("div").attr({class:"btn-toolbar",role:"toolbar"}).style(this.settings.get("use_toolbar")?this.toolbar_on_style:this.toolbar_off_style);var t=this;this.tools.append("div").attr({class:"btn-group"}).classed("pull-right",!0).selectAll("button").data(this.font_btns).enter().call(function(e,n){var i=e.append("button").attr("id",function(t){return t.label}).attr({type:"button",class:"btn btn-default"}).classed("input-xs",!0);i.on("click",n.bind(t)),i.append("span").text(function(t){return t.label}).style("color","#555")},this.onButton)}},{key:"initTextElement",value:function(){this.text_element=this.element_div.append("div").classed("gm-no-focus-outline",!0).style({padding:this.settings.get("padding")+"px","font-size":this.font_size+"px","text-align":this.settings.get("text_align")}).property("innerHTML",this.settings.get("text")).attr("contenteditable",this.uneditable?"contenteditable":"").on("input",function(){var t=this.settings.get("text");this.update(),this.emitEvent("text",{element:{type:"textbox",id:this.id,old_state:t,new_state:this.settings.get("text")}})}.bind(this))}},{key:"initCloseButton",value:function(){var t=2.5*this.settings.get("font_size"),e=(this.size.width-t)/2;this.button=this.element_div.append("svg").style({position:"absolute",left:e,width:t+2+"px",height:t+2+"px"}),this.button_grp=this.button.append("g"),this.button_grp.append("circle").attr({r:t/2,cx:t/2+1,cy:t/2+1}).style({stroke:"#ddd","stroke-width":1,fill:"white"}),this.button_grp.append("text").text("OK").attr({x:"50%",y:"50%","text-anchor":"middle","alignment-baseline":"central"}).style({fill:"#ddd","font-size":this.settings.get("font_size"),"pointer-events":"none"}),this.button.on("click",this.fade.bind(this,null))}},{key:"selectAllText",value:function(){if(window.getSelection){var t=window.getSelection();t.removeAllRanges();var e=document.createRange();e.selectNodeContents(this.text_element.node()),t.addRange(e)}else if(document.selection){var n=document.body.createTextRange();n.moveToElementText(this.text_element.node()),n.select()}}},{key:"setSubTypeActive",value:function(){this.switchToolbarState(this.active)}},{key:"switchToolbarState",value:function(t,e){if(this.tools&&this.settings.get("use_toolbar"))if(t&&this.toolFadeoutTimer)clearTimeout(this.toolFadeoutTimer),this.toolFadeoutTimer=null;else if(t)this.turnOnToolbar();else{if(this.dragging)return;this.turnOffToolbar()}}},{key:"turnOnToolbar",value:function(){this.tools.style(this.toolbar_on_style)}},{key:"turnOffToolbar",value:function(){this.tools.style(this.toolbar_off_style),this.toolFadeoutTimer=null}},{key:"onButton",value:function(t){"+"===t.label?this.increaseTextSize():"-"===t.label&&this.decreaseTextSize()}},{key:"changeFontSize",value:function(t){var e=this.font_size;this.font_size=Math.max(this.settings.get("min_font_size"),Math.min(t,this.settings.get("max_font_size"))),this.font_size!==e&&(this.text_element.style("font-size",this.font_size+"px"),this.emitEvent("font_size",{element:{type:"textbox",id:this.id,old_state:e,new_state:this.font_size}}),this.update())}},{key:"increaseTextSize",value:function(){var t;t=this.font_size<12?1:this.font_size<28?2:this.font_size<36?8:12,this.changeFontSize(this.font_size+t)}},{key:"decreaseTextSize",value:function(){var t;t=this.font_size<=12?1:this.font_size<=28?2:this.font_size<=36?8:12,this.changeFontSize(this.font_size-t)}},{key:"setText",value:function(t){this.text_element.node().innerHTML=t,this.update()}},{key:"update",value:function(){this.settings.set("text",this.text_element.node().innerHTML),this.size.height=this.text_element.node().offsetHeight,this.closable&&(this.size.height+=3*this.settings.get("font_size")),this.element_div.style({height:this.size.height+"px",width:this.size.width+"px"}),this.closable&&this.button.attr("transform","translate("+[this.size.width/2,this.size.height-3*this.settings.get("font_size")]+")")}},{key:"subTypeResize",value:function(){this.update()}},{key:"unselect",value:function(){window.getSelection().removeAllRanges(),this.text_element.node().blur()}},{key:"fade",value:function(t){this.element_div.transition().duration(750).style("opacity",0).each("end",function(){this.canvas_model.removeElement(this),t&&t()}.bind(this))}},{key:"cancelFade",value:function(){this.element_group.transition().duration(0).style("opacity",1)}},{key:"toJSON",value:function(){var t={id:this.id,type:"TextBox",pos:this.pos,size:this.size,uneditable:this.uneditable,closable:this.closable,font_size:this.font_size};return this.settings.get("text")!==this.settings.parent.get("text")&&(t.text=this.settings.get("text")),t}}],[{key:"fromJSON",value:function(t,e,n){return n.createElement("textbox",t,"load",function(t){t.unselect()})}}]),n}(),new s.SettingsType("TextBox").defaults.setAll(s.SettingsType.get("CanvasElement").defaults.getAll()).setAll({text:"Edit this text.",min_size:{width:50,height:50},size:{width:300,height:200},padding:20,text_align:"left",resizable:{x:!0,y:!1},uneditable:!1,closable:!1,font_size:20,min_font_size:10,max_font_size:60,use_toolbar:!0,static_bg:!1,select_text_on_create:!1})}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GM_GGB_SI_Line_Link=o;var i=n(7),r=n(5);function o(t,e,n,r,o){this.id=(0,i.uid)(),this.type="GM_GGB_SI_Line_Link",this.ggb_ic=t,this.ggb_2nd=e,this.ggb_obj=n,this.model=r.model,this.row=r,this.ggb_panel=o,this.dont_update=!1,this.model.events.on("change."+this.id,this.onAMChange.bind(this))}o.prototype.onAMChange=function(t){if(t.old_model!==this.model)throw"wrong old_model";if(t.new_model!==t.old_model&&(this.model.events.on("change."+this.id,null),this.model=t.new_model,this.model.events.on("change."+this.id,this.onAMChange.bind(this))),t.sender!==this.id){var e=t.old_model_ascii||t.old_model.to_ascii(),n=this.ggb_panel.matchSILine(new r.AlgebraModel(e)),i=this.ggb_panel.matchSILine(this.model),o=this.ggb_2nd.x,s=this.ggb_2nd.y,a=i.m_val;if(n.b_val!==i.b_val)s=a*o+i.b_val,this.ggb_panel.ggbApplet.setCoords(this.ggb_ic.name,0,i.b_val),this.ggb_panel.ggbApplet.setCoords(this.ggb_2nd.name,o,s);else{var l=s-i.b_val,u=Math.sqrt(o*o+l*l),c=Math.atan2(o>=0?a:-a,o>0?1:-1);o=u*Math.cos(c),s=u*Math.sin(c)+i.b_val,this.ggb_panel.ggbApplet.setCoords(this.ggb_2nd.name,o,s)}}},o.prototype.onGGBChange=function(t){if(!this.dont_update)if(t===this.ggb_ic.name)(e=this.ggb_panel.matchSILine(this.model)).b_node||(this.model.replace_with("y="+(e.m_node?e.m_val:"")+"x+0",this.id),e=this.ggb_panel.matchSILine(this.model)),this.model.numeric_value(e.b_node,this.ggb_ic.y,this.id),this.dont_update=!0,this.ggb_panel.ggbApplet.setCoords(this.ggb_2nd.name,this.ggb_2nd.x,this.ggb_ic.y+e.m_val*(this.ggb_2nd.x-this.ggb_ic.x)),this.dont_update=!1;else if(t===this.ggb_2nd.name){var e;(e=this.ggb_panel.matchSILine(this.model)).m_node||(e.b_node?this.model.replace_with("y=1x"+(e.b_val<0?"-":"+")+e.b_val,this.id):this.model.replace_with("y=1x",this.id),e=this.ggb_panel.matchSILine(this.model)),this.model.numeric_value(e.m_node,(this.ggb_2nd.y-this.ggb_ic.y)/(this.ggb_2nd.x-this.ggb_ic.x),this.id)}},o.prototype.unlink=function(){this.model.events.on("change."+this.id,null),this.model.events.on("end-of-interaction."+this.id,null)},o.prototype.toJSON=function(){return{type:"GM_GGB_SI_Line_Link",id:this.id,ggb_ic_name:this.ggb_ic.name,ggb_2nd_name:this.ggb_2nd.name,ggb_obj_name:this.ggb_obj.name,row_idx:this.row.idx,dl_id:this.row.dl.id,ggb_panel_id:this.ggb_panel.id}},o.fromJSON=function(t,e,n){var i=n.elements().find(function(e){return e.id===t.dl_id}).rows[t.row_idx],r=e.getGGBObject(t.ggb_obj_name),s=e.getGGBObject(t.ggb_2nd_name);return new o(e.getGGBObject(t.ggb_ic_name),s,r,i,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GM_GGB_Link=s;var i=n(7),r=n(51),o=n(20);function s(t,e,n){this.id=(0,i.uid)(),this.type="GM_GGB_Link",this.ggb_obj=t,this.row=e,this.model=e.model,this.ggb_panel=n,this.dont_update=!1,this.am_changed=!1,"segment"===t.type&&this.onGGBChange(t.name),this.model.events.on("change."+this.id,this.onAMChange.bind(this)),this.model.events.on("start-of-interaction."+this.id,this.onAMsoi.bind(this)),this.model.events.on("end-of-interaction."+this.id,this.onAMeoi.bind(this))}s.prototype.onAMeoi=function(t){this.am_changed&&this.onGGBChange(this.ggb_obj.name)},s.prototype.onAMsoi=function(t){this.am_changed=!1},s.prototype.onAMChange=function(t){if(t.old_model!==this.model)throw"wrong old_model";this.am_changed=!0,t.new_model!==t.old_model&&(this.model.events.on("change."+this.id,null),this.model.events.on("end-of-interaction."+this.id,null),this.model.events.on("start-of-interaction."+this.id,null),this.model=t.new_model,this.model.events.on("change."+this.id,this.onAMChange.bind(this)),this.model.events.on("end-of-interaction."+this.id,this.onAMeoi.bind(this)),this.model.events.on("start-of-interaction."+this.id,this.onAMsoi.bind(this)));var e=this.ggb_obj.name;if(t.sender!==this.id){if(this.dont_update=!0,this.ggb_obj.movable||this.ggb_panel.ggbApplet.setFixed(e,!1),!this.handleAMPointChange()){this.ggb_obj.movable||this.ggb_panel.ggbApplet.setFixed(e,!1);var n=r.GgbTools.convertGmToGgbString(t.new_model),i=t.new_model.children[0];("function"===this.ggb_obj.type||"numeric"===this.ggb_obj.type||"multivariablefunction"===this.ggb_obj.type)&&i.is_group("equals")&&i.children[0]instanceof o.Func&&i.children[0].isCustomFunction?this.ggb_panel.ggbApplet.evalCommand(n):this.ggb_panel.ggbApplet.evalCommand(e+": "+n)}this.ggb_obj.movable&&this.model.settings.get("locked")&&this.ggb_panel.ggbApplet.setFixed(e,!0),this.dont_update=!1}},s.prototype.handleAMPointChange=function(){if("point"!==this.ggb_obj.type)return!1;var t=this.ggb_obj.name,e=this.ggb_panel.matchPoint(this.model);if(e){var n,i=e.x.get_signed_value(),o=e.y.get_signed_value();e.z?(n=e.z.get_signed_value(),this.ggb_panel.ggbApplet.setCoords(t,i,o,n)):this.ggb_panel.ggbApplet.setCoords(t,i,o)}else this.model.children[0].is_group("equals")?this.ggb_panel.ggbApplet.evalCommand(r.GgbTools.convertGmToGgbString(this.model)):this.ggb_panel.ggbApplet.evalCommand(t+": "+r.GgbTools.convertGmToGgbString(this.model));return!0},s.prototype.onGGBChange=function(t){if(!this.dont_update&&t===this.ggb_obj.name){var e=this.id,n=r.GgbTools.convertGgbToGmString(this.ggb_obj);if("point"===this.ggb_obj.type){if(!(o=this.ggb_panel.matchPoint(this.model)))return;var i=this.ggb_panel.matchPointString(n);this.model.numeric_value(o.x,+i[1],e),this.model.numeric_value(o.y,+i[2],e),o.z&&this.model.numeric_value(o.z,+i[3],e)}else if("segment"===this.ggb_obj.type){var o=this.ggb_panel.matchSegment(this.model);this.model.numeric_value(o.val,+this.ggb_obj.value,e)}else this.model.replace_with(n,e)}},s.prototype.unlink=function(){this.model.events.on("change."+this.id,null),this.model.events.on("end-of-interaction."+this.id,null)},s.prototype.toJSON=function(){return{type:"GM_GGB_Link",id:this.id,ggb_obj_name:this.ggb_obj.name,row_idx:this.row.idx,dl_id:this.row.dl.id,ggb_panel_id:this.ggb_panel.id}},s.fromJSON=function(t,e,n){var i=n.elements().find(function(e){return e.id===t.dl_id}).rows[t.row_idx];return new s(e.getGGBObject(t.ggb_obj_name),i,e)}},function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.GeoGebraPanel=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7)),s=n(19),a=n(79),l=n(51),u=n(78),c=n(10);function d(t,e){t.style({cursor:"pointer",position:"absolute",top:"-1px",right:e?"-21px":"0",width:"20px","line-height":"1.4em","text-align":"center",border:e?"1px solid silver":"1px solid transparent","border-left":"none",background:e?"#eeeeee":"none","padding-top":"0.2em","padding-left":e?"0.1em":"0",color:"#444444"}),t.text(e?"▶":"◀")}e.GeoGebraPanel=function(e){function n(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};arguments.length>3&&void 0!==arguments[3]&&arguments[3],function(t,e){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e,i,"GeoGebraPanel"));return r.type="ggb-panel",r.ggb_objs=[],r.adding_ggb_object_for_row=void 0,r.dont_update=void 0,r.links=[],r.ggbElement=i.ggbElement,r.ggbElement.ggbPanel=r,r.registerInspectListeners(),r.init(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,s.CanvasElement),r(n,[{key:"init",value:function(){var t=this;this._addToDOM?(this.div=this.element_div.append("div").style({height:"100%",padding:"5px","overflow-y":"auto","overflow-x":"hidden"}).classed("ggb-panel",!0),this.expander=this.element_div.append("div").on("click",function(){return t.setVisibility(!t.settings.get("hidden"))}),this.setVisibility(this.settings.get("hidden")),this.div.append("img").attr("id","help-next-btn").style({cursor:"pointer",width:"20px",display:"block",margin:"auto"}).attr("src","/shared/imgs/menu-icons/geogebra.svg").on("click",function(){return t.loadMaterialDialog()})):this.element_div.attr("hidden",!0),this.ggbElement.events.on("move."+this.id,this.moveAttached.bind(this)),this.ggbElement.events.on("resize."+this.id,this.resizeAttached.bind(this)),this.ggbElement.events.on("ggb_add."+this.id,this.ggbAddListener.bind(this)),this.ggbElement.events.on("ggb_update."+this.id,this.ggbUpdateListener.bind(this)),this.ggbElement.events.on("ggb_remove."+this.id,this.ggbRemoveListener.bind(this)),this.ggbElement.events.on("ggb_rename."+this.id,this.ggbRenameListener.bind(this)),this.ggbElement.events.on("ggb_click."+this.id,this.ggbClickListener.bind(this)),this.ggbElement.ggbApplet?this.on_ggb_load():this.ggbElement.events.on("ggb_init",this.on_ggb_load.bind(this)),this.resizeAttached(this.ggbElement)}},{key:"setVisibility",value:function(t){this._addToDOM&&(this.settings.set("hidden",t),this.settings.set("resizable",{x:!t,y:this.settings.get("resizable").y}),t&&this.resize_grp&&this.resize_grp.style("display","none"),this.expander.call(d,this.settings.get("hidden")),this.div.style("padding",this.settings.get("hidden")?"0":"5px"),t?this.settings.set("prev_width",this.size.width):null===this.settings.get("prev_width")&&this.settings.set("prev_width",this.size.width),this.resizeElement({width:t?0:this.settings.get("prev_width"),height:this.size.height}))}},{key:"loadMaterialDialog",value:function(){var e=this,n=t.select("#gm-modal-container #gm-ggb-material-modal");if(0===n.size()){var r=(n=t.select("#gm-modal-container").append("div").attr("id","gm-ggb-material-modal").classed("modal fade",!0).attr("role","dialog").style("display","none")).append("div").classed("modal-dialog",!0).append("div").classed("modal-content",!0).style("width","180px").append("div").classed("modal-body",!0);r.append("p").text("GeoGebra Material ID:");var o=r.append("input").attr({type:"text",id:"mat-id-input"});r.append("p"),r.append("button").attr("type","button").classed("btn btn-primary",!0).text("Load").on("click",function(){console.log(o),e.loadMaterial(o.node().value),i("#gm-ggb-material-modal").modal("hide")})}i("#gm-ggb-material-modal").modal("show")}},{key:"loadMaterial",value:function(t){console.log('Loading GGB material "'+t+'"...'),t&&t.length>0&&this.ggbApplet.openMaterial(t)}},{key:"removeElement",value:function(){this.element_div.remove(),this.canvas_model.on("el_inspected."+this.id,null),this.canvas_model.on("active_tool."+this.id,null),this.ggbElement&&-1!==this.canvas_model.elements().indexOf(this.ggbElement)&&this.canvas_model.removeElement(this.ggbElement)}},{key:"registerInspectListeners",value:function(){var t=this;this.canvas_model.on("el_inspected."+this.id,function(e){if(t.ggb_objs.filter(function(t){return t.highlighted}).forEach(function(e){return t.setGGBHighlight(e,!1)}),e.node){e.node.is_group("var")&&t.setGGBHighlight(t.getGGBObject(e.node.to_ascii()),!0);var n=e.node.get_root();t.links.forEach(function(e){e.model===n&&t.setGGBHighlight(e.ggb_obj,!0)})}}),this.canvas_model.on("active_tool."+this.id,function(e){"inspect"!==e.tool&&t.ggb_objs.filter(function(t){return t.highlighted}).forEach(function(e){return t.setGGBHighlight(e,!1)})})}},{key:"on_ggb_load",value:function(){this.ggbApplet=this.ggbElement.ggbApplet,this.updateAllGGBObjects(),this.update(),this.settings.get("links")&&this.loadLinks(this.settings.get("links"))}},{key:"moveAttached",value:function(t){this.settings.get("auto_attach")&&this.translateElement({x:t.pos.x+this.ggbElement.size.width-1,y:t.pos.y},t.animated)}},{key:"resizeAttached",value:function(t){this.settings.get("auto_attach")&&(this.translateElement({x:this.ggbElement.pos.x+t.size.width-1,y:this.ggbElement.pos.y}),this.resizeElement({width:this.size.width,height:t.size.height}))}},{key:"ggbUpdateListener",value:function(t){this.updateGGBObject(t),this._addToDOM&&this.settings.get("show_definitions")&&this.update()}},{key:"ggbClickListener",value:function(t){}},{key:"setGGBHighlight",value:function(e,n){if(e&&e.highlighted!==n){if(n)this.flashObject(e);else{var i=t.rgb(e.color);this.ggbApplet.setColor(e.name,i.r,i.g,i.b)}e.highlighted=n}}},{key:"flashObject",value:function(t){this.flashing&&(clearInterval(this.blinkTimer),this.ggbApplet.setColor(this.flashingObject.name,this.noFlashColor.r,this.noFlashColor.g,this.noFlashColor.b),"point"===this.flashingObject.type&&this.ggbApplet.setPointSize(this.flashingObject.name,2),"line"===this.flashingObject.type&&this.ggbApplet.setLineThickness(this.flashingObject.name,-1)),this.noFlashColor=this.ggbApplet.getColor(t.name),this.toggle=0,this.flashingObject=t,this.flashing=!0,this.blinkTimer=setInterval(this.blinker.bind(this,t),500)}},{key:"blinker",value:function(t){this.toggle%2==0?(this.ggbApplet.setColor(t.name,132,189,69),"point"===t.type&&this.ggbApplet.setPointSize(t.name,5),"line"===t.type&&this.ggbApplet.setLineThickness(t.name,7)):(this.ggbApplet.setColor(t.name,this.noFlashColor.r,this.noFlashColor.g,this.noFlashColor.b),"point"===t.type&&this.ggbApplet.setPointSize(t.name,2),"line"===t.type&&this.ggbApplet.setLineThickness(t.name,-1)),this.toggle+=1,this.toggle>3&&(clearInterval(this.blinkTimer),this.flashing=!1)}},{key:"setCanvasHighlight",value:function(t,e){this.setCanvasHighlightByLink(t,e)}},{key:"setCanvasHighlightByName",value:function(t,e){this.canvas_model.dls().forEach(function(n){n.rows.forEach(function(n){var i=!1;n.model.for_each(function(n){n.is_group("var")&&!n.fixed&&n.value===t&&(n.selected!==e&&(i=!0),n.selected=e)}),i&&(n.view.renderer.set_style(n.view.model.children),n.view.update_style(!0))})})}},{key:"setCanvasHighlightByLink",value:function(t,e){this.links.forEach(function(n){if(n.ggb_obj&&n.ggb_obj.name===t){var i=n.row.dl.getVisibleRowOn(n.row);i.model.children[0].selected=e,i.view.renderer.set_style(i.view.model.children),i.view.update_style(!0)}})}},{key:"ggbAddListener",value:function(t){this.updateGGBObject(t),this.update()}},{key:"ggbRemoveListener",value:function(t){var e=this.ggb_objs.find(function(e){return e.name==t&&!e.deleted});e&&(e.deleted=!0,this.update(),this.links.filter(function(e){return t===e.ggb_obj.name&&!e.dont_update}).forEach(function(t){return t.unlink()}),this.links=this.links.filter(function(e){return t!==e.ggb_obj.name||e.dont_update}))}},{key:"ggbRenameListener",value:function(t,e){var n=o.findIndex(this.ggb_objs,function(e){return t===e.name});-1===n?(this.updateGGBObject(e),this.update()):(this.ggb_objs[n].name=e,this.renameVariableOnCanvas(t,e),this.update())}},{key:"renameVariableOnCanvas",value:function(t,e){var n=e.split("_");this.canvas_model.dls().forEach(function(e){e.rows.forEach(function(e){var i=!1;e.model.for_each(function(e){e.is_group("var")&&!e.fixed&&e.value===t&&(i=!0,e.set_value(n[0],n[1]))}),i&&e.view.render()})})}},{key:"findOrCreateLink",value:function(t,e){var n=this.links.find(function(n){return n.ggb_obj.name===t.name&&n.row===e});return n?console.log("found existing link"):(console.log("creating new link"),n=new a.GM_GGB_Link(t,e,this),this.links.push(n)),n}},{key:"updateGGBObject",value:function(t){var e=this.getGGBObject(t,!0);e?e.deleted&&(e.type=this.ggbApplet.getObjectType(t),e.idx=this.ggbApplet.getObjectNumber(t),e.deleted=!1):(e={name:t,type:this.ggbApplet.getObjectType(t),idx:this.ggbApplet.getObjectNumber(t)},this.ggb_objs.push(e),"point"===e.type&&this.ggbApplet.setLabelVisible(t,!0)),e.def_str=this.ggbApplet.getDefinitionString(t),e.independent=this.ggbApplet.isIndependent(t),e.movable=this.ggbApplet.isMoveable(t),e.visible=this.ggbApplet.getVisible(t),"point"===e.type&&(e.x=this.ggbApplet.getXcoord(t),e.y=this.ggbApplet.getYcoord(t)),e.cmd_str=this.ggbApplet.getCommandString(t);var n=!1,i=this.ggbApplet.getValueString(t);Object.is(i,e.value_str)||(e.value_str=i,n=!0);try{var r=this.ggbApplet.getValue(t);Object.is(r,e.value)||(e.value=r,n=!0)}catch(t){}return n&&this.dont_update!==t&&this.links.forEach(function(e){e.onGGBChange(t)}),e}},{key:"updateAllGGBObjects",value:function(){this.ggbApplet.getAllObjectNames().forEach(this.updateGGBObject.bind(this))}},{key:"getGGBObject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.ggb_objs.find(function(n){return n.name===t&&(!n.deleted||e)})}},{key:"nestByType",value:function(e){return t.nest().key(function(t){return t.type}).sortKeys(t.ascending).sortValues(function(t,e){return t.idx-e.idx}).entries(e)}},{key:"dropDLRow",value:function(t){var e=l.GgbTools.convertGmToGgbString(t.model),n=this.ggbApplet.evalCommandGetLabels(e);n&&(this.ggbApplet.setLabelVisible(n,!0),t.model.settings.get("locked")&&(this.ggbApplet.setFixed(n,!0),this.ggbApplet.setColor(n,68,68,68),this.ggbApplet.setPointSize(n,3)),this.findOrCreateLink(this.getGGBObject(n),t),this.links.forEach(function(t){t.onGGBChange(n)}))}},{key:"matchSILine",value:function(t){var e=t.match("y=±{m:\\NUM}*{x:x}±{?b:\\NUM}","y={?x:x}±{?b:\\NUM}");return e?{m_val:e.m?e.m.get_signed_value():e.x?1:0,b_val:e.b?e.b.get_signed_value():0,m_node:e.m,b_node:e.b}:!!(e=t.match("y=-x±{?b:\\NUM}"))&&{m_val:-1,b_val:e.b?e.b.get_signed_value():0,b_node:e.b}}},{key:"matchSegment",value:function(t){return t.match("\\VAR = ±{val:\\NUM}")}},{key:"matchPoint",value:function(t){return t.match("\\VAR = (±{x:\\NUM},±{y:\\NUM})","\\VAR = (±{x:\\NUM},±{y:\\NUM},±{z:\\NUM})","(±{x:\\NUM},±{y:\\NUM})","(±{x:\\NUM},±{y:\\NUM},±{z:\\NUM})")}},{key:"matchPointString",value:function(t){return this.__pt_rx||(this.__pt_rx=new RegExp(".*= ?\\(([^(),]*),([^(),]*)(?:,([^(),]*))?\\)")),t.match(this.__pt_rx)}},{key:"dropGGBObject",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto",i=this.canvas_model,r=i.canvas().controller,o=l.GgbTools.convertGgbToGmString(t);r.simulateStartOfInteraction(),"text"===t.type?i.createElement("textbox",{text:o,pos:n,select_on_create:!0}):i.createElement("derivation",{eq:o,pos:n,select_on_create:!0},"ggb-link",function(n){t.cmd_str&&n.getLastModel().setLocked(!t.movable),e.findOrCreateLink(t,n.getLastRow())}),r.simulateEndOfInteraction()}},{key:"update",value:function(){if(this._addToDOM){var e=this,n=this.div.selectAll("div.type").data(this.nestByType(this.ggb_objs.filter(function(t){return!t.deleted})));n.enter().append("div").classed("type",!0).append("p"),n.exit().remove(),n.select("p").text(function(t){return n=(e=t.key).length,e.match(/[^aeiou]y$/)?e.substr(0,n-1)+"ies":e.match(/(ch|sh|s|ss|x|z|zz)$/)?e+"es":e+"s";var e,n}).style("font-weight","bold");var i=n.selectAll("p.object").data(function(t){return t.values});i.enter().append("p").classed("object",!0).style("cursor","pointer").on("click",function(t){e.dropGGBObject(t),e.setGGBHighlight(t,!0),e.setCanvasHighlight(t.name,!0)}).on("mouseenter",function(n){e.setGGBHighlight(n,!0),e.setCanvasHighlight(n.name,!0),t.select(this).style("color","red")}).on("mouseleave",function(n){e.setGGBHighlight(n,!1),e.setCanvasHighlight(n.name,!1),t.select(this).style("color","black")}),i.exit().remove(),i.text(function(t){return e.show_definitions?t.value_str:t.name})}}},{key:"toJSON",value:function(){return o.object.merged(this.settings.getModified(),{type:"GeoGebraPanel",id:this.id,pos:this.pos,size:{width:this.settings.get("hidden")?this.settings.get("prev_width"):this.size.width,height:this.size.height},ggbElement:this.ggbElement.id,links:this.links})}},{key:"loadLinks",value:function(t){var e=this,n={GM_GGB_Link:a.GM_GGB_Link,GM_GGB_SI_Line_Link:u.GM_GGB_SI_Line_Link};t.forEach(function(t){var i=n[t.type];if(!i)throw"Unknown link type "+t.type;e.links.push(i.fromJSON(t,e,e.canvas_model))})}},{key:"_addToDOM",get:function(){return"classic"===this.ggbElement.settings.get("ggb_app_name")}}],[{key:"fromJSON",value:function(t,e,n){return t.ggbElement=e[t.ggbElement],n.createElement("ggb-panel",t)}}]),n}(),new c.SettingsType("GeoGebraPanel").defaults.setAll(c.SettingsType.get("CanvasElement").defaults.getAll()).setAll({type:"GeoGebraPanel",auto_attach:!0,size:{width:120,height:500},min_size:{width:75,height:50},resizable:{x:!0,y:!1},prev_width:120,font_size:15,bg_edit_style:{border:"1px solid silver","background-color":"#eee"},bg_edit_active_style:{"background-color":"#eee"},bg_arrange_style:{"background-color":"#eee"},bg_arrange_active_style:{"background-color":"#eee"},show_definitions:!1,draggable:!1,links:[],hidden:!1})}).call(this,n(6),n(8))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasModelView=void 0;var i=n(0),r=n(10),o=n(21),s=n(34),a=n(80),l=n(39),u=n(53),c=n(77),d=n(76),h=n(19),p=n(75),f=n(74);e.CanvasModelView=function(e){var n,g,m,v,y,b,_,x=t.dispatch("create","remove","reset","active_tool","input_mode","el_change","el_changed","el_moved","el_inspected"),w=!0,A=i.gmath.uid(),k=e.settings,T=null,S=[],M=[],E=[],N="mouse",O=!0,q=r.SettingsType.get("Derivation").doc,C=!1,P=!0,j=!1,D=function e(i){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return O=r,n=(T=i).append("div").style({position:"absolute",left:0,right:0,top:0,bottom:0}),g=n.append("svg").style({position:"absolute",width:"100%",height:"100%",left:0,top:0}).style("pointer-events","none").append("g"),y=n.append("div").style({position:"absolute",left:0,right:0,top:0,bottom:0}),m=T.append("svg").style({position:"absolute",width:"100%",height:"100%",left:0,top:0}).style("pointer-events","none").append("g"),v=T.append("svg").style({position:"absolute",width:"100%",height:"100%",left:0,top:0}).style("pointer-events","none").append("g"),b=T.append("div").style({position:"absolute",left:0,right:0,top:0,bottom:0}).style({display:"none","pointer-events":"all"}),(_=T.append("div").classed("alert alert-info alert-dismissible",!0).style({display:"none",position:"absolute"}).on("click",function(){t.event.stopPropagation()})).append("span"),_.append("button").classed("close",!0).on("click",e.hideNotice.bind(this)).append("span").html("&times;"),this};function I(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;x.create({type:"create",target_type:t.type,target:t,method:e}),t instanceof h.CanvasElement?(D.setActiveTool("edit",!0),t.events.on("moved."+A,function(e){w&&x.el_moved({type:"el_moved",target_type:t.type,target:t,pos:e.pos})}),"derivation"===t.type&&(t.events.on("pack_state."+A,function(e){t.events.on("end-of-interaction."+A,function(e){t.events.on("end-of-interaction."+A,null),w&&x.el_changed({type:"el_changed",target_type:t.type,target:t,last_eq:t.getLastModel().to_ascii()})})}),t.events.on("change."+A,function(e){w&&x.el_change({type:"el_change",target_type:t.type,target:t,last_eq:t.getLastModel().to_ascii()}),t.events.on("end-of-interaction."+A,function(e){t.events.on("end-of-interaction."+A,null),setTimeout(function(){w&&x.el_changed({type:"el_changed",target_type:t.type,target:t,last_eq:t.getLastModel().to_ascii()})})})}),t.events.on("inspect_node."+A,function(e){w&&x.el_inspected({type:"el_inspected",target_type:t.type,target:t,node:e.node})}))):"path"===t.type&&(t.events.on("change."+A,function(e){w&&x.el_changed({type:"el_change",target_type:t.type,target:t})}),t.events.on("changed."+A,function(e){w&&x.el_changed({type:"el_changed",target_type:t.type,target:t})}))}function F(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;w&&x.remove({type:"remove",target_type:t.type,target:t,method:e}),"derivation"===t.type&&(t.events.on("change."+A,null),t.events.on("moved."+A,null),t.events.on("inspect_node."+A,null))}D.canvas=function(){return e},D.renderAll=function(){S.forEach(function(t){t.render&&t.render()})},D.enableNotifications=function(t){return 0===arguments.length?P:(!t&&P&&this.hideNotice(),P=t,this)},D.showNotice=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info";_&&P&&(j=!0,_.attr("class","alert alert-"+n+" "+(e?"alert-dismissible":"")),_.select("span").text(t),_.select(".close").style("display",e?null:"hidden"),_.style({display:null,width:T.node().scrollWidth+"px",top:T.node().parentNode.scrollTop+"px"}),setTimeout(function(){T.on("click."+A,D.hideNotice)},0))},D.updateNotice=function(){j&&_.style("top",T.node().parentNode.scrollTop+"px")},D.hideNotice=function(){_&&(j=!1,_.style("display","none"),T.on("click."+A,null))},D.reset=function(){for((0,o.linkCoordinator)().unlinkCanvasModel(this);S.length>0;)this.removeElement(S[0]);for(var t=M.length-1;t>=0;t--)this.removePath(M[t]);E=[],this.scroll(0)},D.lockActive=function(t){return 0===arguments.length?C:(C=t,this)},D.setActive=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&!D.getElementByID(t.id)||C||(t&&(t.setActive(e),"derivation"===t.type&&t.element_div&&n.node().appendChild(t.element_div.node())),S.forEach(function(e){e!==t&&(e.setActive(!1),t||"table"!==e.type&&"textbox"!==e.type||e.unselect())}))},D.inputMode=function(t){return 0===arguments.length?N:N!==t?(N=t,w&&x.input_mode({type:"input_mode",mode:N}),this):void 0},D.willAcceptDroppedElements=function(){return e.settings.get("accept_dropped_assets")},D.focusOnDL=function(t){t.events.on("end-of-interaction."+this.id,t.initPosition.bind(t,!0))},D.fontSize=function(t){if(0===arguments.length)return q.get("font_size");q.set("font_size",t),this.getElementsOfType("derivation").forEach(function(t){t.settings.unset("font_size"),t.updateFontSize()})},D.createDL=function(t,e,n){return this.createElement("derivation",t,n,e)},D.createElement=function(t,e,r,o){var u=function(t){if("canvas-element"===t)return h.CanvasElement;if("image"===t)return d.CanvasImage;if("video"===t)return p.CanvasVideo;if("textbox"===t)return c.TextBox;if("graph"===t)return i.gmath.ui.Graph;if("derivation"===t)return s.Derivation;if("ggb-panel"===t)return a.GeoGebraPanel;if("ggb-element"===t)return l.GeoGebraCanvasElement;if("table"===t)return f.Table;if("multichoice"===t)return i.gmath.ui.Multichoice;if("graph-eq"===t)return i.gmath.ui.GraphEq;throw'unkown element type "'+t+'"'}(t),g=i.gmath.extend({},e),m=new u(D,n.node(),g,function(t){v(t),o&&o(t)});function v(t){-1===S.indexOf(t)&&(t.setMode(k.get("active_tool")),S.push(t),O&&D.size().height<t.size.height+t.pos.y&&T.style("height",t.pos.y+t.size.height+10+"px"),I(t,r))}return v(m),m},D.addElement=function(t){if(t in S)throw"element is already part of this canvas";return L(E,t),t.canvas_model=D,t.initElement(n.node()),t.setMode(k.get("active_tool")),S.push(t),I(t),D},D.addDL=function(t){return this.addElement(t)},D.createDLs=function(t,e,n,r){var o=0;!function s(a){if(o===t.length)n&&n();else{a&&(e.pos[1]+=a.dims.height);var l=i.gmath.deepCopy(e);l.eq=t[o++],D.createDL(l,s,r)}}()},D.isInFreeVisibleSpace=function(t,e){var n=this.viewport();return!(t.y<n.y||t.y+t.height>n.y+n.height)&&0===this.getIntersectingElements(t,e).length},D.getIntersectingElements=function(t,e){return S.filter(function(n){return e!==n&&i.gmath.HitTester.overlaps(t,n.getBBox())})},D.getClosestElement=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,i=e?S.filter(e):S;if(0===i.length)return null;var r=i.map(function(e){return{el:e,dist:e.getDistanceTo(t)}}).sort(function(t,e){return t.dist-e.dist})[0];return r.dist<=n?r.el:void 0},D.moveToFreeSpace=function(e){for(var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.05,o=e.getBBox(),s=this.viewport(),a=2;a>=0;a-=1){var l=r?a*r:0,u={left:l*s.width,right:l*s.width,top:l*s.height,bottom:l*s.height},c={x:s.x,y:s.y,width:o.width+u.left+u.right,height:o.height+u.top+u.bottom};for(i&&(c.y=i.pos.y+i.size.height+u.top+1);c.y+c.height<s.y+s.height;){for(;c.x+c.width<s.x+s.width;){var d=this.getIntersectingElements(c,e);if(0===d.length)return e.translateElement({x:c.x+u.left,y:c.y+u.top},n),!0;var h=t.max(d,function(t){return t.pos.x+t.size.width});c.x=h+1}c.x=s.x,c.y=c.y+s.height/20}if(!r)break}return e.settings.set("pos",{x:"center",y:"center"}),e.initPosition(n),!1},D.createPath=function(t,e){var n=new u.Path(m.node(),t);return M.push(n),I(n,e),n},D.removePath=function(t){L(M,t),t.remove(),F(t)},D.addPath=function(t){if(-1!==M.indexOf(t))throw"path is already in this model";return t.setContainer(m),t.init(),M.push(t),I(t),t},D.removeElement=function(t){L(S,t),E.push(t);var e=t.removeElement();return F(t),e};var L=function(t,e){if(0===t.length)return!1;var n=t.indexOf(e);return-1!==n&&(t.splice(n,1),!0)};D.elements=function(){return S},D.dls=function(){return D.getElementsOfType("derivation")},D.getElementsOfType=function(t){return S.filter(function(e){return e.type===t})},D.getElementByID=function(t){for(var e=0;e<S.length;e++)if(S[e].id===t)return S[e];for(e=0;e<M.length;e++)if(M[e].id===t)return M[e]},D.getDeletedElementByID=function(t){for(var e=0;e<E.length;e++)if(E[e].id===t)return E[e]},D.paths=function(t){if(!arguments.length)return M;for(var e=0;e<M.length;e++)M[e].remove();for(M=t.slice(),e=0;e<M.length;e++)M[e].setContainer(m),M[e].init();w&&x.reset({target_type:"path",target:M.slice()})};var z=function(e){return function(){var n=t.interpolateNumber(this.scrollTop,e);return function(t){this.scrollTop=n(t)}}};return D.scroll=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=T.node().parentNode.scrollTop;return 0===arguments.length?i:e===i?this:(D.hideNotice(),n?t.select(T.node().parentNode).transition().duration(600).tween("scrollTop",z(e)):T.node().parentNode.scrollTop=e,this)},D.scrollX=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=T.node().parentNode.scrollLeft;return 0===arguments.length?i:e===i?this:(D.hideNotice(),n?t.select(T.node().parentNode).transition().duration(600).tween("scrollLeft",z(e)):T.node().parentNode.scrollLeft=e,this)},D.scrollToElementTop=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.scroll(Math.max(0,t.pos.y-e),n)},D.scrollToShowElement=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t.getBoundingClientRect(),r=i.gmath.ui.Keyboard(),o=1/0,s=this.viewport();r&&r.visible()?o=r.container().getBoundingClientRect().top:r&&(o=(window.innerHeight||document.documentElement.clientHeight)-r.height());var a=t.pos.y>s.y+s.height,l=t.pos.y+t.size.height<s.y,u=o<n.bottom&&t.pos.y>s.y+10;a||l?this.scroll(Math.max(0,t.pos.y-10),e):u&&this.scroll(Math.max(0,Math.min(t.pos.y-10,this.scroll()-o+n.bottom+50)),e)},D.container=function(){return T},D.html_container=function(){return n},D.background_event_layer=function(t){return y},D.foreground_event_layer=function(t){return b},D.foreground_event_layer_visible=function(t){if(!arguments.length)return b.style("display");b.style("display",t?null:"none")},D.front_svg=function(t){return arguments.length?(m=t,this):m},D.back_svg=function(t){return arguments.length?(g=t,this):g},D.foreground_svg=function(t){return arguments.length?(v=t,this):v},D.actionsTriggeredManually=function(t){return arguments.length?(w=t,this):w},D.size=function(){var t=T.node();return{width:t.clientWidth,height:t.clientHeight}},D.horizontalScrollEnabled=function(){return e.settings.get("horizontal_scroll")},D.verticalScrollEnabled=function(){return e.settings.get("vertical_scroll")},D.viewport=function(){var t=T.node().parentNode;return{x:0,width:t.clientWidth,y:t.scrollTop,height:t.clientHeight}},D.getActiveTool=function(){return k.get("active_tool")},D.setActiveTool=function(t,e){var n=k.get("active_tool");return k.set("active_tool",t),S.forEach(function(e){return e.setMode(t)}),x.active_tool({type:"active_tool",tool:t,prevTool:n,auto:e}),this},D.clearAllTermTracesExcept=function(t){D.getElementsOfType("derivation").forEach(function(e){e!==t&&e.clearTraceProperties()}),s.Derivation.hideTermTraces(g,n)},t.rebind(D,x,"on")}}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=s(n(52)),o=s(n(207));function s(t){return t&&t.__esModule?t:{default:t}}var a=function(){function t(e){var n=e.settingsType,i=e.settingName,o=e.isUserSetting,s=e.fallbackValue;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=n,this.name=i,this.isUserSetting=o,this.fallbackValue=s,this.settings=(0,r.default)(o,n)}return i(t,[{key:"get",value:function(){return this.assertNameExists(),this.settings.getIfExists(this.name,this.fallbackValue)}},{key:"getName",value:function(){return this.name}},{key:"getByKey",value:function(t){return this.settings.get(t)}},{key:"set",value:function(t){return this.assertNameExists(),this.settings.set(this.name,t)}},{key:"setByKey",value:function(t,e){return this.settings.set(t,e)}},{key:"setLibValue",value:function(t,e,n){return this.settings.get(t)[e]=n}},{key:"unset",value:function(){return this.assertNameExists(),this.settings.unset(this.name)}},{key:"isModified",value:function(){return this.assertNameExists(),(0,o.default)(this.settings,this.name)}},{key:"assertNameExists",value:function(){if(!this.name)throw"[AppSetting] Unexpected use of instance method: no configured setting name."}},{key:"saveCurrentSettingsOntoDocument",value:function(){if(this.isUserSetting)throw new Exception("saveCurrentSettingsOntoDocument() called on the wrong object");this.set(this.get())}}]),t}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.addSettingsButton=function(t){t.appendButtonGroup([{type:"push",label:"settings",pull_right:!0,icon:"glyphicon glyphicon-cog"}],o.bind(null,(0,r.getDocumentSettingsModal)(),t)),function(){var t=(0,r.getDocumentSettingsModal)(),e=!0,n=!1,i=void 0;try{for(var o,s=t.settingForms[Symbol.iterator]();!(e=(o=s.next()).done);e=!0){o.value.saveCurrentSettingsOntoDocument()}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}}()},e.showUserSettingsModal=function(t){o((0,r.getUserSettingsModal)(),t)};var i=n(17),r=n(212);function o(t,e){t.onSave(function(){t.hide(),t.settingForms.forEach(function(t){return t.writeData()}),e.model.dls().forEach(function(t){return t.rows.forEach(function(t){return t.view.model.hide_nodes()})}),e.model.renderAll(),t.isUserSetting&&i.user.saveSettings()}),t.presetSettingForm.render(),t.settingForms.forEach(function(t){return t.render()}),t.presetSettingForm.onChange("menu-preset-input",function(t,e){e&&(e=e.options,Object.keys(e).forEach(function(n){var i=e[n];t.forEach(function(t){return t.setFormValue(i)})}))}.bind(null,t.settingForms)),t.show()}},function(t,e,n){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0}),e.addHelpButton=function(e,i){e.appendButtonGroup([{type:"dropdown",label:"help",data_toggle:"dropdown",pull_right:!0,icon:"glyphicon glyphicon-question-sign",html_fn:function(e,i,h,p){var f={width:320,row_height:40},g=function(e,n){return t.select(e).append("div").style("width",n.width+22+"px").style("padding","5px").on("click",function(){t.event.stopPropagation()})}(h,f);return l(h),function(e,i,o,h){var p=a(),f=i.append("div").classed("panel gm-help",!0).style("width",o.width+2+"px").style("height",o.row_height*r.length+2+"px").style("margin","5px").style("border","1px solid silver").selectAll(".block").data(r).enter().append("a").style("background-color",function(t){return t.version>p?"lightyellow":null}).classed("block",!0).attr("href",function(t){return t.external_page?t.src:"#"}).attr("target",function(t){return t.external_page?"_blank":null}).style("width",o.width+"px").style("height",o.row_height+"px").on("click",function(r){var o;window&&window.gmath_log_ga&&gmath_log_ga.trackEvent("gm-canvas-event","help-menu","choice",r.menu_title),r.disabled||(r.version&&r.version>p&&(o=r.version,localStorage.setItem("gm-help-version-shown",o),p=r.version,l(h),i.selectAll("a").style("background-color",function(t){return t.version>p?"lightyellow":null})),n("body").trigger("click"),r.external_page||(r.video?(e.video_modal.playSingle(r.video),r.switch_on_sound&&e.video_modal.unMute()):(t.event.preventDefault(),(s=r).active_part=0,u(),c(0),d())))});f.filter(function(t){return t.icon}).append("span").attr("class",function(t){return t.icon}).style("margin-left","1em").style("font-size","0.8em"),f.append("span").text(function(t){return t.menu_title})}(e,g,f,h),function(e,n){0===(o=t.select("#gm-modal-container #gm-help-modal")).size()&&((o=t.select("#gm-modal-container").append("div").attr("id","gm-help-modal").classed("modal fade",!0).attr("role","dialog").style("display","none")).append("div").classed("modal-dialog",!0).style("width","650px").style("max-width","90%").append("div").classed("modal-content",!0),u(),n&&!localStorage.getItem("gm-finished-welcome-help")&&e.callWhenReady(function(t){return setTimeout(d,500)}))}(e,i),c(0),g.node()}.bind(null,e,i)}])},e.getHelpEntries=function(){return r};var i=2,r=[{menu_title:"Introduction",modal_title:"Welcome to the Graspable Math Canvas!",src:"https://graspablemath.com/shared/content/help-pages/introduction.html",parts:5},{menu_title:"Learning Resources",icon:"glyphicon glyphicon-new-window",external_page:!0,src:"https://graspablemath.com/learn"},{menu_title:"Cheat Sheet",icon:"glyphicon glyphicon-new-window",external_page:!0,src:"https://graspablemath.com/shared/content/gm-summary-sheet.pdf",version:4},{menu_title:"Exploration and presentation mode",modal_title:"User modes",src:"https://graspablemath.com/shared/content/help-pages/user-modes.html",parts:4,version:3},{menu_title:"How do I pick up a group of symbols?",modal_title:"Picking up a group of symbols",src:"https://graspablemath.com/shared/content/help-pages/groups.html",parts:6},{menu_title:"How do I load and save my work?",modal_title:"Loading & Saving Math Sheets",src:"https://graspablemath.com/shared/content/help-pages/login-system.html",parts:2,version:2},{menu_title:"How can I freely rewrite an expression?",modal_title:"Rewriting Expressions With The Keyboard",src:"https://graspablemath.com/shared/content/help-pages/shaking.html",parts:2},{menu_title:"How do I correct a mistake?",modal_title:"Correcting Mistakes",src:"https://graspablemath.com/shared/content/help-pages/correcting-mistakes.html",parts:2},{menu_title:"How do I substitute a term for a variable?",modal_title:"Substitution in Graspable Math",src:"https://graspablemath.com/shared/content/help-pages/substitution.html",parts:2},{menu_title:"How do I work with negative numbers?",modal_title:"Working with Negative Numbers",src:"https://graspablemath.com/shared/content/help-pages/negatives.html",parts:3},{menu_title:"How to add fractions with unlike denominators?",modal_title:"Adding Fractions with Unlike Denominators",switch_on_sound:!1,video:"_CQ6oHM-Nn4"},{menu_title:"How do I assign a math sheet on Google Classroom?",modal_title:"Google Classroom Integration",src:"https://graspablemath.com/shared/content/help-pages/gc-integration.html",parts:4,version:5},{menu_title:"Interactive Gesture Tutorials",icon:"glyphicon glyphicon-new-window",external_page:!0,src:"https://graspablemath.com/tutorial/index.html"},{menu_title:"Contact Us",icon:"glyphicon glyphicon-envelope",external_page:!0,src:"mailto:contact@graspablemath.com"}],o=null,s=r[0];function a(){return+(localStorage.getItem("gm-help-version-shown")||"0")}function l(e){var n,i=(n=a(),r.some(function(t){return t.version&&t.version>n}));t.select(e).select(".btn").style("background-color",i?"lightyellow":null)}function u(){var t=o.select(".modal-content");t.selectAll("*").remove();var e=t.append("div").classed("modal-header",!0).style("padding-left","25px").style("padding-right","25px");e.append("button").attr("type","button").classed("close",!0).attr("data-dismiss","modal").style("font-size","28px").html("&times;"),e.append("h3").classed("modal-title",!0).style("font-size","20px").html(s.modal_title),t.append("div").classed("modal-body",!0).style("padding-left","35px").style("padding-right","35px").append("iframe").attr("class","help-content").style("border","none").style("display","block").style("width","100%").style("height","400px").on("load",function(){c(s.active_part)}).attr("src",s.src+"?ver="+i);var r=t.append("div").classed("modal-footer",!0).style("padding-left","25px").style("padding-right","25px").append("div").style("display","flex").style("align-items","center").style("margin","0.5em");r.append("div").style("flex","1 1 0").style("text-align","left").append("a").attr("href","#").classed("gm-help-modal__button--previous",!0).style("visibility","hidden").text("back").on("click",function(t){return c(s.active_part-1)});for(var a=[],l=0;l<s.parts;l++)a.push(l);r.append("div").style("flex","10 10 0").style("text-align","center").selectAll("span").data(a).enter().append("span").style({width:"15px",height:"15px","border-radius":"50%",cursor:"pointer",margin:"0 10px"}).style("display",function(t){return s.parts>1?"inline-block":"none"}).classed("gm-marker",!0).style("background","silver").on("click",function(t,e){return c(e)}),r.append("div").style("flex","1 1 0").style("text-align","right").append("button").classed("gm-help-modal__button--next",!0).attr("type","button").classed("btn btn-primary",!0).text("Next").on("click",function(t){s.active_part===s.parts-1?(localStorage.setItem("gm-finished-welcome-help",!0),n("#gm-help-modal").modal("hide")):c(s.active_part+1)})}function c(e){s.active_part=e,o.selectAll(".gm-marker").style("background",function(t,e){return s.active_part===e?"steelblue":"gray"});var n=o.select("iframe.help-content").node().contentDocument;if(null!=n){var i=t.select(n.body);i.style("font-size","100%"),i.selectAll(".content").style("display",function(t,e){return s.active_part===e?"block":"none"}).style("text-align","center"),i.style({"font-family":'Lato, "Helvetica Neue", Helvetica, Arial, sans-serif'}),i.selectAll("h3").style({"font-size":"1em"}),o.select("iframe.help-content").style("visibility",null),o.select(".gm-help-modal__button--previous").style("visibility",0===s.active_part?"hidden":null),o.select(".gm-help-modal__button--next").text(s.active_part===s.parts-1?"Done":"Next")}}function d(){var t=n("#gm-help-modal");t.modal&&t.modal("show"),window&&window.gmath_log_ga&&gmath_log_ga.trackEvent("gm-canvas-event","help-menu","show",1)}s.active_part=0}).call(this,n(6),n(8))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return"gm-btn-"+t}},function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.addHomeworkButton=function(e){var n="column",l={width:200,height:200},u={width:400,height:400},c=null,d=void 0,h=void 0,p=void 0,f=void 0,g={col1:380,row1:40,col2:580,height:360};function m(t){t.video&&(i.event.stopPropagation(),i.event.preventDefault(),y(),window&&window.gmath_log_ga&&window.gmath_log_ga.trackEvent("Homework Menu","play video",t.video,"1"),e.video_modal.playSingle(t.video))}function v(t){var c=t.title.split(" ")[0];d.selectAll("div.subchapter").style("background-color",function(e,n){return e==t?"#e7f5fe":n%2==0?"whitesmoke":"white"}),f.selectAll(".problem").remove();var h=f.selectAll(".problem").data(t.problems).enter().append("div").classed("problem",!0).style("position","relative").style("width",g.col2+"px").style("background-color",function(t,e){return 0==t.parts.length?"#e6e6e6":e%2==0?"whitesmoke":"white"}).style({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none"}).style("cursor",function(t){return 0==t.parts.length?"default":"pointer"}).each(function(t,a){t.alignment||(t.alignment=n);var u=i.select(this),c=0,d=0,h=0,p=0,f=u.append("div").style("position","relative").style("width",g.col2+"px").style("pointer-events","none");t.video&&u.append("div").classed("gm-homework-play-btn",!0).on("click",m).append("span").classed("glyphicon glyphicon-play",!0),f.append("p").html(t.num).style("left","5px").style("width","30px").style("text-align","right");var v=f.append("p").html(t.text).style("left","45px").style("width",g.col2-18-90+"px");f.selectAll("p").style("position","absolute").style("margin","0px").style("top","15px").style("font-weight","bold").style("color","lightskyblue").style("pointer-events","none");var y=parseFloat(v.style("height"))+15;0==t.parts.length&&(y+=15),f.style("height",y+"px"),d+=y,"row"==t.alignment&&(u=u.append("div").style("position","absolute").style("left","50%").style("transform","translateX(-50%)").style("-webkit-transform","translateX(-50%)")),u.selectAll(".part").data(t.parts).enter().append("div").classed("part","true").style("position","relative").style("pointer-events","none").each(function(n){var a,u=i.select(this),f=0,m=0;if("derivation"==n.type){var v=u.append("div").style("pointer-events","none"),y=new o.AlgebraModel(n.options.eq);new r.AlgebraView(y,v.node(),{font_size:20,v_align:"center",fixed:!0},function(e){var n=e.getBBox();m=n.height+30,"row"==t.alignment?(f=n.width+80,c+=f,v.style({position:"absolute",top:"50%",transform:"translateY(-50%)","-webkit-transform":"translateY(-50%)"})):"column"==t.alignment&&(f=g.col2-18),u.style("width",f+"px"),v.style({width:f+"px",height:m+"px"});var i="translate("+f/2+"px,"+m/2+"px)";e.main.style("transform",i).style("-webkit-transform",i)})}else if("textbox"==n.type){var b=u.append("p").html(n.options.text).style("margin","0px").style("pointer-events","none");"row"==t.alignment?(f=b.node().clientWidth+40,c+=f,b.style("position","absolute").style("top","50%").style("transform","translateY(-50%)").style("-webkit-transform","translateY(-50%)").style("text-align","center")):"column"==t.alignment&&(f=g.col2-18-90,b.style("position","absolute").style("left","45px").style("top",t.text?"10px":"0px")),u.style("width",f+"px"),b.style("width",f+"px"),m=b.node().clientHeight,n.options.size={width:f,height:m},n.options.font_size=parseFloat(b.style("font-size")),m+=20}else if("ggb-element"==n.type){var _=u.append("div").style("position","absolute").style("left","50%").style("top","50%").style("transform","translate(-50%, -50%)").style("-webkit-transform","translate(-50%, -50%)").style("width",l.width+"px").style("height",l.height+"px").style("border","1px solid black").style("overflow","hidden"),x=n.options;x.pos={x:0,y:0},x.size=l,new s.GeoGebraCanvasElement(e.model,_.node(),n.options,function(t){t.element_div.style("pointer-events","none"),t.ggbApplet.setCoordSystem(x.xmin,x.xmax,x.ymin,x.ymax),t.ggbApplet.setAxisSteps(1,1,1,1),x.points.forEach(function(e,n){var i=String.fromCharCode(97+n).toUpperCase();t.ggbApplet.evalCommand(i+"=("+e.x+","+e.y+")"),t.ggbApplet.setColor(i,135,206,250),e.label&&(t.ggbApplet.setCaption(i,e.label),t.ggbApplet.setLabelStyle(i,3),t.ggbApplet.setLabelVisible(i,!0))}),x.lines.forEach(function(e,n){var i=String.fromCharCode(97+n);t.ggbApplet.evalCommand(i+":"+e.eq),t.ggbApplet.setColor(i,135,206,250),e.label&&(t.ggbApplet.setCaption(i,e.label),t.ggbApplet.setLabelStyle(i,3),t.ggbApplet.setLabelVisible(i,!0))})}),"row"==t.alignment?(f=l.width+40,c+=f):"column"==t.alignment&&(f=g.col2-18),u.style("width",f+"px"),m=l.height+40}if("row"==t.alignment?(m>h&&(h=m),u.style("display","inline-block").style("height","100%")):"column"==t.alignment&&(d+=m,u.style("height",m+"px")),n.label){var w=u.append("p").html((a=p,String.fromCharCode(97+a))).style("position","absolute").style("color","lightskyblue").style("pointer-events","none");"row"==t.alignment?w.style("top","50%").style("transform","translateY(-50%)").style("-webkit-transform","translateY(-50%)"):"column"==t.alignment&&w.style("left","5px").style("top","10px").style("width","30px").style("text-align","right"),p++}}),"row"==t.alignment?(u.style("width",c+"px").style("height",h+"px"),d+=h,i.select(u.node().parentNode).style("height",d+"px")):"column"==t.alignment&&u.style("height",d+"px")}).on("click",function(t,n){0!=t.parts.length&&(h.filter(function(e){return e==t}).transition().duration(150).style("background-color","#e7f5fe").transition().duration(150).style("background-color",n%2==0?"whitesmoke":"white").each("end",y),function(t,n){var i=function(t){for(var e=0;e<a.length;e++)for(var n=a[e],i=0;i<n.subchapters.length;i++){var r=n.subchapters[i];if(-1!==r.problems.indexOf(t))return{chapter:n,subchapter:r}}return null}(t);e.logger.logCustomInteraction("homework-menu",{action:"select",problem:t.num,chapter:i.chapter.title,subchapter:i.subchapter.title});var r=20,o=0;function s(){e.model.setActive(),e.controller.simulateStartOfInteraction(),function n(i){if(t.parts.length>i){var s=function(e){"row"==t.alignment?r+=e.size.width+20:"column"==t.alignment&&(o+=e.size.height+20),n(i+1),"ggb-element"==t.parts[i].type&&(e.element_div.style("pointer-events","none").style("border","1px solid black").style("overflow","hidden"),e.ggbApplet.setCoordSystem(a.xmin,a.xmax,a.ymin,a.ymax),e.ggbApplet.setAxisSteps(1,1,1,1),a.points.forEach(function(t,n){var i=String.fromCharCode(97+n).toUpperCase();e.ggbApplet.evalCommand(i+"=("+t.x+","+t.y+")"),e.ggbApplet.setColor(i,135,206,250),t.label&&(e.ggbApplet.setCaption(i,t.label),e.ggbApplet.setLabelStyle(i,3),e.ggbApplet.setLabelVisible(i,!0))}),a.lines.forEach(function(t,n){var i=String.fromCharCode(97+n);e.ggbApplet.evalCommand(i+":"+t.eq),e.ggbApplet.setColor(i,135,206,250),t.label&&(e.ggbApplet.setCaption(i,t.label),e.ggbApplet.setLabelStyle(i,3),e.ggbApplet.setLabelVisible(i,!0))}))};e.controller.simulateEndOfInteraction();var a=t.parts[i].options;switch(a.pos={x:r,y:o},a.v_align="top",t.parts[i].type){case"derivation":e.model.createDL(t.parts[i].options,s,"homework-menu");break;case"textbox":e.model.createElement("textbox",t.parts[i].options,"homework-menu",s);break;case"ggb-element":a.size=u,e.model.createElement("ggb-element",t.parts[i].options,"homework-menu",s)}e.controller.simulateEndOfInteraction()}}(0)}if(e.model.elements().forEach(function(t){var e=t.pos.y+t.size.height;e>o&&(o=e)}),o+=20,t.text){var l=n+"."+t.num+" "+t.text;e.model.createElement("textbox",{pos:{x:r,y:o},size:{width:472},text:l},null,function(t){o+=t.size.height+20,s()})}else s()}(t,c))})}function y(){t("body").trigger("click")}e.appendButtonGroup([{type:"dropdown",label:"problems",data_toggle:"dropdown",pull_right:!0,icon:"glyphicon glyphicon-book",html_fn:function(e,n){return function(t){h=t.append("div").style("width",g.col1+g.col2+2+"px").style("height",g.height+2+"px").style("margin","5px").style("border","1px solid silver"),p=h.append("div").classed("panel",!0).style("width",g.col1+"px"),f=h.append("div").classed("panel",!0).style("width",g.col2+"px"),t.selectAll(".panel").style("height",g.height+"px").style("border","none").style("margin","0px").style("display","inline-block").style("overflow-y","scroll").style("overflow-x","hidden");var e=p.selectAll(".chapter").data(a);e.enter().append("div").classed("chapter",!0).append("div").style("width",g.col1+"px").style("height",g.row1+"px").style("background-color","#e6e6e6").style({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none"}).style("overflow","hidden").style("padding-left","5px").style("line-height",g.row1+"px").append("p").html(function(t){return t.title}).style("font-weight","bold").style("pointer-events","none"),e.selectAll(".subchapter").data(function(t){return t.subchapters}).enter().append("div").classed("subchapter",!0).append("div").style("width",g.col1+"px").style("height",g.row1+"px").style({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none"}).style("overflow","hidden").style("padding-left","5px").style("line-height",g.row1+"px").style("cursor","pointer").on("click",v).append("p").html(function(t){return t.title}).style("pointer-events","none")}(d=function(t){var e=i.select(t).append("div").style("width",g.col1+g.col2+22+"px").style("padding","5px").on("click",function(){i.event.stopPropagation()});return e.append("p").text("click on a problem, then on the canvas").style("color","gray").style("font-style","italic").style("text-align","center"),e}(c=e)),t(c).on("shown.bs.dropdown",function(){v(a[0].subchapters[0])}),t(c).on("hide.bs.dropdown",function(){f.selectAll(".problem").remove()}),d.node()}}]),a.forEach(function(t){t.subchapters.forEach(function(t){t.problems.forEach(function(t){t.parts.forEach(function(t){"textbox"==t.type&&(t.options.uneditable=!0),"ggb-element"==t.type&&(t.options.ggb_params={showToolbar:!1,borderColor:"#FFFFFF"})})})})})};var r=n(14),o=n(5),s=n(39),a=[{title:"Chapter 1 Fundamental Concepts of Algebra",subchapters:[{title:"1.1 Real Numbers",problems:[{num:1,video:"v9PrVQlKBDQ",text:"If <i>x</i> < 0 and <i>y</i> > 0, determine the sign of the real number.",alignment:"row",parts:[{type:"derivation",options:{eq:"xy"},label:!0},{type:"derivation",options:{eq:"x^2y"},label:!0},{type:"derivation",options:{eq:"x/y+x"},label:!0},{type:"derivation",options:{eq:"y-x"},label:!0}]},{num:"3, 5",text:"We're not yet supporting these problems. Please see p. 13 in the textbook.",alignment:null,parts:[]},{num:7,text:"Express the statement as an inequality.",alignment:"column",parts:[{type:"textbox",options:{text:"<i>x</i> is negative."},label:!0},{type:"textbox",options:{text:"<i>y</i> is nonnegative."},label:!0},{type:"textbox",options:{text:"<i>q</i> is less than or equal to <i>π</i>."},label:!0},{type:"textbox",options:{text:"<i>d</i> is between 4 and 2."},label:!0},{type:"textbox",options:{text:"<i>t</i> is not less than 5."},label:!0}]},{num:9,video:"g_sB-B4GbiI",text:"Rewrite the number without using the absolute value symbol, and simplify the result.",alignment:"row",parts:[{type:"derivation",options:{eq:"|-3-2|"},label:!0},{type:"derivation",options:{eq:"|-5|-|2|"},label:!0},{type:"derivation",options:{eq:"|7|+|-4|"},label:!0}]},{num:11,text:"Rewrite the number without using the absolute value symbol, and simplify the result.",alignment:"row",parts:[{type:"derivation",options:{eq:"(-5)*|3-6|"},label:!0},{type:"derivation",options:{eq:"|-6|/(-2)"},label:!0},{type:"derivation",options:{eq:"|-7|+|4|"},label:!0}]},{num:13,text:"Rewrite the number without using the absolute value symbol, and simplify the result.",alignment:"row",parts:[{type:"derivation",options:{eq:"|4-π|"},label:!0},{type:"derivation",options:{eq:"|π-4|"},label:!0},{type:"derivation",options:{eq:"|sqrt2-1.5|"},label:!0}]},{num:15,text:"We're not yet supporting this problem. Please see p. 14 in the textbook.",alignment:null,parts:[]},{num:19,text:"The two given numbers are coordinates of points <i>A</i> and <i>B</i>, respectively, on a coordinate line. Express the indicated statement as an inequality involving the absolute value symbol.",alignment:"row",parts:[{type:"derivation",options:{eq:"x"},label:!1},{type:"derivation",options:{eq:"7"},label:!1},{type:"textbox",options:{text:"<i>d</i>(<i>A</i>, <i>B</i>) is less than 5"},label:!1}]},{num:23,text:"The two given numbers are coordinates of points <i>A</i> and <i>B</i>, respectively, on a coordinate line. Express the indicated statement as an inequality involving the absolute value symbol.",alignment:"row",parts:[{type:"derivation",options:{eq:"4"},label:!1},{type:"derivation",options:{eq:"x"},label:!1},{type:"textbox",options:{text:"<i>d</i>(<i>A</i>, <i>B</i>) is not greater than 3"},label:!1}]},{num:25,text:"Rewrite the expression without using absolute the value symbol, and simplify the result.",alignment:"row",parts:[{type:"derivation",options:{eq:"|3+x|"},label:!1},{type:"textbox",options:{text:"if <i>x</i> < -3"},label:!1}]},{num:27,text:"Rewrite the expression without using the absolute value symbol, and simplify the result.",alignment:"row",parts:[{type:"derivation",options:{eq:"|2-x|"},label:!1},{type:"textbox",options:{text:"if <i>x</i> < 2"},label:!1}]},{num:29,text:"Rewrite the expression without using the absolute value symbol, and simplify the result.",alignment:"row",parts:[{type:"derivation",options:{eq:"|a-b|"},label:!1},{type:"textbox",options:{text:"if <i>a</i> < b"},label:!1}]},{num:31,text:"Rewrite the expression without using the absolute value symbol, and simplify the result.",alignment:"row",parts:[{type:"derivation",options:{eq:"|x^2+4|"},label:!1}]},{num:"33-53",text:"We're not yet supporting these problems. Please see p. 14 in the textbook.",alignment:null,parts:[]},{num:57,text:"Avogadro's number",alignment:null,parts:[{type:"textbox",options:{text:"The number of hydrogen atoms in a mole is Avogadro's number, 6.02 x 10<sup>23</sup>. If one mole of the gas has a mass of 1.01 grams, estimate the mass of a hydrogen atom."},label:!1}]},{num:59,text:"Frames in a movie film",alignment:null,parts:[{type:"textbox",options:{text:"One of the longest movies ever made is a 1970 British film that runs for 48 hours. Assuming that the film speed is 24 frames per second, approximate the total number of frames in this film. Express your answer in scientific form."},label:!1}]},{num:61,text:"Tornado pressure",alignment:"column",parts:[{type:"textbox",options:{text:"When a tornado passes near a building, there is a rapid drop in the outdoor pressure and the indoor pressure does not have time to change. The resulting difference is capable of causing an outward pressure of 1.4 lb/in<sup>2</sup> on the walls and ceiling of the building."},label:!1},{type:"textbox",options:{text:"Calculate the force in pounds exerted on 1 square foot of a wall."},label:!0},{type:"textbox",options:{text:"Estimate the tons of force exerted on a wall that is 8 feet high and 40 feet wide."},label:!0}]}]},{title:"1.2 Exponents and Radicals",problems:[{num:3,video:"0eOEimfwMRw",text:"Express the number in the form <i>a</i>/<i>b</i>, where <i>a</i> and <i>b</i> are integers.",alignment:null,parts:[{type:"derivation",options:{eq:"2^-3/3^-2"},label:!1}]},{num:5,video:"c1TznaPYwdA",text:"Express the number in the form <i>a</i>/<i>b</i>, where <i>a</i> and <i>b</i> are integers.",alignment:null,parts:[{type:"derivation",options:{eq:"-2^4+3^-1"},label:!1}]},{num:7,video:"qrSUsQT0LgA",text:"Express the number in the form <i>a</i>/<i>b</i>, where <i>a</i> and <i>b</i> are integers.",alignment:null,parts:[{type:"derivation",options:{eq:"16^(-3/4)"},label:!1}]},{num:9,video:"OMCkg6DllNE",text:"Express the number in the form <i>a</i>/<i>b</i>, where <i>a</i> and <i>b</i> are integers.",alignment:null,parts:[{type:"derivation",options:{eq:"(-0.008)^(2/3)"},label:!1}]},{num:13,text:"Simplify.",alignment:null,parts:[{type:"derivation",options:{eq:"((2x^3)(3x^2))/(x^2)^3"},label:!1}]},{num:15,text:"Simplify.",alignment:null,parts:[{type:"derivation",options:{eq:"(1/6a^5)(-3a^2)(4a^7)"},label:!1}]},{num:21,text:"Simplify.",alignment:null,parts:[{type:"derivation",options:{eq:"(8x^4y^-3)(1/2x^-5y^2)"},label:!1}]},{num:25,text:"Simplify.",alignment:null,parts:[{type:"derivation",options:{eq:"(3y^3)^4(4y^2)^-3"},label:!1}]},{num:29,text:"Simplify.",alignment:null,parts:[{type:"derivation",options:{eq:"(5x^2y^-3)(4x^-5y^4)"},label:!1}]},{num:31,text:"Simplify.",alignment:null,parts:[{type:"derivation",options:{eq:"((3x^5y^4)/(x^0y^-3))^2"},label:!1}]},{num:35,text:"Simplify.",alignment:null,parts:[{type:"derivation",options:{eq:"(3x^(5/6))(8x^(2/3))"},label:!1}]},{num:39,text:"Simplify.",alignment:null,parts:[{type:"derivation",options:{eq:"(8x^(-2/3))x^(1/6)"},label:!1}]},{num:41,text:"Simplify.",alignment:null,parts:[{type:"derivation",options:{eq:"((-8x^3)/y^-6)^(2/3)"},label:!1}]},{num:43,text:"Simplify.",alignment:null,parts:[{type:"derivation",options:{eq:"(x^6/(9y^-4))^(-1/2)"},label:!1}]},{num:45,text:"Simplify.",alignment:null,parts:[{type:"derivation",options:{eq:"(x^6y^3)^(-1/3)/(x^4y^2)^(-1/2)"},label:!1}]},{num:49,text:"Rewrite the expression using rational exponents.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt[3]{(a+b)^2}"},label:!1}]},{num:51,text:"Rewrite the expression using rational exponents.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt{x^2+y^2}"},label:!1}]},{num:53,text:"Rewrite the expression using a radical.",alignment:"row",parts:[{type:"derivation",options:{eq:"4x^(2/3)"},label:!0},{type:"derivation",options:{eq:"(4x)^(3/2)"},label:!0}]},{num:55,text:"Rewrite the expression using a radical.",alignment:"row",parts:[{type:"derivation",options:{eq:"8-y^(1/3)"},label:!0},{type:"derivation",options:{eq:"(8-y)^(1/3)"},label:!0}]},{num:65,text:"Simplify the expression, and rationalize the denominator when appropriate.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt[3]{8a^6b^-3}"},label:!1}]},{num:67,text:"Simplify the expression, and rationalize the denominator when appropriate.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt{(3x)/(2y^3)}"},label:!1}]},{num:69,text:"Simplify the expression, and rationalize the denominator when appropriate.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt[3]{(2x^4y^4)/(9x)}"},label:!1}]},{num:71,text:"Simplify the expression, and rationalize the denominator when appropriate.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt[4]{(5x^8y^3)/(27x^2)}"},label:!1}]},{num:73,text:"Simplify the expression, and rationalize the denominator when appropriate.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt[5]{(5x^7y^2)/(8x^3)}"},label:!1}]},{num:77,text:"Simplify the expression, and rationalize the denominator when appropriate.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt[5]{(8x^3)/y^4}*sqrt[5]{(4x^4)/y^2}"},label:!1}]},{num:79,text:"Simplify the expression, and rationalize the denominator when appropriate.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt[3]{3t^4v^2}*sqrt[3]{-9t^-1v^4}"},label:!1}]},{num:81,text:"Simplify the expression, assuming <i>x</i> and <i>y</i> may be negative.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt{x^6y^4}"},label:!1}]},{num:83,text:"Simplify the expression, assuming <i>x</i> and <i>y</i> may be negative.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt[4]{x^8(y-1)^12}"},label:!1}]},{num:"85-93",text:"We're not yet supporting these problems. Please see p. 26 in the textbook.",alignment:null,parts:[]},{num:95,text:"Savings account",alignment:null,parts:[{type:"textbox",options:{text:"One of the oldest banks in the United States is the Bank of America, founded in 1812. If $200 had been deposited at that time into an account that paid 4% annual interest, then 180 years later the amount would have grown to 200(1.04)<sup>180</sup> dollars. Approximate this amount to the nearest cent."},label:!1}]},{num:"97-99",text:"We're not yet supporting this problem. Please see p. 26 in the textbook.",alignment:null,parts:[]}]},{title:"1.3 Algebraic Expressions",problems:[{num:3,text:"Express as a polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"(4x^3+5x-3)-(3x^3+2x^2+5x-7)"},label:!1}]},{num:9,text:"Express as a polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"(2u+3)(u-4)+4u(u-2)"},label:!1}]},{num:11,video:"pW8bpElusWc",text:"Express as a polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"(3x+5)(2x^2+9x-5)"},label:!1}]},{num:13,text:"Express as a polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"(t^2+2t-5)(3t^2-t+2)"},label:!1}]},{num:15,text:"Express as a polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"(x+1)(2x^2-2)(x^3+5)"},label:!1}]},{num:19,video:"PEx7hbOVD1g",text:"Express as a polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"(3u^3v^4-2u^5v^2+(u^2v^2)^2)/(u^3v^2)"},label:!1}]},{num:25,text:"Express as a polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"(x^2+9)(x^2-4)"},label:!1}]},{num:29,text:"Express as a polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"(x^2-3y^2)^2"},label:!1}]},{num:37,text:"Express as a polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"(x-2y)^3"},label:!1}]},{num:39,text:"Express as a polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"(2x+3y)^3"},label:!1}]},{num:43,text:"Express as a polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"(2x+y-3z)^2"},label:!1}]},{num:51,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"15x^3y^5-25x^4y^2+10x^6y^4"},label:!1}]},{num:57,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"6x^2+7x-20"},label:!1}]},{num:65,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"45x^2+38xy+8y^2"},label:!1}]},{num:69,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"z^4-64w^2"},label:!1}]},{num:73,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2+25"},label:!1}]},{num:77,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"64x^3+27"},label:!1}]},{num:79,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"64x^3-y^6"},label:!1}]},{num:81,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"343x^3+y^9"},label:!1}]},{num:83,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"125-27x^3"},label:!1}]},{num:85,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"2ax-6bx+ay-3by"},label:!1}]},{num:87,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"3x^3+3x^2-27x-27"},label:!1}]},{num:89,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"x^4+2x^3-x-2"},label:!1}]},{num:91,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"a^3-a^2b+ab^2-b^3"},label:!1}]},{num:93,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"a^6-b^6"},label:!1}]},{num:95,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2+4x+4-9y^2"},label:!1}]},{num:97,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"y^2-x^2+8y+16"},label:!1}]},{num:99,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"y^6+7y^3-8"},label:!1}]},{num:101,text:"Factor the polynomial.",alignment:null,parts:[{type:"derivation",options:{eq:"x^16-1"},label:!1}]}]},{title:"1.4 Fractional Expressions",problems:[{num:3,text:"Write the expression as a simplified rational number.",alignment:null,parts:[{type:"derivation",options:{eq:"5/24-3/20"},label:!1}]},{num:13,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"(5a^2+12a+4)/(a^4-16)/(25a^2+20a+4)/(a^2-2a)"},label:!1}]},{num:21,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"(3t)/(t+2)+(5t)/(t-2)-40/(t^2-4)"},label:!1}]},{num:25,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"(2x)/(x+2)-8/(x^2+2x)+3/x"},label:!1}]},{num:31,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"((2x+1)/(x^2+4x+4))-((6x)/(x^2-4))+3/(x-2)"},label:!1}]},{num:33,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"(b/a-a/b)/(1/a-1/b)"},label:!1}]},{num:35,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"(x/y^2-y/x^2)/(1/y^2-1/x^2)"},label:!1}]},{num:37,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"(y^-1+x^-1)/(xy)^-1"},label:!1}]},{num:39,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"(5/(x+1)+(2x)/(x+3))/(x/(x+1)+7/(x+3))"},label:!1}]},{num:41,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"(3/(x-1)-3/(a-1))/(x-a)"},label:!1}]},{num:43,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"((x+h)^2-3(x+h)-(x^2-3x))/h"},label:!1}]},{num:45,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"(1/(x+h)^3-1/x^3)/h"},label:!1}]},{num:47,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"(4/(3x+3h-1)-4/(3x-1))/h"},label:!1}]},{num:51,text:"Rationalize the denominator.",alignment:null,parts:[{type:"derivation",options:{eq:"(81x^2-16y^2)/(3sqrtx-2sqrty)"},label:!1}]},{num:55,text:"Rationalize the numerator.",alignment:null,parts:[{type:"derivation",options:{eq:"(sqrta-sqrtb)/(a^2-b^2)"},label:!1}]},{num:57,text:"Rationalize the numerator.",alignment:null,parts:[{type:"derivation",options:{eq:"(sqrt{2(x+h)+1}-sqrt{2x+1})/h"},label:!1}]},{num:63,text:"Express as a sum of terms of the form <i>ax<sup>r</sup></i>, where <i>r</i> is a rational number.",alignment:null,parts:[{type:"derivation",options:{eq:"(x^2+2)^2/x^5"},label:!1}]},{num:67,text:"Express as a quotient.",alignment:null,parts:[{type:"derivation",options:{eq:"x^(-1/2)-x^(3/2)"},label:!1}]},{num:69,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"(2x^2-3x+1)(4)(3x+2)^3(3)+(3x+2)^4(4x-3)"},label:!1}]},{num:71,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"(x^2-4)^(1/2)(3)(2x+1)^2(2)+(2x+1)^3(1/2)(x^2-4)^(-1/2)(2x)"},label:!1}]},{num:73,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"(3x+1)^6(1/2)(2x-5)^(-1/2)(2)+(2x-5)^(1/2)(6)(3x+1)^5(3)"},label:!1}]},{num:75,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"((6x+1)^3(27x^2+2)-(9x^3+2x)(3)(6x+1)^2(6))/(6x+1)^6"},label:!1}]},{num:77,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"((x^2+2)^3(2x)-x^2(3)(x^2+2)^2(2x))/[(x^2+2)^3]^2"},label:!1}]},{num:79,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"((x^2+4)^(1/3)(3)-(3x)(1/3)(x^2+4)^(-2/3)(2x))/[(x^2+4)^(1/3)]^2"},label:!1}]},{num:81,text:"Simplify the expression.",alignment:null,parts:[{type:"derivation",options:{eq:"((4x^2+9)^(1/2)(2)-(2x+3)(1/2)(4x^2+9)^(-1/2)(8x))/[(4x^2+9)^(1/2)]^2"},label:!1}]}]}]},{title:"Chapter 2 Equations and Inequalities",subchapters:[{title:"2.1 Equations",problems:[{num:7,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"1/5x+2=3-2/7x"},label:!1}]},{num:9,video:"EVOrKJinJcI",text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"0.3(3+2x)+1.2x=3.2"},label:!1}]},{num:13,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"(13+2x)/(4x+1)=3/4"},label:!1}]},{num:15,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"8-5/x=2+3/x"},label:!1}]},{num:17,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"(3x-2)^2=(x-5)(9x+4)"},label:!1}]},{num:21,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"(3x+1)/(6x-2)=(2x+5)/(4x-13)"},label:!1}]},{num:23,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"2/5+4/(10x+5)=7/(2x+1)"},label:!1}]},{num:27,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"2-5/(3x-7)=2"},label:!1}]},{num:31,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"7/(y^2-4)-4/(y+2)=5/(y-2)"},label:!1}]},{num:33,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"(x+3)^3-(3x-1)^2=x^3+4"},label:!1}]},{num:35,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"(9x)/(3x-1)=2+3/(3x-1)"},label:!1}]},{num:37,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"1/(x+4)+3/(x-4)=(3x+8)/(x^2-16)"},label:!1}]},{num:39,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"4/(x+2)+1/(x-2)=(5x-6)/(x^2-4)"},label:!1}]},{num:41,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"2/(2x+1)-3/(2x-1)=(-2x+7)/(4x^2-1)"},label:!1}]},{num:43,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"5/(2x+3)+4/(2x-3)=(14x+3)/(4x^2-9)"},label:!1}]},{num:51,text:"For what value of <i>c</i> is the number <i>a</i> a solution of the equation?",alignment:null,parts:[{type:"derivation",options:{eq:"4x+1+2c=5c-3x+6"},label:!1},{type:"derivation",options:{eq:"a=-2"},label:!1}]},{num:55,text:"Determine values for <i>a</i> and <i>b</i> such that <sup>5</sup>&frasl;<sub>3</sub> is a solution of the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"ax+b=0"},label:!1}]},{num:57,text:"Determine which equation is not equivalent to the equation preceding it.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2-x-2=x^2-4"},label:!1},{type:"derivation",options:{eq:"(x+1)(x-2)=(x+2)(x-2)"},label:!1},{type:"derivation",options:{eq:"x+1=x+2"},label:!1},{type:"derivation",options:{eq:"1=2"},label:!1}]},{num:59,text:"Solve the formula for the specified variable.",alignment:"row",parts:[{type:"derivation",options:{eq:"EK+L=D-TK"},label:!1},{type:"textbox",options:{text:"for <i>K</i>"},label:!1}]},{num:61,text:"Solve the formula for the specified variable.",alignment:"row",parts:[{type:"derivation",options:{eq:"M=(Q+1)/Q"},label:!1},{type:"textbox",options:{text:"for <i>Q</i>"},label:!1}]},{num:67,text:"The formula occurs in the indicated application. Solve for the specified variable.",alignment:"row",parts:[{type:"derivation",options:{eq:"F=g(mM)/d^2"},label:!1},{type:"textbox",options:{text:"for <i>m</i> (Newton's law of gravitation)"},label:!1}]},{num:69,text:"The formula occurs in the indicated application. Solve for the specified variable.",alignment:"row",parts:[{type:"derivation",options:{eq:"P=2l+2w"},label:!1},{type:"textbox",options:{text:"for <i>w</i> (perimeter of a rectangle)"},label:!1}]},{num:71,text:"The formula occurs in the indicated application. Solve for the specified variable.",alignment:"row",parts:[{type:"derivation",options:{eq:"A=1/2(b_1+b_2)h"},label:!1},{type:"textbox",options:{text:"for <i>b</i><sub>1</sub> (area of a trapezoid)"},label:!1}]},{num:73,text:"The formula occurs in the indicated application. Solve for the specified variable.",alignment:"row",parts:[{type:"derivation",options:{eq:"S=p/(q+p(1-q))"},label:!1},{type:"textbox",options:{text:"for <i>q</i> (Amdahl's law for supercomputers)"},label:!1}]},{num:75,text:"The formula occurs in the indicated application. Solve for the specified variable.",alignment:"row",parts:[{type:"derivation",options:{eq:"1/f=1/p+1/q"},label:!1},{type:"textbox",options:{text:"for <i>q</i> (lens equation)"},label:!1}]}]},{title:"2.2 Applied Problems",problems:[{num:1,text:"Test scores",alignment:null,parts:[{type:"textbox",options:{text:"A student in an algebra course has test scores of 75, 82, 71, and 84. What score on the next test will raise the student's average to 80?"},label:!1}]},{num:2,text:"Final class average",alignment:null,parts:[{type:"textbox",options:{text:"Before the final exam, a student has test scores of 72, 80, 65, 78, and 60. If the final exam counts as one-third of the final grade, what score must the student receive in order to have a final average of 76?"},label:!1}]},{num:3,text:"Gross pay",alignment:null,parts:[{type:"textbox",options:{text:"A worker’s take-home pay is $492, after deductions totaling 40% of the gross pay have been subtracted. What is the gross pay?"},label:!1}]},{num:4,text:"Cost of dining out",alignment:null,parts:[{type:"textbox",options:{text:"A couple does not wish to spend more than $70 for dinner at a restaurant. If a sales tax of 6% is added to the bill and they plan to tip 15% after the tax has been added, what is the most they can spend for the meal?"},label:!1}]},{num:5,text:"Intelligence quotient",alignment:"column",parts:[{type:"textbox",options:{text:"A person's intelligence quotient (IQ) is determined by multiplying the quotient of his or her mental age and chonological age by 100."},label:!1},{type:"textbox",options:{text:"Find the IQ of a 12-year-old child whose mental age is 15."},label:!0},{type:"textbox",options:{text:"Find the mental age of a person 15 years old whose IQ is 140."},label:!0}]},{num:7,text:"Cost of insulation",alignment:null,parts:[{type:"textbox",options:{text:"The cost of installing insulation in a particular two-bedroom home is $2400. Present monthly heating costs average $200, but the insulation is expected to reduce heating costs by 10%. How many months will it take to recover the cost of the insulation?"},label:!1}]},{num:9,text:"Savings accounts",alignment:null,parts:[{type:"textbox",options:{text:"An algebra student has won $100,000 in a lottery and wishes to deposit it in savings accounts in two financial institutions. One account pays 8% simple interest, but deposits are insured only to $50,000. The second account pays 6.4% simple interest, and deposits are insured up to $100,000. Determine whether the money can be deposited so that it is fully insured and earns annual interest of $7500."},label:!1}]},{num:11,text:"Movie attendance",alignment:null,parts:[{type:"textbox",options:{text:"Six hundred people attended the premiere of a motion picture. Adult tickets cost $9, and children were admitted for $6. If box office receipts totaled $4800, how many children attended the premiere?"},label:!1}]},{num:13,text:"Preparing a glucose solution",alignment:null,parts:[{type:"textbox",options:{text:"In a certain medical test designed to measure carbohydrate tolerance, an adult drinks 7 ounces of a 30% glucose solution. When the test is administered to a child, the glucose concentration must be decreased to 20%. How much 30% glucose solution and how much water should be used to prepare 7 ounces of 20% glucose solution?"},label:!1}]},{num:15,text:"Preparing an alloy",alignment:null,parts:[{type:"textbox",options:{text:"British sterling silver is a copper-silver alloy that is 7.5% copper by weight. How many grams of pure copper and how many grams of British sterling silver should be used to prepare 200 grams of a copper-silver alloy that is 10% copper by weight?"},label:!1}]},{num:17,text:"Walking rates",alignment:"column",parts:[{type:"textbox",options:{text:"Two children, who are 224 meters apart, start walking toward each other at the same instant at rates of 1.5 m/sec and 2 m/sec, respectively (see the figure on p. 71)."},label:!1},{type:"textbox",options:{text:"When will they meet?"},label:!0},{type:"textbox",options:{text:"How far will each have walked?"},label:!0}]},{num:19,text:"Snowplow speed",alignment:null,parts:[{type:"textbox",options:{text:"At 6 A.M. a snowplow, traveling at a constant speed, begins to clear a highway leading out of town. At 8 A.M. an automobile begins traveling the highway at a speed of 30 and reaches the plow 30 minutes later. Find the speed of the snowplow."},label:!1}]},{num:21,text:"Rowing rate",alignment:"column",parts:[{type:"textbox",options:{text:"A boy can row a boat at a constant rate of 5 mi/hr in still water, as indicated in the figure (p. 71). He rows upstream for 15 minutes and then rows downstream, returning to his starting point in another 12 minutes."},label:!1},{type:"textbox",options:{text:"Find the rate of the current."},label:!0},{type:"textbox",options:{text:"Find the total distance traveled."},label:!0}]},{num:23,text:"Distance to a target",alignment:null,parts:[{type:"textbox",options:{text:"A bullet is fired horizontally at a target, and the sound of its impact is heard 1.5 seconds later. If the speed of the bullet is 3300 ft/sec and the speed of sound is 1100 ft/sec, how far away is the target?"},label:!1}]},{num:25,text:"Fencing a region",alignment:null,parts:[{type:"textbox",options:{text:"A farmer plans to use 180 feet of fencing to enclose a rectangular region, using part of a straight river bank instead of fencing as one side of the rectangle, as shown in the figure on the next page (p. 72). Find the area of the region if the length of the side parallel to the river bank is"},label:!1},{type:"textbox",options:{text:"twice the length of an adjacent side."},label:!0},{type:"textbox",options:{text:"one-half the length of an adjacent side."},label:!0},{type:"textbox",options:{text:"the same as the length of an adjacent side."},label:!0}]},{num:29,text:"Constructing a silo",alignment:null,parts:[{type:"textbox",options:{text:"A large grain silo is to be constructed in the shape of a circular cylinder with a hemisphere attached to the top (see the figure on p. 72). The diameter of the silo is to be 30 feet, but the height is yet to be determined. Find the height <i>h</i> of the silo that will result in a capacity of 11,250<i>π</i> ft<sup>3</i>."},label:!1}]},{num:31,text:"Lawn mowing rates",alignment:null,parts:[{type:"textbox",options:{text:"It takes a boy 90 minutes to mow the lawn, but his sister can mow it in 60 minutes. How long would it take them to mow the lawn if they worked together, using two lawn mowers?"},label:!1}]},{num:33,text:"Delivering newspapers",alignment:null,parts:[{type:"textbox",options:{text:"It takes a girl 45 minutes to deliver the newspapers on her route; however, if her brother helps, it takes them only 20 minutes. How long would it take her brother to deliver the newspapers by himself?"},label:!1}]},{num:35,text:"Grade point average (GPA)",alignment:null,parts:[{type:"textbox",options:{text:"A college student has finished 48 credit hours with a GPA of 2.75. To get into the program she wishes to enter, she must have a GPA of 3.2. How many additional credit hours of 4.0 work will raise her GPA to 3.2?"},label:!1}]},{num:37,text:"Air temperature",alignment:"column",parts:[{type:"textbox",options:{text:"Below the cloud base, the air temperature <i>T</i> (in °F) at height <i>h</i> (in feet) can be approximated by the equation <i>T</i> = <i>T</i><sub>0</sub> - (<sup>5.5</sup>&frasl;<sub>1000</sub>)<i>h</i>, where <i>T</i><sub>0</sub> is the temperature at ground level."},label:!1},{type:"textbox",options:{text:"Determine the air temperature at a height of 1 mile if the ground temperature is 70°F."},label:!0},{type:"textbox",options:{text:"At what altitude is the temperature freezing?"},label:!0}]},{num:39,text:"A cloud's temperature",alignment:null,parts:[{type:"textbox",options:{text:"The temperature <i>T</i> within a cloud at height <i>h</i> (in feet) above the cloud base can be approximated using the equation <i>T</i> = <i>B</i> - (<sup>3</sup>&frasl;<sub>1000</sub>)<i>h</i>, where <i>B</i> is the temperature of the cloud at its base. Determine the temperature at 10,000 feet in a cloud with a base temperature of 55°F and a base height of 4000 feet. <b>Note:</b> For an interesting application involving the three preceding exercises, see Exercise 6 in the Discussion Exercises at the end of the chapter."},label:!1}]}]},{title:"2.3 Quadratic Equations",problems:[{num:9,text:"Solve the equation by factoring.",alignment:null,parts:[{type:"derivation",options:{eq:"12x^2+60x+75=0"},label:!1}]},{num:13,text:"Solve the equation by factoring.",alignment:null,parts:[{type:"derivation",options:{eq:"(5x)/(x-3)+4/(x+3)=90/(x^2-9)"},label:!1}]},{num:15,text:"Determine whether the two equations are equivalent.",alignment:"row",parts:[{type:"derivation",options:{eq:"x^2=16"},label:!0},{type:"derivation",options:{eq:"x=4"},label:!1},{type:"derivation",options:{eq:"x=sqrt9"},label:!0},{type:"derivation",options:{eq:"x=3"},label:!1}]},{num:21,text:"Solve the equation by using the special quadratic equation on page 75.",alignment:null,parts:[{type:"derivation",options:{eq:"(x-3)^2=17"},label:!1}]},{num:23,text:"Solve the equation by using the special quadratic equation on page 75.",alignment:null,parts:[{type:"derivation",options:{eq:"4(x+2)^2=11"},label:!1}]},{num:25,text:"Determine the value or values of <i>d</i> that complete the square for the expression.",alignment:"column",parts:[{type:"derivation",options:{eq:"x^2+9x+d"},label:!0},{type:"derivation",options:{eq:"x^2-8x+d"},label:!0},{type:"derivation",options:{eq:"x^2+dx+36"},label:!0},{type:"derivation",options:{eq:"x^2+dx+49/4"},label:!0}]},{num:29,text:"Solve by completing the square. (<i>Note:</i> See the discussion after Example 5 for help in solving Exercises 29 and 30.)",alignment:null,parts:[{type:"derivation",options:{eq:"4x^2-12x-11=0"},label:!1}]},{num:37,text:"Solve by using the quadratic formula.",alignment:null,parts:[{type:"derivation",options:{eq:"3/2z^2-4z-1=0"},label:!1}]},{num:39,text:"Solve by using the quadratic formula.",alignment:null,parts:[{type:"derivation",options:{eq:"5/(w^2)-10/w+2=0"},label:!1}]},{num:41,text:"Solve by using the quadratic formula.",alignment:null,parts:[{type:"derivation",options:{eq:"4x^2+81=36x"},label:!1}]},{num:43,text:"Solve by using the quadratic formula.",alignment:null,parts:[{type:"derivation",options:{eq:"(5x)/(x^2+9)=-1"},label:!1}]},{num:45,text:"Use the quadratic formula to factor the expressions.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2+x-30"},label:!1}]},{num:47,text:"Use the quadratic formula to factor the expressions.",alignment:null,parts:[{type:"derivation",options:{eq:"12x^2-16x-3"},label:!1}]},{num:49,text:"Use the quadratic formula to solve the equation for (a) <i>x</i> in terms of <i>y</i> and (b) <i>y</i> in terms of <i>x</i>.",alignment:null,parts:[{type:"derivation",options:{eq:"4x^2-4xy+1-y^2=0"},label:!1}]},{num:51,text:"Solve for the specified variable.",alignment:"row",parts:[{type:"derivation",options:{eq:"K=1/2mv^2"},label:!1},{type:"textbox",options:{text:"for <i>v</i> (kinetic energy)"},label:!1}]},{num:53,text:"Solve for the specified variable.",alignment:"row",parts:[{type:"derivation",options:{eq:"A=2πr(r+h)"},label:!1},{type:"textbox",options:{text:"for <i>r</i> (surface area of a closed cylinder)"},label:!1}]},{num:59,text:"Baseball toss",alignment:null,parts:[{type:"textbox",options:{text:"A baseball is thrown straight upward with an initial speed of 64 ft/sec. The number of feet <i>s</i> above the ground after <i>t</i> seconds is given by the equation <i>s</i> = -16<i>t</i><sup>2</sup> + 64<i>t</i>."},label:!1},{type:"textbox",options:{text:"When will the baseball be 48 feet above the ground?"},label:!0},{type:"textbox",options:{text:"When will it hit the ground?"},label:!0}]},{num:60,text:"Breaking distance",alignment:"column",parts:[{type:"textbox",options:{text:"The distance that a car travels between the time the driver makes the decision to hit the brakes and the time the car actually stops is called the braking distance. For a certain car traveling <i>v</i> mi/hr, the braking distance <i>d</i> (in feet) is given by <i>d</i> = <i>v</i> + (<i>v</i><sup>2</sup>/20)."},label:!1},{type:"textbox",options:{text:"Find the braking distance when <i>v</i> is 55 mi/hr."},label:!0},{type:"textbox",options:{text:"If a driver decides to brake 120 feet from a stop sign, how fast can the car be going and still stop by the time it reaches the sign?"},label:!0}]},{num:65,text:"Fencing a garden",alignment:null,parts:[{type:"textbox",options:{text:"A square vegetable garden is to be tilled and then enclosed with a fence. If the fence costs $1 per foot and the cost of preparing the soil is $0.50 per ft<sup>2</sup>, determine the size of the garden that can be enclosed for $120."},label:!1}]},{num:66,text:"Fencing a region",alignment:null,parts:[{type:"textbox",options:{text:"A farmer plans to enclose a rectangular region, using part of his barn for one side and fencing for the other three sides. If the side parallel to the barn is to be twice the length of an adjacent side, and the area of the region is to be 128 ft<sup>2</sup>, how many feet of fencing should be purchased?"},label:!1}]},{num:69,text:"Distance between airplanes",alignment:"column",parts:[{type:"textbox",options:{text:"An airplane flying north at 200 mi/hr passed over a point on the ground at 2:00 P.M. Another airplane at the same altitude passed over the point at 2:30 P.M., flying east at 400 mi/hr (see the figure on p. 86)."},label:!1},{type:"textbox",options:{text:"If <i>t</i> denotes the time in hours after 2:30 P.M., express the distance <i>d</i> between the airplanes in terms of <i>t</i>."},label:!0},{type:"textbox",options:{text:"At what time after 2:30 P.M. were the airplanes 500 miles apart?"},label:!0}]},{num:70,text:"Two-way radio range",alignment:null,parts:[{type:"textbox",options:{text:"Two surveyors with two-way radios leave the same point at 9:00 A.M., one walking due south at 4 mi/hr and the other due west at 3 mi/hr. How long can they communicate with one another if each radio has a maximum range of 2 miles?"},label:!1}]},{num:71,text:"Constructing a pizza box",alignment:null,parts:[{type:"textbox",options:{text:"A pizza box with a square base is to be made from a rectangular sheet of cardboard by cutting six 1-inch squares from the corners and the middle sections and folding up the sides (see the figure on p. 86). If the area of the base is to be 144 in<sup>2</sup>, what size piece of cardboard should be used?"},label:!1}]}]},{title:"2.4 Complex Numbers",problems:[{num:3,text:"Write the expression in the form <i>a</i> + <i>bi</i>, where <i>a</i> and <i>b</i> are real numbers.",alignment:null,parts:[{type:"derivation",options:{eq:"(7-6i)-(-11-3i)"},label:!1}]},{num:7,text:"Write the expression in the form <i>a</i> + <i>bi</i>, where <i>a</i> and <i>b</i> are real numbers.",alignment:null,parts:[{type:"derivation",options:{eq:"(1-3i)(2+5i)"},label:!1}]},{num:9,text:"Write the expression in the form <i>a</i> + <i>bi</i>, where <i>a</i> and <i>b</i> are real numbers.",alignment:null,parts:[{type:"derivation",options:{eq:"(5-2i)^2"},label:!1}]},{num:17,text:"Write the expression in the form <i>a</i> + <i>bi</i>, where <i>a</i> and <i>b</i> are real numbers.",alignment:"row",parts:[{type:"derivation",options:{eq:"i^73"},label:!0},{type:"derivation",options:{eq:"i^-46"},label:!0},{type:"derivation",options:{eq:"i^66"},label:!0},{type:"derivation",options:{eq:"i^-55"},label:!0}]},{num:19,text:"Write the expression in the form <i>a</i> + <i>bi</i>, where <i>a</i> and <i>b</i> are real numbers.",alignment:null,parts:[{type:"derivation",options:{eq:"3/(2+4i)"},label:!1}]},{num:21,text:"Write the expression in the form <i>a</i> + <i>bi</i>, where <i>a</i> and <i>b</i> are real numbers.",alignment:null,parts:[{type:"derivation",options:{eq:"(1-7i)/(6-2i)"},label:!1}]},{num:23,text:"Write the expression in the form <i>a</i> + <i>bi</i>, where <i>a</i> and <i>b</i> are real numbers.",alignment:null,parts:[{type:"derivation",options:{eq:"(-4+6i)/(2+7i)"},label:!1}]},{num:25,text:"Write the expression in the form <i>a</i> + <i>bi</i>, where <i>a</i> and <i>b</i> are real numbers.",alignment:null,parts:[{type:"derivation",options:{eq:"(4-2i)/(-5i)"},label:!1}]},{num:27,text:"Write the expression in the form <i>a</i> + <i>bi</i>, where <i>a</i> and <i>b</i> are real numbers.",alignment:null,parts:[{type:"derivation",options:{eq:"(2+5i)^3"},label:!1}]},{num:29,text:"Write the expression in the form <i>a</i> + <i>bi</i>, where <i>a</i> and <i>b</i> are real numbers.",alignment:null,parts:[{type:"derivation",options:{eq:"(2-sqrt-4)(3-sqrt-16)"},label:!1}]},{num:31,text:"Write the expression in the form <i>a</i> + <i>bi</i>, where <i>a</i> and <i>b</i> are real numbers.",alignment:null,parts:[{type:"derivation",options:{eq:"(4+sqrt-81)/(7-sqrt-64)"},label:!1}]},{num:35,text:"Find the values of <i>x</i> and <i>y</i>, where <i>x</i> and <i>y</i> are real numbers.",alignment:null,parts:[{type:"derivation",options:{eq:"4+(x+2y)i=x+2i"},label:!1}]},{num:37,text:"Find the values of <i>x</i> and <i>y</i>, where <i>x</i> and <i>y</i> are real numbers.",alignment:null,parts:[{type:"derivation",options:{eq:"(2x-y)-16i=10+4yi"},label:!1}]},{num:39,text:"Find the solutions of the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2-6x+13=0"},label:!1}]},{num:41,text:"Find the solutions of the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2+4x+13=0"},label:!1}]},{num:43,text:"Find the solutions of the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2-5x+20=0"},label:!1}]},{num:45,text:"Find the solutions of the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"4x^2+x+3=0"},label:!1}]},{num:47,text:"Find the solutions of the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"x^3+125=0"},label:!1}]},{num:48,text:"Find the solutions of the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"x^3-27=0"},label:!1}]},{num:49,text:"Find the solutions of the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"27x^3=(x+5)^3"},label:!1}]},{num:50,text:"Find the solutions of the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"16x^4=(x-4)^4"},label:!1}]},{num:51,text:"Find the solutions of the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"x^4=256"},label:!1}]},{num:53,text:"Find the solutions of the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"4x^4+25x^2+36=0"},label:!1}]},{num:54,text:"Find the solutions of the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"27x^4+21x^2+4=0"},label:!1}]},{num:55,text:"Find the solutions of the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"x^3+3x^2+4x=0"},label:!1}]},{num:57,text:"This problem is currently unavailable. Please see p. 94 in the textbook.",alignment:null,parts:[]}]},{title:"2.5 Other Types of Equations",problems:[{num:3,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"|3x-2|+3=7"},label:!1}]},{num:5,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"3*|x+1|-2=-11"},label:!1}]},{num:8,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"3x^3-4x^2-27x+36=0"},label:!1}]},{num:9,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"4x^4+10x^3=6x^2+15x"},label:!1}]},{num:11,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"y^(3/2)=5y"},label:!1}]},{num:17,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt[5]{2x^2+1}-2=0"},label:!1}]},{num:19,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt{7-x}=x-5"},label:!1}]},{num:21,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"3sqrt{2x-3}+2sqrt{7-x}=11"},label:!1}]},{num:23,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"x=4+sqrt{4x-19}"},label:!1}]},{num:25,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"x+sqrt{5x+19}=-1"},label:!1}]},{num:27,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt{7-2x}-sqrt{5+x}=sqrt{4+3x}"},label:!1}]},{num:29,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt{11+8x}+1=sqrt{9+4x}"},label:!1}]},{num:33,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"sqrt{1+4sqrtx}=sqrtx+1"},label:!1}]},{num:37,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"5y^4-7y^2+1=0"},label:!1}]},{num:39,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"36x^-4-13x^-2+1=0"},label:!1}]},{num:41,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"3x^(2/3)+4x^(1/3)-4=0"},label:!1}]},{num:43,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"6w+7w^(1/2)-20=0"},label:!1}]},{num:44,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"8t-22t^(1/2)-21=0"},label:!1}]},{num:45,text:"Solve the equation.",alignment:null,parts:[{type:"derivation",options:{eq:"2x^(-2/3)-7x^(-1/3)-15=0"},label:!1}]},{num:49,text:"Solve the equation.",alignment:"row",parts:[{type:"derivation",options:{eq:"sqrt[3]{x}=2sqrt[4]{x}"},label:!1},{type:"textbox",options:{text:"(<i>Hint:</i> Raise both sides to the least common multiple of 3 and 4.)"},label:!1}]},{num:51,text:"Find the real solutions of the equation.",alignment:"column",parts:[{type:"derivation",options:{eq:"x^(5/3)=32"},label:!0},{type:"derivation",options:{eq:"x^(4/3)=16"},label:!0},{type:"derivation",options:{eq:"x^(2/3)=-36"},label:!0},{type:"derivation",options:{eq:"x^(3/4)=125"},label:!0},{type:"derivation",options:{eq:"x^(3/2)=-27"},label:!0}]},{num:53,text:"Solve for the specified variable.",alignment:"row",parts:[{type:"derivation",options:{eq:"T=2πsqrt{l/g}"},label:!1},{type:"textbox",options:{text:"for <i>l</i> (period of a pendulum)"},label:!1}]},{num:55,text:"Solve for the specified variable.",alignment:"row",parts:[{type:"derivation",options:{eq:"S=πrsqrt{r^2+h^2}"},label:!1},{type:"textbox",options:{text:"for <i>h</i> (surface area of a cone)"},label:!1}]},{num:57,text:"Ladder height",alignment:null,parts:[{type:"textbox",options:{text:"The recommended distance <i>d</i> that a ladder should be placed away from a vertical wall is 25% of its length <i>L</i>. Approximate the height <i>h</i> that can be reached by relating <i>h</i> as a percentage of <i>L</i> (see figure on p. 101)."},label:!1}]},{num:59,text:"Windmill power",alignment:null,parts:[{type:"textbox",options:{text:"The power <i>P</i> (in watts) generated by a windmill that has efficiency <i>E</i> is given by the formula <i>P</i> = 0.31<i>ED</i><sup>2</sup><i>V</i><sup>3</sup>, where <i>D</i> is the diameter (in feet) of the windmill blades and <i>V</i> is the wind velocity (in ft/sec). Approximate the wind velocity necessary to generate 10,000 watts if <i>E</i> = 42% and <i>D</i> = 10."},label:!1}]},{num:61,text:"The effect of price on demand",alignment:null,parts:[{type:"textbox",options:{text:"The demand for a commodity usually depends on its price. If other factors do not affect the demand, then the quantity <i>Q</i> purchased at price <i>P</i> (in cents) is given by <i>Q</i> = <i>kP</i><sup>-<i>c</i></sup>, where <i>k</i> and <i>c</i> are positive constants. If <i>k</i> = 10<sup>5</sup> and <i>c</i> = <sup>1</sup>&frasl;<sub>2</sub>, find the price that will result in the purchase of 5000 items."},label:!1}]},{num:62,text:"The urban heat island",alignment:null,parts:[{type:"textbox",options:{text:"Urban areas have higher average air temperatures than rural areas, as a result of the presence of buildings, asphalt, and concrete. This phenomenon has become known as the <i>urban heat island</i>. The temperature difference <i>T</i> (in °C) between urban and rural areas near Montreal, with a population <i>P</i> between 1000 and 1,000,000, can be described the by the formula <i>T</i> = 0.25<i>P</i><sup><sup>1</sup>&frasl;<sub>4</sub></sup>/√<i>v</i>, where <i>v</i> is the average wind speed (in mi/hr) and <i>v</i> ≥ 1. If <i>T</i> = 3 and <i>v</i> = 5, find <i>P</i>."},label:!1}]},{num:67,text:"Installing a power line",alignment:null,parts:[{type:"textbox",options:{text:"A power line is to be installed across a river that is 1 mile wide to a town that is 5 miles downstream (see the figure on p. 102). It costs $7500 per mile to lay the cable underwater and $6000 per mile to lay it overland. Determine how the cable should be installed if $35,000 has been allocated for this project."},label:!1}]}]},{title:"2.6 Inequalities",problems:[{num:3,text:"Express the inequality as an interval, and sketch its graph.",alignment:null,parts:[{type:"derivation",options:{eq:"x<-2"},label:!1}]},{num:5,text:"Express the inequality as an interval, and sketch its graph.",alignment:null,parts:[{type:"derivation",options:{eq:"x≥4"},label:!1}]},{num:"7-19",text:"We're not yet supporting these problems. Please see pp. 109 and 110 in the textbook.",alignment:null,parts:[]},{num:27,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"9+1/3x≥4-1/2x"},label:!1}]},{num:"31-35",text:"We're not yet supporting these problems. Please see p. 110 in the textbook.",alignment:null,parts:[]},{num:39,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"(x-4)^2>x(x+12)"},label:!1}]},{num:41,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"4/(3x+2)≥0"},label:!1}]},{num:43,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"-2/(4-3x)>0"},label:!1}]},{num:45,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"2/((1-x)^2)>0"},label:!1}]},{num:47,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"|x|<3"},label:!1}]},{num:49,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"|x|≥5"},label:!1}]},{num:53,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"|x+2|+0.1≥0.2"},label:!1}]},{num:57,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"-1/3*|6-5x|+2≥1"},label:!1}]},{num:59,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"|7x+2|>-2"},label:!1}]},{num:63,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"|(2-3x)/5|≥2"},label:!1}]},{num:65,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"3/|5-2x|<2"},label:!1}]},{num:"67-77",text:"We're not yet supporting these problems. Please see p. 110 in the textbook.",alignment:null,parts:[]},{num:80,text:"Electrical resistance",alignment:null,parts:[{type:"textbox",options:{text:"If two resistors <i>R</i><sub>1</sub> and <i>R</i><sub>2</sub> are connected in parallel in an electrical circuit, the net resistance <i>R</i> is given by<p style='text-align:center; margin: 10px;'><sup>1</sup>&frasl;<sub><i>R</i></sub> = <sup>1</sup>&frasl;<sub><i>R</i><sub>1</sub></sub> + <sup>1</sup>&frasl;<sub><i>R</i><sub>2</sub></sub>.</p>If <i>R</i><sub>1</sub> = 10 ohms, what values of <i>R</i><sub>2</sub> will result in a net resistance of less than 5 ohms?"},label:!1}]},{num:85,text:"Decreasing height",alignment:"column",parts:[{type:"textbox",options:{text:"A person's height will typically decrease by 0.024 inch each year after age 30."},label:!1},{type:"textbox",options:{text:"If a woman was 5 feet 9 inches tall at age 30, predict her height at age 70."},label:!0},{type:"textbox",options:{text:"A 50-year-old man is 5 feet 6 inches tall. Determine an inequality for the range of heights (in inches) that this man will experience between the ages of 30 and 70."},label:!0}]}]},{title:"2.7 More on Inequalities",problems:[{num:7,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2-2x-5>3"},label:!1}]},{num:9,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"x(2x+3)≥5"},label:!1}]},{num:11,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"6x-8>x^2"},label:!1}]},{num:17,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"16x^2≥9x"},label:!1}]},{num:19,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"x^4+5x^2≥36"},label:!1}]},{num:21,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"x^3+2x^2-4x-8≥0"},label:!1}]},{num:23,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"(x^2(x+2))/((x+2)(x+1))≤0"},label:!1}]},{num:25,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"(x^2-x)/(x^2+2x)≤0"},label:!1}]},{num:27,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"(x-2)/(x^2-3x-10)≥0"},label:!1}]},{num:29,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"(-3x)/(x^2-9)>0"},label:!1}]},{num:31,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"(x+1)/(2x-3)>2"},label:!1}]},{num:33,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"1/(x-2)≥3/(x+1)"},label:!1}]},{num:35,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"4/(3x-2)≤2/(x+1)"},label:!1}]},{num:37,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"x/(3x-5)≤2/(x-1)"},label:!1}]},{num:39,text:"Solve the inequality, and express the solutions in terms of intervals whenever possible.",alignment:null,parts:[{type:"derivation",options:{eq:"x^3>x"},label:!1}]},{num:41,text:"As a particle moves along a straight path, its speed <i>v</i> (in cm/sec) at time <i>t</i> (in seconds) is given by the equation. For what subintervals of the given time interval [<i>a</i>, <i>b</i>] will its speed be at least <i>k</i> cm/sec?",alignment:"row",parts:[{type:"derivation",options:{eq:"v=t^3-3t^2-4t+20"},label:!1},{type:"derivation",options:{eq:"[0,5]"},label:!1},{type:"derivation",options:{eq:"k=8"},label:!1}]},{num:43,text:"Vertical leap record",alignment:null,parts:[{type:"textbox",options:{text:"<i>Guinness Book of World Records</i> reports that German shepherds can make vertical leaps of over 10 feet when scaling walls. If the distance <i>s</i> (in feet) off the ground after <i>t</i> seconds is given by the equation <i>s</i> = -16<i>t</i><sup>2</sup> + 24<i>t</i> + 1, for how many seconds is the dog more than 9 feet off the ground?"},label:!1}]},{num:44,text:"Height of a projected object",alignment:null,parts:[{type:"textbox",options:{text:"If an object is projected vertically upward from ground level with an initial velocity of 320 ft/sec, then its distance <i>s</i> above the ground after <i>t</i> seconds is given by <i>s</i> = -16<i>t</i><sup>2</sup> + 320<i>t</i>. For what values of <i>t</i> will the object be more than 1536 feet above the ground?"},label:!1}]},{num:45,text:"Braking distance",alignment:null,parts:[{type:"textbox",options:{text:"The braking distance <i>d</i> (in feet) of a certain car traveling <i>v</i> mi/hr is given by the equation <i>d</i> = <i>v</i> + (<i>v</i><sup>2</sup>/20). Determine the velocities that result in braking distances of less than 75 feet."},label:!1}]},{num:49,text:"Weight in space",alignment:null,parts:[{type:"textbox",options:{text:"After an astronaut is launched into space, the astronaut's weight decreases until a state of weightlessness is achieved. The weight of a 125-pound astronaut at an altitude of <i>x</i> kilometers above sea level is given by<p style='text-align:center; margin: 10px;'><i>W</i> = 125(<sup>6400</sup>&frasl;<sub>6400 + <i>x</i></sub>)<sup>2</sup>.</p>At what altitudes is the astronaut's weight less than 5 pounds?"},label:!1}]},{num:51,text:"Aircraft's landing speed",alignment:null,parts:[{type:"textbox",options:{text:"In the design of certain small turbo-prop aircraft, the landing speed <i>V</i> (in ft/sec) is determined by the formula <i>W</i> = 0.00334<i>V</i><sup>2</sup><i>S</i>, where <i>W</i> is the gross weight (in pounds) of the aircraft and <i>S</i> is the surface area (in ft<sup>2</sup>) of the wings. If the gross weight of the aircraft is between 7500 pounds and 10,000 pounds and <i>S</i> = 210 ft<sup>2</sup>, determine the range of the landing speeds in miles per hour."},label:!1}]}]}]},{title:"Chapter 3 Functions and Graphs",subchapters:[{title:"3.1 Rectangular Coordinate Systems",problems:[{num:3,text:null,alignment:null,parts:[{type:"textbox",options:{text:"Plot the points <i>A</i> (0, 0), <i>B</i> (1, 1), <i>C</i> (3, 3), <i>D</i> (-1, -1), and <i>E</i> (-2, -2). Describe the set of all points of the form (<i>a</i>, <i>a</i>), where <i>a</i> is a real number."},label:!1}]},{num:7,text:"Describe the set of all points <i>P</i> (<i>x</i>, <i>y</i>) in a coordinate plane that satisfy the given condition.",alignment:"column",parts:[{type:"derivation",options:{eq:"x=-2"},label:!0},{type:"derivation",options:{eq:"y=3"},label:!0},{type:"derivation",options:{eq:"x≥0"},label:!0},{type:"derivation",options:{eq:"xy>0"},label:!0},{type:"derivation",options:{eq:"y<0"},label:!0},{type:"derivation",options:{eq:"x=0"},label:!0}]},{num:9,text:"(a) Find the distance <i>d</i> (<i>A</i>, <i>B</i>) between <i>A</i> and <i>B</i>. (b) Find the midpoint of the segment <i>AB</i>.",alignment:"row",parts:[{type:"textbox",options:{text:"<i>A</i> (4, -3)"},label:!1},{type:"textbox",options:{text:"<i>B</i> (6, 2)"},label:!1}]},{num:11,text:"(a) Find the distance <i>d</i> (<i>A</i>, <i>B</i>) between <i>A</i> and <i>B</i>. (b) Find the midpoint of the segment <i>AB</i>.",alignment:"row",parts:[{type:"textbox",options:{text:"<i>A</i> (-5, 0)"},label:!1},{type:"textbox",options:{text:"<i>B</i> (-2, -2)"},label:!1}]},{num:13,text:"(a) Find the distance <i>d</i> (<i>A</i>, <i>B</i>) between <i>A</i> and <i>B</i>. (b) Find the midpoint of the segment <i>AB</i>.",alignment:"row",parts:[{type:"textbox",options:{text:"<i>A</i> (7, -3)"},label:!1},{type:"textbox",options:{text:"<i>B</i> (3, -3)"},label:!1}]},{num:15,text:"We're not yet supporting this problem.",alignment:null,parts:[]},{num:19,text:null,alignment:null,parts:[{type:"textbox",options:{text:"Given <i>A</i> (-3, 8), find the coordinates of the point <i>B</i> such that <i>C</i> (5, -10) is the midpoint of segment <i>AB</i>."},label:!1}]},{num:21,text:"Prove that <i>C</i> is on the perpendicular bisector of segment <i>AB</i>.",alignment:"row",parts:[{type:"textbox",options:{text:"<i>A</i> (-4, -3)"},label:!1},{type:"textbox",options:{text:"<i>B</i> (6, 1)"},label:!1},{type:"textbox",options:{text:"<i>C</i> (5, -11)"},label:!1}]},{num:23,text:"Find a formula that expresses the fact that an arbitrary point <i>P</i> (<i>x</i>, <i>y</i>) is on the perpendicular bisector <i>l</i> of segment <i>AB</i>.",alignment:"row",parts:[{type:"textbox",options:{text:"<i>A</i> (-4, -3)"},label:!1},{type:"textbox",options:{text:"<i>B</i> (6, 1)"},label:!1}]},{num:25,text:null,alignment:null,parts:[{type:"textbox",options:{text:"Find a formula that expresses the fact that <i>P</i> (<i>x</i>, <i>y</i>) is a distance 5 from the origin. Describe the set of all such points."},label:!1}]},{num:26,text:null,alignment:null,parts:[{type:"textbox",options:{text:"Find a formula that states that <i>P</i> (<i>x</i>, <i>y</i>) is a distance <i>r</i> > 0 from a fixed point <i>C</i> (<i>h</i>, <i>k</i>). Describe the set of all such points."},label:!1}]},{num:27,text:null,alignment:null,parts:[{type:"textbox",options:{text:"Find all points on the <i>y</i>-axis that are a distance 6 from <i>P</i> (5, 3)."},label:!1}]},{num:29,text:null,alignment:null,parts:[{type:"textbox",options:{text:"Find the point with coordinates of the form (2<i>a</i>, <i>a</i>) that is in the third quadrant and is a distance 5 from <i>P</i> (1, 3)."},label:!1}]},{num:31,text:null,alignment:null,parts:[{type:"textbox",options:{text:"For what values of <i>a</i> is the distance between <i>P</i> (<i>a</i>, 3) and <i>Q</i> (5, 2<i>a</i>) greater than √26?"},label:!1}]},{num:33,text:null,alignment:null,parts:[{type:"textbox",options:{text:"Prove that the midpoint of the hypotenuse of any right triangle is equidistant from the vertices. (<i>Hint:</i> Label the vertices of the triangle <i>O</i> (0,0), <i>A</i> (</i>a</i>, 0), and <i>B</i> (0, <i>b</i>).)"},label:!1}]}]},{title:"3.2 Graphs of Equations",problems:[{num:1,text:"Sketch the graph of the equation, and label the <i>x</i>- and <i>y</i>-intercepts.",alignment:null,parts:[{type:"derivation",options:{eq:"y=2x-3"},label:!1}]},{num:3,text:"Sketch the graph of the equation, and label the <i>x</i>- and <i>y</i>-intercepts.",alignment:null,parts:[{type:"derivation",options:{eq:"y=-x+1"},label:!1}]},{num:5,text:"Sketch the graph of the equation, and label the <i>x</i>- and <i>y</i>-intercepts.",alignment:null,parts:[{type:"derivation",options:{eq:"y=-4x^2"},label:!1}]},{num:7,text:"Sketch the graph of the equation, and label the <i>x</i>- and <i>y</i>-intercepts.",alignment:null,parts:[{type:"derivation",options:{eq:"y=2x^2-1"},label:!1}]},{num:9,text:"Sketch the graph of the equation, and label the <i>x</i>- and <i>y</i>-intercepts.",alignment:null,parts:[{type:"derivation",options:{eq:"x=1/4y^2"},label:!1}]},{num:11,text:"Sketch the graph of the equation, and label the <i>x</i>- and <i>y</i>-intercepts.",alignment:null,parts:[{type:"derivation",options:{eq:"x=-y^2+3"},label:!1}]},{num:13,text:"Sketch the graph of the equation, and label the <i>x</i>- and <i>y</i>-intercepts.",alignment:null,parts:[{type:"derivation",options:{eq:"y=-1/2x^3"},label:!1}]},{num:15,text:"Sketch the graph of the equation, and label the <i>x</i>- and <i>y</i>-intercepts.",alignment:null,parts:[{type:"derivation",options:{eq:"y=x^3-8"},label:!1}]},{num:17,text:"Sketch the graph of the equation, and label the <i>x</i>- and <i>y</i>-intercepts.",alignment:null,parts:[{type:"derivation",options:{eq:"y=sqrtx"},label:!1}]},{num:19,text:"Sketch the graph of the equation, and label the <i>x</i>- and <i>y</i>-intercepts.",alignment:null,parts:[{type:"derivation",options:{eq:"y=sqrtx-4"},label:!1}]},{num:20,text:"Sketch the graph of the equation, and label the <i>x</i>- and <i>y</i>-intercepts.",alignment:null,parts:[{type:"derivation",options:{eq:"y=sqrt{x-4}"},label:!1}]},{num:21,text:"Use tests for symmetry to determine which graphs in the indicated exercises are symmetric with respect to (a) the <i>y</i>-axis, (b) the <i>x</i>-axis, and (c) the origin.",alignment:null,parts:[{type:"textbox",options:{text:"The odd-numbered exercises in 1-20"},label:!1}]},{num:23,text:"Sketch the graph of the circle or semicircle.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2+y^2=11"},label:!1}]},{num:25,text:"Sketch the graph of the circle or semicircle.",alignment:null,parts:[{type:"derivation",options:{eq:"(x+3)^2+(y-2)^2=9"},label:!1}]},{num:27,text:"Sketch the graph of the circle or semicircle.",alignment:null,parts:[{type:"derivation",options:{eq:"(x+3)^2+y^2=16"},label:!1}]},{num:31,text:"Sketch the graph of the circle or semicircle.",alignment:null,parts:[{type:"derivation",options:{eq:"y=-sqrt{16-x^2}"},label:!1}]},{num:33,text:"Sketch the graph of the circle or semicircle.",alignment:null,parts:[{type:"derivation",options:{eq:"x=sqrt{9-y^2}"},label:!1}]},{num:35,text:"Find an equation of the circle that satisfies the stated conditions.",alignment:null,parts:[{type:"textbox",options:{text:"Center <i>C</i> (2, -3), radius 5"},label:!1}]},{num:37,text:"Find an equation of the circle that satisfies the stated conditions.",alignment:null,parts:[{type:"textbox",options:{text:"Center <i>C</i> (<sup>1</sup>&frasl;<sub>4</sub>, 0), radius 3&radic;2"},label:!1}]},{num:39,text:"Find an equation of the circle that satisfies the stated conditions.",alignment:null,parts:[{type:"textbox",options:{text:"Center <i>C</i> (-4, 6), passing through <i>P</i> (1, 2)"},label:!1}]},{num:41,text:"Find an equation of the circle that satisfies the stated conditions.",alignment:null,parts:[{type:"textbox",options:{text:"Center <i>C</i> (-3, 6), tangent to the <i>y</i>-axis"},label:!1}]},{num:43,text:"Find an equation of the circle that satisfies the stated conditions.",alignment:null,parts:[{type:"textbox",options:{text:"Tangent to both axes, center in the second quadrant, radius 4"},label:!1}]},{num:45,text:"Find an equation of the circle that satisfies the stated conditions.",alignment:null,parts:[{type:"textbox",options:{text:"Endpoints of a diameter <i>A</i> (4, -3) and <i>B</i> (-2, 7)"},label:!1}]},{num:47,text:"Find the center and radius of the circle with the given equation.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2+y^2-4x+6y-36-0"},label:!1}]},{num:49,text:"Find the center and radius of the circle with the given equation.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2+y^2+4y-117=0"},label:!1}]},{num:51,text:"Find the center and radius of the circle with the given equation.",alignment:null,parts:[{type:"derivation",options:{eq:"2x^2+2y^2-12x+4y-15=0"},label:!1}]},{num:53,text:"Find the center and radius of the circle with the given equation.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2+y^2+4x-2y+5=0"},label:!1}]},{num:55,text:"Find the center and radius of the circle with the given equation.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2+y^2-2x-8y+19=0"},label:!1}]},{num:57,text:"Find equations for the upper half, lower half, right half, and left half of the circle.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2+y^2=36"},label:!1}]},{num:59,text:"Find equations for the upper half, lower half, right half, and left half of the circle.",alignment:null,parts:[{type:"derivation",options:{eq:"(x-2)^2+(y+1)^2=49"},label:!1}]},{num:65,text:"Determine whether the point <i>P</i> is inside, outside, or on the circle with center <i>C</i> and radius <i>r</i>.",alignment:null,parts:[{type:"textbox",options:{text:"<i>P</i> (2, 3), <i>C</i> (4, 6), <i>r</i> = 4"},label:!0},{type:"textbox",options:{text:"<i>P</i> (4, 2), <i>C</i> (1, -2), <i>r</i> = 5"},label:!0},{type:"textbox",options:{text:"<i>P</i> (-3, 5), <i>C</i> (2, 1), <i>r</i> = 6"},label:!0}]},{num:67,text:"For the given circle, find (a) the <i>x</i>-intercepts and (b) the <i>y</i>-intercepts.",alignment:null,parts:[{type:"derivation",options:{eq:"x^2+y^2-4x-6y+4=0"},label:!1}]}]},{title:"3.3 Lines",problems:[{num:3,text:"Sketch the line through <i>A</i> and <i>B</i>, and find its slope <i>m</i>.",alignment:null,parts:[{type:"textbox",options:{text:"<i>A</i> (2, 5), <i>B</i> (-7, 5)"},label:!1}]},{num:13,video:"ntllXftcCuU",text:"Sketch the graph of <i>y</i> = <i>mx</i> for the given values of <i>m</i>.",alignment:null,parts:[{type:"textbox",options:{text:"<i>m</i> = 3, -2, <sup>2</sup>&frasl;<sub>3</sub>, -<sup>1</sup>&frasl;<sub>4</sub>"},label:!1}]},{num:15,text:"Sketch the graph of the line through <i>P</i> for each value of <i>m</i>.",alignment:null,parts:[{type:"textbox",options:{text:"<i>P</i> (3, 1); <i>m</i> = <sup>1</sup>&frasl;<sub>2</sub>, -1, -<sup>1</sup>&frasl;<sub>5</sub>"},label:!1}]},{num:19,text:"Sketch the graphs of the lines on the same coordinate plane.",alignment:"row",parts:[{type:"derivation",options:{eq:"y=x+3"},label:!1},{type:"derivation",options:{eq:"y=x+1"},label:!1},{type:"derivation",options:{eq:"y=-x+1"},label:!1}]},{num:21,text:"Find a general form of an equation of the line through the point <i>A</i> that satisfies the given condition.",alignment:"column",parts:[{type:"textbox",options:{text:"<i>A</i> (5, -2)"},label:!1},{type:"textbox",options:{text:"parallel to the <i>y</i>-axis"},label:!0},{type:"textbox",options:{text:"perpendicular to the <i>y</i>-axis"},label:!0}]},{num:23,text:"Find a general form of an equation of the line through the point <i>A</i> that satisfies the given condition.",alignment:"row",parts:[{type:"textbox",options:{text:"<i>A</i> (5, -3)"},label:!1},{type:"textbox",options:{text:"slope -4"},label:!1}]},{num:25,text:"Find a general form of an equation of the line through the point <i>A</i> that satisfies the given condition.",alignment:"row",parts:[{type:"textbox",options:{text:"<i>A</i> (4, 0)"},label:!1},{type:"textbox",options:{text:"slope -3"},label:!1}]},{num:27,text:"Find a general form of an equation of the line through the point <i>A</i> that satisfies the given condition.",alignment:"row",parts:[{type:"textbox",options:{text:"<i>A</i> (4, -5)"},label:!1},{type:"textbox",options:{text:"through <i>B</i> (-3, 6)"},label:!1}]},{num:29,text:"Find a general form of an equation of the line through the point <i>A</i> that satisfies the given condition.",alignment:"row",parts:[{type:"textbox",options:{text:"<i>A</i> (2, -4)"},label:!1},{type:"textbox",options:{text:"parallel to the line 5<i>x</i> - 2<i>y</i> = 4"},label:!1}]},{num:31,text:"Find a general form of an equation of the line through the point <i>A</i> that satisfies the given condition.",alignment:"row",parts:[{type:"textbox",options:{text:"<i>A</i> (7, -3)"},label:!1},{type:"textbox",options:{text:"perpendicular to the line 2<i>x</i> - 5<i>y</i> = 8"},label:!1}]},{num:33,text:"Find the slope-intercept form of the line that satisfies the given conditions.",alignment:"row",parts:[{type:"textbox",options:{text:"<i>x</i>-intercept 4"},label:!1},{type:"textbox",options:{text:"<i>y</i>-intercept -3"},label:!1}]},{num:35,text:"Find the slope-intercept form of the line that satisfies the given conditions.",alignment:null,parts:[{type:"textbox",options:{text:"Through <i>A</i> (5, 2) and <i>B</i> (-1, 4)"},label:!1}]},{num:37,text:"Find a general form of an equation for the perpendicular bisector of the segment <i>AB</i>.",alignment:"row",parts:[{type:"textbox",options:{text:"<i>A</i> (3, -1)"},label:!1},{type:"textbox",options:{text:"<i>B</i> (-2, 6)"},label:!1}]},{num:39,text:"Find an equation for the line that bisects the given quadrants.",alignment:null,parts:[{type:"textbox",options:{text:"II and IV"},label:!1}]},{num:41,text:"Use the slope-intercept form to find the slope and <i>y</i>-intercept of the given line, and sketch its graph.",alignment:null,parts:[{type:"derivation",options:{eq:"2x=15-3y"},label:!1}]},{num:43,text:"Use the slope-intercept form to find the slope and <i>y</i>-intercept of the given line, and sketch its graph.",alignment:null,parts:[{type:"derivation",options:{eq:"4x-3y=9"},label:!1}]},{num:45,text:"We're not yet supporting this problem.",alignment:null,parts:[]},{num:51,text:"Fetal growth",alignment:null,parts:[{type:"textbox",options:{text:"The growth of a fetus more than 12 weeks old can be approximated by the formula <i>L</i> = 1.53<i>t</i> - 6.7, where <i>L</i> is the length (in centimeters) and <i>t</i> is the age (in weeks). Prenatal length can be determined by ultrasound. Approximate the age of a fetus whose length is 28 centimeters."},label:!1}]},{num:54,text:"Growth of a blue whale",alignment:"column",parts:[{type:"textbox",options:{text:"Newborn blue whales are approximately 24 feet long and weigh 3 tons. Young whales are nursed for 7 months, and by the time of weaning they often are 53 feet long and weigh 23 tons. Let <i>L</i> and <i>W</i> denote the length (in feet) and the weight (in tons), respectively, of a whale that is <i>t</i> months of age."},label:!1},{type:"textbox",options:{text:"If <i>L</i> and <i>t</i> are linearly related, express <i>L</i> in terms of <i>t</i>."},label:!0},{type:"textbox",options:{text:"What is the daily increase in the length of a young whale? (Use 1 month = 30 days.)"},label:!0},{type:"textbox",options:{text:"If <i>W</i> and <i>t</i> are linearly related, express <i>W</i> in terms of <i>t</i>."},label:!0},{type:"textbox",options:{text:"What is the daily increase in the weight of a young whale?"},label:!0}]},{num:57,text:"Childhood weight",alignment:"column",parts:[{type:"textbox",options:{text:"A baby weighs 10 pounds at birth, and three years later the child's weight is 30 pounds. Assume that childhood weight <i>W</i> (in pounds) is linearly related to age <i>t</i> (in years)."},label:!1},{type:"textbox",options:{text:"Express <i>W</i> in terms of <i>t</i>."},label:!0},{type:"textbox",options:{text:"What is <i>W</i> on the child's sixth birthday?"},label:!0},{type:"textbox",options:{text:"At what age will the child weigh 70 pounds?"},label:!0},{type:"textbox",options:{text:"Sketch, on a <i>tW</i>-plane, a graph that shows the relationship between <i>W</i> and <i>t</i> for 0 ≤ <i>t</i> ≤ 12."},label:!0}]},{num:61,text:"Urban heat island",alignment:"column",parts:[{type:"textbox",options:{text:"The urban heat island phenomenon has been observed in Tokyo. The average temperature was 13.5°C in 1915, and since then has risen 0.032°C per year."},label:!1},{type:"textbox",options:{text:"Assuming that temperature <i>T</i> (in °C) is linearly related to time <i>t</i> (in years) and that <i>t</i> = 0 corresponds to 1915, express <i>T</i> in terms of <i>t</i>."},label:!0},{type:"textbox",options:{text:"Predict the average temperature in the year 2010."},label:!0}]},{num:67,text:"Vertical wind shear",alignment:null,parts:[{type:"textbox",options:{text:"Vertical wind shear occurs when wind speed varies at different heights above the ground. Wind shear is of great importance to pilots during takeoffs and landings. If the wind speed is <i>v</i><sub>1</sub> at height <i>h</i><sub>1</sub> and <i>v</i><sub>2</sub> at height <i>h</i><sub>2</sub>, then the average wind shear <i>s</i> is given by the slope formula<p style='text-align:center; margin:10px'><i>s</i> = <sup><i>v</i><sub>2</sub> - <i>v</i><sub>1</sub></sup>&frasl;<sub><i>h</i><sub>2</sub> - <i>h</i><sub>1</sub></sub>.</p>If the wind speed at ground level is 22 mi/hr and <i>s</i> has been determined to be 0.07, find the wind speed 185 feet above the ground."},label:!1}]},{num:69,text:"The given points were found using empirical methods. Determine whether they lie on the same line <i>y</i> = <i>ax</i> + <i>b</i>, and if so, find the values of <i>a</i> and <i>b</i>.",alignment:"column",parts:[{type:"textbox",options:{text:"<i>A</i> (-1.3, -1.3598)"},label:!1},{type:"textbox",options:{text:"<i>B</i> (-0.55, -1.11905)"},label:!1},{type:"textbox",options:{text:"<i>C</i> (1.2, -0.5573)"},label:!1},{type:"textbox",options:{text:"<i>D</i> (3.25, 0.10075)"},label:!1}]}]}]}]}).call(this,n(8),n(6))},function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.VideoModal=s;var r=n(7),o=n(56);function s(t,e){this.id=(0,r.uid)(),this.modal=null;var n=e||{};this.video_size={width:n.video_width||"80%",height:n.video_height||"80%"},this.player=null,this.sources=t,this.videoInfo={},this.max_idle_time=n.max_idle_time,this.timer_id=null,this.resetTimer(),this.visible=!1,this.single_video_mode=!1,this.endTimer=null,this.startTimer=null,this.volume=100,this.target_volume=40,this.max_volume=null,this.init(),this.createPlayer(function(){this.player.mute(),this.cueVideoList(this.sources)})}s.prototype.getVideoInfo=function(t){var e=new XMLHttpRequest;e.videoModal=this,e.onreadystatechange=function(){if(4===e.readyState&&200===e.status){var n=void 0;try{n=JSON.parse(e.responseText)}catch(t){return void console.log("could not parse youtube response: ",t)}this.videoInfo[t]={title:n.items[0].snippet.title,desc:n.items[0].snippet.description}}}.bind(this);var n="https://www.googleapis.com/youtube/v3/videos?part=snippet,contentDetails&id="+t+"&key=AIzaSyCKInAs_T5Ujjg-brjkx5Pj1wafSzxjGHE";e.open("GET",n,!0),e.send()},s.prototype.remove=function(){this.resetTimer(),this.modal&&this.modal.remove(),this.player&&this.player.destroy&&this.player.destroy()},s.prototype.unMute=function(){this.player&&this.player.unMute()},s.prototype.mute=function(){this.player&&this.player.mute()},s.prototype.getVolume=function(){return this.volume},s.prototype.setVolume=function(t){this.target_volume=t,this.max_volume=null,this.updateVolume()},s.prototype.reduceVolume=function(t){this.max_volume=t,this.target_vol=null,this.updateVolume()},s.prototype.updateVolume=function(){if(this.player){var t=this.player.getPlayerState();1!==t&&5!==t||(this.volume=this.player.getVolume(),null!==this.max_volume&&this.volume>this.max_volume&&(this.target_volume=this.max_volume,this.max_volume=null),null!==this.target_volume&&(this.player.setVolume(this.target_volume),this.volume=this.target_volume,this.target_volume=null))}},s.prototype.playSingle=function(t){this.player&&(this.single_video_mode=!0,this.player.setLoop(!1),this.videoInfo[t]||this.getVideoInfo(t),this.player.loadVideoById({videoId:t}),this.visible||this.showDialog())},s.prototype.cueVideoList=function(t){var e=this;0!==t.length&&(this.single_video_mode=!1,t.forEach(function(t){e.videoInfo[t]||e.getVideoInfo(t)}),this.player.cuePlaylist(t,0,0),this.player.setLoop(!0),this.player.setShuffle(!0))},s.prototype.createPlayer=function(t){o.YTLoader.loaded?"undefined"!=typeof YT&&YT&&YT.Player?this.player=new YT.Player("gm_video_div"+this.id,{playerVars:{rel:0,enablejsapi:1},height:this.video_size.height,width:this.video_size.width,events:{onReady:t.bind(this),onStateChange:this.onPlayerStateChange.bind(this)}}):console.warn("Error loading Youtube player."):o.YTLoader.loadYTScript(this.createPlayer.bind(this,t))},s.prototype.pauseAtEnd=function(){var t=this;clearInterval(this.startTimer),this.player.getCurrentTime()>this.currentVideoDuration-.5&&(clearInterval(this.endTimer),this.player.pauseVideo(),this.single_video_mode||(this.startTimer=setTimeout(function(){t.player.playVideo()},3e3)))},s.prototype.onPlayerStateChange=function(t){var e=this;if(clearInterval(this.endTimer),1===t.data){var n=this.player.getVideoData().video_id,i=this.videoInfo[n];this.titleEl.text(i?i.title:""),this.currentVideoDuration=this.player.getDuration(),this.endTimer=setInterval(function(){e.pauseAtEnd()},250)}this.updateVolume()},s.prototype.resetTimer=function(){this.max_idle_time&&(this.timer_id&&clearTimeout(this.timer_id),this.timer_id=setTimeout(this.showDialog.bind(this,!0),this.max_idle_time))},s.prototype.init=function(){this.modal&&this.modal.remove(),this.modal=t.select("#gm-modal-container").append("div").classed("modal fade",!0).attr("role","dialog").style("display","none");var e=this.modal.append("div").attr("class","modal-dialog").style({position:"relative",display:"table","overflow-y":"auto","overflow-x":"auto",width:"auto"}).attr("role","document").append("div").attr("class","modal-content"),n=e.append("div").classed("modal-header",!0).style("padding-left","25px").style("padding-right","25px");n.append("button").attr("type","button").classed("close",!0).attr("data-dismiss","modal").style("font-size","28px").html("&times;"),this.titleEl=n.append("h3").classed("modal-title",!0).style("font-size","18px").text("Working with Graspable Math"),e.append("div").classed("modal-body",!0).append("div").attr("id","gm_video_div"+this.id),i(this.modal.node()).modal({show:!1}),i(this.modal.node()).on("hidden.bs.modal",function(){this.visible=!1,this.player&&(this.player.seekTo(0),this.player.pauseVideo(),this.single_video_mode&&this.cueVideoList(this.sources)),this.resetTimer(),clearInterval(this.startTimer),clearInterval(this.endTimer)}.bind(this))},s.prototype.showDialog=function(){this.timer_id&&clearTimeout(this.timer_id),this.player?this.visible||(this.player.setSize(.8*window.innerWidth,.8*window.innerHeight-60),i(this.modal.node()).modal("show"),this.visible=!0,this.single_video_mode||this.player.playVideo()):setTimeout(this.showDialog.bind(this),1e3)}}).call(this,n(6),n(8))},function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.IdentificationModal=s;var r=n(0),o=n(42);function s(e){this.modal=null,this.init(),this.events=t.dispatch("identified"),this.max_idle_time=e,this.timer_id=null,this.resetTimer(),this.showGlassPane(!0)}r.gmath.IdentificationModal=s,s.prototype.resetTimer=function(){this.showGlassPane(!1),this.timer_id&&clearTimeout(this.timer_id),this.timer_id=setTimeout(this.showGlassPane.bind(this,!0),this.max_idle_time)},s.prototype.showGlassPane=function(t){this.glass_pane.style("display",t?null:"none")},s.prototype.init=function(){this.glass_pane&&this.glass_pane.remove(),this.glass_pane=t.select("#gm-modal-container").append("div").style({position:"fixed",top:0,right:0,bottom:0,left:0,"z-index":1e4,display:"none"}).call((0,o.mtouch_events)().on("touch",this.show.bind(this))),this.modal&&this.modal.remove(),this.modal=t.select("#gm-modal-container").append("div").attr("class","modal fade").attr("tabindex",-1).attr("role","dialog");var e=this.modal.append("div").attr("class","modal-dialog modal-sm").attr("role","document").append("div").attr("class","modal-content");e.append("div").classed("modal-header",!0).append("h4").classed("modal-title",!0).text("Please tell us who you are!");var n=e.append("div").classed("modal-body",!0).append("div");this.type_div=n.append("div").classed("form-group",!0).style("margin-bottom",0),this.type_div.append("label").attr({for:"user-id",class:"control-label"}).text("I'm a...");var r={width:"40%",height:"60px"},s=this.type_div.append("div");s.append("button").attr({type:"button",class:"btn btn-default"}).style(r).text("Student").on("click",this.on_choice.bind(this,"student")),s.append("button").attr({type:"button",class:"btn btn-default"}).style(r).style("float","right").text("Tutor").on("click",this.show_id_input.bind(this,!0)),this.id_div=n.append("div").classed("form-group",!0),this.id_div.append("label").attr({for:"user-id",class:"control-label"}).text("My initials & day of birth");var a=this.id_div.append("div").classed("input-group",!0);a.append("input").attr({type:"text",class:"form-control",id:"user-id"}).attr({placeholder:"EM28"}).on("keyup",function(){13===t.event.keyCode&&(t.event.preventDefault(),this.on_choice("tutor"))}.bind(this)),a.append("span").classed("input-group-btn",!0).append("button").attr({type:"button",class:"btn btn-default"}).text("OK").on("click",this.on_choice.bind(this,"tutor")),i(this.modal.node()).modal({backdrop:"static",keyboard:!1,show:!1})},s.prototype.show_id_input=function(t){this.type_div.style("display",t?"none":null),this.id_div.style("display",t?null:"none"),t&&this.modal.select("#user-id").node().focus()},s.prototype.reset=function(){this.modal.select("#user-id").node().value=null,this.show_id_input(!1),this.showGlassPane(!1)},s.prototype.on_choice=function(t){var e=this.modal.select("#user-id").node().value,n=!("tutor"!==t||e&&/^[a-zA-Z]{2,3}[0-9]{1,2}$/.test(e));this.id_div.classed("has-error",n),n||(this.events.identified({type:t,id:e}),i(this.modal.node()).modal("hide"),this.resetTimer())},s.prototype.show=function(){this.reset(),i(this.modal.node()).modal("show")}}).call(this,n(6),n(8))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.Canvas=e.insertCanvas=void 0;var i,r=n(0),o=n(17),s=n(55),a=n(88),l=n(87),u=n(220),c=n(86),d=n(219),h=n(84),p=n(217),f=n(216),g=n(215),m=n(213),v=n(83),y=n(81),b=n(92),_=n(10),x=n(184),w=n(95),A=(i=n(85))&&i.__esModule?i:{default:i};r.gmath.ui=r.gmath.ui||{},r.gmath.ui.resource_path="../shared/",e.insertCanvas=function(t,e){return new k(t,e)};var k=e.Canvas=function(e,n){var i=this;this.id=r.gmath.uid(),this.meta_data={title:"Untitled Math Sheet"},this.container=t.select(e),this.screen_size=this.getScreenSize(),this.loaded=!1,this.after_load_callbacks=[],this.initSettings(n),this._modeButtonGroup=[],this.events=t.dispatch("button","meta_data_change"),this.updateTitle(),this.events.on("meta_data_change."+this.id,function(){return i.updateTitle()}),window&&window.gmath_log_ga&&this.settings.get("disable_ga_tracking")&&gmath_log_ga.enabled(!1),this.model=(0,y.CanvasModelView)(this),this.model.enableNotifications(!this.settings.get("disable_notifications")),this.model.on("active_tool."+this.id,this.updateModeBtns.bind(this)),this.controller=(0,b.CanvasController)(this.model).drawing(this.settings.get("draw_btn")).hwr(this.settings.get("hwr")).use_keyboard(this.settings.get("use_keyboard")).use_hold_menu(this.settings.get("use_hold_menu")).keyboard_max_width(this.settings.get("keyboard_max_width")).askConfirmationOnClosing(this.settings.get("ask_confirmation_on_closing")),this.init(),o.user.events.on("login."+this.id,function(){return i.updateTitle()}),o.user.events.on("logout."+this.id,function(){return i.updateTitle()}),this.settings.get("overflow_visible")&&(this.scroll_div.style("overflow","visible"),this.content_div.style("overflow","visible")),this.logger=new s.DataLogger(this,this.settings.get("log_mouse_trajectories")),this.controller.logger(this.logger),!this.settings.get("parse_url_query_params")||this.meta_data.save_id&&this.settings.get("savefile_server")||this.callWhenReady(this.parseURLQueryParams.bind(this)),this.setupInputModeListeners(),this.gcService=new x.GCService(this),this.settings.get("enable_external_api")&&(this.externalAPI=new w.ExternalApi(this)),function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3,i=Date.now(),r=t.append("div").style({width:0,height:0}).attr("id","gm-canvas-css-finished-loading").node(),o=t.append("div").style({width:0,height:0}).classed("btn-group",!0).node();!function t(){var s=window.getComputedStyle(r).display,a=window.getComputedStyle(o).display;Date.now()-i<=n&&("none"!==s||"inline-block"!==a)?setTimeout(t,50):(r.remove(),o.remove(),e())}()}(this.content_div,this.finishedLoading.bind(this))};function T(t){void 0===t.font_smaller_btn||t.font_smaller_btn||(t.font_size_btns=!1),void 0===t.font_larger_btn||t.font_larger_btn||(t.font_size_btns=!1),t.feedback&&(t.feedback_btn||void 0===t.feedback_btn)&&(t.feedback_btn=!0),void 0===t.saving_and_loading||t.saving_and_loading||(t.save_btn=!1,t.load_btn=!1)}k.createFromSaveId=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=new k(e,n);return r.loadFromFile(t,!0,i),r},k.prototype.initSettings=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.settings=new _.Settings("Canvas"),this.settings.get("parse_url_options")||t.parse_url_options){var e=r.gmath.getURLParameter("options");try{if(e){var n=JSON.parse(e);T(n),this.settings.setExisting(n)}}catch(t){console.error("Error parsing url options: ",t)}}T(t),this.settings.setExisting(t)},k.prototype.updateTitle=function(){if(this.settings.get("title_selector")){var e=this.meta_data&&this.meta_data.title||"";o.user.logged_in&&o.user.user_id===this.meta_data.owner||this.meta_data.display_name&&(e=e+" ("+this.meta_data.display_name+")"),t.select(this.settings.get("title_selector")).text(e)}},k.prototype.getScreenSize=function(){var t=this.container.append("div").style({height:"1in",width:"1in",top:"100%",left:"100%",position:"fixed"}),e=t.node().offsetWidth,n=t.node().offsetHeight;return t.remove(),{width:window.screen.width/e,height:window.screen.height/n}},k.prototype.callWhenReady=function(t){this.loaded?t(this):this.after_load_callbacks.push(t)},k.prototype.finishedLoading=function(){var t=this;this.loaded=!0,this.after_load_callbacks.forEach(function(e){return e(t)}),this.after_load_callbacks=[]},k.prototype.setupInputModeListeners=function(){var e=this;t.select("body").on("mousedown",function(){return e.model.inputMode("mouse")}),t.select("body").on("touchstart",function(){return e.model.inputMode("touch")})},k.prototype.init=function(){this.outer_div=this.container.append("div").classed("flex-container-columns",!0).classed("gm-styles",!0).style({width:this.settings.get("width"),height:this.settings.get("height")});var e=t.select("body");0===e.select("#gm-modal-container").size()&&(this.modalContainer=e.append("div").attr("id","gm-modal-container").classed("gm-styles",!0)),Array.isArray(this.settings.get("external_component_selectors"))&&this.settings.get("external_component_selectors").forEach(function(e){t.select(e).classed("gm-styles",!0)}),this.settings.get("use_toolbar")&&this.initToolbar(),this.initOverlayFooter(),this.scroll_div="top"===this.settings.get("toolbar_pos")?this.outer_div.append("div"):this.outer_div.insert("div","div.gm-main-toolbar"),this.scroll_div.style("flex",1).style("-webkit-flex",1),this.scroll_div.classed("gm-canvas",!0).style("width",this.settings.get("width")).style("position","relative").style("overflow-y",this.settings.get("vertical_scroll")?"scroll":"hidden"),this.content_div=this.scroll_div.append("div").style("width","100%").style("min-width",this.settings.get("content_min_width")).style("min-height",this.settings.get("vertical_scroll")?"200%":"100%").style("position","absolute").call(this.model,this.settings.get("vertical_scroll")),this.settings.get("fullscreen_btn")&&this.initFullscreenButton(this.outer_div),this.controller(),this.settings.get("vertical_scroll")&&(this.scroll_div.on("scroll",function(){this.adjustCanvasSize(),this.model.updateNotice()}.bind(this)),this.adjustCanvasSize(!0)),!1!==this.settings.get("identification_interval")&&(this.id_modal=new a.IdentificationModal(this.settings.get("identification_interval")),this.id_modal.events.on("identified",this.onUserIdentification.bind(this)),this.controller.on("start-of-interaction",this.id_modal.resetTimer.bind(this.id_modal))),(!1!==this.settings.get("demo_video_idle_time")&&this.settings.get("demo_video_sources")&&this.settings.get("demo_video_sources").length>0||this.settings.get("use_toolbar")&&(this.settings.get("homework_btn")||this.settings.get("help_btn")))&&(this.video_modal=new l.VideoModal(this.settings.get("demo_video_sources")||[],{max_idle_time:this.settings.get("demo_video_idle_time")}),this.controller.on("start-of-interaction.video_modal",this.video_modal.resetTimer.bind(this.video_modal)))},k.prototype.initOverlayFooter=function(){this.footer||(this.footer=this.outer_div.append("div").style({display:"none",position:"absolute",width:"100%",left:0,bottom:0,"z-index":10,"text-align":"center"}))},k.prototype.showFooter=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.footer.style("display",t?null:"none")},k.prototype.onUserIdentification=function(t){this.logger.logCustomInteraction("user-id",{user_id:t.id,user_type:t.type})},k.prototype.initToolbar=function(t){var e=this;if(this.tools=t||this.outer_div.append("div").attr({class:"gm-main-toolbar",role:"toolbar"}).style(this.settings.get("toolbar_on_style")),this.settings.get("minimal")&&this.tools.on("mouseenter",function(){e.toolFadeoutTimer&&clearTimeout(e.toolFadeoutTimer)}).on("mouseleave",this.switchToolbarState.bind(this)),this.settings.get("transform_btn")&&this._modeButtonGroup.push({type:"radio",group:"mode",state:!0,label:"transform",icon:"glyphicon glyphicon-random"}),this.settings.get("keypad_btn")&&this._modeButtonGroup.push({type:"radio",group:"mode",state:!1,label:"keypad",icon:"material-icons",icon_name:"keyboard"}),this.settings.get("scrub_btn")&&this._modeButtonGroup.push({type:"radio",group:"mode",state:!1,label:"scrub",icon:"glyphicon glyphicon-wrench"}),this.settings.get("draw_btn")&&this._modeButtonGroup.push({type:"radio",group:"draw",state:!1,label:"draw",icon:"glyphicon glyphicon-pencil"}),this.settings.get("erase_btn")&&this._modeButtonGroup.push({type:"radio",group:"draw",state:!1,label:"erase",icon:"glyphicon glyphicon-erase"}),this.settings.get("arrange_btn")&&this._modeButtonGroup.push({type:"radio",group:"mode",state:!1,label:"arrange",icon:"glyphicon glyphicon-move"}),this._modeButtonGroup.length>0&&this.appendButtonGroup(this._modeButtonGroup,this.onButton),this.settings.get("undo_btn")||this.settings.get("redo_btn")){var n=[];this.settings.get("undo_btn")&&n.push({type:"push",label:"undo",icon:"material-icons",icon_name:"undo"}),this.settings.get("redo_btn")&&n.push({type:"push",label:"redo",icon:"material-icons",icon_name:"redo"}),this.appendButtonGroup(n,this.onButton)}if(this.settings.get("font_size_btns")){var i=[];i.push({type:"push",label:"smaller",icon:"material-icons",icon_name:"format_size",flip:"y"}),i.push({type:"push",label:"larger",icon:"material-icons",icon_name:"format_size"}),this.appendButtonGroup(i,this.onButton)}if(this.settings.get("insert_btn")&&(0,u.addInsertButton)(this,r.gmath.ui.resource_path,this.settings.get("insert_menu_items")),this.settings.get("homework_btn")&&(0,c.addHomeworkButton)(this),this.settings.get("formula_btn")&&(0,d.addFormulaButton)(this),this.settings.get("share_btn")&&(0,g.addShareButton)(this),this.settings.get("load_btn")&&(0,f.addLoadButton)(this),this.settings.get("save_btn")&&(0,p.addSaveButton)(this),this.settings.get("submit_btn")&&(0,m.addSubmitButton)(this),this.settings.get("new_sheet_btn")&&this.appendButtonGroup([{type:"push",pull_right:!0,label:"new",icon:"glyphicon glyphicon-file"}],this.onButton),this.settings.get("help_btn")&&(0,h.addHelpButton)(this,this.settings.get("show_welcome_tutorial")),this.settings.get("feedback_btn")&&this.appendButtonGroup([{type:"push",label:"feedback",pull_right:!0,icon:"glyphicon glyphicon-envelope"}],this.onButton),this.settings.get("settings_btn")&&(0,v.addSettingsButton)(this),this.settings.get("minimal")){this.tools.classed("gm-main-toolbar-minimal",!0);var o=this.tools.append("div").attr("class","btn-group pull-right").style({"line-height":"26px","margin-left":"40px"});o.append("span").text("powered by").style({"font-style":"italic","font-family":"sans-serif",color:"#909090","font-weight":300,"font-size":"13px"}),o.append("a").style({"text-decoration":"none"}).attr({href:"http://graspablemath.com",target:"_blank"}).append("img").attr({alt:"GM",src:this.settings.get("logo_src")}).style({"vertical-align":"-0.3em",height:"1.7em","margin-left":"0.8em","margin-right":"0.2em","font-size":"13px"})}this.settings.get("minimal")&&this.settings.get("static_toolbar")&&this.switchToolbarState(!0)},k.prototype.initFullscreenButton=function(t){var e="fullscreen",n=t.append("div").datum({label:e,state:!1}).classed((0,A.default)(e),!0);n.append("i").classed("material-icons",!0).style("margin","auto").text(e),n.call(r.gmath.mtouch_events().on("touch",this.onButton.bind(this)))},k.prototype.resetToolbar=function(){this.tools&&this.tools.selectAll("*").remove(),this.initToolbar(this.tools)},k.prototype.showHint=function(t,e,n){var i=this.model;n||(n={});var r={pos:{x:-1e3,y:-1e3},size:{width:n.width||220,height:0},text:t,closable:!0,uneditable:!0,static_bg:!0,text_align:"center",dont_log_events:!0,font_size:n.font_size||16,resizable:!1},o=i.createElement("textbox",r,"hint",function(t){var e=i.viewport();t.translateElement({x:n.x||e.x+e.width/2-t.size.width/2,y:n.y||e.y+e.height/2-t.size.height/2})});e&&i.on("create.gm-initial-hint",function(){i.actionsTriggeredManually()&&(i.getElementsOfType("textbox").indexOf(o)>=0&&o.fade(),i.on("create.gm-initial-hint",null))})},k.prototype.parseURLQueryParams=function(){var t=r.gmath.getURLParameter("eq");if(t){t=t.split(";"),this.controller.simulateStartOfInteraction();for(var e=0;e<t.length;e++)this.model.createDL({eq:t[e],pos:"auto"},null,"URL")}},k.prototype.adjustCanvasSize=function(t){var e=this.scroll_div.node().getBoundingClientRect().height,n=this.content_div.node().getBoundingClientRect().height,i=this.scroll_div.property("scrollTop");if(this.scroll_top||(this.scroll_top=i),t){var r=Math.round(n/e);this.content_div.style("height",e*r+"px")}i>this.scroll_top?n-i-5<=e&&(r=Math.round(n/e)+1,this.content_div.style("height",e*r+"px")):i<this.scroll_top&&n-i>=2*e&&this.noObjectsHiddenBelowView(i)&&(r=Math.round(n/e)-1,this.content_div.style("height",e*r+"px")),this.scroll_top=i},k.prototype.noObjectsHiddenBelowView=function(t){var e;if(0===(e=this.model.elements().concat(this.model.paths())).length)return!0;for(var n=0;n<e.length;n++){var i=e[n];if(i.pos){if(Array.isArray(i.pos)&&i.pos[1]>t)return!1;if(i.pos.y>t)return!1}else if(i.points&&i.points[0][1]>t)return!1}return!0},k.prototype.switchToolbarState=function(t,e){var n=this;t?n.turnOnToolbar():e?n.turnOffToolbar():n.toolFadeoutTimer=setTimeout(function(){n.turnOffToolbar()},n.settings.get("toolFadeoutDelay"))},k.prototype.turnOnToolbar=function(){this.toolFadeoutTimer&&(clearTimeout(this.toolFadeoutTimer),this.toolFadeoutTimer=null),this.tools.style(this.settings.get("toolbar_on_style")),this.toolbarOn=!0},k.prototype.turnOffToolbar=function(){this.toolFadeoutTimer&&(clearTimeout(this.toolFadeoutTimer),this.toolFadeoutTimer=null),this.tools.style(this.settings.get("toolbar_off_style")),this.toolbarOn=!1},k.prototype.resize=function(t){this.settings.set("width",t.width),this.settings.set("height",t.height),this.scroll_div.style({width:this.settings.get("width"),height:this.settings.get("height")}),this.tools&&this.tools.style({width:this.settings.get("width")})},k.prototype.addSubmitButton=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.settings.get("submit_btn")||((0,m.addSubmitButton)(this,t),this.settings.set("submit_btn",!0))},k.prototype.onButton=function(t){this.id_modal&&this.id_modal.resetTimer(),this.video_modal&&this.video_modal.resetTimer();var e={mode:"inspect"===this.model.getActiveTool()?"scrub":this.model.getActiveTool(),font_size:this.model.fontSize()};this.updateButton(t),"new sheet"!==t.label&&"new"!==t.label||(this.logger.canvas_logger.containsPendingEvents(this.logger.canvas_logger.interactionSequence)&&this.logger.canvas_logger.submitCurrentSequence(),window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","new_sheet",1),window.open(location.origin+location.pathname)),"undo"===t.label&&(this.logger.canvas_logger.containsPendingEvents(this.logger.canvas_logger.interactionSequence)&&this.logger.canvas_logger.submitCurrentSequence(),this.controller.undo(),window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","undo",1)),"redo"===t.label&&(this.logger.canvas_logger.containsPendingEvents(this.logger.canvas_logger.interactionSequence)&&this.logger.canvas_logger.submitCurrentSequence(),window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","redo",1),this.controller.redo()),"HWR"===t.label&&(window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","hwr",1),this.controller.hwr(t.state)),"transform"===t.label&&(window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","transform",1),this.model.setActiveTool(k.mode_name_map[t.label])),"keypad"===t.label&&(window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","keypad",1),this.model.setActiveTool(k.mode_name_map[t.label])),"scrub"===t.label&&(window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","scrub",1),this.model.setActiveTool(k.mode_name_map[t.label])),"arrange"===t.label&&(window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","arrange",1),this.model.setActiveTool(k.mode_name_map[t.label])),"draw"===t.label&&(window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","draw",1),this.model.setActiveTool(k.mode_name_map[t.label])),"erase"===t.label&&(window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","erase",1),this.model.setActiveTool(k.mode_name_map[t.label])),"help"===t.label&&(window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","help",1),this.help()),"feedback"===t.label&&(window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","feedback",1),this.sendFeedback()),"fullscreen"===t.label&&!1===t.state?(window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","start fullscreen",1),this.launchFullScreen(t)):"fullscreen"===t.label&&!0===t.state&&(window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","stop fullscreen",1),this.cancelFullScreen(t)),"HWR"===t.label&&!0===t.state||!0!==this.settings.get("hwr")||(window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","cancel HWR",1),this.controller.cancelHWR()),"larger"===t.label&&(window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","font larger",1),this.controller.font_larger()),"smaller"===t.label&&(window&&window.gmath_log_ga&&gmath_log_ga.trackEvent(this.settings.get("gm_app_name"),"button press","font smaller",1),this.controller.font_smaller());var n={button:{label:t.label,state:t.state,type:t.type},old_state:e,time:Date.now()};"larger"!==n.button.label&&"smaller"!==n.button.label||(n.button.font_size=this.model.fontSize()),this.events.button(n)},k.prototype.launchFullScreen=function(e){e.state=!0,this.container.classed("gm-fullscreen",!0),this.container.select(".gm-btn-fullscreen i").text("fullscreen_exit");var n=this.container.node();n.requestFullscreen?n.requestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.msRequestFullscreen&&n.msRequestFullscreen(),t.select(document).on("fullscreenchange."+this.id,this.exitFullscreenWithEscKeyListener.bind(this,e)).on("webkitfullscreenchange."+this.id,this.exitFullscreenWithEscKeyListener.bind(this,e)).on("mozfullscreenchange."+this.id,this.exitFullscreenWithEscKeyListener.bind(this,e)).on("MSFullscreenChange."+this.id,this.exitFullscreenWithEscKeyListener.bind(this,e))},k.prototype.exitFullscreenWithEscKeyListener=function(t){var e=this.container.select(".gm-btn-fullscreen").select("i");"fullscreen"!==e.text()&&(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||(e.text("fullscreen"),t.state=!1))},k.prototype.cancelFullScreen=function(e){e.state=!1,t.select(document).on("fullscreenchange."+this.id,null).on("webkitfullscreenchange."+this.id,null).on("mozfullscreenchange."+this.id,null).on("MSFullscreenChange."+this.id,null),this.container.classed("gm-fullscreen",!1),this.container.select(".gm-btn-fullscreen i").text("fullscreen"),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},k.prototype.help=function(){window.open("http://graspablemath.com/unstable/tutorial/index.html","_blank").focus()},k.prototype.sendFeedback=function(){window.open("mailto:contact@graspablemath.com","_blank").focus()},k.prototype.updateModeBtns=function(t){var e=this;t.auto&&this._modeButtonGroup.forEach(function(n){n.state=k.mode_name_map[n.label]===t.tool,n.state&&e.updateButton(n)})},k.prototype.updateButton=function(e){this.tools&&this.tools.select("button."+(0,A.default)(e.label)).datum(e).each(function(e){if("toggle"===e.type)e.state=!e.state,t.select(this).classed("active",e.state);else if("radio"===e.type){var n=this;t.select(this.parentNode).selectAll("button").each(function(t){t.state=n===this}).classed("active",function(t){return t.state})}})},k.prototype.appendButtonElement=function(t,e){var n=t.append("button").attr("type","button").attr("class",function(t){return"btn btn-default "+(0,A.default)(t.label)}).classed("btn-xs","xs"===this.settings.get("btn_size")).classed("btn-sm","sm"===this.settings.get("btn_size")).classed("active",function(t){return t.state});if(n.filter(function(t){return"dropdown"===t.type}).classed("toggle-dropdown",!0).attr("data-toggle","dropdown").attr("aria-haspopup","true").attr("aria-expanded","false"),e&&n.call(r.gmath.mtouch_events().on("touch",e.bind(this))),this.settings.get("display_icons")){var i,o=n.filter(function(t){return t.icon});o.append("div").style("height","24px").append("i").attr("class",function(t){return t.icon}).style("margin-top",function(t){return t.icon_name?"1px":null}).style("font-size",function(t){return t.icon_name?"1.6em":"1.2em"}).text(function(t){return t.icon_name||null}).style({color:"#555","line-height":"24px"}).style("padding-left",function(t){return"dropdown"===t.type?"0.25em":null}).style("transform",function(t){return"x"===t.flip?"rotateX(180deg)":"y"===t.flip?"rotateY(180deg)":"xy"===t.flip?"rotateZ(180deg)":null}).style("-webkit-transform",function(t){return"x"===t.flip?"rotateX(180deg)":"y"===t.flip?"rotateY(180deg)":"xy"===t.flip?"rotateZ(180deg)":null}),(i=o.filter(function(t){return"dropdown"===t.type}).select("div")).append("span").html("&nbsp;"),i.append("span").classed("caret",!0)}this.settings.get("display_labels")&&(n.append("span").text(function(t){return t.label}).style("color","#555"),this.settings.get("display_icons")||((i=n.filter(function(t){return"dropdown"===t.type})).append("span").html("&nbsp;"),i.append("span").classed("caret",!0)))},k.prototype.appendButtonGroup=function(e,n,i){if(!this.tools)throw"Can't add buttons if toolbar is disabled.";var r=i?this.tools.insert("div","*"):this.tools.append("div");if(r.attr({class:"btn-group",role:e[0].group}).classed("pull-right",e[0].pull_right),r.selectAll("button").data(e).enter().call(this.appendButtonElement.bind(this),n),1===e.length&&"dropdown"===e[0].type){var o=e[0].html_fn(r.node(),e[0]);t.select(o).attr("aria-labelledby",e[0].label).classed("dropdown-menu",!0)}return r},k.prototype.remove=function(){this.tools&&this.tools.remove(),this.tools=null,this.footer=null,this.outer_div.remove(),this.video_modal&&this.video_modal.remove(),this.controller.removeKeyboard()},k.mode_name_map={transform:"edit",keypad:"edit-keypad",scrub:"inspect",arrange:"arrange",draw:"draw",erase:"erase"},new _.SettingsType("Canvas").defaults.setAll({width:"100%",height:"100%",horizontal_scroll:!0,vertical_scroll:!0,content_min_width:"auto",parse_url_query_params:!1,parse_url_options:!0,toolbar_pos:"top",use_toolbar:!0,undo_btn:!0,redo_btn:!0,new_sheet_btn:!0,font_size_btns:!0,formula_btn:!0,help_btn:!0,fullscreen_btn:!0,homework_btn:!1,transform_btn:!0,keypad_btn:!0,scrub_btn:!0,draw_btn:!0,erase_btn:!0,arrange_btn:!0,save_btn:!0,load_btn:!0,settings_btn:!0,formulas_btn:!0,share_btn:!0,insert_btn:!0,submit_btn:!1,hwr_btn:!0,hwr:!1,feedback_btn:!1,disable_ga_tracking:!1,gm_app_name:"canvas factory",use_keyboard:!0,use_hold_menu:!0,display_icons:!0,display_labels:!0,btn_size:"sm",toolbar_on_style:{},toolbar_off_style:{display:"none"},toolFadeoutDelay:0,insert_menu_items:{derivation:!0,homework:!1,textbox:!0,function:!0,ggb_graphing:!0,ggb_geometry:!0,ggb_3d:!0,video:!0},savefile_server:"https://graspablemath.com",email_server:"https://graspablemath.com",accept_dropped_assets:!0,title_selector:"#gm-file-title",log_mouse_trajectories:!1,keyboard_max_width:800,ask_confirmation_on_closing:!0,identification_interval:!1,demo_video_sources:[],demo_video_idle_time:!1,show_welcome_tutorial:!1,disable_notifications:!1,active_tool:"edit",custom_login_method:null,enable_google_classroom:!1,enable_external_api:!1,external_component_selectors:[],overflow_visible:!1})}).call(this,n(6))},function(t,e,n){"use strict";function i(t,e,n,i){return Math.sqrt(Math.pow(n-t,2)+Math.pow(i-e,2))}function r(t,e,n,r,o){return i(t,e,n,r)<o?1:0}function o(t,e,n,i,o,s,a){var l=[];return l.push(r(t,e,n,i,a)),l.push(r(t,e,o,s,a)),l.push(function(t,e,n,i,r,o,s){var a=[r-n,o-i],l=[t-n,e-i],u=[-a[1],a[0]],c=Math.sqrt(Math.pow(u[0],2)+Math.pow(u[1],2)),d=[u[0]/c,u[1]/c],h=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)),p=[a[0]/h,a[1]/h],f=l[0]*p[0]+l[1]*p[1];if(f<=0||f>=h)return 0;var g=l[0]*d[0]+l[1]*d[1];return g>=s||g<=-s?0:1}(t,e,n,i,o,s,a)),l}function s(t,e,n,i,r){var o=[n-t,i-e],s=[-o[1],o[0]],a=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2)),l=[s[0]/a,s[1]/a];return[[t+r*l[0],e+r*l[1]],[t-r*l[0],e-r*l[1]],[n-r*l[0],i-r*l[1]],[n+r*l[0],i+r*l[1]]]}function a(t,e,n,i,r,o,s){var a=[r-t,o-e],l=[n-t,i-e],u=Math.sqrt(Math.pow(l[0],2)+Math.pow(l[1],2)),c=[l[0]/u,l[1]/u],d=a[0]*c[0]+a[1]*c[1],h=[t+d*c[0],e+d*c[1]],p=Math.sqrt(Math.pow(r-h[0],2)+Math.pow(o-h[1],2));if(0===p)f=s;else var f=Math.sqrt(Math.pow(s,2)-Math.pow(p,2));var g=[t+d*c[0]+f*c[0],e+d*c[1]+f*c[1]];return g[0]===t&&g[1]===e?null:g}function l(t,e,n,i,r,o,s){var a=[r-t,o-e],l=[n-t,i-e],u=[-l[1],l[0]],c=Math.sqrt(Math.pow(u[0],2)+Math.pow(u[1],2)),d=[u[0]/c,u[1]/c],f=a[0]*d[0]+a[1]*d[1],g=p([t,e],[n,i],[r,o]);if(h([g[0]-r,g[1]-o])>=s)return null;var m=Math.sqrt(Math.pow(s,2)-Math.pow(f,2)),v=[r-f*d[0],o-f*d[1]],y=Math.sqrt(Math.pow(l[0],2)+Math.pow(l[1],2)),b=[l[0]/y,l[1]/y],_=[[v[0]-b[0]*m,v[1]-b[1]*m],[v[0]+b[0]*m,v[1]+b[1]*m]];return _[0][0]===t&&_[0][1]===e?null:_}function u(t,e,n,i,r,o,s,a){var l,u,c,d,h,p;return-(c=s-r)*(u=i-e)+(l=n-t)*(d=a-o)==0?null:(p=(c*(e-o)-d*(t-r))/(-c*u+l*d),(h=(-u*(t-r)+l*(e-o))/(-c*u+l*d))>=0&&h<=1&&p>=0&&p<=1?[t+p*l,e+p*u]:null)}function c(t,e,n,r,o,c,d,h,p,f){var g=s(c,d,h,p,f),m=[];if(n[0]&&!n[1])m.push(a(t,e,r,o,c,d,f)),m.push(u(t,e,r,o,g[0][0],g[0][1],g[3][0],g[3][1])),m.push(u(t,e,r,o,g[1][0],g[1][1],g[2][0],g[2][1])),(v=l(t,e,r,o,h,p,f))&&m.push(v[0],v[1]);else if(!n[0]&&n[1])m.push(a(t,e,r,o,h,p,f)),m.push(u(t,e,r,o,g[0][0],g[0][1],g[3][0],g[3][1])),m.push(u(t,e,r,o,g[1][0],g[1][1],g[2][0],g[2][1])),(v=l(t,e,r,o,c,d,f))&&m.push(v[0],v[1]);else if(n[0]&&n[1])m.push(a(t,e,r,o,c,d,f)),m.push(u(t,e,r,o,g[0][0],g[0][1],g[3][0],g[3][1])),m.push(u(t,e,r,o,g[1][0],g[1][1],g[2][0],g[2][1])),m.push(a(t,e,r,o,h,p,f));else{var v=l(t,e,r,o,h,p,f),y=l(t,e,r,o,c,d,f);v&&m.push(v[0],v[1]),y&&m.push(y[0],y[1]),m.push(u(t,e,r,o,g[0][0],g[0][1],g[3][0],g[3][1])),m.push(u(t,e,r,o,g[1][0],g[1][1],g[2][0],g[2][1]))}for(var b=[t,e],_=0;_<m.length;_++)m[_]&&i(m[_][0],m[_][1],r,o)<i(b[0],b[1],r,o)&&(b=m[_]);return b[0]===t&&b[1]===e?null:b}function d(t,e,n,r,o,a,c,d,h){var p=s(o,a,c,d,h),f=[],g=l(t,e,n,r,o,a,h);g&&f.push(g[0],g[1]),(g=l(t,e,n,r,c,d,h))&&f.push(g[0],g[1]),f.push(u(t,e,n,r,p[0][0],p[0][1],p[3][0],p[3][1])),f.push(u(t,e,n,r,p[1][0],p[1][1],p[2][0],p[2][1]));for(var m=[n,r],v=[t,e],y=0;y<f.length;y++)f[y]&&i(f[y][0],f[y][1],t,e)<i(m[0],m[1],t,e)&&(m=f[y]);for(var b=0;b<f.length;b++)f[b]&&i(f[b][0],f[b][1],n,r)<i(v[0],v[1],n,r)&&(v=f[b]);return m[0]===n&&m[1]===r||v[0]===t&&v[1]===e?null:[m,v]}Object.defineProperty(e,"__esModule",{value:!0}),e.erase_paths=function(t,e,n){n=n||20;var i=[],s=function(t){var o=e[0][0],s=e[0][1],u=0,c=0;if(1!==t.length||r(t[0][0],t[0][1],o,s,n)){for(var d;u<t.length-1;){var h=t[u],p=t[u+1],f=r(h[0],h[1],o,s,n),g=r(p[0],p[1],o,s,n);if(f&&g)c=++u;else if(f&&!g){(m=a(h[0],h[1],p[0],p[1],o,s,n))?(t[u]=m,c=u):u++}else if(!f&&g){var m;(m=a(p[0],p[1],h[0],h[1],o,s,n))&&((d=t.slice(c,u+1)).push(m),i.push(d)),c=++u}else{var v=l(h[0],h[1],p[0],p[1],o,s,n);v?((d=t.slice(c,u+1))[d.length-1][0]===v[0][0]&&d[d.length-1][1]===v[0][1]||d.push(v[0]),d.length>1&&i.push(d),t[u]=v[1],t[u+1]&&t[u+1][0]==v[1][0]&&t[u+1][1]==v[1][1]&&u++,c=u):u++}}c!==u&&(d=t.slice(c,t.length))&&i.push(d)}else i.push(t)},u=function(t,r){if(t.path){n+=t.width/2;t=t.path}var s,a=e[r],l=e[r+1],u=(r=0,0);if(1===t.length&&-1===(f=o(t[0][0],t[0][1],a[0],a[1],l[0],l[1],n)).indexOf(1))return void i.push(t);for(;r<t.length-1;){var h=t[r],p=t[r+1],f=o(h[0],h[1],a[0],a[1],l[0],l[1],n),g=o(p[0],p[1],a[0],a[1],l[0],l[1],n);if(-1!==f.indexOf(1)&&-1!==g.indexOf(1))u=++r;else if(-1!==f.indexOf(1)&&-1===g.indexOf(1)){(m=c(h[0],h[1],f,p[0],p[1],a[0],a[1],l[0],l[1],n))?(t[r]=m,u=r):r++}else if(-1===f.indexOf(1)&&-1!==g.indexOf(1)){var m;(m=c(p[0],p[1],g,h[0],h[1],a[0],a[1],l[0],l[1],n))?((s=t.slice(u,r+1)).push(m),i.push(s),u=++r):r++}else{var v=d(h[0],h[1],p[0],p[1],a[0],a[1],l[0],l[1],n);v?((s=t.slice(u,r+1))[s.length-1][0]===v[0][0]&&s[s.length-1][1]===v[0][1]||s.push(v[0]),s.length>1&&i.push(s),t[r]=v[1],t[r+1]&&t[r+1][0]==v[1][0]&&t[r+1][1]==v[1][1]&&r++,u=r):r++}}u!==r&&(s=t.slice(u,t.length))&&i.push(s)};if(1===(e=function(t){if(t.path)t=t.path;var e=[];if(1===t.length)e=t;else{for(var n=0;n<t.length-1;)t[n][0]===t[n+1][0]&&t[n][1]===t[n+1][1]||e.push(t[n]),n++;0!==t.length&&0===e.length&&e.push(t[0]),t[t.length-1][0]===t[e.length-1][0]&&t[t.length-1][1]===t[e.length-1][1]||e.push(t[n])}return e}({path:e})).length){for(var h=0;h<t.length;h++)s(t[h]);t=i}else for(var p=0;p<e.length-1;p++){for(h=0;h<t.length;h++)u(t[h],p);t=i,i=[]}for(var f=0;f<t.length;f++)for(var g=0;g<t[f].length;g++)t[f][g][0]=Math.round(t[f][g][0]),t[f][g][1]=Math.round(t[f][g][1]);return t};var h=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},p=function(t,e,n){var i=[e[0]-t[0],e[1]-t[1]],r=h(i);if(r<1e-6)return t;var o=[n[0]-t[0],n[1]-t[1]],s=(i[0]*o[0]+i[1]*o[1])/r;return s<0?t:s>r?e:[t[0]+i[0]*s/r,t[1]+i[1]*s/r]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Timeline=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=n(21),s=n(5);function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var c=e.Timeline={};r.gmath.Timeline=c,c.entryTypes={},c.entry=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(var i in t=t[0],c.entryTypes){var r=c.entryTypes[i];if(r.prototype.match(t,n))return new r(t,e)}return null};var d=function(){function t(e){u(this,t),this.type=e}return i(t,[{key:"match",value:function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1],this.type===t.subtype}},{key:"undo",value:function(t){throw new Error("This is an abstract method.")}},{key:"redo",value:function(t){throw new Error("This is an abstract method.")}}]),t}(),h=function(t){function e(t,n){u(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.subtype));return i.summary=t,i.object=n.getElementByID(i.summary.el_id),t.created_elements?i.created_objects=t.created_elements.map(function(t){return{object:n.getElementByID(t)}}):i.created_objects=[],i}return l(e,d),i(e,[{key:"match",value:function(t){var e;return arguments.length>1&&void 0!==arguments[1]&&arguments[1],"rewrite"===t.subtype&&!(e=p.prototype).match.apply(e,arguments)}},{key:"undo",value:function(t){for(this.rows=[],this.packState=this.object.packState;this.object.getLastRow().idx!==this.summary.el_subid;)this.rows.push(this.object.undo());for(var e=0;e<this.created_objects.length;e++){var n=this.created_objects[e].object,i=t.removeElement(n);"derivation"===n.type&&(this.created_objects[e].links=i)}}},{key:"redo",value:function(t){for(var e=this.rows.length-1;e>=0;e--)this.object.redo(this.rows[e]);for(this.object.setPackState(this.packState),e=0;e<this.created_objects.length;e++){var n=this.created_objects[e];t.addElement(n.object),n.links&&(0,o.linkCoordinator)().addLinks(n.links)}}}]),e}();h.prototype.type="rewrite",c.entryTypes.AlgebraEntry=h;var p=function(t){function e(t,n){u(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.subtype));return i.summary=t,i.object=n.getElementByID(i.summary.el_id),i}return l(e,d),i(e,[{key:"match",value:function(t,e){return"rewrite"===t.subtype&&e.some(function(t){return"FirstLineRewriteAction"===t.action})}},{key:"undo",value:function(t){this.object.setExpression(this.summary.old_state,!0,null)}},{key:"redo",value:function(t){this.object.setExpression(this.summary.new_state,!0,null)}}]),e}();p.prototype.type="rewrite",c.entryTypes.RewriteFirstLineEntry=p;var f=function(t){function e(t,n){u(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.subtype));return i.summary=t,i.objects=[],i.objects.push(n.getElementByID(i.summary.el_id)),i.objects=i.objects.map(function(t){return{object:t}}),i}return l(e,d),i(e,[{key:"match",value:function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1],this.type===t.subtype&&("derivation"===t.el_type||"textbox"===t.el_type||"image"===t.el_type||"video"===t.el_type)}},{key:"undo",value:function(t){for(var e=0;e<this.objects.length;e++){var n=this.objects[e].object,i=t.removeElement(n);"derivation"===n.type&&(this.objects[e].links=i)}}},{key:"redo",value:function(t){for(var e=0;e<this.objects.length;e++){var n=this.objects[e];t.addElement(n.object),n.links&&(0,o.linkCoordinator)().addLinks(n.links)}}}]),e}();f.prototype.type="create",c.entryTypes.CreateEntry=f;var g=function(t){function e(t,n){u(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.subtype));return i.summary=t,i.object=n.getDeletedElementByID(i.summary.el_id),i}return l(e,d),i(e,[{key:"match",value:function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1],this.type===t.subtype&&("derivation"===t.el_type||"textbox"===t.el_type||"image"===t.el_type||"video"===t.el_type)}},{key:"undo",value:function(t){t.addElement(this.object)}},{key:"redo",value:function(t){t.removeElement(this.object)}}]),e}();g.prototype.type="delete",c.entryTypes.Entry=g;var m=function(t){function e(t,n){u(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.subtype));return i.summary=t,i.object=n.getElementByID(i.summary.el_id),i}return l(e,d),i(e,[{key:"undo",value:function(t){t.removePath(this.object)}},{key:"redo",value:function(t){t.addPath(this.object)}}]),e}();m.prototype.type="draw",c.entryTypes.DrawEntry=m;var v=function(t){function e(t){u(this,e);var n=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.subtype));return n.summary=t,n}return l(e,d),i(e,[{key:"undo",value:function(t){this.modification?(this.modification.removed.forEach(function(e){t.addPath(e)}),this.modification.added.forEach(function(e){t.removePath(e)}),this.modification.modified.forEach(function(t){t.path.points=t.points_before,t.path.emitChangeEvent(),t.path.update()})):console.warn("erase modification was not set")}},{key:"redo",value:function(t){this.modification.removed.forEach(function(e){t.removePath(e)}),this.modification.modified.forEach(function(t){t.path.points=t.points_after,t.path.emitChangeEvent(),t.path.update()}),this.modification.added.forEach(function(e){t.addPath(e)})}}]),e}();v.prototype.type="erase",c.entryTypes.EraseEntry=v;var y=function(t){function e(t,n){u(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.subtype));return i.summary=t,i.object=n.getElementByID(i.summary.el_id),i}return l(e,d),i(e,[{key:"match",value:function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1],this.type===t.subtype&&("derivation"===t.el_type||"textbox"===t.el_type||"image"===t.el_type||"video"===t.el_type)}},{key:"undo",value:function(t){this.object.translateElement(JSON.parse(this.summary.old_state))}},{key:"redo",value:function(t){this.object.translateElement(JSON.parse(this.summary.new_state))}}]),e}();y.prototype.type="move",c.entryTypes.MoveEntry=y;var b=function(t){function e(t,n){u(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.subtype));return i.summary=t,i.object=n.getElementByID(t.element.id),i}return l(e,d),i(e,[{key:"match",value:function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1],this.type===t.subtype&&!this.startingAndEndingPackStateAreTheSame(t)}},{key:"startingAndEndingPackStateAreTheSame",value:function(t){for(var e=t.element.old_state,n=t.element.new_state,i=0;i<e.length;i++)if(e[i]!==n[i])return!1;return!0}},{key:"undo",value:function(t){this.object.setPackState(this.summary.element.old_state)}},{key:"redo",value:function(t){this.object.setPackState(this.summary.element.new_state)}}]),e}();b.prototype.type="pack-dl",c.entryTypes.PackEntry=b;var _=function(t){function e(t,n){u(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.subtype));return i.summary=t,i.object=n.getElementByID(i.summary.target_id),i}return l(e,d),i(e,[{key:"undo",value:function(t){this.links=t.removeElement(this.object)}},{key:"redo",value:function(t){t.addDL(this.object),(0,o.linkCoordinator)().addLinks(this.links)}}]),e}();_.prototype.type="clone",c.entryTypes.CloneEntry=_;var x=function(t){function e(t,n){u(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.subtype));return i.summary=t,i.object=n.getElementByID(i.summary.el_id),i}return l(e,d),i(e,[{key:"undo",value:function(t){var e=this.object.rows[0].model;e.replace_with(new s.AlgebraModel(this.summary.old_state,e.settings.getAll())),this.object.rows[0].updateDimensionAfterInteraction(),this.object.updateDims(),this.object.rows[0].view.update_existing()}},{key:"redo",value:function(t){var e=this.object.rows[0].model;e.replace_with(new s.AlgebraModel(this.summary.new_state,e.settings.getAll())),this.object.rows[0].updateDimensionAfterInteraction(),this.object.updateDims(),this.object.rows[0].view.update_existing()}}]),e}();x.prototype.type="scrub",c.entryTypes.ScrubEntry=x;var w=function(t){function e(t,n){u(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.subtype));return i.summary=t,i.textbox=n.getElementByID(i.summary.el_id),i}return l(e,d),i(e,[{key:"match",value:function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1],this.type===t.subtype&&"textbox"===t.el_type}},{key:"undo",value:function(t){this.textbox.setText(this.summary.old_state)}},{key:"redo",value:function(t){this.textbox.setText(this.summary.new_state)}}]),e}();w.prototype.type="edit",c.entryTypes.TextEditEntry=w;var A=function(t){function e(t,n){u(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.subtype));return i.summary=t,i.canvasElement=n.getElementByID(i.summary.el_id),i}return l(e,d),i(e,[{key:"undo",value:function(t){this.canvasElement.resizeElement(JSON.parse(this.summary.old_state))}},{key:"redo",value:function(t){this.canvasElement.resizeElement(JSON.parse(this.summary.new_state))}}]),e}();A.prototype.type="resize",c.entryTypes.ResizeEntry=A},function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.CanvasController=function(e){var n,o,g,m=t.dispatch("scroll","start_hwr","stop_hwr","undone","redone","hold","touch","drag","release","font_size","keyboard","entered_term","start-of-interaction","end-of-interaction","undoable-action","undoStackChanged"),v=s.gmath.uid(),y=e,b=null,_=[],x=-1,w=null,A=!1,k=!0,T=1500,S=null,M=y.paths().length,E=2,N=50,O="black",q=null,C={},P=null,j=!1,D=null,I=!0,F=!0,L=["derivation","textbox","graph"],z=800,R=!1,B=!0,H=function n(){return e.on("create."+v,function(t){"derivation"===t.target_type||"graph"===t.target_type||"textbox"===t.target_type||"image"===t.target_type?(t.target.events.on("start-of-interaction."+v,function(e){y.setActive(t.target),e.source&&"derivation"===e.source.type&&"inspect"===y.getActiveTool()&&d.Derivation.hideTermTraces(y.back_svg(),y.html_container()),m["start-of-interaction"](e)}),t.target.events.on("end-of-interaction."+v,function(t){!t.source||"AlgebraModel"!==t.source.type&&"derivation"!==t.source.type||"inspect"!==y.getActiveTool()||d.Derivation.drawTraces(y.getElementsOfType("derivation")),m["end-of-interaction"](t)}),"derivation"===t.target_type&&(t.target.events.on("inspect_node."+v,function(t){t.shiftKey||y.clearAllTermTracesExcept(t.dl)}),t.target.events.on("change."+v,function(t){"inspect"===y.getActiveTool()&&d.Derivation.hideTermTraces(y.back_svg(),y.html_container())}))):"ggb-element"===t.target_type&&(t.target.element_div.on("dragstart",function(e){n.GGBElementThatDragStartedOn=t.target},!0),t.target.element_div.on("dragend",function(t){n.GGBElementThatDragStartedOn=null},!0))}),q=(0,a.transform_behavior)().allow_rotate(!1).allow_scale(!1).one_finger_drag(!1).on("transform",function(){y.scrollX(-t.event.transform.translate[0],!1),y.scroll(-t.event.transform.translate[1],!1)}),F&&!D&&y.container()&&(D=new p.holdUI(n,y)),$(e.background_event_layer(),function(){return s.gmath.mtouch_events().on("touch",K.bind(this,null)).on("hold",J.bind(this,null)).on("drag",Z.bind(this,null)).on("tap",function(){y.clearAllTermTracesExcept(),y.setActive(null)}).on("release",Y.bind(this,null)).hold_max_dist(5).hold_time(500).call(q)}()),$(e.foreground_event_layer(),function(){return s.gmath.mtouch_events().on("touch",X.bind(this,null)).on("drag",tt.bind(this,null)).on("release",et.bind(this,null)).hold_max_dist(5).hold_time(500)}()),e.on("active_tool."+v,V),t.select(document).on("keydown."+v,function(e){27===(e||t.event).keyCode&&(y.setActive(),y.setActive(null,!1),y.clearAllTermTracesExcept())}.bind(this,null)),window.addEventListener("beforeunload",function(t){if(B&&R){var e="You have not saved your work. Are you sure you want to leave the page?";return(t||window.event).returnValue=e,e}}),I&&void 0!==s.gmath.ui.Keyboard&&void 0!==i&&(w=s.gmath.ui.Keyboard()).width(z).position("center")(),y.container().on("dragover",function(){t.event.preventDefault()}).on("drop",function(){n.handleDrop()}),this};H.GGBElementThatDragStartedOn=null,H.needsSaving=function(t){return 0===arguments.length?R:(R=t,this)},H.askConfirmationOnClosing=function(t){return 0===arguments.length?B:(B=t,this)},H.insertElementFromInsertButton=function(t){w&&w.abort(),H.simulateStartOfInteraction();var e="auto",n={};n.pos=e,n.select_on_create=!0,n.select_text_on_create=!0;var i=!0;switch(t){case"derivation":H.inputDL(e,"toolbar"),i=!1;break;case"function":H.inputDL(e,"toolbar"),i=!1,w&&(w.latex("f[x]=x"),w.moveToRightEnd(),w.keystroke("Left Shift-Right"));break;case"textbox":y.createElement("textbox",n);break;case"graph":y.createGraph({pos:e});break;case"ggb-graphing":H.insertGGB(e,"graphing");break;case"ggb-3d":H.insertGGB(e,"3d");break;case"ggb-geometry":H.insertGGB(e,"geometry");break;case"ggb-table":G(e);break;case"table":y.createElement("table",{pos:e});break;case"video":y.createElement("video",{pos:e},"toolbar");break;default:console.warn("unknown element type",t)}i&&H.simulateEndOfInteraction()},H.closeKeyboard=function(){w&&w.abort()},H.insertGGB=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"classic",n="auto"===t?"auto":{x:"number"==typeof t.x?t.x-300:t.x,y:"number"==typeof t.y?t.y-200:t.y},i=y.createElement("ggb-element",{ggb_app_name:e,pos:n,size:{width:600,height:400}},"toolbar");return y.createElement("ggb-panel",{ggbElement:i},"toolbar"),i};var G=function(t){var e="auto"===t?"auto":{x:"number"==typeof t.x?t.x-300:t.x,y:"number"==typeof t.y?t.y-300:t.y},n=y.createElement("ggb-element",{pos:e,size:{width:600,height:600},ggb_params:{showMenuBar:!1,showAlgebraInput:!1,showToolBar:!0,customToolBar:"0|40",showResetIcon:!1,enableLabelDrags:!1,enableShiftDragZoom:!1,enableRightClick:!1,errorDialogsActive:!1,useBrowserForJS:!0,preventFocus:!1,language:"en"},ggb_base64:"UEsDBBQACAgIALyC9kgAAAAAAAAAAAAAAAAWAAAAZ2VvZ2VicmFfamF2YXNjcmlwdC5qc0srzUsuyczPU0hPT/LP88zLLNHQVKiu5QIAUEsHCEXM3l0aAAAAGAAAAFBLAwQUAAgICAC8gvZIAAAAAAAAAAAAAAAAFwAAAGdlb2dlYnJhX2RlZmF1bHRzMmQueG1s7ZpLb9s4EIDP219B6NQ9xJZky3aCOEVaYLEB0nSxCYq90tJY5oYitSIVy/n1S5F6OX7UVtzEbXMxOfTw9c1wSFE6/5BFFD1AIghnY8vp2BYC5vOAsHBspXJ6MrI+XLw7D4GHMEkwmvIkwnJseblmVU9JHdfr5WUoE+SM8RscgYixD7f+DCJ8zX0stepMyvis253P552y0Q5Pwm4Yyk4mAgupATExtorMmWpuqdK8p9Vd23a6/3y+Ns2fECYkZj5YSA02gClOqRQqCxQiYBLJRQxja5oyPx/FzVecWIjiCdCxxVJKLVTUGVsDz7p499u5mPE54pN/wVdlMkmh0tdCN9dRf3/ilCcoGVuu3beQQqYITPQvpvEMq1xn6BltiheQoAdM8791CU4l93UDunSKqYBSV3X1mQdg/ukX+oxEmiISEmJlLQuJGCDQOTND1XGsOtLWq9o77xYYVoBQImQ1sWstVCCcnr1KwrS5HYWtQTj2UxQnuXdp7UlYc/M8ra7TSZEWFfL8K6NT7REGt3JBAckZ8e8ZCOWcbqNSnvmTBAHk68fUiTlh8pY8FmPwmqW6KV184mw3TszpIuSsov1XKVcmGhoLtRnivv7teD1tJ89ZcXDntY20HWFOZ4mhKaghOi8G0d4QIuxjJqictoFPSej9NAH4vRkq1kSKPXE01/3LAnHWr3uf8yQQKBtbN/jGQosifTTpHsvcbgE4gBiY8jS5RNlpRXkw0pjzZGKSHxtz71CYvzRDqeO2guu4ZvvS6ZsbL/G9Yn9DSJY2LKf3RvnAlJe9uP9LBmKtYiiK/Hds+TyKKWQHRE+5n4r6rGykCvzo+TvgUR0I8p4yQglOFqs97X1S2vYA0jicXS8fzNyfjukOrtzmGAr/sSXnJ8r3iU/kdvQCwlyqaN6Wcm2AdgeOX88APJU07+uKSUgE6DsGsTKZe4D4TlX+wu4SzER+k2J0SoybbbXLxYXbbm/dHPvdV3/6/jaQjTCevxEemeseMuomeLFt2be7ATtidj/qsn9QbfJ6wX8txMpS627o3iy1xlJrDog4kSAIZtstICGrd8g7LTRuPY4S/+bJ+JwRvxrcJyNV0+kf5Wxe+uoWSAjMrDuBUGYX70QWtpkTeixLMqcoWThFyWOR0e2oISckQ5dlvctS/dItM70y0y8zXgNcu0OdNnGsfLsR358EjX67U90xXwD/xKZ+gV1GMQ9r618ZqXHraOLClKgBMhypCqZHwj5i/z5MeMqCleEcJoo4rx9FNmNjaQRJI57elHKFzjPk1DDS8o6hnNAuEdT51kwFJYHCEhHl0yfq5B7hLL/dQHgiOE0l3PoJAKtfvRo7zEkgZ/nTtXbErHTtIp2SLIdiVGc8IY+cycqPUG7XS6rf2jZN2Wb5PbVIPuHn2gSzkNaudmmk2h7mjlcrPb34WW+mJmG7ADzouKOeM/J69tAZnnqjwY7AndEBgR/spewBo/deTuAWfSR+42bf3uQZ9mjoDgb9geudng6dQX/4bE+ZcE4B18+PH0u58UZgZfluCnC7G+A7npP8Gfj3E54tedR+D9F/VAX15xCvcypshJaXOCn0dn2O7ja+LemW369c/A9QSwcILVCearIEAABGIwAAUEsDBBQACAgIALyC9kgAAAAAAAAAAAAAAAAXAAAAZ2VvZ2VicmFfZGVmYXVsdHMzZC54bWztl8lu2zAQhs/NUxC8R6uVDVYCIz20QBK0yKVXmhrLbCVSIelFebW+Q5+pFEU6yuIUNVy0BXIxh8PhkPp+ciSPL9Z1hZYgFRM8x3EQYQScioLxMscLPTs8wRfnB+MSRAlTSdBMyJroHGdd5Gae6QVJlnY+tFbsjIsbUoNqCIVbOoeaXAlKtA2da92cheFqtQp80kDIMixLHaxVgZHZEFc5dsaZSfdo0iq14UkUxeGX66s+/SHjShNOASOz2QJmZFFpZUyooAaukW4byHFTEQ6pWaMiU6hy/Mn232PkZuQ4NXnx+cG7sZqLFRLTr0CNV8sFbCbZTtjFmOFLUQmJZI5PTzEyxJLYtFPXkqqZkxxHQdbHV6QFiZbEJIl6D1loQW0K652RSoGPNYtdiwL6kVHvpULIQqF1l9Swbl1779pV39rQGek0dKsFscvKONzqtgKk54x+46BUtxeHxxkfWFFAdxi6OePQIXwGkwrO6ADmR67NcTC8jMyILuQShlzjbDeuSZZZsHFybMFGA6zxvrASzmp7PJHS0HRPjlQDUFhrw8acntZei2G+l4AmrwF9NwZWAl8aAEIqc10id+3ayKvpPevY6xw7z70zbB6zZcnWaOLnTXz4JPFG6o2RN7LBEYE73u9ddb85ZnVTMcr067qTNVMD2Sdd99EViqN0J6kjK3T0TOboP5X5Cd2GSFMTjWTUrNHbYJ76x/dfXLPuJlEiNShG+AD8ZTfwlPzRG/ntKBtRtXMopOAPb4CB64Fj6l4Cu8j+u+zjLLX0s/gZ/tHfxr8d5d2CFPYku2f77PtDiPFuFT8abTmOx3t7j/6psh1tL9v9kK/MrTfukz1VdDQ58saxN068cbq5zdslVQs5M99rL5UaN/RY3dE/q+6eq028W7XhoDcsbjp7CC97qy9P4IWDr/bQ/zM4/wlQSwcIDmF7u7sCAACgDAAAUEsDBBQACAgIALyC9kgAAAAAAAAAAAAAAAAMAAAAZ2VvZ2VicmEueG1s3Vptc9s2Ev6c/goMP92LJQEgQYoZKR3biXuZSZvMOe3c3De+QBJjimRJypY7/fG3C4AUJdmKaTs5ubZpkCCwwD7PYncBafLjepmSa1lWSZ5NLTakFpFZlMdJNp9aq3o2GFs/vvlhMpf5XIZlQGZ5uQzqqSWwZdsPnoZc2FiXxFPLphELPEcOZOi5AycM/YEfRs5gFvoeE44nZjPbImRdJa+z/JdgKasiiORltJDL4EMeBbUSuqjr4vVodHNzM2yGH+blfDSfh8N1FVsEpp5VU8vcvAZxW51ubNWcU8pG//n5gxY/SLKqDrJIWgTVWiVvfng1uUmyOL8hN0lcL6aW7/kWWchkvgA9PZ9ZZISNClC2kFGdXMsKunYelc71srBUsyDD96/0HUlbdSwSJ9dJLMupBWBRh/uU+sy3qXCY7VkkLxOZ1aZxM+ioETe5TuSNlot3akiH+tDvOqmSMJVTaxakFaiVZLMSIIUZlSt4rOrbVIZB2TxvJsRO1C80Sf6QKA3Y00hMrbHDTmzhn3iUnghB9Ww6QwvGLVLneaokU/InYURQuAjzyQlxPajhhAniQM0YajxiY51gDrEJNmE2cRwoHaxmLr4T0F9QwhhUE04J54Qzwm14FIIIlwgPO3Jo6/pKGIULW8N04LKxzrbhUnW2AxfHOxAktBiYhLBddSewNcgXHKevKu0xcXwYCCuEx4gNc4BnjxKQaKN4ppRwKME/RhwUzz3CxwTkgd4omfIDpJjnDSumYoeWhhTRJYUBGXi5cCm2dkhxtikBBijodoIF0wVO13X1K6rrqK0LrgtHF0K3cXR3RzfV2lJHt3Hsp6rZKGn3UXLcUZKhEkAKzl4VNsF5MzV/LBzz6OpHZWqUUVM7xn8+PgAm7ljdPFEn+1E6sc6oepX2GbQZ0nfHDx/yaTbaqsnvUpOLe9R8IrrNoEx0BoWx1J+69oa0e+m55yEfMaK7tQqf4p4fMbhH73QBumSmPATJs01qMmoC1sRMiFQLbGvsu5bLCqdo+23scNG7mwDi8U4AOcEQ4opNFMEYMt6KImLcCSUQR1ys9FRcgjEwEOiwwp0mspyY2PLnXmyBUOBsogFMDUWhnzHhAEbn3YDAwXlw4qEfheiGfoRwEMkJxBEX+90TKyxS5FXS4rqQadESoiBMsmJVG9hMfbSMGwjrHJoHqcqLTIc4j67OdpCWQVU399AIMopN4qIzjK285tUkDUKZQvp3iUZAyHWQoh0r+bM8q0ljANxS4lQKNZGrKE3iJMh+A9abdOWX1TKUJVG3OeqohGB30uZa6LPaXIvaukmU52V8eVuBkZD1f2UJnR0PctPuD8B3q1/ZXAz9zg9IrKIArdvxt174Y+x03zs9tLy+lHUN6lckWMuqQW5e4vIyJODD++osTzdVRZ5k9XlQ1KtSZc7gIEtU6jSbp1IhqTiGFDS6CvP1pXaerpb1+baQLcbh/DxP85LA4uNCQANThrpUbXBmbSuq2lDVwshAoe175nPVQpWhLlUrIFlPzWjKGjVpM0pSEf28ZVHKQDCfXWVJ/aF5qJPoaqMottf0NxBui2TPJHIy2rG8yZUsM5lqK8qAyFW+qrQRa6rUPFaV/BTUi9Ms/recwwL8FKD7q0G0brqZcSyjZAkddb1BLkBWf4Wp6tpYzkvZaKgXpMbVrB1SFaUM4mohZd2iq22822wj+qLMl++z689gQjtTn4wa/SZVVCYFWioJwT9fyY0xxkkVgHePu/0AjAq0itDdALA1gmqRYFUv8lLtTYIaa3Apr2G2Fe7rNC1kai3BjazB2wzU+pzIVC5hq0JqZbfZainLJGpJXKptEEx7ZTQb4L5QL32gkOThF/A2m/iue20Qh/f32DYJ0mIR4PbJuJI0uEX/0oFPSfs5j83QrAEVOFSag0sptDUVUmo7rM3qIwWIU4u3g7ZR9W5YQgMLfwAq4S4q/K8ICgQkg8ktmZK/Lck/yPrv5J8kbCSiz9FxaBsuXd/K2MNly00YkOQ1bnkeDA99IDzd9VmRNfhyPNa4NYcjf4A9t9RtPGi9AF8FO/VKZdYtenjzrySOZdbCLn/PdJdKezZAK02ipN6FNsqXyyCLSabysk8YX6xNUhBQhEnrvqqbmlMtxHTdA1kFqRbF032Ut61vH2ZwInGiTQa6fTS9yn0OGNeRS5Umcj2UiY+zWSVrBH6sYWeHaHqAFbO7rLhLMPBpq6EGzpD6imPWTFJhhuFajyq6tTvO+6nsnfVh76z3GvmLkseGtnA0e8Cjy78BfR9LiJLzPAvSD+imtnk8A2zY1FqfQmqzR2l0mNItrxd9bT32iwaPdncDZvwdNf5OI/xsDi9ZPsThHcT89BDmcQ/M42PFXLmkI4T89k7IZQ/I5bFATg3kgzauK+9/TKCfHQJ91gP02fGCrp32d0b9fYZ7PcBhB3B5CPDzPvH5/EGI35fD4qnIXBehLp4T+69mOfajwuR9oM4Ogfq2D6hvjxjUrycfz4tqdCgGvuuD6rujQ7WT022SkO8BanwI1Is+oF4cHaibXc63wfRSzrF+B9FzjejbPTTnh9GsjLQGrvm32+80x6x949xmrzOwtbW6dzLB95wGUMHHW/kePXikIA7HQEA1xR1Sa9Wg9P6Z55WUBZ40f8w+l0FW4Rc5tg87+1L7TlN7sUftoh+1i29HbTeB6bONPbCMaJupu57ofoDgvVgi32oiz/aITPoRmXwfIp8lE21oNKFGbbk8n/nO+AB9dkMfPyr+jI893ePvSz/+vrxA/nRUA/rGQ5ty7+WR9+6+xXfVj7yrF0SeyZU78W/wclffxX2rL+1HYPqCCNQ7yC5/x7/8HnYI/1OfJP+nZ6Ks2KfsKYfwXz1nx88KH/MxiT02uzIxZIJ1k59nOXXfhjrM81QGWQtmsfsJ6ubM6v92sGW+zkFmyVrGdxvhYaXKl6nUqPt1AvUtIPMF7Tf/A1BLBwiaLk/eqggAAFEuAABQSwECFAAUAAgICAC8gvZIRczeXRoAAAAYAAAAFgAAAAAAAAAAAAAAAAAAAAAAZ2VvZ2VicmFfamF2YXNjcmlwdC5qc1BLAQIUABQACAgIALyC9kgtUJ5qsgQAAEYjAAAXAAAAAAAAAAAAAAAAAF4AAABnZW9nZWJyYV9kZWZhdWx0czJkLnhtbFBLAQIUABQACAgIALyC9kgOYXu7uwIAAKAMAAAXAAAAAAAAAAAAAAAAAFUFAABnZW9nZWJyYV9kZWZhdWx0czNkLnhtbFBLAQIUABQACAgIALyC9kiaLk/eqggAAFEuAAAMAAAAAAAAAAAAAAAAAFUIAABnZW9nZWJyYS54bWxQSwUGAAAAAAQABAAIAQAAOREAAAAA"});return n.events.on("ggb_init",function(){n.ggbApplet.setCoordSystem(-10,10,-10,10),y.elements().forEach(function(t){"table"==t.type&&t.setGraph(n)})}),n};function V(t){"edit-keypad"===t.prevTool&&"edit"===t.tool&&t.auto||!w||w.abort(),"edit"===t.tool&&w&&w.on("done.go-to-edit-mode",null),"arrange"===t.tool&&y.setActive(null),"draw"===t.tool||"erase"===t.tool?(y.foreground_event_layer_visible(!0),y.setActive(null)):y.foreground_event_layer_visible(!1),"edit-keypad"===t.tool&&w&&w.on("done.go-to-edit-mode",function(){y.setActiveTool("edit",!0)}),"inspect"!==t.tool&&y.clearAllTermTracesExcept()}H.id=v,H.logger=function(t){(b=t).events.on("interaction."+v,this.addInteractionSummaryToTimeline.bind(this))},H.model=function(){if(0===arguments.length)return y},H.use_keyboard=function(t){return 0===arguments.length?I:(I=t,this)},H.keyboard_max_width=function(t){return 0===arguments.length?z:(z=t,this)},H.use_hold_menu=function(t){return 0===arguments.length?F:(Array.isArray(t)&&H.hold_menu_options(t.filter(function(t){return-1!==L.indexOf(t)})),(F=!!Array.isArray(t)||t)&&!D&&y.container()&&(D=new p.holdUI(H,y)),this)},H.hold_menu_options=function(t){if(0===arguments.length)return L;L=t},H.color=function(t){return 0===arguments.length?O:(O=t,this)},H.markerRadius=function(t){return 0===arguments.length?E:(E=t,this)},H.eraserRadius=function(t){return 0===arguments.length?N:(N=t,this)},H.hwr_delay=function(t){return 0===arguments.length?T:(T=t,this)},H.hwr=function(t){return arguments.length?k===t?H:(k=t,M=y.paths.length,k||H.cancelHWR(),H):k},H.drawing=function(t){return arguments.length?(n=t,this):n},H.scheduleHWR=function(){S||(S=setTimeout(H.performHWR,T),m.start_hwr())},H.cancelHWR=function(t){t||(M=y.paths.length),S&&(clearTimeout(S),S=null,m.stop_hwr())},H.performHWR=function(){if(S=null,m.stop_hwr(),!(M>y.paths().length-1)){var t=y.paths().slice(M),e=[];gm_hwr_request(t,function(n,i){n&&console.log(n);var r=t[0].points[0];try{y.createDL({pos:{x:r[0],y:r[1]},eq:i})}catch(t){return}for(var o=function(t){try{y.removePath(t),e.push(t)}catch(t){return}},s=0;s<t.length;s++)o(t[s]);M=y.paths().length}),M=y.paths().length}},H.font_smaller=function(){var t=parseInt(y.fontSize());t/1.2>24&&this.set_font_size(t/1.2)},H.font_larger=function(){var t=parseInt(y.fontSize());1.2*t<160&&this.set_font_size(1.2*t)},H.set_font_size=function(t){y.fontSize(t),y.dls().forEach(function(t){return t.render(!1)}),"inspect"===y.getActiveTool()&&d.Derivation.drawTraces(y.getElementsOfType("derivation")),m.font_size(new Q(t))};var U=function(t){this.type="drag",this.subtype=t.subtype,this.performee=v,this.performee_type="CanvasController",this.time=Date.now(),this.finger={pos:[t.finger.pos[0],t.finger.pos[1]]},this.fingers=t.fingers.map(function(t){return{pos:[t.pos[0],t.pos[1]]}})},W=function(t){this.type="release",this.subtype=t.subtype,this.performee=v,this.performee_type="CanvasController",this.time=Date.now(),this.finger={pos:[t.finger.pos[0],t.finger.pos[1]]},this.fingers=t.fingers.map(function(t){return{pos:[t.pos[0],t.pos[1]]}})},Q=function(t){this.type="fontSize",this.performee=v,this.performee_type="CanvasController",this.time=Date.now(),this.font_size=t};function $(t,e){t.call(e),e.frame(t.node())}var K=function(e){if(F&&!j){var n=e||t.event;!e&&t.event&&m["start-of-interaction"]({type:"start-of-interaction",source:{type:"CanvasController",id:v},time:Date.now()}),n.fingers.length>1&&(j=!0)}};H.menu_touch=K;var J=function(e){if(!(!F||j||I&&w.visible())){var n=e||t.event;!e&&t.event&&m.hold(new function(t){this.type="hold",this.subtype=t.subtype,this.performee=v,this.performee_type="CanvasController",this.time=Date.now(),this.finger={pos:[t.finger.pos[0],t.finger.pos[1]]},this.fingers=t.fingers.map(function(t){return{pos:[t.pos[0],t.pos[1]]}})}(s.gmath.extend(t.event,{subtype:"menu"}))),y.setActive(),o=n.finger.pos.slice(),D.setPos(n.finger.pos_client.slice()),D.setVisible(!0)}};H.menu_hold=J;var Z=function(e){if(!j&&F&&D.visible){var n=e||t.event;!e&&t.event&&m.drag(new U(s.gmath.extend(t.event,{subtype:"menu"}))),D.visible&&D.highlight(n.finger.pos_client.slice())}};H.menu_drag=Z;var Y=function(e){var n=e||t.event;!e&&t.event&&m.release(new W(s.gmath.extend(t.event,{subtype:"menu"}))),j?0===n.fingers.length&&(j=!1):(D&&D.visible&&(D.performAction(n.finger.pos_client.slice(),o),D.setVisible(!1)),e||!t.event||w&&w.visible()||H.simulateEndOfInteraction())};H.menu_release=Y;var X=function(e){if(n){var i=e||t.event;!e&&t.event&&(H.simulateStartOfInteraction(),m.touch(new function(t){this.type="touch",this.subtype=t.subtype,this.performee=v,this.performee_type="CanvasController",this.time=Date.now(),this.finger={pos:[t.finger.pos[0],t.finger.pos[1]],pos0:[t.finger.pos0[0],t.finger.pos0[1]]},this.fingers=t.fingers.map(function(t){return{pos:[t.pos[0],t.pos[1]]}})}(s.gmath.extend(t.event,{subtype:y.getActiveTool()}))));var r=i.finger.pos0.slice();r[1]-=0,H.cancelHWR(!0);var o=[[r[0],r[1]]],a=null;"draw"===y.getActiveTool()?a=y.createPath({points:o,color:O,width:2*E}):"erase"===y.getActiveTool()&&((a=new c.Path(y.front_svg().node(),{points:o,color:"white",width:2*N})).head=y.front_svg().append("circle").attr({cx:r[0],cy:r[1],r:N}).style({stroke:"silver",fill:"white"})),C[i.finger.id]=a}};H.draw_touch=X;var tt=function(e){if(n){var i=e||t.event;!e&&t.event&&m.drag(new U(s.gmath.extend(t.event,{subtype:y.getActiveTool()})));var r=C[i.finger.id],o=i.finger.pos.slice();r&&(o[1]-=0,r.points.push(o),"draw"===y.getActiveTool()?(r.emitChangeEvent(),r.update()):"erase"===y.getActiveTool()&&(r.update(),r.head.attr({cx:o[0],cy:o[1]})))}};H.draw_drag=tt;var et=function(e){if(n){var i=e||t.event;if(!e&&t.event&&m.drag(new W(s.gmath.extend(t.event,{subtype:y.getActiveTool()}))),"draw"===y.getActiveTool())C[i.finger.id].emitChangedEvent(),!k||w&&w.visible()||H.scheduleHWR();var r=C[i.finger.id];"erase"===y.getActiveTool()&&(nt(r),r.head.remove(),r.remove()),delete C[i.finger.id],!e&&t.event&&m["end-of-interaction"]({type:"end-of-interaction",source:{type:"CanvasController",id:v},time:Date.now()})}};H.draw_release=et;var nt=function(t){var e=[],n=[],i=[];y.paths().slice().forEach(function(r,o){var s=N+r.width/2,a=(0,u.erase_paths)([r.points],t.points,s);if(0===a.length)n.push(r),y.removePath(r);else{i.push({path:r,points_before:r.points.slice(),points_after:a[0].slice()}),r.points=a[0],r.emitChangedEvent(),r.update();for(var l=1;l<a.length;l++){var c=y.createPath({points:a[l],color:r.color,width:r.width,oid:r.id});e.push(c)}}}),g={removed:n,modified:i,added:e}};H.addInteractionSummaryToTimeline=function(t,e){if(1!==t.length||"rewrite"!==t[0].subtype||t[0].new_state&&t[0].new_state!==t[0].old_state||t[0].created_elements){R=!0,1===t.length&&"save"===t[0].subtype&&(R=!1);var n=l.Timeline.entry(t,y,e);n&&("erase"===n.type&&(n.modification=g,g=null),_[++x]=n,_.length=x+1,m.undoStackChanged(_,x),m["undoable-action"](n.type,n))}},H.reset=function(){b.listen(!1),y.reset(),b.canvas_logger.reset(),_=[],x=-1,m.undoStackChanged(_,x),q.transform({translate:[0,0]}),C={},P=null,j=!1,R=!1,b.listen(!0)},H.undo=function(){if(-1===x)return!1;b.listen(!1);var t=_[x];return x--,m.undoStackChanged(_,x),t.undo(y,this),d.Derivation.hideTermTraces(y.back_svg(),y.html_container()),b.listen(!0),!0},H.redo=function(){if(_.length<=x+1)return!1;b.listen(!1);var t=_[++x];return m.undoStackChanged(_,x),t.redo(y,this),b.listen(!0),!0},H.undoLocalOnlyTransactions=function(){for(;x>=0&&_[x].localOnly;)this.undo(),_.splice(x+1,1),m.undoStackChanged(_,x)},H.clearInteractionTimeline=function(){x=-1,_=[],m.undoStackChanged(_,x)},H.clear_undo_queue=function(){throw"(CanvasController) Deprecated method `clear_undo_queue` called."},H.getCopyOfUndoStack=function(){return{undoStack:_.slice(),currentUndoStackPosition:x}};var it=function(){rt(),H.simulateEndOfInteraction()};function rt(){w&&w.caption("").latex("").on("done",null).on("cancel",null).visible(!1)}function ot(t,e){var n={drop_evt:t,pos:e};y.createElement("image",n,"drag-n-drop")}function st(t){if("{"!==t[0]||"}"!==t[t.length-1])return t;for(var e=!0,n=0,i=0;i<t.length;i++)"{"===t[i]&&(n+=1),"}"===t[i]&&(n-=1),0===n&&i!==t.length-1&&(e=!1),i===t.length-1&&0!==n&&(e=!1);return e?st(t.substr(1,t.length-2)):t}return H.inputDL=function(t,e,n){A||(m.keyboard(new function(){this.type="keyboard",this.performee=v,this.performee_type="CanvasController",this.time=Date.now()}),H.cancelHWR(!0),P={pos:"auto"===t?"auto":{x:t.x,y:"number"==typeof t.y?t.y-0:t.y},v_align:"center",h_align:"equals",select_on_create:"toolbar"===e},w.caption(null).on("done",function(t){!function(t,e,n){if(P)if(""!==t)if(P.eq=t,P.id=s.gmath.uid(),m.entered_term(new function(t){this.type="enteredTerm",this.performee=v,this.performee_type="CanvasController",this.time=Date.now(),this.eq=t.eq,this.dl_id=t.id,this.options=s.gmath.deepCopy(t)}(P)),h.AlgebraModel.isParsable(t)){var i=void 0;try{i=y.createDL(P,null,e),P=null,n&&n(i)}catch(t){return console.log(t),void w.warning("Could not parse expression.",null)}rt(),m["end-of-interaction"]({type:"end-of-interaction",source:{type:"CanvasController",id:v},time:Date.now()})}else w.warning("Could not parse expression.",null);else rt()}(t,e,n)}).on("cancel",it),(0,f.default)(w,""))},H.disableKeyboard=function(t){A=t},H.removeKeyboard=function(){w&&w.remove()},H.simulateStartOfInteraction=function(){m["start-of-interaction"]({type:"start-of-interaction",source:{type:"CanvasController",id:v},time:Date.now()})},H.simulateEndOfInteraction=function(){m["end-of-interaction"]({type:"end-of-interaction",source:{type:"CanvasController",id:v},time:Date.now()})},H.handleDrop=function(e){var n=e||t.event;if(n.preventDefault&&n.preventDefault(),y.willAcceptDroppedElements()){var i,o,s,a=y.container().node(),l=a.getBoundingClientRect(),u=[n.clientX-l.left-a.clientLeft,n.clientY-l.top-a.clientTop],c=void 0,d=n.math_str||(i=n.dataTransfer.getData("text/html"),o=document.createElement("div"),1===(s=t.select(o).html(i).select("img")).size()?s.attr("alt"):null)||n.dataTransfer.getData("text/plain");if(d)if("http"===d.slice(0,4))g={drop_evt:d,pos:{x:u[0],y:u[1]}},H.simulateStartOfInteraction(),y.createElement("image",g,"drag-n-drop"),H.simulateEndOfInteraction();else if(c=this.GGBElementThatDragStartedOn){var p=c.ggbPanel;p.dropGGBObject(p.getGGBObject(d),{x:u[0],y:u[1]})}else{var f=function(){for(console.log("dropped",d),d=(d=(d=(d=(d=(d=(d=(d=(d=(d=(d=(d=d.replace(/\\end{aligned}/g,"")).replace(/\\end{alignat}/g,"")).replace(/\\end{alignedat}/g,"")).replace(/\\displaystyle/g,"")).replace(/\\\,/g,"")).replace(/\&/g,"")).replace(/\\begin{aligned}/g,"")).replace(/\\begin{alignat}{[0-9]*}/g,"")).replace(/\\begin{alignedat}{[0-9]*}/g,"")).replace(/\\\;/g,"")).replace(/\\ /g,"")).replace(/\\quad/g,"");;){var t=d.replace(/[.,\s\\]+$/,"");if(t===d){if((t=st(d))===d)break;d=t}else d=t}for(var e=[],i=d.split(/{?\s*\\text{(.*?)}\s*}?/),r="",o=0;o<i.length;o+=2){var s=i[o],a=i[o+1];if(r+=s,a&&"_"===r[r.length-1])r=r.substr(1,r.length-1)+'"'+a+'"';else{var l=r.split("\\\\"),c=!1;l.forEach(function(t){var n=t.replace(/[.,]+$/,"").split("="),i=n[0];n.forEach(function(t,r){if(!(0===r&&n.length>1)){var o=1===n.length?t:i+"="+t;h.AlgebraModel.isParsable(o)?(e.push(o),c=!0):c=!1}})}),r=c?"":l[l.length-1]+'"'+a+'"'}}if(0===e.length)return y.showNotice("We could not parse the math data. It is being displayed as an image.",!0,"warning"),console.log("Could not parse equation!"),ot(n.img_url||n,{x:u[0],y:u[1]}),{v:void 0};try{H.simulateStartOfInteraction(),function t(n,i){n>=e.length||y.createElement("derivation",{eq:e[n],pos:i},"drag-n-drop",function(e){t(n+1,{x:e.pos.x,y:e.pos.y+e.size.height+1})})}(0,{x:u[0],y:u[1]})}catch(t){y.showNotice("We could not parse the math data. It is being displayed as an image.",!0,"warning"),console.log("Could not parse equation!",t),ot(n.img_url||n,{x:u[0],y:u[1]})}finally{H.simulateEndOfInteraction()}}();if("object"===(void 0===f?"undefined":r(f)))return f.v}else{console.log("could not parse drop data",n);var g={drop_evt:n.img_url||n,pos:{x:u[0],y:u[1]}};H.simulateStartOfInteraction(),y.createElement("image",g,"drag-n-drop"),H.simulateEndOfInteraction()}}else console.warn("The current settings prevent dropped assets from being accepted.")},t.rebind(H,m,"on")};var o,s=n(0),a=(n(10),n(105)),l=n(91),u=n(90),c=n(53),d=n(34),h=n(5),p=n(221),f=(o=n(23))&&o.__esModule?o:{default:o}}).call(this,n(6),n(8))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.loadFromJSON=function(t,e,n){return e||(e={}),JSON.parse(t,function(t,i){if(i&&i.type in l){var r=l[i.type](i,e,n);return r.id&&(e[r.id]=r),r}return i})},n(1);var i=n(2),r=n(30),o=n(117),s=n(54),a=n(41),l={Action:i.Action.fromJSON,ApplyFormulaAction:a.ApplyFormulaAction.fromJSON,AlgebraModel:r.AlgebraModel.fromJSON,AlgebraModelLink:r.AlgebraModelLink.fromJSON,DerivationRow:o.DerivationRow.fromJSON,Derivation:o.Derivation.fromJSON,LinkCoordinator:r.LinkCoordinator.fromJSON,Path:s.Path.fromJSON,TextBox:s.TextBox.fromJSON,CanvasImage:s.CanvasImage.fromJSON,CanvasVideo:s.CanvasVideo.fromJSON,GeoGebraCanvasElement:s.GeoGebraCanvasElement.fromJSON,GeoGebraPanel:s.GeoGebraPanel.fromJSON,Table:s.Table.fromJSON}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DLLogger=a;var i=n(0),r=n(43),o=n(41),s=n(7);function a(t,e){this.id=i.gmath.uid(),this.interaction_logger=t,this.log_mouse_trajectories=this.interaction_logger.log_mouse_trajectories,this.dl=e,this.initListeners(),this.events=[],this.interaction=null,this.scrubbed_in_this_interaction=!1}function l(t){return Math.round(10*t)/10}i.gmath.DLLogger=a,a.prototype.initListeners=function(){this.registerDLListeners(this.dl);var t=this.dl.rows.length;this.dl.rows.forEach(function(e,n){0!==n&&n!==t-1||this.registerInteractionHandlerListeners(e.view.interaction_handler),this.registerAMListeners(e.model)},this)},a.prototype.registerDLListeners=function(t){t.events.on("added_line."+this.id,function(){2===t.rows.length&&this.registerInteractionHandlerListeners(t.rows[0].view.interaction_handler),this.registerAMListeners(t.getLastModel())}.bind(this)).on("auto_undo."+this.id,function(e){this.registerInteractionHandlerListeners(t.getLastView().interaction_handler),this.registerAMListeners(t.getLastModel()),this.on_auto_undo(e)}.bind(this))},a.prototype.registerAMListeners=function(t){t.events.on("create."+this.id,this.on_change.bind(this)).on("change."+this.id,this.on_change.bind(this)).on("mistake."+this.id,this.on_mistake.bind(this)).on("spawn."+this.id,this.on_spawn.bind(this)).on("end-of-interaction."+this.id,this.on_end_of_interaction.bind(this)).on("start-of-interaction."+this.id,this.on_start_of_interaction.bind(this))},a.prototype.registerInteractionHandlerListeners=function(t){t.events.on("touch."+this.id,this.on_touch.bind(this,t)).on("release."+this.id,this.on_release.bind(this,t)).on("tap."+this.id,this.on_tap.bind(this,t)).on("dbltap."+this.id,this.on_tap.bind(this,t)).on("hold."+this.id,this.on_tap.bind(this,t)).on("keydown."+this.id,this.on_keydown.bind(this,t)).on("keyup."+this.id,this.on_keyup.bind(this,t)).on("node_selection."+this.id,this.on_node_selection.bind(this,t)),this.log_mouse_trajectories&&t.events.on("drag_start."+this.id,this.on_drag_start.bind(this,t)).on("drag."+this.id,this.on_drag.bind(this,t)).on("drag_end."+this.id,this.on_drag_end.bind(this,t))},a.prototype.on_error=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];console.warn("Error during logging of derivation interaction."),e&&i.gmath.sendErrorReport("Error during logging of derivation interaction.",(0,s.getStackTrace)()),this.clearData(),this.interaction="ignore"},a.prototype.log=function(t){this.events.push(t)},a.prototype.extendWithNodeData=function(t,e,n,i){if(n||(n=[]),Array.isArray(n)||(n=[n]),this.extendWithSelectorData(t,e,n),0!==n.length){var o=r.HitTester.getBoundingBox(n);t[e+"x"]=l(o.x),t[e+"y"]=l(o.y),t[e+"width"]=l(o.width),t[e+"height"]=l(o.height)}},a.prototype.getSelectorString=function(t,e){if(Array.isArray(t)){if(0===t.length)return""}else t=[t];return e?t[0].get_root().getSelectorOfNodes(t):t.map(function(t){return t.to_ascii()}).join(";")},a.prototype.extendWithSelectorData=function(t,e,n){t[e+"ascii"]=this.getSelectorString(n,!0)},a.prototype.extendWithLogData=function(t,e,n,i){if(!(e&&n+"x"in e))throw"(DLLogger) Source log argument does not exist or does not contain expected data.";void 0===i&&(i=n),t[i+"x"]=e[n+"x"],t[i+"y"]=e[n+"y"],t[i+"width"]=e[n+"width"],t[i+"height"]=e[n+"height"],t[i+"ascii"]=e[n+"ascii"],e[i+"idx"]&&(t[i+"idx"]=e[n+"idx"])},a.prototype.extendWithDuration=function(t){for(var e=this.events.length-1;e>=0;e--){var n=this.events[e];if("math"===n.type||0===e)return void(t.dur=t.time-n.time)}},a.prototype.on_spawn=function(t){try{t.settings&&t.settings.makes_no_changes&&this.on_action({action:t})}catch(t){this.on_error(t)}},a.prototype.on_change=function(t){try{if("ignore"===this.interaction)return;if(!this.interaction&&t.new_model&&this.registerAMListeners(t.new_model),!this.interaction)return;t.action?this.on_action(t):this.dl.rows[0].model===t.new_model&&this.on_scrub(t)}catch(t){this.on_error(t)}},a.prototype.on_mistake=function(t){try{if(!this.interaction||"ignore"===this.interaction)return;this.interaction.subtype="mistake",this.interaction.method=t.method;var e={type:"event",subtype:"math",time:Date.now(),action:"mistake",target_side:t.side,method:t.method,dx_to_target:-l(t.dx),dy_to_target:-l(t.dy)};"dropOnSelf"in t&&(e.drop_on_self=t.dropOnSelf),this.events.length&&this.extendWithDuration(e),t.target&&(t.target.get_root()===t.target?e.target_ascii=t.target.to_ascii():this.extendWithSelectorData(e,"target_",t.target)),t.selection&&this.extendWithNodeData(e,"sel_",t.selection),t.model&&this.extendWithNodeData(e,"expr_",t.model.children[0]),this.log(e)}catch(t){this.on_error(t)}},a.prototype.element_created=function(t){var e=t.el_id,n=t.new_state,i=t.el_type;if("ignore"!==this.interaction){this.interaction.created_elements?this.interaction.created_elements.push(e):this.interaction.created_elements=[e];var r={type:"event",subtype:"create",el_type:i,el_id:e,new_state:n,time:Date.now()};this.log(r)}},a.prototype.on_action=function(t){this.interaction.subtype="rewrite";var e=this.dl.getRowByModel(t.action.newTree),n={time:Date.now(),type:"event",subtype:"math",action:t.action.name,row_id:e?e.idx:-1,method:t.action.getOrInferTriggerType()};if(t.action instanceof o.ApplyFormulaAction&&(n.source=t.action.nodes.map(function(t){return t.to_ascii()}).join(";")),t.action.source_am){n.source=this.getSelectorString(t.action.nodes);var i=this.dl.getAllDLs().find(function(e){return e.getRowByModel(t.action.source_am)});i&&(n.source_id=i.id)}this.extendWithNodeData(n,"expr_",t.action.new_derivation?t.action.oldTree.children[0]:t.action.newTree.children[0]),(t.action.nodes||t.action.actor)&&this.extendWithSelectorData(n,"sel_",t.action.nodes||t.action.actor),t.action.target&&(this.extendWithSelectorData(n,"target_",t.action.target),n.target_side=t.action.settings.side),this.events.length&&this.extendWithDuration(n),this.interaction.method=n.method,this.interaction.new_state=n.expr_ascii,this.log(n),t.dl&&(console.log("I'm still useful!"),this.element_created({time:n.time,action:t.action.name,el_id:t.dl,new_state:t.action.newTree.to_ascii(),el_type:"derivation"}))},a.prototype.on_scrub=function(t){this.scrubbed_in_this_interaction=!0,this.interaction.subtype="scrub",this.interaction.method="drag"},a.prototype.on_start_of_interaction=function(t){try{if(this.interaction)return console.warn("Start of interaction received before prior interaction ended."),void this.clearData();this.interaction={time:Date.now(),type:"interaction",subtype:"rewrite",el_type:"derivation",el_id:this.dl.id,el_subtype:"row",el_subid:this.dl.getRowByModel(t.model).idx,old_state:t.model.to_ascii()},this.logStartOfInterationEvent(t.time,this.dl.getRowByModel(t.model))}catch(t){this.on_error(t)}},a.prototype.on_end_of_interaction=function(t){try{if(!this.interaction||"ignore"===this.interaction)return this.interaction||(console.warn("End of interaction received without prior start of interaction."),this.on_error("End of interaction received without prior start of interaction.")),void this.clearData();this.scrubbed_in_this_interaction&&(this.logScrubEvent(),this.initListeners()),(("edit"===this.dl.mode||"edit-keypad"===this.dl.mode)&&!this.isEmptySelectionInteraction()||"inspect"===this.dl.mode&&this.scrubbed_in_this_interaction)&&(this.interaction.dur=this.events[this.events.length-1].time-this.interaction.time,this.interaction_logger.logInteractionWithEvents(this.interaction,this.events,a.compressDragEvents),this.interaction.new_state||(this.interaction.new_state=this.interaction.old_state)),this.clearData()}catch(t){this.on_error(t)}},a.prototype.on_auto_undo=function(t){try{if(!this.interaction||"ignore"===this.interaction)return;this.log({time:Date.now(),type:"event",subtype:"auto-undo",row_id:this.dl.rows.length-1})}catch(t){this.on_error(t)}},a.prototype.isEmptySelectionInteraction=function(){return!this.events.some(function(t){return"node_selection"===t.subtype||"math"===t.subtype})},a.compressDragEvents=function(t){var e=t.filter(function(t){return"drag"===t.subtype});if(0===e.length)return t;for(var n,i={type:"event",subtype:"trajectory",dts:[],xs:[],ys:[],wi_int_ids:[],sel_ascii:[]},r=t[0].time,o=0;o<e.length;o++){var s=e[o];i.dts.push(s.time-r),i.xs.push(s.x),i.ys.push(s.y),i.wi_int_ids.push(s.within_interaction_id),i.sel_ascii.push(s.sel_ascii!==n?s.sel_ascii:void 0),r=s.time,n=s.sel_ascii}return i.interaction_id=t[0].interaction_id,i.trial_id=t[0].trial_id,(t=t.filter(function(t){return"drag"!==t.subtype})).push(i),t},a.decompressAndSortEvents=function(t){var e;if(t.sort(function(t,e){return(t.within_interaction_id||-1)-(e.within_interaction_id||-1)}),"trajectory"===t[0].subtype)e=0;else{if(!t[1]||"trajectory"!==t[1].subtype)return t;e=1}for(var n=t.splice(e,1)[0],i=t[0].time,r=0;r<n.dts.length;r++){var o={time:n.dts[r]+i,x:n.xs[r],y:n.ys[r],trial_id:n.trial_id,interaction_id:n.interaction_id,within_interaction_id:n.wi_int_ids[r],type:"event",subtype:"drag"};n.sel_ascii&&n.sel_ascii[r]&&(o.sel_ascii=n.sel_ascii[r]),t.push(o),i+=n.dts[r]}return t.sort(function(t,e){return(t.within_interaction_id||-1)-(e.within_interaction_id||-1)}),t},a.prototype.clearData=function(){this.scrubbed_in_this_interaction=!1,this.interaction=null,this.events=[]},a.prototype.logScrubEvent=function(){var t={time:Date.now(),type:"event",subtype:"scrub",method:"drag",dur:this.events[this.events.length-1].time-this.events[0].time};this.extendWithNodeData(t,"expr_",this.dl.rows[0].model.children[0]),this.interaction.new_state=t.expr_ascii,this.log(t)},a.prototype.logStartOfInterationEvent=function(t,e){var n={time:t,type:"event",subtype:"start-interaction",row_id:e.idx};this.extendWithNodeData(n,"expr_",e.model.children[0]),this.extendWithNodeData(n,"sel_",e.view.interaction_handler.selected_nodes),this.log(n)},a.prototype.on_touch=function(t,e){try{if(!this.interaction||"ignore"===this.interaction)return;var n={time:e.time,type:"event",subtype:"touch",x:l(e.finger.pos[0]),y:l(e.finger.pos[1]),touch_id:e.finger.id};this.extendWithNodeData(n,"sym_",e.target,!0),this.log(n)}catch(t){this.on_error(t)}},a.prototype.on_release=function(t,e){try{if(!this.interaction||"ignore"===this.interaction)return;this.log({time:e.time,type:"event",subtype:"release",x:l(e.finger.pos[0]),y:l(e.finger.pos[1]),touch_id:e.finger.id})}catch(t){this.on_error(t)}},a.prototype.on_drag_start=function(t,e){try{if(!this.interaction||"ignore"===this.interaction)return;if(0===e.selection.length)this.interaction="ignore";else{var n={time:e.time,type:"event",subtype:"drag",x:Math.round(e.pos0[0]),y:Math.round(e.pos0[1]),sel_ascii:this.getSelectorString(e.selection[0],!1)};this.log(n)}}catch(t){this.on_error(t)}},a.prototype.on_drag=function(t,e){try{if(!this.interaction||"ignore"===this.interaction)return;var n={time:e.time,type:"event",subtype:"drag",x:Math.round(e.pos[0]),y:Math.round(e.pos[1]),sel_ascii:this.getSelectorString(e.selection[0],!1)};this.log(n)}catch(t){this.on_error(t)}},a.prototype.on_drag_end=function(t,e){},a.prototype.on_node_selection=function(t,e){try{if(!this.interaction||"ignore"===this.interaction)return;var n={time:e.time,type:"event",subtype:"node_selection"};this.extendWithNodeData(n,"sel_",e.selection,!0),this.log(n)}catch(t){this.on_error(t)}},a.prototype.on_tap=function(t,e){try{if(!this.interaction||"ignore"===this.interaction)return;this.log({time:e.time,type:"event",subtype:e.type,x:e.finger.pos[0],y:e.finger.pos[1]})}catch(t){this.on_error(t)}},a.prototype.on_keydown=function(t,e){try{if(!this.interaction||"ignore"===this.interaction)return;this.log({time:e.time,type:"event",subtype:"keydown",key_code:e.keyCode})}catch(t){this.on_error(t)}},a.prototype.on_keyup=function(t,e){try{if(!this.interaction||"ignore"===this.interaction)return;this.log({time:e.time,type:"event",subtype:"keyup",key_code:e.keyCode})}catch(t){this.on_error(t)}},i.gmath.DLLogger=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=[/^https:\/\/graspablemath\.com$/,/^https:\/\/.*geogebra\.org$/,/^https:\/\/.*\.bbpd\.io$/,/^http:\/\/localhost:5000$/];e.ExternalApi=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=e,window.addEventListener("message",this.receiveMsg.bind(this)),this.commands=new Set(["loadFromJSON","getAsJSON","undo","redo","ping"]),this.events=new Set(["undoable-action"]),this.listeners=new Map,this.canvas.controller.on("undoable-action",function(t){return n.fireEvent("undoable-action",{type:t})})}return r(t,[{key:"fireEvent",value:function(t,e){var n=this.listeners.get(t);n&&n.source.postMessage({gmm_id:n.id,is_event:!0,eventType:t,result:e},n.origin)}},{key:"receiveMsg",value:function(t){if(t.origin&&o.some(function(e){return e.test(t.origin)})&&"object"===i(t.data)&&"gmm_id"in t.data){var e=t.data.command;"listen"===e?this.listen(t):this.commands.has(e)?this.replySuccess(t,this[e](t.data.args)):this.replyError(t,'Unknown command "'+e+'".')}}},{key:"listen",value:function(t){var e=t.data.eventType;return this.events.has(e)?(this.listeners.set(e,{id:t.data.gmm_id,source:t.source,origin:t.origin}),this.replySuccess(t,'Listening to "'+e+'" events.')):this.replyError(t,"Unknown eventType "+e+".")}},{key:"replySuccess",value:function(t,e){t.source.postMessage({gmm_id:t.data.gmm_id,result:e},t.origin)}},{key:"replyError",value:function(t,e){t.source.postMessage({gmm_id:t.data.gmm_id,error:e},t.origin)}},{key:"ping",value:function(){return!0}},{key:"loadFromJSON",value:function(t){var e=t.json;return this.canvas.loadFromJSON(e),!0}},{key:"getAsJSON",value:function(){return this.canvas.toJSON()}},{key:"undo",value:function(){this.canvas.controller.undo()}},{key:"redo",value:function(){this.canvas.controller.redo()}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){!function(t){if(!t.is_group("mul","div")||!i.Var.is_var(t.get_child([1])))throw"[getVariableGroup] Incorrect use of function: must pass in an operator containing a variable."}(t);for(var e=[],n=t.ls;n&&n.is_group(t.value)&&n.rs&&r(n.rs);)e.unshift(n),n=n.ls;for(e.push(t),n=t.rs;n&&n.is_group(t.value)&&r(n);)e.push(n),n=n.rs;return e.length===t.parent.children.length?[t.parent]:e};var i=n(3);function r(t){return t.get_child([0]).hidden}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(3),s=(i=n(96))&&i.__esModule?i:{default:i},a=n(30),l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,null,[{key:"getSelectionsFromModel",value:function(e){return e.filter(function(e){return e.is_group("num")||t.isSimpleVariable(e)||e.is_group("var","sym")&&e.parent&&e.parent.is_group("func")}).map(function(e){return e.parent.is_group("add","sub","mul","div")?e.parent:e.parent.is_group("power")&&e.get_parent(2).is_group("mul","div")&&t.withinSimpleProductFraction(e.parent)?e.get_parent(2):e})}},{key:"isSimpleVariable",value:function(e){return e.is_group("var")&&(t.withinSimpleProductFraction(e)||a.AlgebraModel.is_top_most(e)||e.parent.is_group("sign","add","sub","param","power"))}},{key:"withinSimpleProductFraction",value:function(t){return!!t.parent&&t.parent.is_group("mul","div")&&o.ProductFraction.get_whole_range(t.parent).every(function(t){return o.Num.is_num(t.children[1])||o.Var.is_var(t.children[1])})}},{key:"getApplicableTerm",value:function(t){if(t.length>1)return t;var e=t[0];return e.parent.is_group("sign","add","sub","func")?[e.parent]:[e]}},{key:"getVariableGroup",value:function(e){if(e.children[1]&&o.Var.is_var(e.children[1])&&t.withinSimpleProductFraction(e.children[1])){if(e.get_parent(1).is_group("product","fraction"))return(0,s.default)(e);throw"[SplitNumberHandler] Can't find the containing group!"}return e.parent.is_group("power")?[e.parent]:[e]}},{key:"filterSuperscriptsAndSubscripts",value:function(e){return e.filter(function(e){return!t.isSuperscriptOrSubscript(e)})}},{key:"isSuperscriptOrSubscript",value:function(t){for(var e=t.parent;e;){if(e.is_group("subscript","superscript")||e.is_leaf_node)return!0;e=e.parent}return!1}}]),t}();e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExpressionRewriteAction=p;var i=n(0),r=n(1),o=(n(7),n(2)),s=n(5),a=h(n(4)),l=n(3),u=h(n(25)),c=n(12),d=h(n(23));function h(t){return t&&t.__esModule?t:{default:t}}function p(t){o.Action.call(this,"ExpressionRewriteAction","replace an expression with an equivalent one"),this.priority=0,this.triggerType="tap",this.settings={side:"shake",asynchronous:!0},this.latex=null,this.original_node_state=null,t&&(this.settings.use_simple_keyboard_layout=t.use_simple_keyboard_layout||c.MathSettings.get("use_simple_keyboard_layout"),this.settings.allow_non_equivalent_keyboard_rewrite=t.allow_non_equivalent_keyboard_rewrite||c.MathSettings.get("allow_non_equivalent_keyboard_rewrite"),this.settings.only_simple_rewrites=t.only_simple_rewrites||c.MathSettings.get("only_simple_rewrites"),t.actor?this.actor=t.actor:(this.triggerType="drag",this.nodes=t.nodes),t.triggerType&&(this.triggerType=t.triggerType),t.side&&(this.settings.side=t.side))}function f(t){return t.map(function(t){return t.to_ascii()}).join("")}i.gmath.inherit(o.Action,p),p.prototype.toJSON=function(){var t=o.Action.prototype.toJSON.call(this);return this.latex&&(t.latex=this.latex),this.original_node_state&&(t.original_node_state=this.original_node_state),t},p.prototype.rematch=function(){return!!(this.actor||this.nodes&&this.nodes.length>0)&&(this.actor?this.match(this.actor):this.getAllAvailableActions?this.getAllAvailableActions(this.nodes).every(function(t){return f(t.nodes)===this.original_node_state},this):void 0)},p.prototype.match=function(t){return i.gmath.ui&&i.gmath.ui.Keyboard&&t.is_group("placeholder")},p.prototype.getAllAvailableActions=function(t){return i.gmath.ui&&i.gmath.ui.Keyboard&&c.MathSettings.get("enable_shake_trigger_type")?c.MathSettings.get("only_simple_rewrites")&&t.length>1?[]:[this.createBoundAction(t[0].get_root(),{nodes:t})]:[]},p.prototype.adjustTarget=function(t){return 1===t.length&&t[0].is_group("exponent","degree")?[t[0].children[0]]:1===t.length&&t[0].is_group("mul","div")?[t[0].children[1]]:t},p.prototype.transform=function(t){var e=this.adjustTarget(this.getNewTreeNode(this.nodes||[this.actor])),n=this.getOldTreeNode(e);if(this.latex){var o=this.newTree.parse(y(this.latex),!0);return x.call(this,n,e,o),"function"==typeof t&&t(this),this}this.original_node_state=f(this.nodes||[this.actor]);var a=!1,c=1===e.length&&b(e[0])?"Enter an expression to fill in the selected box.":"Enter an expression to replace the selected expression.",h=e.map(function(t){return t.to_latex()}).join("");this.settings.only_simple_rewrites&&(c=1===e.length&&(l.Num.is_num(e[0])||e[0].is_group("add","sub","mul","div")&&l.Num.is_num(e[0].children[1]))?'Substitute "'+l.Num.get_value(e[0])+'" with an equivalent expression.':"Substitute the term with an equivalent expression."),h.startsWith("\\cdot ")&&!e[0].is_group("product")&&(h=h.replace("\\cdot ","")),h=h.replace(/\\dottedsquare/g,"⬚");var p,g,m=i.gmath.ui.Keyboard(),v=this.settings.only_simple_rewrites?(p=this.newTree,g=new Set,p.for_each(function(t){t.is_group("var")&&g.add(t.value)}),[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(g))):null;function y(t){var e=(t=t.replace(/\\quad/g,"")).split("\\rightarrow");return e.length>1?e[e.length-1]:e[0]}function b(t){return t.is_group("placeholder")||t.is_group("add","sub","addsub","sign","plusminus","degree","exponent","mul","div")&&t.children[1].is_group("placeholder")}function _(t,n){if(n.get_root()instanceof s.AlgebraModel||new s.AlgebraModel("").append(n.get_root()),1===t.length&&b(t[0]))return!0;var r=i.gmath.termsToAlgebriteString;if(1===t.length&&l.Num.is_num(t[0])&&s.AlgebraModel.evalExpression(n)===l.Num.get_value(t[0]))return!0;if(!u.default)return!1;var o=function(t,e,n){e=e[0];var i=u.default.simplify(r(t.children[0])),o=u.default.simplify(r(t.children[2])),s=u.default.simplify(r(e.children[0])),a=u.default.simplify(r(e.children[2]));return!n&&u.default.equal(i,s)&&u.default.equal(o,a)||n&&u.default.equal(i,a)&&u.default.equal(o,s)};try{if(n.is_group("equals")||t[0].is_group("equals"))return!(!n.is_group("equals")||1!==t.length||!t[0].is_group("equals"))&&o(n,t,!1);if(l.Inequality.is_inequality(n)||l.Inequality.is_inequality(t[0]))return!(!l.Inequality.is_inequality(n)||1!==t.length||!l.Inequality.is_inequality(t[0]))&&(t[0].value===n.value?o(n,t,!1):!!(t[0].is_group("lt")&&n.is_group("gt")||t[0].is_group("lte")&&n.is_group("gte")||t[0].is_group("gt")&&n.is_group("lt")||t[0].is_group("gte")&&n.is_group("lte"))&&o(n,t,!0));var a=u.default.simplify(r(n)),c=u.default.simplify(r(e));return u.default.equal(c,a)}catch(t){return console.warn("[RewriteExpressionWithKeyboardAction] External library Algebrite threw an error."),!1}}function x(t,e,n,i){var o=this,s=e[0].get_parent(1),a=r.Tree.remove_range(e);if(1===e.length&&e[0].is_group("add","sub")){var u=n.is_group("product")&&n.get_child([0,1]).is_group("sign");e[0].is_group("add")&&n.is_group("sign")?n=new l.AddSub(n.children[1],"sub"):e[0].is_group("sub")&&n.is_group("sign")?n=new l.AddSub(n.children[1],"sub"):e[0].is_group("sub")&&u?(l.Sign.invertTerm(n),n=new l.AddSub(n,"sub")):n=new l.AddSub(n)}else e[0].is_group("mul","div")?n=new l.MulDiv(n,e[0].value):e[0].is_group("add","sub")&&(n=new l.AddSub(n));s.insert(a,n),t[0].get_root();var c=n.get_leaf_nodes().filter(function(t){return!t.is_group("sym")});t.forEach(function(t){o.updateNodeMap(t,n),r.Tree.get_leaf_nodes(t).filter(function(t){return!t.is_group("sym")}).forEach(function(t){return o.updateNodeMap(t,c)})}),l.Brackets.handle(n),this.cleanup(n),this.cleanup_cascade(s)}function w(t,e,n){m.warning(e,n),this.oldTree.events.mistake({selection:this.nodes||this.actor,model:this.oldTree,target:t,method:"keypad"})}m.caption(c).on("done",function(i){this.latex=i;var r=y(i);if(function(t){var e;try{e=this.newTree.parse(t,!0)}catch(t){return console.log(t),w.call(this,e,"Could not parse expression.",c),!1}return!!e||(w.call(this,e,"Please enter an expression.",c),!1)}.call(this,r)){var o=this.newTree.parse(r,!0);if(this.settings.only_simple_rewrites){if(!_(e,o))return void w.call(this,o,"The total of the new expression should be the same as the original.",c);if(o.is_group("sum")&&2!==o.children.length)return void w.call(this,o,"Only sums of two terms are accepted.");x.call(this,n,e,o)}else if(a&&this.settings.allow_non_equivalent_keyboard_rewrite)x.call(this,n,e,o);else{if(!_(e,o))return this.settings.allow_non_equivalent_keyboard_rewrite?w.call(this,o,"You may have changed the value. If you're sure you want this, press Done again.",c):w.call(this,o,"It looks like what you entered is not equal to what you are replacing. Try again.",c),void(a=!0);x.call(this,n,e,o,!0)}if(this.endKeyboardInteraction(m),"function"!=typeof t)return!0;t(this)}}.bind(this)).on("change",function(){a=!1}.bind(this)).on("cancel",function(){this.endKeyboardInteraction(m),t(!1)}.bind(this)),(0,d.default)(m,h,v),m.selectAll()},(0,a.default)(p,!0,l.PlaceHolder)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.analyzeNodeStructure=function(t){var e=r.AlgebraModel.groupNodeRanges(t);if(0===e.length)return[];for(var n=[],o=0;o<e.length;o++){var s=e[o];if(1===s.length&&s[0].is_group("exponent")){var a=s[0].children[0];i.Brackets.areHidden(a)&&(a=a.children[1]);var l=s[0].get_parent(3);if(!l)return[];n.push({range:s,exp:s[0],prod:l,ascii:a.to_ascii()})}else{if(!s.every(function(t){return t.is_group("mul","div")}))return[];var u=s[0].get_parent(3),c=s[0].get_parent(6),d=r.AlgebraModel.rangeToAsciiNoLeadingOp(s,!0);if(!u||!c)return[];n.push({range:s,exp:u,prod:c,ascii:d})}}for(var h=0;h<n.length;h++){var p=n[h];if(p.ascii!==n[0].ascii)return[];if(!p.exp.is_group("exponent"))return[];if(!p.prod.is_group("fraction","product")||p.prod!==n[0].prod)return[];for(var f=h+1;f<n.length;f++)if(p.exp===n[f].exp)return[]}return n};var i=n(3),r=n(5)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MulDivInvertAction=h;var i=n(0),r=n(1),o=n(2),s=n(5),a=d(n(4)),l=n(3),u=d(n(25)),c=n(12);function d(t){return t&&t.__esModule?t:{default:t}}function h(t){if(o.Action.call(this,"MulDivInvertAction","invert multipliers across an inequality"),this.priority=0,this.triggerType="drag",t){this.settings.allow_drag_across_relation=c.MathSettings.get("allow_drag_across_relation"),this.settings.simplify_after_drag_across_relation=c.MathSettings.get("simplify_after_drag_across_relation");var e=this.getDestinationHints(t);this.initSettings(i.gmath.extend(t,{drop_area:{margin:{y2:-1,x:-.25}},drop_area_hint:{margin:{y2:-1}},destination_hint:e}))}}i.gmath.inherit(o.Action,h),h.prototype.inContext=function(t){return t in this.settings?this.settings[t]:c.MathSettings.get(t)},h.prototype.getAllAvailableActions=function(t){if(!this.inContext("allow_drag_across_relation"))return[];var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n)},h.prototype.matchSource=function(t){if(!r.Tree.is_range(t))return!1;var e=t[0].get_parent(1);return e.is_group("product","fraction")&&l.Inequality.is_relation(e.get_parent(1))?{nodes:t,side:e.get_idx(),group:e.get_parent(1)}:e.is_group("fraction")&&e.get_parent(1).is_group("sign")&&l.Inequality.is_relation(e.get_parent(2))?{nodes:t,side:e.get_parent(1).get_idx(),group:e.get_parent(2)}:(e.is_group("product","fraction")&&e.get_parent(1).is_group("add","sub")||e.is_group("fraction")&&e.get_parent(1).is_group("mul"))&&l.Inequality.is_relation(e.get_parent(3))?{nodes:t,side:e.get_parent(2).get_idx(),group:e.get_parent(3)}:e.is_group("fraction")&&e.get_parent(1).is_group("mul")&&e.get_parent(3).is_group("add","sub")&&l.Inequality.is_relation(e.get_parent(5))?{nodes:t,side:e.get_parent(4).get_idx(),group:e.get_parent(5)}:!!(e.is_group("fraction")&&e.parent&&e.parent.is_group("mul")&&l.Inequality.is_relation(e.parent.parent.parent))&&{nodes:t,frac:e,side:e.get_parent(2).get_idx(),group:e.get_parent(3)}},h.prototype.getTargets=function(t){return[t.group.get_child([t.side?0:2])]},h.prototype.getDestinationHintNodes=function(t){for(var e=t.nodes,n=t.target,i=e[0];!i.is_group("add","sub","addsub")&&!s.AlgebraModel.is_top_most(i);)i=i.parent;var r=i.is_group("add","sub","addsub")?l.Group.get_siblings(i).map(function(t){return t.children[1]}):[];return r.push(n),r},h.prototype.getDestinationHints=function(t){for(var e=[],n=t.nodes[0];!n.is_group("add","sub","addsub")&&!s.AlgebraModel.is_top_most(n);)n=n.parent;if((n.is_group("add","sub","addsub")?l.Group.get_siblings(n).map(function(t){return t.children[1]}):[]).forEach(function(t){return e.push({node:t,side:"below",margin:{x:-.2}})}),t.target.is_group("fraction")&&t.nodes[0].is_group("mul")){var i=t.target.get_bottom();e.push({node:i[i.length-1],side:"right-of"})}else if(t.nodes[0].is_group("mul"))e.push({node:t.target,side:"below"});else if(t.nodes[0].is_group("div")){var r=void 0;if(t.target.is_group("fraction")){var o=t.target.get_top();r=o[o.length-1]}else r=t.target.is_group("product")?t.target.get_last_child():t.target;e.push({node:r,side:"right-of"})}return e},h.prototype.transform=function(t){var e=this.getNewTreeNode(this.nodes);this.settings.simplify_after_drag_across_relation&&r.Tree.get_leaf_nodes(e).forEach(function(t){return t._anim_use_base_pos=!0});var n=this.analyzeStructureOfEquation(e);return l.Inequality.is_inequality(n.otherSideOfEquation.get_parent(1))&&this.invertInequality(n.oldModifiers,n.otherSideOfEquation.get_parent(1)),this.invertModifiers(n.modifiers),this.modifyAnyOtherTermsOnOriginSide(n.modifiers,n.originChanges,n.oldModifiers),this.settings.simplify_after_drag_across_relation||this.removeModifiersFromOriginSide(n.modifiers),this.modifyTargetSide(n.oldModifiers,n.modifiers,n.otherSideOfEquation,n.oldOtherSideOfEquation),"function"==typeof t&&t(this),this},h.prototype.analyzeStructureOfEquation=function(t){var e=this,n={},i=t[0].get_root().children[0],o=t[0].get_path(),s=o[1]?0:2;return n.oldModifiers=t.map(this.getOldTreeNode.bind(this)),this.settings.simplify_after_drag_across_relation?(n.modifiers=r.Tree.clone(t),n.oldModifiers.forEach(function(t,i){return e.extendNodeMap(t.get_mapping_to(n.modifiers[i]))})):n.modifiers=t,n.originChanges=this.getOtherTermsFromSide(i.children[o[1]],t,o),n.otherSideOfEquation=i.children[s],n.oldOtherSideOfEquation=this.getOldTreeNode(n.otherSideOfEquation),n},h.prototype.getOtherTermsFromSide=function(t,e,n){return this.settings.simplify_after_drag_across_relation&&t.is_group("sum")?t.children.slice():this.settings.simplify_after_drag_across_relation?[t]:t===e[0]||e[0].is_group("div")&&e[0].parent===t?[]:t.children.slice().filter(function(t){return t.get_path()[2]!==n[2]})},h.prototype.invertInequality=function(t,e){var n=s.AlgebraModel.evalExpression(t),r=s.AlgebraModel.to_ascii(t),o=i.gmath.termsToAlgebriteString(t);if(Number.isNaN(n)&&void 0!==u.default)try{n=Number(u.default.eval(o).toString())}catch(t){console.log("Algebrite could not parse",o)}isNaN(n)?this.settings.restraint="The terms "+r+" must simplify to a positive number.":n<0&&e.invert()},h.prototype.invertModifiers=function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n];i.is_group("mul")&&i.children[1].is_group("fraction")?l.ProductFraction.convert_to_reciprocal(i.children[1]):!i.invert||i.is_group("product","fraction")||this.isIdentityMul(i)&&!this.settings.simplify_after_drag_across_relation||i.invert(),e.push(i)}return e},h.prototype.isIdentityMul=function(t){return t.is_group("mul")&&(1===l.Num.get_value(t.children[1],!0)||-1===l.Num.get_value(t.children[1]))},h.prototype.modifyAnyOtherTermsOnOriginSide=function(t,e,n){if(0!==e.length){var i=e[0].parent;if(t[0].is_group("mul","div")&&(i.is_group("sum")||this.settings.simplify_after_drag_across_relation))for(var r=0;r<e.length;r++){var o=this.settings.simplify_after_drag_across_relation&&!i.is_group("sum")?e[r]:e[r].children[1],s=t.slice();this.settings.simplify_after_drag_across_relation||(s=this.removeRedundantTerms(o,s)),s.length>0&&(this.settings.simplify_after_drag_across_relation||(o=e[r].children[1]),this.insertModifiersIntoTerm(o,s,n))}}},h.prototype.removeRedundantTerms=function(t,e){var n=e.slice();if(t.is_group("product","fraction")){for(var i=0;i<t.children.length;){for(var o=t.children[i],s=0;s<n.length;){if(this.invertModifiers([r.Tree.clone(n[s])])[0].to_ascii()===o.to_ascii()){this.extendNodeMap(this.getOldTreeNode(o).get_mapping_to(n[s])),o.remove(),n.splice(s,1);break}i++,s++}if(0===n.length)break}this.cleanup(t)}return n},h.prototype.insertModifiersIntoTerm=function(t,e,n){this.termIsAProductContainingAFraction(t)&&e[0].is_group("div")?this.insertModifierDivsAsNewFractionIntoProduct(t,e,n):t.is_group("product","fraction")?this.insertModifiersIntoProductFraction(t,e,n):this.replaceTermWithProductContainingModifiedTerm(t,e,n)},h.prototype.termIsAProductContainingAFraction=function(t){return!!t.is_group("product")&&t.children.some(function(t){return t.children[1].is_group("fraction")})},h.prototype.insertModifierDivsAsNewFractionIntoProduct=function(t,e,n){var i=this,o=l.MulDiv.prototype.createParentGroup();o.append(new l.MulDiv(new l.Num(1))),e.forEach(function(t,e){var s=r.Tree.clone(t);s.dragging=!1,s.selected=!1,i.settings.simplify_after_drag_across_relation?i.extendNodeMap(n[e].get_mapping_to(s)):i.extendNodeMap(i.getOldTreeNode(t).get_mapping_to(s)),o.append(s)}),t.append(new l.MulDiv(o))},h.prototype.insertModifiersIntoProductFraction=function(t,e,n){var i=this;e.forEach(function(e,o){var s=r.Tree.clone(e);s.dragging=!1,s.selected=!1,i.settings.simplify_after_drag_across_relation?i.extendNodeMap(n[o].get_mapping_to(s)):i.extendNodeMap(i.getOldTreeNode(e).get_mapping_to(s)),t.append(s)})},h.prototype.replaceTermWithProductContainingModifiedTerm=function(t,e,n){var i=this,o=l.MulDiv.prototype.createParentGroup(),s=t.parent,a=t.remove();o.append(new l.MulDiv(t)),e.forEach(function(t,e){var s=r.Tree.clone(t);s.dragging=!1,s.selected=!1,i.settings.simplify_after_drag_across_relation?i.extendNodeMap(n[e].get_mapping_to(s)):i.extendNodeMap(i.getOldTreeNode(t).get_mapping_to(s)),o.append(s)}),s.insert(a,o)},h.prototype.removeModifiersFromOriginSide=function(t){var e=t[0].get_root().get_child(t[0].get_path().slice(0,2));if(this.modifierIsTheOnlyTermOnOriginSide(t,e))this.removeModifierAndReplaceWithZero(t);else if(t[0].is_group("div")||t[0].is_group("mul")&&t[0].parent.is_group("fraction")){var n=t[0].parent,i=n.parent;r.Tree.remove_range(t);var o=n.get_top();this.cleanup(n)&&1===o.length&&i.is_group("product","mul")&&(i.simplify=!0),this.cleanup(i)}else i=t[0].parent,r.Tree.remove_range(t),this.cleanup(i)},h.prototype.modifierIsTheOnlyTermOnOriginSide=function(t,e){return t[0]===e},h.prototype.removeModifierAndReplaceWithZero=function(t){var e=t[0].parent,n=t[0].remove();e.insert(n,new l.Num(0))},h.prototype.modifyTargetSide=function(t,e,n,i){if(1===e.length&&!e[0].is_group("mul","div")&&!e[0].is_group("add","sub"))if(e[0].is_group("sign"))(r=e[0].children[1]).remove(),e[0]=new l.AddSub(r),this.updateNodeMap(t[0],e[0]),this.updateNodeMap(t[0].children[0],e[0].children[0]);else if(e[0].is_group("sum"))(r=e[0]).children.forEach(function(t){t.invert()}),e[0]=new l.AddSub(r);else{var r=e[0];e[0]=new l.AddSub(r,"sub")}var o=n.parent,s=n.remove();if(!n.is_group("product","fraction")&&e[0].is_group("mul","div")){var a=l.MulDiv.prototype.createParentGroup(),u=new l.MulDiv(n);a.append(u);for(var c=0;c<e.length;c++)a.append(e[c]);o.insert(s,a),this.cleanup(a.children[0]),a.children[0].simplify=!0}else if(!n.is_group("sum")&&e[0].is_group("add","sub","sum")){var d,h=l.AddSub.prototype.createParentGroup();for(n.is_group("sign")?(d=new l.AddSub(n),this.extendNodeMap(i,d),this.extendNodeMap(i.children[0],d.children[0])):d=new l.AddSub(n),h.append(d),c=0;c<e.length;c++)h.append(e[c]);if(o.insert(s,h),this.cleanup(h.children[0]),e[0].children[1].is_group("sum")){var p=e[0].children[1].children.slice();this.cleanup(e[0]),e=p}h.children[0].simplify=!0}else{var f=n;for(c=0;c<e.length;c++)f.append(e[c]);o.insert(s,f),1===e.length&&e[0].children[1].is_group("sum")&&(e=e[0].children[1].children.slice(),this.cleanup(f.children[f.children.length-1]))}this.setNodesToReselectAfterAction(e)},(0,a.default)(h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.reduceProduct=function(t,e,n,s,a){var l=[],u=[],c=[],d=[];function h(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];t.is_group("sign")?(e||(n=!n),h(t.children[1],e,r,o)):t.is_group("brackets")&&i.Brackets.is_optional(t)?h(t.children[1],e,r,o):t.is_group("fraction","product")&&o?(t.get_top().forEach(function(t){return h(t.children[1],e,!1,!1)}),t.get_bottom().forEach(function(t){return h(t.children[1],e,!0,!1)})):r?e?d.push(t):u.push(t):e?c.push(t):l.push(t)}t.forEach(function(t){return h(t)}),e.forEach(function(t){return h(t,!0)});var p=function(t,e,n,s,a){var l=1,u=1,c={};function d(t,e,n){var r=t.is_group("power")?t.children[0]:t,o=t.is_group("power")?e.children[0]:e,s=r.to_ascii(),a=t.is_group("power")?t.get_exponent_term():new i.Num(1),l=t.is_group("power")?e.get_exponent_term():null;n&&(a=i.Sign.invertTerm(a)),s in c||(c[s]={base:r,oldBases:[],exps:[],oldExps:[]}),c[s].exps.push(a),c[s].oldBases.push(o),l&&c[s].oldExps.push(l)}t.forEach(function(t,e){t.is_group("num")?l*=t.value:d(t,n[e],!1)}),e.forEach(function(t,e){t.is_group("num")?u*=t.value:d(t,s[e],!0)});var h=new i.ProductFraction;if(l!==u||0===u){if(0!==l&&0!==u){var p=(0,o.getGCF)(l,u);l/=p,u/=p}if(1===u||0!==u&&0===l){var f=new i.Num(l);h.append(new i.MulDiv(f)),n.filter(function(t){return t.is_group("num")}).forEach(function(t){return a.extendNodeMap(t,f)}),s.filter(function(t){return t.is_group("num")}).forEach(function(t){return a.extendNodeMap(t,f)})}else{var g=new i.ProductFraction,m=new i.Num(l),v=new i.Num(u);g.append(new i.MulDiv(m)),g.append(new i.MulDiv(v,"div")),h.append(new i.MulDiv(g)),1!==l?n.filter(function(t){return t.is_group("num")}).forEach(function(t){return a.extendNodeMap(t,m)}):n.filter(function(t){return t.is_group("num")}).forEach(function(t){return a.extendNodeMap(t,v)}),s.filter(function(t){return t.is_group("num")}).forEach(function(t){return a.extendNodeMap(t,v)})}}var y=new i.ProductFraction,b=function(t){var e=void 0;if(1===(x=c[t]).exps.length)e=x.exps[0];else{e=new i.Sum,x.exps.forEach(function(t){var n=e.append(new i.AddSub(t));a&&a.applyInnerAction("AddSubCombineSigns",{actor:n})});for(var n=e.children.length-1;n>=0;n--)r.Action.cleanupInPlace(e.children[n])}var o=e.is_group("sum")?e.children.reduce(function(t,e){return t+i.Num.get_value(e)},0):i.Num.get_value(e),s=void 0;if(Number.isNaN(o))s=new i.MulDiv(new i.Power(x.base,e)),x.oldBases.forEach(function(t){return a.extendNodeMap(t.get_mapping_to(x.base))});else if(1===o)s=new i.MulDiv(x.base),x.oldBases.forEach(function(t){return a.extendNodeMap(t.get_mapping_to(x.base))});else if(0===o)s=null;else if(-1===o)s=new i.MulDiv(x.base,"div"),x.oldBases.forEach(function(t){return a.extendNodeMap(t.get_mapping_to(x.base))});else if(o<0){var l=new i.Num(-o);s=new i.MulDiv(new i.Power(x.base,l),"div"),x.oldBases.forEach(function(t){return a.extendNodeMap(t.get_mapping_to(x.base))}),x.oldExps.forEach(function(t){return a.extendNodeMap(t.get_mapping_to(l))})}else{var u=new i.Num(o);s=new i.MulDiv(new i.Power(x.base,u)),x.oldBases.forEach(function(t){return a.extendNodeMap(t.get_mapping_to(x.base))}),x.oldExps.forEach(function(t){return a.extendNodeMap(t.get_mapping_to(u))})}s&&y.append(s)};for(var _ in c){var x;b(_)}return(0===y.children.length&&0===h.children.length||y.children.length>0&&!y.children[0].is_group("mul"))&&y.append(new i.MulDiv(new i.Num(1))),0===h.children.length?y:0===y.children.length?h:(h.append(new i.MulDiv(y)),h)}(l,u,c,d,a);if(n){var f=(p=i.Sign.wrapTerm(p)).is_group("sign")?p.children[0]:p.get_child([0,1,0]);s.forEach(function(t){return a.extendNodeMap(t,f)})}return p},e.arrangeProduct=function(t,e,n,r){var o=[],s=[];t.forEach(function(t){return function t(n){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n.is_group("sign")?(e=!e,t(n.children[1],r,a)):n.is_group("brackets")&&i.Brackets.is_optional(n)?t(n.children[1],r,a):n.is_group("fraction","product")&&a?(n.get_top().forEach(function(e){return t(e.children[1],!1,!1)}),n.get_bottom().forEach(function(e){return t(e.children[1],!0,!1)})):r?s.push(n):o.push(n)}(t)});var a=function(t,e){var n=new i.ProductFraction;return t.forEach(function(t){n.append(new i.MulDiv(t))}),e.forEach(function(t){n.append(new i.MulDiv(t,"div"))}),n}(o,s);if(e){var l=(a=i.Sign.wrapTerm(a)).is_group("sign")?a.children[0]:a.get_child([0,1,0]);n.forEach(function(t){return r.extendNodeMap(t,l)})}return a},n(0);var i=n(3),r=n(2),o=n(24)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddSubInvertAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),s=n(1),a=n(2),l=(n(5),n(9),n(108)),u=n(60),c=n(111),d=(n(26),n(15)),h=n(12),p=(i=n(4))&&i.__esModule?i:{default:i},f=e.AddSubInvertAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"AddSubInvertAction","apply an inverse operation to both sides of a relation"));return n.priority=0,n.triggerType="drag",n.settings={side:"around"},t&&(t.settings&&o.gmath.extend(n.settings,t.settings),n.settings.allow_drag_across_relation=h.MathSettings.get("allow_drag_across_relation"),n.settings.simplify_after_drag_across_relation=h.MathSettings.get("simplify_after_drag_across_relation"),n.initSettings(t)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.Action),r(e,[{key:"inContext",value:function(t){return t in this.settings?this.settings[t]:h.MathSettings.get(t)}},{key:"getAllAvailableActions",value:function(t){if(this.inContext("allow_drag_across_relation")){var e=this.inContext("simplify_after_drag_across_relation"),n=this.matchSource(t,e);if(n){var i=this.getTargets(n,e);return e?this.bindExplicitActions(n,i):this.bindActions(n,i)}return[]}return[]}},{key:"matchSource",value:function(t,e){if(e&&(t.length>1||t[0].is_group("sum")))return!1;var n=t[0],i=n.get_parent(n.is_group("add","sub","addsub")?2:1);return!!i.is_group("equals","lte","gte","lt","gt")&&(i.is_group("equals","lte","gte","lt","gt")?{nodes:t,side:l.Equals.getSideOfTerm(n),eq:i}:void 0)}},{key:"getTargets",value:function(t,e){var n=l.Equals.getOppositeSide(t.nodes[0]);return{sym:t.eq.get_child([1]),terms:n.is_group("sum")&&!e?n.children.slice():[n]}}},{key:"bindExplicitActions",value:function(t,e){return[this.createBoundAction(t.nodes[0].get_root(),{nodes:t.nodes,target:e.terms[0],drop_area:{margin:{y:-.5,x2:"left"===t.side?-1.5:-.2}},destination_hint:{nodes:[t.nodes[0],e.terms[0]],side:"right-of"}})]}},{key:"bindActions",value:function(t,e){var n=this,i=[],r=t.nodes,o=r[0].get_root(),s="left"===t.side?{x1:-.75}:{x2:-.75};return i.push(this.createBoundAction(o,{nodes:r,target:e.sym,settings:{side:"left"===t.side?"right-of":"left-of",margin:s}})),e.terms.forEach(function(t){var e=t.parent.is_group("add","sub","addsub");i.push(n.createBoundAction(o,{nodes:r,target:t,settings:e?{side:"left-of",target_group:!0,group_side:"around",margin:{y:-.5}}:{side:"left-inside",margin:{y:-.5}}})),i.push(n.createBoundAction(o,{nodes:r,target:t,settings:e?{side:"right-of",target_group:!0,group_side:"around",margin:{y:-.5}}:{side:"right-inside",margin:{y:-.5}}}))}),i}},{key:"transform",value:function(t){var e=this.inContext("simplify_after_drag_across_relation"),n=this.getSourceAndTarget(!0);this.addTouchedNodes(n.source);var i=this.getNewTreeNode(n.source),r=i[0].parent,o=i[i.length-1].get_idx(),a=this.matchSource(i),c=this.getNewTreeNode(n.target),h=this.settings.side;"left-inside"===h&&(h="left-of"),"around"!==h&&"right-inside"!==h||(h="right-of");var p=void 0,f=void 0;if(c.is_group("sym")&&u.Inequality.is_relation(c.parent)&&((c=l.Equals.getOppositeSide(a.nodes[0])).is_group("sum")&&(c="left"===a.side?c.children[0]:c.children[c.children.length-1]),h="left"===a.side?"left-of":"right-of"),c.is_group("sum"))f=c.children[c.children.length-1],p=c;else if(c.is_group("add","sub","addsub"))f=c,p=c.parent;else{var m=c.parent,v=c.get_idx();p=g(c),m.insert(v,p),f=c.parent}if(0===d.Num.get_value(c)&&(c.simplify=!0),this.insertInvertedTermsInSum(i,p,f.get_idx(),h,!0),this.applyInnerAction("AddSubCombineSigns",{actor:f}),e){var y=i[0],b=y.parent;y.is_group("add","sub","addsub")||(b=g(y),r.insert(o,b),o=0),s.Tree.get_leaf_nodes(y).forEach(function(t){return t._anim_use_base_pos=!0}),this.insertInvertedTermsInSum(this.nodes,b,o,"right-of")}else s.Tree.remove_range(i);return e||r.is_group("sum")||a.eq.insert("left"===a.side?0:2,new d.Num(0)),p.parent.is_group("add","sub","addsub")?this.cleanup(p.parent):this.cleanup(p),i[0].is_group("add","sub","addsub")&&this.cleanup(r),"function"==typeof t&&t(this),this}},{key:"insertInvertedTermsInSum",value:function(t,e,n,i){var r=this,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];t[0].is_group("sum")&&(t=t[0].children);var a=s.Tree.clone(t);(1===this.nodes.length&&this.nodes[0].is_group("sum")?this.nodes[0].children:this.nodes).forEach(function(t,e){return r.extendNodeMap(t.get_mapping_to(a[e]))}),a[0].is_group("add","sub","addsub")?a.forEach(function(t){return t.invert()}):a=[new c.AddSub(a[0],"sub")],s.Tree.insert_range(e,"left-of"===i?n:n+1,a),o&&this.setNodesToReselectAfterAction(a),1===a.length&&this.applyInnerAction("AddSubCombineSigns",{actor:a[0]})}}]),e}();function g(t){var e=new c.Sum;return t.remove(),t=new c.AddSub(t),e.append(t),e}(0,p.default)(f,!0)},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.GMLHLGMHandler=h;var i=n(0),r=n(3),o=n(5),s=n(1),a=n(35),l=n(367),u=n(366),c=n(365),d=[new l.GMLHLGMSquishAction,new u.GMLHLGMCrossEquals,new c.GMLHLGMPlaceholder];function h(t,e){this.id=i.gmath.uid(),this.view=t,this.interaction_handler=e,this.derivation=t.derivation,this.dx=0,this.dy=0,this.finger_delta={x:0,y:0},this.x_offset=0,this.nodes=[],this.leaf_nodes=[],this.bbox=null,this.actions=[],this.on_release_action=null,this.target_areas=null,this.active=!1,this.bestHit=null,this.actionCount=0}function p(t){return 1===t.length&&t[0].is_group("add","sub","addsub","mul","div")?[t[0].children[1]]:t}function f(t,e){var n=a.HitTester.getBoundingBox(p([t]),0);return n.x-=e,n.width=2*e,n.y-=1.5*e,n.height=3*e,n}h.debug_draw=!0,h.prototype.check=function(t,e){var n=t.pos0[0]-t.pos[0],i=t.pos0[1]-t.pos[1];return(1!==t.fingers.length||0!==e.length)&&n*n+i*i>=64},h.prototype.isActive=function(){return this.active},h.prototype.start=function(e,n){var i=this;return this.actionCount=0,!0===this.view.settings.get("hide_mouse_cursor")&&t.select("html").style("cursor","none"),this.derivation&&this.derivation.setLastHandleVisibility(!1),this.active=!0,this.setDragNodes(h.process_selection(n)),this.center=this.getCenter(this.nodes),this.interaction_handler.events.on("keydown."+this.id,function(t){18!==t.keyCode&&32!==t.keyCode||i.selectNodesOneLevelUp(!0)}),this.view.model.hide_nodes()&&(this.view.renderer.set_style(this.nodes),this.view.update_style()),this.view.enter_and_exit(!1,"shadow"),this.setupActions(),this.nodes},h.prototype.getCenter=function(t){var e=a.HitTester.getBoundingBox(p(t));return[e.x+e.width/2,e.y+e.height/2]},h.prototype.getCenterOffset=function(t){return"touch"===t?{x:0,y:this.view.settings.get("drag_dy_on_touch")*this.view.model.children[0].size}:{x:0,y:0}},h.prototype.setDragNodes=function(t){this.nodes.forEach(function(t){t.dragging=!1}),this.nodes=t,this.nodes.forEach(function(t){t.dragging=!0}),this.leaf_nodes=s.Tree.filter(function(t){return!t.has_children()},t)},h.prototype.selectNodesOneLevelUp=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.stopAllTimeouts(),!this.nodes[0].parent.is_root()){var e=[];return this.nodes[0].is_group("mul","div")?((e=r.MulDiv.groupWithSiblings(this.nodes,!0)).length===this.nodes.length&&(e=r.MulDiv.groupWithSiblings(this.nodes)),e.length===this.nodes.length&&(e=[this.nodes[0].parent])):this.nodes.forEach(function(n){var i=!t&&n.parent.is_group("param","equals","gt","gte","lt","lte")?n:n.parent;i.is_group("param")&&(i=i.parent),e.push(i)}),this.updateSelection(e)}},h.prototype.onTap=function(t){t&&t.is_group("equals","gt","gte","lt","lte")||this.updateSelection(s.Tree.nodes_to_range(this.nodes.concat([t])))},h.prototype.updateSelection=function(t){var e=h.process_selection(t),n=this.nodes[0].x-this.nodes[0].x0,i=this.nodes[0].y-this.nodes[0].y0;this.setDragNodes(e),this.view.model.hide_nodes()&&(this.view.renderer.set_style(this.nodes),this.view.update_style()),this.interaction_handler.highlight_nodes(this.nodes),this.view.renderer.set_position(this.view.model,!1);for(var r=0;r<this.nodes.length;r++)this.nodes[r].for_each(function(t){t.x+=n,t.y+=i});return this.view.enter_and_exit(!1,"shadow"),this.view.update_existing(!1,"shadow"),this.view.updateDraggedNodes(this.leaf_nodes),this.setupActions(),this.center=this.getCenter(this.nodes),this.nodes},h.prototype.update=function(t){var e,n=t.dx,i=t.dy;this.dy+=i,this.dx+=n,this.finger_delta.x+=n,this.finger_delta.y+=i,(e=this.finger_delta).x*e.x+e.y*e.y>9&&this.bestHit&&this.derivation.settings.get("auto_trigger_actions")&&this.stopAllTimeouts();var r=t.sourceEvent.fingers;if(this.nodes.every(function(t){return t.squished}))s.Tree.for_each(function(t){t.x+=n,t.y+=i},this.nodes);else if(r.length===this.nodes.length&&2===r.length)for(var o=0;o<this.nodes.length;o++){var a=this.nodes[o],l=r[o];l.changed&&a.for_each(function(t){t.x+=l.dx,t.y+=l.dy})}else s.Tree.for_each(function(t){t.x+=n,t.y+=i},this.nodes);this.bbox.x+=n,this.bbox.y+=i,this.center[0]+=n,this.center[1]+=i,this.updateActions(),this.view.updateDraggedNodes(this.leaf_nodes),h.debug_draw&&this.debugDraw(!0)},h.prototype.setupActions=function(){var t=this;this.bestHit=null,this.finger_delta={x:0,y:0},this.view_box=this.view.getBBox({no_padding:!0});var e=this.nodes.length>0?.1*this.nodes[0].size:.1*this.view.settings.get("font_size");this.bbox=a.HitTester.getBoundingBox(p(this.nodes),0),this.bbox.x-=e,this.bbox.width=2*e,this.bbox.y-=1.5*e,this.bbox.height=3*e;var n=[];d.forEach(function(e){n=n.concat(e.getAllAvailableActions(t.nodes))}),this.actions=n,this.actions[0],a.HitTester.setTargetRegions(this.actions,this.view.settings.get("font_size"),this.view_box),h.debug_draw&&this.debugDraw(!0),this.derivation.settings.get("show_area_hints")&&a.HitTester.drawDropAreaHints(this.view.main,this.actions)},h.prototype.getSubstitutionActions=function(){var t=this;if(!this.derivation)return[];var e=this.derivation.getRowByView(this.view);e||(e=this.derivation.getLastRow());var n=this.derivation.pos.x-this.derivation.dims.x+e.pos[0],r=this.derivation.pos.y-this.derivation.dims.y+e.pos[1],o=[];return this.derivation.getAllDLs().forEach(function(e){var s=e.getLastRow(),a=s.model;if(a.id!==t.view.model.id){var l=a.getMoveActions(t.nodes,[i.gmath.actions.DirectSubstitutionAction]);l.forEach(function(t){t.target_ih=s.view.interaction_handler,t.settings.offset={x:e.pos.x-e.dims.x+s.pos[0]-n,y:e.pos.y-e.dims.y+s.pos[1]-r}},t),o=o.concat(l)}}),o},h.prototype.updateActions=function(){var t=this.getBestHit();t?this.handleTargetHit(t):this.handleTargetMiss()},h.prototype.handleTargetHit=function(t){if(this.derivation.settings.get("auto_trigger_actions")?t.settings.no_delay?this.performAction(t):t.timeoutID||this.applyTimeout(t):!t.settings.makes_no_changes||!t.settings.no_delay&&t.settings.on_release?this.on_release_action=t:this.performAction(t),this.bestHit!==t)if(this.bestHit=t,this.derivation.settings.get("show_area_hints")&&a.HitTester.drawDropAreaHints(this.view.main),this.derivation.settings.get("show_dest_hints"))a.HitTester.drawDestinationHints(this.view.main,t);else if(t.target_ih)t.target_ih.highlight_nodes(t.getTargetsForHighlighting(),!1,!0);else{var e=t.getTargetsForHighlighting();e.length>0&&this.view.interaction_handler.highlight_nodes(this.nodes.concat(e),!1,!0)}},h.prototype.handleTargetMiss=function(){this.bestHit&&(this.bestHit=null,this.derivation.settings.get("show_area_hints")&&a.HitTester.drawDropAreaHints(this.view.main,this.actions),this.derivation.settings.get("show_dest_hints")?a.HitTester.drawDestinationHints(this.view.main):this.unhighlightTargetNodes(),this.derivation.settings.get("auto_trigger_actions")?this.stopAllTimeouts():this.on_release_action=null)},h.prototype.getBestHit=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.nodes.length>0?.1*this.nodes[0].size:.1*this.view.settings.get("font_size"),n=this.actions.find(function(t){return"GMLHLGMSquishAction"===t.name});if(n){var i=f(p([n.nodes[0]])[0],e),r=f(p([n.nodes[1]])[0],e),o=a.HitTester.getHits([n],i),s=a.HitTester.getHits([n],r);if(o.length>0&&s.length>0)return n}var l=this.actions.filter(function(t){return"GMLHLGMCrossEquals"===t.name||"GMLHLGMPlaceholder"===t.name}),u=a.HitTester.getHits(l,this.bbox);t&&(u=u.filter(function(t){return!t.settings.delay})),this.isTooFarFromAView()&&(u=u.filter(function(t){return t.source_am}));var c=a.HitTester.getHighestPriorityHit(u,this.bbox);return c&&c.settings&&c.settings.dummy&&(c=null),c},h.prototype.isTooFarFromAView=function(){if(!this.bbox)return!1;var t=this.bbox.x+this.bbox.width/2,e=this.bbox.y+this.bbox.height/2,n=this.view_box,i=2*this.view.settings.get("font_size");return t<n.x-i||t>n.x+n.width+i||e<n.y-i||e>n.y+n.height+i},h.prototype.performAction=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.derivation.settings.get("auto_trigger_actions")&&this.stopAllTimeouts(),this.derivation.settings.get("show_dest_hints")&&a.HitTester.drawDestinationHints(this.view.main),h.debug_draw&&this.debugDraw(!1),this.dy=0,this.dx=0;var n={};s.Tree.for_each(function(t){n[t.id]={x:t.x,y:t.y}},this.nodes);var i=t.oldTree,r=i!==this.view.model;r&&i.startInteraction(),t=t.oldTree.performAction(t),this.actionCount++,r&&(i.finishInteraction(),i.for_each(function(t){return t.selected=!1}),i.hide_nodes(),this.view.render(!1)),this.derivation&&this.derivation.setLastHandleVisibility(!1);var o=h.getNewSelectionAfterAction(t,this.nodes);if(!e){if(0===o.length)return console.warn("No follow-up nodes selected! Check node_maps of action "+t.name+"!"),void this.interaction_handler.abort_interaction();var l=a.Reselector.getNewSelection(o);o=l||o,t.settings.is_join_action&&!l||(t.settings.is_join_action=!1),t.settings.is_join_action&&!l||(t.settings.is_join_action=!1),this.interaction_handler.highlight_nodes(o),this.setDragNodes(o),this.correctNodePositions(this.nodes,t,n),this.view.model.hide_nodes(),(t.settings.reset_x||t.settings.reset_y)&&this.resetPositionOfDraggedNodes(t.settings.reset_x,t.settings.reset_y),t.settings.makes_no_changes||this.alignExpressionAroundDraggedNodes(t.settings.is_join_action),this.center=this.getCenter(this.nodes),this.view.enter_and_exit(!1,"shadow"),this.view.update_existing(!0,"both"),this.view.updateDraggedNodes(this.leaf_nodes),this.setupActions()}},h.getNewSelectionAfterAction=function(t,e){var n=t.new_selection?t.new_selection:t.mapNodes(e);return function(t){if(t.length<2)return t;var e=0;t[0].get_root().for_each(function(t){t.order_num=e++}),t.sort(function(t,e){return t.order_num-e.order_num})}(n),h.process_each_selection(n)},h.prototype.correctNodePositions=function(t,e,n){var i;if((!e.settings.makes_no_changes||e.settings.update_node_positions)&&(s.Tree.select_first(function(n){if(!n.has_children()){var r=e.mapNodes(n);if(1!==r.length||r[0].has_children())return!1;var o=s.Tree.select_first(function(t){return t===r[0]},t);return!!o&&(i={old:n,new:o},!0)}},e.nodes),i)){var r=n[i.old.id].x-i.new.x0,o=n[i.old.id].y-i.new.y0;s.Tree.for_each(function(t){t.x=t.x0+r,t.y=t.y0+o},t)}},h.prototype.resetPositionOfDraggedNodes=function(t,e){this.nodes.forEach(function(n){n.for_each(function(n){t&&(n.x=n.x0),e&&(n.y=n.y0)})})},h.prototype.alignExpressionAroundDraggedNodes=function(t){if(!a.HitTester.boxIsLeftOrRightOfViewBox(a.HitTester.getBoundingBox(this.nodes),this.view_box)){if(t){for(var e=0,n=0;n<this.nodes[0].children.length;n++)e+=this.nodes[0].children[n].sel_box.width;this.x_offset=this.center[0]+e/2-this.nodes[0].x0}else this.x_offset=this.nodes[0].x-this.nodes[0].x0;this.applyHorizontalShiftToRestingNodes(this.x_offset),t?s.Tree.for_each(function(t){t.x0+=this.x_offset,t.x+=this.x_offset}.bind(this),this.nodes):s.Tree.for_each(function(t){t.x0+=this.x_offset}.bind(this),this.nodes)}},h.prototype.applyHorizontalShiftToRestingNodes=function(t){var e=this.view.model.filter(function(t){return!t.dragging});(e=e.filter(function(t){for(var e=t;e=e.parent;)if(e.dragging)return!1;return!0})).forEach(function(e){e.x+=t,e.x0+=t})},h.prototype.debugDraw=function(t){t?a.HitTester.draw(this.view.main,this.actions,this.bbox):a.HitTester.draw(this.view.main)},h.prototype.end=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.select("html").style("cursor",null),this.interaction_handler.events.on("keydown."+this.id,null),this.unhighlightTargetNodes(),this.setDragNodes([]),this.view.enter_and_exit(!0,"shadow");var n=!0;if(e){var i=this.on_release_action||this.getBestHit(!1);i&&(this.performAction(i,!0),this.actionCount++,n=i.settings&&i.settings.makes_no_changes&&"squish"!==i.settings.side)}return n&&(this.view.model.hide_nodes(),this.view.render()),this.derivation&&this.derivation.setLastHandleVisibility(!0),this.stopAllTimeouts(),this.actions=[],this.bestHit=null,this.bbox=null,this.active=!1,this.dy=0,this.dx=0,h.debug_draw&&this.debugDraw(!1),this.derivation.settings.get("show_area_hints")&&a.HitTester.drawDropAreaHints(this.view.main),this.derivation.settings.get("show_dest_hints")&&a.HitTester.drawDestinationHints(this.view.main),this.actionCount},h.prototype.applyTimeout=function(t){var e=this.view.settings.get("trigger_delay_factor"),n=this.view.settings.get("trigger_delay_minimum"),i=t.settings.delay?Math.max(t.settings.delay*e,n):null;this.finger_delta.x=0,this.finger_delta.y=0,t.timeoutID=setTimeout(function(){t.settings.on_release?(this.on_release_action=t,this.finger_delta={x:0,y:0}):this.performAction(t)}.bind(this),Math.max(i,n))},h.prototype.stopAllTimeouts=function(){this.on_release_action=null;for(var t=0;t<this.actions.length;t++){var e=this.actions[t];e.timeoutID&&this.clearActionTimeout(e)}},h.prototype.clearActionTimeout=function(t){clearTimeout(t.timeoutID),delete t.timeoutID,delete t.dx,delete t.dy},h.prototype.unhighlightTargetNodes=function(){this.actions.forEach(function(t){t.target_ih&&t.target_ih.highlight_nodes([],!1,!0)})},h.process_each_selection=function(t){if(0===t.length)return[];var e=[];return o.AlgebraModel.groupNodeRanges(t).map(function(t){return h.process_selection(t)}).forEach(function(t){e=i.gmath.array.mergedNew(e,t)}),e},h.process_selection=function(t){var e=t.slice();if(0===e.length)return[];if(h.special_selection(e))return h.special_selection(e);if(e[0].commutative){var n=e[0].parent;if(e.length<n.children.length)return e;e=[n]}for(var i=e[0];!o.AlgebraModel.is_top_most(i)&&!i.parent.is_group("equals","gte","lte","gt","lt")&&!i.commutative&&!i.is_group("exponent","degree")&&!i.parent.is_group("param")&&(!i.parent.is_group("radical")||i.parent.children[3]!==i)&&(!i.is_group()||i.is_group("tuple")||1!==i.get_idx()||!i.parent.is_group("brackets")||r.Brackets.areHidden(i.parent));)i=i.parent;return 1===i.get_idx()&&i.parent&&r.Inequality.is_relation(i.parent)&&(i=i.parent),[i]},h.special_selection=function(t){if(1!==t.length)return!1;var e=t[0];return!e.fixed&&e.parent.is_group("subscript","superscript")?t:"-"===e.to_ascii()||"±"===e.to_ascii()?t:"|"===e.to_ascii()&&0===e.get_idx()?t:(r.Num.is_num(e)&&e.parent.is_group("sign")&&(e=e.parent),!!(r.Num.is_equal_to(e,-1)&&e.parent.is_group("brackets")&&e.get_parent(2).is_group("power")&&e.get_parent(2).is_square_root())&&[e])},i.gmath.GMLHLGMHandler=h}).call(this,n(6))},function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.InteractionHandler=c;var r=n(0),o=n(61),s=n(106),a=n(1),l=n(20),u=n(103);function c(e,n,i){this.id=r.gmath.uid(),this.send_events=!0,this.events=t.dispatch("tap","dbltap","drag_start","drag","drag_end","touch","release","hold","inspect_node","keyup","keydown","node_selection"),this.view=e,this.dl=e.derivation,this.canvas_model=this.dl?this.dl.canvas_model:null,this.recorder=i,this.interactive=n,this.init(),n||this.set_interactive(!1),this.selected_nodes=[],this.handlers={edit:[new u.GMLHLGMHandler(this.view,this)],inspect:[new o.ChangeNumberHandler(this.view,this)]},this.active_handler=null,this.active_action=null,this.ignore_next_release_event=!1,this.only_synchronous_actions=!1,this.always_visualize_fingers=!1,this.finger_vis=null,this.notice_timer=null,this.expand_selections_to_range=!1,this.highlight_selected_nodes=!1}function d(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t[0],i=t[1];return function(t){var r=(e?t.x0:t.x)+t.sel_box.x+t.sel_box.width/2-n,o=(e?t.y0:t.y)+t.sel_box.y+t.sel_box.height/2-i,s=Math.abs(r)<=t.sel_box.width/2&&Math.abs(o)<=t.sel_box.height/2;return{node:t,score:(s?1e6:0)-(r*r+o*o),hit:s,dx:r,dy:o}}}c.prototype.getHandlerByClass=function(t){var e=function(e){return e instanceof t};for(var n in this.handlers){var i=this.handlers[n].filter(e);if(i.length>0)return i[0]}},c.prototype.start_of_interaction=function(){this.view.model.startInteraction()},c.prototype.end_of_interaction=function(t){this.view.model.finishInteraction(t)},c.prototype.init=function(){var e=this.view.main.node();this.mtouch=r.gmath.mtouch_events().frame(e).hold_time(this.view.settings.get("hold_time")),this.view.event_receiver.call(this.mtouch),this.mtouch.on("touch",this.on_touch.bind(this,null)).on("release",this.on_release.bind(this,null)).on("tap",this.on_tap.bind(this,null)).on("dbltap",this.on_dbltap.bind(this,null)).on("hold",this.on_hold.bind(this,null));var n=(0,s.drag_behavior)().on("drag-start",this.on_drag_start.bind(this,null)).on("drag",this.on_drag.bind(this,null)).on("drag-end",this.on_drag_end.bind(this,null));this.mtouch.call(n),t.select(document).on("keydown."+this.id,this.on_keydown.bind(this,null)),t.select(document).on("keyup."+this.id,this.on_keyup.bind(this,null))},c.prototype.abort_interaction=function(){this.active_handler&&this.active_handler.end(),this.active_handler=null,this.highlight_nodes([])},c.prototype.cancelDraggingIfDragging=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.active_handler&&!this.active_action&&(this.active_handler.end(),this.active_handler=null,this.end_of_interaction(),this.ignore_next_release_event=!0,this.highlight_nodes([]),t.preventDefault&&t.preventDefault())},c.prototype.modeChanged=function(t){this.interactive||this.mtouch.connected("inspect"===t)},c.prototype.set_interactive=function(t){this.interactive=!!t,"inspect"===this.view.settings.get("interaction_mode")?this.mtouch.connected(!0):this.mtouch.connected(this.interactive)},c.prototype.select_new_handler=function(t){for(var e=this.handlers[this.view.settings.get("interaction_mode")]||[],n=0;n<e.length;n++){var i=e[n];if(i.check(t,this.selected_nodes))return this.active_handler=i,void this.highlight_nodes(i.start(t.pos,this.selected_nodes))}},c.prototype.on_keydown=function(e){var n=e||t.event;function i(){this.highlight_nodes(this.selected_nodes.map(function(t){return this.get_user_selection(null,null,{altKey:!0},t)},this).reduce(function(t,e){return t.concat(e[0])},[])),this.mtouch.fingers().forEach(function(t){t.cancel_hold()})}if(16===n.keyCode);else if(18===n.keyCode)this.mtouch.fingers().length>0&&this.selected_nodes.length>0&&i.call(this);else if(32===n.keyCode)this.spaceBarDown=!0,this.mtouch.fingers().length>0&&this.selected_nodes.length>0&&(i.call(this),n.preventDefault&&n.preventDefault(),this.active_handler&&this.active_handler.on_keydown&&this.active_handler.on_keydown(n));else{if(27!==n.keyCode)return;this.cancelDraggingIfDragging(n)}this.active_handler&&n.preventDefault&&n.preventDefault(),this.send_events&&!r.gmath.ui.Keyboard().visible()&&this.events.keydown(new m("down",n,this.id))},c.prototype.on_keyup=function(e){var n=e||t.event;if(16===n.keyCode);else{if(32!==n.keyCode)return;this.spaceBarDown=!1}this.active_handler&&n.preventDefault&&n.preventDefault(),this.send_events&&!r.gmath.ui.Keyboard().visible()&&this.events.keyup(new m("up",n,this.id))},c.prototype.on_tap=function(e){var n=this,i=this.view.settings.get("interaction_mode");if(!this.active_action){var r=this.selectInputEvent(e,t.event);if(!r.shiftKey||"inspect"===i){var o,s=this.get_closest_node_at(r.finger.pos);if(s&&(o=this.getFirstUnfixedParent(s)),this.active_handler)this.active_handler.onTap&&this.active_handler.onTap(o);else if(this.send_events&&this.events.tap(new f(r,this.id,s,o)),o&&("inspect"===i&&(this.highlight_nodes([]),this.events.inspect_node({node:o,shiftKey:r.shiftKey||this.touch_shift}),0===r.fingers.length&&this.end_of_interaction(!0)),"edit"===i)){var a=this.view.model.getBestMatchingBoundAction(o,"tap");this.performAction(a,!1,function(){a||(n.canvas_model&&n.view.model.getBestMatchingBoundAction(o,"dbltap")?n.notice_timer=setTimeout(function(){n.canvas_model.showNotice("Try to double tap.",!0),n.view.model.events.mistake({target:o,method:"tap",model:n.view.model}),n.giveMistakeFeedback(o)},250):(n.view.model.events.mistake({target:o,method:"tap",model:n.view.model}),n.giveMistakeFeedback(o)))})}}}},c.prototype.on_dbltap=function(e){var n=this,i=this.view.settings.get("interaction_mode");if(!this.active_action){var r=this.selectInputEvent(e,t.event);if(!(this.active_handler||r.shiftKey&&"inspect"!==i)){var o,s=this.get_closest_node_at(r.finger.pos);s&&(o=this.getFirstUnfixedParent(s)),this.send_events&&this.events.tap(new g(r,this.id,s,o)),o&&("edit"===i?this.view.model.process_operator(o,function(t){n.end_of_interaction(!t),n.highlight_nodes([]),clearTimeout(n.notice_timer)},"dbltap"):"inspect"===i&&(this.highlight_nodes([]),this.events.inspect_node({node:o,shiftKey:r.shiftKey||this.touch_shift}),this.end_of_interaction(!0)))}}},c.prototype.on_hold=function(e){var n=this.view.settings.get("interaction_mode");if(!this.active_action){var i=this.selectInputEvent(e,t.event);if(!this.active_handler&&"edit"===n){this.send_events&&this.events.hold(new v(i,this.id));var r=this.get_closest_node_at(i.finger.pos);if(r&&"edit"===n){var o=this.view.model.getBestMatchingBoundAction(r,"hold");o&&this.performAction(o)}}}},c.prototype.performAction=function(t,e,n){if(!(this.only_synchronous_actions&&t&&t.settings.asynchronous)){this.active_action=t;var i=null;if(t&&t.settings.asynchronous){var r=t.nodes||[t.actor]||[];1===r.length&&"AlgebraModel"===r[0].type&&(r=[r[0].children[0]]),this.highlight_nodes(r,!0,!0),this.canvas_model&&(i=this.canvas_model.scroll(),this.canvas_model.scrollToShowElement(this.dl))}this.view.model.performAction(t,function(t){this.active_action=null,n&&n(),this.end_of_interaction(),this.highlight_nodes([]),null!==t&&this.canvas_model.scroll(t)}.bind(this,i),e)}},c.prototype.getFirstUnfixedParent=function(t){for(;t.fixed&&t.parent&&"AlgebraModel"!==t.parent.type;)t=t.parent;return t},c.prototype.selectInputEvent=function(t,e){if(t)return t;for(var n=e;n.sourceEvent;)n=n.sourceEvent;return e.shiftKey=n.shiftKey,e.altKey=n.altKey,e},c.prototype.on_drag_start=function(e){var n=this.view.settings.get("interaction_mode");if(!this.active_action&&(this.interactive||"inspect"===n)){var i=this.selectInputEvent(e,t.event),r=this.selected_nodes.slice();if(this.active_handler)this.send_events&&this.events.drag_start(new p(i,this.id,r));else{if(this.selected_nodes.length>1){var o=this.expand_selections_to_range?a.Tree.nodes_to_range(this.selected_nodes):this.selected_nodes;this.highlight_nodes(o)}this.select_new_handler(i),this.send_events&&this.events.drag_start(new p(i,this.id,r,this.selected_nodes))}}},c.prototype.update_fingers=function(e,n){if(!this.finger_sel){var i=this.view.main.node();this.finger_sel=t.select(i).selectAll(".finger");var r=t.touches(i,[{pageX:0,pageY:0,clientX:0,clientY:0}])[0],o=t.touches(this.view.main.node(),[{pageX:0,pageY:0,clientX:0,clientY:0}])[0];this.dpos_finger_vis=[o[0]-r[0],o[1]-r[1]],this.finger_vis_start=Date.now()}var s=this.finger_sel.data(e);n||s.enter().append("div").classed("finger",!0).style({border:"2px solid rgba(77,77,77,0.5)","background-color":"rgba(178,202,237,0.5)",width:"25px",height:"25px","border-radius":"50%",position:"absolute"}).transition().ease("bounce").style({width:"20px",height:"20px"});var a=this.dpos_finger_vis;s.style("transform",function(t){return"translate("+(t.pos[0]-a[0]-10)+"px,"+(t.pos[1]-a[1]-10)+"px)"}),s.style("-webkit-transform",function(t){return"translate("+(t.pos[0]-a[0]-10)+"px,"+(t.pos[1]-a[1]-10)+"px)"});var l=this.finger_vis_start;s.exit().transition().delay(Math.max(0,250-(Date.now()-l))).style("opacity",1e-4).remove(),this.finger_sel=0===s.size()?null:s},c.prototype.on_drag=function(e){var n=this.view.settings.get("interaction_mode");if(!this.active_action&&(this.interactive||"inspect"===n)){var i=this.selectInputEvent(e,t.event);this.send_events&&this.events.drag(new y(i,this.id,this.selected_nodes)),(e||this.always_visualize_fingers)&&this.update_fingers(i.fingers,!0),this.active_handler||this.select_new_handler(i),this.active_handler&&this.active_handler.update(i)}},c.prototype.on_drag_end=function(t){this.send_events&&this.events.drag_end(new b(this.uid))},c.prototype.on_touch=function(e){var n=this.view.settings.get("interaction_mode");if(!this.active_action&&(this.interactive||"inspect"===n)){i(window).focus();var o=this.selectInputEvent(e,t.event);if((e||this.always_visualize_fingers)&&this.update_fingers(o.fingers),this.active_handler)this.send_events&&this.events.touch(new _(o,this.id));else{"inspect"===n&&o.sourceEvent&&"touchstart"===o.sourceEvent.type&&o.sourceEvent.touches.length>1?this.touch_shift=!0:(this.touch_shift&&"touchstart"===o.sourceEvent.type&&o.sourceEvent.touches.length<2||this.touch_shift&&"mousedown"===o.sourceEvent.type)&&delete this.touch_shift;var s,a=this.get_user_selection(o.finger,null,o);a[0].parent.squished?(this.start_of_interaction(),s=this.view.model.filter(function(t){return t.squished})):"edit"===n&&1===o.fingers.length?(o.shiftKey||this.start_of_interaction(),o.shiftKey?s=r.gmath.array.xor(this.selected_nodes,a):r.gmath.array.containsAll(this.selected_nodes,a)||(s=a)):"edit"===n&&2===o.fingers.length?s=this.get_user_selection(o.fingers[0],o.fingers[1],o):"inspect"===n&&1===o.fingers.length&&(this.start_of_interaction(),r.gmath.array.containsAll(this.selected_nodes,a)||(s=a)),this.send_events&&this.events.touch(new _(o,this.id,a,s||this.selected_nodes)),s&&this.highlight_nodes(s)}}},c.prototype.on_release=function(e){var n=this.view.settings.get("interaction_mode");if(this.interactive||"inspect"===n){var i=this.selectInputEvent(e,t.event);if((e||this.always_visualize_fingers)&&this.update_fingers(i.fingers),this.ignore_next_release_event)this.ignore_next_release_event=!1;else if(this.send_events&&this.events.release(new x(i,this.id)),0===i.fingers.length){var r=i.shiftKey;if(this.active_handler){this.active_handler instanceof o.SelectionHandler&&(r=!0);var s=void 0,l=void 0;this.active_handler instanceof o.DragHandler&&(l=this.active_handler.nodes.slice(),(s=this.get_closest_node_origin_at(this.active_handler.center))&&(s.node=this.getFirstUnfixedParent(s.node)));var u=this.active_handler.end();if(!this.active_action&&this.active_handler instanceof o.DragHandler&&0===u&&s){var c=s&&s.node&&!!a.Tree.select_first(function(t){return t===s.node},l);this.view.model.events.mistake({target:s&&s.node,selection:l,model:this.view.model,side:s&&s.hit?"inside":"outside",method:"drag",dx:s&&s.dx,dy:s&&s.dy,dropOnSelf:c})}this.active_handler=null}i.isTapOrDoubleTap||this.active_action||r||(this.end_of_interaction(),this.highlight_nodes([]))}}},c.prototype.get_user_selection=function(t,e,n,i){var r;if(e)r=this.get_nodes_between(t.pos,e.pos);else{var o=i||this.get_closest_node_at(t.pos);if(!o)return[];if(o=this.getFirstUnfixedParent(o),n.altKey||this.spaceBarDown){for(;o.parent.parent&&!o.parent.commutative;)o=o.parent;var s=o.parent.parent;r=s&&s.is_group("fraction")?o.parent.is_group("mul")?s.get_top():s.get_bottom():o.parent.commutative?[o.parent.parent]:"AlgebraModel"===o.parent.type?[o]:[o.parent]}else r=[o]}return(this.expand_selections_to_range?a.Tree.nodes_to_range(r):e?r=(r=[r[0],r[r.length-1]]).map(function(t){return t.parent.commutative?t.parent:t}):r).filter(function(t){return function(t){return e=[[0,0,0],[0,0,1],[0,0,0,0],[0,0,0,1],[0,0,1,0],[0,0,1,1]],n=t.get_path(),e.some(function(t){if(n.length!==t.length)return!1;var e=!0;return t.forEach(function(t,i){n[i]!==t&&(e=!1)}),e});var e,n}(t)})},c.prototype.highlight_nodes=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!r.gmath.array.equals(this.selected_nodes,t)){if(this.selected_nodes=t,this.highlight_selected_nodes){var i=this.view;a.Tree.for_each(function(t){t.selected=!1},i.model.children);for(var o=0;o<t.length;o++)t[o].selected=!0;i.renderer.set_style(i.model.children),i.update_style(!e)}!n&&this.send_events&&this.events.node_selection(new w(this.id,t))}},c.prototype.get_closest_node_at=function(t){t[0],t[1];var e=a.Tree.get_leaf_nodes(this.view.model).filter(function(t){return t.sel_box&&!t.hidden}).map(d(t));return e.sort(function(t,e){return e.score-t.score}),e[0].node},c.prototype.get_closest_node_origin_at=function(t){var e=a.Tree.get_leaf_nodes(this.view.model).filter(function(t){return t.sel_box&&!t.hidden}).map(d(t,!0));return e.sort(function(t,e){return e.score-t.score}),e[0]},c.prototype.get_nodes_between=function(t,e){return a.Tree.get_leaf_nodes(this.view.model).filter(function(n){if(n.hidden||!n.sel_box||"//"==n.value)return!1;var i=[n.x+n.sel_box.x+n.sel_box.width/2,n.y+n.sel_box.y+n.sel_box.height/2],r=h(t,e,i),o=n.sel_box.width/4+n.sel_box.height/4;return 0==r.len?r.dist<=o+0:r.k>=0&&r.k<=1&&r.dist<=o+0})},c.prototype.giveMistakeFeedback=function(t){var e=this,n=l.Func.isTriggerableFuncPart(t);if(n&&!n.isCustomFunction||t.is_group("sym")&&("+"===t.value||"-"===t.value||"±"===t.value||"*"===t.value||"//"===t.value)){var i=[];i=t.parent.is_group("mul","add","sub","addsub")?(i=[t.parent.ls&&t.parent.ls.children[1],t.parent.children[1]]).filter(function(t){return t}):n?[n.get_arg()]:t.parent!==t.get_root()?[t.parent]:[t],this.view.shakeNodes(i,!0),setTimeout(function(){e.view.shakeNodes(e.view.model,!1)},600)}};var h=function(t,e,n){var i=.5,r=[e[0]-t[0],e[1]-t[1]],o=Math.sqrt(r[0]*r[0]+r[1]*r[1]);if(o<1e-6)s=t[0]-n[0],a=t[1]-n[1],o=0;else{var s,a,l=[n[0]-t[0],n[1]-t[1]];(i=(r[0]*l[0]+r[1]*l[1])/o)<0?(s=t[0]-n[0],a=t[1]-n[1]):i>o?(s=e[0]-n[0],a=e[1]-n[1]):(s=t[0]+i*r[0]/o-n[0],a=t[1]+i*r[1]/o-n[1])}return{dist:Math.sqrt(s*s+a*a),k:i/o,len:o}},p=function(t,e,n,i){this.type="drag_start",this.performee=e,this.performee_type="interaction-handler",this.time=Date.now(),this.pos=[t.pos[0],t.pos[1]],this.pos0=[t.pos0[0],t.pos0[1]],this.dist=t.dist,this.dist0=t.dist0,t.altKey&&(this.altKey=t.altKey),t.shiftKey&&(this.shiftKey=t.shiftKey),this.fingers={length:t.fingers.length},this.target=n,this.selection=i},f=function(t,e,n,i){this.type="tap",this.performee=e,this.performee_type="interaction-handler",this.time=Date.now(),t.altKey&&(this.altKey=t.altKey),t.shiftKey&&(this.shiftKey=t.shiftKey),this.finger={pos:[t.finger.pos[0],t.finger.pos[1]]},this.target=n,this.selection=i},g=function(t,e,n,i){this.type="dbltap",this.performee=e,this.performee_type="interaction-handler",this.time=Date.now(),t.altKey&&(this.altKey=t.altKey),t.shiftKey&&(this.shiftKey=t.shiftKey),this.finger={pos:[t.finger.pos[0],t.finger.pos[1]]},this.target=n,this.selection=i},m=function(t,e,n){this.type="key"+t,this.performee=n,this.performee_type="interaction-handler",this.time=Date.now(),this.keyCode=e.keyCode},v=function(t,e){this.type="hold",this.performee=e,this.performee_type="interaction-handler",this.time=Date.now(),this.finger={pos:[t.finger.pos[0],t.finger.pos[1]]}},y=function(t,e,n){this.type="drag",this.performee=e,this.performee_type="interaction-handler",this.time=Date.now(),this.dx=t.dx,this.dy=t.dy,this.dist=t.dist,this.dist0=t.dist0,this.pos=[t.pos[0],t.pos[1]],this.pos0=[t.pos0[0],t.pos0[1]],this.fingers=t.fingers.map(function(t){return{pos:[t.pos[0],t.pos[1]]}}),this.selection=n},b=function(t){this.type="drag_end",this.performee=t,this.performee_type="interaction-handler",this.time=Date.now()},_=function(t,e,n,i){this.type="touch",this.performee=e,this.performee_type="interaction-handler",this.time=Date.now(),t.altKey&&(this.altKey=t.altKey),t.shiftKey&&(this.shiftKey=t.shiftKey),t.finger&&(this.finger={pos:[t.finger.pos[0],t.finger.pos[1]],id:t.finger.id}),this.fingers=t.fingers.map(function(t){return{pos:[t.pos[0],t.pos[1]]}}),this.target=n,this.selection=i},x=function(t,e){this.type="release",this.performee=e,this.performee_type="interaction-handler",this.time=Date.now(),this.isTapOrDoubleTap=t.isTapOrDoubleTap,t.altKey&&(this.altKey=t.altKey),t.shiftKey&&(this.shiftKey=t.shiftKey),this.fingers=t.fingers.map(function(t){return{pos:[t.pos[0],t.pos[1]]}}),t.finger&&(this.finger={pos:[t.finger.pos[0],t.finger.pos[1]],id:t.finger.id})},w=function(t,e){this.type="node_selection",this.performee=t,this.performee_type="interaction-handler",this.time=Date.now(),this.selection=e}}).call(this,n(6),n(8))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.transform_behavior=o;var i=n(0),r=n(42);function o(){var e,n,i,o,s,a,l,u,c,d=(0,r.d3_eventDispatch)(b,"transform","transformend","transformstart"),h=[],p=0,f=0,g=0,m=1,v={scale:!0,translate:!0,rotate:!0},y=!0,b=function(){this.on("touch.transform",_).on("mdrag.transform",x).on("release.transform",w)};b.transform=function(t){return arguments.length?("scale"in t&&(m=t.scale),"rotate"in t&&(g=t.rotate),"translate"in t&&(p=t.translate[0],f=t.translate[1]),b):{scale:m,rotate:g,translate:[p,f]}},b.one_finger_drag=function(t){return arguments.length?(y=t,b):y},b.allow_translate=function(t){return arguments.length?(v.translate=t,b):v.translate},b.allow_scale=function(t){return arguments.length?(v.scale=t,b):v.scale},b.allow_rotate=function(t){return arguments.length?(v.rotate=t,b):v.rotate};var _=function(){2!==h.length&&(h.push(t.event.finger),1===h.length&&y&&(e=n=[h[0].pos[0],h[0].pos[1]],i=k(n),d.of(this,arguments)({type:"transformstart"})),2===h.length&&(e=n=M(h[0].pos,h[1].pos),o=s=S(h[0].pos,h[1].pos),a=l=E(h[0].pos,h[1].pos),i=k(n),u=m,c=g))},x=function(){if(0!==h.length&&t.event.dragged_fingers.some(function(t){return t.changed})){if(1===h.length){if(!y)return;v.translate&&(e=[h[0].pos[0],h[0].pos[1]]),T(e,i)}2===h.length&&(v.scale&&(o=S(h[0].pos,h[1].pos)),v.translate&&(e=M(h[0].pos,h[1].pos)),v.rotate&&(a=E(h[0].pos,h[1].pos)),A()),d.of(this,arguments)({type:"transform",fingers:h,transform:{scale:m,rotate:g,translate:[p,f]}})}},w=function(){if(0!==h.length){var r=t.event.finger,o=h.indexOf(r);-1!==o&&(h.splice(o,1),0===h.length&&d.of(this,arguments)({type:"transformend"}),1===h.length&&(e=n=[h[0].pos[0],h[0].pos[1]],i=k(n)))}},A=function(){v.rotate&&(g=c+(a-l)),v.scale&&(m=u*o/s),(v.translate||v.rotate||v.scale)&&T(e,i)},k=function(t){var e=(t[0]-p)/m,n=(t[1]-f)/m,i=Math.cos(-g),r=Math.sin(-g);return[e*i-n*r,n*i+e*r]},T=function(t,e){e=function(t){var e=Math.cos(g),n=Math.sin(g),i=t[0]*e-t[1]*n,r=t[1]*e+t[0]*n;return[i*m+p,r*m+f]}(e),p+=t[0]-e[0],f+=t[1]-e[1]};function S(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}function M(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}function E(t,e){return Math.atan2(t[1]-e[1],t[0]-e[0])}return t.rebind(b,d,"on")}i.gmath.transform_behavior=o}).call(this,n(6))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.drag_behavior=function(){var e,n,r,o,s=(0,i.d3_eventDispatch)(h,"drag","drag-start","drag-end"),a=[],l=!1,u=10,c=5,d=!0,h=function(){this.on("touch.drag",p).on("mdrag.drag",f).on("release.drag",g)};h.min_single_dist=function(t){return 0===arguments.length?u:(u=t,this)},h.min_double_dist=function(t){return 0===arguments.length?c:(c=t,this)},h.allow_double_drag=function(t){return 0===arguments.length?d:(d=t,this)};var p=function(){2===a.length||d&&1===a.length||(a.push(t.event.finger),2===a.length?(e=[(a[0].pos[0]+a[1].pos[0])/2,(a[0].pos[1]+a[1].pos[1])/2],n=[e[0],e[1]],o=r=m(a[0].pos,a[1].pos)):(e=[a[0].pos[0],a[0].pos[1]],n=[e[0],e[1]],r=o=0))},f=function(){if(0!==a.length){var t,i=s.of(this,arguments);if(1===a.length){if(!a[0].changed)return;t=[a[0].pos[0],a[0].pos[1]],!l&&m(e,n)>=u&&(l=!0,i({type:"drag-start",fingers:a,pos0:e,pos:n,dist0:r,dist:o}))}else{if(!a[0].changed&&!a[1].changed)return;t=[(a[0].pos[0]+a[1].pos[0])/2,(a[0].pos[1]+a[1].pos[1])/2],o=m(a[0].pos,a[1].pos),!l&&m(e,n)>=c&&(l=!0,i({type:"drag-start",fingers:a,pos0:e,pos:n,dist0:r,dist:o}))}l&&i({type:"drag",fingers:a,pos0:e,pos:t,dist0:r,dist:o,dx:t[0]-n[0],dy:t[1]-n[1]}),n=t}},g=function(){if(0!==a.length){var i=t.event.finger,r=a.indexOf(i);-1!==r&&(a.splice(r,1),l&&(1===a.length&&(e=[a[0].pos[0],a[0].pos[1]],n=[e[0],e[1]]),0===a.length&&(l=!1,s.of(this,arguments)({type:"drag-end"}))))}};function m(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}return t.rebind(h,s,"on")};var i=n(42)}).call(this,n(6))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.fontPresets=void 0,e.FontLoader=function(e,n){void 0===n&&(n=1e3);var r,o={},s=[];o.fonts=[],o.map={},o.finished=!1,o.success=!1,o.div=t.select("body").append("div").style({position:"absolute",visibility:"hidden",width:"1px",height:"1px",top:0,left:0}),o.on_fonts_loaded=function(t){this.finished?t(this.success):s.push(t)},o.add_fonts=function(t){var e=!1;t.forEach(function(t){var n=a(t);n?t.id=n.id:(t.id=(0,i.uid)(),o.fonts.push(t),e=!0)}),e&&o.wait_for_fonts()};var a=function(t){for(var e=0;e<o.fonts.length;e++){var n=o.fonts[e];if(n.style===t.style&&n.family===t.family&&n.weight===t.weight)return n}return null};return o.wait_for_fonts=function(){r&&clearInterval(r),this.finished=!1,this.success=!1,this.fonts.unshift({family:"serif"});var t=this.div.selectAll("text.temp").data(this.fonts);t.enter().append("span").classed("temp",!0).style("font-size","100px").style("font-family",function(t){return-1===t.family.indexOf(" ")?t.family+", serif":"'"+t.family+"', serif"}).style("font-style",function(t){return t.style}).style("font-weight",function(t){return t.weight}).text("012abc"),t.exit().remove(),this.fonts.shift();var e=Date.now(),i=this;r=setInterval(function(){var a=[],l=!0;t.each(function(t,e){a[e]=this.getBoundingClientRect().width});for(var u=1;u<a.length;u++)a[u]===a[0]&&(l=!1);var c=Date.now()-e;!l&&c<=n||(i.success=l,i.finished=!0,t.remove(),clearInterval(r),function(){o.loadSizes();for(var t=0;t<s.length;t++)s[t](this.success);s=[]}.call(i))},20)},o.loadSizes=function(t,e){t=t||"abcdefghijklmnopqrstuvwxyzABCDEFGHJKLMNOPQRSTUVWXYZ0123456789()=+-*^∗·•−,.√",e=e||this.fonts;for(var n=[],i=0;i<e.length;i++){this.map[e[i].id]||(this.map[e[i].id]={});for(var r=0;r<t.length;r++){var o={font:e[i],char:t[r],width:0,height:0};this.map[e[i].id][t[r]]=o,n.push(o)}}this.div.selectAll(".hiddenChars").data(n).enter().append("span").style("font-size","100px").style("font-family",function(t){return t.font.family}).style("font-style",function(t){return t.font.style}).style("font-weight",function(t){return t.font.weight}).text(function(t){return t.char}).each(function(t){var e=this.getBoundingClientRect();t.width=e.width,t.height=e.height}).remove()},o.width=function(t,e,n){for(var i=0,r=0;r<t.length;r++)this.map[n.id]&&this.map[n.id][t[r]]||this.loadSizes(t[r],[n]),i+=this.map[n.id][t[r]].width;return i*e/100},o.height=function(t,e,n){for(var i=0,r=0;r<t.length;r++)this.map[n.id]&&this.map[n.id][t[r]]||this.loadSizes(t[r],[n]),i=Math.max(this.map[n.id][t[r]].height,i);return i*e/100},o.add_fonts(e),o};var i=n(7),r=n(10);e.fontPresets={Kalam:"Font_Kalam"},new r.SettingsType("Font_Kalam").defaults.setAll({normal_font:{family:"Kalam"},italic_font:{family:"Kalam"},font_dominant_baseline:-.94,font_center:-.62,font_ascent:-.05,font_descent:1.16,slanted_div_bar:!0,div_bar_height:1/12,char_metrics:{"√":{ascent:-.32,width:.65},f:{width:.45},"(":{ascent:0},")":{ascent:0},"+add":{lmar:1/6,rmar:1/6},"-sub":{lmar:1/6,rmar:1/6},"±addsub":{lmar:1/6,rmar:1/6},"=":{lmar:1/3,rmar:1/3},"<":{lmar:1/3,rmar:1/3},">":{lmar:1/3,rmar:1/3},"≤":{lmar:1/3,rmar:1/3},"≥":{lmar:1/3,rmar:1/3},",":{lmar:0,rmar:1/3}}})}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Equals=l,n(0);var i=n(11),r=n(9),o=n(16),s=n(60),a=n(1);function l(t,e){r.Group.call(this),t&&e&&(a.Tree.append(this,t),a.Tree.append(this,new o.Sym("=")),a.Tree.append(this,e))}i.asOperator.call(l,"equals",{bp:10}),l.registerAtParser=function(t){t.registerSymbol("=",l.prototype.bp).led=function(e){var n=t.parseExpression(l.prototype.bp);if(s.Inequality.is_relation(e)||s.Inequality.is_relation(n))throw"More than one comparator in equation.";return new l(e,n)}},l.getSideOfTerm=function(t){for(var e=t;e.parent&&!s.Inequality.is_relation(e.parent);)e=e.parent;if(!e.parent||!s.Inequality.is_relation(e.parent))throw"[Equals] Error: attempted to find the side of a relation for a term not in a relation.";if(0===e.get_idx())return"left";if(2===e.get_idx())return"right";throw"[Equals] Error: the relation symbol is not on a side of the relation."},l.getOppositeSide=function(t){for(var e=t;e.parent&&!s.Inequality.is_relation(e.parent);)e=e.parent;return e.parent&&s.Inequality.is_relation(e.parent)?e.parent.children[2-e.get_idx()]:null},l.prototype.getOppositeSide=function(t){if("left"===t)return this.children[2];if("right"===t)return this.children[0];throw"[Equals] Error: cannot find opposite side with this input."}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Radical=c;var i=n(11),r=n(9),o=n(18),s=n(16),a=n(15),l=n(110),u=n(22);function c(t,e){r.Group.call(this),this.set_degree(e),this.init_symbols(),this.set_radicand(t)}i.asOperator.call(c,"radical",{bp:50,vertical_notation:!1}),c.prototype.set_degree=function(t){var e;this.has_children()&&this.children[0].is_group("degree")&&this.children[0].remove(),e=t&&t.is_group("degree")?t:t?new l.Degree(t):new l.Degree(new a.Num(2)),this.insert(0,e)},c.prototype.init_symbols=function(){this.insert(1,new s.Sym("√")),this.insert(2,new s.Sym("//"))},c.prototype.set_radicand=function(t){this.has_children()&&this.children[3]&&this.children[3].remove(),t&&(this.insert(3,t),o.Brackets.handle(t))},c.prototype.is_square_root=function(){return this.match("sqrt[2]\\ANY")},c.prototype.get_degree=function(){return this.children[0]},c.prototype.get_degree_term=function(){return this.children[0].get_term()},c.prototype.get_radicand=function(){return o.Brackets.areHidden(this.children[3])?this.children[3].children[1]:this.children[3]},c.prototype.map_to_radical=function(t,e,n){var i=n?t.updateNodeMap.bind(t):t.extendNodeMap.bind(t);i(this,e),i(this.children[0],e.children[0]),i(this.children[1],e.children[1]),i(this.children[2],e.children[2])},c.parsable_syms=["sqrt","\\sqrt","√","\\operatorname{sqrt}"],c.registerAtParser=function(t){var e=function(){var e=new c,n=t.parseExpression(1/0);if(n.is_group("brackets")&&"["===n.children[0].value){var i=n.children[1];e.set_degree(i);var r=t.parseExpression(1/0);e.set_radicand(r)}else e.set_radicand(n);return e},n=function(e){var n=t.parseExpression(u.MulDiv.prototype.bp,this);return u.MulDiv.createProduct(e,n)};c.parsable_syms.forEach(function(i){var r=t.registerSymbol(i,c.prototype.bp);r.nud=e,r.led=n})},c.prototype.to_ascii=function(t){var e=this.get_radicand();if(t&&t.roots_as_powers){var n=this.get_degree_term().to_ascii(t);return"("+e.to_ascii(t)+")^(1/("+n+"))"}return e.parent.is_group("brackets")&&(e=e.parent),2!==this.get_degree().get_term().value?"sqrt"+this.get_degree().to_ascii(t)+e.to_ascii(t):e.is_group("brackets")?"sqrt"+e.to_ascii(t):"sqrt "+e.to_ascii(t)},c.prototype.to_latex=function(t){var e="\\sqrt";return 2!==this.get_degree().get_term().value&&(e+=this.get_degree().to_latex(t)),e+"{"+this.get_radicand().to_latex(t)+"}"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Degree=u;var i=n(11),r=n(9),o=n(109),s=n(18),a=n(15),l=n(1);function u(t){r.Group.call(this),t&&(l.Tree.append(this,t),s.Brackets.handle(t))}i.asOperator.call(u,"degree",{group_class:o.Radical,group_name:"radical",bp:51,vertical_notation:!0}),u.prototype.get_term=function(){return s.Brackets.areHidden(this.children[0])?this.children[0].children[1]:this.children[0]},u.prototype.to_ascii=function(t){return 0===this.children.length?"":"["+this.children[0].to_ascii(t)+"]"},u.prototype.to_latex=function(t){return 0===this.children.length?"":"["+this.children[0].to_latex(t)+"]"},u.hide_rule={name:"hide degree of 2",disabled:!1,apply:function(t,e){t.parent.is_group("degree")&&a.Num.is_equal_to(t,2)&&(t.hidden=!0)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sum=u,e.AddSub=c;var i=n(0),r=n(1),o=n(11),s=n(9),a=n(18),l=(n(26),n(16));function u(){s.Group.call(this)}function c(t,e){if(s.Group.call(this),t){switch(e){case"sub":this.value="sub";break;case"addsub":this.value="addsub";break;default:this.value="add"}r.Tree.append(this,new l.Sym(c.value2sym[this.value])),r.Tree.append(this,t),a.Brackets.handle(t)}this.associative="add"==this.value}o.asOperator.call(u,"sum",{bp:20}),u.prototype.to_ascii=function(t){return this.children.map(function(e,n){var i=e.children[1],r=!e.is_group("add")||n>0||i.is_group("plusminus","sign"),o=e.to_ascii(t);return"+"!==o[0]||r?o:o.substring(1)}).join("")},c.value2sym={add:"+",sub:"-",addsub:"±"},o.asOperator.call(c,"add-sub",{group_class:u,group_name:"sum",bp:20,associative:!0,commutative:!0,has_inverse:!0}),c.prototype.invert=function(){"add"===this.value?this.setValue("sub"):"sub"===this.value&&this.setValue("add")},c.prototype.setValue=function(t){this.value=t,this.children[0].value=c.value2sym[t],this.associative="add"===t},c.prototype.symIsHidden=function(){return this.get_child([0]).hidden},c.prototype.map_group_and_sym=function(t,e,n){var i=n?"updateNodeMap":"extendNodeMap";t[i](this,e),t[i](this.children[0],e.children[0])},c.prototype.to_ascii=function(t){var e=!this.ls&&(this.children[1].is_group("product")||this.children[1].is_group("fraction")&&!this.children[1].children[1].is_group("mul"))&&this.children[1].children[0].children[1].is_group("plusminus","sign");return!this.ls&&this.is_group("sub")&&this.children[1].is_group("product")&&this.get_child([1,0,1]).is_group("fraction")&&(e=!0),this.children[0].to_ascii(t)+this.children[1].to_ascii(t,e)},c.registerAtParser=function(t){var e=function(t){var e=c.prototype.createParentGroup(),n=t.is_group("product","fraction")?t.children[0].children[1]:null;return t.had_leading_plus?e.append(new c(t)):t.is_group("sign")&&!t.user_grouped?e.append(new c(t.children[1],"sub")):t.is_group("plusminus")&&!t.user_grouped?e.append(new c(t.children[1],"addsub")):n&&!n.user_grouped&&n.is_group("sign","plusminus")&&!n.had_leading_plus?(n.replace_with(n.children[1]),n.is_group("sign")&&e.append(new c(t,"sub")),n.is_group("plusminus")&&e.append(new c(t,"addsub"))):e.append(new c(t)),e};t.registerSymbol("+",c.prototype.bp).led=function(n){var i=t.parseExpression(c.prototype.bp);if(n.is_group("sum"))return n.append(new c(i,"add")),n;var r=e(n);return r.append(new c(i,"add")),r};var n=t.registerSymbol("-",c.prototype.bp),i=t.registerSymbol("–",c.prototype.bp);function r(n){var i=t.parseExpression(c.prototype.bp);if(n.is_group("sum"))return n.append(new c(i,"addsub")),n;var r=e(n);return r.append(new c(i,"addsub")),r}n.led=function(n){var i=t.parseExpression(c.prototype.bp);if(n.is_group("sum"))return n.append(new c(i,"sub")),n;var r=e(n);return r.append(new c(i,"sub")),r},i.led=n.led,["±","\\pm"].forEach(function(e){t.registerSymbol(e,c.prototype.bp).led=r})},i.gmath.expressions.addsub=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProductFraction=u,n(0);var i=n(1),r=n(11),o=n(9),s=n(16),a=n(15),l=n(22);function u(){o.Group.call(this)}function c(t,e){var n=1===e.length&&e[0].children[1];return e.length>1||n&&n.is_group("fraction")?"("+t+")":n&&n.is_group("brackets")&&n.children[1].is_group("fraction","product")?"{"+t+"}":t}r.asOperator.call(u,"product",{bp:30,vertical_notation:!1}),u.prototype.invert=function(){var t=this.children.length;if("product"==this.value){this.value="fraction",this.vertical_notation=!0;for(var e=this.children[t-1],n=t-1;e&&"div"==e.value;)e=e.ls,n--;e&&"//"===e.value||i.Tree.insert(this,n+1,new s.Sym("//"))}else if(this.value="product",this.vertical_notation=!1,t>0)for(var r=this.children[0];r;)"//"==r.value&&i.Tree.remove(r),r=r.rs},u.prototype.append=function(t){if("product"==this.value&&"div"==t.value)this.invert(),i.Tree.append(this,t);else if("fraction"==this.value&&"mul"==t.value){for(var e=0;e<this.children.length&&"//"!==this.children[e].value;)e++;i.Tree.insert(this,e,t)}else i.Tree.append(this,t);return this},u.prototype.insert=function(t,e,n){if("product"==this.value&&"div"==e.value)this.invert(),i.Tree.append(this,e);else if("fraction"==this.value&&"mul"==e.value){var r=this.get_top().length;t>r&&(t=r),i.Tree.insert(this,t,e)}else if("fraction"==this.value&&"div"==e.value&&n){t+=this.get_top().length+1;var o=this.children.length;t>o&&(t=o),i.Tree.insert(this,t,e)}else i.Tree.insert(this,t,e)},u.prototype.append_range=function(t){t.forEach(function(t){this.append(t)},this)},u.prototype.insert_range=function(t,e,n){"product"==this.value&&"div"==e[0].value?this.append_range(e):e.forEach(function(e){this.insert(t++,e,n)},this)},u.prototype.insert_into_demominator=function(t,e){if(!e.is_group("div"))throw'wrong type of term, expected "div", not "'+e.name+'"';if("product"==this.value)this.invert(),i.Tree.append(this,e);else{for(var n=0;n<this.children.length&&"//"!==this.children[n].value;)n++;n=Math.max(this.children.length,n+1+t),i.Tree.insert(this,n,term)}return this},u.prototype.get_top=function(){for(var t=this.children[0],e=[];t;)"mul"==t.value&&e.push(t),t=t.rs;return e},u.prototype.get_bottom=function(){for(var t=this.children[0],e=[];t;)"div"==t.value&&e.push(t),t=t.rs;return e},u.prototype.get_fraction_bar=function(){for(var t=this.children[0];t;){if("//"==t.value)return t;t=t.rs}return null},u.get_whole_range=function(t){var e=Array.isArray(t)?t:[t];if(e[0].is_group("mul"))return e[0].parent.get_top();if(e[0].is_group("div"))return e[0].parent.get_bottom();throw"(ProductFraction) Incorrect operator type."},u.convert_to_reciprocal=function(t){var e,n=!1;if(t.is_group("sign","plusminus")&&(n=!0,t=t.children[1]),1===a.Num.get_value(t))return n?t.parent:t;function r(t){i.Tree.remove_range(t),t.forEach(function(t){t.invert()})}if(t.is_group("fraction")&&1===t.get_top().length&&a.Num.is_equal_to(t.get_top()[0].children[1],1)&&1===t.get_bottom().length){var o=t.parent,s=t.remove();(e=t.get_bottom()[0].children[1]).remove(),o.insert(s,e)}else if(t.is_group("fraction")){e=t;var c=t.get_top(),d=t.get_bottom();r(c),r(d),t.append_range(d),1===c.length&&a.Num.is_equal_to(c[0].children[1],1)?t.invert():t.append_range(c)}else if(t.is_group("product"))e=t,r(c=t.get_top()),t.invert(),t.append(new l.MulDiv(new a.Num(1))),t.append_range(c);else{o=t.parent;var h=t.remove(),p=new u;p.invert(),p.append(new l.MulDiv(new a.Num(1))),p.append(new l.MulDiv(t,"div")),o.insert(h,p),e=p}return n?e.parent:e},u.is_fraction=function(t){return t.is_group("fraction")||t.is_group("sign")&&t.children[1].is_group("fraction")},u.is_fraction_with_identity_numerator=function(t){return!(!t.is_group("fraction")||!u.is_lone_fraction_part(t.children[0]))&&a.Num.is_equal_to(t.get_child([0,1]),1)},u.is_lone_fraction_part=function(t){return t.is_group("mul")&&!t.ls&&"//"===t.rs.value||t.is_group("div")&&!t.rs&&"//"===t.ls.value},u.matchSource=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t.is_group("mul"))return!1;if(t.is_group("div")&&(t=t.parent),!t.is_group("fraction"))return!1;if(e&&1!==t.get_bottom().length)return!1;var n=t.get_top(),i=t.get_bottom();return{fraction:t,numerator:n,denominator:i,mul:n[0],div:i[0]}},u.getFactors=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];if(t.is_group("fraction")&&!e){var i=t.get_parent(2);i&&i.is_group("product")&&(t=i)}return t.is_group("fraction")&&(n=t.get_top().concat(t.get_bottom())),t.is_group("product")&&t.children.forEach(function(t){var i=t.children[1];!e&&i.is_group("fraction")?n=n.concat(i.get_top()).concat(i.get_bottom()):n.push(t)}),n},u.getSourceAndTarget=function(t){if("drag"===this.triggerType)return{source:t?this.nodes:this.nodes[0],target:this.target};var e=u.matchSource(this.actor);return{source:e.div,target:e.mul}},u.prototype.group_nodes=function(){for(var t,e=this.children[0],n=[],i=[];e;)"div"==e.value?i.push(e):"mul"==e.value?n.push(e):t=e,e=e.rs;return{top:n,bottom:i,bar:t}},u.prototype.to_latex=function(t){for(var e=this.get_top(),n=this.get_bottom(),i=n.length>0?"\\frac{":"",r=0;r<e.length;r++)i+=0==r?e[r].children[1].to_latex(t):e[r].to_latex(t);if(n.length>0){for(i+="}{",r=0;r<n.length;r++)i+=0==r?n[r].children[1].to_latex(t):n[r].to_latex(t);i+="}"}return i},u.prototype.to_ascii=function(t,e){for(var n=this.get_top(),i=this.get_bottom(),r=[],o=[],s=0;s<n.length;s++){var a=(0===s?"":"*")+n[s].children[1].to_ascii(t);e&&0===s?r.push("{"+a+"}"):r.push(a)}var l=r.join("");if(0==i.length)return l;for(s=0;s<i.length;s++)o.push((0==s?"":"*")+i[s].children[1].to_ascii(t));var u=o.join("");return c(l,n)+"/"+c(u,i)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Param=l;var i=n(0),r=n(1),o=(n(11),n(9)),s=n(63),a=n(16);function l(t){o.Group.call(this),this.value="param",t&&(this.append(new a.Sym(",")),this.children[0].fixed=!0,this.append(t)),this.group_class=s.Tuple,this.group_name="tuple",this.associative=!1,this.commutative=!1}i.gmath.inherit(o.Group,l),l.prototype.name="param",l.prototype.bp=5,l.createTuple=function(t,e){if(t.is_group("tuple"))return t.append(new l(e)),t;var n=new s.Tuple;return n.append(new l(t)),n.append(new l(e)),n},l.prototype.append=function(t){r.Tree.append(this,t),t instanceof a.Sym&&(t.fixed=!0)},l.registerAtParser=function(t){var e=t.registerSymbol(",",l.prototype.bp);e.led=function(e){var n=t.parseExpression(l.prototype.bp);return l.createTuple(e,n)},t.registerSymbol("\\,",l.prototype.bp).led=e.led},l.hide_rule={name:"Do not show the first comma in a tuple set.",disabled:!1,apply:function(t,e){if(!(t instanceof a.Sym)||","!==t.value)return!1;var n=t.parent;if(!n||!n.is_group("param"))return!1;n.ls&&n.ls.value===n.value||(t.hidden=!0)}},i.gmath.expressions[l.prototype.name]=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NodeMap=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(7);function o(t,e){e.forEach(function(e){-1===t.indexOf(e)&&t.push(e)})}e.NodeMap=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._map=e,this.source_model=n,this.target_model=i}return i(t,[{key:"clone",value:function(){var e={};for(var n in this._map)e[n]=this._map[n].slice();return new t(e,this.source_model,this.target_model)}},{key:"update",value:function(t,e){var n=this;if(1===arguments.length){var i=t;for(var r in i)this._map[r]=i[r]}else{var o=t;e=Array.isArray(e)?e:[e],Array.isArray(o)?o.forEach(function(t){return n._map[t.id]=e}):this._map[o.id]=e}}},{key:"extend",value:function(t,e){var n=this;if(1===arguments.length){var i=t;for(var r in i)r in this._map?o(this._map[r],i[r]):this._map[r]=i[r]}else{var s=Array.isArray(t)?t:[t];e=Array.isArray(e)?e:[e],s.forEach(function(t){t.id in n._map?o(n._map[t.id],e):n._map[t.id]=e})}}},{key:"reset",value:function(){this._map={}}},{key:"map",value:function(t){var e=this;if(Array.isArray(t)){var n=[];return t.forEach(function(t){var i=e._map[t.id];i&&o(n,i)}),n}return this._map[t.id]}},{key:"unmap",value:function(t){var e=[],n=Array.isArray(t)?t:[t];for(var i in this._map)r.array.containsAll(this._map[i],n)&&e.push(this.source_model.get_by_id(i));return e}},{key:"compose",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e instanceof t?e:new t(e);for(var r in this._map){var o=this._map[r];this._map[r]=i.map(o);var s=o.filter(function(t){return!i._map[t.id]});if(s.length>0&&n)throw"Second mapping does not cover all target nodes from first mapping.";this._map[r]=this._map[r].concat(s)}return i.target_model&&(this.target_model=e.target_model),this}},{key:"removeDeletedTargetNodes",value:function(){var t=this.target_model.select_all();for(var e in this._map)this._map[e]=this._map[e].filter(function(e){return-1!==t.indexOf(e)})}},{key:"getInverse",value:function(){var e=this,n={},i=this.target_model.children[0].select_all(),r=Object.keys(this._map);return i.forEach(function(t){n[t.id]=r.filter(function(n){return e._map[n].find(function(e){return e===t})}).map(function(t){return e.source_model.get_by_id(t)})}),new t(n,this.target_model,this.source_model)}},{key:"print",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Node Map";for(var e in t&&console.log(t),this._map){var n=e;this.source_model&&(n=(n=this.source_model.get_by_id(e))?n.to_ascii():"?"),console.log(n,"==>",this._map[e].map(function(t){return t.to_ascii()}).join(", "))}}}]),t}()},function(t,e,n){"use strict";function i(t){var e=new RegExp("^\\s*([0-9]*\\.?[0-9]+([eE][-+]?[0-9]+)?|∞|Infinity)"),n=new RegExp("^\\s*\\{(\\??[A-Za-z0-9_]*)\\:"),i=/^\s*(\\operatorname{(.*?)}|(sinh|asinh|arcsinh|cosh|acosh|arccosh|tanh|atanh|arctanh|sin|cos|tan|log|ln|sqrt|asin|arcsin|acos|arccos|atan|arctan))/,r=new RegExp("^\\s*([a-zA-Z₀₁₂₃₄₅₆₇₈₉⬚])"),o=new RegExp("^\\s*([α-ωΑ-Ω])"),s=new RegExp('^\\s*"([^"]+)"'),a=new RegExp("^\\s*\\\\text{(.*?)}"),l=new RegExp("^\\s*(>=|<=|\\*\\*|[-\\–+*/=><();,^\\{\\}\\[\\]\\|_±⁰¹²³⁴⁵⁶⁷⁸⁹ⁿ:≥≤√])"),u=new RegExp("^\\s*(\\\\[^A-Za-z0-9\\s]|\\\\[A-Za-z]+)"),c=new RegExp("^(\\s+)"),d=[],h=0;t&&(h=t.length);for(var p=0;p<h;){var f,g=t.substr(p);if(f=e.exec(g))d.push({type:"number",value:parseFloat(f[1].replace("∞","Infinity")),from:p+(f[0].length-f[1].length),to:p+f[0].length}),p+=f[0].length;else if(f=n.exec(g))d.push({type:"operator",value:"{",from:p,to:p+1}),d.push({type:"name",value:f[1],from:p+1,to:p+f[1].length+1}),d.push({type:"operator",value:":",from:p+f[0].length-1,to:p+f[0].length}),p+=f[0].length;else if(f=i.exec(g))d.push({type:"operator",value:f[2]||f[3],from:p+(f[0].length-f[1].length),to:p+f[0].length}),p+=f[0].length;else if(f=r.exec(g))d.push({type:"name",value:f[1],from:p+(f[0].length-f[1].length),to:p+f[0].length}),p+=f[0].length;else if(f=o.exec(g))d.push({type:"name",value:f[1],from:p+(f[0].length-f[1].length),to:p+f[0].length}),p+=f[0].length;else if(f=s.exec(g))d.push({type:"name",value:f[1],from:p+(f[0].length-f[1].length),to:p+f[0].length}),p+=f[0].length;else if(f=a.exec(g)){var m=p+f.index+f[0].indexOf(f[1]);d.push({type:"name",value:f[1],from:m,to:m+f[1].length}),p+=f[0].length}else if(f=l.exec(g))d.push({type:"operator",value:f[1],from:p+(f[0].length-f[1].length),to:p+f[0].length}),p+=f[0].length;else if(f=u.exec(g))d.push({type:"latex",value:f[1],from:p+(f[0].length-f[1].length),to:p+f[0].length}),p+=f[0].length;else{if(!(f=c.exec(g)))throw"can't tokenize '"+g+"'";p+=f[0].length}}return d}Object.defineProperty(e,"__esModule",{value:!0}),e.tokenize=i,n(0).gmath.tokenize=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NodeRenderer=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=n(5),s=n(3);e.NodeRenderer=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e,this.h_align=n||"center",this.v_align=i||"alphabetic",this.readFontSettings()}return i(t,[{key:"readFontSettings",value:function(){this.to_str_opts={sym_map:this.view.settings.get("symbol_mappings"),precision:this.view.settings.get("number_display_precision")},this.char_metrics=this.view.font_settings.get("char_metrics")}},{key:"set_style",value:function(t){for(var e=0;e<t.length;e++){var n=t[e],i=o.AlgebraModel.is_top_most(n)||!n.size?this.view.settings.get("font_size"):n.size,r=n.parent.color||(this.view.interactive()||!this.view.muted()?this.view.settings.get("color"):this.view.settings.get("inactive_color"));this.set_color_and_size(n,i,r)}}},{key:"set_color_and_size",value:function(t,e,n){t.size=e,t.bigger&&(t.size*=1.5),t.smaller&&(t.size*=.67),t.color=t.selected?this.view.settings.get("selection_color"):n,t.children.forEach(function(e,n){t.is_group("fraction")?this.set_color_and_size(e,t.size*this.view.settings.get("fraction_size_factor"),t.color):t.is_group("power")&&e.is_group("exponent")?this.set_color_and_size(e,t.size*this.view.settings.get("exp_size_factor"),t.color):t.is_group("radical")&&e.is_group("degree")?this.set_color_and_size(e,t.size*this.view.settings.get("degree_size_factor"),t.color):t.is_group("subscript")?this.set_color_and_size(e,t.size*this.view.settings.get("subscript_size_factor"),t.color):t.is_group("superscript")?this.set_color_and_size(e,t.size*this.view.settings.get("exp_size_factor"),t.color):this.set_color_and_size(e,t.size,t.color)},this)}},{key:"set_position",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.readFontSettings();var n=t instanceof o.AlgebraModel?t.children[0]:t;if(n){if(!o.AlgebraModel.is_top_most(n))throw"[NodeRenderer] Calling set_position on a sub-node of a tree will most assuredly cause rendering issues.";var i,r,s=this.view.font_settings.get("font_center");switch(this.view.font_settings.get("font_ascent"),this.view.font_settings.get("font_descent"),this.rel_pos(n,e,s),this.v_align){case"alphabetic":r=-.94*n.size;break;case"top":r=-n.descent;break;case"middle":r=s*n.size;break;case"center":r=(-n.descent+n.ascent)/2;break;case"bottom":r=n.ascent}switch(this.h_align){case"left":i=n.width;break;case"center":i=n.width/2;break;case"equals":if(i=n.width/2,n.is_group("equals","lte","gte","lt","gt")){var a=n.children[1];i=-(a.rel_x+a.sel_box.x+a.sel_box.width/2)}break;case"right":i=0}this.abs_pos(n,i,r,i,r)}}},{key:"position_horizontally",value:function(t){for(var e,n=t[0].parent,i=0,r=-1/0,s=-1/0,a=t.length,l=t[0].hidden?0:t[0].lmar||0,u=t[a-1].hidden?0:t[a-1].rmar||0,c=0;c<t.length;c++)i+=(h=t[c]).hidden||h.hide_after_drop?0:h.width,h.hidden||h.width,r=Math.max(r,h.hidden?0:h.ascent-h.rel_y),s=Math.max(s,h.hidden?0:h.descent+h.rel_y);e=r+s,o.AlgebraModel.is_top_most(n)&&l&&(i-=l);var d=-i;for(c=0;c<t.length;c++){var h=t[c],p=0===c?0:h.lmar||0,f=0===c?h.width-(h.lmar||0):h.width,g=0===c?0:Math.min(t[c-1].rmar||0,p);i-=g,h.rel_x+=d+h.width+p-g,(h.hidden||h.hide_after_drop)&&(h.rel_x-=f-g),d+=h.hidden||h.hide_after_drop?0:f-g}return o.AlgebraModel.is_top_most(n)&&0!==d&&t.forEach(function(t){t.rel_x-=d}),{width:i,height:e,ascent:r,descent:s,sel_box:{x:-i-l,width:i,y:-r,height:e},lmar:l,rmar:u}}},{key:"getFontMetric",value:function(t,e){var n=this.char_metrics[t.to_string(this.to_str_opts)];return n&&e in n?n[e]*t.size:"ascent"===e?this.view.font_settings.get("font_ascent")*t.size:"descent"===e?this.view.font_settings.get("font_descent")*t.size:void 0}},{key:"rel_pos",value:function(t,e,n){t.has_children()?this.group_rel_pos(t,e,n):this.leaf_rel_pos(t,e,n)}},{key:"leaf_rel_pos",value:function(t,e,n){var i=0,r=0,o=t.value+t.parent.value,s=t.value;if(o in this.char_metrics?("lmar"in this.char_metrics[o]&&(i=this.char_metrics[o].lmar),"rmar"in this.char_metrics[o]&&(r=this.char_metrics[o].rmar)):s in this.char_metrics&&("lmar"in this.char_metrics[s]&&(i=this.char_metrics[s].lmar),"rmar"in this.char_metrics[s]&&(r=this.char_metrics[s].rmar)),t.lmar=i*t.size,t.rmar=r*t.size,e){var a=t.to_string(this.to_str_opts),l=this.char_metrics[s]&&this.char_metrics[s].width?this.char_metrics[s].width*t.size:this.view.fontloader.width(a,t.size,this.view.get_font(t));t.width=l+t.lmar+t.rmar,t.ascent=this.getFontMetric(t,"ascent"),t.descent=this.getFontMetric(t,"descent"),t.height=t.ascent+t.descent,t.sel_box={x:-t.lmar,width:t.width,y:-t.ascent,height:t.height},t.scale_y=1}t.rel_x=-t.width,t.rel_y=0}},{key:"group_rel_pos",value:function(t,e,n){t.rel_x=0,t.rel_y=0;for(var i=0;i<t.children.length;i++)this.rel_pos(t.children[i],e,n);if(t.is_group("fraction")){for(var o=[],a=[],l=null,u=t.children[0];u;)"mul"==u.value?o.push(u):"div"==u.value?a.push(u):l=u,u=u.rs;var c=this.position_horizontally(o),d=this.position_horizontally(a),h=-n*t.size;for(l.height=l.size*this.view.font_settings.get("div_bar_height"),l.width=Math.max(c.width,d.width)+t.size/8,l.ascent=l.height/2,l.descent=l.height/2,l.rel_y=h,l.rel_x=.1*t.size,l.sel_box={x:-.1*t.size,width:l.width+.2*t.size,y:-t.size/4,height:t.size/2},t.width=l.width+.2*t.size,t.ascent=c.height+l.height/2-h,t.descent=d.height+l.height/2+h,t.height=t.ascent+t.descent,t.rel_y=0,t.rel_x=-t.width,t.sel_box={x:0,width:t.width,y:-t.ascent,height:t.height},i=0;i<o.length;i++)o[i].rel_y+=-c.descent-l.height/2+h,o[i].rel_x+=.5*(t.width+c.width);for(i=0;i<a.length;i++)a[i].rel_y+=d.ascent+l.height/2+h,a[i].rel_x+=.5*(t.width+d.width)}else if(t.is_group("radical")){var p=t.children[3],f=this.position_horizontally([p]),g=[t.children[0],t.children[1],t.children[3]],m=this.position_horizontally(g),v=g[1],y=(p.height+.1*p.size)/v.height;this.scaleNode(v,y),v.rel_y=-(v.descent+v.rel_y-p.descent-p.rel_y);var b=g[0];b.rel_y-=.6*v.ascent-v.rel_y,b.rel_x+=v.width/3,v.sel_box={x:-v.lmar,width:v.width,y:-v.ascent,height:v.height},r.gmath.extend(v,v.sel_box),(l=t.children[2]).height=t.size*this.view.font_settings.get("div_bar_height"),l.width=f.width+t.size/8,l.ascent=l.height/2,l.descent=l.height/2,l.rel_y=-v.ascent+v.rel_y,l.rel_x=v.rel_x+v.width-l.height/2,l.sel_box={x:0,width:l.width,y:-l.height/2,height:l.height},r.gmath.extend(l,l.sel_box),m.ascent=v.ascent-v.rel_y+l.ascent,m.descent=v.descent+v.rel_y,m.height=m.ascent+m.descent,m.y-=l.ascent,m.x+=v.width/3,m.width-=b.children[0].hidden?0:v.width/3,r.gmath.extend(t,m)}else{if(t.is_group("power")){var _=t.children[0],x=t.children[1],w=this.view.font_settings.get("font_dominant_baseline");x.rel_y=x.ascent-_.ascent,x.rel_y=Math.min(x.rel_y,-(w*_.size+.05*_.size)-x.descent),_.is_group("func")&&!_.getFunctionLabel().has_script("superscript")&&(t.children[1].rel_x-=_.children[1].width,_.children[1].rel_x+=t.children[1].width)}if(t.is_group("subscript")){var A=t.parent.get_base();t.rel_y+=.32*(A.descent-n*A.size)}if(r.gmath.extend(t,this.position_horizontally(t.children)),t.is_group("brackets","abs-val")&&!s.Brackets.areHidden(t)){var k=this.view.settings.get("brackets_size_factor")-1,T=t.children[0],S=t.children[1],M=t.children[2],E=(S.height+k*S.size)/T.height;this.scaleNode(T,E),T.rel_y=n*(T.scale_y-1)*T.size,this.scaleNode(M,E),M.rel_y=n*(M.scale_y-1)*M.size,t.ascent=T.ascent-T.rel_y,t.descent=T.descent+T.rel_y,t.height=t.ascent+t.descent,t.sel_box.y=-t.ascent,t.sel_box.height=t.height}}}},{key:"scaleNode",value:function(t,e){var n=t.scale_y||1;t.scale_y=n*e,t.ascent*=e,t.descent*=e,t.height*=e,t.sel_box.y=-t.ascent,t.sel_box.height=t.height}},{key:"abs_pos",value:function(t,e,n,i,r){t.x=t.rel_x+e,t.y=t.rel_y+n,t.x0=t.rel_x+i,t.y0=t.rel_y+r,t.children.forEach(function(e){this.abs_pos(e,t.x,t.y,t.x0,t.y0)},this)}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GraphEq=e.Multichoice=e.NodeRenderer=e.DerivationRow=e.Derivation=e.preloadFonts=e.AlgebraView=void 0;var i=n(14);Object.defineProperty(e,"AlgebraView",{enumerable:!0,get:function(){return i.AlgebraView}}),Object.defineProperty(e,"preloadFonts",{enumerable:!0,get:function(){return i.preloadFonts}});var r=n(34);Object.defineProperty(e,"Derivation",{enumerable:!0,get:function(){return r.Derivation}});var o=n(59);Object.defineProperty(e,"DerivationRow",{enumerable:!0,get:function(){return o.DerivationRow}});var s=n(116);Object.defineProperty(e,"NodeRenderer",{enumerable:!0,get:function(){return s.NodeRenderer}});var a=n(230);Object.defineProperty(e,"Multichoice",{enumerable:!0,get:function(){return a.Multichoice}});var l=n(229);Object.defineProperty(e,"GraphEq",{enumerable:!0,get:function(){return l.GraphEq}}),n(228),n(227),n(35),n(61)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.migrateDataToVersion=function(t,e){var n=t.version||"0.0.0",i=t;if(s(e)||console.error("Can't parse target version",e),s(n)||console.error("Can't parse data version",n),!u(e,n))return i;for(var o=r.length-1;o>=0;o--){if(u(r[o].update_to,e)){i.version=e;break}l(n,r[o].update_to)<0&&(console.log("updating data file from",i.version,"to",r[o].update_to),i=r[o].run(i))}return i};var i=n(5),r=[];function o(t,e){for(var n=t.objects.filter(function(t){return"Derivation"===t.type}),i=0;i<n.length;i++)for(var r=n[i],o=0;o<r.rows.length;o++)if(r.rows[o].model.id===e)return r.rows[o].model;return null}function s(t){var e=t.match(/^(\d+).(\d+).(\d+)(?:-([^+]*))?(?:\+(.+))?$/);return!!e&&{major:Number(e[1]),minor:Number(e[2]),patch:Number(e[3]),pre:e[4],meta:e[5]}}function a(t,e){return t>e?1:t<e?-1:0}function l(t,e){var n=s(t),i=s(e);return n&&i?0!==a(n.major,i.major)?a(n.major,i.major):0!==a(n.minor,i.minor)?a(n.minor,i.minor):0!==a(n.patch,i.patch)?a(n.patch,i.patch):n.pre&&!i.pre?-1:i.pre&&!n.pre?1:n.pre&&i.pre?n.pre.match(/^d+$/)&&i.pre.match(/^d+$/)?a(Number(n.pre),Number(i.pre)):a(n.pre,i.pre):0:NaN}function u(t,e){return l(t,e)>0}r.push({update_to:"2.13.8",run:function(t){return t.version="2.13.8",t.settings&&t.settings.AlgebraModel&&"deprecatedMixed"===t.settings.AlgebraModel.hide_implicit_multiplication_setting&&(t.settings.AlgebraModel.hide_implicit_multiplication_setting="hideBetweenNumAndVarAndBetweenVarAndVar"),t}}),r.push({update_to:"2.12.2",run:function(t){return t.version="2.12.2",t.settings||(t.settings={}),t.settings.AlgebraModel||(t.settings.AlgebraModel={}),t.settings.AlgebraModel.auto_simplify_variables&&(t.settings.AlgebraModel.auto_simplify_multiplicative_annihilators=t.settings.AlgebraModel.auto_simplify_variables),t}}),r.push({update_to:"2.10.0",run:function(t){return t.version="2.10.0",t.settings||(t.settings={}),t.settings.AlgebraModel||(t.settings.AlgebraModel={}),t.settings.AlgebraModel.hide_implicit_multiplication_setting="deprecatedMixed",t}}),r.push({update_to:"2.8.2",run:function(t){return t.version="2.8.2",t.linkCoordinator.links.forEach(function(t){t.action&&"EqInvertAndCommuteTermAction"===t.action.name&&(t.action.settings.allow_drag_across_relation=!0)}),t}}),r.push({update_to:"2.8.1",run:function(t){return t.version="2.8.1",t.objects=t.objects.filter(function(e){return"GeoGebraPanel"!==e.type||!!t.objects.some(function(t){return"GeoGebraElement"===t.type&&t.id===e.ggbElement})}),t}}),r.push({update_to:"2.7.5",run:function(t){t.version="2.7.5";var e=!0,n=!1,i=void 0;try{for(var r,o=t.objects.filter(function(t){return"GeoGebraPanel"===t.type})[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var s=r.value;s.prev_width||(s.prev_width=s.size.width?s.size.width:120),s.size&&null===s.size.width&&(s.size.width=s.prev_width)}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}var a=!0,l=!1,u=void 0;try{for(var c,d=t.objects.filter(function(t){return"GeoGebraCanvasElement"===t.type})[Symbol.iterator]();!(a=(c=d.next()).done);a=!0){var h=c.value;h.ggb_app_name||(h.ggb_app_name="classic")}}catch(t){l=!0,u=t}finally{try{!a&&d.return&&d.return()}finally{if(l)throw u}}return t}}),r.push({update_to:"2.7.2",run:function(t){return t.version="2.7.2",t.linkCoordinator.links.forEach(function(t){t.action&&t.action.settings&&"trigger_operation_inversion_by_gesture"in t.action.settings&&(t.action.settings.allow_drag_across_relation=t.action.settings.trigger_operation_inversion_by_gesture,delete t.action.settings.trigger_operation_inversion_by_gesture),t.action&&t.action.settings&&"explicit_equivalence"in t.action.settings&&(t.action.settings.simplify_after_drag_across_relation=t.action.settings.explicit_equivalence,delete t.action.settings.explicit_equivalence)}),t}}),r.push({update_to:"2.6.7",run:function(t){return t.version="2.6.7",t.linkCoordinator.links.forEach(function(e){if(e.action&&"AddSubInvertAction"===e.action.name){var n=o(t,e.action.oldTree),r=new i.AlgebraModel(n.ascii),s=r.getNodesFromSelector(e.action.target)[0];s.parent.is_group("add","sub","addsub")&&(e.action.target=r.getSelectorOfNodes(s.parent))}}),t}}),r.push({update_to:"2.6.1",run:function(t){return t.version="2.6.1",t.linkCoordinator.links.forEach(function(t){t.action&&"AddSubResolveCasesAction"===t.action.name&&(t.action.target=t.target)}),t}}),r.push({update_to:"2.4.0",run:function(t){return t.version="2.4.0",t.settings={Canvas:{},Derivation:{}},t.options&&"scrub_precision"in t.options&&(t.settings.Derivation.scrub_precision=t.options.scrub_precision),delete t.options,t.settings.Canvas.active_tool=t.mode,delete t.mode,t.objects.filter(function(t){return"Derivation"===t.type}).forEach(function(t){t.settings=t.options,delete t.options,t.rows.forEach(function(t){t.model.settings=t.model.options,delete t.model.options})}),t.referenced_deleted_models.forEach(function(t){t.settings=t.options,delete t.options}),t}}),r.push({update_to:"2.1.0",run:function(t){return t.version="2.1.0",t.linkCoordinator.links.forEach(function(e){if(e.action&&"DistributeIntoBracketsAction"===e.action.name){var n=o(t,e.action.oldTree),r=new i.AlgebraModel(n.ascii),s=r.getNodesFromSelector(e.action.nodes)[0],a=r.getNodesFromSelector(e.action.target)[0];s.get_idx()<a.get_idx()?e.action.settings.side="left-inside":e.action.settings.side="right-inside"}}),t}}),r.push({update_to:"1.0.3",run:function(t){return t.version="1.0.3",t.linkCoordinator.links.forEach(function(t){t.action&&"FractionMagSimplificationAction"===t.action.name&&(t.action.name="FractionDivideToInteger")}),t}}),r.push({update_to:"1.0.0-2",run:function(t){return t.version="1.0.0-2",t.linkCoordinator.links.forEach(function(t){t.action&&"AbsValFracSplitAction"===t.action.name&&"tap"===t.action.triggerType&&(t.action.name="AbsValFracJoinAction")}),t}}),r.push({update_to:"1.0.0-0",run:function(t){return t.version="1.0.0-0",t.linkCoordinator.links.forEach(function(e){if(e.action&&"CommuteAction"===e.action.name){var n=o(t,e.action.oldTree),r=new i.AlgebraModel(n.ascii);e.action.target=r.getSelectorOfNodes(r.getNodesFromSelector(e.action.target)[0].children[1]),"right-of"===e.action.settings.side?e.action.settings.side="right-inside":"left-of"===e.action.settings.side&&(e.action.settings.side="left-inside")}if(e.action&&"BreakingBracketsInAction"===e.action.name){var s=o(t,e.action.oldTree),a=new i.AlgebraModel(s.ascii);e.action.target=a.getSelectorOfNodes(a.getNodesFromSelector(e.action.target)[0].parent),"right-of"===e.action.settings.side?e.action.settings.side="right-inside":"left-of"===e.action.settings.side&&(e.action.settings.side="left-inside")}}),t}}),r.push({update_to:"0.15.1",run:function(t){var e=r.find(function(t){return"0.14.4"===t.update_to}).run(t);return e.version="0.15.1",e}}),r.push({update_to:"0.15.0",run:function(t){return t.version="0.15.0",t.linkCoordinator.links.forEach(function(e){if(e.action&&"SubstitutionAction"===e.action.name){e.action.name="DirectSubstitutionAction",e.action.source_am=e.action.nodes,e.action.target&&(e.action.target=e.action.target.split(";")[0]),e.action.target_is_array=!0;var n=o(t,e.action.nodes);if(n){var r=new i.AlgebraModel(n.ascii);e.action.nodes=r.getSelectorOfNodes(r.children[0].children[0])}else e.action.nodes=e.action.target}if(e.action&&"EquationCombineAction"===e.action.name){e.action.source_am=e.action.nodes;var s=o(t,e.action.nodes);s&&(e.action.nodes=s.ascii)}}),t}}),r.push({update_to:"0.14.4",run:function(t){return t.version="0.14.4",t.linkCoordinator.links.forEach(function(t){if(t.action)switch(t.action.name){case"editLineAction":t.action.name="FirstLineRewriteAction";break;case"RewriteExpressionWithKeyboardAction":t.action.name="ExpressionRewriteAction";break;case"EquationFountainAction":t.action.name="EquationRewriteAction";break;case"EquationCombineAction":t.action.name="CombinationRewriteAction";break;case"FractionExtendAction":t.action.name="FractionRewriteAction",t.action.latex=t.action.term}}),t}}),r.push({update_to:"0.14.2",run:function(t){return t.version="0.14.2",t.referenced_deleted_models||(t.referenced_deleted_models=[]),t}}),r.push({update_to:"0.12.15",run:function(t){return t.version="0.12.15",t.linkCoordinator.links.forEach(function(t){t.action&&"DistributePolynomials"===t.action.name&&(t.action.name="DistributePolynomialsAction")}),t}}),r.push({update_to:"0.12.14",run:function(t){return t.version="0.12.14",t}}),r.push({update_to:"0.12.11",run:function(t){var e={version:"0.12.11"},n={options:1,linkCoordinator:1,objects:1,paths:1};for(var r in t)r in n&&"string"==typeof t[r]?e[r]=JSON.parse(t[r]):e[r]=t[r];e.options||(e.options={}),e.linkCoordinator||(e.linkCoordinator={}),e.objects||(e.objects=[]),e.paths||(e.paths=[]),e.objects.forEach(function(t){"DerivationList"===t.type&&(t.type="Derivation")});var s={EquationFountain:"EquationFountainAction",InequalityFountain:"InequalityFountainAction",polynomialExpansionAction:"PolynomialExpansionAction",combineStackedExponentsUpAction:"CombineStackedExponentsUpAction"};return e.linkCoordinator.links.forEach(function(e){e.action&&(e.action.name in s&&(e.action.name=s[e.action.name]),function(t,e){if("EqInvertAndCommuteTermAction"===t.name&&0!==["*","/"].indexOf(t.nodes[0])){var n=o(e,t.oldTree);t.name="AddSubInvertAction";var r=!1;if(0===["+","-","±"].indexOf(t.target[0])){r=!0;var s=new i.AlgebraModel(n.ascii);t.target=s.getSelectorOfNodes(s.getNodesFromSelector(t.target)[0].children[1])}var a=t.settings.side;t.settings="left-of"===a?r?{side:"left-of",target_group:!0,group_side:"around",margin:{y:-.5}}:{side:"left-inside",margin:{y:-.5}}:r?{side:"right-of",target_group:!0,group_side:"around",margin:{y:-.5}}:{side:"right-inside",margin:{y:-.5}},t.settings.extend_extreme_target_boxes=!0,t.settings.delay=100}}(e.action,t))}),e.user_data=t.user_data||{},e}})},function(t,e,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=n(0),o=n(17),s=n(89),a=n(21),l=n(118),u=n(5),c=n(10),d=n(93),h=n(7);s.Canvas.prototype.getCanvasUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"https://graspablemath.com/canvas",i=this.meta_data.save_id;null===t&&(t=-1!==location.pathname.indexOf("canvas/mac")?"/mac":-1!==location.pathname.indexOf("canvas/dev")?"/dev":"/");var r=(0,h.extend)({},e);i&&(r.load=encodeURIComponent(i));var o="?"+Object.keys(r).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(r[t])}).join("&");return n+t+(o.length>1?o:"")},s.Canvas.prototype.save=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];t.clone&&(this.meta_data.cloned_from=this.meta_data.save_id,delete this.meta_data.save_id,this.meta_data.public=!1);var n=!this.meta_data||!this.meta_data.save_id,i=this.toJSON(this.meta_data.save_id||r.gmath.uid(),t.transferOwnership&&t.transferOwnership.id);if(t.transferOwnership&&(this.meta_data.display_name=t.transferOwnership.name),console.log("File size:",(i.length/1e3).toFixed(1),"KB"),i.length>75e5)return console.warn("The data is too large for saving."),void(e&&e({reason:"File size too big ("+(i.length/1e6).toFixed(1)+" MB)."}));this.logger.logCustomInteraction(t.clone?"duplicate":"save",{type:"canvas"});var s=new XMLHttpRequest,a=this;e&&(s.onreadystatechange=function(){4===this.readyState&&(200===this.status||301===this.status||302===this.status?(a.controller.needsSaving(!1),a.events.meta_data_change({is_new_sheet:n||t.clone}),e(null,a)):e({reason:"Network or server error ("+s.status+").",status:s.status,statusText:s.statusText}))});var l=this.settings.get("savefile_server")+"/api/saves";n?s.open("POST",l):s.open("PUT",l+"/"+this.meta_data.save_id),s.setRequestHeader("Content-Type","application/json"),o.user.auth_token&&s.setRequestHeader("Authorization","Bearer "+o.user.auth_token),s.send(i)},s.Canvas.prototype.toJSON=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.meta_data||(this.meta_data={}),t&&(this.meta_data.save_id=t),e?this.meta_data.owner=e:o.user.logged_in&&(this.meta_data.owner=o.user.user_id);var n=v(this);return JSON.stringify(n)},s.Canvas.prototype.loadFromFile=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.logger.logCustomInteraction("load",{type:"canvas",canvas_save_id:t});var i=new XMLHttpRequest,r=this.settings.get("savefile_server")+"/api/saves/"+t,s=this;i.onreadystatechange=function(){4===i.readyState&&(200===this.status||301===this.status||302===this.status?s.loadFromJSON(i.responseText,e,n):n&&n("Network error ("+this.status+")"))},i.open("get",r,!0),i.setRequestHeader("Content-Type","application/json"),o.user.auth_token&&i.setRequestHeader("Authorization","Bearer "+o.user.auth_token),i.send()},s.Canvas.prototype.loadFromJSON=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.controller.closeKeyboard();var i=JSON.parse(t);Array.isArray(i)&&(i=i[0]),e&&this.controller.reset();var o,s=(o=0,this.model.elements().forEach(function(t){var e=t.size.height+t.pos.y;e>o&&(o=e)}),this.model.paths().forEach(function(t){t.points.forEach(function(t){t[1]>o&&(o=t[1])})}),o+30),a=(0,l.migrateDataToVersion)(i.canvas_data,r.gmath.version);e&&(this.meta_data=i.meta_data),s>30&&(a.objects.forEach(function(t){t.pos&&(t.pos.y+=s)}),a.paths.forEach(function(t){return t.points.forEach(function(t){return t[1]+=s})})),this.loadData(a),s>30&&this.model.scroll(s),this.events.meta_data_change({is_new_sheet:!0}),n&&n(null,this)},s.Canvas.prototype.loadData=function(t){this.loadDocSettings(t.settings),this.logger.listen(!1),g(this,t);var e={};(0,d.loadFromJSON)(JSON.stringify(t.referenced_deleted_models),e);var n=(0,d.loadFromJSON)(JSON.stringify(t.objects),e,this.model);(0,d.loadFromJSON)(JSON.stringify(t.paths),e,this.model),(0,d.loadFromJSON)(JSON.stringify(t.linkCoordinator),e),f(n,e),m(),this.logger.listen(!0),t.settings.Canvas&&t.settings.Canvas.active_tool&&this.model.setActiveTool(t.settings.Canvas.active_tool,!0),this.logger.canvas_logger.dlLoggers.forEach(function(t){t.initListeners()})},s.Canvas.prototype.loadDocSettings=function(t){if(t){var e=c.SettingsType.getAll();for(var n in e)if(n in t){var i=e[n].doc;i.unsetAll(),i.setAll(t[n])}}},s.Canvas.prototype.archiveFile=function(t,e){var n=this.settings.get("savefile_server");p(!0,n,t,e)},s.Canvas.prototype.unarchiveFile=function(t,e){var n=this.settings.get("savefile_server");p(!1,n,t,e)};var p=function(t,e,n,i){var r=new XMLHttpRequest,s=n.archived;i&&(r.onreadystatechange=function(){4===this.readyState&&(200===this.status||301===this.status||302===this.status?i&&i(null,n):(n.archived=s,i&&i({reason:"Network or server error ("+r.status+").",status:r.status,statusText:r.statusText})))}),r.open("PUT",e+"/api/saves/"+n.save_id),r.setRequestHeader("Content-Type","application/json"),o.user.auth_token&&r.setRequestHeader("Authorization","Bearer "+o.user.auth_token),r.send(JSON.stringify({"meta_data.archived":t})),n.archived=t},f=function(t,e){t.filter(function(t){return"derivation"===t.type}).forEach(function(t){t.rows.forEach(function(t){t.action&&(t.action=e[t.action])})})},g=function(t,e){var n=t.model.elements().map(function(t){return t.id}).concat(t.model.paths().map(function(t){return t.id}));(0,a.linkCoordinator)().links.forEach(function(t){n.push(t.action.id),n.push(t.id)}),t.model.getElementsOfType("derivation").forEach(function(t){t.rows.forEach(function(t){n.push(t.id),n.push(t.model.id)})}),console.log(n);var o={};function s(t){return o[t]?o[t]:-1===n.indexOf(t)?t:(o[t]=r.gmath.uid(),console.log("assigning new id"),o[t])}!function t(e){if(Array.isArray(e))e.forEach(function(n,i){"string"==typeof n?e[i]=s(n):t(n)});else if("object"===(void 0===e?"undefined":i(e))&&e)for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];"string"==typeof r?e[n]=s(r):t(r)}}(e)},m=function(t){(0,a.linkCoordinator)().groups.forEach(function(t){0===t.deps&&t.nodes.forEach(function(t){if(t instanceof u.AlgebraModel){var e=t.children[0].get_mapping_to(t.children[0]);t.events.change(new u.AlgebraModel.ChangeEvent({model:t,no_anim:!0,node_map:e}))}})})},v=function(t){var e=t.meta_data,n={};n.version=r.gmath.version,n.settings=c.SettingsType.docSettingsToJSON(),n.settings.Canvas.active_tool=t.settings.get("active_tool"),n.linkCoordinator=(0,a.linkCoordinator)();var i=t.model.elements(),o=t.model.paths();return n.objects=i,n.paths=o,n.referenced_deleted_models=function(t){var e=(0,a.linkCoordinator)().links.filter(function(t){return t.action.source_am}).map(function(t){return t.action.source_am});if(0===e.length)return[];var n={};return t.model.getElementsOfType("derivation").forEach(function(t){return t.rows.forEach(function(t){return n[t.model.id]=t.model})}),e.filter(function(t){return!n[t.id]})}(t),{meta_data:e,canvas_data:n}}},function(t,e,n){"use strict";e.gmVersion="2.14.7"},function(t,e,n){var i=n(32),r=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&r(t)===t}},function(t,e,n){var i=n(49);i(i.S,"Number",{isInteger:n(121)})},function(t,e,n){n(122),t.exports=n(27).Number.isInteger},function(t,e,n){"use strict";var i=n(49),r=n(68)(6),o="findIndex",s=!0;o in[]&&Array(1)[o](function(){s=!1}),i(i.P+i.F*s,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(65)(o)},function(t,e,n){n(124),t.exports=n(27).Array.findIndex},function(t,e){t.exports=!1},function(t,e,n){var i=n(27),r=n(33),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(126)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var i=n(67);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var i=n(32),r=n(128),o=n(66)("species");t.exports=function(t){var e;return r(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){var i=n(129);t.exports=function(t,e){return new(i(t))(e)}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){var i=n(131),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var i=n(133);t.exports=function(t){return Object(i(t))}},function(t,e,n){var i=n(67);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(33),r=n(48),o=n(137),s=n(70)("src"),a=Function.toString,l=(""+a).split("toString");n(27).inspectSource=function(t){return a.call(t)},(t.exports=function(t,e,n,a){var u="function"==typeof n;u&&(o(n,"name")||r(n,"name",e)),t[e]!==n&&(u&&(o(n,s)||r(n,s,t[e]?""+t[e]:l.join(String(e)))),t===i?t[e]=n:a?t[e]?t[e]=n:r(t,e,n):(delete t[e],r(t,e,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||a.call(this)})},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var i=n(32);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(32),r=n(33).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e,n){t.exports=!n(47)&&!n(71)(function(){return 7!=Object.defineProperty(n(141)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(32);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){var i=n(143),r=n(142),o=n(140),s=Object.defineProperty;e.f=n(47)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){"use strict";var i=n(49),r=n(68)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),i(i.P+i.F*o,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(65)("find")},function(t,e,n){n(145),t.exports=n(27).Array.find},function(t,e,n){(function(t){
/*!
 * Bootstrap v3.4.1 (https://getbootstrap.com/)
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under the MIT license
 */
if(void 0===t)throw new Error("Bootstrap's JavaScript requires jQuery");!function(e){"use strict";var n=t.fn.jquery.split(" ")[0].split(".");if(n[0]<2&&n[1]<9||1==n[0]&&9==n[1]&&n[2]<1||n[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(),function(t){"use strict";t.fn.emulateTransitionEnd=function(e){var n=!1,i=this;return t(this).one("bsTransitionEnd",function(){n=!0}),setTimeout(function(){n||t(i).trigger(t.support.transition.end)},e),this},t(function(){t.support.transition=function(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(void 0!==t.style[n])return{end:e[n]};return!1}(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(t),function(t){"use strict";var e='[data-dismiss="alert"]',n=function(n){t(n).on("click",e,this.close)};n.VERSION="3.4.1",n.TRANSITION_DURATION=150,n.prototype.close=function(e){var i=t(this),r=i.attr("data-target");r||(r=(r=i.attr("href"))&&r.replace(/.*(?=#[^\s]*$)/,"")),r="#"===r?[]:r;var o=t(document).find(r);function s(){o.detach().trigger("closed.bs.alert").remove()}e&&e.preventDefault(),o.length||(o=i.closest(".alert")),o.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(o.removeClass("in"),t.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",s).emulateTransitionEnd(n.TRANSITION_DURATION):s())};var i=t.fn.alert;t.fn.alert=function(e){return this.each(function(){var i=t(this),r=i.data("bs.alert");r||i.data("bs.alert",r=new n(this)),"string"==typeof e&&r[e].call(i)})},t.fn.alert.Constructor=n,t.fn.alert.noConflict=function(){return t.fn.alert=i,this},t(document).on("click.bs.alert.data-api",e,n.prototype.close)}(t),function(t){"use strict";var e=function(n,i){this.$element=t(n),this.options=t.extend({},e.DEFAULTS,i),this.isLoading=!1};function n(n){return this.each(function(){var i=t(this),r=i.data("bs.button"),o="object"==typeof n&&n;r||i.data("bs.button",r=new e(this,o)),"toggle"==n?r.toggle():n&&r.setState(n)})}e.VERSION="3.4.1",e.DEFAULTS={loadingText:"loading..."},e.prototype.setState=function(e){var n="disabled",i=this.$element,r=i.is("input")?"val":"html",o=i.data();e+="Text",null==o.resetText&&i.data("resetText",i[r]()),setTimeout(t.proxy(function(){i[r](null==o[e]?this.options[e]:o[e]),"loadingText"==e?(this.isLoading=!0,i.addClass(n).attr(n,n).prop(n,!0)):this.isLoading&&(this.isLoading=!1,i.removeClass(n).removeAttr(n).prop(n,!1))},this),0)},e.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var n=this.$element.find("input");"radio"==n.prop("type")?(n.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==n.prop("type")&&(n.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),n.prop("checked",this.$element.hasClass("active")),t&&n.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var i=t.fn.button;t.fn.button=n,t.fn.button.Constructor=e,t.fn.button.noConflict=function(){return t.fn.button=i,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(e){var i=t(e.target).closest(".btn");n.call(i,"toggle"),t(e.target).is('input[type="radio"], input[type="checkbox"]')||(e.preventDefault(),i.is("input,button")?i.trigger("focus"):i.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(t),function(t){"use strict";var e=function(e,n){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};function n(n){return this.each(function(){var i=t(this),r=i.data("bs.carousel"),o=t.extend({},e.DEFAULTS,i.data(),"object"==typeof n&&n),s="string"==typeof n?n:o.slide;r||i.data("bs.carousel",r=new e(this,o)),"number"==typeof n?r.to(n):s?r[s]():o.interval&&r.pause().cycle()})}e.VERSION="3.4.1",e.TRANSITION_DURATION=600,e.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},e.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},e.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},e.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},e.prototype.getItemForDirection=function(t,e){var n=this.getItemIndex(e);if(("prev"==t&&0===n||"next"==t&&n==this.$items.length-1)&&!this.options.wrap)return e;var i=(n+("prev"==t?-1:1))%this.$items.length;return this.$items.eq(i)},e.prototype.to=function(t){var e=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",this.$items.eq(t))},e.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},e.prototype.next=function(){if(!this.sliding)return this.slide("next")},e.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},e.prototype.slide=function(n,i){var r=this.$element.find(".item.active"),o=i||this.getItemForDirection(n,r),s=this.interval,a="next"==n?"left":"right",l=this;if(o.hasClass("active"))return this.sliding=!1;var u=o[0],c=t.Event("slide.bs.carousel",{relatedTarget:u,direction:a});if(this.$element.trigger(c),!c.isDefaultPrevented()){if(this.sliding=!0,s&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var d=t(this.$indicators.children()[this.getItemIndex(o)]);d&&d.addClass("active")}var h=t.Event("slid.bs.carousel",{relatedTarget:u,direction:a});return t.support.transition&&this.$element.hasClass("slide")?(o.addClass(n),"object"==typeof o&&o.length&&o[0].offsetWidth,r.addClass(a),o.addClass(a),r.one("bsTransitionEnd",function(){o.removeClass([n,a].join(" ")).addClass("active"),r.removeClass(["active",a].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(h)},0)}).emulateTransitionEnd(e.TRANSITION_DURATION)):(r.removeClass("active"),o.addClass("active"),this.sliding=!1,this.$element.trigger(h)),s&&this.cycle(),this}};var i=t.fn.carousel;t.fn.carousel=n,t.fn.carousel.Constructor=e,t.fn.carousel.noConflict=function(){return t.fn.carousel=i,this};var r=function(e){var i=t(this),r=i.attr("href");r&&(r=r.replace(/.*(?=#[^\s]+$)/,""));var o=i.attr("data-target")||r,s=t(document).find(o);if(s.hasClass("carousel")){var a=t.extend({},s.data(),i.data()),l=i.attr("data-slide-to");l&&(a.interval=!1),n.call(s,a),l&&s.data("bs.carousel").to(l),e.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",r).on("click.bs.carousel.data-api","[data-slide-to]",r),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var e=t(this);n.call(e,e.data())})})}(t),function(t){"use strict";var e=function(n,i){this.$element=t(n),this.options=t.extend({},e.DEFAULTS,i),this.$trigger=t('[data-toggle="collapse"][href="#'+n.id+'"],[data-toggle="collapse"][data-target="#'+n.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};function n(e){var n,i=e.attr("data-target")||(n=e.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return t(document).find(i)}function i(n){return this.each(function(){var i=t(this),r=i.data("bs.collapse"),o=t.extend({},e.DEFAULTS,i.data(),"object"==typeof n&&n);!r&&o.toggle&&/show|hide/.test(n)&&(o.toggle=!1),r||i.data("bs.collapse",r=new e(this,o)),"string"==typeof n&&r[n]()})}e.VERSION="3.4.1",e.TRANSITION_DURATION=350,e.DEFAULTS={toggle:!0},e.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},e.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var n,r=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(r&&r.length&&(n=r.data("bs.collapse"))&&n.transitioning)){var o=t.Event("show.bs.collapse");if(this.$element.trigger(o),!o.isDefaultPrevented()){r&&r.length&&(i.call(r,"hide"),n||r.data("bs.collapse",null));var s=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[s](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var a=function(){this.$element.removeClass("collapsing").addClass("collapse in")[s](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return a.call(this);var l=t.camelCase(["scroll",s].join("-"));this.$element.one("bsTransitionEnd",t.proxy(a,this)).emulateTransitionEnd(e.TRANSITION_DURATION)[s](this.$element[0][l])}}}},e.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var n=t.Event("hide.bs.collapse");if(this.$element.trigger(n),!n.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var r=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!t.support.transition)return r.call(this);this.$element[i](0).one("bsTransitionEnd",t.proxy(r,this)).emulateTransitionEnd(e.TRANSITION_DURATION)}}},e.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},e.prototype.getParent=function(){return t(document).find(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(e,i){var r=t(i);this.addAriaAndCollapsedClass(n(r),r)},this)).end()},e.prototype.addAriaAndCollapsedClass=function(t,e){var n=t.hasClass("in");t.attr("aria-expanded",n),e.toggleClass("collapsed",!n).attr("aria-expanded",n)};var r=t.fn.collapse;t.fn.collapse=i,t.fn.collapse.Constructor=e,t.fn.collapse.noConflict=function(){return t.fn.collapse=r,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(e){var r=t(this);r.attr("data-target")||e.preventDefault();var o=n(r),s=o.data("bs.collapse")?"toggle":r.data();i.call(o,s)})}(t),function(t){"use strict";var e=".dropdown-backdrop",n='[data-toggle="dropdown"]',i=function(e){t(e).on("click.bs.dropdown",this.toggle)};function r(e){var n=e.attr("data-target");n||(n=(n=e.attr("href"))&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i="#"!==n?t(document).find(n):null;return i&&i.length?i:e.parent()}function o(i){i&&3===i.which||(t(e).remove(),t(n).each(function(){var e=t(this),n=r(e),o={relatedTarget:this};n.hasClass("open")&&(i&&"click"==i.type&&/input|textarea/i.test(i.target.tagName)&&t.contains(n[0],i.target)||(n.trigger(i=t.Event("hide.bs.dropdown",o)),i.isDefaultPrevented()||(e.attr("aria-expanded","false"),n.removeClass("open").trigger(t.Event("hidden.bs.dropdown",o)))))}))}i.VERSION="3.4.1",i.prototype.toggle=function(e){var n=t(this);if(!n.is(".disabled, :disabled")){var i=r(n),s=i.hasClass("open");if(o(),!s){"ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",o);var a={relatedTarget:this};if(i.trigger(e=t.Event("show.bs.dropdown",a)),e.isDefaultPrevented())return;n.trigger("focus").attr("aria-expanded","true"),i.toggleClass("open").trigger(t.Event("shown.bs.dropdown",a))}return!1}},i.prototype.keydown=function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var i=t(this);if(e.preventDefault(),e.stopPropagation(),!i.is(".disabled, :disabled")){var o=r(i),s=o.hasClass("open");if(!s&&27!=e.which||s&&27==e.which)return 27==e.which&&o.find(n).trigger("focus"),i.trigger("click");var a=o.find(".dropdown-menu li:not(.disabled):visible a");if(a.length){var l=a.index(e.target);38==e.which&&l>0&&l--,40==e.which&&l<a.length-1&&l++,~l||(l=0),a.eq(l).trigger("focus")}}}};var s=t.fn.dropdown;t.fn.dropdown=function(e){return this.each(function(){var n=t(this),r=n.data("bs.dropdown");r||n.data("bs.dropdown",r=new i(this)),"string"==typeof e&&r[e].call(n)})},t.fn.dropdown.Constructor=i,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=s,this},t(document).on("click.bs.dropdown.data-api",o).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",n,i.prototype.toggle).on("keydown.bs.dropdown.data-api",n,i.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",i.prototype.keydown)}(t),function(t){"use strict";var e=function(e,n){this.options=n,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.fixedContent=".navbar-fixed-top, .navbar-fixed-bottom",this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};function n(n,i){return this.each(function(){var r=t(this),o=r.data("bs.modal"),s=t.extend({},e.DEFAULTS,r.data(),"object"==typeof n&&n);o||r.data("bs.modal",o=new e(this,s)),"string"==typeof n?o[n](i):s.show&&o.show(i)})}e.VERSION="3.4.1",e.TRANSITION_DURATION=300,e.BACKDROP_TRANSITION_DURATION=150,e.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},e.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},e.prototype.show=function(n){var i=this,r=t.Event("show.bs.modal",{relatedTarget:n});this.$element.trigger(r),this.isShown||r.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){i.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(i.$element)&&(i.ignoreBackdropClick=!0)})}),this.backdrop(function(){var r=t.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),i.adjustDialog(),r&&i.$element[0].offsetWidth,i.$element.addClass("in"),i.enforceFocus();var o=t.Event("shown.bs.modal",{relatedTarget:n});r?i.$dialog.one("bsTransitionEnd",function(){i.$element.trigger("focus").trigger(o)}).emulateTransitionEnd(e.TRANSITION_DURATION):i.$element.trigger("focus").trigger(o)}))},e.prototype.hide=function(n){n&&n.preventDefault(),n=t.Event("hide.bs.modal"),this.$element.trigger(n),this.isShown&&!n.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(e.TRANSITION_DURATION):this.hideModal())},e.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){document===t.target||this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},e.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},e.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},e.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},e.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},e.prototype.backdrop=function(n){var i=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=t.support.transition&&r;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+r).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!n)return;o?this.$backdrop.one("bsTransitionEnd",n).emulateTransitionEnd(e.BACKDROP_TRANSITION_DURATION):n()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var s=function(){i.removeBackdrop(),n&&n()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",s).emulateTransitionEnd(e.BACKDROP_TRANSITION_DURATION):s()}else n&&n()},e.prototype.handleUpdate=function(){this.adjustDialog()},e.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},e.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},e.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},e.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"";var n=this.scrollbarWidth;this.bodyIsOverflowing&&(this.$body.css("padding-right",e+n),t(this.fixedContent).each(function(e,i){var r=i.style.paddingRight,o=t(i).css("padding-right");t(i).data("padding-right",r).css("padding-right",parseFloat(o)+n+"px")}))},e.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad),t(this.fixedContent).each(function(e,n){var i=t(n).data("padding-right");t(n).removeData("padding-right"),n.style.paddingRight=i||""})},e.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var i=t.fn.modal;t.fn.modal=n,t.fn.modal.Constructor=e,t.fn.modal.noConflict=function(){return t.fn.modal=i,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var i=t(this),r=i.attr("href"),o=i.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,""),s=t(document).find(o),a=s.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(r)&&r},s.data(),i.data());i.is("a")&&e.preventDefault(),s.one("show.bs.modal",function(t){t.isDefaultPrevented()||s.one("hidden.bs.modal",function(){i.is(":visible")&&i.trigger("focus")})}),n.call(s,a,this)})}(t),function(t){"use strict";var e=["sanitize","whiteList","sanitizeFn"],n=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],i=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,r=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i;function o(e,o){var s=e.nodeName.toLowerCase();if(-1!==t.inArray(s,o))return-1===t.inArray(s,n)||Boolean(e.nodeValue.match(i)||e.nodeValue.match(r));for(var a=t(o).filter(function(t,e){return e instanceof RegExp}),l=0,u=a.length;l<u;l++)if(s.match(a[l]))return!0;return!1}function s(e,n,i){if(0===e.length)return e;if(i&&"function"==typeof i)return i(e);if(!document.implementation||!document.implementation.createHTMLDocument)return e;var r=document.implementation.createHTMLDocument("sanitization");r.body.innerHTML=e;for(var s=t.map(n,function(t,e){return e}),a=t(r.body).find("*"),l=0,u=a.length;l<u;l++){var c=a[l],d=c.nodeName.toLowerCase();if(-1!==t.inArray(d,s))for(var h=t.map(c.attributes,function(t){return t}),p=[].concat(n["*"]||[],n[d]||[]),f=0,g=h.length;f<g;f++)o(h[f],p)||c.removeAttribute(h[f].nodeName);else c.parentNode.removeChild(c)}return r.body.innerHTML}var a=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};a.VERSION="3.4.1",a.TRANSITION_DURATION=150,a.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0},sanitize:!0,sanitizeFn:null,whiteList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]}},a.prototype.init=function(e,n,i){if(this.enabled=!0,this.type=e,this.$element=t(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&t(document).find(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var r=this.options.trigger.split(" "),o=r.length;o--;){var s=r[o];if("click"==s)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=s){var a="hover"==s?"mouseenter":"focusin",l="hover"==s?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},a.prototype.getDefaults=function(){return a.DEFAULTS},a.prototype.getOptions=function(n){var i=this.$element.data();for(var r in i)i.hasOwnProperty(r)&&-1!==t.inArray(r,e)&&delete i[r];return(n=t.extend({},this.getDefaults(),i,n)).delay&&"number"==typeof n.delay&&(n.delay={show:n.delay,hide:n.delay}),n.sanitize&&(n.template=s(n.template,n.whiteList,n.sanitizeFn)),n},a.prototype.getDelegateOptions=function(){var e={},n=this.getDefaults();return this._options&&t.each(this._options,function(t,i){n[t]!=i&&(e[t]=i)}),e},a.prototype.enter=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusin"==e.type?"focus":"hover"]=!0),n.tip().hasClass("in")||"in"==n.hoverState)n.hoverState="in";else{if(clearTimeout(n.timeout),n.hoverState="in",!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)}},a.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},a.prototype.leave=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusout"==e.type?"focus":"hover"]=!1),!n.isInStateTrue()){if(clearTimeout(n.timeout),n.hoverState="out",!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)}},a.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var n=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!n)return;var i=this,r=this.tip(),o=this.getUID(this.type);this.setContent(),r.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&r.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,l=/\s?auto?\s?/i,u=l.test(s);u&&(s=s.replace(l,"")||"top"),r.detach().css({top:0,left:0,display:"block"}).addClass(s).data("bs."+this.type,this),this.options.container?r.appendTo(t(document).find(this.options.container)):r.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var c=this.getPosition(),d=r[0].offsetWidth,h=r[0].offsetHeight;if(u){var p=s,f=this.getPosition(this.$viewport);s="bottom"==s&&c.bottom+h>f.bottom?"top":"top"==s&&c.top-h<f.top?"bottom":"right"==s&&c.right+d>f.width?"left":"left"==s&&c.left-d<f.left?"right":s,r.removeClass(p).addClass(s)}var g=this.getCalculatedOffset(s,c,d,h);this.applyPlacement(g,s);var m=function(){var t=i.hoverState;i.$element.trigger("shown.bs."+i.type),i.hoverState=null,"out"==t&&i.leave(i)};t.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",m).emulateTransitionEnd(a.TRANSITION_DURATION):m()}},a.prototype.applyPlacement=function(e,n){var i=this.tip(),r=i[0].offsetWidth,o=i[0].offsetHeight,s=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(s)&&(s=0),isNaN(a)&&(a=0),e.top+=s,e.left+=a,t.offset.setOffset(i[0],t.extend({using:function(t){i.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),i.addClass("in");var l=i[0].offsetWidth,u=i[0].offsetHeight;"top"==n&&u!=o&&(e.top=e.top+o-u);var c=this.getViewportAdjustedDelta(n,e,l,u);c.left?e.left+=c.left:e.top+=c.top;var d=/top|bottom/.test(n),h=d?2*c.left-r+l:2*c.top-o+u,p=d?"offsetWidth":"offsetHeight";i.offset(e),this.replaceArrow(h,i[0][p],d)},a.prototype.replaceArrow=function(t,e,n){this.arrow().css(n?"left":"top",50*(1-t/e)+"%").css(n?"top":"left","")},a.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();this.options.html?(this.options.sanitize&&(e=s(e,this.options.whiteList,this.options.sanitizeFn)),t.find(".tooltip-inner").html(e)):t.find(".tooltip-inner").text(e),t.removeClass("fade in top bottom left right")},a.prototype.hide=function(e){var n=this,i=t(this.$tip),r=t.Event("hide.bs."+this.type);function o(){"in"!=n.hoverState&&i.detach(),n.$element&&n.$element.removeAttr("aria-describedby").trigger("hidden.bs."+n.type),e&&e()}if(this.$element.trigger(r),!r.isDefaultPrevented())return i.removeClass("in"),t.support.transition&&i.hasClass("fade")?i.one("bsTransitionEnd",o).emulateTransitionEnd(a.TRANSITION_DURATION):o(),this.hoverState=null,this},a.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},a.prototype.hasContent=function(){return this.getTitle()},a.prototype.getPosition=function(e){var n=(e=e||this.$element)[0],i="BODY"==n.tagName,r=n.getBoundingClientRect();null==r.width&&(r=t.extend({},r,{width:r.right-r.left,height:r.bottom-r.top}));var o=window.SVGElement&&n instanceof window.SVGElement,s=i?{top:0,left:0}:o?null:e.offset(),a={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},l=i?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},r,a,l,s)},a.prototype.getCalculatedOffset=function(t,e,n,i){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-n/2}:"top"==t?{top:e.top-i,left:e.left+e.width/2-n/2}:"left"==t?{top:e.top+e.height/2-i/2,left:e.left-n}:{top:e.top+e.height/2-i/2,left:e.left+e.width}},a.prototype.getViewportAdjustedDelta=function(t,e,n,i){var r={top:0,left:0};if(!this.$viewport)return r;var o=this.options.viewport&&this.options.viewport.padding||0,s=this.getPosition(this.$viewport);if(/right|left/.test(t)){var a=e.top-o-s.scroll,l=e.top+o-s.scroll+i;a<s.top?r.top=s.top-a:l>s.top+s.height&&(r.top=s.top+s.height-l)}else{var u=e.left-o,c=e.left+o+n;u<s.left?r.left=s.left-u:c>s.right&&(r.left=s.left+s.width-c)}return r},a.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},a.prototype.getUID=function(t){do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},a.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},a.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},a.prototype.enable=function(){this.enabled=!0},a.prototype.disable=function(){this.enabled=!1},a.prototype.toggleEnabled=function(){this.enabled=!this.enabled},a.prototype.toggle=function(e){var n=this;e&&((n=t(e.currentTarget).data("bs."+this.type))||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n))),e?(n.inState.click=!n.inState.click,n.isInStateTrue()?n.enter(n):n.leave(n)):n.tip().hasClass("in")?n.leave(n):n.enter(n)},a.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null,t.$element=null})},a.prototype.sanitizeHtml=function(t){return s(t,this.options.whiteList,this.options.sanitizeFn)};var l=t.fn.tooltip;t.fn.tooltip=function(e){return this.each(function(){var n=t(this),i=n.data("bs.tooltip"),r="object"==typeof e&&e;!i&&/destroy|hide/.test(e)||(i||n.data("bs.tooltip",i=new a(this,r)),"string"==typeof e&&i[e]())})},t.fn.tooltip.Constructor=a,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=l,this}}(t),function(t){"use strict";var e=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");e.VERSION="3.4.1",e.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),(e.prototype=t.extend({},t.fn.tooltip.Constructor.prototype)).constructor=e,e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),n=this.getContent();if(this.options.html){var i=typeof n;this.options.sanitize&&(e=this.sanitizeHtml(e),"string"===i&&(n=this.sanitizeHtml(n))),t.find(".popover-title").html(e),t.find(".popover-content").children().detach().end()["string"===i?"html":"append"](n)}else t.find(".popover-title").text(e),t.find(".popover-content").children().detach().end().text(n);t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},e.prototype.hasContent=function(){return this.getTitle()||this.getContent()},e.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var n=t.fn.popover;t.fn.popover=function(n){return this.each(function(){var i=t(this),r=i.data("bs.popover"),o="object"==typeof n&&n;!r&&/destroy|hide/.test(n)||(r||i.data("bs.popover",r=new e(this,o)),"string"==typeof n&&r[n]())})},t.fn.popover.Constructor=e,t.fn.popover.noConflict=function(){return t.fn.popover=n,this}}(t),function(t){"use strict";function e(n,i){this.$body=t(document.body),this.$scrollElement=t(n).is(document.body)?t(window):t(n),this.options=t.extend({},e.DEFAULTS,i),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function n(n){return this.each(function(){var i=t(this),r=i.data("bs.scrollspy"),o="object"==typeof n&&n;r||i.data("bs.scrollspy",r=new e(this,o)),"string"==typeof n&&r[n]()})}e.VERSION="3.4.1",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e=this,n="offset",i=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(n="position",i=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=t(this),r=e.data("target")||e.attr("href"),o=/^#./.test(r)&&t(r);return o&&o.length&&o.is(":visible")&&[[o[n]().top+i,r]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,n=this.getScrollHeight(),i=this.options.offset+n-this.$scrollElement.height(),r=this.offsets,o=this.targets,s=this.activeTarget;if(this.scrollHeight!=n&&this.refresh(),e>=i)return s!=(t=o[o.length-1])&&this.activate(t);if(s&&e<r[0])return this.activeTarget=null,this.clear();for(t=r.length;t--;)s!=o[t]&&e>=r[t]&&(void 0===r[t+1]||e<r[t+1])&&this.activate(o[t])},e.prototype.activate=function(e){this.activeTarget=e,this.clear();var n=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',i=t(n).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var i=t.fn.scrollspy;t.fn.scrollspy=n,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=i,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);n.call(e,e.data())})})}(t),function(t){"use strict";var e=function(e){this.element=t(e)};function n(n){return this.each(function(){var i=t(this),r=i.data("bs.tab");r||i.data("bs.tab",r=new e(this)),"string"==typeof n&&r[n]()})}e.VERSION="3.4.1",e.TRANSITION_DURATION=150,e.prototype.show=function(){var e=this.element,n=e.closest("ul:not(.dropdown-menu)"),i=e.data("target");if(i||(i=(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var r=n.find(".active:last a"),o=t.Event("hide.bs.tab",{relatedTarget:e[0]}),s=t.Event("show.bs.tab",{relatedTarget:r[0]});if(r.trigger(o),e.trigger(s),!s.isDefaultPrevented()&&!o.isDefaultPrevented()){var a=t(document).find(i);this.activate(e.closest("li"),n),this.activate(a,a.parent(),function(){r.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:r[0]})})}}},e.prototype.activate=function(n,i,r){var o=i.find("> .active"),s=r&&t.support.transition&&(o.length&&o.hasClass("fade")||!!i.find("> .fade").length);function a(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),n.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),s?(n[0].offsetWidth,n.addClass("in")):n.removeClass("fade"),n.parent(".dropdown-menu").length&&n.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),r&&r()}o.length&&s?o.one("bsTransitionEnd",a).emulateTransitionEnd(e.TRANSITION_DURATION):a(),o.removeClass("in")};var i=t.fn.tab;t.fn.tab=n,t.fn.tab.Constructor=e,t.fn.tab.noConflict=function(){return t.fn.tab=i,this};var r=function(e){e.preventDefault(),n.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',r).on("click.bs.tab.data-api",'[data-toggle="pill"]',r)}(t),function(t){"use strict";var e=function(n,i){this.options=t.extend({},e.DEFAULTS,i);var r=this.options.target===e.DEFAULTS.target?t(this.options.target):t(document).find(this.options.target);this.$target=r.on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(n),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};function n(n){return this.each(function(){var i=t(this),r=i.data("bs.affix"),o="object"==typeof n&&n;r||i.data("bs.affix",r=new e(this,o)),"string"==typeof n&&r[n]()})}e.VERSION="3.4.1",e.RESET="affix affix-top affix-bottom",e.DEFAULTS={offset:0,target:window},e.prototype.getState=function(t,e,n,i){var r=this.$target.scrollTop(),o=this.$element.offset(),s=this.$target.height();if(null!=n&&"top"==this.affixed)return r<n&&"top";if("bottom"==this.affixed)return null!=n?!(r+this.unpin<=o.top)&&"bottom":!(r+s<=t-i)&&"bottom";var a=null==this.affixed,l=a?r:o.top;return null!=n&&r<=n?"top":null!=i&&l+(a?s:e)>=t-i&&"bottom"},e.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(e.RESET).addClass("affix");var t=this.$target.scrollTop(),n=this.$element.offset();return this.pinnedOffset=n.top-t},e.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},e.prototype.checkPosition=function(){if(this.$element.is(":visible")){var n=this.$element.height(),i=this.options.offset,r=i.top,o=i.bottom,s=Math.max(t(document).height(),t(document.body).height());"object"!=typeof i&&(o=r=i),"function"==typeof r&&(r=i.top(this.$element)),"function"==typeof o&&(o=i.bottom(this.$element));var a=this.getState(s,n,r,o);if(this.affixed!=a){null!=this.unpin&&this.$element.css("top","");var l="affix"+(a?"-"+a:""),u=t.Event(l+".bs.affix");if(this.$element.trigger(u),u.isDefaultPrevented())return;this.affixed=a,this.unpin="bottom"==a?this.getPinnedOffset():null,this.$element.removeClass(e.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==a&&this.$element.offset({top:s-n-o})}};var i=t.fn.affix;t.fn.affix=n,t.fn.affix.Constructor=e,t.fn.affix.noConflict=function(){return t.fn.affix=i,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var e=t(this),i=e.data();i.offset=i.offset||{},null!=i.offsetBottom&&(i.offset.bottom=i.offsetBottom),null!=i.offsetTop&&(i.offset.top=i.offsetTop),n.call(e,i)})})}(t)}).call(this,n(8))},function(t,e,n){(e=t.exports=n(29)(!1)).push([t.i,"@import url(https://fonts.googleapis.com/icon?family=Material+Icons);",""]),e.push([t.i,"",""])},function(t,e,n){var i=n(148);"string"==typeof i&&(i=[[t.i,i,""]]);n(28)(i,{hmr:!0,transform:void 0,insertInto:void 0}),i.locals&&(t.exports=i.locals)},function(t,e,n){(t.exports=n(29)(!1)).push([t.i,'header {\n  background: white;\n}\n\nnav.gm-dark {\n  height: 52px;\n  color: white;\n  background: #4d4e4c;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  flex-shrink: 0;\n  border-bottom: rgba(69, 70, 67, 0.5) 1px solid;\n}\n\nnav.gm-light {\n  color: #4d4e4c;\n}\n\nnav a#gm-brand {\n  display: block;\n  background-size: 100% 100%;\n  margin-bottom: 4px;\n  margin-left: 20px;\n  margin-right: 20px;\n}\n\nnav.gm-light a.navbar-brand img {\n  height: 32px;\n  margin-top: -10px;\n  margin-right: 20px;\n}\n\n.nav-item.nav-link.fa:hover {\n  color: #85bd4a;\n}\n\nfooter {\n  background: whitesmoke;\n  font-family: "Helvetica Neue", Roboto, Helvetica, Arial, sans-serif;\n  font-weight: 300;\n  margin-top: 5em;\n  padding: 0.3rem 0;\n}\n\n#sup-by {\n  margin-right: 0.8rem;\n}\n\n.ies-ref {\n    font-size: 2.1rem;\n}\n.ies-ref a {\n    cursor: pointer;\n    display: inline-block;\n    text-align: left;\n    padding: .1em 0;\n    font-family: Montserrat, Arial, sans-serif;\n    text-decoration: none;\n    line-height: 1.2em;\n    color: black;\n}\n.ies-ref a:hover {\n    color: black;\n}\n.ies-ref a .long_name{\n    display: inline-block;\n    text-align: left;\n    line-height: 1.1em;\n    font-size: .39em;\n    font-weight: bold;\n}\n\nnav.gm-dark a#gm-brand {\n  width: 172px;\n  height: 32px;\n  background-image: url(/shared/imgs/dark-gm-brand.png);\n}\n\n.gm-navbar-left {\n  flex: 0 1 1;\n}\n\n.gm-navbar-right {\n  flex: 0 1 1;\n  text-align: right;\n  margin-right: 20px;\n  margin-left: 20px;\n  margin-top: 3px;\n}\n\n.gm-navbar-left {\n  flex: 0 1 1;\n}\n\n.gm-navbar-center {\n  flex: 1 1 0;\n  margin-top: 3px;\n}\n\n#gm-file-title {\n  text-align: center;\n  font-size: 1.1em;\n  overflow: hidden;\n  -o-text-overflow: ellipsis;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  cursor: pointer;\n}\n\n#gm-file-title:hover {\n  text-decoration: underline;\n}\n\n.gm-navbar-right {\n  flex: 0 1 1;\n  text-align: right;\n  margin-right: 20px;\n  margin-left: 20px;\n  margin-top: 3px;\n  color: #ddd;\n  text-shadow: rgba(0,0,0,0.75) 1px 1px 2px;\n}\n\n#gm-navbar__a--login {\n  color: #ddd;\n  text-decoration: underline;\n}\n\nnav a.dropdown-toggle {\n  color: inherit;\n}\n\nnav #gm-user-name {\n  font-size: 1.1em;\n}\n\nnav .gm-navbar-right .dropdown-menu {\n  text-shadow: none;\n}\n\nnav #gm-login, nav #gm-logout {\n  color: #ddd;\n  text-decoration: underline;\n}\n\nnav #gm-login:hover, nav #gm-logout:hover {\n  color: white;\n}\n\n.inline-list li {\n  display: inline-block;\n  font-size: 20px;\n  color: #dbdbdb;\n}\n.inline-list li + li {\n  margin-left: 15px;\n}\n.inline-list a:hover {\n  color: #84bd43;\n}\n',""])},function(t,e,n){var i=n(150);"string"==typeof i&&(i=[[t.i,i,""]]);n(28)(i,{hmr:!0,transform:void 0,insertInto:void 0}),i.locals&&(t.exports=i.locals)},function(t,e,n){t.exports=n.p+"509055533550f297c8b6b6947dbc8de0.ttf"},function(t,e,n){t.exports=n.p+"54f17f867f414a6629ff093c3385a675.ttf"},function(t,e,n){t.exports=n.p+"7bd30dae68cc93616c2e56dff03057c9.ttf"},function(t,e,n){var i=n(50);(t.exports=n(29)(!1)).push([t.i,"/*@import url(https://fonts.googleapis.com/css?family=Lato:300,400);*/\n\n@font-face {\n  font-family: 'Kalam';\n  src: url("+i(n(154))+");\n}\n\n@font-face {\n  font-family: 'Crimson Text Italics';\n  src: url("+i(n(153))+");\n}\n\n@font-face {\n  font-family: 'Crimson Text';\n  src: url("+i(n(152))+");\n}\n\ng.math text {\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  dominant-baseline: alphabetic;\n  cursor: default;\n}\n",""])},function(t,e,n){var i=n(155);"string"==typeof i&&(i=[[t.i,i,""]]);n(28)(i,{hmr:!0,transform:void 0,insertInto:void 0}),i.locals&&(t.exports=i.locals)},function(t,e,n){t.exports=n.p+"89889688147bd7575d6327160d64e760.svg"},function(t,e,n){t.exports=n.p+"e18bbf611f2a2e43afc071aa2f4e1512.ttf"},function(t,e,n){t.exports=n.p+"fa2772327f55d8198301fdb8bcfc8158.woff"},function(t,e,n){t.exports=n.p+"448c34a56d699c29117adc64c43affeb.woff2"},function(t,e,n){var i=n(50);(t.exports=n(29)(!1)).push([t.i,'@charset "UTF-8";\n.GeoGebraFrame .collapse {\n  display: block; }\n\n.gm-styles {\n  line-height: 1.42857143;\n  /*!\n * Bootstrap v3.4.1 (https://getbootstrap.com/)\n * Copyright 2011-2019 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n */\n  /*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */\n  /*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */ }\n  .gm-styles html {\n    font-family: sans-serif;\n    -ms-text-size-adjust: 100%;\n    -webkit-text-size-adjust: 100%; }\n  .gm-styles body {\n    margin: 0; }\n  .gm-styles article,\n  .gm-styles aside,\n  .gm-styles details,\n  .gm-styles figcaption,\n  .gm-styles figure,\n  .gm-styles footer,\n  .gm-styles header,\n  .gm-styles hgroup,\n  .gm-styles main,\n  .gm-styles menu,\n  .gm-styles nav,\n  .gm-styles section,\n  .gm-styles summary {\n    display: block; }\n  .gm-styles audio,\n  .gm-styles canvas,\n  .gm-styles progress,\n  .gm-styles video {\n    display: inline-block;\n    vertical-align: baseline; }\n  .gm-styles audio:not([controls]) {\n    display: none;\n    height: 0; }\n  .gm-styles [hidden],\n  .gm-styles template {\n    display: none; }\n  .gm-styles a {\n    background-color: transparent; }\n  .gm-styles a:active,\n  .gm-styles a:hover {\n    outline: 0; }\n  .gm-styles abbr[title] {\n    border-bottom: none;\n    text-decoration: underline;\n    text-decoration: underline dotted; }\n  .gm-styles b,\n  .gm-styles strong {\n    font-weight: bold; }\n  .gm-styles dfn {\n    font-style: italic; }\n  .gm-styles h1 {\n    font-size: 2em;\n    margin: 0.67em 0; }\n  .gm-styles mark {\n    background: #ff0;\n    color: #000; }\n  .gm-styles small {\n    font-size: 80%; }\n  .gm-styles sub,\n  .gm-styles sup {\n    font-size: 75%;\n    line-height: 0;\n    position: relative;\n    vertical-align: baseline; }\n  .gm-styles sup {\n    top: -0.5em; }\n  .gm-styles sub {\n    bottom: -0.25em; }\n  .gm-styles img {\n    border: 0; }\n  .gm-styles svg:not(:root) {\n    overflow: hidden; }\n  .gm-styles figure {\n    margin: 1em 40px; }\n  .gm-styles hr {\n    box-sizing: content-box;\n    height: 0; }\n  .gm-styles pre {\n    overflow: auto; }\n  .gm-styles code,\n  .gm-styles kbd,\n  .gm-styles pre,\n  .gm-styles samp {\n    font-family: monospace, monospace;\n    font-size: 1em; }\n  .gm-styles button,\n  .gm-styles input,\n  .gm-styles optgroup,\n  .gm-styles select,\n  .gm-styles textarea {\n    color: inherit;\n    font: inherit;\n    margin: 0; }\n  .gm-styles button {\n    overflow: visible; }\n  .gm-styles button,\n  .gm-styles select {\n    text-transform: none; }\n  .gm-styles button,\n  .gm-styles html input[type="button"],\n  .gm-styles input[type="reset"],\n  .gm-styles input[type="submit"] {\n    -webkit-appearance: button;\n    cursor: pointer; }\n  .gm-styles button[disabled],\n  .gm-styles html input[disabled] {\n    cursor: default; }\n  .gm-styles button::-moz-focus-inner,\n  .gm-styles input::-moz-focus-inner {\n    border: 0;\n    padding: 0; }\n  .gm-styles input {\n    line-height: normal; }\n  .gm-styles input[type="checkbox"],\n  .gm-styles input[type="radio"] {\n    box-sizing: border-box;\n    padding: 0; }\n  .gm-styles input[type="number"]::-webkit-inner-spin-button,\n  .gm-styles input[type="number"]::-webkit-outer-spin-button {\n    height: auto; }\n  .gm-styles input[type="search"] {\n    -webkit-appearance: textfield;\n    box-sizing: content-box; }\n  .gm-styles input[type="search"]::-webkit-search-cancel-button,\n  .gm-styles input[type="search"]::-webkit-search-decoration {\n    -webkit-appearance: none; }\n  .gm-styles fieldset {\n    border: 1px solid #c0c0c0;\n    margin: 0 2px;\n    padding: 0.35em 0.625em 0.75em; }\n  .gm-styles legend {\n    border: 0;\n    padding: 0; }\n  .gm-styles textarea {\n    overflow: auto; }\n  .gm-styles optgroup {\n    font-weight: bold; }\n  .gm-styles table {\n    border-collapse: collapse;\n    border-spacing: 0; }\n  .gm-styles td,\n  .gm-styles th {\n    padding: 0; }\n  @media print {\n    .gm-styles *,\n    .gm-styles *:before,\n    .gm-styles *:after {\n      color: #000 !important;\n      text-shadow: none !important;\n      background: transparent !important;\n      box-shadow: none !important; }\n    .gm-styles a,\n    .gm-styles a:visited {\n      text-decoration: underline; }\n    .gm-styles a[href]:after {\n      content: " (" attr(href) ")"; }\n    .gm-styles abbr[title]:after {\n      content: " (" attr(title) ")"; }\n    .gm-styles a[href^="#"]:after,\n    .gm-styles a[href^="javascript:"]:after {\n      content: ""; }\n    .gm-styles pre,\n    .gm-styles blockquote {\n      border: 1px solid #999;\n      page-break-inside: avoid; }\n    .gm-styles thead {\n      display: table-header-group; }\n    .gm-styles tr,\n    .gm-styles img {\n      page-break-inside: avoid; }\n    .gm-styles img {\n      max-width: 100% !important; }\n    .gm-styles p,\n    .gm-styles h2,\n    .gm-styles h3 {\n      orphans: 3;\n      widows: 3; }\n    .gm-styles h2,\n    .gm-styles h3 {\n      page-break-after: avoid; }\n    .gm-styles .navbar {\n      display: none; }\n    .gm-styles .btn > .caret,\n    .gm-styles .dropup > .btn > .caret {\n      border-top-color: #000 !important; }\n    .gm-styles .label {\n      border: 1px solid #000; }\n    .gm-styles .table {\n      border-collapse: collapse !important; }\n      .gm-styles .table td,\n      .gm-styles .table th {\n        background-color: #fff !important; }\n    .gm-styles .table-bordered th,\n    .gm-styles .table-bordered td {\n      border: 1px solid #ddd !important; } }\n\n@font-face {\n  font-family: "Glyphicons Halflings";\n  src: url('+i(n(72))+");\n  src: url("+i(n(72))+'?#iefix) format("embedded-opentype"), url('+i(n(160))+') format("woff2"), url('+i(n(159))+') format("woff"), url('+i(n(158))+') format("truetype"), url('+i(n(157))+'#glyphicons_halflingsregular) format("svg"); }\n  .gm-styles .glyphicon {\n    position: relative;\n    top: 1px;\n    display: inline-block;\n    font-family: "Glyphicons Halflings";\n    font-style: normal;\n    font-weight: 400;\n    line-height: 1;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale; }\n  .gm-styles .glyphicon-asterisk:before {\n    content: "*"; }\n  .gm-styles .glyphicon-plus:before {\n    content: "+"; }\n  .gm-styles .glyphicon-euro:before,\n  .gm-styles .glyphicon-eur:before {\n    content: "\\20AC"; }\n  .gm-styles .glyphicon-minus:before {\n    content: "\\2212"; }\n  .gm-styles .glyphicon-cloud:before {\n    content: "\\2601"; }\n  .gm-styles .glyphicon-envelope:before {\n    content: "\\2709"; }\n  .gm-styles .glyphicon-pencil:before {\n    content: "\\270F"; }\n  .gm-styles .glyphicon-glass:before {\n    content: "\\E001"; }\n  .gm-styles .glyphicon-music:before {\n    content: "\\E002"; }\n  .gm-styles .glyphicon-search:before {\n    content: "\\E003"; }\n  .gm-styles .glyphicon-heart:before {\n    content: "\\E005"; }\n  .gm-styles .glyphicon-star:before {\n    content: "\\E006"; }\n  .gm-styles .glyphicon-star-empty:before {\n    content: "\\E007"; }\n  .gm-styles .glyphicon-user:before {\n    content: "\\E008"; }\n  .gm-styles .glyphicon-film:before {\n    content: "\\E009"; }\n  .gm-styles .glyphicon-th-large:before {\n    content: "\\E010"; }\n  .gm-styles .glyphicon-th:before {\n    content: "\\E011"; }\n  .gm-styles .glyphicon-th-list:before {\n    content: "\\E012"; }\n  .gm-styles .glyphicon-ok:before {\n    content: "\\E013"; }\n  .gm-styles .glyphicon-remove:before {\n    content: "\\E014"; }\n  .gm-styles .glyphicon-zoom-in:before {\n    content: "\\E015"; }\n  .gm-styles .glyphicon-zoom-out:before {\n    content: "\\E016"; }\n  .gm-styles .glyphicon-off:before {\n    content: "\\E017"; }\n  .gm-styles .glyphicon-signal:before {\n    content: "\\E018"; }\n  .gm-styles .glyphicon-cog:before {\n    content: "\\E019"; }\n  .gm-styles .glyphicon-trash:before {\n    content: "\\E020"; }\n  .gm-styles .glyphicon-home:before {\n    content: "\\E021"; }\n  .gm-styles .glyphicon-file:before {\n    content: "\\E022"; }\n  .gm-styles .glyphicon-time:before {\n    content: "\\E023"; }\n  .gm-styles .glyphicon-road:before {\n    content: "\\E024"; }\n  .gm-styles .glyphicon-download-alt:before {\n    content: "\\E025"; }\n  .gm-styles .glyphicon-download:before {\n    content: "\\E026"; }\n  .gm-styles .glyphicon-upload:before {\n    content: "\\E027"; }\n  .gm-styles .glyphicon-inbox:before {\n    content: "\\E028"; }\n  .gm-styles .glyphicon-play-circle:before {\n    content: "\\E029"; }\n  .gm-styles .glyphicon-repeat:before {\n    content: "\\E030"; }\n  .gm-styles .glyphicon-refresh:before {\n    content: "\\E031"; }\n  .gm-styles .glyphicon-list-alt:before {\n    content: "\\E032"; }\n  .gm-styles .glyphicon-lock:before {\n    content: "\\E033"; }\n  .gm-styles .glyphicon-flag:before {\n    content: "\\E034"; }\n  .gm-styles .glyphicon-headphones:before {\n    content: "\\E035"; }\n  .gm-styles .glyphicon-volume-off:before {\n    content: "\\E036"; }\n  .gm-styles .glyphicon-volume-down:before {\n    content: "\\E037"; }\n  .gm-styles .glyphicon-volume-up:before {\n    content: "\\E038"; }\n  .gm-styles .glyphicon-qrcode:before {\n    content: "\\E039"; }\n  .gm-styles .glyphicon-barcode:before {\n    content: "\\E040"; }\n  .gm-styles .glyphicon-tag:before {\n    content: "\\E041"; }\n  .gm-styles .glyphicon-tags:before {\n    content: "\\E042"; }\n  .gm-styles .glyphicon-book:before {\n    content: "\\E043"; }\n  .gm-styles .glyphicon-bookmark:before {\n    content: "\\E044"; }\n  .gm-styles .glyphicon-print:before {\n    content: "\\E045"; }\n  .gm-styles .glyphicon-camera:before {\n    content: "\\E046"; }\n  .gm-styles .glyphicon-font:before {\n    content: "\\E047"; }\n  .gm-styles .glyphicon-bold:before {\n    content: "\\E048"; }\n  .gm-styles .glyphicon-italic:before {\n    content: "\\E049"; }\n  .gm-styles .glyphicon-text-height:before {\n    content: "\\E050"; }\n  .gm-styles .glyphicon-text-width:before {\n    content: "\\E051"; }\n  .gm-styles .glyphicon-align-left:before {\n    content: "\\E052"; }\n  .gm-styles .glyphicon-align-center:before {\n    content: "\\E053"; }\n  .gm-styles .glyphicon-align-right:before {\n    content: "\\E054"; }\n  .gm-styles .glyphicon-align-justify:before {\n    content: "\\E055"; }\n  .gm-styles .glyphicon-list:before {\n    content: "\\E056"; }\n  .gm-styles .glyphicon-indent-left:before {\n    content: "\\E057"; }\n  .gm-styles .glyphicon-indent-right:before {\n    content: "\\E058"; }\n  .gm-styles .glyphicon-facetime-video:before {\n    content: "\\E059"; }\n  .gm-styles .glyphicon-picture:before {\n    content: "\\E060"; }\n  .gm-styles .glyphicon-map-marker:before {\n    content: "\\E062"; }\n  .gm-styles .glyphicon-adjust:before {\n    content: "\\E063"; }\n  .gm-styles .glyphicon-tint:before {\n    content: "\\E064"; }\n  .gm-styles .glyphicon-edit:before {\n    content: "\\E065"; }\n  .gm-styles .glyphicon-share:before {\n    content: "\\E066"; }\n  .gm-styles .glyphicon-check:before {\n    content: "\\E067"; }\n  .gm-styles .glyphicon-move:before {\n    content: "\\E068"; }\n  .gm-styles .glyphicon-step-backward:before {\n    content: "\\E069"; }\n  .gm-styles .glyphicon-fast-backward:before {\n    content: "\\E070"; }\n  .gm-styles .glyphicon-backward:before {\n    content: "\\E071"; }\n  .gm-styles .glyphicon-play:before {\n    content: "\\E072"; }\n  .gm-styles .glyphicon-pause:before {\n    content: "\\E073"; }\n  .gm-styles .glyphicon-stop:before {\n    content: "\\E074"; }\n  .gm-styles .glyphicon-forward:before {\n    content: "\\E075"; }\n  .gm-styles .glyphicon-fast-forward:before {\n    content: "\\E076"; }\n  .gm-styles .glyphicon-step-forward:before {\n    content: "\\E077"; }\n  .gm-styles .glyphicon-eject:before {\n    content: "\\E078"; }\n  .gm-styles .glyphicon-chevron-left:before {\n    content: "\\E079"; }\n  .gm-styles .glyphicon-chevron-right:before {\n    content: "\\E080"; }\n  .gm-styles .glyphicon-plus-sign:before {\n    content: "\\E081"; }\n  .gm-styles .glyphicon-minus-sign:before {\n    content: "\\E082"; }\n  .gm-styles .glyphicon-remove-sign:before {\n    content: "\\E083"; }\n  .gm-styles .glyphicon-ok-sign:before {\n    content: "\\E084"; }\n  .gm-styles .glyphicon-question-sign:before {\n    content: "\\E085"; }\n  .gm-styles .glyphicon-info-sign:before {\n    content: "\\E086"; }\n  .gm-styles .glyphicon-screenshot:before {\n    content: "\\E087"; }\n  .gm-styles .glyphicon-remove-circle:before {\n    content: "\\E088"; }\n  .gm-styles .glyphicon-ok-circle:before {\n    content: "\\E089"; }\n  .gm-styles .glyphicon-ban-circle:before {\n    content: "\\E090"; }\n  .gm-styles .glyphicon-arrow-left:before {\n    content: "\\E091"; }\n  .gm-styles .glyphicon-arrow-right:before {\n    content: "\\E092"; }\n  .gm-styles .glyphicon-arrow-up:before {\n    content: "\\E093"; }\n  .gm-styles .glyphicon-arrow-down:before {\n    content: "\\E094"; }\n  .gm-styles .glyphicon-share-alt:before {\n    content: "\\E095"; }\n  .gm-styles .glyphicon-resize-full:before {\n    content: "\\E096"; }\n  .gm-styles .glyphicon-resize-small:before {\n    content: "\\E097"; }\n  .gm-styles .glyphicon-exclamation-sign:before {\n    content: "\\E101"; }\n  .gm-styles .glyphicon-gift:before {\n    content: "\\E102"; }\n  .gm-styles .glyphicon-leaf:before {\n    content: "\\E103"; }\n  .gm-styles .glyphicon-fire:before {\n    content: "\\E104"; }\n  .gm-styles .glyphicon-eye-open:before {\n    content: "\\E105"; }\n  .gm-styles .glyphicon-eye-close:before {\n    content: "\\E106"; }\n  .gm-styles .glyphicon-warning-sign:before {\n    content: "\\E107"; }\n  .gm-styles .glyphicon-plane:before {\n    content: "\\E108"; }\n  .gm-styles .glyphicon-calendar:before {\n    content: "\\E109"; }\n  .gm-styles .glyphicon-random:before {\n    content: "\\E110"; }\n  .gm-styles .glyphicon-comment:before {\n    content: "\\E111"; }\n  .gm-styles .glyphicon-magnet:before {\n    content: "\\E112"; }\n  .gm-styles .glyphicon-chevron-up:before {\n    content: "\\E113"; }\n  .gm-styles .glyphicon-chevron-down:before {\n    content: "\\E114"; }\n  .gm-styles .glyphicon-retweet:before {\n    content: "\\E115"; }\n  .gm-styles .glyphicon-shopping-cart:before {\n    content: "\\E116"; }\n  .gm-styles .glyphicon-folder-close:before {\n    content: "\\E117"; }\n  .gm-styles .glyphicon-folder-open:before {\n    content: "\\E118"; }\n  .gm-styles .glyphicon-resize-vertical:before {\n    content: "\\E119"; }\n  .gm-styles .glyphicon-resize-horizontal:before {\n    content: "\\E120"; }\n  .gm-styles .glyphicon-hdd:before {\n    content: "\\E121"; }\n  .gm-styles .glyphicon-bullhorn:before {\n    content: "\\E122"; }\n  .gm-styles .glyphicon-bell:before {\n    content: "\\E123"; }\n  .gm-styles .glyphicon-certificate:before {\n    content: "\\E124"; }\n  .gm-styles .glyphicon-thumbs-up:before {\n    content: "\\E125"; }\n  .gm-styles .glyphicon-thumbs-down:before {\n    content: "\\E126"; }\n  .gm-styles .glyphicon-hand-right:before {\n    content: "\\E127"; }\n  .gm-styles .glyphicon-hand-left:before {\n    content: "\\E128"; }\n  .gm-styles .glyphicon-hand-up:before {\n    content: "\\E129"; }\n  .gm-styles .glyphicon-hand-down:before {\n    content: "\\E130"; }\n  .gm-styles .glyphicon-circle-arrow-right:before {\n    content: "\\E131"; }\n  .gm-styles .glyphicon-circle-arrow-left:before {\n    content: "\\E132"; }\n  .gm-styles .glyphicon-circle-arrow-up:before {\n    content: "\\E133"; }\n  .gm-styles .glyphicon-circle-arrow-down:before {\n    content: "\\E134"; }\n  .gm-styles .glyphicon-globe:before {\n    content: "\\E135"; }\n  .gm-styles .glyphicon-wrench:before {\n    content: "\\E136"; }\n  .gm-styles .glyphicon-tasks:before {\n    content: "\\E137"; }\n  .gm-styles .glyphicon-filter:before {\n    content: "\\E138"; }\n  .gm-styles .glyphicon-briefcase:before {\n    content: "\\E139"; }\n  .gm-styles .glyphicon-fullscreen:before {\n    content: "\\E140"; }\n  .gm-styles .glyphicon-dashboard:before {\n    content: "\\E141"; }\n  .gm-styles .glyphicon-paperclip:before {\n    content: "\\E142"; }\n  .gm-styles .glyphicon-heart-empty:before {\n    content: "\\E143"; }\n  .gm-styles .glyphicon-link:before {\n    content: "\\E144"; }\n  .gm-styles .glyphicon-phone:before {\n    content: "\\E145"; }\n  .gm-styles .glyphicon-pushpin:before {\n    content: "\\E146"; }\n  .gm-styles .glyphicon-usd:before {\n    content: "\\E148"; }\n  .gm-styles .glyphicon-gbp:before {\n    content: "\\E149"; }\n  .gm-styles .glyphicon-sort:before {\n    content: "\\E150"; }\n  .gm-styles .glyphicon-sort-by-alphabet:before {\n    content: "\\E151"; }\n  .gm-styles .glyphicon-sort-by-alphabet-alt:before {\n    content: "\\E152"; }\n  .gm-styles .glyphicon-sort-by-order:before {\n    content: "\\E153"; }\n  .gm-styles .glyphicon-sort-by-order-alt:before {\n    content: "\\E154"; }\n  .gm-styles .glyphicon-sort-by-attributes:before {\n    content: "\\E155"; }\n  .gm-styles .glyphicon-sort-by-attributes-alt:before {\n    content: "\\E156"; }\n  .gm-styles .glyphicon-unchecked:before {\n    content: "\\E157"; }\n  .gm-styles .glyphicon-expand:before {\n    content: "\\E158"; }\n  .gm-styles .glyphicon-collapse-down:before {\n    content: "\\E159"; }\n  .gm-styles .glyphicon-collapse-up:before {\n    content: "\\E160"; }\n  .gm-styles .glyphicon-log-in:before {\n    content: "\\E161"; }\n  .gm-styles .glyphicon-flash:before {\n    content: "\\E162"; }\n  .gm-styles .glyphicon-log-out:before {\n    content: "\\E163"; }\n  .gm-styles .glyphicon-new-window:before {\n    content: "\\E164"; }\n  .gm-styles .glyphicon-record:before {\n    content: "\\E165"; }\n  .gm-styles .glyphicon-save:before {\n    content: "\\E166"; }\n  .gm-styles .glyphicon-open:before {\n    content: "\\E167"; }\n  .gm-styles .glyphicon-saved:before {\n    content: "\\E168"; }\n  .gm-styles .glyphicon-import:before {\n    content: "\\E169"; }\n  .gm-styles .glyphicon-export:before {\n    content: "\\E170"; }\n  .gm-styles .glyphicon-send:before {\n    content: "\\E171"; }\n  .gm-styles .glyphicon-floppy-disk:before {\n    content: "\\E172"; }\n  .gm-styles .glyphicon-floppy-saved:before {\n    content: "\\E173"; }\n  .gm-styles .glyphicon-floppy-remove:before {\n    content: "\\E174"; }\n  .gm-styles .glyphicon-floppy-save:before {\n    content: "\\E175"; }\n  .gm-styles .glyphicon-floppy-open:before {\n    content: "\\E176"; }\n  .gm-styles .glyphicon-credit-card:before {\n    content: "\\E177"; }\n  .gm-styles .glyphicon-transfer:before {\n    content: "\\E178"; }\n  .gm-styles .glyphicon-cutlery:before {\n    content: "\\E179"; }\n  .gm-styles .glyphicon-header:before {\n    content: "\\E180"; }\n  .gm-styles .glyphicon-compressed:before {\n    content: "\\E181"; }\n  .gm-styles .glyphicon-earphone:before {\n    content: "\\E182"; }\n  .gm-styles .glyphicon-phone-alt:before {\n    content: "\\E183"; }\n  .gm-styles .glyphicon-tower:before {\n    content: "\\E184"; }\n  .gm-styles .glyphicon-stats:before {\n    content: "\\E185"; }\n  .gm-styles .glyphicon-sd-video:before {\n    content: "\\E186"; }\n  .gm-styles .glyphicon-hd-video:before {\n    content: "\\E187"; }\n  .gm-styles .glyphicon-subtitles:before {\n    content: "\\E188"; }\n  .gm-styles .glyphicon-sound-stereo:before {\n    content: "\\E189"; }\n  .gm-styles .glyphicon-sound-dolby:before {\n    content: "\\E190"; }\n  .gm-styles .glyphicon-sound-5-1:before {\n    content: "\\E191"; }\n  .gm-styles .glyphicon-sound-6-1:before {\n    content: "\\E192"; }\n  .gm-styles .glyphicon-sound-7-1:before {\n    content: "\\E193"; }\n  .gm-styles .glyphicon-copyright-mark:before {\n    content: "\\E194"; }\n  .gm-styles .glyphicon-registration-mark:before {\n    content: "\\E195"; }\n  .gm-styles .glyphicon-cloud-download:before {\n    content: "\\E197"; }\n  .gm-styles .glyphicon-cloud-upload:before {\n    content: "\\E198"; }\n  .gm-styles .glyphicon-tree-conifer:before {\n    content: "\\E199"; }\n  .gm-styles .glyphicon-tree-deciduous:before {\n    content: "\\E200"; }\n  .gm-styles .glyphicon-cd:before {\n    content: "\\E201"; }\n  .gm-styles .glyphicon-save-file:before {\n    content: "\\E202"; }\n  .gm-styles .glyphicon-open-file:before {\n    content: "\\E203"; }\n  .gm-styles .glyphicon-level-up:before {\n    content: "\\E204"; }\n  .gm-styles .glyphicon-copy:before {\n    content: "\\E205"; }\n  .gm-styles .glyphicon-paste:before {\n    content: "\\E206"; }\n  .gm-styles .glyphicon-alert:before {\n    content: "\\E209"; }\n  .gm-styles .glyphicon-equalizer:before {\n    content: "\\E210"; }\n  .gm-styles .glyphicon-king:before {\n    content: "\\E211"; }\n  .gm-styles .glyphicon-queen:before {\n    content: "\\E212"; }\n  .gm-styles .glyphicon-pawn:before {\n    content: "\\E213"; }\n  .gm-styles .glyphicon-bishop:before {\n    content: "\\E214"; }\n  .gm-styles .glyphicon-knight:before {\n    content: "\\E215"; }\n  .gm-styles .glyphicon-baby-formula:before {\n    content: "\\E216"; }\n  .gm-styles .glyphicon-tent:before {\n    content: "\\26FA"; }\n  .gm-styles .glyphicon-blackboard:before {\n    content: "\\E218"; }\n  .gm-styles .glyphicon-bed:before {\n    content: "\\E219"; }\n  .gm-styles .glyphicon-apple:before {\n    content: "\\F8FF"; }\n  .gm-styles .glyphicon-erase:before {\n    content: "\\E221"; }\n  .gm-styles .glyphicon-hourglass:before {\n    content: "\\231B"; }\n  .gm-styles .glyphicon-lamp:before {\n    content: "\\E223"; }\n  .gm-styles .glyphicon-duplicate:before {\n    content: "\\E224"; }\n  .gm-styles .glyphicon-piggy-bank:before {\n    content: "\\E225"; }\n  .gm-styles .glyphicon-scissors:before {\n    content: "\\E226"; }\n  .gm-styles .glyphicon-bitcoin:before {\n    content: "\\E227"; }\n  .gm-styles .glyphicon-btc:before {\n    content: "\\E227"; }\n  .gm-styles .glyphicon-xbt:before {\n    content: "\\E227"; }\n  .gm-styles .glyphicon-yen:before {\n    content: "\\A5"; }\n  .gm-styles .glyphicon-jpy:before {\n    content: "\\A5"; }\n  .gm-styles .glyphicon-ruble:before {\n    content: "\\20BD"; }\n  .gm-styles .glyphicon-rub:before {\n    content: "\\20BD"; }\n  .gm-styles .glyphicon-scale:before {\n    content: "\\E230"; }\n  .gm-styles .glyphicon-ice-lolly:before {\n    content: "\\E231"; }\n  .gm-styles .glyphicon-ice-lolly-tasted:before {\n    content: "\\E232"; }\n  .gm-styles .glyphicon-education:before {\n    content: "\\E233"; }\n  .gm-styles .glyphicon-option-horizontal:before {\n    content: "\\E234"; }\n  .gm-styles .glyphicon-option-vertical:before {\n    content: "\\E235"; }\n  .gm-styles .glyphicon-menu-hamburger:before {\n    content: "\\E236"; }\n  .gm-styles .glyphicon-modal-window:before {\n    content: "\\E237"; }\n  .gm-styles .glyphicon-oil:before {\n    content: "\\E238"; }\n  .gm-styles .glyphicon-grain:before {\n    content: "\\E239"; }\n  .gm-styles .glyphicon-sunglasses:before {\n    content: "\\E240"; }\n  .gm-styles .glyphicon-text-size:before {\n    content: "\\E241"; }\n  .gm-styles .glyphicon-text-color:before {\n    content: "\\E242"; }\n  .gm-styles .glyphicon-text-background:before {\n    content: "\\E243"; }\n  .gm-styles .glyphicon-object-align-top:before {\n    content: "\\E244"; }\n  .gm-styles .glyphicon-object-align-bottom:before {\n    content: "\\E245"; }\n  .gm-styles .glyphicon-object-align-horizontal:before {\n    content: "\\E246"; }\n  .gm-styles .glyphicon-object-align-left:before {\n    content: "\\E247"; }\n  .gm-styles .glyphicon-object-align-vertical:before {\n    content: "\\E248"; }\n  .gm-styles .glyphicon-object-align-right:before {\n    content: "\\E249"; }\n  .gm-styles .glyphicon-triangle-right:before {\n    content: "\\E250"; }\n  .gm-styles .glyphicon-triangle-left:before {\n    content: "\\E251"; }\n  .gm-styles .glyphicon-triangle-bottom:before {\n    content: "\\E252"; }\n  .gm-styles .glyphicon-triangle-top:before {\n    content: "\\E253"; }\n  .gm-styles .glyphicon-console:before {\n    content: "\\E254"; }\n  .gm-styles .glyphicon-superscript:before {\n    content: "\\E255"; }\n  .gm-styles .glyphicon-subscript:before {\n    content: "\\E256"; }\n  .gm-styles .glyphicon-menu-left:before {\n    content: "\\E257"; }\n  .gm-styles .glyphicon-menu-right:before {\n    content: "\\E258"; }\n  .gm-styles .glyphicon-menu-down:before {\n    content: "\\E259"; }\n  .gm-styles .glyphicon-menu-up:before {\n    content: "\\E260"; }\n  .gm-styles * {\n    -webkit-box-sizing: border-box;\n    -moz-box-sizing: border-box;\n    box-sizing: border-box; }\n  .gm-styles *:before,\n  .gm-styles *:after {\n    -webkit-box-sizing: border-box;\n    -moz-box-sizing: border-box;\n    box-sizing: border-box; }\n  .gm-styles html {\n    font-size: 10px;\n    -webkit-tap-highlight-color: rgba(0, 0, 0, 0); }\n  .gm-styles body {\n    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n    font-size: 14px;\n    line-height: 1.42857;\n    color: #333333;\n    background-color: #fff; }\n  .gm-styles input,\n  .gm-styles button,\n  .gm-styles select,\n  .gm-styles textarea {\n    font-family: inherit;\n    font-size: inherit;\n    line-height: inherit; }\n  .gm-styles a {\n    color: #337ab7;\n    text-decoration: none; }\n    .gm-styles a:hover, .gm-styles a:focus {\n      color: #23527c;\n      text-decoration: underline; }\n    .gm-styles a:focus {\n      outline: 5px auto -webkit-focus-ring-color;\n      outline-offset: -2px; }\n  .gm-styles figure {\n    margin: 0; }\n  .gm-styles img {\n    vertical-align: middle; }\n  .gm-styles .img-responsive {\n    display: block;\n    max-width: 100%;\n    height: auto; }\n  .gm-styles .img-rounded {\n    border-radius: 6px; }\n  .gm-styles .img-thumbnail {\n    padding: 4px;\n    line-height: 1.42857;\n    background-color: #fff;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    -webkit-transition: all 0.2s ease-in-out;\n    -o-transition: all 0.2s ease-in-out;\n    transition: all 0.2s ease-in-out;\n    display: inline-block;\n    max-width: 100%;\n    height: auto; }\n  .gm-styles .img-circle {\n    border-radius: 50%; }\n  .gm-styles hr {\n    margin-top: 20px;\n    margin-bottom: 20px;\n    border: 0;\n    border-top: 1px solid #eeeeee; }\n  .gm-styles .sr-only {\n    position: absolute;\n    width: 1px;\n    height: 1px;\n    padding: 0;\n    margin: -1px;\n    overflow: hidden;\n    clip: rect(0, 0, 0, 0);\n    border: 0; }\n  .gm-styles .sr-only-focusable:active, .gm-styles .sr-only-focusable:focus {\n    position: static;\n    width: auto;\n    height: auto;\n    margin: 0;\n    overflow: visible;\n    clip: auto; }\n  .gm-styles [role="button"] {\n    cursor: pointer; }\n  .gm-styles h1, .gm-styles h2, .gm-styles h3, .gm-styles h4, .gm-styles h5, .gm-styles h6,\n  .gm-styles .h1, .gm-styles .h2, .gm-styles .h3, .gm-styles .h4, .gm-styles .h5, .gm-styles .h6 {\n    font-family: inherit;\n    font-weight: 500;\n    line-height: 1.1;\n    color: inherit; }\n    .gm-styles h1 small,\n    .gm-styles h1 .small, .gm-styles h2 small,\n    .gm-styles h2 .small, .gm-styles h3 small,\n    .gm-styles h3 .small, .gm-styles h4 small,\n    .gm-styles h4 .small, .gm-styles h5 small,\n    .gm-styles h5 .small, .gm-styles h6 small,\n    .gm-styles h6 .small,\n    .gm-styles .h1 small,\n    .gm-styles .h1 .small, .gm-styles .h2 small,\n    .gm-styles .h2 .small, .gm-styles .h3 small,\n    .gm-styles .h3 .small, .gm-styles .h4 small,\n    .gm-styles .h4 .small, .gm-styles .h5 small,\n    .gm-styles .h5 .small, .gm-styles .h6 small,\n    .gm-styles .h6 .small {\n      font-weight: 400;\n      line-height: 1;\n      color: #777777; }\n  .gm-styles h1, .gm-styles .h1,\n  .gm-styles h2, .gm-styles .h2,\n  .gm-styles h3, .gm-styles .h3 {\n    margin-top: 20px;\n    margin-bottom: 10px; }\n    .gm-styles h1 small,\n    .gm-styles h1 .small, .gm-styles .h1 small,\n    .gm-styles .h1 .small,\n    .gm-styles h2 small,\n    .gm-styles h2 .small, .gm-styles .h2 small,\n    .gm-styles .h2 .small,\n    .gm-styles h3 small,\n    .gm-styles h3 .small, .gm-styles .h3 small,\n    .gm-styles .h3 .small {\n      font-size: 65%; }\n  .gm-styles h4, .gm-styles .h4,\n  .gm-styles h5, .gm-styles .h5,\n  .gm-styles h6, .gm-styles .h6 {\n    margin-top: 10px;\n    margin-bottom: 10px; }\n    .gm-styles h4 small,\n    .gm-styles h4 .small, .gm-styles .h4 small,\n    .gm-styles .h4 .small,\n    .gm-styles h5 small,\n    .gm-styles h5 .small, .gm-styles .h5 small,\n    .gm-styles .h5 .small,\n    .gm-styles h6 small,\n    .gm-styles h6 .small, .gm-styles .h6 small,\n    .gm-styles .h6 .small {\n      font-size: 75%; }\n  .gm-styles h1, .gm-styles .h1 {\n    font-size: 36px; }\n  .gm-styles h2, .gm-styles .h2 {\n    font-size: 30px; }\n  .gm-styles h3, .gm-styles .h3 {\n    font-size: 24px; }\n  .gm-styles h4, .gm-styles .h4 {\n    font-size: 18px; }\n  .gm-styles h5, .gm-styles .h5 {\n    font-size: 14px; }\n  .gm-styles h6, .gm-styles .h6 {\n    font-size: 12px; }\n  .gm-styles p {\n    margin: 0 0 10px; }\n  .gm-styles .lead {\n    margin-bottom: 20px;\n    font-size: 16px;\n    font-weight: 300;\n    line-height: 1.4; }\n    @media (min-width: 768px) {\n      .gm-styles .lead {\n        font-size: 21px; } }\n  .gm-styles small,\n  .gm-styles .small {\n    font-size: 85%; }\n  .gm-styles mark,\n  .gm-styles .mark {\n    padding: .2em;\n    background-color: #fcf8e3; }\n  .gm-styles .text-left {\n    text-align: left; }\n  .gm-styles .text-right {\n    text-align: right; }\n  .gm-styles .text-center {\n    text-align: center; }\n  .gm-styles .text-justify {\n    text-align: justify; }\n  .gm-styles .text-nowrap {\n    white-space: nowrap; }\n  .gm-styles .text-lowercase {\n    text-transform: lowercase; }\n  .gm-styles .text-uppercase, .gm-styles .initialism {\n    text-transform: uppercase; }\n  .gm-styles .text-capitalize {\n    text-transform: capitalize; }\n  .gm-styles .text-muted {\n    color: #777777; }\n  .gm-styles .text-primary {\n    color: #337ab7; }\n  .gm-styles a.text-primary:hover,\n  .gm-styles a.text-primary:focus {\n    color: #286090; }\n  .gm-styles .text-success {\n    color: #3c763d; }\n  .gm-styles a.text-success:hover,\n  .gm-styles a.text-success:focus {\n    color: #2b542c; }\n  .gm-styles .text-info {\n    color: #31708f; }\n  .gm-styles a.text-info:hover,\n  .gm-styles a.text-info:focus {\n    color: #245269; }\n  .gm-styles .text-warning {\n    color: #8a6d3b; }\n  .gm-styles a.text-warning:hover,\n  .gm-styles a.text-warning:focus {\n    color: #66512c; }\n  .gm-styles .text-danger {\n    color: #a94442; }\n  .gm-styles a.text-danger:hover,\n  .gm-styles a.text-danger:focus {\n    color: #843534; }\n  .gm-styles .bg-primary {\n    color: #fff; }\n  .gm-styles .bg-primary {\n    background-color: #337ab7; }\n  .gm-styles a.bg-primary:hover,\n  .gm-styles a.bg-primary:focus {\n    background-color: #286090; }\n  .gm-styles .bg-success {\n    background-color: #dff0d8; }\n  .gm-styles a.bg-success:hover,\n  .gm-styles a.bg-success:focus {\n    background-color: #c1e2b3; }\n  .gm-styles .bg-info {\n    background-color: #d9edf7; }\n  .gm-styles a.bg-info:hover,\n  .gm-styles a.bg-info:focus {\n    background-color: #afd9ee; }\n  .gm-styles .bg-warning {\n    background-color: #fcf8e3; }\n  .gm-styles a.bg-warning:hover,\n  .gm-styles a.bg-warning:focus {\n    background-color: #f7ecb5; }\n  .gm-styles .bg-danger {\n    background-color: #f2dede; }\n  .gm-styles a.bg-danger:hover,\n  .gm-styles a.bg-danger:focus {\n    background-color: #e4b9b9; }\n  .gm-styles .page-header {\n    padding-bottom: 9px;\n    margin: 40px 0 20px;\n    border-bottom: 1px solid #eeeeee; }\n  .gm-styles ul,\n  .gm-styles ol {\n    margin-top: 0;\n    margin-bottom: 10px; }\n    .gm-styles ul ul,\n    .gm-styles ul ol,\n    .gm-styles ol ul,\n    .gm-styles ol ol {\n      margin-bottom: 0; }\n  .gm-styles .list-unstyled {\n    padding-left: 0;\n    list-style: none; }\n  .gm-styles .list-inline {\n    padding-left: 0;\n    list-style: none;\n    margin-left: -5px; }\n    .gm-styles .list-inline > li {\n      display: inline-block;\n      padding-right: 5px;\n      padding-left: 5px; }\n  .gm-styles dl {\n    margin-top: 0;\n    margin-bottom: 20px; }\n  .gm-styles dt,\n  .gm-styles dd {\n    line-height: 1.42857; }\n  .gm-styles dt {\n    font-weight: 700; }\n  .gm-styles dd {\n    margin-left: 0; }\n  .gm-styles .dl-horizontal dd:before, .gm-styles .dl-horizontal dd:after {\n    display: table;\n    content: " "; }\n  .gm-styles .dl-horizontal dd:after {\n    clear: both; }\n  @media (min-width: 768px) {\n    .gm-styles .dl-horizontal dt {\n      float: left;\n      width: 160px;\n      clear: left;\n      text-align: right;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap; }\n    .gm-styles .dl-horizontal dd {\n      margin-left: 180px; } }\n  .gm-styles abbr[title],\n  .gm-styles abbr[data-original-title] {\n    cursor: help; }\n  .gm-styles .initialism {\n    font-size: 90%; }\n  .gm-styles blockquote {\n    padding: 10px 20px;\n    margin: 0 0 20px;\n    font-size: 17.5px;\n    border-left: 5px solid #eeeeee; }\n    .gm-styles blockquote p:last-child,\n    .gm-styles blockquote ul:last-child,\n    .gm-styles blockquote ol:last-child {\n      margin-bottom: 0; }\n    .gm-styles blockquote footer,\n    .gm-styles blockquote small,\n    .gm-styles blockquote .small {\n      display: block;\n      font-size: 80%;\n      line-height: 1.42857;\n      color: #777777; }\n      .gm-styles blockquote footer:before,\n      .gm-styles blockquote small:before,\n      .gm-styles blockquote .small:before {\n        content: "\\2014   \\A0"; }\n  .gm-styles .blockquote-reverse,\n  .gm-styles blockquote.pull-right {\n    padding-right: 15px;\n    padding-left: 0;\n    text-align: right;\n    border-right: 5px solid #eeeeee;\n    border-left: 0; }\n    .gm-styles .blockquote-reverse footer:before,\n    .gm-styles .blockquote-reverse small:before,\n    .gm-styles .blockquote-reverse .small:before,\n    .gm-styles blockquote.pull-right footer:before,\n    .gm-styles blockquote.pull-right small:before,\n    .gm-styles blockquote.pull-right .small:before {\n      content: ""; }\n    .gm-styles .blockquote-reverse footer:after,\n    .gm-styles .blockquote-reverse small:after,\n    .gm-styles .blockquote-reverse .small:after,\n    .gm-styles blockquote.pull-right footer:after,\n    .gm-styles blockquote.pull-right small:after,\n    .gm-styles blockquote.pull-right .small:after {\n      content: "\\A0   \\2014"; }\n  .gm-styles address {\n    margin-bottom: 20px;\n    font-style: normal;\n    line-height: 1.42857; }\n  .gm-styles code,\n  .gm-styles kbd,\n  .gm-styles pre,\n  .gm-styles samp {\n    font-family: Menlo, Monaco, Consolas, "Courier New", monospace; }\n  .gm-styles code {\n    padding: 2px 4px;\n    font-size: 90%;\n    color: #c7254e;\n    background-color: #f9f2f4;\n    border-radius: 4px; }\n  .gm-styles kbd {\n    padding: 2px 4px;\n    font-size: 90%;\n    color: #fff;\n    background-color: #333;\n    border-radius: 3px;\n    box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25); }\n    .gm-styles kbd kbd {\n      padding: 0;\n      font-size: 100%;\n      font-weight: 700;\n      box-shadow: none; }\n  .gm-styles pre {\n    display: block;\n    padding: 9.5px;\n    margin: 0 0 10px;\n    font-size: 13px;\n    line-height: 1.42857;\n    color: #333333;\n    word-break: break-all;\n    word-wrap: break-word;\n    background-color: #f5f5f5;\n    border: 1px solid #ccc;\n    border-radius: 4px; }\n    .gm-styles pre code {\n      padding: 0;\n      font-size: inherit;\n      color: inherit;\n      white-space: pre-wrap;\n      background-color: transparent;\n      border-radius: 0; }\n  .gm-styles .pre-scrollable {\n    max-height: 340px;\n    overflow-y: scroll; }\n  .gm-styles .container {\n    padding-right: 15px;\n    padding-left: 15px;\n    margin-right: auto;\n    margin-left: auto; }\n    .gm-styles .container:before, .gm-styles .container:after {\n      display: table;\n      content: " "; }\n    .gm-styles .container:after {\n      clear: both; }\n    @media (min-width: 768px) {\n      .gm-styles .container {\n        width: 750px; } }\n    @media (min-width: 992px) {\n      .gm-styles .container {\n        width: 970px; } }\n    @media (min-width: 1200px) {\n      .gm-styles .container {\n        width: 1170px; } }\n  .gm-styles .container-fluid {\n    padding-right: 15px;\n    padding-left: 15px;\n    margin-right: auto;\n    margin-left: auto; }\n    .gm-styles .container-fluid:before, .gm-styles .container-fluid:after {\n      display: table;\n      content: " "; }\n    .gm-styles .container-fluid:after {\n      clear: both; }\n  .gm-styles .row {\n    margin-right: -15px;\n    margin-left: -15px; }\n    .gm-styles .row:before, .gm-styles .row:after {\n      display: table;\n      content: " "; }\n    .gm-styles .row:after {\n      clear: both; }\n  .gm-styles .row-no-gutters {\n    margin-right: 0;\n    margin-left: 0; }\n    .gm-styles .row-no-gutters [class*="col-"] {\n      padding-right: 0;\n      padding-left: 0; }\n  .gm-styles .col-xs-1, .gm-styles .col-sm-1, .gm-styles .col-md-1, .gm-styles .col-lg-1, .gm-styles .col-xs-2, .gm-styles .col-sm-2, .gm-styles .col-md-2, .gm-styles .col-lg-2, .gm-styles .col-xs-3, .gm-styles .col-sm-3, .gm-styles .col-md-3, .gm-styles .col-lg-3, .gm-styles .col-xs-4, .gm-styles .col-sm-4, .gm-styles .col-md-4, .gm-styles .col-lg-4, .gm-styles .col-xs-5, .gm-styles .col-sm-5, .gm-styles .col-md-5, .gm-styles .col-lg-5, .gm-styles .col-xs-6, .gm-styles .col-sm-6, .gm-styles .col-md-6, .gm-styles .col-lg-6, .gm-styles .col-xs-7, .gm-styles .col-sm-7, .gm-styles .col-md-7, .gm-styles .col-lg-7, .gm-styles .col-xs-8, .gm-styles .col-sm-8, .gm-styles .col-md-8, .gm-styles .col-lg-8, .gm-styles .col-xs-9, .gm-styles .col-sm-9, .gm-styles .col-md-9, .gm-styles .col-lg-9, .gm-styles .col-xs-10, .gm-styles .col-sm-10, .gm-styles .col-md-10, .gm-styles .col-lg-10, .gm-styles .col-xs-11, .gm-styles .col-sm-11, .gm-styles .col-md-11, .gm-styles .col-lg-11, .gm-styles .col-xs-12, .gm-styles .col-sm-12, .gm-styles .col-md-12, .gm-styles .col-lg-12 {\n    position: relative;\n    min-height: 1px;\n    padding-right: 15px;\n    padding-left: 15px; }\n  .gm-styles .col-xs-1, .gm-styles .col-xs-2, .gm-styles .col-xs-3, .gm-styles .col-xs-4, .gm-styles .col-xs-5, .gm-styles .col-xs-6, .gm-styles .col-xs-7, .gm-styles .col-xs-8, .gm-styles .col-xs-9, .gm-styles .col-xs-10, .gm-styles .col-xs-11, .gm-styles .col-xs-12 {\n    float: left; }\n  .gm-styles .col-xs-1 {\n    width: 8.33333%; }\n  .gm-styles .col-xs-2 {\n    width: 16.66667%; }\n  .gm-styles .col-xs-3 {\n    width: 25%; }\n  .gm-styles .col-xs-4 {\n    width: 33.33333%; }\n  .gm-styles .col-xs-5 {\n    width: 41.66667%; }\n  .gm-styles .col-xs-6 {\n    width: 50%; }\n  .gm-styles .col-xs-7 {\n    width: 58.33333%; }\n  .gm-styles .col-xs-8 {\n    width: 66.66667%; }\n  .gm-styles .col-xs-9 {\n    width: 75%; }\n  .gm-styles .col-xs-10 {\n    width: 83.33333%; }\n  .gm-styles .col-xs-11 {\n    width: 91.66667%; }\n  .gm-styles .col-xs-12 {\n    width: 100%; }\n  .gm-styles .col-xs-pull-0 {\n    right: auto; }\n  .gm-styles .col-xs-pull-1 {\n    right: 8.33333%; }\n  .gm-styles .col-xs-pull-2 {\n    right: 16.66667%; }\n  .gm-styles .col-xs-pull-3 {\n    right: 25%; }\n  .gm-styles .col-xs-pull-4 {\n    right: 33.33333%; }\n  .gm-styles .col-xs-pull-5 {\n    right: 41.66667%; }\n  .gm-styles .col-xs-pull-6 {\n    right: 50%; }\n  .gm-styles .col-xs-pull-7 {\n    right: 58.33333%; }\n  .gm-styles .col-xs-pull-8 {\n    right: 66.66667%; }\n  .gm-styles .col-xs-pull-9 {\n    right: 75%; }\n  .gm-styles .col-xs-pull-10 {\n    right: 83.33333%; }\n  .gm-styles .col-xs-pull-11 {\n    right: 91.66667%; }\n  .gm-styles .col-xs-pull-12 {\n    right: 100%; }\n  .gm-styles .col-xs-push-0 {\n    left: auto; }\n  .gm-styles .col-xs-push-1 {\n    left: 8.33333%; }\n  .gm-styles .col-xs-push-2 {\n    left: 16.66667%; }\n  .gm-styles .col-xs-push-3 {\n    left: 25%; }\n  .gm-styles .col-xs-push-4 {\n    left: 33.33333%; }\n  .gm-styles .col-xs-push-5 {\n    left: 41.66667%; }\n  .gm-styles .col-xs-push-6 {\n    left: 50%; }\n  .gm-styles .col-xs-push-7 {\n    left: 58.33333%; }\n  .gm-styles .col-xs-push-8 {\n    left: 66.66667%; }\n  .gm-styles .col-xs-push-9 {\n    left: 75%; }\n  .gm-styles .col-xs-push-10 {\n    left: 83.33333%; }\n  .gm-styles .col-xs-push-11 {\n    left: 91.66667%; }\n  .gm-styles .col-xs-push-12 {\n    left: 100%; }\n  .gm-styles .col-xs-offset-0 {\n    margin-left: 0%; }\n  .gm-styles .col-xs-offset-1 {\n    margin-left: 8.33333%; }\n  .gm-styles .col-xs-offset-2 {\n    margin-left: 16.66667%; }\n  .gm-styles .col-xs-offset-3 {\n    margin-left: 25%; }\n  .gm-styles .col-xs-offset-4 {\n    margin-left: 33.33333%; }\n  .gm-styles .col-xs-offset-5 {\n    margin-left: 41.66667%; }\n  .gm-styles .col-xs-offset-6 {\n    margin-left: 50%; }\n  .gm-styles .col-xs-offset-7 {\n    margin-left: 58.33333%; }\n  .gm-styles .col-xs-offset-8 {\n    margin-left: 66.66667%; }\n  .gm-styles .col-xs-offset-9 {\n    margin-left: 75%; }\n  .gm-styles .col-xs-offset-10 {\n    margin-left: 83.33333%; }\n  .gm-styles .col-xs-offset-11 {\n    margin-left: 91.66667%; }\n  .gm-styles .col-xs-offset-12 {\n    margin-left: 100%; }\n  @media (min-width: 768px) {\n    .gm-styles .col-sm-1, .gm-styles .col-sm-2, .gm-styles .col-sm-3, .gm-styles .col-sm-4, .gm-styles .col-sm-5, .gm-styles .col-sm-6, .gm-styles .col-sm-7, .gm-styles .col-sm-8, .gm-styles .col-sm-9, .gm-styles .col-sm-10, .gm-styles .col-sm-11, .gm-styles .col-sm-12 {\n      float: left; }\n    .gm-styles .col-sm-1 {\n      width: 8.33333%; }\n    .gm-styles .col-sm-2 {\n      width: 16.66667%; }\n    .gm-styles .col-sm-3 {\n      width: 25%; }\n    .gm-styles .col-sm-4 {\n      width: 33.33333%; }\n    .gm-styles .col-sm-5 {\n      width: 41.66667%; }\n    .gm-styles .col-sm-6 {\n      width: 50%; }\n    .gm-styles .col-sm-7 {\n      width: 58.33333%; }\n    .gm-styles .col-sm-8 {\n      width: 66.66667%; }\n    .gm-styles .col-sm-9 {\n      width: 75%; }\n    .gm-styles .col-sm-10 {\n      width: 83.33333%; }\n    .gm-styles .col-sm-11 {\n      width: 91.66667%; }\n    .gm-styles .col-sm-12 {\n      width: 100%; }\n    .gm-styles .col-sm-pull-0 {\n      right: auto; }\n    .gm-styles .col-sm-pull-1 {\n      right: 8.33333%; }\n    .gm-styles .col-sm-pull-2 {\n      right: 16.66667%; }\n    .gm-styles .col-sm-pull-3 {\n      right: 25%; }\n    .gm-styles .col-sm-pull-4 {\n      right: 33.33333%; }\n    .gm-styles .col-sm-pull-5 {\n      right: 41.66667%; }\n    .gm-styles .col-sm-pull-6 {\n      right: 50%; }\n    .gm-styles .col-sm-pull-7 {\n      right: 58.33333%; }\n    .gm-styles .col-sm-pull-8 {\n      right: 66.66667%; }\n    .gm-styles .col-sm-pull-9 {\n      right: 75%; }\n    .gm-styles .col-sm-pull-10 {\n      right: 83.33333%; }\n    .gm-styles .col-sm-pull-11 {\n      right: 91.66667%; }\n    .gm-styles .col-sm-pull-12 {\n      right: 100%; }\n    .gm-styles .col-sm-push-0 {\n      left: auto; }\n    .gm-styles .col-sm-push-1 {\n      left: 8.33333%; }\n    .gm-styles .col-sm-push-2 {\n      left: 16.66667%; }\n    .gm-styles .col-sm-push-3 {\n      left: 25%; }\n    .gm-styles .col-sm-push-4 {\n      left: 33.33333%; }\n    .gm-styles .col-sm-push-5 {\n      left: 41.66667%; }\n    .gm-styles .col-sm-push-6 {\n      left: 50%; }\n    .gm-styles .col-sm-push-7 {\n      left: 58.33333%; }\n    .gm-styles .col-sm-push-8 {\n      left: 66.66667%; }\n    .gm-styles .col-sm-push-9 {\n      left: 75%; }\n    .gm-styles .col-sm-push-10 {\n      left: 83.33333%; }\n    .gm-styles .col-sm-push-11 {\n      left: 91.66667%; }\n    .gm-styles .col-sm-push-12 {\n      left: 100%; }\n    .gm-styles .col-sm-offset-0 {\n      margin-left: 0%; }\n    .gm-styles .col-sm-offset-1 {\n      margin-left: 8.33333%; }\n    .gm-styles .col-sm-offset-2 {\n      margin-left: 16.66667%; }\n    .gm-styles .col-sm-offset-3 {\n      margin-left: 25%; }\n    .gm-styles .col-sm-offset-4 {\n      margin-left: 33.33333%; }\n    .gm-styles .col-sm-offset-5 {\n      margin-left: 41.66667%; }\n    .gm-styles .col-sm-offset-6 {\n      margin-left: 50%; }\n    .gm-styles .col-sm-offset-7 {\n      margin-left: 58.33333%; }\n    .gm-styles .col-sm-offset-8 {\n      margin-left: 66.66667%; }\n    .gm-styles .col-sm-offset-9 {\n      margin-left: 75%; }\n    .gm-styles .col-sm-offset-10 {\n      margin-left: 83.33333%; }\n    .gm-styles .col-sm-offset-11 {\n      margin-left: 91.66667%; }\n    .gm-styles .col-sm-offset-12 {\n      margin-left: 100%; } }\n  @media (min-width: 992px) {\n    .gm-styles .col-md-1, .gm-styles .col-md-2, .gm-styles .col-md-3, .gm-styles .col-md-4, .gm-styles .col-md-5, .gm-styles .col-md-6, .gm-styles .col-md-7, .gm-styles .col-md-8, .gm-styles .col-md-9, .gm-styles .col-md-10, .gm-styles .col-md-11, .gm-styles .col-md-12 {\n      float: left; }\n    .gm-styles .col-md-1 {\n      width: 8.33333%; }\n    .gm-styles .col-md-2 {\n      width: 16.66667%; }\n    .gm-styles .col-md-3 {\n      width: 25%; }\n    .gm-styles .col-md-4 {\n      width: 33.33333%; }\n    .gm-styles .col-md-5 {\n      width: 41.66667%; }\n    .gm-styles .col-md-6 {\n      width: 50%; }\n    .gm-styles .col-md-7 {\n      width: 58.33333%; }\n    .gm-styles .col-md-8 {\n      width: 66.66667%; }\n    .gm-styles .col-md-9 {\n      width: 75%; }\n    .gm-styles .col-md-10 {\n      width: 83.33333%; }\n    .gm-styles .col-md-11 {\n      width: 91.66667%; }\n    .gm-styles .col-md-12 {\n      width: 100%; }\n    .gm-styles .col-md-pull-0 {\n      right: auto; }\n    .gm-styles .col-md-pull-1 {\n      right: 8.33333%; }\n    .gm-styles .col-md-pull-2 {\n      right: 16.66667%; }\n    .gm-styles .col-md-pull-3 {\n      right: 25%; }\n    .gm-styles .col-md-pull-4 {\n      right: 33.33333%; }\n    .gm-styles .col-md-pull-5 {\n      right: 41.66667%; }\n    .gm-styles .col-md-pull-6 {\n      right: 50%; }\n    .gm-styles .col-md-pull-7 {\n      right: 58.33333%; }\n    .gm-styles .col-md-pull-8 {\n      right: 66.66667%; }\n    .gm-styles .col-md-pull-9 {\n      right: 75%; }\n    .gm-styles .col-md-pull-10 {\n      right: 83.33333%; }\n    .gm-styles .col-md-pull-11 {\n      right: 91.66667%; }\n    .gm-styles .col-md-pull-12 {\n      right: 100%; }\n    .gm-styles .col-md-push-0 {\n      left: auto; }\n    .gm-styles .col-md-push-1 {\n      left: 8.33333%; }\n    .gm-styles .col-md-push-2 {\n      left: 16.66667%; }\n    .gm-styles .col-md-push-3 {\n      left: 25%; }\n    .gm-styles .col-md-push-4 {\n      left: 33.33333%; }\n    .gm-styles .col-md-push-5 {\n      left: 41.66667%; }\n    .gm-styles .col-md-push-6 {\n      left: 50%; }\n    .gm-styles .col-md-push-7 {\n      left: 58.33333%; }\n    .gm-styles .col-md-push-8 {\n      left: 66.66667%; }\n    .gm-styles .col-md-push-9 {\n      left: 75%; }\n    .gm-styles .col-md-push-10 {\n      left: 83.33333%; }\n    .gm-styles .col-md-push-11 {\n      left: 91.66667%; }\n    .gm-styles .col-md-push-12 {\n      left: 100%; }\n    .gm-styles .col-md-offset-0 {\n      margin-left: 0%; }\n    .gm-styles .col-md-offset-1 {\n      margin-left: 8.33333%; }\n    .gm-styles .col-md-offset-2 {\n      margin-left: 16.66667%; }\n    .gm-styles .col-md-offset-3 {\n      margin-left: 25%; }\n    .gm-styles .col-md-offset-4 {\n      margin-left: 33.33333%; }\n    .gm-styles .col-md-offset-5 {\n      margin-left: 41.66667%; }\n    .gm-styles .col-md-offset-6 {\n      margin-left: 50%; }\n    .gm-styles .col-md-offset-7 {\n      margin-left: 58.33333%; }\n    .gm-styles .col-md-offset-8 {\n      margin-left: 66.66667%; }\n    .gm-styles .col-md-offset-9 {\n      margin-left: 75%; }\n    .gm-styles .col-md-offset-10 {\n      margin-left: 83.33333%; }\n    .gm-styles .col-md-offset-11 {\n      margin-left: 91.66667%; }\n    .gm-styles .col-md-offset-12 {\n      margin-left: 100%; } }\n  @media (min-width: 1200px) {\n    .gm-styles .col-lg-1, .gm-styles .col-lg-2, .gm-styles .col-lg-3, .gm-styles .col-lg-4, .gm-styles .col-lg-5, .gm-styles .col-lg-6, .gm-styles .col-lg-7, .gm-styles .col-lg-8, .gm-styles .col-lg-9, .gm-styles .col-lg-10, .gm-styles .col-lg-11, .gm-styles .col-lg-12 {\n      float: left; }\n    .gm-styles .col-lg-1 {\n      width: 8.33333%; }\n    .gm-styles .col-lg-2 {\n      width: 16.66667%; }\n    .gm-styles .col-lg-3 {\n      width: 25%; }\n    .gm-styles .col-lg-4 {\n      width: 33.33333%; }\n    .gm-styles .col-lg-5 {\n      width: 41.66667%; }\n    .gm-styles .col-lg-6 {\n      width: 50%; }\n    .gm-styles .col-lg-7 {\n      width: 58.33333%; }\n    .gm-styles .col-lg-8 {\n      width: 66.66667%; }\n    .gm-styles .col-lg-9 {\n      width: 75%; }\n    .gm-styles .col-lg-10 {\n      width: 83.33333%; }\n    .gm-styles .col-lg-11 {\n      width: 91.66667%; }\n    .gm-styles .col-lg-12 {\n      width: 100%; }\n    .gm-styles .col-lg-pull-0 {\n      right: auto; }\n    .gm-styles .col-lg-pull-1 {\n      right: 8.33333%; }\n    .gm-styles .col-lg-pull-2 {\n      right: 16.66667%; }\n    .gm-styles .col-lg-pull-3 {\n      right: 25%; }\n    .gm-styles .col-lg-pull-4 {\n      right: 33.33333%; }\n    .gm-styles .col-lg-pull-5 {\n      right: 41.66667%; }\n    .gm-styles .col-lg-pull-6 {\n      right: 50%; }\n    .gm-styles .col-lg-pull-7 {\n      right: 58.33333%; }\n    .gm-styles .col-lg-pull-8 {\n      right: 66.66667%; }\n    .gm-styles .col-lg-pull-9 {\n      right: 75%; }\n    .gm-styles .col-lg-pull-10 {\n      right: 83.33333%; }\n    .gm-styles .col-lg-pull-11 {\n      right: 91.66667%; }\n    .gm-styles .col-lg-pull-12 {\n      right: 100%; }\n    .gm-styles .col-lg-push-0 {\n      left: auto; }\n    .gm-styles .col-lg-push-1 {\n      left: 8.33333%; }\n    .gm-styles .col-lg-push-2 {\n      left: 16.66667%; }\n    .gm-styles .col-lg-push-3 {\n      left: 25%; }\n    .gm-styles .col-lg-push-4 {\n      left: 33.33333%; }\n    .gm-styles .col-lg-push-5 {\n      left: 41.66667%; }\n    .gm-styles .col-lg-push-6 {\n      left: 50%; }\n    .gm-styles .col-lg-push-7 {\n      left: 58.33333%; }\n    .gm-styles .col-lg-push-8 {\n      left: 66.66667%; }\n    .gm-styles .col-lg-push-9 {\n      left: 75%; }\n    .gm-styles .col-lg-push-10 {\n      left: 83.33333%; }\n    .gm-styles .col-lg-push-11 {\n      left: 91.66667%; }\n    .gm-styles .col-lg-push-12 {\n      left: 100%; }\n    .gm-styles .col-lg-offset-0 {\n      margin-left: 0%; }\n    .gm-styles .col-lg-offset-1 {\n      margin-left: 8.33333%; }\n    .gm-styles .col-lg-offset-2 {\n      margin-left: 16.66667%; }\n    .gm-styles .col-lg-offset-3 {\n      margin-left: 25%; }\n    .gm-styles .col-lg-offset-4 {\n      margin-left: 33.33333%; }\n    .gm-styles .col-lg-offset-5 {\n      margin-left: 41.66667%; }\n    .gm-styles .col-lg-offset-6 {\n      margin-left: 50%; }\n    .gm-styles .col-lg-offset-7 {\n      margin-left: 58.33333%; }\n    .gm-styles .col-lg-offset-8 {\n      margin-left: 66.66667%; }\n    .gm-styles .col-lg-offset-9 {\n      margin-left: 75%; }\n    .gm-styles .col-lg-offset-10 {\n      margin-left: 83.33333%; }\n    .gm-styles .col-lg-offset-11 {\n      margin-left: 91.66667%; }\n    .gm-styles .col-lg-offset-12 {\n      margin-left: 100%; } }\n  .gm-styles table {\n    background-color: transparent; }\n    .gm-styles table col[class*="col-"] {\n      position: static;\n      display: table-column;\n      float: none; }\n    .gm-styles table td[class*="col-"],\n    .gm-styles table th[class*="col-"] {\n      position: static;\n      display: table-cell;\n      float: none; }\n  .gm-styles caption {\n    padding-top: 8px;\n    padding-bottom: 8px;\n    color: #777777;\n    text-align: left; }\n  .gm-styles th {\n    text-align: left; }\n  .gm-styles .table {\n    width: 100%;\n    max-width: 100%;\n    margin-bottom: 20px; }\n    .gm-styles .table > thead > tr > th,\n    .gm-styles .table > thead > tr > td,\n    .gm-styles .table > tbody > tr > th,\n    .gm-styles .table > tbody > tr > td,\n    .gm-styles .table > tfoot > tr > th,\n    .gm-styles .table > tfoot > tr > td {\n      padding: 8px;\n      line-height: 1.42857;\n      vertical-align: top;\n      border-top: 1px solid #ddd; }\n    .gm-styles .table > thead > tr > th {\n      vertical-align: bottom;\n      border-bottom: 2px solid #ddd; }\n    .gm-styles .table > caption + thead > tr:first-child > th,\n    .gm-styles .table > caption + thead > tr:first-child > td,\n    .gm-styles .table > colgroup + thead > tr:first-child > th,\n    .gm-styles .table > colgroup + thead > tr:first-child > td,\n    .gm-styles .table > thead:first-child > tr:first-child > th,\n    .gm-styles .table > thead:first-child > tr:first-child > td {\n      border-top: 0; }\n    .gm-styles .table > tbody + tbody {\n      border-top: 2px solid #ddd; }\n    .gm-styles .table .table {\n      background-color: #fff; }\n  .gm-styles .table-condensed > thead > tr > th,\n  .gm-styles .table-condensed > thead > tr > td,\n  .gm-styles .table-condensed > tbody > tr > th,\n  .gm-styles .table-condensed > tbody > tr > td,\n  .gm-styles .table-condensed > tfoot > tr > th,\n  .gm-styles .table-condensed > tfoot > tr > td {\n    padding: 5px; }\n  .gm-styles .table-bordered {\n    border: 1px solid #ddd; }\n    .gm-styles .table-bordered > thead > tr > th,\n    .gm-styles .table-bordered > thead > tr > td,\n    .gm-styles .table-bordered > tbody > tr > th,\n    .gm-styles .table-bordered > tbody > tr > td,\n    .gm-styles .table-bordered > tfoot > tr > th,\n    .gm-styles .table-bordered > tfoot > tr > td {\n      border: 1px solid #ddd; }\n    .gm-styles .table-bordered > thead > tr > th,\n    .gm-styles .table-bordered > thead > tr > td {\n      border-bottom-width: 2px; }\n  .gm-styles .table-striped > tbody > tr:nth-of-type(odd) {\n    background-color: #f9f9f9; }\n  .gm-styles .table-hover > tbody > tr:hover {\n    background-color: #f5f5f5; }\n  .gm-styles .table > thead > tr > td.active,\n  .gm-styles .table > thead > tr > th.active,\n  .gm-styles .table > thead > tr.active > td,\n  .gm-styles .table > thead > tr.active > th,\n  .gm-styles .table > tbody > tr > td.active,\n  .gm-styles .table > tbody > tr > th.active,\n  .gm-styles .table > tbody > tr.active > td,\n  .gm-styles .table > tbody > tr.active > th,\n  .gm-styles .table > tfoot > tr > td.active,\n  .gm-styles .table > tfoot > tr > th.active,\n  .gm-styles .table > tfoot > tr.active > td,\n  .gm-styles .table > tfoot > tr.active > th {\n    background-color: #f5f5f5; }\n  .gm-styles .table-hover > tbody > tr > td.active:hover,\n  .gm-styles .table-hover > tbody > tr > th.active:hover,\n  .gm-styles .table-hover > tbody > tr.active:hover > td,\n  .gm-styles .table-hover > tbody > tr:hover > .active,\n  .gm-styles .table-hover > tbody > tr.active:hover > th {\n    background-color: #e8e8e8; }\n  .gm-styles .table > thead > tr > td.success,\n  .gm-styles .table > thead > tr > th.success,\n  .gm-styles .table > thead > tr.success > td,\n  .gm-styles .table > thead > tr.success > th,\n  .gm-styles .table > tbody > tr > td.success,\n  .gm-styles .table > tbody > tr > th.success,\n  .gm-styles .table > tbody > tr.success > td,\n  .gm-styles .table > tbody > tr.success > th,\n  .gm-styles .table > tfoot > tr > td.success,\n  .gm-styles .table > tfoot > tr > th.success,\n  .gm-styles .table > tfoot > tr.success > td,\n  .gm-styles .table > tfoot > tr.success > th {\n    background-color: #dff0d8; }\n  .gm-styles .table-hover > tbody > tr > td.success:hover,\n  .gm-styles .table-hover > tbody > tr > th.success:hover,\n  .gm-styles .table-hover > tbody > tr.success:hover > td,\n  .gm-styles .table-hover > tbody > tr:hover > .success,\n  .gm-styles .table-hover > tbody > tr.success:hover > th {\n    background-color: #d0e9c6; }\n  .gm-styles .table > thead > tr > td.info,\n  .gm-styles .table > thead > tr > th.info,\n  .gm-styles .table > thead > tr.info > td,\n  .gm-styles .table > thead > tr.info > th,\n  .gm-styles .table > tbody > tr > td.info,\n  .gm-styles .table > tbody > tr > th.info,\n  .gm-styles .table > tbody > tr.info > td,\n  .gm-styles .table > tbody > tr.info > th,\n  .gm-styles .table > tfoot > tr > td.info,\n  .gm-styles .table > tfoot > tr > th.info,\n  .gm-styles .table > tfoot > tr.info > td,\n  .gm-styles .table > tfoot > tr.info > th {\n    background-color: #d9edf7; }\n  .gm-styles .table-hover > tbody > tr > td.info:hover,\n  .gm-styles .table-hover > tbody > tr > th.info:hover,\n  .gm-styles .table-hover > tbody > tr.info:hover > td,\n  .gm-styles .table-hover > tbody > tr:hover > .info,\n  .gm-styles .table-hover > tbody > tr.info:hover > th {\n    background-color: #c4e3f3; }\n  .gm-styles .table > thead > tr > td.warning,\n  .gm-styles .table > thead > tr > th.warning,\n  .gm-styles .table > thead > tr.warning > td,\n  .gm-styles .table > thead > tr.warning > th,\n  .gm-styles .table > tbody > tr > td.warning,\n  .gm-styles .table > tbody > tr > th.warning,\n  .gm-styles .table > tbody > tr.warning > td,\n  .gm-styles .table > tbody > tr.warning > th,\n  .gm-styles .table > tfoot > tr > td.warning,\n  .gm-styles .table > tfoot > tr > th.warning,\n  .gm-styles .table > tfoot > tr.warning > td,\n  .gm-styles .table > tfoot > tr.warning > th {\n    background-color: #fcf8e3; }\n  .gm-styles .table-hover > tbody > tr > td.warning:hover,\n  .gm-styles .table-hover > tbody > tr > th.warning:hover,\n  .gm-styles .table-hover > tbody > tr.warning:hover > td,\n  .gm-styles .table-hover > tbody > tr:hover > .warning,\n  .gm-styles .table-hover > tbody > tr.warning:hover > th {\n    background-color: #faf2cc; }\n  .gm-styles .table > thead > tr > td.danger,\n  .gm-styles .table > thead > tr > th.danger,\n  .gm-styles .table > thead > tr.danger > td,\n  .gm-styles .table > thead > tr.danger > th,\n  .gm-styles .table > tbody > tr > td.danger,\n  .gm-styles .table > tbody > tr > th.danger,\n  .gm-styles .table > tbody > tr.danger > td,\n  .gm-styles .table > tbody > tr.danger > th,\n  .gm-styles .table > tfoot > tr > td.danger,\n  .gm-styles .table > tfoot > tr > th.danger,\n  .gm-styles .table > tfoot > tr.danger > td,\n  .gm-styles .table > tfoot > tr.danger > th {\n    background-color: #f2dede; }\n  .gm-styles .table-hover > tbody > tr > td.danger:hover,\n  .gm-styles .table-hover > tbody > tr > th.danger:hover,\n  .gm-styles .table-hover > tbody > tr.danger:hover > td,\n  .gm-styles .table-hover > tbody > tr:hover > .danger,\n  .gm-styles .table-hover > tbody > tr.danger:hover > th {\n    background-color: #ebcccc; }\n  .gm-styles .table-responsive {\n    min-height: .01%;\n    overflow-x: auto; }\n    @media screen and (max-width: 767px) {\n      .gm-styles .table-responsive {\n        width: 100%;\n        margin-bottom: 15px;\n        overflow-y: hidden;\n        -ms-overflow-style: -ms-autohiding-scrollbar;\n        border: 1px solid #ddd; }\n        .gm-styles .table-responsive > .table {\n          margin-bottom: 0; }\n          .gm-styles .table-responsive > .table > thead > tr > th,\n          .gm-styles .table-responsive > .table > thead > tr > td,\n          .gm-styles .table-responsive > .table > tbody > tr > th,\n          .gm-styles .table-responsive > .table > tbody > tr > td,\n          .gm-styles .table-responsive > .table > tfoot > tr > th,\n          .gm-styles .table-responsive > .table > tfoot > tr > td {\n            white-space: nowrap; }\n        .gm-styles .table-responsive > .table-bordered {\n          border: 0; }\n          .gm-styles .table-responsive > .table-bordered > thead > tr > th:first-child,\n          .gm-styles .table-responsive > .table-bordered > thead > tr > td:first-child,\n          .gm-styles .table-responsive > .table-bordered > tbody > tr > th:first-child,\n          .gm-styles .table-responsive > .table-bordered > tbody > tr > td:first-child,\n          .gm-styles .table-responsive > .table-bordered > tfoot > tr > th:first-child,\n          .gm-styles .table-responsive > .table-bordered > tfoot > tr > td:first-child {\n            border-left: 0; }\n          .gm-styles .table-responsive > .table-bordered > thead > tr > th:last-child,\n          .gm-styles .table-responsive > .table-bordered > thead > tr > td:last-child,\n          .gm-styles .table-responsive > .table-bordered > tbody > tr > th:last-child,\n          .gm-styles .table-responsive > .table-bordered > tbody > tr > td:last-child,\n          .gm-styles .table-responsive > .table-bordered > tfoot > tr > th:last-child,\n          .gm-styles .table-responsive > .table-bordered > tfoot > tr > td:last-child {\n            border-right: 0; }\n          .gm-styles .table-responsive > .table-bordered > tbody > tr:last-child > th,\n          .gm-styles .table-responsive > .table-bordered > tbody > tr:last-child > td,\n          .gm-styles .table-responsive > .table-bordered > tfoot > tr:last-child > th,\n          .gm-styles .table-responsive > .table-bordered > tfoot > tr:last-child > td {\n            border-bottom: 0; } }\n  .gm-styles fieldset {\n    min-width: 0;\n    padding: 0;\n    margin: 0;\n    border: 0; }\n  .gm-styles legend {\n    display: block;\n    width: 100%;\n    padding: 0;\n    margin-bottom: 20px;\n    font-size: 21px;\n    line-height: inherit;\n    color: #333333;\n    border: 0;\n    border-bottom: 1px solid #e5e5e5; }\n  .gm-styles label {\n    display: inline-block;\n    max-width: 100%;\n    margin-bottom: 5px;\n    font-weight: 700; }\n  .gm-styles input[type="search"] {\n    -webkit-box-sizing: border-box;\n    -moz-box-sizing: border-box;\n    box-sizing: border-box;\n    -webkit-appearance: none;\n    appearance: none; }\n  .gm-styles input[type="radio"],\n  .gm-styles input[type="checkbox"] {\n    margin: 4px 0 0;\n    margin-top: 1px \\9;\n    line-height: normal; }\n    .gm-styles input[type="radio"][disabled], .gm-styles input[type="radio"].disabled,\n    fieldset[disabled] .gm-styles input[type="radio"],\n    .gm-styles input[type="checkbox"][disabled],\n    .gm-styles input[type="checkbox"].disabled,\n    fieldset[disabled]\n    .gm-styles input[type="checkbox"] {\n      cursor: not-allowed; }\n  .gm-styles input[type="file"] {\n    display: block; }\n  .gm-styles input[type="range"] {\n    display: block;\n    width: 100%; }\n  .gm-styles select[multiple],\n  .gm-styles select[size] {\n    height: auto; }\n  .gm-styles input[type="file"]:focus,\n  .gm-styles input[type="radio"]:focus,\n  .gm-styles input[type="checkbox"]:focus {\n    outline: 5px auto -webkit-focus-ring-color;\n    outline-offset: -2px; }\n  .gm-styles output {\n    display: block;\n    padding-top: 7px;\n    font-size: 14px;\n    line-height: 1.42857;\n    color: #555555; }\n  .gm-styles .form-control {\n    display: block;\n    width: 100%;\n    height: 34px;\n    padding: 6px 12px;\n    font-size: 14px;\n    line-height: 1.42857;\n    color: #555555;\n    background-color: #fff;\n    background-image: none;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n    box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n    -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;\n    -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;\n    transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; }\n    .gm-styles .form-control:focus {\n      border-color: #66afe9;\n      outline: 0;\n      -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(102, 175, 233, 0.6);\n      box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(102, 175, 233, 0.6); }\n    .gm-styles .form-control::-moz-placeholder {\n      color: #999;\n      opacity: 1; }\n    .gm-styles .form-control:-ms-input-placeholder {\n      color: #999; }\n    .gm-styles .form-control::-webkit-input-placeholder {\n      color: #999; }\n    .gm-styles .form-control::-ms-expand {\n      background-color: transparent;\n      border: 0; }\n    .gm-styles .form-control[disabled], .gm-styles .form-control[readonly],\n    fieldset[disabled] .gm-styles .form-control {\n      background-color: #eeeeee;\n      opacity: 1; }\n    .gm-styles .form-control[disabled],\n    fieldset[disabled] .gm-styles .form-control {\n      cursor: not-allowed; }\n  .gm-styles textarea.form-control {\n    height: auto; }\n  @media screen and (-webkit-min-device-pixel-ratio: 0) {\n    .gm-styles input[type="date"].form-control,\n    .gm-styles input[type="time"].form-control,\n    .gm-styles input[type="datetime-local"].form-control,\n    .gm-styles input[type="month"].form-control {\n      line-height: 34px; }\n    .gm-styles input[type="date"].input-sm, .gm-styles .input-group-sm > input.form-control[type="date"],\n    .gm-styles .input-group-sm > input.input-group-addon[type="date"],\n    .gm-styles .input-group-sm > .input-group-btn > input.btn[type="date"],\n    .input-group-sm .gm-styles input[type="date"],\n    .gm-styles input[type="time"].input-sm,\n    .gm-styles .input-group-sm > input.form-control[type="time"],\n    .gm-styles .input-group-sm > input.input-group-addon[type="time"],\n    .gm-styles .input-group-sm > .input-group-btn > input.btn[type="time"],\n    .input-group-sm\n    .gm-styles input[type="time"],\n    .gm-styles input[type="datetime-local"].input-sm,\n    .gm-styles .input-group-sm > input.form-control[type="datetime-local"],\n    .gm-styles .input-group-sm > input.input-group-addon[type="datetime-local"],\n    .gm-styles .input-group-sm > .input-group-btn > input.btn[type="datetime-local"],\n    .input-group-sm\n    .gm-styles input[type="datetime-local"],\n    .gm-styles input[type="month"].input-sm,\n    .gm-styles .input-group-sm > input.form-control[type="month"],\n    .gm-styles .input-group-sm > input.input-group-addon[type="month"],\n    .gm-styles .input-group-sm > .input-group-btn > input.btn[type="month"],\n    .input-group-sm\n    .gm-styles input[type="month"] {\n      line-height: 30px; }\n    .gm-styles input[type="date"].input-lg, .gm-styles .input-group-lg > input.form-control[type="date"],\n    .gm-styles .input-group-lg > input.input-group-addon[type="date"],\n    .gm-styles .input-group-lg > .input-group-btn > input.btn[type="date"],\n    .input-group-lg .gm-styles input[type="date"],\n    .gm-styles input[type="time"].input-lg,\n    .gm-styles .input-group-lg > input.form-control[type="time"],\n    .gm-styles .input-group-lg > input.input-group-addon[type="time"],\n    .gm-styles .input-group-lg > .input-group-btn > input.btn[type="time"],\n    .input-group-lg\n    .gm-styles input[type="time"],\n    .gm-styles input[type="datetime-local"].input-lg,\n    .gm-styles .input-group-lg > input.form-control[type="datetime-local"],\n    .gm-styles .input-group-lg > input.input-group-addon[type="datetime-local"],\n    .gm-styles .input-group-lg > .input-group-btn > input.btn[type="datetime-local"],\n    .input-group-lg\n    .gm-styles input[type="datetime-local"],\n    .gm-styles input[type="month"].input-lg,\n    .gm-styles .input-group-lg > input.form-control[type="month"],\n    .gm-styles .input-group-lg > input.input-group-addon[type="month"],\n    .gm-styles .input-group-lg > .input-group-btn > input.btn[type="month"],\n    .input-group-lg\n    .gm-styles input[type="month"] {\n      line-height: 46px; } }\n  .gm-styles .form-group {\n    margin-bottom: 15px; }\n  .gm-styles .radio,\n  .gm-styles .checkbox {\n    position: relative;\n    display: block;\n    margin-top: 10px;\n    margin-bottom: 10px; }\n    .gm-styles .radio.disabled label,\n    fieldset[disabled] .gm-styles .radio label,\n    .gm-styles .checkbox.disabled label,\n    fieldset[disabled]\n    .gm-styles .checkbox label {\n      cursor: not-allowed; }\n    .gm-styles .radio label,\n    .gm-styles .checkbox label {\n      min-height: 20px;\n      padding-left: 20px;\n      margin-bottom: 0;\n      font-weight: 400;\n      cursor: pointer; }\n  .gm-styles .radio input[type="radio"],\n  .gm-styles .radio-inline input[type="radio"],\n  .gm-styles .checkbox input[type="checkbox"],\n  .gm-styles .checkbox-inline input[type="checkbox"] {\n    position: absolute;\n    margin-top: 4px \\9;\n    margin-left: -20px; }\n  .gm-styles .radio + .radio,\n  .gm-styles .checkbox + .checkbox {\n    margin-top: -5px; }\n  .gm-styles .radio-inline,\n  .gm-styles .checkbox-inline {\n    position: relative;\n    display: inline-block;\n    padding-left: 20px;\n    margin-bottom: 0;\n    font-weight: 400;\n    vertical-align: middle;\n    cursor: pointer; }\n    .gm-styles .radio-inline.disabled,\n    fieldset[disabled] .gm-styles .radio-inline,\n    .gm-styles .checkbox-inline.disabled,\n    fieldset[disabled]\n    .gm-styles .checkbox-inline {\n      cursor: not-allowed; }\n  .gm-styles .radio-inline + .radio-inline,\n  .gm-styles .checkbox-inline + .checkbox-inline {\n    margin-top: 0;\n    margin-left: 10px; }\n  .gm-styles .form-control-static {\n    min-height: 34px;\n    padding-top: 7px;\n    padding-bottom: 7px;\n    margin-bottom: 0; }\n    .gm-styles .form-control-static.input-lg, .gm-styles .input-group-lg > .form-control-static.form-control,\n    .gm-styles .input-group-lg > .form-control-static.input-group-addon,\n    .gm-styles .input-group-lg > .input-group-btn > .form-control-static.btn, .gm-styles .form-control-static.input-sm, .gm-styles .input-group-sm > .form-control-static.form-control,\n    .gm-styles .input-group-sm > .form-control-static.input-group-addon,\n    .gm-styles .input-group-sm > .input-group-btn > .form-control-static.btn {\n      padding-right: 0;\n      padding-left: 0; }\n  .gm-styles .input-sm, .gm-styles .input-group-sm > .form-control,\n  .gm-styles .input-group-sm > .input-group-addon,\n  .gm-styles .input-group-sm > .input-group-btn > .btn {\n    height: 30px;\n    padding: 5px 10px;\n    font-size: 12px;\n    line-height: 1.5;\n    border-radius: 3px; }\n  .gm-styles select.input-sm, .gm-styles .input-group-sm > select.form-control,\n  .gm-styles .input-group-sm > select.input-group-addon,\n  .gm-styles .input-group-sm > .input-group-btn > select.btn {\n    height: 30px;\n    line-height: 30px; }\n  .gm-styles textarea.input-sm, .gm-styles .input-group-sm > textarea.form-control,\n  .gm-styles .input-group-sm > textarea.input-group-addon,\n  .gm-styles .input-group-sm > .input-group-btn > textarea.btn,\n  .gm-styles select[multiple].input-sm,\n  .gm-styles .input-group-sm > select.form-control[multiple],\n  .gm-styles .input-group-sm > select.input-group-addon[multiple],\n  .gm-styles .input-group-sm > .input-group-btn > select.btn[multiple] {\n    height: auto; }\n  .gm-styles .form-group-sm .form-control {\n    height: 30px;\n    padding: 5px 10px;\n    font-size: 12px;\n    line-height: 1.5;\n    border-radius: 3px; }\n  .gm-styles .form-group-sm select.form-control {\n    height: 30px;\n    line-height: 30px; }\n  .gm-styles .form-group-sm textarea.form-control,\n  .gm-styles .form-group-sm select[multiple].form-control {\n    height: auto; }\n  .gm-styles .form-group-sm .form-control-static {\n    height: 30px;\n    min-height: 32px;\n    padding: 6px 10px;\n    font-size: 12px;\n    line-height: 1.5; }\n  .gm-styles .input-lg, .gm-styles .input-group-lg > .form-control,\n  .gm-styles .input-group-lg > .input-group-addon,\n  .gm-styles .input-group-lg > .input-group-btn > .btn {\n    height: 46px;\n    padding: 10px 16px;\n    font-size: 18px;\n    line-height: 1.33333;\n    border-radius: 6px; }\n  .gm-styles select.input-lg, .gm-styles .input-group-lg > select.form-control,\n  .gm-styles .input-group-lg > select.input-group-addon,\n  .gm-styles .input-group-lg > .input-group-btn > select.btn {\n    height: 46px;\n    line-height: 46px; }\n  .gm-styles textarea.input-lg, .gm-styles .input-group-lg > textarea.form-control,\n  .gm-styles .input-group-lg > textarea.input-group-addon,\n  .gm-styles .input-group-lg > .input-group-btn > textarea.btn,\n  .gm-styles select[multiple].input-lg,\n  .gm-styles .input-group-lg > select.form-control[multiple],\n  .gm-styles .input-group-lg > select.input-group-addon[multiple],\n  .gm-styles .input-group-lg > .input-group-btn > select.btn[multiple] {\n    height: auto; }\n  .gm-styles .form-group-lg .form-control {\n    height: 46px;\n    padding: 10px 16px;\n    font-size: 18px;\n    line-height: 1.33333;\n    border-radius: 6px; }\n  .gm-styles .form-group-lg select.form-control {\n    height: 46px;\n    line-height: 46px; }\n  .gm-styles .form-group-lg textarea.form-control,\n  .gm-styles .form-group-lg select[multiple].form-control {\n    height: auto; }\n  .gm-styles .form-group-lg .form-control-static {\n    height: 46px;\n    min-height: 38px;\n    padding: 11px 16px;\n    font-size: 18px;\n    line-height: 1.33333; }\n  .gm-styles .has-feedback {\n    position: relative; }\n    .gm-styles .has-feedback .form-control {\n      padding-right: 42.5px; }\n  .gm-styles .form-control-feedback {\n    position: absolute;\n    top: 0;\n    right: 0;\n    z-index: 2;\n    display: block;\n    width: 34px;\n    height: 34px;\n    line-height: 34px;\n    text-align: center;\n    pointer-events: none; }\n  .gm-styles .input-lg + .form-control-feedback, .gm-styles .input-group-lg > .form-control + .form-control-feedback, .gm-styles .input-group-lg > .input-group-addon + .form-control-feedback, .gm-styles .input-group-lg > .input-group-btn > .btn + .form-control-feedback,\n  .gm-styles .input-group-lg + .form-control-feedback,\n  .gm-styles .form-group-lg .form-control + .form-control-feedback {\n    width: 46px;\n    height: 46px;\n    line-height: 46px; }\n  .gm-styles .input-sm + .form-control-feedback, .gm-styles .input-group-sm > .form-control + .form-control-feedback, .gm-styles .input-group-sm > .input-group-addon + .form-control-feedback, .gm-styles .input-group-sm > .input-group-btn > .btn + .form-control-feedback,\n  .gm-styles .input-group-sm + .form-control-feedback,\n  .gm-styles .form-group-sm .form-control + .form-control-feedback {\n    width: 30px;\n    height: 30px;\n    line-height: 30px; }\n  .gm-styles .has-success .help-block,\n  .gm-styles .has-success .control-label,\n  .gm-styles .has-success .radio,\n  .gm-styles .has-success .checkbox,\n  .gm-styles .has-success .radio-inline,\n  .gm-styles .has-success .checkbox-inline,\n  .gm-styles .has-success.radio label,\n  .gm-styles .has-success.checkbox label,\n  .gm-styles .has-success.radio-inline label,\n  .gm-styles .has-success.checkbox-inline label {\n    color: #3c763d; }\n  .gm-styles .has-success .form-control {\n    border-color: #3c763d;\n    -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n    box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); }\n    .gm-styles .has-success .form-control:focus {\n      border-color: #2b542c;\n      -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;\n      box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168; }\n  .gm-styles .has-success .input-group-addon {\n    color: #3c763d;\n    background-color: #dff0d8;\n    border-color: #3c763d; }\n  .gm-styles .has-success .form-control-feedback {\n    color: #3c763d; }\n  .gm-styles .has-warning .help-block,\n  .gm-styles .has-warning .control-label,\n  .gm-styles .has-warning .radio,\n  .gm-styles .has-warning .checkbox,\n  .gm-styles .has-warning .radio-inline,\n  .gm-styles .has-warning .checkbox-inline,\n  .gm-styles .has-warning.radio label,\n  .gm-styles .has-warning.checkbox label,\n  .gm-styles .has-warning.radio-inline label,\n  .gm-styles .has-warning.checkbox-inline label {\n    color: #8a6d3b; }\n  .gm-styles .has-warning .form-control {\n    border-color: #8a6d3b;\n    -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n    box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); }\n    .gm-styles .has-warning .form-control:focus {\n      border-color: #66512c;\n      -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;\n      box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b; }\n  .gm-styles .has-warning .input-group-addon {\n    color: #8a6d3b;\n    background-color: #fcf8e3;\n    border-color: #8a6d3b; }\n  .gm-styles .has-warning .form-control-feedback {\n    color: #8a6d3b; }\n  .gm-styles .has-error .help-block,\n  .gm-styles .has-error .control-label,\n  .gm-styles .has-error .radio,\n  .gm-styles .has-error .checkbox,\n  .gm-styles .has-error .radio-inline,\n  .gm-styles .has-error .checkbox-inline,\n  .gm-styles .has-error.radio label,\n  .gm-styles .has-error.checkbox label,\n  .gm-styles .has-error.radio-inline label,\n  .gm-styles .has-error.checkbox-inline label {\n    color: #a94442; }\n  .gm-styles .has-error .form-control {\n    border-color: #a94442;\n    -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n    box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); }\n    .gm-styles .has-error .form-control:focus {\n      border-color: #843534;\n      -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;\n      box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483; }\n  .gm-styles .has-error .input-group-addon {\n    color: #a94442;\n    background-color: #f2dede;\n    border-color: #a94442; }\n  .gm-styles .has-error .form-control-feedback {\n    color: #a94442; }\n  .gm-styles .has-feedback label ~ .form-control-feedback {\n    top: 25px; }\n  .gm-styles .has-feedback label.sr-only ~ .form-control-feedback {\n    top: 0; }\n  .gm-styles .help-block {\n    display: block;\n    margin-top: 5px;\n    margin-bottom: 10px;\n    color: #737373; }\n  @media (min-width: 768px) {\n    .gm-styles .form-inline .form-group {\n      display: inline-block;\n      margin-bottom: 0;\n      vertical-align: middle; }\n    .gm-styles .form-inline .form-control {\n      display: inline-block;\n      width: auto;\n      vertical-align: middle; }\n    .gm-styles .form-inline .form-control-static {\n      display: inline-block; }\n    .gm-styles .form-inline .input-group {\n      display: inline-table;\n      vertical-align: middle; }\n      .gm-styles .form-inline .input-group .input-group-addon,\n      .gm-styles .form-inline .input-group .input-group-btn,\n      .gm-styles .form-inline .input-group .form-control {\n        width: auto; }\n    .gm-styles .form-inline .input-group > .form-control {\n      width: 100%; }\n    .gm-styles .form-inline .control-label {\n      margin-bottom: 0;\n      vertical-align: middle; }\n    .gm-styles .form-inline .radio,\n    .gm-styles .form-inline .checkbox {\n      display: inline-block;\n      margin-top: 0;\n      margin-bottom: 0;\n      vertical-align: middle; }\n      .gm-styles .form-inline .radio label,\n      .gm-styles .form-inline .checkbox label {\n        padding-left: 0; }\n    .gm-styles .form-inline .radio input[type="radio"],\n    .gm-styles .form-inline .checkbox input[type="checkbox"] {\n      position: relative;\n      margin-left: 0; }\n    .gm-styles .form-inline .has-feedback .form-control-feedback {\n      top: 0; } }\n  .gm-styles .form-horizontal .radio,\n  .gm-styles .form-horizontal .checkbox,\n  .gm-styles .form-horizontal .radio-inline,\n  .gm-styles .form-horizontal .checkbox-inline {\n    padding-top: 7px;\n    margin-top: 0;\n    margin-bottom: 0; }\n  .gm-styles .form-horizontal .radio,\n  .gm-styles .form-horizontal .checkbox {\n    min-height: 27px; }\n  .gm-styles .form-horizontal .form-group {\n    margin-right: -15px;\n    margin-left: -15px; }\n    .gm-styles .form-horizontal .form-group:before, .gm-styles .form-horizontal .form-group:after {\n      display: table;\n      content: " "; }\n    .gm-styles .form-horizontal .form-group:after {\n      clear: both; }\n  @media (min-width: 768px) {\n    .gm-styles .form-horizontal .control-label {\n      padding-top: 7px;\n      margin-bottom: 0;\n      text-align: right; } }\n  .gm-styles .form-horizontal .has-feedback .form-control-feedback {\n    right: 15px; }\n  @media (min-width: 768px) {\n    .gm-styles .form-horizontal .form-group-lg .control-label {\n      padding-top: 11px;\n      font-size: 18px; } }\n  @media (min-width: 768px) {\n    .gm-styles .form-horizontal .form-group-sm .control-label {\n      padding-top: 6px;\n      font-size: 12px; } }\n  .gm-styles .btn {\n    display: inline-block;\n    margin-bottom: 0;\n    font-weight: normal;\n    text-align: center;\n    white-space: nowrap;\n    vertical-align: middle;\n    touch-action: manipulation;\n    cursor: pointer;\n    background-image: none;\n    border: 1px solid transparent;\n    padding: 6px 12px;\n    font-size: 14px;\n    line-height: 1.42857;\n    border-radius: 4px;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none; }\n    .gm-styles .btn:focus, .gm-styles .btn.focus, .gm-styles .btn:active:focus, .gm-styles .btn:active.focus, .gm-styles .btn.active:focus, .gm-styles .btn.active.focus {\n      outline: 5px auto -webkit-focus-ring-color;\n      outline-offset: -2px; }\n    .gm-styles .btn:hover, .gm-styles .btn:focus, .gm-styles .btn.focus {\n      color: #333;\n      text-decoration: none; }\n    .gm-styles .btn:active, .gm-styles .btn.active {\n      background-image: none;\n      outline: 0;\n      -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);\n      box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125); }\n    .gm-styles .btn.disabled, .gm-styles .btn[disabled],\n    fieldset[disabled] .gm-styles .btn {\n      cursor: not-allowed;\n      filter: alpha(opacity=65);\n      opacity: 0.65;\n      -webkit-box-shadow: none;\n      box-shadow: none; }\n  .gm-styles a.btn.disabled,\n  fieldset[disabled] .gm-styles a.btn {\n    pointer-events: none; }\n  .gm-styles .btn-default {\n    color: #333;\n    background-color: #fff;\n    border-color: #ccc; }\n    .gm-styles .btn-default:focus, .gm-styles .btn-default.focus {\n      color: #333;\n      background-color: #e6e6e6;\n      border-color: #8c8c8c; }\n    .gm-styles .btn-default:hover {\n      color: #333;\n      background-color: #e6e6e6;\n      border-color: #adadad; }\n    .gm-styles .btn-default:active, .gm-styles .btn-default.active,\n    .open > .gm-styles .btn-default.dropdown-toggle {\n      color: #333;\n      background-color: #e6e6e6;\n      background-image: none;\n      border-color: #adadad; }\n      .gm-styles .btn-default:active:hover, .gm-styles .btn-default:active:focus, .gm-styles .btn-default:active.focus, .gm-styles .btn-default.active:hover, .gm-styles .btn-default.active:focus, .gm-styles .btn-default.active.focus,\n      .open > .gm-styles .btn-default.dropdown-toggle:hover,\n      .open > .gm-styles .btn-default.dropdown-toggle:focus,\n      .open > .gm-styles .btn-default.dropdown-toggle.focus {\n        color: #333;\n        background-color: #d4d4d4;\n        border-color: #8c8c8c; }\n    .gm-styles .btn-default.disabled:hover, .gm-styles .btn-default.disabled:focus, .gm-styles .btn-default.disabled.focus, .gm-styles .btn-default[disabled]:hover, .gm-styles .btn-default[disabled]:focus, .gm-styles .btn-default[disabled].focus,\n    fieldset[disabled] .gm-styles .btn-default:hover,\n    fieldset[disabled] .gm-styles .btn-default:focus,\n    fieldset[disabled] .gm-styles .btn-default.focus {\n      background-color: #fff;\n      border-color: #ccc; }\n    .gm-styles .btn-default .badge {\n      color: #fff;\n      background-color: #333; }\n  .gm-styles .btn-primary {\n    color: #fff;\n    background-color: #337ab7;\n    border-color: #2e6da4; }\n    .gm-styles .btn-primary:focus, .gm-styles .btn-primary.focus {\n      color: #fff;\n      background-color: #286090;\n      border-color: #122b40; }\n    .gm-styles .btn-primary:hover {\n      color: #fff;\n      background-color: #286090;\n      border-color: #204d74; }\n    .gm-styles .btn-primary:active, .gm-styles .btn-primary.active,\n    .open > .gm-styles .btn-primary.dropdown-toggle {\n      color: #fff;\n      background-color: #286090;\n      background-image: none;\n      border-color: #204d74; }\n      .gm-styles .btn-primary:active:hover, .gm-styles .btn-primary:active:focus, .gm-styles .btn-primary:active.focus, .gm-styles .btn-primary.active:hover, .gm-styles .btn-primary.active:focus, .gm-styles .btn-primary.active.focus,\n      .open > .gm-styles .btn-primary.dropdown-toggle:hover,\n      .open > .gm-styles .btn-primary.dropdown-toggle:focus,\n      .open > .gm-styles .btn-primary.dropdown-toggle.focus {\n        color: #fff;\n        background-color: #204d74;\n        border-color: #122b40; }\n    .gm-styles .btn-primary.disabled:hover, .gm-styles .btn-primary.disabled:focus, .gm-styles .btn-primary.disabled.focus, .gm-styles .btn-primary[disabled]:hover, .gm-styles .btn-primary[disabled]:focus, .gm-styles .btn-primary[disabled].focus,\n    fieldset[disabled] .gm-styles .btn-primary:hover,\n    fieldset[disabled] .gm-styles .btn-primary:focus,\n    fieldset[disabled] .gm-styles .btn-primary.focus {\n      background-color: #337ab7;\n      border-color: #2e6da4; }\n    .gm-styles .btn-primary .badge {\n      color: #337ab7;\n      background-color: #fff; }\n  .gm-styles .btn-success {\n    color: #fff;\n    background-color: #5cb85c;\n    border-color: #4cae4c; }\n    .gm-styles .btn-success:focus, .gm-styles .btn-success.focus {\n      color: #fff;\n      background-color: #449d44;\n      border-color: #255625; }\n    .gm-styles .btn-success:hover {\n      color: #fff;\n      background-color: #449d44;\n      border-color: #398439; }\n    .gm-styles .btn-success:active, .gm-styles .btn-success.active,\n    .open > .gm-styles .btn-success.dropdown-toggle {\n      color: #fff;\n      background-color: #449d44;\n      background-image: none;\n      border-color: #398439; }\n      .gm-styles .btn-success:active:hover, .gm-styles .btn-success:active:focus, .gm-styles .btn-success:active.focus, .gm-styles .btn-success.active:hover, .gm-styles .btn-success.active:focus, .gm-styles .btn-success.active.focus,\n      .open > .gm-styles .btn-success.dropdown-toggle:hover,\n      .open > .gm-styles .btn-success.dropdown-toggle:focus,\n      .open > .gm-styles .btn-success.dropdown-toggle.focus {\n        color: #fff;\n        background-color: #398439;\n        border-color: #255625; }\n    .gm-styles .btn-success.disabled:hover, .gm-styles .btn-success.disabled:focus, .gm-styles .btn-success.disabled.focus, .gm-styles .btn-success[disabled]:hover, .gm-styles .btn-success[disabled]:focus, .gm-styles .btn-success[disabled].focus,\n    fieldset[disabled] .gm-styles .btn-success:hover,\n    fieldset[disabled] .gm-styles .btn-success:focus,\n    fieldset[disabled] .gm-styles .btn-success.focus {\n      background-color: #5cb85c;\n      border-color: #4cae4c; }\n    .gm-styles .btn-success .badge {\n      color: #5cb85c;\n      background-color: #fff; }\n  .gm-styles .btn-info {\n    color: #fff;\n    background-color: #5bc0de;\n    border-color: #46b8da; }\n    .gm-styles .btn-info:focus, .gm-styles .btn-info.focus {\n      color: #fff;\n      background-color: #31b0d5;\n      border-color: #1b6d85; }\n    .gm-styles .btn-info:hover {\n      color: #fff;\n      background-color: #31b0d5;\n      border-color: #269abc; }\n    .gm-styles .btn-info:active, .gm-styles .btn-info.active,\n    .open > .gm-styles .btn-info.dropdown-toggle {\n      color: #fff;\n      background-color: #31b0d5;\n      background-image: none;\n      border-color: #269abc; }\n      .gm-styles .btn-info:active:hover, .gm-styles .btn-info:active:focus, .gm-styles .btn-info:active.focus, .gm-styles .btn-info.active:hover, .gm-styles .btn-info.active:focus, .gm-styles .btn-info.active.focus,\n      .open > .gm-styles .btn-info.dropdown-toggle:hover,\n      .open > .gm-styles .btn-info.dropdown-toggle:focus,\n      .open > .gm-styles .btn-info.dropdown-toggle.focus {\n        color: #fff;\n        background-color: #269abc;\n        border-color: #1b6d85; }\n    .gm-styles .btn-info.disabled:hover, .gm-styles .btn-info.disabled:focus, .gm-styles .btn-info.disabled.focus, .gm-styles .btn-info[disabled]:hover, .gm-styles .btn-info[disabled]:focus, .gm-styles .btn-info[disabled].focus,\n    fieldset[disabled] .gm-styles .btn-info:hover,\n    fieldset[disabled] .gm-styles .btn-info:focus,\n    fieldset[disabled] .gm-styles .btn-info.focus {\n      background-color: #5bc0de;\n      border-color: #46b8da; }\n    .gm-styles .btn-info .badge {\n      color: #5bc0de;\n      background-color: #fff; }\n  .gm-styles .btn-warning {\n    color: #fff;\n    background-color: #f0ad4e;\n    border-color: #eea236; }\n    .gm-styles .btn-warning:focus, .gm-styles .btn-warning.focus {\n      color: #fff;\n      background-color: #ec971f;\n      border-color: #985f0d; }\n    .gm-styles .btn-warning:hover {\n      color: #fff;\n      background-color: #ec971f;\n      border-color: #d58512; }\n    .gm-styles .btn-warning:active, .gm-styles .btn-warning.active,\n    .open > .gm-styles .btn-warning.dropdown-toggle {\n      color: #fff;\n      background-color: #ec971f;\n      background-image: none;\n      border-color: #d58512; }\n      .gm-styles .btn-warning:active:hover, .gm-styles .btn-warning:active:focus, .gm-styles .btn-warning:active.focus, .gm-styles .btn-warning.active:hover, .gm-styles .btn-warning.active:focus, .gm-styles .btn-warning.active.focus,\n      .open > .gm-styles .btn-warning.dropdown-toggle:hover,\n      .open > .gm-styles .btn-warning.dropdown-toggle:focus,\n      .open > .gm-styles .btn-warning.dropdown-toggle.focus {\n        color: #fff;\n        background-color: #d58512;\n        border-color: #985f0d; }\n    .gm-styles .btn-warning.disabled:hover, .gm-styles .btn-warning.disabled:focus, .gm-styles .btn-warning.disabled.focus, .gm-styles .btn-warning[disabled]:hover, .gm-styles .btn-warning[disabled]:focus, .gm-styles .btn-warning[disabled].focus,\n    fieldset[disabled] .gm-styles .btn-warning:hover,\n    fieldset[disabled] .gm-styles .btn-warning:focus,\n    fieldset[disabled] .gm-styles .btn-warning.focus {\n      background-color: #f0ad4e;\n      border-color: #eea236; }\n    .gm-styles .btn-warning .badge {\n      color: #f0ad4e;\n      background-color: #fff; }\n  .gm-styles .btn-danger {\n    color: #fff;\n    background-color: #d9534f;\n    border-color: #d43f3a; }\n    .gm-styles .btn-danger:focus, .gm-styles .btn-danger.focus {\n      color: #fff;\n      background-color: #c9302c;\n      border-color: #761c19; }\n    .gm-styles .btn-danger:hover {\n      color: #fff;\n      background-color: #c9302c;\n      border-color: #ac2925; }\n    .gm-styles .btn-danger:active, .gm-styles .btn-danger.active,\n    .open > .gm-styles .btn-danger.dropdown-toggle {\n      color: #fff;\n      background-color: #c9302c;\n      background-image: none;\n      border-color: #ac2925; }\n      .gm-styles .btn-danger:active:hover, .gm-styles .btn-danger:active:focus, .gm-styles .btn-danger:active.focus, .gm-styles .btn-danger.active:hover, .gm-styles .btn-danger.active:focus, .gm-styles .btn-danger.active.focus,\n      .open > .gm-styles .btn-danger.dropdown-toggle:hover,\n      .open > .gm-styles .btn-danger.dropdown-toggle:focus,\n      .open > .gm-styles .btn-danger.dropdown-toggle.focus {\n        color: #fff;\n        background-color: #ac2925;\n        border-color: #761c19; }\n    .gm-styles .btn-danger.disabled:hover, .gm-styles .btn-danger.disabled:focus, .gm-styles .btn-danger.disabled.focus, .gm-styles .btn-danger[disabled]:hover, .gm-styles .btn-danger[disabled]:focus, .gm-styles .btn-danger[disabled].focus,\n    fieldset[disabled] .gm-styles .btn-danger:hover,\n    fieldset[disabled] .gm-styles .btn-danger:focus,\n    fieldset[disabled] .gm-styles .btn-danger.focus {\n      background-color: #d9534f;\n      border-color: #d43f3a; }\n    .gm-styles .btn-danger .badge {\n      color: #d9534f;\n      background-color: #fff; }\n  .gm-styles .btn-link {\n    font-weight: 400;\n    color: #337ab7;\n    border-radius: 0; }\n    .gm-styles .btn-link, .gm-styles .btn-link:active, .gm-styles .btn-link.active, .gm-styles .btn-link[disabled],\n    fieldset[disabled] .gm-styles .btn-link {\n      background-color: transparent;\n      -webkit-box-shadow: none;\n      box-shadow: none; }\n    .gm-styles .btn-link, .gm-styles .btn-link:hover, .gm-styles .btn-link:focus, .gm-styles .btn-link:active {\n      border-color: transparent; }\n    .gm-styles .btn-link:hover, .gm-styles .btn-link:focus {\n      color: #23527c;\n      text-decoration: underline;\n      background-color: transparent; }\n    .gm-styles .btn-link[disabled]:hover, .gm-styles .btn-link[disabled]:focus,\n    fieldset[disabled] .gm-styles .btn-link:hover,\n    fieldset[disabled] .gm-styles .btn-link:focus {\n      color: #777777;\n      text-decoration: none; }\n  .gm-styles .btn-lg, .gm-styles .btn-group-lg > .btn {\n    padding: 10px 16px;\n    font-size: 18px;\n    line-height: 1.33333;\n    border-radius: 6px; }\n  .gm-styles .btn-sm, .gm-styles .btn-group-sm > .btn {\n    padding: 5px 10px;\n    font-size: 12px;\n    line-height: 1.5;\n    border-radius: 3px; }\n  .gm-styles .btn-xs, .gm-styles .btn-group-xs > .btn {\n    padding: 1px 5px;\n    font-size: 12px;\n    line-height: 1.5;\n    border-radius: 3px; }\n  .gm-styles .btn-block {\n    display: block;\n    width: 100%; }\n  .gm-styles .btn-block + .btn-block {\n    margin-top: 5px; }\n  .gm-styles input[type="submit"].btn-block,\n  .gm-styles input[type="reset"].btn-block,\n  .gm-styles input[type="button"].btn-block {\n    width: 100%; }\n  .gm-styles .fade {\n    opacity: 0;\n    -webkit-transition: opacity 0.15s linear;\n    -o-transition: opacity 0.15s linear;\n    transition: opacity 0.15s linear; }\n    .gm-styles .fade.in {\n      opacity: 1; }\n  .gm-styles .collapse {\n    display: none; }\n    .gm-styles .collapse.in {\n      display: block; }\n  .gm-styles tr.collapse.in {\n    display: table-row; }\n  .gm-styles tbody.collapse.in {\n    display: table-row-group; }\n  .gm-styles .collapsing {\n    position: relative;\n    height: 0;\n    overflow: hidden;\n    -webkit-transition-property: height, visibility;\n    transition-property: height, visibility;\n    -webkit-transition-duration: 0.35s;\n    transition-duration: 0.35s;\n    -webkit-transition-timing-function: ease;\n    transition-timing-function: ease; }\n  .gm-styles .caret {\n    display: inline-block;\n    width: 0;\n    height: 0;\n    margin-left: 2px;\n    vertical-align: middle;\n    border-top: 4px dashed;\n    border-top: 4px solid \\9;\n    border-right: 4px solid transparent;\n    border-left: 4px solid transparent; }\n  .gm-styles .dropup,\n  .gm-styles .dropdown {\n    position: relative; }\n  .gm-styles .dropdown-toggle:focus {\n    outline: 0; }\n  .gm-styles .dropdown-menu {\n    position: absolute;\n    top: 100%;\n    left: 0;\n    z-index: 1000;\n    display: none;\n    float: left;\n    min-width: 160px;\n    padding: 5px 0;\n    margin: 2px 0 0;\n    font-size: 14px;\n    text-align: left;\n    list-style: none;\n    background-color: #fff;\n    background-clip: padding-box;\n    border: 1px solid #ccc;\n    border: 1px solid rgba(0, 0, 0, 0.15);\n    border-radius: 4px;\n    -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);\n    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175); }\n    .gm-styles .dropdown-menu.pull-right {\n      right: 0;\n      left: auto; }\n    .gm-styles .dropdown-menu .divider {\n      height: 1px;\n      margin: 9px 0;\n      overflow: hidden;\n      background-color: #e5e5e5; }\n    .gm-styles .dropdown-menu > li > a {\n      display: block;\n      padding: 3px 20px;\n      clear: both;\n      font-weight: 400;\n      line-height: 1.42857;\n      color: #333333;\n      white-space: nowrap; }\n      .gm-styles .dropdown-menu > li > a:hover, .gm-styles .dropdown-menu > li > a:focus {\n        color: #262626;\n        text-decoration: none;\n        background-color: #f5f5f5; }\n  .gm-styles .dropdown-menu > .active > a, .gm-styles .dropdown-menu > .active > a:hover, .gm-styles .dropdown-menu > .active > a:focus {\n    color: #fff;\n    text-decoration: none;\n    background-color: #337ab7;\n    outline: 0; }\n  .gm-styles .dropdown-menu > .disabled > a, .gm-styles .dropdown-menu > .disabled > a:hover, .gm-styles .dropdown-menu > .disabled > a:focus {\n    color: #777777; }\n  .gm-styles .dropdown-menu > .disabled > a:hover, .gm-styles .dropdown-menu > .disabled > a:focus {\n    text-decoration: none;\n    cursor: not-allowed;\n    background-color: transparent;\n    background-image: none;\n    filter: progid:DXImageTransform.Microsoft.gradient(enabled = false); }\n  .gm-styles .open > .dropdown-menu {\n    display: block; }\n  .gm-styles .open > a {\n    outline: 0; }\n  .gm-styles .dropdown-menu-right {\n    right: 0;\n    left: auto; }\n  .gm-styles .dropdown-menu-left {\n    right: auto;\n    left: 0; }\n  .gm-styles .dropdown-header {\n    display: block;\n    padding: 3px 20px;\n    font-size: 12px;\n    line-height: 1.42857;\n    color: #777777;\n    white-space: nowrap; }\n  .gm-styles .dropdown-backdrop {\n    position: fixed;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    z-index: 990; }\n  .gm-styles .pull-right > .dropdown-menu {\n    right: 0;\n    left: auto; }\n  .gm-styles .dropup .caret,\n  .gm-styles .navbar-fixed-bottom .dropdown .caret {\n    content: "";\n    border-top: 0;\n    border-bottom: 4px dashed;\n    border-bottom: 4px solid \\9; }\n  .gm-styles .dropup .dropdown-menu,\n  .gm-styles .navbar-fixed-bottom .dropdown .dropdown-menu {\n    top: auto;\n    bottom: 100%;\n    margin-bottom: 2px; }\n  @media (min-width: 768px) {\n    .gm-styles .navbar-right .dropdown-menu {\n      right: 0;\n      left: auto; }\n    .gm-styles .navbar-right .dropdown-menu-left {\n      left: 0;\n      right: auto; } }\n  .gm-styles .btn-group,\n  .gm-styles .btn-group-vertical {\n    position: relative;\n    display: inline-block;\n    vertical-align: middle; }\n    .gm-styles .btn-group > .btn,\n    .gm-styles .btn-group-vertical > .btn {\n      position: relative;\n      float: left; }\n      .gm-styles .btn-group > .btn:hover, .gm-styles .btn-group > .btn:focus, .gm-styles .btn-group > .btn:active, .gm-styles .btn-group > .btn.active,\n      .gm-styles .btn-group-vertical > .btn:hover,\n      .gm-styles .btn-group-vertical > .btn:focus,\n      .gm-styles .btn-group-vertical > .btn:active,\n      .gm-styles .btn-group-vertical > .btn.active {\n        z-index: 2; }\n  .gm-styles .btn-group .btn + .btn,\n  .gm-styles .btn-group .btn + .btn-group,\n  .gm-styles .btn-group .btn-group + .btn,\n  .gm-styles .btn-group .btn-group + .btn-group {\n    margin-left: -1px; }\n  .gm-styles .btn-toolbar {\n    margin-left: -5px; }\n    .gm-styles .btn-toolbar:before, .gm-styles .btn-toolbar:after {\n      display: table;\n      content: " "; }\n    .gm-styles .btn-toolbar:after {\n      clear: both; }\n    .gm-styles .btn-toolbar .btn,\n    .gm-styles .btn-toolbar .btn-group,\n    .gm-styles .btn-toolbar .input-group {\n      float: left; }\n    .gm-styles .btn-toolbar > .btn,\n    .gm-styles .btn-toolbar > .btn-group,\n    .gm-styles .btn-toolbar > .input-group {\n      margin-left: 5px; }\n  .gm-styles .btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {\n    border-radius: 0; }\n  .gm-styles .btn-group > .btn:first-child {\n    margin-left: 0; }\n    .gm-styles .btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {\n      border-top-right-radius: 0;\n      border-bottom-right-radius: 0; }\n  .gm-styles .btn-group > .btn:last-child:not(:first-child),\n  .gm-styles .btn-group > .dropdown-toggle:not(:first-child) {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0; }\n  .gm-styles .btn-group > .btn-group {\n    float: left; }\n  .gm-styles .btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {\n    border-radius: 0; }\n  .gm-styles .btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,\n  .gm-styles .btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {\n    border-top-right-radius: 0;\n    border-bottom-right-radius: 0; }\n  .gm-styles .btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0; }\n  .gm-styles .btn-group .dropdown-toggle:active,\n  .gm-styles .btn-group.open .dropdown-toggle {\n    outline: 0; }\n  .gm-styles .btn-group > .btn + .dropdown-toggle {\n    padding-right: 8px;\n    padding-left: 8px; }\n  .gm-styles .btn-group > .btn-lg + .dropdown-toggle, .gm-styles .btn-group-lg.btn-group > .btn + .dropdown-toggle {\n    padding-right: 12px;\n    padding-left: 12px; }\n  .gm-styles .btn-group.open .dropdown-toggle {\n    -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);\n    box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125); }\n    .gm-styles .btn-group.open .dropdown-toggle.btn-link {\n      -webkit-box-shadow: none;\n      box-shadow: none; }\n  .gm-styles .btn .caret {\n    margin-left: 0; }\n  .gm-styles .btn-lg .caret, .gm-styles .btn-group-lg > .btn .caret {\n    border-width: 5px 5px 0;\n    border-bottom-width: 0; }\n  .gm-styles .dropup .btn-lg .caret, .gm-styles .dropup .btn-group-lg > .btn .caret {\n    border-width: 0 5px 5px; }\n  .gm-styles .btn-group-vertical > .btn,\n  .gm-styles .btn-group-vertical > .btn-group,\n  .gm-styles .btn-group-vertical > .btn-group > .btn {\n    display: block;\n    float: none;\n    width: 100%;\n    max-width: 100%; }\n  .gm-styles .btn-group-vertical > .btn-group:before, .gm-styles .btn-group-vertical > .btn-group:after {\n    display: table;\n    content: " "; }\n  .gm-styles .btn-group-vertical > .btn-group:after {\n    clear: both; }\n  .gm-styles .btn-group-vertical > .btn-group > .btn {\n    float: none; }\n  .gm-styles .btn-group-vertical > .btn + .btn,\n  .gm-styles .btn-group-vertical > .btn + .btn-group,\n  .gm-styles .btn-group-vertical > .btn-group + .btn,\n  .gm-styles .btn-group-vertical > .btn-group + .btn-group {\n    margin-top: -1px;\n    margin-left: 0; }\n  .gm-styles .btn-group-vertical > .btn:not(:first-child):not(:last-child) {\n    border-radius: 0; }\n  .gm-styles .btn-group-vertical > .btn:first-child:not(:last-child) {\n    border-top-left-radius: 4px;\n    border-top-right-radius: 4px;\n    border-bottom-right-radius: 0;\n    border-bottom-left-radius: 0; }\n  .gm-styles .btn-group-vertical > .btn:last-child:not(:first-child) {\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n    border-bottom-right-radius: 4px;\n    border-bottom-left-radius: 4px; }\n  .gm-styles .btn-group-vertical > .btn-group:not(:first-child):not(:last-child) > .btn {\n    border-radius: 0; }\n  .gm-styles .btn-group-vertical > .btn-group:first-child:not(:last-child) > .btn:last-child,\n  .gm-styles .btn-group-vertical > .btn-group:first-child:not(:last-child) > .dropdown-toggle {\n    border-bottom-right-radius: 0;\n    border-bottom-left-radius: 0; }\n  .gm-styles .btn-group-vertical > .btn-group:last-child:not(:first-child) > .btn:first-child {\n    border-top-left-radius: 0;\n    border-top-right-radius: 0; }\n  .gm-styles .btn-group-justified {\n    display: table;\n    width: 100%;\n    table-layout: fixed;\n    border-collapse: separate; }\n    .gm-styles .btn-group-justified > .btn,\n    .gm-styles .btn-group-justified > .btn-group {\n      display: table-cell;\n      float: none;\n      width: 1%; }\n    .gm-styles .btn-group-justified > .btn-group .btn {\n      width: 100%; }\n    .gm-styles .btn-group-justified > .btn-group .dropdown-menu {\n      left: auto; }\n  .gm-styles [data-toggle="buttons"] > .btn input[type="radio"],\n  .gm-styles [data-toggle="buttons"] > .btn input[type="checkbox"],\n  .gm-styles [data-toggle="buttons"] > .btn-group > .btn input[type="radio"],\n  .gm-styles [data-toggle="buttons"] > .btn-group > .btn input[type="checkbox"] {\n    position: absolute;\n    clip: rect(0, 0, 0, 0);\n    pointer-events: none; }\n  .gm-styles .input-group {\n    position: relative;\n    display: table;\n    border-collapse: separate; }\n    .gm-styles .input-group[class*="col-"] {\n      float: none;\n      padding-right: 0;\n      padding-left: 0; }\n    .gm-styles .input-group .form-control {\n      position: relative;\n      z-index: 2;\n      float: left;\n      width: 100%;\n      margin-bottom: 0; }\n      .gm-styles .input-group .form-control:focus {\n        z-index: 3; }\n  .gm-styles .input-group-addon,\n  .gm-styles .input-group-btn,\n  .gm-styles .input-group .form-control {\n    display: table-cell; }\n    .gm-styles .input-group-addon:not(:first-child):not(:last-child),\n    .gm-styles .input-group-btn:not(:first-child):not(:last-child),\n    .gm-styles .input-group .form-control:not(:first-child):not(:last-child) {\n      border-radius: 0; }\n  .gm-styles .input-group-addon,\n  .gm-styles .input-group-btn {\n    width: 1%;\n    white-space: nowrap;\n    vertical-align: middle; }\n  .gm-styles .input-group-addon {\n    padding: 6px 12px;\n    font-size: 14px;\n    font-weight: 400;\n    line-height: 1;\n    color: #555555;\n    text-align: center;\n    background-color: #eeeeee;\n    border: 1px solid #ccc;\n    border-radius: 4px; }\n    .gm-styles .input-group-addon.input-sm,\n    .gm-styles .input-group-sm > .input-group-addon,\n    .gm-styles .input-group-sm > .input-group-btn > .input-group-addon.btn {\n      padding: 5px 10px;\n      font-size: 12px;\n      border-radius: 3px; }\n    .gm-styles .input-group-addon.input-lg,\n    .gm-styles .input-group-lg > .input-group-addon,\n    .gm-styles .input-group-lg > .input-group-btn > .input-group-addon.btn {\n      padding: 10px 16px;\n      font-size: 18px;\n      border-radius: 6px; }\n    .gm-styles .input-group-addon input[type="radio"],\n    .gm-styles .input-group-addon input[type="checkbox"] {\n      margin-top: 0; }\n  .gm-styles .input-group .form-control:first-child,\n  .gm-styles .input-group-addon:first-child,\n  .gm-styles .input-group-btn:first-child > .btn,\n  .gm-styles .input-group-btn:first-child > .btn-group > .btn,\n  .gm-styles .input-group-btn:first-child > .dropdown-toggle,\n  .gm-styles .input-group-btn:last-child > .btn:not(:last-child):not(.dropdown-toggle),\n  .gm-styles .input-group-btn:last-child > .btn-group:not(:last-child) > .btn {\n    border-top-right-radius: 0;\n    border-bottom-right-radius: 0; }\n  .gm-styles .input-group-addon:first-child {\n    border-right: 0; }\n  .gm-styles .input-group .form-control:last-child,\n  .gm-styles .input-group-addon:last-child,\n  .gm-styles .input-group-btn:last-child > .btn,\n  .gm-styles .input-group-btn:last-child > .btn-group > .btn,\n  .gm-styles .input-group-btn:last-child > .dropdown-toggle,\n  .gm-styles .input-group-btn:first-child > .btn:not(:first-child),\n  .gm-styles .input-group-btn:first-child > .btn-group:not(:first-child) > .btn {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0; }\n  .gm-styles .input-group-addon:last-child {\n    border-left: 0; }\n  .gm-styles .input-group-btn {\n    position: relative;\n    font-size: 0;\n    white-space: nowrap; }\n    .gm-styles .input-group-btn > .btn {\n      position: relative; }\n      .gm-styles .input-group-btn > .btn + .btn {\n        margin-left: -1px; }\n      .gm-styles .input-group-btn > .btn:hover, .gm-styles .input-group-btn > .btn:focus, .gm-styles .input-group-btn > .btn:active {\n        z-index: 2; }\n    .gm-styles .input-group-btn:first-child > .btn,\n    .gm-styles .input-group-btn:first-child > .btn-group {\n      margin-right: -1px; }\n    .gm-styles .input-group-btn:last-child > .btn,\n    .gm-styles .input-group-btn:last-child > .btn-group {\n      z-index: 2;\n      margin-left: -1px; }\n  .gm-styles .nav {\n    padding-left: 0;\n    margin-bottom: 0;\n    list-style: none; }\n    .gm-styles .nav:before, .gm-styles .nav:after {\n      display: table;\n      content: " "; }\n    .gm-styles .nav:after {\n      clear: both; }\n    .gm-styles .nav > li {\n      position: relative;\n      display: block; }\n      .gm-styles .nav > li > a {\n        position: relative;\n        display: block;\n        padding: 10px 15px; }\n        .gm-styles .nav > li > a:hover, .gm-styles .nav > li > a:focus {\n          text-decoration: none;\n          background-color: #eeeeee; }\n      .gm-styles .nav > li.disabled > a {\n        color: #777777; }\n        .gm-styles .nav > li.disabled > a:hover, .gm-styles .nav > li.disabled > a:focus {\n          color: #777777;\n          text-decoration: none;\n          cursor: not-allowed;\n          background-color: transparent; }\n    .gm-styles .nav .open > a, .gm-styles .nav .open > a:hover, .gm-styles .nav .open > a:focus {\n      background-color: #eeeeee;\n      border-color: #337ab7; }\n    .gm-styles .nav .nav-divider {\n      height: 1px;\n      margin: 9px 0;\n      overflow: hidden;\n      background-color: #e5e5e5; }\n    .gm-styles .nav > li > a > img {\n      max-width: none; }\n  .gm-styles .nav-tabs {\n    border-bottom: 1px solid #ddd; }\n    .gm-styles .nav-tabs > li {\n      float: left;\n      margin-bottom: -1px; }\n      .gm-styles .nav-tabs > li > a {\n        margin-right: 2px;\n        line-height: 1.42857;\n        border: 1px solid transparent;\n        border-radius: 4px 4px 0 0; }\n        .gm-styles .nav-tabs > li > a:hover {\n          border-color: #eeeeee #eeeeee #ddd; }\n      .gm-styles .nav-tabs > li.active > a, .gm-styles .nav-tabs > li.active > a:hover, .gm-styles .nav-tabs > li.active > a:focus {\n        color: #555555;\n        cursor: default;\n        background-color: #fff;\n        border: 1px solid #ddd;\n        border-bottom-color: transparent; }\n  .gm-styles .nav-pills > li {\n    float: left; }\n    .gm-styles .nav-pills > li > a {\n      border-radius: 4px; }\n    .gm-styles .nav-pills > li + li {\n      margin-left: 2px; }\n    .gm-styles .nav-pills > li.active > a, .gm-styles .nav-pills > li.active > a:hover, .gm-styles .nav-pills > li.active > a:focus {\n      color: #fff;\n      background-color: #337ab7; }\n  .gm-styles .nav-stacked > li {\n    float: none; }\n    .gm-styles .nav-stacked > li + li {\n      margin-top: 2px;\n      margin-left: 0; }\n  .gm-styles .nav-justified, .gm-styles .nav-tabs.nav-justified {\n    width: 100%; }\n    .gm-styles .nav-justified > li, .gm-styles .nav-tabs.nav-justified > li {\n      float: none; }\n      .gm-styles .nav-justified > li > a, .gm-styles .nav-tabs.nav-justified > li > a {\n        margin-bottom: 5px;\n        text-align: center; }\n    .gm-styles .nav-justified > .dropdown .dropdown-menu {\n      top: auto;\n      left: auto; }\n    @media (min-width: 768px) {\n      .gm-styles .nav-justified > li, .gm-styles .nav-tabs.nav-justified > li {\n        display: table-cell;\n        width: 1%; }\n        .gm-styles .nav-justified > li > a, .gm-styles .nav-tabs.nav-justified > li > a {\n          margin-bottom: 0; } }\n  .gm-styles .nav-tabs-justified, .gm-styles .nav-tabs.nav-justified {\n    border-bottom: 0; }\n    .gm-styles .nav-tabs-justified > li > a, .gm-styles .nav-tabs.nav-justified > li > a {\n      margin-right: 0;\n      border-radius: 4px; }\n    .gm-styles .nav-tabs-justified > .active > a, .gm-styles .nav-tabs.nav-justified > .active > a,\n    .gm-styles .nav-tabs-justified > .active > a:hover,\n    .gm-styles .nav-tabs.nav-justified > .active > a:hover,\n    .gm-styles .nav-tabs-justified > .active > a:focus,\n    .gm-styles .nav-tabs.nav-justified > .active > a:focus {\n      border: 1px solid #ddd; }\n    @media (min-width: 768px) {\n      .gm-styles .nav-tabs-justified > li > a, .gm-styles .nav-tabs.nav-justified > li > a {\n        border-bottom: 1px solid #ddd;\n        border-radius: 4px 4px 0 0; }\n      .gm-styles .nav-tabs-justified > .active > a, .gm-styles .nav-tabs.nav-justified > .active > a,\n      .gm-styles .nav-tabs-justified > .active > a:hover,\n      .gm-styles .nav-tabs.nav-justified > .active > a:hover,\n      .gm-styles .nav-tabs-justified > .active > a:focus,\n      .gm-styles .nav-tabs.nav-justified > .active > a:focus {\n        border-bottom-color: #fff; } }\n  .gm-styles .tab-content > .tab-pane {\n    display: none; }\n  .gm-styles .tab-content > .active {\n    display: block; }\n  .gm-styles .nav-tabs .dropdown-menu {\n    margin-top: -1px;\n    border-top-left-radius: 0;\n    border-top-right-radius: 0; }\n  .gm-styles .navbar {\n    position: relative;\n    min-height: 50px;\n    margin-bottom: 20px;\n    border: 1px solid transparent; }\n    .gm-styles .navbar:before, .gm-styles .navbar:after {\n      display: table;\n      content: " "; }\n    .gm-styles .navbar:after {\n      clear: both; }\n    @media (min-width: 768px) {\n      .gm-styles .navbar {\n        border-radius: 4px; } }\n  .gm-styles .navbar-header:before, .gm-styles .navbar-header:after {\n    display: table;\n    content: " "; }\n  .gm-styles .navbar-header:after {\n    clear: both; }\n  @media (min-width: 768px) {\n    .gm-styles .navbar-header {\n      float: left; } }\n  .gm-styles .navbar-collapse {\n    padding-right: 15px;\n    padding-left: 15px;\n    overflow-x: visible;\n    border-top: 1px solid transparent;\n    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);\n    -webkit-overflow-scrolling: touch; }\n    .gm-styles .navbar-collapse:before, .gm-styles .navbar-collapse:after {\n      display: table;\n      content: " "; }\n    .gm-styles .navbar-collapse:after {\n      clear: both; }\n    .gm-styles .navbar-collapse.in {\n      overflow-y: auto; }\n    @media (min-width: 768px) {\n      .gm-styles .navbar-collapse {\n        width: auto;\n        border-top: 0;\n        box-shadow: none; }\n        .gm-styles .navbar-collapse.collapse {\n          display: block !important;\n          height: auto !important;\n          padding-bottom: 0;\n          overflow: visible !important; }\n        .gm-styles .navbar-collapse.in {\n          overflow-y: visible; }\n        .navbar-fixed-top .gm-styles .navbar-collapse,\n        .navbar-static-top .gm-styles .navbar-collapse,\n        .navbar-fixed-bottom .gm-styles .navbar-collapse {\n          padding-right: 0;\n          padding-left: 0; } }\n  .gm-styles .navbar-fixed-top,\n  .gm-styles .navbar-fixed-bottom {\n    position: fixed;\n    right: 0;\n    left: 0;\n    z-index: 1030; }\n    .gm-styles .navbar-fixed-top .navbar-collapse,\n    .gm-styles .navbar-fixed-bottom .navbar-collapse {\n      max-height: 340px; }\n      @media (max-device-width: 480px) and (orientation: landscape) {\n        .gm-styles .navbar-fixed-top .navbar-collapse,\n        .gm-styles .navbar-fixed-bottom .navbar-collapse {\n          max-height: 200px; } }\n    @media (min-width: 768px) {\n      .gm-styles .navbar-fixed-top,\n      .gm-styles .navbar-fixed-bottom {\n        border-radius: 0; } }\n  .gm-styles .navbar-fixed-top {\n    top: 0;\n    border-width: 0 0 1px; }\n  .gm-styles .navbar-fixed-bottom {\n    bottom: 0;\n    margin-bottom: 0;\n    border-width: 1px 0 0; }\n  .gm-styles .container > .navbar-header,\n  .gm-styles .container > .navbar-collapse,\n  .gm-styles .container-fluid > .navbar-header,\n  .gm-styles .container-fluid > .navbar-collapse {\n    margin-right: -15px;\n    margin-left: -15px; }\n    @media (min-width: 768px) {\n      .gm-styles .container > .navbar-header,\n      .gm-styles .container > .navbar-collapse,\n      .gm-styles .container-fluid > .navbar-header,\n      .gm-styles .container-fluid > .navbar-collapse {\n        margin-right: 0;\n        margin-left: 0; } }\n  .gm-styles .navbar-static-top {\n    z-index: 1000;\n    border-width: 0 0 1px; }\n    @media (min-width: 768px) {\n      .gm-styles .navbar-static-top {\n        border-radius: 0; } }\n  .gm-styles .navbar-brand {\n    float: left;\n    height: 50px;\n    padding: 15px 15px;\n    font-size: 18px;\n    line-height: 20px; }\n    .gm-styles .navbar-brand:hover, .gm-styles .navbar-brand:focus {\n      text-decoration: none; }\n    .gm-styles .navbar-brand > img {\n      display: block; }\n    @media (min-width: 768px) {\n      .navbar > .container .gm-styles .navbar-brand,\n      .navbar > .container-fluid .gm-styles .navbar-brand {\n        margin-left: -15px; } }\n  .gm-styles .navbar-toggle {\n    position: relative;\n    float: right;\n    padding: 9px 10px;\n    margin-right: 15px;\n    margin-top: 8px;\n    margin-bottom: 8px;\n    background-color: transparent;\n    background-image: none;\n    border: 1px solid transparent;\n    border-radius: 4px; }\n    .gm-styles .navbar-toggle:focus {\n      outline: 0; }\n    .gm-styles .navbar-toggle .icon-bar {\n      display: block;\n      width: 22px;\n      height: 2px;\n      border-radius: 1px; }\n    .gm-styles .navbar-toggle .icon-bar + .icon-bar {\n      margin-top: 4px; }\n    @media (min-width: 768px) {\n      .gm-styles .navbar-toggle {\n        display: none; } }\n  .gm-styles .navbar-nav {\n    margin: 7.5px -15px; }\n    .gm-styles .navbar-nav > li > a {\n      padding-top: 10px;\n      padding-bottom: 10px;\n      line-height: 20px; }\n    @media (max-width: 767px) {\n      .gm-styles .navbar-nav .open .dropdown-menu {\n        position: static;\n        float: none;\n        width: auto;\n        margin-top: 0;\n        background-color: transparent;\n        border: 0;\n        box-shadow: none; }\n        .gm-styles .navbar-nav .open .dropdown-menu > li > a,\n        .gm-styles .navbar-nav .open .dropdown-menu .dropdown-header {\n          padding: 5px 15px 5px 25px; }\n        .gm-styles .navbar-nav .open .dropdown-menu > li > a {\n          line-height: 20px; }\n          .gm-styles .navbar-nav .open .dropdown-menu > li > a:hover, .gm-styles .navbar-nav .open .dropdown-menu > li > a:focus {\n            background-image: none; } }\n    @media (min-width: 768px) {\n      .gm-styles .navbar-nav {\n        float: left;\n        margin: 0; }\n        .gm-styles .navbar-nav > li {\n          float: left; }\n          .gm-styles .navbar-nav > li > a {\n            padding-top: 15px;\n            padding-bottom: 15px; } }\n  .gm-styles .navbar-form {\n    padding: 10px 15px;\n    margin-right: -15px;\n    margin-left: -15px;\n    border-top: 1px solid transparent;\n    border-bottom: 1px solid transparent;\n    -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);\n    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);\n    margin-top: 8px;\n    margin-bottom: 8px; }\n    @media (min-width: 768px) {\n      .gm-styles .navbar-form .form-group {\n        display: inline-block;\n        margin-bottom: 0;\n        vertical-align: middle; }\n      .gm-styles .navbar-form .form-control {\n        display: inline-block;\n        width: auto;\n        vertical-align: middle; }\n      .gm-styles .navbar-form .form-control-static {\n        display: inline-block; }\n      .gm-styles .navbar-form .input-group {\n        display: inline-table;\n        vertical-align: middle; }\n        .gm-styles .navbar-form .input-group .input-group-addon,\n        .gm-styles .navbar-form .input-group .input-group-btn,\n        .gm-styles .navbar-form .input-group .form-control {\n          width: auto; }\n      .gm-styles .navbar-form .input-group > .form-control {\n        width: 100%; }\n      .gm-styles .navbar-form .control-label {\n        margin-bottom: 0;\n        vertical-align: middle; }\n      .gm-styles .navbar-form .radio,\n      .gm-styles .navbar-form .checkbox {\n        display: inline-block;\n        margin-top: 0;\n        margin-bottom: 0;\n        vertical-align: middle; }\n        .gm-styles .navbar-form .radio label,\n        .gm-styles .navbar-form .checkbox label {\n          padding-left: 0; }\n      .gm-styles .navbar-form .radio input[type="radio"],\n      .gm-styles .navbar-form .checkbox input[type="checkbox"] {\n        position: relative;\n        margin-left: 0; }\n      .gm-styles .navbar-form .has-feedback .form-control-feedback {\n        top: 0; } }\n    @media (max-width: 767px) {\n      .gm-styles .navbar-form .form-group {\n        margin-bottom: 5px; }\n        .gm-styles .navbar-form .form-group:last-child {\n          margin-bottom: 0; } }\n    @media (min-width: 768px) {\n      .gm-styles .navbar-form {\n        width: auto;\n        padding-top: 0;\n        padding-bottom: 0;\n        margin-right: 0;\n        margin-left: 0;\n        border: 0;\n        -webkit-box-shadow: none;\n        box-shadow: none; } }\n  .gm-styles .navbar-nav > li > .dropdown-menu {\n    margin-top: 0;\n    border-top-left-radius: 0;\n    border-top-right-radius: 0; }\n  .gm-styles .navbar-fixed-bottom .navbar-nav > li > .dropdown-menu {\n    margin-bottom: 0;\n    border-top-left-radius: 4px;\n    border-top-right-radius: 4px;\n    border-bottom-right-radius: 0;\n    border-bottom-left-radius: 0; }\n  .gm-styles .navbar-btn {\n    margin-top: 8px;\n    margin-bottom: 8px; }\n    .gm-styles .navbar-btn.btn-sm, .gm-styles .btn-group-sm > .navbar-btn.btn {\n      margin-top: 10px;\n      margin-bottom: 10px; }\n    .gm-styles .navbar-btn.btn-xs, .gm-styles .btn-group-xs > .navbar-btn.btn {\n      margin-top: 14px;\n      margin-bottom: 14px; }\n  .gm-styles .navbar-text {\n    margin-top: 15px;\n    margin-bottom: 15px; }\n    @media (min-width: 768px) {\n      .gm-styles .navbar-text {\n        float: left;\n        margin-right: 15px;\n        margin-left: 15px; } }\n  @media (min-width: 768px) {\n    .gm-styles .navbar-left {\n      float: left !important; }\n    .gm-styles .navbar-right {\n      float: right !important;\n      margin-right: -15px; }\n      .gm-styles .navbar-right ~ .navbar-right {\n        margin-right: 0; } }\n  .gm-styles .navbar-default {\n    background-color: #f8f8f8;\n    border-color: #e7e7e7; }\n    .gm-styles .navbar-default .navbar-brand {\n      color: #777; }\n      .gm-styles .navbar-default .navbar-brand:hover, .gm-styles .navbar-default .navbar-brand:focus {\n        color: #5e5e5e;\n        background-color: transparent; }\n    .gm-styles .navbar-default .navbar-text {\n      color: #777; }\n    .gm-styles .navbar-default .navbar-nav > li > a {\n      color: #777; }\n      .gm-styles .navbar-default .navbar-nav > li > a:hover, .gm-styles .navbar-default .navbar-nav > li > a:focus {\n        color: #333;\n        background-color: transparent; }\n    .gm-styles .navbar-default .navbar-nav > .active > a, .gm-styles .navbar-default .navbar-nav > .active > a:hover, .gm-styles .navbar-default .navbar-nav > .active > a:focus {\n      color: #555;\n      background-color: #e7e7e7; }\n    .gm-styles .navbar-default .navbar-nav > .disabled > a, .gm-styles .navbar-default .navbar-nav > .disabled > a:hover, .gm-styles .navbar-default .navbar-nav > .disabled > a:focus {\n      color: #ccc;\n      background-color: transparent; }\n    .gm-styles .navbar-default .navbar-nav > .open > a, .gm-styles .navbar-default .navbar-nav > .open > a:hover, .gm-styles .navbar-default .navbar-nav > .open > a:focus {\n      color: #555;\n      background-color: #e7e7e7; }\n    @media (max-width: 767px) {\n      .gm-styles .navbar-default .navbar-nav .open .dropdown-menu > li > a {\n        color: #777; }\n        .gm-styles .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover, .gm-styles .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {\n          color: #333;\n          background-color: transparent; }\n      .gm-styles .navbar-default .navbar-nav .open .dropdown-menu > .active > a, .gm-styles .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover, .gm-styles .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {\n        color: #555;\n        background-color: #e7e7e7; }\n      .gm-styles .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a, .gm-styles .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover, .gm-styles .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus {\n        color: #ccc;\n        background-color: transparent; } }\n    .gm-styles .navbar-default .navbar-toggle {\n      border-color: #ddd; }\n      .gm-styles .navbar-default .navbar-toggle:hover, .gm-styles .navbar-default .navbar-toggle:focus {\n        background-color: #ddd; }\n      .gm-styles .navbar-default .navbar-toggle .icon-bar {\n        background-color: #888; }\n    .gm-styles .navbar-default .navbar-collapse,\n    .gm-styles .navbar-default .navbar-form {\n      border-color: #e7e7e7; }\n    .gm-styles .navbar-default .navbar-link {\n      color: #777; }\n      .gm-styles .navbar-default .navbar-link:hover {\n        color: #333; }\n    .gm-styles .navbar-default .btn-link {\n      color: #777; }\n      .gm-styles .navbar-default .btn-link:hover, .gm-styles .navbar-default .btn-link:focus {\n        color: #333; }\n      .gm-styles .navbar-default .btn-link[disabled]:hover, .gm-styles .navbar-default .btn-link[disabled]:focus,\n      fieldset[disabled] .gm-styles .navbar-default .btn-link:hover,\n      fieldset[disabled] .gm-styles .navbar-default .btn-link:focus {\n        color: #ccc; }\n  .gm-styles .navbar-inverse {\n    background-color: #222;\n    border-color: #090909; }\n    .gm-styles .navbar-inverse .navbar-brand {\n      color: #9d9d9d; }\n      .gm-styles .navbar-inverse .navbar-brand:hover, .gm-styles .navbar-inverse .navbar-brand:focus {\n        color: #fff;\n        background-color: transparent; }\n    .gm-styles .navbar-inverse .navbar-text {\n      color: #9d9d9d; }\n    .gm-styles .navbar-inverse .navbar-nav > li > a {\n      color: #9d9d9d; }\n      .gm-styles .navbar-inverse .navbar-nav > li > a:hover, .gm-styles .navbar-inverse .navbar-nav > li > a:focus {\n        color: #fff;\n        background-color: transparent; }\n    .gm-styles .navbar-inverse .navbar-nav > .active > a, .gm-styles .navbar-inverse .navbar-nav > .active > a:hover, .gm-styles .navbar-inverse .navbar-nav > .active > a:focus {\n      color: #fff;\n      background-color: #090909; }\n    .gm-styles .navbar-inverse .navbar-nav > .disabled > a, .gm-styles .navbar-inverse .navbar-nav > .disabled > a:hover, .gm-styles .navbar-inverse .navbar-nav > .disabled > a:focus {\n      color: #444;\n      background-color: transparent; }\n    .gm-styles .navbar-inverse .navbar-nav > .open > a, .gm-styles .navbar-inverse .navbar-nav > .open > a:hover, .gm-styles .navbar-inverse .navbar-nav > .open > a:focus {\n      color: #fff;\n      background-color: #090909; }\n    @media (max-width: 767px) {\n      .gm-styles .navbar-inverse .navbar-nav .open .dropdown-menu > .dropdown-header {\n        border-color: #090909; }\n      .gm-styles .navbar-inverse .navbar-nav .open .dropdown-menu .divider {\n        background-color: #090909; }\n      .gm-styles .navbar-inverse .navbar-nav .open .dropdown-menu > li > a {\n        color: #9d9d9d; }\n        .gm-styles .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:hover, .gm-styles .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:focus {\n          color: #fff;\n          background-color: transparent; }\n      .gm-styles .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a, .gm-styles .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:hover, .gm-styles .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:focus {\n        color: #fff;\n        background-color: #090909; }\n      .gm-styles .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a, .gm-styles .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:hover, .gm-styles .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:focus {\n        color: #444;\n        background-color: transparent; } }\n    .gm-styles .navbar-inverse .navbar-toggle {\n      border-color: #333; }\n      .gm-styles .navbar-inverse .navbar-toggle:hover, .gm-styles .navbar-inverse .navbar-toggle:focus {\n        background-color: #333; }\n      .gm-styles .navbar-inverse .navbar-toggle .icon-bar {\n        background-color: #fff; }\n    .gm-styles .navbar-inverse .navbar-collapse,\n    .gm-styles .navbar-inverse .navbar-form {\n      border-color: #101010; }\n    .gm-styles .navbar-inverse .navbar-link {\n      color: #9d9d9d; }\n      .gm-styles .navbar-inverse .navbar-link:hover {\n        color: #fff; }\n    .gm-styles .navbar-inverse .btn-link {\n      color: #9d9d9d; }\n      .gm-styles .navbar-inverse .btn-link:hover, .gm-styles .navbar-inverse .btn-link:focus {\n        color: #fff; }\n      .gm-styles .navbar-inverse .btn-link[disabled]:hover, .gm-styles .navbar-inverse .btn-link[disabled]:focus,\n      fieldset[disabled] .gm-styles .navbar-inverse .btn-link:hover,\n      fieldset[disabled] .gm-styles .navbar-inverse .btn-link:focus {\n        color: #444; }\n  .gm-styles .breadcrumb {\n    padding: 8px 15px;\n    margin-bottom: 20px;\n    list-style: none;\n    background-color: #f5f5f5;\n    border-radius: 4px; }\n    .gm-styles .breadcrumb > li {\n      display: inline-block; }\n      .gm-styles .breadcrumb > li + li:before {\n        padding: 0 5px;\n        color: #ccc;\n        content: "/\\A0"; }\n    .gm-styles .breadcrumb > .active {\n      color: #777777; }\n  .gm-styles .pagination {\n    display: inline-block;\n    padding-left: 0;\n    margin: 20px 0;\n    border-radius: 4px; }\n    .gm-styles .pagination > li {\n      display: inline; }\n      .gm-styles .pagination > li > a,\n      .gm-styles .pagination > li > span {\n        position: relative;\n        float: left;\n        padding: 6px 12px;\n        margin-left: -1px;\n        line-height: 1.42857;\n        color: #337ab7;\n        text-decoration: none;\n        background-color: #fff;\n        border: 1px solid #ddd; }\n        .gm-styles .pagination > li > a:hover, .gm-styles .pagination > li > a:focus,\n        .gm-styles .pagination > li > span:hover,\n        .gm-styles .pagination > li > span:focus {\n          z-index: 2;\n          color: #23527c;\n          background-color: #eeeeee;\n          border-color: #ddd; }\n      .gm-styles .pagination > li:first-child > a,\n      .gm-styles .pagination > li:first-child > span {\n        margin-left: 0;\n        border-top-left-radius: 4px;\n        border-bottom-left-radius: 4px; }\n      .gm-styles .pagination > li:last-child > a,\n      .gm-styles .pagination > li:last-child > span {\n        border-top-right-radius: 4px;\n        border-bottom-right-radius: 4px; }\n    .gm-styles .pagination > .active > a, .gm-styles .pagination > .active > a:hover, .gm-styles .pagination > .active > a:focus,\n    .gm-styles .pagination > .active > span,\n    .gm-styles .pagination > .active > span:hover,\n    .gm-styles .pagination > .active > span:focus {\n      z-index: 3;\n      color: #fff;\n      cursor: default;\n      background-color: #337ab7;\n      border-color: #337ab7; }\n    .gm-styles .pagination > .disabled > span,\n    .gm-styles .pagination > .disabled > span:hover,\n    .gm-styles .pagination > .disabled > span:focus,\n    .gm-styles .pagination > .disabled > a,\n    .gm-styles .pagination > .disabled > a:hover,\n    .gm-styles .pagination > .disabled > a:focus {\n      color: #777777;\n      cursor: not-allowed;\n      background-color: #fff;\n      border-color: #ddd; }\n  .gm-styles .pagination-lg > li > a,\n  .gm-styles .pagination-lg > li > span {\n    padding: 10px 16px;\n    font-size: 18px;\n    line-height: 1.33333; }\n  .gm-styles .pagination-lg > li:first-child > a,\n  .gm-styles .pagination-lg > li:first-child > span {\n    border-top-left-radius: 6px;\n    border-bottom-left-radius: 6px; }\n  .gm-styles .pagination-lg > li:last-child > a,\n  .gm-styles .pagination-lg > li:last-child > span {\n    border-top-right-radius: 6px;\n    border-bottom-right-radius: 6px; }\n  .gm-styles .pagination-sm > li > a,\n  .gm-styles .pagination-sm > li > span {\n    padding: 5px 10px;\n    font-size: 12px;\n    line-height: 1.5; }\n  .gm-styles .pagination-sm > li:first-child > a,\n  .gm-styles .pagination-sm > li:first-child > span {\n    border-top-left-radius: 3px;\n    border-bottom-left-radius: 3px; }\n  .gm-styles .pagination-sm > li:last-child > a,\n  .gm-styles .pagination-sm > li:last-child > span {\n    border-top-right-radius: 3px;\n    border-bottom-right-radius: 3px; }\n  .gm-styles .pager {\n    padding-left: 0;\n    margin: 20px 0;\n    text-align: center;\n    list-style: none; }\n    .gm-styles .pager:before, .gm-styles .pager:after {\n      display: table;\n      content: " "; }\n    .gm-styles .pager:after {\n      clear: both; }\n    .gm-styles .pager li {\n      display: inline; }\n      .gm-styles .pager li > a,\n      .gm-styles .pager li > span {\n        display: inline-block;\n        padding: 5px 14px;\n        background-color: #fff;\n        border: 1px solid #ddd;\n        border-radius: 15px; }\n      .gm-styles .pager li > a:hover,\n      .gm-styles .pager li > a:focus {\n        text-decoration: none;\n        background-color: #eeeeee; }\n    .gm-styles .pager .next > a,\n    .gm-styles .pager .next > span {\n      float: right; }\n    .gm-styles .pager .previous > a,\n    .gm-styles .pager .previous > span {\n      float: left; }\n    .gm-styles .pager .disabled > a,\n    .gm-styles .pager .disabled > a:hover,\n    .gm-styles .pager .disabled > a:focus,\n    .gm-styles .pager .disabled > span {\n      color: #777777;\n      cursor: not-allowed;\n      background-color: #fff; }\n  .gm-styles .label {\n    display: inline;\n    padding: .2em .6em .3em;\n    font-size: 75%;\n    font-weight: 700;\n    line-height: 1;\n    color: #fff;\n    text-align: center;\n    white-space: nowrap;\n    vertical-align: baseline;\n    border-radius: .25em; }\n    .gm-styles .label:empty {\n      display: none; }\n    .btn .gm-styles .label {\n      position: relative;\n      top: -1px; }\n  .gm-styles a.label:hover, .gm-styles a.label:focus {\n    color: #fff;\n    text-decoration: none;\n    cursor: pointer; }\n  .gm-styles .label-default {\n    background-color: #777777; }\n    .gm-styles .label-default[href]:hover, .gm-styles .label-default[href]:focus {\n      background-color: #5e5e5e; }\n  .gm-styles .label-primary {\n    background-color: #337ab7; }\n    .gm-styles .label-primary[href]:hover, .gm-styles .label-primary[href]:focus {\n      background-color: #286090; }\n  .gm-styles .label-success {\n    background-color: #5cb85c; }\n    .gm-styles .label-success[href]:hover, .gm-styles .label-success[href]:focus {\n      background-color: #449d44; }\n  .gm-styles .label-info {\n    background-color: #5bc0de; }\n    .gm-styles .label-info[href]:hover, .gm-styles .label-info[href]:focus {\n      background-color: #31b0d5; }\n  .gm-styles .label-warning {\n    background-color: #f0ad4e; }\n    .gm-styles .label-warning[href]:hover, .gm-styles .label-warning[href]:focus {\n      background-color: #ec971f; }\n  .gm-styles .label-danger {\n    background-color: #d9534f; }\n    .gm-styles .label-danger[href]:hover, .gm-styles .label-danger[href]:focus {\n      background-color: #c9302c; }\n  .gm-styles .badge {\n    display: inline-block;\n    min-width: 10px;\n    padding: 3px 7px;\n    font-size: 12px;\n    font-weight: bold;\n    line-height: 1;\n    color: #fff;\n    text-align: center;\n    white-space: nowrap;\n    vertical-align: middle;\n    background-color: #777777;\n    border-radius: 10px; }\n    .gm-styles .badge:empty {\n      display: none; }\n    .btn .gm-styles .badge {\n      position: relative;\n      top: -1px; }\n    .btn-xs .gm-styles .badge, .gm-styles .btn-group-xs > .btn .gm-styles .badge,\n    .btn-group-xs > .btn .gm-styles .badge {\n      top: 0;\n      padding: 1px 5px; }\n    .list-group-item.active > .gm-styles .badge,\n    .nav-pills > .active > a > .gm-styles .badge {\n      color: #337ab7;\n      background-color: #fff; }\n    .list-group-item > .gm-styles .badge {\n      float: right; }\n    .list-group-item > .gm-styles .badge + .gm-styles .badge {\n      margin-right: 5px; }\n    .nav-pills > li > a > .gm-styles .badge {\n      margin-left: 3px; }\n  .gm-styles a.badge:hover, .gm-styles a.badge:focus {\n    color: #fff;\n    text-decoration: none;\n    cursor: pointer; }\n  .gm-styles .jumbotron {\n    padding-top: 30px;\n    padding-bottom: 30px;\n    margin-bottom: 30px;\n    color: inherit;\n    background-color: #eeeeee; }\n    .gm-styles .jumbotron h1,\n    .gm-styles .jumbotron .h1 {\n      color: inherit; }\n    .gm-styles .jumbotron p {\n      margin-bottom: 15px;\n      font-size: 21px;\n      font-weight: 200; }\n    .gm-styles .jumbotron > hr {\n      border-top-color: #d5d5d5; }\n    .container .gm-styles .jumbotron,\n    .container-fluid .gm-styles .jumbotron {\n      padding-right: 15px;\n      padding-left: 15px;\n      border-radius: 6px; }\n    .gm-styles .jumbotron .container {\n      max-width: 100%; }\n    @media screen and (min-width: 768px) {\n      .gm-styles .jumbotron {\n        padding-top: 48px;\n        padding-bottom: 48px; }\n        .container .gm-styles .jumbotron,\n        .container-fluid .gm-styles .jumbotron {\n          padding-right: 60px;\n          padding-left: 60px; }\n        .gm-styles .jumbotron h1,\n        .gm-styles .jumbotron .h1 {\n          font-size: 63px; } }\n  .gm-styles .thumbnail {\n    display: block;\n    padding: 4px;\n    margin-bottom: 20px;\n    line-height: 1.42857;\n    background-color: #fff;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    -webkit-transition: border 0.2s ease-in-out;\n    -o-transition: border 0.2s ease-in-out;\n    transition: border 0.2s ease-in-out; }\n    .gm-styles .thumbnail > img,\n    .gm-styles .thumbnail a > img {\n      display: block;\n      max-width: 100%;\n      height: auto;\n      margin-right: auto;\n      margin-left: auto; }\n    .gm-styles .thumbnail .caption {\n      padding: 9px;\n      color: #333333; }\n  .gm-styles a.thumbnail:hover,\n  .gm-styles a.thumbnail:focus,\n  .gm-styles a.thumbnail.active {\n    border-color: #337ab7; }\n  .gm-styles .alert {\n    padding: 15px;\n    margin-bottom: 20px;\n    border: 1px solid transparent;\n    border-radius: 4px; }\n    .gm-styles .alert h4 {\n      margin-top: 0;\n      color: inherit; }\n    .gm-styles .alert .alert-link {\n      font-weight: bold; }\n    .gm-styles .alert > p,\n    .gm-styles .alert > ul {\n      margin-bottom: 0; }\n    .gm-styles .alert > p + p {\n      margin-top: 5px; }\n  .gm-styles .alert-dismissable,\n  .gm-styles .alert-dismissible {\n    padding-right: 35px; }\n    .gm-styles .alert-dismissable .close,\n    .gm-styles .alert-dismissible .close {\n      position: relative;\n      top: -2px;\n      right: -21px;\n      color: inherit; }\n  .gm-styles .alert-success {\n    color: #3c763d;\n    background-color: #dff0d8;\n    border-color: #d6e9c6; }\n    .gm-styles .alert-success hr {\n      border-top-color: #c9e2b3; }\n    .gm-styles .alert-success .alert-link {\n      color: #2b542c; }\n  .gm-styles .alert-info {\n    color: #31708f;\n    background-color: #d9edf7;\n    border-color: #bce8f1; }\n    .gm-styles .alert-info hr {\n      border-top-color: #a6e1ec; }\n    .gm-styles .alert-info .alert-link {\n      color: #245269; }\n  .gm-styles .alert-warning {\n    color: #8a6d3b;\n    background-color: #fcf8e3;\n    border-color: #faebcc; }\n    .gm-styles .alert-warning hr {\n      border-top-color: #f7e1b5; }\n    .gm-styles .alert-warning .alert-link {\n      color: #66512c; }\n  .gm-styles .alert-danger {\n    color: #a94442;\n    background-color: #f2dede;\n    border-color: #ebccd1; }\n    .gm-styles .alert-danger hr {\n      border-top-color: #e4b9c0; }\n    .gm-styles .alert-danger .alert-link {\n      color: #843534; }\n\n@-webkit-keyframes progress-bar-stripes {\n  from {\n    background-position: 40px 0; }\n  to {\n    background-position: 0 0; } }\n\n@keyframes progress-bar-stripes {\n  from {\n    background-position: 40px 0; }\n  to {\n    background-position: 0 0; } }\n  .gm-styles .progress {\n    height: 20px;\n    margin-bottom: 20px;\n    overflow: hidden;\n    background-color: #f5f5f5;\n    border-radius: 4px;\n    -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);\n    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1); }\n  .gm-styles .progress-bar {\n    float: left;\n    width: 0%;\n    height: 100%;\n    font-size: 12px;\n    line-height: 20px;\n    color: #fff;\n    text-align: center;\n    background-color: #337ab7;\n    -webkit-box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);\n    box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);\n    -webkit-transition: width 0.6s ease;\n    -o-transition: width 0.6s ease;\n    transition: width 0.6s ease; }\n  .gm-styles .progress-striped .progress-bar,\n  .gm-styles .progress-bar-striped {\n    background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n    background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n    background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n    background-size: 40px 40px; }\n  .gm-styles .progress.active .progress-bar,\n  .gm-styles .progress-bar.active {\n    -webkit-animation: progress-bar-stripes 2s linear infinite;\n    -o-animation: progress-bar-stripes 2s linear infinite;\n    animation: progress-bar-stripes 2s linear infinite; }\n  .gm-styles .progress-bar-success {\n    background-color: #5cb85c; }\n    .progress-striped .gm-styles .progress-bar-success {\n      background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n      background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n      background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent); }\n  .gm-styles .progress-bar-info {\n    background-color: #5bc0de; }\n    .progress-striped .gm-styles .progress-bar-info {\n      background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n      background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n      background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent); }\n  .gm-styles .progress-bar-warning {\n    background-color: #f0ad4e; }\n    .progress-striped .gm-styles .progress-bar-warning {\n      background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n      background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n      background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent); }\n  .gm-styles .progress-bar-danger {\n    background-color: #d9534f; }\n    .progress-striped .gm-styles .progress-bar-danger {\n      background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n      background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n      background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent); }\n  .gm-styles .media {\n    margin-top: 15px; }\n    .gm-styles .media:first-child {\n      margin-top: 0; }\n  .gm-styles .media,\n  .gm-styles .media-body {\n    overflow: hidden;\n    zoom: 1; }\n  .gm-styles .media-body {\n    width: 10000px; }\n  .gm-styles .media-object {\n    display: block; }\n    .gm-styles .media-object.img-thumbnail {\n      max-width: none; }\n  .gm-styles .media-right,\n  .gm-styles .media > .pull-right {\n    padding-left: 10px; }\n  .gm-styles .media-left,\n  .gm-styles .media > .pull-left {\n    padding-right: 10px; }\n  .gm-styles .media-left,\n  .gm-styles .media-right,\n  .gm-styles .media-body {\n    display: table-cell;\n    vertical-align: top; }\n  .gm-styles .media-middle {\n    vertical-align: middle; }\n  .gm-styles .media-bottom {\n    vertical-align: bottom; }\n  .gm-styles .media-heading {\n    margin-top: 0;\n    margin-bottom: 5px; }\n  .gm-styles .media-list {\n    padding-left: 0;\n    list-style: none; }\n  .gm-styles .list-group {\n    padding-left: 0;\n    margin-bottom: 20px; }\n  .gm-styles .list-group-item {\n    position: relative;\n    display: block;\n    padding: 10px 15px;\n    margin-bottom: -1px;\n    background-color: #fff;\n    border: 1px solid #ddd; }\n    .gm-styles .list-group-item:first-child {\n      border-top-left-radius: 4px;\n      border-top-right-radius: 4px; }\n    .gm-styles .list-group-item:last-child {\n      margin-bottom: 0;\n      border-bottom-right-radius: 4px;\n      border-bottom-left-radius: 4px; }\n    .gm-styles .list-group-item.disabled, .gm-styles .list-group-item.disabled:hover, .gm-styles .list-group-item.disabled:focus {\n      color: #777777;\n      cursor: not-allowed;\n      background-color: #eeeeee; }\n      .gm-styles .list-group-item.disabled .list-group-item-heading, .gm-styles .list-group-item.disabled:hover .list-group-item-heading, .gm-styles .list-group-item.disabled:focus .list-group-item-heading {\n        color: inherit; }\n      .gm-styles .list-group-item.disabled .list-group-item-text, .gm-styles .list-group-item.disabled:hover .list-group-item-text, .gm-styles .list-group-item.disabled:focus .list-group-item-text {\n        color: #777777; }\n    .gm-styles .list-group-item.active, .gm-styles .list-group-item.active:hover, .gm-styles .list-group-item.active:focus {\n      z-index: 2;\n      color: #fff;\n      background-color: #337ab7;\n      border-color: #337ab7; }\n      .gm-styles .list-group-item.active .list-group-item-heading,\n      .gm-styles .list-group-item.active .list-group-item-heading > small,\n      .gm-styles .list-group-item.active .list-group-item-heading > .small, .gm-styles .list-group-item.active:hover .list-group-item-heading,\n      .gm-styles .list-group-item.active:hover .list-group-item-heading > small,\n      .gm-styles .list-group-item.active:hover .list-group-item-heading > .small, .gm-styles .list-group-item.active:focus .list-group-item-heading,\n      .gm-styles .list-group-item.active:focus .list-group-item-heading > small,\n      .gm-styles .list-group-item.active:focus .list-group-item-heading > .small {\n        color: inherit; }\n      .gm-styles .list-group-item.active .list-group-item-text, .gm-styles .list-group-item.active:hover .list-group-item-text, .gm-styles .list-group-item.active:focus .list-group-item-text {\n        color: #c7ddef; }\n  .gm-styles a.list-group-item,\n  .gm-styles button.list-group-item {\n    color: #555; }\n    .gm-styles a.list-group-item .list-group-item-heading,\n    .gm-styles button.list-group-item .list-group-item-heading {\n      color: #333; }\n    .gm-styles a.list-group-item:hover, .gm-styles a.list-group-item:focus,\n    .gm-styles button.list-group-item:hover,\n    .gm-styles button.list-group-item:focus {\n      color: #555;\n      text-decoration: none;\n      background-color: #f5f5f5; }\n  .gm-styles button.list-group-item {\n    width: 100%;\n    text-align: left; }\n  .gm-styles .list-group-item-success {\n    color: #3c763d;\n    background-color: #dff0d8; }\n  .gm-styles a.list-group-item-success,\n  .gm-styles button.list-group-item-success {\n    color: #3c763d; }\n    .gm-styles a.list-group-item-success .list-group-item-heading,\n    .gm-styles button.list-group-item-success .list-group-item-heading {\n      color: inherit; }\n    .gm-styles a.list-group-item-success:hover, .gm-styles a.list-group-item-success:focus,\n    .gm-styles button.list-group-item-success:hover,\n    .gm-styles button.list-group-item-success:focus {\n      color: #3c763d;\n      background-color: #d0e9c6; }\n    .gm-styles a.list-group-item-success.active, .gm-styles a.list-group-item-success.active:hover, .gm-styles a.list-group-item-success.active:focus,\n    .gm-styles button.list-group-item-success.active,\n    .gm-styles button.list-group-item-success.active:hover,\n    .gm-styles button.list-group-item-success.active:focus {\n      color: #fff;\n      background-color: #3c763d;\n      border-color: #3c763d; }\n  .gm-styles .list-group-item-info {\n    color: #31708f;\n    background-color: #d9edf7; }\n  .gm-styles a.list-group-item-info,\n  .gm-styles button.list-group-item-info {\n    color: #31708f; }\n    .gm-styles a.list-group-item-info .list-group-item-heading,\n    .gm-styles button.list-group-item-info .list-group-item-heading {\n      color: inherit; }\n    .gm-styles a.list-group-item-info:hover, .gm-styles a.list-group-item-info:focus,\n    .gm-styles button.list-group-item-info:hover,\n    .gm-styles button.list-group-item-info:focus {\n      color: #31708f;\n      background-color: #c4e3f3; }\n    .gm-styles a.list-group-item-info.active, .gm-styles a.list-group-item-info.active:hover, .gm-styles a.list-group-item-info.active:focus,\n    .gm-styles button.list-group-item-info.active,\n    .gm-styles button.list-group-item-info.active:hover,\n    .gm-styles button.list-group-item-info.active:focus {\n      color: #fff;\n      background-color: #31708f;\n      border-color: #31708f; }\n  .gm-styles .list-group-item-warning {\n    color: #8a6d3b;\n    background-color: #fcf8e3; }\n  .gm-styles a.list-group-item-warning,\n  .gm-styles button.list-group-item-warning {\n    color: #8a6d3b; }\n    .gm-styles a.list-group-item-warning .list-group-item-heading,\n    .gm-styles button.list-group-item-warning .list-group-item-heading {\n      color: inherit; }\n    .gm-styles a.list-group-item-warning:hover, .gm-styles a.list-group-item-warning:focus,\n    .gm-styles button.list-group-item-warning:hover,\n    .gm-styles button.list-group-item-warning:focus {\n      color: #8a6d3b;\n      background-color: #faf2cc; }\n    .gm-styles a.list-group-item-warning.active, .gm-styles a.list-group-item-warning.active:hover, .gm-styles a.list-group-item-warning.active:focus,\n    .gm-styles button.list-group-item-warning.active,\n    .gm-styles button.list-group-item-warning.active:hover,\n    .gm-styles button.list-group-item-warning.active:focus {\n      color: #fff;\n      background-color: #8a6d3b;\n      border-color: #8a6d3b; }\n  .gm-styles .list-group-item-danger {\n    color: #a94442;\n    background-color: #f2dede; }\n  .gm-styles a.list-group-item-danger,\n  .gm-styles button.list-group-item-danger {\n    color: #a94442; }\n    .gm-styles a.list-group-item-danger .list-group-item-heading,\n    .gm-styles button.list-group-item-danger .list-group-item-heading {\n      color: inherit; }\n    .gm-styles a.list-group-item-danger:hover, .gm-styles a.list-group-item-danger:focus,\n    .gm-styles button.list-group-item-danger:hover,\n    .gm-styles button.list-group-item-danger:focus {\n      color: #a94442;\n      background-color: #ebcccc; }\n    .gm-styles a.list-group-item-danger.active, .gm-styles a.list-group-item-danger.active:hover, .gm-styles a.list-group-item-danger.active:focus,\n    .gm-styles button.list-group-item-danger.active,\n    .gm-styles button.list-group-item-danger.active:hover,\n    .gm-styles button.list-group-item-danger.active:focus {\n      color: #fff;\n      background-color: #a94442;\n      border-color: #a94442; }\n  .gm-styles .list-group-item-heading {\n    margin-top: 0;\n    margin-bottom: 5px; }\n  .gm-styles .list-group-item-text {\n    margin-bottom: 0;\n    line-height: 1.3; }\n  .gm-styles .panel {\n    margin-bottom: 20px;\n    background-color: #fff;\n    border: 1px solid transparent;\n    border-radius: 4px;\n    -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);\n    box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05); }\n  .gm-styles .panel-body {\n    padding: 15px; }\n    .gm-styles .panel-body:before, .gm-styles .panel-body:after {\n      display: table;\n      content: " "; }\n    .gm-styles .panel-body:after {\n      clear: both; }\n  .gm-styles .panel-heading {\n    padding: 10px 15px;\n    border-bottom: 1px solid transparent;\n    border-top-left-radius: 3px;\n    border-top-right-radius: 3px; }\n    .gm-styles .panel-heading > .dropdown .dropdown-toggle {\n      color: inherit; }\n  .gm-styles .panel-title {\n    margin-top: 0;\n    margin-bottom: 0;\n    font-size: 16px;\n    color: inherit; }\n    .gm-styles .panel-title > a,\n    .gm-styles .panel-title > small,\n    .gm-styles .panel-title > .small,\n    .gm-styles .panel-title > small > a,\n    .gm-styles .panel-title > .small > a {\n      color: inherit; }\n  .gm-styles .panel-footer {\n    padding: 10px 15px;\n    background-color: #f5f5f5;\n    border-top: 1px solid #ddd;\n    border-bottom-right-radius: 3px;\n    border-bottom-left-radius: 3px; }\n  .gm-styles .panel > .list-group,\n  .gm-styles .panel > .panel-collapse > .list-group {\n    margin-bottom: 0; }\n    .gm-styles .panel > .list-group .list-group-item,\n    .gm-styles .panel > .panel-collapse > .list-group .list-group-item {\n      border-width: 1px 0;\n      border-radius: 0; }\n    .gm-styles .panel > .list-group:first-child .list-group-item:first-child,\n    .gm-styles .panel > .panel-collapse > .list-group:first-child .list-group-item:first-child {\n      border-top: 0;\n      border-top-left-radius: 3px;\n      border-top-right-radius: 3px; }\n    .gm-styles .panel > .list-group:last-child .list-group-item:last-child,\n    .gm-styles .panel > .panel-collapse > .list-group:last-child .list-group-item:last-child {\n      border-bottom: 0;\n      border-bottom-right-radius: 3px;\n      border-bottom-left-radius: 3px; }\n  .gm-styles .panel > .panel-heading + .panel-collapse > .list-group .list-group-item:first-child {\n    border-top-left-radius: 0;\n    border-top-right-radius: 0; }\n  .gm-styles .panel-heading + .list-group .list-group-item:first-child {\n    border-top-width: 0; }\n  .gm-styles .list-group + .panel-footer {\n    border-top-width: 0; }\n  .gm-styles .panel > .table,\n  .gm-styles .panel > .table-responsive > .table,\n  .gm-styles .panel > .panel-collapse > .table {\n    margin-bottom: 0; }\n    .gm-styles .panel > .table caption,\n    .gm-styles .panel > .table-responsive > .table caption,\n    .gm-styles .panel > .panel-collapse > .table caption {\n      padding-right: 15px;\n      padding-left: 15px; }\n  .gm-styles .panel > .table:first-child,\n  .gm-styles .panel > .table-responsive:first-child > .table:first-child {\n    border-top-left-radius: 3px;\n    border-top-right-radius: 3px; }\n    .gm-styles .panel > .table:first-child > thead:first-child > tr:first-child,\n    .gm-styles .panel > .table:first-child > tbody:first-child > tr:first-child,\n    .gm-styles .panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child,\n    .gm-styles .panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child {\n      border-top-left-radius: 3px;\n      border-top-right-radius: 3px; }\n      .gm-styles .panel > .table:first-child > thead:first-child > tr:first-child td:first-child,\n      .gm-styles .panel > .table:first-child > thead:first-child > tr:first-child th:first-child,\n      .gm-styles .panel > .table:first-child > tbody:first-child > tr:first-child td:first-child,\n      .gm-styles .panel > .table:first-child > tbody:first-child > tr:first-child th:first-child,\n      .gm-styles .panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:first-child,\n      .gm-styles .panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:first-child,\n      .gm-styles .panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:first-child,\n      .gm-styles .panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:first-child {\n        border-top-left-radius: 3px; }\n      .gm-styles .panel > .table:first-child > thead:first-child > tr:first-child td:last-child,\n      .gm-styles .panel > .table:first-child > thead:first-child > tr:first-child th:last-child,\n      .gm-styles .panel > .table:first-child > tbody:first-child > tr:first-child td:last-child,\n      .gm-styles .panel > .table:first-child > tbody:first-child > tr:first-child th:last-child,\n      .gm-styles .panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:last-child,\n      .gm-styles .panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:last-child,\n      .gm-styles .panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:last-child,\n      .gm-styles .panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:last-child {\n        border-top-right-radius: 3px; }\n  .gm-styles .panel > .table:last-child,\n  .gm-styles .panel > .table-responsive:last-child > .table:last-child {\n    border-bottom-right-radius: 3px;\n    border-bottom-left-radius: 3px; }\n    .gm-styles .panel > .table:last-child > tbody:last-child > tr:last-child,\n    .gm-styles .panel > .table:last-child > tfoot:last-child > tr:last-child,\n    .gm-styles .panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child,\n    .gm-styles .panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child {\n      border-bottom-right-radius: 3px;\n      border-bottom-left-radius: 3px; }\n      .gm-styles .panel > .table:last-child > tbody:last-child > tr:last-child td:first-child,\n      .gm-styles .panel > .table:last-child > tbody:last-child > tr:last-child th:first-child,\n      .gm-styles .panel > .table:last-child > tfoot:last-child > tr:last-child td:first-child,\n      .gm-styles .panel > .table:last-child > tfoot:last-child > tr:last-child th:first-child,\n      .gm-styles .panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:first-child,\n      .gm-styles .panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:first-child,\n      .gm-styles .panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:first-child,\n      .gm-styles .panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:first-child {\n        border-bottom-left-radius: 3px; }\n      .gm-styles .panel > .table:last-child > tbody:last-child > tr:last-child td:last-child,\n      .gm-styles .panel > .table:last-child > tbody:last-child > tr:last-child th:last-child,\n      .gm-styles .panel > .table:last-child > tfoot:last-child > tr:last-child td:last-child,\n      .gm-styles .panel > .table:last-child > tfoot:last-child > tr:last-child th:last-child,\n      .gm-styles .panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:last-child,\n      .gm-styles .panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:last-child,\n      .gm-styles .panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:last-child,\n      .gm-styles .panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:last-child {\n        border-bottom-right-radius: 3px; }\n  .gm-styles .panel > .panel-body + .table,\n  .gm-styles .panel > .panel-body + .table-responsive,\n  .gm-styles .panel > .table + .panel-body,\n  .gm-styles .panel > .table-responsive + .panel-body {\n    border-top: 1px solid #ddd; }\n  .gm-styles .panel > .table > tbody:first-child > tr:first-child th,\n  .gm-styles .panel > .table > tbody:first-child > tr:first-child td {\n    border-top: 0; }\n  .gm-styles .panel > .table-bordered,\n  .gm-styles .panel > .table-responsive > .table-bordered {\n    border: 0; }\n    .gm-styles .panel > .table-bordered > thead > tr > th:first-child,\n    .gm-styles .panel > .table-bordered > thead > tr > td:first-child,\n    .gm-styles .panel > .table-bordered > tbody > tr > th:first-child,\n    .gm-styles .panel > .table-bordered > tbody > tr > td:first-child,\n    .gm-styles .panel > .table-bordered > tfoot > tr > th:first-child,\n    .gm-styles .panel > .table-bordered > tfoot > tr > td:first-child,\n    .gm-styles .panel > .table-responsive > .table-bordered > thead > tr > th:first-child,\n    .gm-styles .panel > .table-responsive > .table-bordered > thead > tr > td:first-child,\n    .gm-styles .panel > .table-responsive > .table-bordered > tbody > tr > th:first-child,\n    .gm-styles .panel > .table-responsive > .table-bordered > tbody > tr > td:first-child,\n    .gm-styles .panel > .table-responsive > .table-bordered > tfoot > tr > th:first-child,\n    .gm-styles .panel > .table-responsive > .table-bordered > tfoot > tr > td:first-child {\n      border-left: 0; }\n    .gm-styles .panel > .table-bordered > thead > tr > th:last-child,\n    .gm-styles .panel > .table-bordered > thead > tr > td:last-child,\n    .gm-styles .panel > .table-bordered > tbody > tr > th:last-child,\n    .gm-styles .panel > .table-bordered > tbody > tr > td:last-child,\n    .gm-styles .panel > .table-bordered > tfoot > tr > th:last-child,\n    .gm-styles .panel > .table-bordered > tfoot > tr > td:last-child,\n    .gm-styles .panel > .table-responsive > .table-bordered > thead > tr > th:last-child,\n    .gm-styles .panel > .table-responsive > .table-bordered > thead > tr > td:last-child,\n    .gm-styles .panel > .table-responsive > .table-bordered > tbody > tr > th:last-child,\n    .gm-styles .panel > .table-responsive > .table-bordered > tbody > tr > td:last-child,\n    .gm-styles .panel > .table-responsive > .table-bordered > tfoot > tr > th:last-child,\n    .gm-styles .panel > .table-responsive > .table-bordered > tfoot > tr > td:last-child {\n      border-right: 0; }\n    .gm-styles .panel > .table-bordered > thead > tr:first-child > td,\n    .gm-styles .panel > .table-bordered > thead > tr:first-child > th,\n    .gm-styles .panel > .table-bordered > tbody > tr:first-child > td,\n    .gm-styles .panel > .table-bordered > tbody > tr:first-child > th,\n    .gm-styles .panel > .table-responsive > .table-bordered > thead > tr:first-child > td,\n    .gm-styles .panel > .table-responsive > .table-bordered > thead > tr:first-child > th,\n    .gm-styles .panel > .table-responsive > .table-bordered > tbody > tr:first-child > td,\n    .gm-styles .panel > .table-responsive > .table-bordered > tbody > tr:first-child > th {\n      border-bottom: 0; }\n    .gm-styles .panel > .table-bordered > tbody > tr:last-child > td,\n    .gm-styles .panel > .table-bordered > tbody > tr:last-child > th,\n    .gm-styles .panel > .table-bordered > tfoot > tr:last-child > td,\n    .gm-styles .panel > .table-bordered > tfoot > tr:last-child > th,\n    .gm-styles .panel > .table-responsive > .table-bordered > tbody > tr:last-child > td,\n    .gm-styles .panel > .table-responsive > .table-bordered > tbody > tr:last-child > th,\n    .gm-styles .panel > .table-responsive > .table-bordered > tfoot > tr:last-child > td,\n    .gm-styles .panel > .table-responsive > .table-bordered > tfoot > tr:last-child > th {\n      border-bottom: 0; }\n  .gm-styles .panel > .table-responsive {\n    margin-bottom: 0;\n    border: 0; }\n  .gm-styles .panel-group {\n    margin-bottom: 20px; }\n    .gm-styles .panel-group .panel {\n      margin-bottom: 0;\n      border-radius: 4px; }\n      .gm-styles .panel-group .panel + .panel {\n        margin-top: 5px; }\n    .gm-styles .panel-group .panel-heading {\n      border-bottom: 0; }\n      .gm-styles .panel-group .panel-heading + .panel-collapse > .panel-body,\n      .gm-styles .panel-group .panel-heading + .panel-collapse > .list-group {\n        border-top: 1px solid #ddd; }\n    .gm-styles .panel-group .panel-footer {\n      border-top: 0; }\n      .gm-styles .panel-group .panel-footer + .panel-collapse .panel-body {\n        border-bottom: 1px solid #ddd; }\n  .gm-styles .panel-default {\n    border-color: #ddd; }\n    .gm-styles .panel-default > .panel-heading {\n      color: #333333;\n      background-color: #f5f5f5;\n      border-color: #ddd; }\n      .gm-styles .panel-default > .panel-heading + .panel-collapse > .panel-body {\n        border-top-color: #ddd; }\n      .gm-styles .panel-default > .panel-heading .badge {\n        color: #f5f5f5;\n        background-color: #333333; }\n    .gm-styles .panel-default > .panel-footer + .panel-collapse > .panel-body {\n      border-bottom-color: #ddd; }\n  .gm-styles .panel-primary {\n    border-color: #337ab7; }\n    .gm-styles .panel-primary > .panel-heading {\n      color: #fff;\n      background-color: #337ab7;\n      border-color: #337ab7; }\n      .gm-styles .panel-primary > .panel-heading + .panel-collapse > .panel-body {\n        border-top-color: #337ab7; }\n      .gm-styles .panel-primary > .panel-heading .badge {\n        color: #337ab7;\n        background-color: #fff; }\n    .gm-styles .panel-primary > .panel-footer + .panel-collapse > .panel-body {\n      border-bottom-color: #337ab7; }\n  .gm-styles .panel-success {\n    border-color: #d6e9c6; }\n    .gm-styles .panel-success > .panel-heading {\n      color: #3c763d;\n      background-color: #dff0d8;\n      border-color: #d6e9c6; }\n      .gm-styles .panel-success > .panel-heading + .panel-collapse > .panel-body {\n        border-top-color: #d6e9c6; }\n      .gm-styles .panel-success > .panel-heading .badge {\n        color: #dff0d8;\n        background-color: #3c763d; }\n    .gm-styles .panel-success > .panel-footer + .panel-collapse > .panel-body {\n      border-bottom-color: #d6e9c6; }\n  .gm-styles .panel-info {\n    border-color: #bce8f1; }\n    .gm-styles .panel-info > .panel-heading {\n      color: #31708f;\n      background-color: #d9edf7;\n      border-color: #bce8f1; }\n      .gm-styles .panel-info > .panel-heading + .panel-collapse > .panel-body {\n        border-top-color: #bce8f1; }\n      .gm-styles .panel-info > .panel-heading .badge {\n        color: #d9edf7;\n        background-color: #31708f; }\n    .gm-styles .panel-info > .panel-footer + .panel-collapse > .panel-body {\n      border-bottom-color: #bce8f1; }\n  .gm-styles .panel-warning {\n    border-color: #faebcc; }\n    .gm-styles .panel-warning > .panel-heading {\n      color: #8a6d3b;\n      background-color: #fcf8e3;\n      border-color: #faebcc; }\n      .gm-styles .panel-warning > .panel-heading + .panel-collapse > .panel-body {\n        border-top-color: #faebcc; }\n      .gm-styles .panel-warning > .panel-heading .badge {\n        color: #fcf8e3;\n        background-color: #8a6d3b; }\n    .gm-styles .panel-warning > .panel-footer + .panel-collapse > .panel-body {\n      border-bottom-color: #faebcc; }\n  .gm-styles .panel-danger {\n    border-color: #ebccd1; }\n    .gm-styles .panel-danger > .panel-heading {\n      color: #a94442;\n      background-color: #f2dede;\n      border-color: #ebccd1; }\n      .gm-styles .panel-danger > .panel-heading + .panel-collapse > .panel-body {\n        border-top-color: #ebccd1; }\n      .gm-styles .panel-danger > .panel-heading .badge {\n        color: #f2dede;\n        background-color: #a94442; }\n    .gm-styles .panel-danger > .panel-footer + .panel-collapse > .panel-body {\n      border-bottom-color: #ebccd1; }\n  .gm-styles .embed-responsive {\n    position: relative;\n    display: block;\n    height: 0;\n    padding: 0;\n    overflow: hidden; }\n    .gm-styles .embed-responsive .embed-responsive-item,\n    .gm-styles .embed-responsive iframe,\n    .gm-styles .embed-responsive embed,\n    .gm-styles .embed-responsive object,\n    .gm-styles .embed-responsive video {\n      position: absolute;\n      top: 0;\n      bottom: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      border: 0; }\n  .gm-styles .embed-responsive-16by9 {\n    padding-bottom: 56.25%; }\n  .gm-styles .embed-responsive-4by3 {\n    padding-bottom: 75%; }\n  .gm-styles .well {\n    min-height: 20px;\n    padding: 19px;\n    margin-bottom: 20px;\n    background-color: #f5f5f5;\n    border: 1px solid #e3e3e3;\n    border-radius: 4px;\n    -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);\n    box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05); }\n    .gm-styles .well blockquote {\n      border-color: #ddd;\n      border-color: rgba(0, 0, 0, 0.15); }\n  .gm-styles .well-lg {\n    padding: 24px;\n    border-radius: 6px; }\n  .gm-styles .well-sm {\n    padding: 9px;\n    border-radius: 3px; }\n  .gm-styles .close {\n    float: right;\n    font-size: 21px;\n    font-weight: bold;\n    line-height: 1;\n    color: #000;\n    text-shadow: 0 1px 0 #fff;\n    filter: alpha(opacity=20);\n    opacity: 0.2; }\n    .gm-styles .close:hover, .gm-styles .close:focus {\n      color: #000;\n      text-decoration: none;\n      cursor: pointer;\n      filter: alpha(opacity=50);\n      opacity: 0.5; }\n  .gm-styles button.close {\n    padding: 0;\n    cursor: pointer;\n    background: transparent;\n    border: 0;\n    -webkit-appearance: none;\n    appearance: none; }\n  .gm-styles .modal-open {\n    overflow: hidden; }\n  .gm-styles .modal {\n    position: fixed;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    z-index: 1050;\n    display: none;\n    overflow: hidden;\n    -webkit-overflow-scrolling: touch;\n    outline: 0; }\n    .gm-styles .modal.fade .modal-dialog {\n      -webkit-transform: translate(0, -25%);\n      -ms-transform: translate(0, -25%);\n      -o-transform: translate(0, -25%);\n      transform: translate(0, -25%);\n      -webkit-transition: -webkit-transform 0.3s ease-out;\n      -moz-transition: -moz-transform 0.3s ease-out;\n      -o-transition: -o-transform 0.3s ease-out;\n      transition: transform 0.3s ease-out; }\n    .gm-styles .modal.in .modal-dialog {\n      -webkit-transform: translate(0, 0);\n      -ms-transform: translate(0, 0);\n      -o-transform: translate(0, 0);\n      transform: translate(0, 0); }\n  .gm-styles .modal-open .modal {\n    overflow-x: hidden;\n    overflow-y: auto; }\n  .gm-styles .modal-dialog {\n    position: relative;\n    width: auto;\n    margin: 10px; }\n  .gm-styles .modal-content {\n    position: relative;\n    background-color: #fff;\n    background-clip: padding-box;\n    border: 1px solid #999;\n    border: 1px solid rgba(0, 0, 0, 0.2);\n    border-radius: 6px;\n    -webkit-box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);\n    box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);\n    outline: 0; }\n  .gm-styles .modal-backdrop {\n    position: fixed;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    z-index: 1040;\n    background-color: #000; }\n    .gm-styles .modal-backdrop.fade {\n      filter: alpha(opacity=0);\n      opacity: 0; }\n    .gm-styles .modal-backdrop.in {\n      filter: alpha(opacity=50);\n      opacity: 0.5; }\n  .gm-styles .modal-header {\n    padding: 15px;\n    border-bottom: 1px solid #e5e5e5; }\n    .gm-styles .modal-header:before, .gm-styles .modal-header:after {\n      display: table;\n      content: " "; }\n    .gm-styles .modal-header:after {\n      clear: both; }\n  .gm-styles .modal-header .close {\n    margin-top: -2px; }\n  .gm-styles .modal-title {\n    margin: 0;\n    line-height: 1.42857; }\n  .gm-styles .modal-body {\n    position: relative;\n    padding: 15px; }\n  .gm-styles .modal-footer {\n    padding: 15px;\n    text-align: right;\n    border-top: 1px solid #e5e5e5; }\n    .gm-styles .modal-footer:before, .gm-styles .modal-footer:after {\n      display: table;\n      content: " "; }\n    .gm-styles .modal-footer:after {\n      clear: both; }\n    .gm-styles .modal-footer .btn + .btn {\n      margin-bottom: 0;\n      margin-left: 5px; }\n    .gm-styles .modal-footer .btn-group .btn + .btn {\n      margin-left: -1px; }\n    .gm-styles .modal-footer .btn-block + .btn-block {\n      margin-left: 0; }\n  .gm-styles .modal-scrollbar-measure {\n    position: absolute;\n    top: -9999px;\n    width: 50px;\n    height: 50px;\n    overflow: scroll; }\n  @media (min-width: 768px) {\n    .gm-styles .modal-dialog {\n      width: 600px;\n      margin: 30px auto; }\n    .gm-styles .modal-content {\n      -webkit-box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);\n      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5); }\n    .gm-styles .modal-sm {\n      width: 300px; } }\n  @media (min-width: 992px) {\n    .gm-styles .modal-lg {\n      width: 900px; } }\n  .gm-styles .tooltip {\n    position: absolute;\n    z-index: 1070;\n    display: block;\n    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n    font-style: normal;\n    font-weight: 400;\n    line-height: 1.42857;\n    line-break: auto;\n    text-align: left;\n    text-align: start;\n    text-decoration: none;\n    text-shadow: none;\n    text-transform: none;\n    letter-spacing: normal;\n    word-break: normal;\n    word-spacing: normal;\n    word-wrap: normal;\n    white-space: normal;\n    font-size: 12px;\n    filter: alpha(opacity=0);\n    opacity: 0; }\n    .gm-styles .tooltip.in {\n      filter: alpha(opacity=90);\n      opacity: 0.9; }\n    .gm-styles .tooltip.top {\n      padding: 5px 0;\n      margin-top: -3px; }\n    .gm-styles .tooltip.right {\n      padding: 0 5px;\n      margin-left: 3px; }\n    .gm-styles .tooltip.bottom {\n      padding: 5px 0;\n      margin-top: 3px; }\n    .gm-styles .tooltip.left {\n      padding: 0 5px;\n      margin-left: -3px; }\n    .gm-styles .tooltip.top .tooltip-arrow {\n      bottom: 0;\n      left: 50%;\n      margin-left: -5px;\n      border-width: 5px 5px 0;\n      border-top-color: #000; }\n    .gm-styles .tooltip.top-left .tooltip-arrow {\n      right: 5px;\n      bottom: 0;\n      margin-bottom: -5px;\n      border-width: 5px 5px 0;\n      border-top-color: #000; }\n    .gm-styles .tooltip.top-right .tooltip-arrow {\n      bottom: 0;\n      left: 5px;\n      margin-bottom: -5px;\n      border-width: 5px 5px 0;\n      border-top-color: #000; }\n    .gm-styles .tooltip.right .tooltip-arrow {\n      top: 50%;\n      left: 0;\n      margin-top: -5px;\n      border-width: 5px 5px 5px 0;\n      border-right-color: #000; }\n    .gm-styles .tooltip.left .tooltip-arrow {\n      top: 50%;\n      right: 0;\n      margin-top: -5px;\n      border-width: 5px 0 5px 5px;\n      border-left-color: #000; }\n    .gm-styles .tooltip.bottom .tooltip-arrow {\n      top: 0;\n      left: 50%;\n      margin-left: -5px;\n      border-width: 0 5px 5px;\n      border-bottom-color: #000; }\n    .gm-styles .tooltip.bottom-left .tooltip-arrow {\n      top: 0;\n      right: 5px;\n      margin-top: -5px;\n      border-width: 0 5px 5px;\n      border-bottom-color: #000; }\n    .gm-styles .tooltip.bottom-right .tooltip-arrow {\n      top: 0;\n      left: 5px;\n      margin-top: -5px;\n      border-width: 0 5px 5px;\n      border-bottom-color: #000; }\n  .gm-styles .tooltip-inner {\n    max-width: 200px;\n    padding: 3px 8px;\n    color: #fff;\n    text-align: center;\n    background-color: #000;\n    border-radius: 4px; }\n  .gm-styles .tooltip-arrow {\n    position: absolute;\n    width: 0;\n    height: 0;\n    border-color: transparent;\n    border-style: solid; }\n  .gm-styles .popover {\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 1060;\n    display: none;\n    max-width: 276px;\n    padding: 1px;\n    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n    font-style: normal;\n    font-weight: 400;\n    line-height: 1.42857;\n    line-break: auto;\n    text-align: left;\n    text-align: start;\n    text-decoration: none;\n    text-shadow: none;\n    text-transform: none;\n    letter-spacing: normal;\n    word-break: normal;\n    word-spacing: normal;\n    word-wrap: normal;\n    white-space: normal;\n    font-size: 14px;\n    background-color: #fff;\n    background-clip: padding-box;\n    border: 1px solid #ccc;\n    border: 1px solid rgba(0, 0, 0, 0.2);\n    border-radius: 6px;\n    -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);\n    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2); }\n    .gm-styles .popover.top {\n      margin-top: -10px; }\n    .gm-styles .popover.right {\n      margin-left: 10px; }\n    .gm-styles .popover.bottom {\n      margin-top: 10px; }\n    .gm-styles .popover.left {\n      margin-left: -10px; }\n    .gm-styles .popover > .arrow {\n      border-width: 11px; }\n      .gm-styles .popover > .arrow, .gm-styles .popover > .arrow:after {\n        position: absolute;\n        display: block;\n        width: 0;\n        height: 0;\n        border-color: transparent;\n        border-style: solid; }\n      .gm-styles .popover > .arrow:after {\n        content: "";\n        border-width: 10px; }\n    .gm-styles .popover.top > .arrow {\n      bottom: -11px;\n      left: 50%;\n      margin-left: -11px;\n      border-top-color: #999999;\n      border-top-color: rgba(0, 0, 0, 0.25);\n      border-bottom-width: 0; }\n      .gm-styles .popover.top > .arrow:after {\n        bottom: 1px;\n        margin-left: -10px;\n        content: " ";\n        border-top-color: #fff;\n        border-bottom-width: 0; }\n    .gm-styles .popover.right > .arrow {\n      top: 50%;\n      left: -11px;\n      margin-top: -11px;\n      border-right-color: #999999;\n      border-right-color: rgba(0, 0, 0, 0.25);\n      border-left-width: 0; }\n      .gm-styles .popover.right > .arrow:after {\n        bottom: -10px;\n        left: 1px;\n        content: " ";\n        border-right-color: #fff;\n        border-left-width: 0; }\n    .gm-styles .popover.bottom > .arrow {\n      top: -11px;\n      left: 50%;\n      margin-left: -11px;\n      border-top-width: 0;\n      border-bottom-color: #999999;\n      border-bottom-color: rgba(0, 0, 0, 0.25); }\n      .gm-styles .popover.bottom > .arrow:after {\n        top: 1px;\n        margin-left: -10px;\n        content: " ";\n        border-top-width: 0;\n        border-bottom-color: #fff; }\n    .gm-styles .popover.left > .arrow {\n      top: 50%;\n      right: -11px;\n      margin-top: -11px;\n      border-right-width: 0;\n      border-left-color: #999999;\n      border-left-color: rgba(0, 0, 0, 0.25); }\n      .gm-styles .popover.left > .arrow:after {\n        right: 1px;\n        bottom: -10px;\n        content: " ";\n        border-right-width: 0;\n        border-left-color: #fff; }\n  .gm-styles .popover-title {\n    padding: 8px 14px;\n    margin: 0;\n    font-size: 14px;\n    background-color: #f7f7f7;\n    border-bottom: 1px solid #ebebeb;\n    border-radius: 5px 5px 0 0; }\n  .gm-styles .popover-content {\n    padding: 9px 14px; }\n  .gm-styles .carousel {\n    position: relative; }\n  .gm-styles .carousel-inner {\n    position: relative;\n    width: 100%;\n    overflow: hidden; }\n    .gm-styles .carousel-inner > .item {\n      position: relative;\n      display: none;\n      -webkit-transition: 0.6s ease-in-out left;\n      -o-transition: 0.6s ease-in-out left;\n      transition: 0.6s ease-in-out left; }\n      .gm-styles .carousel-inner > .item > img,\n      .gm-styles .carousel-inner > .item > a > img {\n        display: block;\n        max-width: 100%;\n        height: auto;\n        line-height: 1; }\n      @media all and (transform-3d), (-webkit-transform-3d) {\n        .gm-styles .carousel-inner > .item {\n          -webkit-transition: -webkit-transform 0.6s ease-in-out;\n          -moz-transition: -moz-transform 0.6s ease-in-out;\n          -o-transition: -o-transform 0.6s ease-in-out;\n          transition: transform 0.6s ease-in-out;\n          -webkit-backface-visibility: hidden;\n          -moz-backface-visibility: hidden;\n          backface-visibility: hidden;\n          -webkit-perspective: 1000px;\n          -moz-perspective: 1000px;\n          perspective: 1000px; }\n          .gm-styles .carousel-inner > .item.next, .gm-styles .carousel-inner > .item.active.right {\n            -webkit-transform: translate3d(100%, 0, 0);\n            transform: translate3d(100%, 0, 0);\n            left: 0; }\n          .gm-styles .carousel-inner > .item.prev, .gm-styles .carousel-inner > .item.active.left {\n            -webkit-transform: translate3d(-100%, 0, 0);\n            transform: translate3d(-100%, 0, 0);\n            left: 0; }\n          .gm-styles .carousel-inner > .item.next.left, .gm-styles .carousel-inner > .item.prev.right, .gm-styles .carousel-inner > .item.active {\n            -webkit-transform: translate3d(0, 0, 0);\n            transform: translate3d(0, 0, 0);\n            left: 0; } }\n    .gm-styles .carousel-inner > .active,\n    .gm-styles .carousel-inner > .next,\n    .gm-styles .carousel-inner > .prev {\n      display: block; }\n    .gm-styles .carousel-inner > .active {\n      left: 0; }\n    .gm-styles .carousel-inner > .next,\n    .gm-styles .carousel-inner > .prev {\n      position: absolute;\n      top: 0;\n      width: 100%; }\n    .gm-styles .carousel-inner > .next {\n      left: 100%; }\n    .gm-styles .carousel-inner > .prev {\n      left: -100%; }\n    .gm-styles .carousel-inner > .next.left,\n    .gm-styles .carousel-inner > .prev.right {\n      left: 0; }\n    .gm-styles .carousel-inner > .active.left {\n      left: -100%; }\n    .gm-styles .carousel-inner > .active.right {\n      left: 100%; }\n  .gm-styles .carousel-control {\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    width: 15%;\n    font-size: 20px;\n    color: #fff;\n    text-align: center;\n    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);\n    background-color: rgba(0, 0, 0, 0);\n    filter: alpha(opacity=50);\n    opacity: 0.5; }\n    .gm-styles .carousel-control.left {\n      background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);\n      background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);\n      background-image: linear-gradient(to right, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);\n      filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\'#80000000\', endColorstr=\'#00000000\', GradientType=1);\n      background-repeat: repeat-x; }\n    .gm-styles .carousel-control.right {\n      right: 0;\n      left: auto;\n      background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);\n      background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);\n      background-image: linear-gradient(to right, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);\n      filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\'#00000000\', endColorstr=\'#80000000\', GradientType=1);\n      background-repeat: repeat-x; }\n    .gm-styles .carousel-control:hover, .gm-styles .carousel-control:focus {\n      color: #fff;\n      text-decoration: none;\n      outline: 0;\n      filter: alpha(opacity=90);\n      opacity: 0.9; }\n    .gm-styles .carousel-control .icon-prev,\n    .gm-styles .carousel-control .icon-next,\n    .gm-styles .carousel-control .glyphicon-chevron-left,\n    .gm-styles .carousel-control .glyphicon-chevron-right {\n      position: absolute;\n      top: 50%;\n      z-index: 5;\n      display: inline-block;\n      margin-top: -10px; }\n    .gm-styles .carousel-control .icon-prev,\n    .gm-styles .carousel-control .glyphicon-chevron-left {\n      left: 50%;\n      margin-left: -10px; }\n    .gm-styles .carousel-control .icon-next,\n    .gm-styles .carousel-control .glyphicon-chevron-right {\n      right: 50%;\n      margin-right: -10px; }\n    .gm-styles .carousel-control .icon-prev,\n    .gm-styles .carousel-control .icon-next {\n      width: 20px;\n      height: 20px;\n      font-family: serif;\n      line-height: 1; }\n    .gm-styles .carousel-control .icon-prev:before {\n      content: "\\2039"; }\n    .gm-styles .carousel-control .icon-next:before {\n      content: "\\203A"; }\n  .gm-styles .carousel-indicators {\n    position: absolute;\n    bottom: 10px;\n    left: 50%;\n    z-index: 15;\n    width: 60%;\n    padding-left: 0;\n    margin-left: -30%;\n    text-align: center;\n    list-style: none; }\n    .gm-styles .carousel-indicators li {\n      display: inline-block;\n      width: 10px;\n      height: 10px;\n      margin: 1px;\n      text-indent: -999px;\n      cursor: pointer;\n      background-color: #000 \\9;\n      background-color: rgba(0, 0, 0, 0);\n      border: 1px solid #fff;\n      border-radius: 10px; }\n    .gm-styles .carousel-indicators .active {\n      width: 12px;\n      height: 12px;\n      margin: 0;\n      background-color: #fff; }\n  .gm-styles .carousel-caption {\n    position: absolute;\n    right: 15%;\n    bottom: 20px;\n    left: 15%;\n    z-index: 10;\n    padding-top: 20px;\n    padding-bottom: 20px;\n    color: #fff;\n    text-align: center;\n    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6); }\n    .gm-styles .carousel-caption .btn {\n      text-shadow: none; }\n  @media screen and (min-width: 768px) {\n    .gm-styles .carousel-control .glyphicon-chevron-left,\n    .gm-styles .carousel-control .glyphicon-chevron-right,\n    .gm-styles .carousel-control .icon-prev,\n    .gm-styles .carousel-control .icon-next {\n      width: 30px;\n      height: 30px;\n      margin-top: -10px;\n      font-size: 30px; }\n    .gm-styles .carousel-control .glyphicon-chevron-left,\n    .gm-styles .carousel-control .icon-prev {\n      margin-left: -10px; }\n    .gm-styles .carousel-control .glyphicon-chevron-right,\n    .gm-styles .carousel-control .icon-next {\n      margin-right: -10px; }\n    .gm-styles .carousel-caption {\n      right: 20%;\n      left: 20%;\n      padding-bottom: 30px; }\n    .gm-styles .carousel-indicators {\n      bottom: 20px; } }\n  .gm-styles .clearfix:before, .gm-styles .clearfix:after {\n    display: table;\n    content: " "; }\n  .gm-styles .clearfix:after {\n    clear: both; }\n  .gm-styles .center-block {\n    display: block;\n    margin-right: auto;\n    margin-left: auto; }\n  .gm-styles .pull-right {\n    float: right !important; }\n  .gm-styles .pull-left {\n    float: left !important; }\n  .gm-styles .hide {\n    display: none !important; }\n  .gm-styles .show {\n    display: block !important; }\n  .gm-styles .invisible {\n    visibility: hidden; }\n  .gm-styles .text-hide {\n    font: 0/0 a;\n    color: transparent;\n    text-shadow: none;\n    background-color: transparent;\n    border: 0; }\n  .gm-styles .hidden {\n    display: none !important; }\n  .gm-styles .affix {\n    position: fixed; }\n\n@-ms-viewport {\n  width: device-width; }\n  .gm-styles .visible-xs {\n    display: none !important; }\n  .gm-styles .visible-sm {\n    display: none !important; }\n  .gm-styles .visible-md {\n    display: none !important; }\n  .gm-styles .visible-lg {\n    display: none !important; }\n  .gm-styles .visible-xs-block,\n  .gm-styles .visible-xs-inline,\n  .gm-styles .visible-xs-inline-block,\n  .gm-styles .visible-sm-block,\n  .gm-styles .visible-sm-inline,\n  .gm-styles .visible-sm-inline-block,\n  .gm-styles .visible-md-block,\n  .gm-styles .visible-md-inline,\n  .gm-styles .visible-md-inline-block,\n  .gm-styles .visible-lg-block,\n  .gm-styles .visible-lg-inline,\n  .gm-styles .visible-lg-inline-block {\n    display: none !important; }\n  @media (max-width: 767px) {\n    .gm-styles .visible-xs {\n      display: block !important; }\n    .gm-styles table.visible-xs {\n      display: table !important; }\n    .gm-styles tr.visible-xs {\n      display: table-row !important; }\n    .gm-styles th.visible-xs,\n    .gm-styles td.visible-xs {\n      display: table-cell !important; } }\n  @media (max-width: 767px) {\n    .gm-styles .visible-xs-block {\n      display: block !important; } }\n  @media (max-width: 767px) {\n    .gm-styles .visible-xs-inline {\n      display: inline !important; } }\n  @media (max-width: 767px) {\n    .gm-styles .visible-xs-inline-block {\n      display: inline-block !important; } }\n  @media (min-width: 768px) and (max-width: 991px) {\n    .gm-styles .visible-sm {\n      display: block !important; }\n    .gm-styles table.visible-sm {\n      display: table !important; }\n    .gm-styles tr.visible-sm {\n      display: table-row !important; }\n    .gm-styles th.visible-sm,\n    .gm-styles td.visible-sm {\n      display: table-cell !important; } }\n  @media (min-width: 768px) and (max-width: 991px) {\n    .gm-styles .visible-sm-block {\n      display: block !important; } }\n  @media (min-width: 768px) and (max-width: 991px) {\n    .gm-styles .visible-sm-inline {\n      display: inline !important; } }\n  @media (min-width: 768px) and (max-width: 991px) {\n    .gm-styles .visible-sm-inline-block {\n      display: inline-block !important; } }\n  @media (min-width: 992px) and (max-width: 1199px) {\n    .gm-styles .visible-md {\n      display: block !important; }\n    .gm-styles table.visible-md {\n      display: table !important; }\n    .gm-styles tr.visible-md {\n      display: table-row !important; }\n    .gm-styles th.visible-md,\n    .gm-styles td.visible-md {\n      display: table-cell !important; } }\n  @media (min-width: 992px) and (max-width: 1199px) {\n    .gm-styles .visible-md-block {\n      display: block !important; } }\n  @media (min-width: 992px) and (max-width: 1199px) {\n    .gm-styles .visible-md-inline {\n      display: inline !important; } }\n  @media (min-width: 992px) and (max-width: 1199px) {\n    .gm-styles .visible-md-inline-block {\n      display: inline-block !important; } }\n  @media (min-width: 1200px) {\n    .gm-styles .visible-lg {\n      display: block !important; }\n    .gm-styles table.visible-lg {\n      display: table !important; }\n    .gm-styles tr.visible-lg {\n      display: table-row !important; }\n    .gm-styles th.visible-lg,\n    .gm-styles td.visible-lg {\n      display: table-cell !important; } }\n  @media (min-width: 1200px) {\n    .gm-styles .visible-lg-block {\n      display: block !important; } }\n  @media (min-width: 1200px) {\n    .gm-styles .visible-lg-inline {\n      display: inline !important; } }\n  @media (min-width: 1200px) {\n    .gm-styles .visible-lg-inline-block {\n      display: inline-block !important; } }\n  @media (max-width: 767px) {\n    .gm-styles .hidden-xs {\n      display: none !important; } }\n  @media (min-width: 768px) and (max-width: 991px) {\n    .gm-styles .hidden-sm {\n      display: none !important; } }\n  @media (min-width: 992px) and (max-width: 1199px) {\n    .gm-styles .hidden-md {\n      display: none !important; } }\n  @media (min-width: 1200px) {\n    .gm-styles .hidden-lg {\n      display: none !important; } }\n  .gm-styles .visible-print {\n    display: none !important; }\n  @media print {\n    .gm-styles .visible-print {\n      display: block !important; }\n    .gm-styles table.visible-print {\n      display: table !important; }\n    .gm-styles tr.visible-print {\n      display: table-row !important; }\n    .gm-styles th.visible-print,\n    .gm-styles td.visible-print {\n      display: table-cell !important; } }\n  .gm-styles .visible-print-block {\n    display: none !important; }\n    @media print {\n      .gm-styles .visible-print-block {\n        display: block !important; } }\n  .gm-styles .visible-print-inline {\n    display: none !important; }\n    @media print {\n      .gm-styles .visible-print-inline {\n        display: inline !important; } }\n  .gm-styles .visible-print-inline-block {\n    display: none !important; }\n    @media print {\n      .gm-styles .visible-print-inline-block {\n        display: inline-block !important; } }\n  @media print {\n    .gm-styles .hidden-print {\n      display: none !important; } }\n\n.gm-styles .GeoGebraFrame .collapse {\n  display: block; }\n\ndiv.gm-canvas {\n  background: white; }\n\n#gm-version-tag {\n  position: fixed;\n  right: 25px;\n  bottom: 5px;\n  font-size: 10px;\n  color: #aaa;\n  z-index: 10; }\n\n.gray_on_hover:hover {\n  background: rgba(0, 0, 0, 0.1); }\n\n.flex-container-columns {\n  display: -webkit-flex;\n  display: flex;\n  flex-direction: column;\n  -webkit-flex-direction: column;\n  position: relative; }\n\n.gm-fullscreen:fullscreen {\n  background-color: white;\n  width: 100%; }\n\n.gm-fullscreen:-webkit-full-screen {\n  background-color: white;\n  width: 100%; }\n\n.gm-fullscreen:-moz-full-screen {\n  background-color: white;\n  width: 100%; }\n\n.gm-fullscreen:-ms-fullscreen {\n  background-color: white;\n  width: 100%; }\n\n.gm-main-toolbar {\n  position: relative;\n  padding: 10px;\n  border-bottom: 1px solid silver;\n  background: #F5F5F5; }\n\n.gm-main-toolbar .btn-group {\n  margin-right: 4px; }\n\n.gm-main-toolbar .btn div {\n  text-align: center; }\n\n.gm-main-toolbar .btn span {\n  font-size: 12px; }\n\n.gm-main-toolbar .btn {\n  box-sizing: border-box;\n  min-width: 48px; }\n\n.gm-main-toolbar a {\n  color: #337ab7; }\n\n.gm-main-toolbar a:hover {\n  color: #23527c; }\n\n.gm-main-toolbar a span {\n  font-size: 14px;\n  color: inherit; }\n\n.gm-main-toolbar span {\n  font-size: 14px; }\n\n.gm-btn-fullscreen {\n  position: absolute;\n  width: 45px;\n  height: 45px;\n  background-color: #F5F5F5;\n  bottom: 40px;\n  right: 30px;\n  border-radius: 100%;\n  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.2), 0 1px 1px 0 rgba(0, 0, 0, 0.14), 0 2px 1px -1px rgba(0, 0, 0, 0.12);\n  cursor: pointer;\n  /* With these flex styles and the icon having \n    margin = auto, the icon will be centered */\n  display: flex;\n  justify-content: center;\n  flex-direction: column; }\n\ndiv.gm-math, div.gm-shadow, div.gm-smooshed {\n  user-select: none;\n  -webkit-font-smoothing: antialiased; }\n\n#gm-modal-container {\n  height: 0;\n  width: 0;\n  overflow: visible; }\n\n#gm-settings-modal .modal-body {\n  border-top: 1px solid #e5e5e5; }\n\n#gm-settings-modal .modal-body:first-child {\n  border-top: none; }\n\n#gm-settings-modal label {\n  font-weight: normal; }\n\n.gm-area {\n  position: absolute;\n  border-width: 1px;\n  border-style: solid;\n  box-sizing: border-box;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box; }\n\n.gm-area.gm-target {\n  border-color: lightpink; }\n\n.gm-area.gm-source {\n  border-color: steelblue; }\n\n.gm-area.gm-destination {\n  border-width: 2px;\n  border-color: steelblue;\n  background-color: skyblue; }\n\n.gm-area.gm-drop {\n  border-width: 2px;\n  border-color: steelblue;\n  background-color: skyblue; }\n\ndiv.gm-homework-play-btn {\n  position: absolute;\n  right: 25px;\n  top: 14px;\n  border: 1px solid transparent;\n  border-radius: 100%;\n  width: 1.7em;\n  height: 1.7em;\n  text-align: center;\n  line-height: 1.7em;\n  font-size: 1.5em;\n  background: lightskyblue;\n  color: white;\n  cursor: pointer; }\n\ndiv.gm-homework-play-btn:hover {\n  box-shadow: 2px 2px 4px 0px rgba(0, 0, 0, 0.5); }\n\n.gm-clear-after:after {\n  clear: both;\n  content: \'\';\n  display: table; }\n\n.gm-main-toolbar div.gm-menu-dropdown.open {\n  display: block;\n  position: absolute;\n  width: 500px;\n  padding: 5px;\n  margin: 0px;\n  margin-top: -5px;\n  margin-right: 10px;\n  right: 0px;\n  left: auto;\n  top: 100%;\n  font-size: 14px; }\n\n@media (max-width: 519px) {\n  div.gm-menu-dropdown.open {\n    width: 400px; } }\n\n@media (max-width: 419px) {\n  div.gm-menu-dropdown.open {\n    width: 300px;\n    margin-right: 2px; } }\n\ndiv.gm-menu-panel {\n  margin: 5px;\n  border: 1px solid silver; }\n\ndiv#gm-load-dropdown {\n  padding: 10px;\n  width: 400px;\n  max-height: 600px;\n  overflow-y: auto; }\n\n@media (max-width: 400px) {\n  div#gm-load-dropdown {\n    width: 300px; } }\n\n/* material design radio buttons */\n/* from https://codepen.io/hansmaad/pen/zBdzxp ; using https://www.sassmeister.com/ */\n@keyframes ripple {\n  0% {\n    box-shadow: 0px 0px 0px 1px transparent; }\n  50% {\n    box-shadow: 0px 0px 0px 20px rgba(0, 0, 0, 0.1); }\n  100% {\n    box-shadow: 0px 0px 0px 20px transparent; } }\n\n.md-radio {\n  margin: 16px 0; }\n\n.md-radio.md-radio-inline {\n  display: inline-block; }\n\n.md-radio input[type="radio"] {\n  display: none; }\n\n.md-radio input[type="radio"]:checked + label:before {\n  border-color: #337ab7;\n  animation: ripple 0.2s linear forwards; }\n\n.md-radio input[type="radio"]:checked + label:after {\n  transform: scale(1); }\n\n.md-radio p {\n  margin: 1rem;\n  color: #555; }\n\n.md-radio label {\n  display: inline-block;\n  height: 25px;\n  position: relative;\n  padding: 0 40px;\n  margin-bottom: 0;\n  cursor: pointer;\n  vertical-align: bottom;\n  line-height: 23px;\n  font-size: 18px;\n  font-family: \'Helvetica Neue\', Arial, sans-serif;\n  font-weight: 400; }\n\n.md-radio label:before, .md-radio label:after {\n  position: absolute;\n  content: \'\';\n  border-radius: 50%;\n  transition: all .3s ease;\n  transition-property: transform, border-color; }\n\n.md-radio label:before {\n  left: 0;\n  top: 0;\n  width: 25px;\n  height: 25px;\n  border: 2px solid rgba(0, 0, 0, 0.54); }\n\n.md-radio label:after {\n  top: 5px;\n  left: 5px;\n  width: 15px;\n  height: 15px;\n  transform: scale(0);\n  background: #337ab7; }\n\n.md-radio, .md-radio *, .md-radio *:before, .md-radio *:after {\n  box-sizing: border-box; }\n\n/* GM load menu */\ndiv#gm-load-dropdown div.gm-load-append {\n  text-align: right;\n  color: gray; }\n\ndiv#gm-load-dropdown div.gm-load-append label {\n  font-weight: 400; }\n\ndiv.gm-load .gm-load-list {\n  border: 1px solid silver;\n  border-radius: 4px; }\n\ndiv.gm-load .block {\n  display: flex;\n  justify-content: center;\n  user-select: none;\n  padding-left: 15px;\n  text-decoration: none;\n  background-color: white;\n  cursor: pointer;\n  padding: 10px;\n  border-bottom: 1px solid silver; }\n\ndiv.gm-load .block:hover {\n  background-color: whitesmoke; }\n\ndiv.gm-load .block:last-child {\n  border: none; }\n\ndiv.gm-load .block p {\n  flex-grow: 1;\n  margin: 0; }\n\nspan.gm-load-title {\n  font-size: 1.1em; }\n\nspan.gm-load-time {\n  font-size: 0.9em;\n  color: gray; }\n\nspan.gm-load-delete {\n  font-size: 1.6em;\n  line-height: 1.6em;\n  padding: 0.05em 0.5em 0 0.5em;\n  color: #aaa; }\n\nspan.gm-load-undo {\n  font-size: 1em;\n  border: 1px solid silver;\n  border-radius: 4px;\n  height: 2.2em;\n  margin-top: 0.3em;\n  line-height: 2em;\n  background: white; }\n\nspan.gm-load-delete:hover {\n  color: #a94442; }\n\nspan.gm-load-undo:hover {\n  color: #aaa;\n  background: #eee; }\n\ndiv.gm-help .block {\n  user-select: none;\n  padding-left: 15px;\n  text-decoration: none;\n  display: table;\n  background-color: white;\n  cursor: pointer; }\n\ndiv.gm-help .block span {\n  display: table-cell;\n  vertical-align: middle; }\n\ndiv.gm-help .block:nth-child(even) {\n  background-color: whitesmoke; }\n\ndiv.share_link {\n  border: 1px solid #dcdcdc;\n  padding: 8px 4px;\n  margin-bottom: 10px; }\n\ndiv.share_link input {\n  width: 100%;\n  border: none;\n  box-shadow: none;\n  color: #777;\n  font-size: 14px;\n  height: 16px;\n  line-height: 16px;\n  margin: 0;\n  outline: none;\n  overflow: auto;\n  padding: 0;\n  resize: none;\n  vertical-align: middle;\n  white-space: pre;\n  width: 100%; }\n\n.input-xs {\n  padding: 2px 8px;\n  font-size: 12px;\n  line-height: 1.4em;\n  border-radius: 3px; }\n\n/* Mimic styling for bootstrap modal backdrops */\n.modal-backdrop {\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  z-index: 1040;\n  background-color: #000; }\n\n.modal-backdrop.fade {\n  filter: alpha(opacity=0);\n  opacity: 0; }\n\n.modal-backdrop.in {\n  filter: alpha(opacity=50);\n  opacity: .5; }\n\n/** for older GM versions only */\n.graph .axis {\n  stroke: black;\n  shape-rendering: crispEdges;\n  opacity: 0.4; }\n\n.graph .axis text {\n  fill: black;\n  stroke: none;\n  font-size: 10px;\n  font-family: \'Lato\', sans-serif; }\n\nsvg text {\n  -webkit-font-smoothing: antialiased;\n  -webkit-user-select: none; }\n\n.graph .line {\n  stroke-width: 2.5px; }\n\n.graph .border {\n  stroke: #ddd;\n  shape-rendering: crispEdges;\n  fill: none; }\n\n#gm-canvas-css-finished-loading {\n  display: none; }\n\n.gm-ggb-element-drop-target-adorner {\n  position: absolute;\n  left: 0px;\n  top: 0px;\n  width: 100%;\n  height: 100%;\n  border: 2px solid rgba(70, 130, 180, 0.5);\n  background-color: rgba(135, 206, 235, 0.5);\n  /* One above the z-index of something that matches the selector ".GeoGebraFrame .flatButton," which selector is in GGB\'s CSS code.\n    Using a z-index less than this will result in the dragend event of the derivation row handle to not fire when attempting to drop\n    a handle onto parts of a GGB widget with a greater z-index. */\n  z-index: 61; }\n\n.gm-center-flex-container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center; }\n\n.lds-dual-ring {\n  display: flex;\n  width: 64px;\n  height: 64px; }\n\n.lds-dual-ring:after {\n  content: " ";\n  display: block;\n  width: 46px;\n  height: 46px;\n  margin: 1px;\n  border-radius: 50%;\n  border: 5px solid black;\n  border-color: black transparent black transparent;\n  animation: lds-dual-ring 1.2s linear infinite; }\n\n@keyframes lds-dual-ring {\n  0% {\n    transform: rotate(0deg); }\n  100% {\n    transform: rotate(360deg); } }\n',""])},function(t,e,n){var i=n(161);"string"==typeof i&&(i=[[t.i,i,""]]);n(28)(i,{hmr:!0,transform:void 0,insertInto:void 0}),i.locals&&(t.exports=i.locals)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(82);Object.defineProperty(e,"AppSetting",{enumerable:!0,get:function(){return(t=i,t&&t.__esModule?t:{default:t}).default;var t}});var r=n(83);Object.defineProperty(e,"showUserSettingsModal",{enumerable:!0,get:function(){return r.showUserSettingsModal}})},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.trialLogger=void 0;var i=n(0),r=n(17),o=n(7);function s(){this.id=(0,o.uid)(),this.trial=null,this.active_trials=[],this.events=t.dispatch("start_trial","end_trial"),this.experiment_id=null,r.user.events.on("login."+this.id,this.onUserEvent.bind(this)),r.user.events.on("logout."+this.id,this.onUserEvent.bind(this))}s.prototype.onUserEvent=function(t){i.gmath.ServerComm&&i.gmath.ServerComm.postInteractions([{type:"user",subtype:t.type,time:Date.now(),user_id:t.user.user_id,trial_id:this.trial&&this.trial.id}])};var a=e.trialLogger=new s;i.gmath.TrialLogger=a,s.prototype.addTrial=function(t,e){var n={id:i.gmath.uid(),idx:t||0,gm_version:i.gmath.version,gm_ui_version:i.gmath.ui.version,gm_ui_gm_version:i.gmath.ui.gm_version,experiment_id:this.experiment_id,user_id:r.user.logged_in?r.user.user_id:null,time:Date.now()};return i.gmath.extend(n,e),this.active_trials.push(n),n},s.prototype.startTrial=function(t,e){this.trial&&this.endTrial();var n=this.addTrial(t,e);this.trial=n,this.events.start_trial(n)},s.prototype.setCustomFields=function(t){i.gmath.extend(this.trial,t)},s.prototype.endTrial=function(t){this.trial.duration=Date.now()-this.trial.time,t&&this.setCustomFields(t),this.events.end_trial(this.trial),this.postTrial(this.trial),i.gmath.array.remove(this.active_trials,this.trial),this.trial=null},s.prototype.resumeTrial=function(t){this.trial=i.gmath.find(this.active_trials,function(e){return e.id===t}),this.events.start_trial(this.trial)},s.prototype.postTrial=function(){i.gmath.ServerComm&&i.gmath.ServerComm.postTrial(this.trial)},s.prototype.postAllTrials=function(){i.gmath.ServerComm&&i.gmath.ServerComm.postTrial(this.active_trials),this.active_trials=[]}}).call(this,n(6))},function(t,e,n){"use strict";(function(t){n(0).gmath.svg_play_button=function(){var e,n,i,r,o,s=t.dispatch("click"),a=!1,l=function t(n){return e=n,t.init(),t};return l.hidden=function(t){return 0===arguments.length?a:(a=t,r&&r.style("display",a?"none":null),o&&o.attr("opacity",0),this)},l.remove=function(){i&&i.remove()},l.init=function(){n=e.node().getBoundingClientRect(),i=e.append("svg").attr("id","button").attr("width","100%").attr("height","100%").attr("cursor","pointer"),(r=i.append("g").style("display",a?"none":null).attr("transform","translate("+[n.width/2,n.height/2]+")")).append("rect").attr({x:-n.width/2,y:-n.height/2,width:n.width,height:n.height}).attr({fill:"black",opacity:.1}),r.append("circle").attr({r:"35px"}).attr({fill:"#666",stroke:"white","stroke-width":"4px","fill-opacity":.6}),r.append("circle").attr({r:"37px"}).attr({fill:"none",stroke:"silver","stroke-width":1.5}),r.append("path").attr("d","M0,0 L0,1 L0.8,0.5 Z").attr("transform","scale(40)translate(-0.3,-0.5)").attr("fill","white"),o=i.append("rect").classed("overlay",!0).attr({width:n.width,height:n.height}).attr({fill:"black",opacity:0}).attr("pointer-events","all").on("mouseover",function(){o.attr("opacity",a?0:.1)}).on("mouseout",function(){o.attr("opacity",0)}).on("click",function(){a||s.click()})},t.rebind(l,s,"on")}}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.serverComm=void 0;var i=n(0);function r(){this.posting=!1,this.log_to_console=!1,this.trial_collection=null,this.data_collection=null,this.server_url="https://graspablemath.com:7010"}var o=e.serverComm=new r;i.gmath.ServerComm=o,i.gmath.setupLogging=function(t){t||(t={}),i.gmath.ServerComm.setExperimentID(t.experiment_id),i.gmath.ServerComm.setEnabled("enabled"in t?t.enabled:"auto"),t.server&&i.gmath.ServerComm.setServerUrl(t.server),i.gmath.ServerComm.log_to_console=t.log_to_console},i.gmath.sendErrorReport=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(console.warn("error:",t,e),i.gmath.ServerComm.posting)if("string"==typeof t)if("string"==typeof e)if(i.gmath.ServerComm.dataIsTooBig(t+e))console.warn("Data chunk size is too big: not saved.");else{var n=i.gmath.TrialLogger&&i.gmath.TrialLogger.trial&&i.gmath.TrialLogger.trial.id;i.gmath.ServerComm.sendXHR(i.gmath.ServerComm.server_url+"/error_report",JSON.stringify({trial_id:n,description:t,context:e}))}else console.error("Invalid error context type.");else console.error("Invalid error description type.")},r.prototype.setExperimentID=function(t){if("string"!=typeof t)throw"Invalid experiment ID.";if(!t.match(/^\w+$/))throw"Invalid experiment ID.";this.trial_collection=t+"_trials",this.data_collection=t+"_data",i.gmath.TrialLogger.experiment_id=t},r.prototype.setServerUrl=function(t){this.server_url=t},r.prototype.setEnabled=function(t){this.posting=!!t&&("auto"!==t||!window||!window.gmath_log_ga||gmath_log_ga.enabled()),console.info("interaction logging is",this.posting?"on":"off")},r.prototype.postTrial=function(t){this.postToServer(this.trial_collection,t)},r.prototype.postInteractions=function(t){this.postToServer(this.data_collection,t)},r.prototype.postToServer=function(t,e){if(this.log_to_console&&console.log("logging",e),this.posting){var n=JSON.stringify(e);this.dataIsTooBig(n)?console.warn("Data chunk size is too big: not saved."):this.sendXHR(this.server_url+"/log/"+t,n)}},r.prototype.sendXHR=function(t,e){var n=new XMLHttpRequest;n.open("POST",t),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=function(){4==n.readyState&&n.status,4==n.readyState&&n.status},n.send(e)},r.prototype.dataIsTooBig=function(t){return i.gmath.byteLength(t)>5e4}},function(t,e,n){"use strict";(function(t){var e=n(0),i=n(5);function r(e,n){this.event_log=e,this.dl=null,this.other_dl=null,this.div=t.select(n),this.stop_timer=!1}e.gmath.GMEventRecorder=r,r.prototype.showPreview=function(){var t=e.gmath.extend({},this.event_log.options);t.interactive=!1,this.dl&&this.dl.removeElement(),this.dl=new e.gmath.Derivation(null,this.div.node(),t)},r.prototype.replay=function(n,r,o){this.event_log.gm_options&&e.gmath.object.extend(e.gmath.options.actions,this.event_log.gm_options);var s=this;if(this.event_log){var a=void 0,l=void 0,u=this.event_log.events;u.length>0&&(l=o||u[0].time,a=0),this.stop_timer=!1,this.dl&&this.dl.removeElement();var c=e.gmath.object.extend({only_synchronous_actions:!0},this.event_log.options);this.dl=new e.gmath.Derivation(null,this.div.node(),c,function(){s.event_log.events.length>0&&t.timer(d,n||0)})}else console.warn("set the event log before replaying!");function d(t){var e=s.dl.getLastView();if(s.stop_timer)return!0;for(;u[a].time-l<t;){if(u[a+1]&&u[a+1].fromKbd){l=u[a+1].time-t-1e3;var n="...",o=u[a+1].fromKbd;i.AlgebraModel.isParsable(o)&&(n=new i.AlgebraModel(o).to_ascii()),s.showFromKbd(n)}var c=u[a];if(c.action&&c.followup&&u[a+1]&&c.followup===u[a+1].action&&(c=u[++a]),c.action?e.model.to_ascii()!==c.newTree&&(s.triggerDelayedAction(e,c.action)&&e.model.to_ascii()===c.newTree?console.info("Triggered delayed action."):(c.fromKbd||console.warn(c,"Replay out of synch, forcing correct state. Expected: "+c.newTree+"; Actual: "+e.model.to_ascii()),s.abortCurrentStateAndResetInteraction(e,c.newTree))):("touch"!==c.type||c.finger||(c.finger=c.fingers[c.fingers.length-1]),e.interaction_handler["on_"+c.type](c),"keyup"===c.type&&s.updateKey(c.keyCode,!1),"keydown"===c.type&&s.updateKey(c.keyCode,!0)),++a===u.length)return r(),!0}}},r.prototype.triggerDelayedAction=function(t,n){var i=t.interaction_handler.active_handler;if(!(i&&i instanceof e.gmath.DragHandler))return!1;for(var r=0;r<i.actions.length;r++){var o=i.actions[r];return o.name===n&&!!o.timeoutID&&(i.clearActionTimeout(o),i.performAction(o),!0)}return!1},r.prototype.abortCurrentStateAndResetInteraction=function(t,e){t.model.parseAndSet(e),t.interaction_handler.abort_interaction(),t.bindToModel(t.model),t.enter_and_exit(!0,"both")},r.prototype.updateKey=function(t,e){console.log(t);var n=this.div.select("#key"+t);0===n.size()&&(n=this.div.append("span").attr("id","key"+t).classed("key-vis",!0).style("opacity",1e-5).style({position:"absolute",bottom:"5px",right:"10px",padding:"1px 7px",border:"2px solid steelblue","border-radius":"10px",color:"steelblue",background:"white"}).text({32:"space",16:"shift"}[t]||"")),e?n.style("opacity",1):n.transition().duration(750).style("opacity",1e-5)},r.prototype.hideKbd=function(){this.div.select("#fromKbd")},r.prototype.showFromKbd=function(t){var e=this.div.select("#fromKbd");0===e.size()&&(e=this.div.append("span").attr("id","fromKbd").classed("key-vis",!0).style("opacity",1).style({position:"absolute",bottom:"5px",right:"10px",padding:"1px 7px",border:"2px solid steelblue","border-radius":"10px",color:"steelblue",background:"white"})),e.text(t).style("opacity",1),setTimeout(function(){return e.transition().duration(750).style("opacity",1e-5)},1e3)},r.prototype.stop_animation=function(){this.stop_timer=!0},r.prototype.createAndRecordDL=function(t,n){var i=new e.gmath.Derivation(null,t,n);this.recordDL(i)},r.prototype.recordDL=function(t){this.event_log={options:e.gmath.object.extendChanged({},t.options,e.gmath.Derivation.defaultOptions),gm_options:e.gmath.options.actions,events:[]},console.log("add action blacklist here"),console.log("think"),this.event_log.options.action_blacklist=[],this.dl=t;var n=this.dl.getLastView(),i=this.log.bind(this);this.registerListeners(n,i);var r=this;return t.options.no_history?t.getLastModel().events.on("change",r.logAction.bind(this)):t.events.on("added_line",function(e){r.logAction(e),t.getLastView()!==n&&(n=t.getLastView(),r.registerListeners(n,i))}),this.event_log},r.prototype.liveReplay=function(t,n){this.other_dl=new e.gmath.Derivation(null,t,n)},r.prototype.log=function(t){this.event_log.events.push(t),this.other_dl&&this.other_dl.getLastView().interaction_handler["on_"+t.type](t)},r.prototype.logAction=function(t){t&&this.event_log.events.push({type:"action",action:t.action.name,followup:!!t.action.followup&&t.action.followup.name,fromKbd:!!t.action.latex&&t.action.latex,newTree:t.action.newTree.to_ascii(),time:Date.now()})},r.prototype.registerListeners=function(t,e){t.interaction_handler.events.on("touch",e).on("release",e).on("drag_start",e).on("drag",e).on("drag_end",e).on("tap",e).on("dbltap",e).on("keydown",e).on("keyup",e)},e.gmath.EventRecorder=r}).call(this,n(6))},function(t,e,n){"use strict";(function(t){var e=n(0);function i(t,n){this.id=e.gmath.uid(),t&&t.version!==e.gmath.version&&(console.warn("Incompatible versions!"),console.info("Recorded data gmath version:",t.version),console.info("Current gmath version:",e.gmath.version)),this.event_log=t||{},this.container=n,this.ignore_custom_events_during_playback=!0,this.ajust_time_of_next_event=!0,this.event_dt=0}e.gmath.CanvasEventRecorder=i,i.prototype.startRecording=function(){this.event_log.initial_event_count=this.event_log.events.length,this.setupListeners()},i.prototype.adjustTimeOfNextEvent=function(t){this.ajust_time_of_next_event=t},i.prototype.createAndRecordCanvas=function(t,n){if(arguments.length<2)throw"(CanvasEventRecorder) Please provide instantiation arguments for the canvas.";this.container=t,this.canvas=new e.gmath.Canvas(t,n),e.gmath.extend(this.event_log,{version:e.gmath.version,options:n,events:[],ccontrollerID:this.canvas.controller.id}),this.startRecording()},i.prototype.setUserOptions=function(t,e){this.event_log||(this.event_log={}),this.event_log.userOptions||(this.event_log.userOptions={}),this.event_log.userOptions[t]=e},i.prototype.extendClassesWithUserOptions=function(){var t=this.event_log.userOptions;if(t)for(key in t)e.gmath.extend(e.gmath[key].defaultOptions,t[key])},i.prototype.initProgressBar=function(){return this.canvas.container.style("position","relative"),this.canvas.container.append("div").style({position:"absolute",bottom:0,width:"0%",background:"steelblue",height:"5px",opacity:.5})},i.prototype.replay=function(e,n){var i=this;if(this.canvas||this.init(),this.event_log.events.length>0){var r=function(t){for(o.style("width",Math.min(100,(t+i.time_skip)/u*100).toFixed(4)+"%");i.ignore_custom_events_during_playback&&"custom-event"===s[l].type||s[l].time-a<t+i.time_skip;)if((l=i.evaluateEvent(s,l))===s.length)return i.canvas.controller.disableKeyboard(!1),n&&n(),o.transition().remove(),!0},o=this.initProgressBar();this.canvas.controller.disableKeyboard(!0);var s=this.event_log.events,a=s[0].time,l=0;this.time_skip=0;var u=s[s.length-1].time-a;setTimeout(function(){a=s[l].time,t.timer(r,e||0)},10)}else this.canvas.controller.disableKeyboard(!1),n&&n()},i.prototype.init=function(){this.canvas&&(this.canvas.tools.remove(),this.canvas.svg.remove(),this.canvas=null),this.canvas=new e.gmath.Canvas(this.container,this.event_log.options),this.extendClassesWithUserOptions(),this.canvas.controller.id=this.event_log.ccontrollerID,this.event_log.initial_event_count=this.event_log.events.length},i.prototype.addEvent=function(t){if(this.ajust_time_of_next_event){this.ajust_time_of_next_event=!1;var e=this.event_log.events[this.event_log.events.length-1];this.event_dt=e?-t.time+e.time:-t.time}t.time+=this.event_dt,t.selection&&delete t.selection,t.target&&delete t.target,this.event_log.events.push(t)},i.prototype.evaluateEvent=function(t,e){return"custom-event"===t[e].type?++e:this.eventIsAnInteraction(t[e])?this.performInteraction(t,e):"create"===t[e].type||"remove"===t[e].type||"graphElementCreate"===t[e].type||"graphElementRemove"===t[e].type?this.performCheckpoint(t,e):++e},i.prototype.eventIsAnInteraction=function(t){return t.performee},i.prototype.performInteraction=function(t,e){return this.getPerformeeFn(t[e].performee_type)(t,e)},i.prototype.getPerformeeFn=function(t){if("Toolbar"===t)return this.simulateInteractionOnToolbar.bind(this);if("CanvasController"===t)return this.simulateInteractionOnCanvasController.bind(this);if("CanvasModelView"===t)return this.simulateModeSwitch.bind(this);if("DL"===t||"row"===t)return this.simulateInteractionOnDL.bind(this);if("graph"===t)return this.simulateInteractionOnGraph.bind(this);if("AM"===t)return this.simulateInteractionOnAlgebraModel.bind(this);throw"(CanvasEventRecorder) Performee type of event does not match recognized object type."},i.prototype.simulateInteractionOnToolbar=function(t,e){return this.canvas.onButton(t[e].button),++e},i.prototype.simulateInteractionOnCanvasController=function(t,n){var i=t[n];if("keyboard"===i.type){for(var r=n,o=t[r];r<t.length&&"enteredTerm"!==o.type;)o=t[++r];r!==t.length&&(this.time_skip+=o.time-i.time)}else"enteredTerm"===i.type?this.canvas.model.createDL(e.gmath.deepCopy(i.options)):"enteredGraph"===i.type||("fontSize"===i.type?this.canvas.controller.set_font_size(i.font_size):this.getObjectByID(i.performee)[i.subtype+"_"+i.type](i));return++n},i.prototype.simulateInteractionOnDL=function(t,e){var n=t[e],i=this.getObjectByID(n.performee);return"Clone"!==n.type&&"packState"!==n.type&&("row"===n.performee_type?i.rows[n.row][""+n.type.toLowerCase()](n):i[""+n.type.toLowerCase()](n)),++e},i.prototype.simulateInteractionOnGraph=function(t,e){var n=t[e],i=this.getObjectByID(n.performee);if("zoom"===n.type)i.replayZoom(n);else if("moveTouch"===n.type)i.deleteMove();else if("resize"===n.type)"touch"===n.resize_type?i.resize_touch(n):"drag"===n.resize_type?i.resize(n):"release"===n.resize_type&&i.resize_release(n);else if("mouseLocation"===n.type)"in-main"===n.location?i.showMove():"out-main"===n.location?i.hideMove():i.withinGrid(n);else if("linkStart"===n.type||"linkDrag"===n.type||"linkEnd"===n.type){var r=i.getGeomByID(n.object);"linkStart"===n.type?r.startLinking(n):"linkDrag"===n.type?r.linking(n):"linkEnd"===n.type&&r.endLinking(n)}else i[""+n.type](n);return++e},i.prototype.simulateInteractionOnAlgebraModel=function(t,e){var n=t[e];return this.getObjectByID(n.performee).rows[n.row].view.interaction_handler["on_"+n.type](n),++e},i.prototype.simulateModeSwitch=function(t,e){var n=t[e];return this.getObjectByID(n.performee).switchMode(),++e},i.prototype.performCheckpoint=function(t,e){return this.getCheckpointFn(t[e].type)(t,e)},i.prototype.getCheckpointFn=function(t){if("create"===t)return this.checkCreation.bind(this);if("action"===t)return this.checkAction.bind(this);if("undone"===t)return this.checkUndo.bind(this);if("redone"===t)return this.checkRedo.bind(this);if("newPosition"===t)return this.checkPosition.bind(this);if("packState"===t)return this.checkPacking.bind(this);if("remove"===t)return this.checkDeletion.bind(this);if("graphElementCreate"===t||"graphElementRemove"===t)return this.checkGraphContents.bind(this);if("graphElementChange"===t)return this.checkGraphElementAttributes.bind(this);if("mode"===t)return this.checkMode.bind(this);throw"(CanvasEventRecorder) That checkpoint is not recognized."},i.prototype.checkCreation=function(t,e){var n=t[e],i=this.canvas.model.getElementsOfType(n.object_type);if(!i)throw"(CanvasEventRecorder) Unknown object type";var r=i.filter(function(t){return!t.is_accounted_for});if(1!==r.length)throw"(CanvasEventRecorder) Could not identify new object to set ID";return r[0].is_accounted_for=!0,r[0].id=n.object_id,"link"===t[e].object_type&&this.checkExistenceOfLinkedObjects(r[0]),++e},i.prototype.originOfDL=function(t,e){return!("enteredTerm"!==t.type||!t.dl_id||t.dl_id!==e.id)||!("Clone"!==t.type||!t.dl_id||t.dl_id!==e.id)},i.prototype.getUnidentifiedGraph=function(){var t=this.canvas.model.getElementsOfType("graph");return t[t.length-1]},i.prototype.checkExistenceOfLinkedObjects=function(t){this.getObjectByID(t.a().id),this.getObjectByID(t.b().id)},i.prototype.checkAction=function(t,e){var n=t[e],i=this.getObjectByID(n.dl_id);return setTimeout(function(){var t=i.getLastRow();if(t.model.to_ascii()!==n.newTree||t.action.name!==n.action&&"(DL) row added from model (only redo)"!==n.action)throw"FF to next keyframe."},n.delay?n.delay:0),++e},i.prototype.checkUndo=function(t,e){var n=t[e];if("create_dl"===n.actionType)return this.checkDeletion(t,e);if("math"===n.actionType){var i=this.getObjectByID(n.id);if(i.rows.length!==n.numberOfRows||i.getLastModel().to_ascii()!==n.lastExpression)throw"FF to next keyframe."}return++e},i.prototype.checkRedo=function(t,e){var n=t[e];if("create_dl"===n.actionType)try{this.getObjectByID(n.id)}catch(t){throw"(CanvasEventRecorder) Object on the canvas with that id was not found"===t?"FF to next keyframe.":t}else if("math"===n.actionType){var i=this.getObjectByID(n.id);if(i.rows.length!==n.numberOfRows||i.getLastModel().to_ascii()!==n.lastExpression)throw"FF to next keyframe."}return++e},i.prototype.checkPosition=function(t,e){var n=t[e],i=this.getObjectByID(n.id);if("DL"===n.object_type){if(i.pos[0]!==n.pos[0]||i.pos[1]!==n.pos[1])throw"FF to next keyframe."}else if("graph"===n.object_type){if(i.pos.x!==n.pos.x||i.pos.y!==n.pos.y)throw"FF to next keyframe.";if(i.size.width!==n.size.width||i.size.height!==n.size.height)throw"FF to next keyframe."}return++e},i.prototype.checkPacking=function(t,e){var n=t[e],i=this.getObjectByID(n.id);if(n.packState.length!==i.rows.length)throw"FF to next keyframe.";for(var r=0;r<i.rows.length;r++)if(i.rows[r].hidden!==n.packState)throw"FF to next keyframe.";return++e},i.prototype.checkDeletion=function(t,e){var n=t[e];try{this.getObjectByID(n.id)}catch(o){if("(CanvasEventRecorder) Object on the canvas with that id was not found"===o){if("dl"===n.object_type||"graph"===n.object_type){for(var i=e+1,r=t[i];r&&r.performee&&r.performee===n.object_id||r&&r.object_id&&r.object_id===n.object_id;)r=t[++i];return i}return++e}throw o}throw"FF to next keyframe."},i.prototype.checkGraphContents=function(t,e){var n=t[e],i=this.getObjectByID(n.graph_id);if("graphElementCreate"===n.type)return i.geoms[i.geoms.length-1].id=n.object_id,++e;if("graphElementRemove"===n.type){for(var r=0;r<i.geoms.length;r++)if(i.geoms[r].id===n.object_id)throw"FF to next keyframe.";return++e}},i.prototype.checkGraphElementAttributes=function(t,e){for(var n,i=t[e],r=this.getObjectByID(i.graph_id),o=i.object_id,s=0;s<r.geoms.length;s++){var a=r.geoms[s];a.id===o&&(n=a)}if("point"===n.type){if(n.pos.x!==i.point_a.x||n.pos.y!==i.point_a.y)throw"FF to next keyframe."}else if("point-slope"===n.type){if(n.point.pos.x!==i.point_a.x||n.point.pos.y!==i.point_a.y||n.slope!==i.slope)throw"FF to next keyframe."}else if("point-point"===n.type){if(n.point_a.pos.x!==i.point_a.x||n.point_a.pos.y!==i.point_a.y||n.point_b.pos.x!==i.point_b.x||n.point_b.pos.y!==i.point_b.y)throw"FF to next keyframe."}else if("slope-intercept"===n.type&&(n.intercept.pos.x!==i.point_a.x||n.intercept.pos.y!==i.point_a.y||n.slope!==i.slope))throw"FF to next keyframe.";return++e},i.prototype.checkMode=function(t,e){var n=t[e];if(this.canvas.model.mode()!==n.mode)throw"FF to next keyframe.";return++e},i.prototype.getObjectByID=function(t){var e=this.canvas.model,n=e.dls().concat(e.getElementsOfType("graph")).concat(e.links());n.push(this.canvas.controller);for(var i=0;i<n.length;i++)if(n[i].id===t)return n[i];throw"(CanvasEventRecorder) Object on the canvas with that id was not found"},i.prototype.getRowIDXByInteractionHandlerID=function(t,e){for(var n=0;n<t.rows.length;n++)if(t.rows[n].view.interaction_handler.uid===e)return n;throw"(CanvasEventRecorder) Interaction-handler with that ID not found in derivation list."},i.prototype.setupListeners=function(){this.registerToolbarListeners(this.canvasToolbarListener.bind(this)),this.registerCanvasModelListeners(this.canvasModelViewListener.bind(this)),this.registerCanvasControllerListeners(this.canvasControllerListener.bind(this)),self=this,this.canvas.model.dls().forEach(function(t){self.setupListenersOnDL(t)}),this.canvas.model.getElementsOfType("graph").forEach(function(t){self.setupListenersOnGraph(t)}),this.canvas.model.links().forEach(function(t){self.setupListenersOnLink(t)})},i.prototype.canvasToolbarListener=function(t){t=e.gmath.extend(t,{type:"button",performee:this.canvas.id,performee_type:"Toolbar"}),this.addEvent(t)},i.prototype.canvasModelViewListener=function(t){"mode"===t.type?this.modeChangeDetected(t):"create"===t.type?this.objectCreationDetected(t):"remove"===t.type&&this.objectDeletionDetected(t)},i.prototype.canvasControllerListener=function(t){"undone"===t.type||"redone"===t.type?this.undoRedoDetected(t):this.addEvent(t)},i.prototype.registerToolbarListeners=function(t){this.canvas.events.on("button."+this.id,t)},i.prototype.registerCanvasModelListeners=function(t){this.canvas.model.on("create."+this.id,t).on("remove."+this.id,t).on("active_tool."+this.id,t)},i.prototype.registerCanvasControllerListeners=function(t){this.canvas.controller.on("undone."+this.id,t).on("redone."+this.id,t).on("hold."+this.id,t).on("touch."+this.id,t).on("drag."+this.id,t).on("release."+this.id,t).on("font_size."+this.id,t).on("keyboard."+this.id,t).on("entered_term."+this.id,t)},i.prototype.modeChangeDetected=function(t){var e={type:"mode"};e.mode=t.mode,e.time=Date.now(),this.addEvent(e)},i.prototype.objectCreationDetected=function(t){if("dl"===t.target_type||"graph"===t.target_type||"link"===t.target_type){"dl"===t.target_type?this.setupListenersOnDL(t.target):"graph"===t.target_type?this.setupListenersOnGraph(t.target):"link"===t.target_type&&this.setupListenersOnLink(t.target),console.log(t);var n={type:"create"};n.time=Date.now(),n.object_id=t.target.id,n.object_type=t.target_type,"dl"!==t.target_type&&"graph"!==t.target_type||(n.object_options=e.gmath.deepCopy(t.target.options)),this.addEvent(n)}},i.prototype.objectDeletionDetected=function(t){var e={type:"remove"};e.time=Date.now(),e.object_id=t.target.id,e.object_type=t.target_type,this.addEvent(e)},i.prototype.undoRedoDetected=function(t){var e={};e.type=t.type,e.time=Date.now(),"create_dl"===t.action.type?(e.actionType=t.action.type,e.object_id=t.action.dl.id):"math"===t.action.type&&(e.actionType=t.action.type,e.object_id=t.action.dl.id,e.lastExpression=t.action.dl.getLastModel().to_ascii(),e.numberOfRows=t.action.dl.rows.length),this.addEvent(e)},i.prototype.setupListenersOnDL=function(t){var e=this.DLTransformListener.bind(this);this.registerListenersOnDLTransformEvents(t,e);var n=this.DLRowListener.bind(this);this.registerListenersOnDLRowEvents(t,n),this.setupListenersOnInteractionHandlers(t)},i.prototype.DLTransformListener=function(t){this.addEvent(t)},i.prototype.DLRowListener=function(t){if("packState"===t.type){var e={};e.type=t.type,e.time=t.time,e.object_id=t.performee,e.object_type="row",e.packState=t.packState,this.addEvent(e)}else this.addEvent(t)},i.prototype.registerListenersOnDLTransformEvents=function(t,e){t.dl_events.on("drag",e).on("touch",e).on("release",e).on("hold",e)},i.prototype.registerListenersOnDLRowEvents=function(t,e){t.row_events.on("drag",e).on("touch",e).on("tap",e).on("release",e).on("clone",e).on("pack_state",e)},i.prototype.setupListenersOnInteractionHandlers=function(t){for(var n=this,i=function(i){i=e.gmath.extend(i,{performee_type:"AM",performee:t.id,row:n.getRowIDXByInteractionHandlerID(t,i.performee)}),n.addEvent(i)},r=0;r<t.rows.length;r++)this.registerListenersOnInteractionHandler(t.rows[r].view,i);t.events.on("added_line",function(e){if(1!==t.rows.length){n.logAction(e);var r=t.rows[t.rows.length-2].view;n.registerListenersOnInteractionHandler(r,i);var o=t.getLastView();n.registerListenersOnInteractionHandler(o,i)}})},i.prototype.registerListenersOnInteractionHandler=function(t,e){t.interaction_handler.events.on("touch",e).on("release",e).on("drag_start",e).on("drag",e).on("drag_end",e).on("tap",e).on("keydown",e).on("keyup",e)},i.prototype.setupListenersOnGraph=function(t){var e=this.graphListener.bind(this);this.registerListenersOnGraph(t,e)},i.prototype.graphListener=function(t){if("graphElementCreate"===t.type||"graphElementRemove"===t.type)(n={}).type=t.type,n.time=t.time,n.object_id=t.performee,n.object_type=t.performee_type,n.graph_id=t.graph_id,t=n;else if("graphElementChange"===t.type){var n,i,r,o;(n={}).type=t.type,n.time=t.time,n.object_id=t.performee,n.graph_id=t.graph_id;var s=t.performee_object;"point"===s.type&&s.line&&(s=s.line,n.id=s.id),"point"===s.type?i=e.gmath.deepCopy(s.pos):"point-slope"===s.type?(i=e.gmath.deepCopy(s.point.pos),o=s.slope):"point-point"===s.type?(i=e.gmath.deepCopy(s.point_a.pos),r=e.gmath.deepCopy(s.point_b.pos)):"slope-intercept"===s.type&&(i=e.gmath.deepCopy(s.intercept.pos),o=s.slope),n.point_a=i,n.point_b=r,n.slope=o,t=n}else if("linkStart"===t.type||"linkDrag"===t.type||"linkEnd"===t.type){var a={};a.type=t.type,a.time=t.time,a.performee=t.graph_id,a.performee_type="graph",a.object=t.performee,a.object_type=t.performee_type,a.finger=t.finger,t=a}this.addEvent(t)},i.prototype.registerListenersOnGraph=function(t,e){t.events.on("move_touch",e).on("move",e).on("touch",e).on("drag",e).on("hold",e).on("release",e).on("zoom",e).on("resize",e).on("create_geom",e).on("remove_geom",e).on("geom_attr",e).on("mouse_location",e).on("link_start",e).on("link_drag",e).on("link_end",e)},i.prototype.setupListenersOnLink=function(t){},i.prototype.logAction=function(t){this.addEvent({type:"action",action:t.action.name,dl_id:t.senderDL_id,newTree:t.action.newTree.to_ascii(),delay:t.action.delay,time:Date.now()})},i.prototype.clearEventLogRetainSimpleObjects=function(){var t=this.getSimpleObjectsFromCanvas();this.event_log.events=[];for(var e=0;e<t.length;e++){var n=t[e],i=n instanceof Derivation?"dl":"graph";this.addEvent({type:"create",time:-1,performee_type:i,performee:n.id,object_options:n.options})}},i.prototype.captureInitialState=function(){this.event_log.options.initialState=this.canvas.serialize(),this.event_log.events=[]},i.prototype.remove=function(){this.canvasComponents&&(this.canvasComponents.svg.remove(),this.canvasComponents=null)}}).call(this,n(6))},function(t,e,n){"use strict";(function(t){var e=n(0),i=n(5);function r(t){t.selectAll(".gm-main-toolbar button span").style("font-size","12px"),t.selectAll(".gm-main-toolbar button br").style("font-size","12px")}e.gmath.gmifyPage=function(n,o){o=o||{},coordinator=new DLCoordinator;var s=n?t.select(n):t.select("body"),a=s.size()>0&&s.classed("gmify-canvas")?s:s.selectAll(".gmify-canvas");a.each(function(){var n=t.select(this),o=n.text().split(";");try{o.forEach(i.AlgebraModel.getDefaultParser().parse),n.classed("gmify-canvas",!1).classed("gmified-canvas",!0),n.classed("bootstrap-styles",!0),n.select("*").remove();var s=new e.gmath.Canvas(this,{height:"500px"});r(n),s.model.createDLs(o,{pos:["auto",20],v_align:"top"})}catch(t){console.log('could not parse "'+o+'". Error:',t)}}),(a=s.size()>0&&s.classed("gmify-minimal")?s:s.selectAll(".gmify-minimal")).each(function(){var n=t.select(this),r=n.text();try{i.AlgebraModel.getDefaultParser().parse(r),n.classed("gmify-minimal",!1).classed("gmified-minimal",!0),n.classed("bootstrap-styles",!0),n.select("*").remove(),n.text("");var o=n.insert("svg").style({overflow:"visible",display:"block",width:"100%"});e.gmath.Derivation.createFixedSingleLineDL(o.node(),{eq:r})}catch(t){console.log('could not parse "'+r+'". Error:',t)}}),(a=s.size()>0&&s.classed("gmify")?s:s.selectAll(".gmify")).each(function(n,s){var a=t.select(this),l=a.text();try{i.AlgebraModel.getDefaultParser().parse(l),a.classed("gmify",!1).classed("gmified",!0),a.classed("bootstrap-styles",!0),a.select("*").remove(),a.text("");var u=a.insert("div").style({overflow:"visible",display:"block","margin-top":"30px"}),c=new e.gmath.Canvas(u.node(),{minimal:!0,logo_src:o.logo_src}),d=c.model.createDL({eq:l,pos:{x:0,y:0},cloning_on:!1,normal_font:{family:"Kalam"},italic_font:{family:"Kalam"},font_baseline_shift:.4,font_ascent:.9,font_descent:.2,slanted_div_bar:!0,div_bar_height:1/14,font_size:"45",row_border_color:"#ddd",handle_stroke_color:"#d8d8d8",keep_in_container:!0});r(a),coordinator.subscribeToCanvasModel(c.model),coordinator.addDL(d),c.model.focusOnDL(d),c.controller.clearInteractionTimeline()}catch(t){console.log('could not parse "'+l+'". Error:',t)}})}}).call(this,n(6))},function(t,e,n){"use strict";(function(t){var e,i=n(0),r=n(54),o=n(5);i.gmath.ui=i.gmath.ui||{},i.gmath.ui.TutorialPair=((e=function(e,n){this.events=t.dispatch("done","retry","next"),this.id=i.gmath.uid(),this.title=n.title,this.text=n.text,"gestureData"in n&&(this.gesture_data=n.gestureData,this.gesture_data.options.show_drag_indicator=!1,this.gesture_data.options.show_bg=!1),this.initial_expressions=function(t,e){return t?e?[t].concat(e.map(function(t){return t.expression})):[t]:[]}.call(this,n.eq,n.extraExamples),this.correct_answers=function(t,e){return t?e?[t.map(this.parsedAscii)].concat(e.map(function(t){return t.correctAnswers.map(this.parsedAscii)},this)):[t.map(this.parsedAscii)]:[]}.call(this,n.correctAnswers,n.extraExamples),this.current_example=0,this.start_wiggle=n.startWiggle,this.encourage=!0,this.container=t.select(e),this.dl_div=null,this.dl=null,this.play_btn=i.gmath.svg_play_button(),this.player=null,this.practice_problem=n.practice_problem,this.substitution_problem=n.gestureData.substitution_problem,this.youtubeVideoInstead=n.gestureData.youtubeVideoInstead,this.extra_dl=n.gestureData.extra_dl,this.allow_restart_after_done=!("allow_restart_after_done"in n)||n.allow_restart_after_done,this.answered=!1,this.log_mouse_trajectories=n.log_mouse_trajectories,this.task_name=n.task_name,this.init()}).prototype.parsedAscii=function(t){return new o.AlgebraModel(t).to_ascii()},e.prototype.replay=function(){this.play_btn.hidden(!0),this.player.replay(500,function(){setTimeout(function(){this.play_btn.hidden(!1),this.dl&&!this.answered&&(this.encourage&&(this.dl_div.append("span").text("Try it!").classed("tryit",!0),this.start_wiggle&&this.dl.startWiggle(this.start_wiggle)),this.dl_div.on("mousedown",function(){var t=new Date;this.startTime=t.getTime(),this.dl_div.select("span.tryit").remove(),this.dl_div.on("mousedown",null)}.bind(this)))}.bind(this),1e3)}.bind(this))},e.prototype.videoPlay=function(){var t=this;this.play_btn.hidden(!0),this.createPlayer(500,function(){setTimeout(function(){t.play_btn.hidden(!1),t.answered||(t.encourage&&(t.dl_div.append("span").text("Try it!").classed("tryit",!0),t.start_wiggle&&t.dl.startWiggle(t.start_wiggle)),t.dl_div.on("mousedown",function(){var e=new Date;t.startTime=e.getTime(),t.dl_div.select("span.tryit").remove(),t.dl_div.on("mousedown",null)}))}).bind(t)})},e.prototype.loadYTScript=function(t){window.onYouTubeIframeAPIReady=t.bind(this);var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)},e.prototype.createPlayer=function(t){"undefined"!=typeof YT?this.ytPlayer=new YT.Player(this.video_div.node(),{height:500,width:240,playerVars:{rel:0,controls:0,showinfo:0,showsearch:0,theme:"light",frameborder:0},videoId:this.youtubeVideoInstead,events:{onReady:this.onPlayerReady.bind(this.ytPlayer),onStateChange:this.onPlayerStateChange.bind(this)}}):this.loadYTScript(this.createPlayer.bind(this,t))},e.prototype.onPlayerReady=function(t){t.target.playVideo()},e.prototype.onPlayerStateChange=function(t){0===t.data&&(this.ytPlayer.seekTo(0),this.ytPlayer.pauseVideo())},e.prototype.init=function(){this.container.append("h2").text(this.title),this.container.append("p").attr("class","tutorial-instructions").text(this.text);var t=this.container.append("div").classed("tutorial",!0),e=t.append("div").classed("choice",!0).classed("large-choice",this.practice_problem).classed("substitution-problem",this.substitution_problem);this.gesture_data.options.pos={x:"center",y:"center"},this.gesture_data.options.draggable=!1,this.gesture_data.options.collapsed_mode=!0,this.gesture_data.options.no_history=!1,this.gesture_data.options.no_handles=!0,this.gesture_data.options.edit_mode_drag_box_width="0px",this.gesture_data.options.row_padding={left:0,right:0,top:7,bottom:3},this.gesture_data.options.padding={left:0,right:0,top:0,bottom:0};var n=e.append("div").style({position:"absolute",left:0,right:0,top:0,bottom:0});if(this.player=new i.gmath.EventRecorder(this.gesture_data,n.node()),this.player.showPreview(),this.youtubeVideoInstead?this.video_div=e.append("div").classed("animation",!0).call(this.play_btn.on("click",this.videoPlay.bind(this))):e.append("div").classed("animation",!0).call(this.play_btn.on("click",this.replay.bind(this))),this.initial_expressions.length){this.dl_div=t.append("div").classed("choice",!0).classed("large-choice",this.practice_problem).classed("substitution-problem",this.substitution_problem);var o=new r.Canvas(this.dl_div.node(),{vertical_scroll:!1,use_toolbar:!1,use_hold_menu:this.use_hold_menu||!1,svg_height:"100%",log_mouse_trajectories:this.log_mouse_trajectories,ask_confirmation_on_closing:!1,overflow_visible:!0,disable_notifications:!0});this.logger=o.logger,this.model=o.model,this.controller=o.controller,this.setDLToExpression(this.initial_expressions[this.current_example]),this.startTime=-1}},e.prototype.chainTransition=function(t,e){if(t.node().__transition__&&t.id&&t.node().__transition__[t.id]){var n=t.node().__transition__[t.id];e+=n.delay+n.duration}return t.transition().delay(e)},e.prototype.neutralTransition=function(e,n,i,r){e.selectAll("button").remove(),e.select("span.feedback").remove();var o=this.chainTransition(e,n).duration(i||500);return r?o.styleTween("background",function(){return t.interpolate(r,"#EEEEEE")}):o.style("background","#eee"),o},e.prototype.wrongTransition=function(e,n,i,r){t.select(e.node()).append("span").attr("class","feedback").style({opacity:1e-5}).text("✗");var o=this.chainTransition(e,n).duration(i||500);return r?o.styleTween("background",function(){return t.interpolate(r,"#E0A8A8")}):o.style("background","#E0A8A8"),o.select(".feedback").style("opacity",1),o},e.prototype.correctTransition=function(e,n,i,r){var o=t.select(e.node());o.append("span").attr("class","feedback").style({opacity:1e-5}).text("✓"),this.allow_restart_after_done&&this.initDoItAgainBtn(o),this.initial_expressions.length>1&&this.initTryAnotherBtn(o);var s=this.chainTransition(e,n).duration(i||500);return r?s.styleTween("background",function(){return t.interpolate(r,"#A8E0B3")}):s.style("background","#A8E0B3"),s.select(".feedback").style("opacity",1),s.selectAll("button").style("opacity",1),s},e.prototype.initDoItAgainBtn=function(t){t.append("button").classed("gm-tutorial",!0).text("do it again").style({top:"10px",opacity:1e-5}).on("click",function(){this.logger.logCustomInteraction("tutorial-reset",{task_name:this.task_name,eq_start:this.dl.rows[0].model.to_ascii(),eq_end:this.dl.getLastModel().to_ascii()}),this.retry()}.bind(this))},e.prototype.initTryAnotherBtn=function(t){t.append("button").classed("gm-tutorial",!0).text("try another").style({top:"62px",opacity:1e-5}).on("click",function(){this.logger.logCustomInteraction("tutorial-alternative-example",{task_name:this.task_name,eq_start:this.dl.rows[0].model.to_ascii()}),this.initial_expressions.length>1?this.loadNextExample():this.retry()}.bind(this))},e.prototype.checkAnswer=function(){setTimeout(function(){this.dl.getLastView().interactive(!1);var t=this.dl.getLastModel().to_ascii(),e=new Date,n=-1,i=-1;if(-1!==this.startTime&&(n=e.getTime()-this.startTime),this.parsedAscii(this.initial_expressions[this.current_example])!==this.dl.getLastModel().to_ascii()||this.extra_dl_element_modified)if(this.answerIsCorrect(t)){if(i="correct",this.answered=!0,this.extra_dl_element_modified=!1,this.logger.logCustomInteraction("tutorial-success",{task_name:this.task_name,eq_start:this.dl.rows[0].model.to_ascii(),eq_end:this.dl.getLastModel().to_ascii()}),2===this.dl_div.selectAll("div").size())return;this.correctTransition(this.dl_div,200,null,"#EEEEEE").each("end",this.events.done)}else this.practice_problem?(i="intermediate state",this.dl.getLastView().interactive(!0)):(i="wrong",this.extra_dl_element_modified=!1,this.logger.logCustomInteraction("tutorial-fail",{task_name:this.task_name,eq_start:this.dl.rows[0].model.to_ascii(),eq_end:this.dl.getLastModel().to_ascii()}),this.wrongTransition(this.dl_div,200,null,"#EEEEEE").transition().duration(500).each("end",this.retry.bind(this)),this.encourage=!0);else this.dl.getLastView().interactive(!0),i="initial state";window&&window.gmath_log_ga&&gmath_log_ga.trackEvent("tutorial",i,this.eq,n)}.bind(this),400)},e.prototype.answerIsCorrect=function(t){return-1!==this.correct_answers[this.current_example].indexOf(t)},e.prototype.loadNextExample=function(){this.dl.rows[0].model.to_ascii(),this.neutralTransition(this.dl_div,0,1).each("end",function(){this.current_example++,this.current_example===this.initial_expressions.length&&(this.current_example=0),this.setDLToExpression(this.initial_expressions[this.current_example]),0===this.current_example?this.encourage=!0:this.encourage=!1,this.events.next()}.bind(this))},e.prototype.retry=function(){this.neutralTransition(this.dl_div,0,1).each("end",function(){this.setDLToExpression(this.initial_expressions[this.current_example]),this.events.retry()}.bind(this)),this.answered=!1,this.encourage=!0},e.prototype.setDLToExpression=function(t){var e=this,n=SettingsType.get("AlgebraView").defaults,r=i.gmath.deepCopy(this.gesture_data.options);r.eq=t,r.inactive_color=n.get("inactive_color"),r.color=n.get("color"),r.h_align="center",r.edit_mode_drag_box_width="0px",r.show_drag_indicator=n.get("show_drag_indicator"),this.controller.simulateStartOfInteraction(),this.dl&&this.model.removeElement(this.dl),this.dl=this.model.createDL(r),this.controller.simulateEndOfInteraction(),this.extra_dl&&(this.extra_dl_element&&this.model.removeElement(this.extra_dl_element),this.extra_dl_element=this.model.createDL(this.extra_dl.options),this.extra_dl_element.events.on("end-of-interaction."+this.id,function(){e.extra_dl_element_modified=!0,e.checkAnswer(e)})),this.dl.getLastRow().view.interaction_handler.events.on("touch",function(){this.encourage=!1}.bind(this)),this.dl.getLastView().interactive(!0),this.dl.events.on("end-of-interaction."+this.id,this.checkAnswer.bind(this))},e.prototype.stop=function(){this.player.stop_animation()},e)}).call(this,n(6))},function(t,e,n){t.exports=n.p+"20db57ba32a046dfea3c30519898b278.svg"},function(t,e,n){t.exports=n.p+"4621fcfd9def63c694914f7ec5add610.otf"},function(t,e,n){t.exports=n.p+"52a6aac18ae26b6ecbd4f3a0d9579c9f.ttf"},function(t,e,n){t.exports=n.p+"72981090d0240678c5d0a964fe29f082.woff"},function(t,e,n){t.exports=n.p+"2bb0421d8c622fb2aa1632b099807402.woff2"},function(t,e,n){t.exports=n.p+"e4ae9ff7ac2476ae421fc4278e5d3806.eot"},function(t,e,n){var i=n(50);(t.exports=n(29)(!1)).push([t.i,"/*\n * MathQuill v0.10.1               http://mathquill.com\n * by Han, Jeanine, and Mary  maintainers@mathquill.com\n *\n * This Source Code Form is subject to the terms of the\n * Mozilla Public License, v. 2.0. If a copy of the MPL\n * was not distributed with this file, You can obtain\n * one at http://mozilla.org/MPL/2.0/.\n */\n@font-face {\n  font-family: Symbola;\n  src: url("+i(n(176))+');\n  src: local("Symbola Regular"), local("Symbola"), url('+i(n(175))+') format("woff2"), url('+i(n(174))+') format("woff"), url('+i(n(173))+') format("truetype"), url('+i(n(172))+') format("opentype"), url('+i(n(171))+"#Symbola) format(\"svg\");\n}\n.mq-editable-field {\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mq-editable-field .mq-cursor {\n  border-left: 1px solid black;\n  margin-left: -1px;\n  position: relative;\n  z-index: 1;\n  padding: 0;\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mq-editable-field .mq-cursor.mq-blink {\n  visibility: hidden;\n}\n.mq-editable-field,\n.mq-math-mode .mq-editable-field {\n  border: 1px solid gray;\n}\n.mq-editable-field.mq-focused,\n.mq-math-mode .mq-editable-field.mq-focused {\n  -webkit-box-shadow: #8bd 0 0 1px 2px, inset #6ae 0 0 2px 0;\n  -moz-box-shadow: #8bd 0 0 1px 2px, inset #6ae 0 0 2px 0;\n  box-shadow: #8bd 0 0 1px 2px, inset #6ae 0 0 2px 0;\n  border-color: #709AC0;\n  border-radius: 1px;\n}\n.mq-math-mode .mq-editable-field {\n  margin: 1px;\n}\n.mq-editable-field .mq-latex-command-input {\n  color: inherit;\n  font-family: \"Courier New\", monospace;\n  border: 1px solid gray;\n  padding-right: 1px;\n  margin-right: 1px;\n  margin-left: 2px;\n}\n.mq-editable-field .mq-latex-command-input.mq-empty {\n  background: transparent;\n}\n.mq-editable-field .mq-latex-command-input.mq-hasCursor {\n  border-color: ActiveBorder;\n}\n.mq-editable-field.mq-empty:after,\n.mq-editable-field.mq-text-mode:after,\n.mq-math-mode .mq-empty:after {\n  visibility: hidden;\n  content: 'c';\n}\n.mq-editable-field .mq-cursor:only-child:after,\n.mq-editable-field .mq-textarea + .mq-cursor:last-child:after {\n  visibility: hidden;\n  content: 'c';\n}\n.mq-editable-field .mq-text-mode .mq-cursor:only-child:after {\n  content: '';\n}\n.mq-editable-field.mq-text-mode {\n  overflow-x: auto;\n  overflow-y: hidden;\n}\n.mq-root-block,\n.mq-math-mode .mq-root-block {\n  display: -moz-inline-box;\n  display: inline-block;\n  width: 100%;\n  padding: 2px;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  white-space: nowrap;\n  overflow: hidden;\n  vertical-align: middle;\n}\n.mq-math-mode {\n  font-variant: normal;\n  font-weight: normal;\n  font-style: normal;\n  font-size: 115%;\n  line-height: 1;\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mq-math-mode .mq-non-leaf,\n.mq-math-mode .mq-scaled {\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mq-math-mode var,\n.mq-math-mode .mq-text-mode,\n.mq-math-mode .mq-nonSymbola {\n  font-family: \"Times New Roman\", Symbola, serif;\n  line-height: .9;\n}\n.mq-math-mode * {\n  font-size: inherit;\n  line-height: inherit;\n  margin: 0;\n  padding: 0;\n  border-color: black;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n  box-sizing: border-box;\n}\n.mq-math-mode .mq-empty {\n  background: #ccc;\n}\n.mq-math-mode .mq-empty.mq-root-block {\n  background: transparent;\n}\n.mq-math-mode.mq-empty {\n  background: transparent;\n}\n.mq-math-mode .mq-text-mode {\n  font-size: 87%;\n}\n.mq-math-mode .mq-font {\n  font: 1em \"Times New Roman\", Symbola, serif;\n}\n.mq-math-mode .mq-font * {\n  font-family: inherit;\n  font-style: inherit;\n}\n.mq-math-mode b,\n.mq-math-mode b.mq-font {\n  font-weight: bolder;\n}\n.mq-math-mode var,\n.mq-math-mode i,\n.mq-math-mode i.mq-font {\n  font-style: italic;\n}\n.mq-math-mode var.mq-f {\n  margin-right: 0.2em;\n  margin-left: 0.1em;\n}\n.mq-math-mode .mq-roman var.mq-f {\n  margin: 0;\n}\n.mq-math-mode big {\n  font-size: 125%;\n}\n.mq-math-mode .mq-roman {\n  font-style: normal;\n}\n.mq-math-mode .mq-sans-serif {\n  font-family: sans-serif, Symbola, serif;\n}\n.mq-math-mode .mq-monospace {\n  font-family: monospace, Symbola, serif;\n}\n.mq-math-mode .mq-overline {\n  border-top: 1px solid black;\n  margin-top: 1px;\n}\n.mq-math-mode .mq-underline {\n  border-bottom: 1px solid black;\n  margin-bottom: 1px;\n}\n.mq-math-mode .mq-binary-operator {\n  padding: 0 0.2em;\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mq-math-mode .mq-supsub {\n  font-size: 90%;\n  vertical-align: -0.5em;\n}\n.mq-math-mode .mq-supsub.mq-limit {\n  font-size: 80%;\n  vertical-align: -0.4em;\n}\n.mq-math-mode .mq-supsub.mq-sup-only {\n  vertical-align: .5em;\n}\n.mq-math-mode .mq-supsub.mq-sup-only .mq-sup {\n  display: inline-block;\n  vertical-align: text-bottom;\n}\n.mq-math-mode .mq-supsub .mq-sup {\n  display: block;\n}\n.mq-math-mode .mq-supsub .mq-sub {\n  display: block;\n  float: left;\n}\n.mq-math-mode .mq-supsub.mq-limit .mq-sub {\n  margin-left: -0.25em;\n}\n.mq-math-mode .mq-supsub .mq-binary-operator {\n  padding: 0 .1em;\n}\n.mq-math-mode .mq-supsub .mq-fraction {\n  font-size: 70%;\n}\n.mq-math-mode sup.mq-nthroot {\n  font-size: 80%;\n  vertical-align: 0.8em;\n  margin-right: -0.6em;\n  margin-left: .2em;\n  min-width: .5em;\n}\n.mq-math-mode .mq-paren {\n  padding: 0 .1em;\n  vertical-align: top;\n  -webkit-transform-origin: center .06em;\n  -moz-transform-origin: center .06em;\n  -ms-transform-origin: center .06em;\n  -o-transform-origin: center .06em;\n  transform-origin: center .06em;\n}\n.mq-math-mode .mq-paren.mq-ghost {\n  color: silver;\n}\n.mq-math-mode .mq-paren + span {\n  margin-top: .1em;\n  margin-bottom: .1em;\n}\n.mq-math-mode .mq-array {\n  vertical-align: middle;\n  text-align: center;\n}\n.mq-math-mode .mq-array > span {\n  display: block;\n}\n.mq-math-mode .mq-operator-name {\n  font-family: Symbola, \"Times New Roman\", serif;\n  line-height: .9;\n  font-style: normal;\n}\n.mq-math-mode var.mq-operator-name.mq-first {\n  padding-left: .2em;\n}\n.mq-math-mode var.mq-operator-name.mq-last {\n  padding-right: .2em;\n}\n.mq-math-mode .mq-fraction {\n  font-size: 90%;\n  text-align: center;\n  vertical-align: -0.4em;\n  padding: 0 .2em;\n}\n.mq-math-mode .mq-fraction,\n.mq-math-mode .mq-large-operator,\n.mq-math-mode x:-moz-any-link {\n  display: -moz-groupbox;\n}\n.mq-math-mode .mq-fraction,\n.mq-math-mode .mq-large-operator,\n.mq-math-mode x:-moz-any-link,\n.mq-math-mode x:default {\n  display: inline-block;\n}\n.mq-math-mode .mq-numerator,\n.mq-math-mode .mq-denominator {\n  display: block;\n}\n.mq-math-mode .mq-numerator {\n  padding: 0 0.1em;\n}\n.mq-math-mode .mq-denominator {\n  border-top: 1px solid;\n  float: right;\n  width: 100%;\n  padding: 0.1em;\n}\n.mq-math-mode .mq-sqrt-prefix {\n  padding-top: 0;\n  position: relative;\n  top: 0.1em;\n  vertical-align: top;\n  -webkit-transform-origin: top;\n  -moz-transform-origin: top;\n  -ms-transform-origin: top;\n  -o-transform-origin: top;\n  transform-origin: top;\n}\n.mq-math-mode .mq-sqrt-stem {\n  border-top: 1px solid;\n  margin-top: 1px;\n  padding-left: .15em;\n  padding-right: .2em;\n  margin-right: .1em;\n  padding-top: 1px;\n}\n.mq-math-mode .mq-vector-prefix {\n  display: block;\n  text-align: center;\n  line-height: .25em;\n  margin-bottom: -0.1em;\n  font-size: 0.75em;\n}\n.mq-math-mode .mq-vector-stem {\n  display: block;\n}\n.mq-math-mode .mq-large-operator {\n  text-align: center;\n}\n.mq-math-mode .mq-large-operator .mq-from,\n.mq-math-mode .mq-large-operator big,\n.mq-math-mode .mq-large-operator .mq-to {\n  display: block;\n}\n.mq-math-mode .mq-large-operator .mq-from,\n.mq-math-mode .mq-large-operator .mq-to {\n  font-size: 80%;\n}\n.mq-math-mode .mq-large-operator .mq-from {\n  float: right;\n  /* take out of normal flow to manipulate baseline */\n  width: 100%;\n}\n.mq-math-mode,\n.mq-math-mode .mq-editable-field {\n  cursor: text;\n  font-family: Symbola, \"Times New Roman\", serif;\n}\n.mq-math-mode .mq-overarrow {\n  border-top: 1px solid black;\n  margin-top: 1px;\n  padding-top: 0.2em;\n}\n.mq-math-mode .mq-overarrow:before {\n  display: block;\n  position: relative;\n  top: -0.34em;\n  font-size: 0.5em;\n  line-height: 0em;\n  content: '\\27A4';\n  text-align: right;\n}\n.mq-math-mode .mq-overarrow.mq-arrow-left:before {\n  -moz-transform: scaleX(-1);\n  -o-transform: scaleX(-1);\n  -webkit-transform: scaleX(-1);\n  transform: scaleX(-1);\n  filter: FlipH;\n  -ms-filter: \"FlipH\";\n}\n.mq-math-mode .mq-selection,\n.mq-editable-field .mq-selection,\n.mq-math-mode .mq-selection .mq-non-leaf,\n.mq-editable-field .mq-selection .mq-non-leaf,\n.mq-math-mode .mq-selection .mq-scaled,\n.mq-editable-field .mq-selection .mq-scaled {\n  background: #B4D5FE !important;\n  background: Highlight !important;\n  color: HighlightText;\n  border-color: HighlightText;\n}\n.mq-math-mode .mq-selection .mq-matrixed,\n.mq-editable-field .mq-selection .mq-matrixed {\n  background: #39F !important;\n}\n.mq-math-mode .mq-selection .mq-matrixed-container,\n.mq-editable-field .mq-selection .mq-matrixed-container {\n  filter: progid:DXImageTransform.Microsoft.Chroma(color='#3399FF') !important;\n}\n.mq-math-mode .mq-selection.mq-blur,\n.mq-editable-field .mq-selection.mq-blur,\n.mq-math-mode .mq-selection.mq-blur .mq-non-leaf,\n.mq-editable-field .mq-selection.mq-blur .mq-non-leaf,\n.mq-math-mode .mq-selection.mq-blur .mq-scaled,\n.mq-editable-field .mq-selection.mq-blur .mq-scaled,\n.mq-math-mode .mq-selection.mq-blur .mq-matrixed,\n.mq-editable-field .mq-selection.mq-blur .mq-matrixed {\n  background: #D4D4D4 !important;\n  color: black;\n  border-color: black;\n}\n.mq-math-mode .mq-selection.mq-blur .mq-matrixed-container,\n.mq-editable-field .mq-selection.mq-blur .mq-matrixed-container {\n  filter: progid:DXImageTransform.Microsoft.Chroma(color='#D4D4D4') !important;\n}\n.mq-editable-field .mq-textarea,\n.mq-math-mode .mq-textarea {\n  position: relative;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n}\n.mq-editable-field .mq-textarea *,\n.mq-math-mode .mq-textarea *,\n.mq-editable-field .mq-selectable,\n.mq-math-mode .mq-selectable {\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n  position: absolute;\n  clip: rect(1em 1em 1em 1em);\n  -webkit-transform: scale(0);\n  -moz-transform: scale(0);\n  -ms-transform: scale(0);\n  -o-transform: scale(0);\n  transform: scale(0);\n  resize: none;\n  width: 1px;\n  height: 1px;\n}\n.mq-math-mode .mq-matrixed {\n  background: white;\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mq-math-mode .mq-matrixed-container {\n  filter: progid:DXImageTransform.Microsoft.Chroma(color='white');\n  margin-top: -0.1em;\n}\n",""])},function(t,e,n){var i=n(177);"string"==typeof i&&(i=[[t.i,i,""]]);n(28)(i,{hmr:!0,transform:void 0,insertInto:void 0}),i.locals&&(t.exports=i.locals)},function(t,e){!function(){function t(){}function e(t){var e=t.length-1;return function(){var n=vt.call(arguments,0,e),i=vt.call(arguments,e);return t.apply(this,n.concat([i]))}}function n(t){return e(function(e,n){return"function"!=typeof e&&(e=yt(e)),t.call(this,function(t){return e.apply(t,[t].concat(n))})})}function i(t){var e=vt.call(arguments,1);return function(){return t.apply(this,e)}}function r(t,e){if(!e)throw new Error("prayer failed: "+t)}function o(t){r("a direction was passed",t===_t||t===xt)}function s(t,e,n){r("a parent is always present",t),r("leftward is properly set up",e?e[xt]===n&&e.parent===t:t.ends[_t]===n),r("rightward is properly set up",n?n[_t]===e&&n.parent===t:t.ends[xt]===e)}function a(){window.console&&console.warn('You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014–2015) → v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide')}function l(t){return a(),ct(t)}function u(e){function n(t){var e,n;return t&&t.nodeType&&(n=(e=wt(t).children(".mq-root-block").attr(ft))&&kt.byId[e].controller)?r[n.KIND_OF_MQ](n):null}function i(t,e){var n,i,o;for(n in e&&e.handlers&&(e.handlers={fns:e.handlers,APIClasses:r}),e)e.hasOwnProperty(n)&&(i=e[n],o=Pt[n],t[n]=o?o(i):i)}var r,o,s;if(!(e>=m&&v>=e))throw"Only interface versions between "+m+" and "+v+" supported. You specified: "+e;for(s in r={},n.L=_t,n.R=xt,n.config=function(t){return i(Ct.p,t),this},n.registerEmbed=function(t,e){if(!/^[a-z][a-z0-9]*$/i.test(t))throw"Embed name must start with letter and be only letters and digits";Dt[t]=e},o=r.AbstractMathQuill=bt(jt,function(t){t.init=function(t){this.__controller=t,this.__options=t.options,this.id=t.id,this.data=t.data},t.__mathquillify=function(t){var e,n=this.__controller,i=n.root,r=n.container;n.createTextarea(),e=r.addClass(t).contents().detach(),i.jQ=wt('<span class="mq-root-block"/>').attr(ft,i.id).appendTo(r),this.latex(e.text()),this.revert=function(){return r.empty().unbind(".mathquill").removeClass("mq-editable-field mq-math-mode mq-text-mode").append(e)}},t.config=function(t){return i(this.__options,t),this},t.el=function(){return this.__controller.container[0]},t.text=function(){return this.__controller.exportText()},t.latex=function(t){return arguments.length>0?(this.__controller.renderLatexMath(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()},t.html=function(){return this.__controller.root.jQ.html().replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?mq-cursor( mq-blink)?"?>.?<\/span>/i,"").replace(/ mq-hasCursor|mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},t.reflow=function(){return this.__controller.root.postOrder("reflow"),this}}),n.prototype=o.prototype,r.EditableField=bt(o,function(e,n){e.__mathquillify=function(){return n.__mathquillify.apply(this,arguments),this.__controller.editable=!0,this.__controller.delegateMouseEvents(),this.__controller.editablesTextareaEvents(),this},e.focus=function(){return this.__controller.textarea.focus(),this},e.blur=function(){return this.__controller.textarea.blur(),this},e.write=function(t){return this.__controller.writeLatex(t),this.__controller.scrollHoriz(),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this},e.cmd=function(t){var e,n=this.__controller.notify(),i=n.cursor;return/^\\[a-z]+$/i.test(t)?(t=t.slice(1),(e=St[t])&&(t=e(t),i.selection&&t.replaces(i.replaceSelection()),t.createLeftOf(i.show()),this.__controller.scrollHoriz())):i.parent.write(i,t),n.blurred&&i.hide().parent.blur(),this},e.select=function(){var t=this.__controller;for(t.notify("move").cursor.insAtRightEnd(t.root);t.cursor[_t];)t.selectLeft();return this},e.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},e.moveToDirEnd=function(t){return this.__controller.notify("move").cursor.insAtDirEnd(t,this.__controller.root),this},e.moveToLeftEnd=function(){return this.moveToDirEnd(_t)},e.moveToRightEnd=function(){return this.moveToDirEnd(xt)},e.keystroke=function(e){var n;for(e=e.replace(/^\s+|\s+$/g,"").split(/\s+/),n=0;n<e.length;n+=1)this.__controller.keystroke(e[n],{preventDefault:t});return this},e.typedText=function(t){for(var e=0;e<t.length;e+=1)this.__controller.typedText(t.charAt(e));return this},e.dropEmbedded=function(t,e,n){var i=t-wt(window).scrollLeft(),r=e-wt(window).scrollTop(),o=document.elementFromPoint(i,r);this.__controller.seek(wt(o),t,e),ut().setOptions(n).createLeftOf(this.__controller.cursor)}}),n.EditableField=function(){throw"wtf don't call me, I'm 'abstract'"},n.EditableField.prototype=r.EditableField.prototype,qt)!function(t,i){var o=r[t]=i(r);n[t]=function(i,r){var s,a=n(i);return a instanceof o||!i||!i.nodeType?a:((s=Ot(o.RootBlock(),wt(i),Ct())).KIND_OF_MQ=t,o(s).__mathquillify(r,e))},n[t].prototype=o.prototype}(s,qt[s]);return n}function c(t){var e,n="moveOutOf deleteOutOf selectOutOf upOutOf downOutOf".split(" ");for(e=0;e<n.length;e+=1)!function(e){t[e]=function(t){this.controller.handle(e,t)}}(n[e]);t.reflow=function(){this.controller.handle("reflow"),this.controller.handle("edited"),this.controller.handle("edit")}}function d(t,e,n){return bt(N,{ctrlSeq:t,htmlTemplate:"<"+e+" "+n+">&0</"+e+">"})}function h(t){var e=this.parent,n=t;do{if(n[xt])return t.insLeftOf(e);n=n.parent.parent}while(n!==e);t.insRightOf(e)}function p(t,e){t.jQadd=function(){e.jQadd.apply(this,arguments),this.delimjQs=this.jQ.children(":first").add(this.jQ.children(":last")),this.contentjQ=this.jQ.children(":eq(1)")},t.reflow=function(){var t=this.contentjQ.outerHeight()/parseFloat(this.contentjQ.css("fontSize"));$(this.delimjQs,gt(1+.2*(t-1),1.2),1.2*t)}}function f(t,e){e=e||t;var n=at[t],r=at[e];Mt[t]=i(st,_t,t,n,e,r),Mt[n]=i(st,xt,t,n,e,r)}var g,m,v,y,b,_,x,w,A,k,T,S,M,E,N,O,q,C,P,j,D,I,F,L,z,R,B,H,G,V,U,W,Q,$,K,J,Z,Y,X,tt,et,nt,it,rt,ot,st,at,lt,ut,ct,dt,ht=window.jQuery,pt="mathquill-command-id",ft="mathquill-block-id",gt=Math.min,mt=Math.max,vt=[].slice,yt=e(function(t,n){return e(function(e,i){return t in e?e[t].apply(e,n.concat(i)):void 0})}),bt=function(t,e,n){function i(t){return"object"==typeof t}function r(t){return"function"==typeof t}function o(){}return function n(s,a){function l(){var t=new u;return r(t.init)&&t.init.apply(t,arguments),t}function u(){}var c,d,h;return void 0===a&&(a=s,s=Object),l.Bare=u,c=o[t]=s[t],(d=u[t]=l[t]=l.p=new o).constructor=l,l.mixin=function(e){return u[t]=l[t]=n(l,e)[t],l},(l.open=function(t){if(h={},r(t)?h=t.call(l,d,c,l,s):i(t)&&(h=t),i(h))for(var n in h)e.call(h,n)&&(d[n]=h[n]);return r(d.init)||(d.init=s),l})(a)}}("prototype",{}.hasOwnProperty),_t=-1,xt=1,wt=bt(ht,function(t){t.insDirOf=function(t,e){return t===_t?this.insertBefore(e.first()):this.insertAfter(e.last())},t.insAtDirEnd=function(t,e){return t===_t?this.prependTo(e):this.appendTo(e)}}),At=bt(function(t){t.parent=0,t[_t]=0,t[xt]=0,t.init=function(t,e,n){this.parent=t,this[_t]=e,this[xt]=n},this.copy=function(t){return At(t.parent,t[_t],t[xt])}}),kt=bt(function(t){t[_t]=0,t[xt]=0,t.parent=0;var e=0;this.byId={},t.init=function(){this.id=e+=1,kt.byId[this.id]=this,this.ends={},this.ends[_t]=0,this.ends[xt]=0},t.dispose=function(){delete kt.byId[this.id]},t.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},t.jQ=wt(),t.jQadd=function(t){return this.jQ=this.jQ.add(t)},t.jQize=function(t){function e(t){var n,i;for(t.getAttribute&&(n=t.getAttribute("mathquill-command-id"),i=t.getAttribute("mathquill-block-id"),n&&kt.byId[n].jQadd(t),i&&kt.byId[i].jQadd(t)),t=t.firstChild;t;t=t.nextSibling)e(t)}var n;for(t=wt(t||this.html()),n=0;n<t.length;n+=1)e(t[n]);return t},t.createDir=function(t,e){o(t);var n=this;return n.jQize(),n.jQ.insDirOf(t,e.jQ),e[t]=n.adopt(e.parent,e[_t],e[xt]),n},t.createLeftOf=function(t){return this.createDir(_t,t)},t.selectChildren=function(t,e){return Nt(t,e)},t.bubble=n(function(t){var e;for(e=this;e&&!1!==t(e);e=e.parent);return this}),t.postOrder=n(function(t){return function e(n){n.eachChild(e),t(n)}(this),this}),t.isEmpty=function(){return 0===this.ends[_t]&&0===this.ends[xt]},t.children=function(){return Tt(this.ends[_t],this.ends[xt])},t.eachChild=function(){var t=this.children();return t.each.apply(t,arguments),this},t.foldChildren=function(t,e){return this.children().fold(t,e)},t.withDirAdopt=function(t,e,n,i){return Tt(this,this).withDirAdopt(t,e,n,i),this},t.adopt=function(t,e,n){return Tt(this,this).adopt(t,e,n),this},t.disown=function(){return Tt(this,this).disown(),this},t.remove=function(){return this.jQ.remove(),this.postOrder("dispose"),this.disown()}}),Tt=bt(function(t){t.init=function(t,e,n){if(n===g&&(n=_t),o(n),r("no half-empty fragments",!t==!e),this.ends={},t){r("withDir is passed to Fragment",t instanceof kt),r("oppDir is passed to Fragment",e instanceof kt),r("withDir and oppDir have the same parent",t.parent===e.parent),this.ends[n]=t,this.ends[-n]=e;var i=this.fold([],function(t,e){return t.push.apply(t,e.jQ.get()),t});this.jQ=this.jQ.add(i)}},t.jQ=wt(),t.withDirAdopt=function(t,e,n,i){return t===_t?this.adopt(e,n,i):this.adopt(e,i,n)},t.adopt=function(t,e,n){var i,r,o;return s(t,e,n),(i=this).disowned=!1,(r=i.ends[_t])?(o=i.ends[xt],e||(t.ends[_t]=r),n?n[_t]=o:t.ends[xt]=o,i.ends[xt][xt]=n,i.each(function(n){n[_t]=e,n.parent=t,e&&(e[xt]=n),e=n}),i):this},t.disown=function(){var t,e,n=this,i=n.ends[_t];return!i||n.disowned?n:(n.disowned=!0,t=n.ends[xt],s(e=i.parent,i[_t],i),s(e,t,t[xt]),i[_t]?i[_t][xt]=t[xt]:e.ends[_t]=t[xt],t[xt]?t[xt][_t]=i[_t]:e.ends[xt]=i[_t],n)},t.remove=function(){return this.jQ.remove(),this.each("postOrder","dispose"),this.disown()},t.each=n(function(t){var e=this,n=e.ends[_t];if(!n)return e;for(;n!==e.ends[xt][xt]&&!1!==t(n);n=n[xt]);return e}),t.fold=function(t,e){return this.each(function(n){t=e.call(this,t,n)}),t}}),St={},Mt={},Et=bt(At,function(t){t.init=function(t,e){this.parent=t,this.options=e;var n=this.jQ=this._jQ=wt('<span class="mq-cursor">&#8203;</span>');this.blink=function(){n.toggleClass("mq-blink")},this.upDownCache={}},t.show=function(){return this.jQ=this._jQ.removeClass("mq-blink"),"intervalId"in this?clearInterval(this.intervalId):(this[xt]?this.selection&&this.selection.ends[_t][_t]===this[_t]?this.jQ.insertBefore(this.selection.jQ):this.jQ.insertBefore(this[xt].jQ.first()):this.jQ.appendTo(this.parent.jQ),this.parent.focus()),this.intervalId=setInterval(this.blink,500),this},t.hide=function(){return"intervalId"in this&&clearInterval(this.intervalId),delete this.intervalId,this.jQ.detach(),this.jQ=wt(),this},t.withDirInsertAt=function(t,e,n,i){var r=this.parent;this.parent=e,this[t]=n,this[-t]=i,r!==e&&r.blur&&r.blur()},t.insDirOf=function(t,e){return o(t),this.jQ.insDirOf(t,e.jQ),this.withDirInsertAt(t,e.parent,e[t],e),this.parent.jQ.addClass("mq-hasCursor"),this},t.insLeftOf=function(t){return this.insDirOf(_t,t)},t.insRightOf=function(t){return this.insDirOf(xt,t)},t.insAtDirEnd=function(t,e){return o(t),this.jQ.insAtDirEnd(t,e.jQ),this.withDirInsertAt(t,e,0,e.ends[t]),e.focus(),this},t.insAtLeftEnd=function(t){return this.insAtDirEnd(_t,t)},t.insAtRightEnd=function(t){return this.insAtDirEnd(xt,t)},t.jumpUpDown=function(t,e){var n,i,r=this;r.upDownCache[t.id]=At.copy(r),(n=r.upDownCache[e.id])?n[xt]?r.insLeftOf(n[xt]):r.insAtRightEnd(n.parent):(i=r.offset().left,e.seek(i,r))},t.offset=function(){var t=this.jQ.removeClass("mq-cursor").offset();return this.jQ.addClass("mq-cursor"),t},t.unwrapGramp=function(){var t=this.parent.parent,e=t.parent,n=t[xt],i=t[_t];if(t.disown().eachChild(function(r){r.isEmpty()||(r.children().adopt(e,i,n).each(function(e){e.jQ.insertBefore(t.jQ.first())}),i=r.ends[xt])}),!this[xt])if(this[_t])this[xt]=this[_t][xt];else for(;!this[xt];){if(this.parent=this.parent[xt],!this.parent){this[xt]=t[xt],this.parent=e;break}this[xt]=this.parent.ends[_t]}this[xt]?this.insLeftOf(this[xt]):this.insAtRightEnd(e),t.jQ.remove(),t[_t].siblingDeleted&&t[_t].siblingDeleted(this.options,xt),t[xt].siblingDeleted&&t[xt].siblingDeleted(this.options,_t)},t.startSelection=function(){var t,e=this.anticursor=At.copy(this),n=e.ancestors={};for(t=e;t.parent;t=t.parent)n[t.parent.id]=t},t.endSelection=function(){delete this.anticursor},t.select=function(){var t,e,n,i,o,s,a,l=this.anticursor;if(this[_t]===l[_t]&&this.parent===l.parent)return!1;for(t=this;t.parent;t=t.parent)if(t.parent.id in l.ancestors){e=t.parent;break}if(r("cursor and anticursor in the same tree",e),n=l.ancestors[e.id],s=xt,t[_t]!==n)for(a=t;a;a=a[xt])if(a[xt]===n[xt]){s=_t,i=t,o=n;break}return s===xt&&(i=n,o=t),i instanceof At&&(i=i[xt]),o instanceof At&&(o=o[_t]),this.hide().selection=e.selectChildren(i,o),this.insDirOf(s,this.selection.ends[s]),this.selectionChanged(),!0},t.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},t.deleteSelection=function(){this.selection&&(this[_t]=this.selection.ends[_t][_t],this[xt]=this.selection.ends[xt][xt],this.selection.remove(),this.selectionChanged(),delete this.selection)},t.replaceSelection=function(){var t=this.selection;return t&&(this[_t]=t.ends[_t][_t],this[xt]=t.ends[xt][xt],delete this.selection),t}}),Nt=bt(Tt,function(t,e){t.init=function(){e.init.apply(this,arguments),this.jQ=this.jQ.wrapAll('<span class="mq-selection"></span>').parent()},t.adopt=function(){return this.jQ.replaceWith(this.jQ=this.jQ.children()),e.adopt.apply(this,arguments)},t.clear=function(){return this.jQ.replaceWith(this.jQ[0].childNodes),this},t.join=function(t){return this.fold("",function(e,n){return e+n[t]()})}}),Ot=bt(function(t){t.init=function(t,e,n){this.id=t.id,this.data={},this.root=t,this.container=e,this.options=n,t.controller=this,this.cursor=t.cursor=Et(t,n)},t.handle=function(t,e){var n,i=this.options.handlers;i&&i.fns[t]&&(n=i.APIClasses[this.KIND_OF_MQ](this),e===_t||e===xt?i.fns[t](e,n):i.fns[t](n))};var e=[];this.onNotify=function(t){e.push(t)},t.notify=function(){for(var t=0;t<e.length;t+=1)e[t].apply(this.cursor,arguments);return this}}),qt={},Ct=bt(),Pt={},jt=bt(),Dt={};for(R in l.prototype=jt.p,l.interfaceVersion=function(t){if(1!==t)throw"Only interface version 1 supported. You specified: "+t;return(a=function(){window.console&&console.warn('You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014–2015) → v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide')})(),l},l.getInterface=u,m=u.MIN=1,v=u.MAX=2,l.noConflict=function(){return window.MathQuill=y,l},y=window.MathQuill,window.MathQuill=l,b=bt(function(t,e,n){function i(t,e){throw"Parse Error: "+e+" at "+(t?"'"+t+"'":"EOF")}var o,s,a;t.init=function(t){this._=t},t.parse=function(t){return this.skip(a)._(""+t,function(t,e){return e},i)},t.or=function(t){r("or is passed a parser",t instanceof n);var e=this;return n(function(n,i,r){return e._(n,i,function(e){return t._(n,i,r)})})},t.then=function(t){var e=this;return n(function(i,o,s){return e._(i,function(e,i){var a=t instanceof n?t:t(i);return r("a parser is returned",a instanceof n),a._(e,o,s)},s)})},t.many=function(){var t=this;return n(function(e,n,i){function r(t,n){return e=t,s.push(n),!0}function o(){return!1}for(var s=[];t._(e,r,o););return n(e,s)})},t.times=function(t,e){arguments.length<2&&(e=t);var i=this;return n(function(n,r,o){function s(t,e){return d.push(e),n=t,!0}function a(t,e){return u=e,n=t,!1}function l(t,e){return!1}var u,c,d=[],h=!0;for(c=0;t>c;c+=1)if(!(h=i._(n,s,a)))return o(n,u);for(;e>c&&h;c+=1)h=i._(n,s,l);return r(n,d)})},t.result=function(t){return this.then(s(t))},t.atMost=function(t){return this.times(0,t)},t.atLeast=function(t){var e=this;return e.times(t).then(function(t){return e.many().map(function(e){return t.concat(e)})})},t.map=function(t){return this.then(function(e){return s(t(e))})},t.skip=function(t){return this.then(function(e){return t.result(e)})},this.string=function(t){var e=t.length,i="expected '"+t+"'";return n(function(n,r,o){var s=n.slice(0,e);return s===t?r(n.slice(e),s):o(n,i)})},o=this.regex=function(t){r("regexp parser is anchored","^"===t.toString().charAt(1));var e="expected "+t;return n(function(n,i,r){var o,s=t.exec(n);return s?(o=s[0],i(n.slice(o.length),o)):r(n,e)})},s=n.succeed=function(t){return n(function(e,n){return n(e,t)})},n.fail=function(t){return n(function(e,n,i){return i(e,t)})},n.letter=o(/^[a-z]/i),n.letters=o(/^[a-z]*/i),n.digit=o(/^[0-9]/),n.digits=o(/^[0-9]*/),n.whitespace=o(/^\s+/),n.optWhitespace=o(/^\s*/),n.any=n(function(t,e,n){return t?e(t.slice(1),t.charAt(0)):n(t,"expected any character")}),n.all=n(function(t,e,n){return e("",t)}),a=n.eof=n(function(t,e,n){return t?n(t,"expected EOF"):e(t,t)})}),_=function(){function e(t){var e,i=t.which||t.keyCode,r=n[i],o=[];return t.ctrlKey&&o.push("Ctrl"),t.originalEvent&&t.originalEvent.metaKey&&o.push("Meta"),t.altKey&&o.push("Alt"),t.shiftKey&&o.push("Shift"),e=r||String.fromCharCode(i),o.length||r?(o.push(e),o.join("-")):e}var n={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"};return function(n,i){function r(t){f=t,clearTimeout(l),l=setTimeout(t)}function o(){i.keystroke(e(c),c)}function s(){if(!function(){var t=h[0];return"selectionStart"in t&&t.selectionStart!==t.selectionEnd}()){var t=h.val();1===t.length?(h.val(""),i.typedText(t)):t&&h[0].select&&h[0].select()}}function a(){var t=h.val();h.val(""),t&&i.paste(t)}var l,u,c=null,d=null,h=ht(n),p=ht(i.container||h),f=t;return p.bind("keydown keypress input keyup focusout paste",function(t){f(t)}),u=!1,p.bind({keydown:function(e){c=e,d=null,u&&r(function(e){e&&"focusout"===e.type||!h[0].select||h[0].select(),f=t,clearTimeout(l)}),o()},keypress:function(t){c&&d&&o(),d=t,r(s)},focusout:function(){c=d=null},paste:function(t){h.focus(),r(a)}}),{select:function(e){f(),f=t,clearTimeout(l),h.val(e),e&&h[0].select&&h[0].select(),u=!!e}}}}(),Ot.open(function(t,e){t.exportText=function(){return this.root.foldChildren("",function(t,e){return t+e.text()})}}),Ot.open(function(t){t.focusBlurEvents=function(){function t(){clearTimeout(n),o.selection&&o.selection.jQ.addClass("mq-blur"),e()}function e(){o.hide().parent.blur(),i.container.removeClass("mq-focused"),wt(window).off("blur",t)}var n,i=this,r=i.root,o=i.cursor;i.textarea.focus(function(){i.blurred=!1,clearTimeout(n),i.container.addClass("mq-focused"),o.parent||o.insAtRightEnd(r),o.selection?(o.selection.jQ.removeClass("mq-blur"),i.selectionChanged()):o.show()}).blur(function(){i.blurred=!0,n=setTimeout(function(){r.postOrder("intentionalBlur"),o.clearSelection().endSelection(),e()}),wt(window).on("blur",t)}),i.blurred=!0,o.hide().parent.blur()}}),Ot.open(function(t){t.keystroke=function(t,e){this.cursor.parent.keystroke(t,e,this)}}),kt.open(function(t){t.keystroke=function(t,e,n){var i=n.cursor;switch(t){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":n.ctrlDeleteDir(_t);break;case"Shift-Backspace":case"Backspace":n.backspace();break;case"Esc":case"Tab":return void n.escapeDir(xt,t,e);case"Shift-Tab":case"Shift-Esc":return void n.escapeDir(_t,t,e);case"End":n.notify("move").cursor.insAtRightEnd(i.parent);break;case"Ctrl-End":n.notify("move").cursor.insAtRightEnd(n.root);break;case"Shift-End":for(;i[xt];)n.selectRight();break;case"Ctrl-Shift-End":for(;i[xt]||i.parent!==n.root;)n.selectRight();break;case"Home":n.notify("move").cursor.insAtLeftEnd(i.parent);break;case"Ctrl-Home":n.notify("move").cursor.insAtLeftEnd(n.root);break;case"Shift-Home":for(;i[_t];)n.selectLeft();break;case"Ctrl-Shift-Home":for(;i[_t]||i.parent!==n.root;)n.selectLeft();break;case"Left":n.moveLeft();break;case"Shift-Left":n.selectLeft();break;case"Ctrl-Left":break;case"Right":n.moveRight();break;case"Shift-Right":n.selectRight();break;case"Ctrl-Right":break;case"Up":n.moveUp();break;case"Down":n.moveDown();break;case"Shift-Up":if(i[_t])for(;i[_t];)n.selectLeft();else n.selectLeft();case"Shift-Down":if(i[xt])for(;i[xt];)n.selectRight();else n.selectRight();case"Ctrl-Up":case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":n.ctrlDeleteDir(xt);break;case"Shift-Del":case"Del":n.deleteForward();break;case"Meta-A":case"Ctrl-A":for(n.notify("move").cursor.insAtRightEnd(n.root);i[_t];)n.selectLeft();break;default:return}e.preventDefault(),n.scrollHoriz()},t.moveOutOf=t.moveTowards=t.deleteOutOf=t.deleteTowards=t.unselectInto=t.selectOutOf=t.selectTowards=function(){r("overridden or never called on this node")}}),Ot.open(function(t){function e(t,e){var n=t.notify("upDown").cursor,i=e+"Into",r=e+"OutOf";return n[xt][i]?n.insAtLeftEnd(n[xt][i]):n[_t][i]?n.insAtRightEnd(n[_t][i]):n.parent.bubble(function(t){var e=t[r];return(!e||("function"==typeof e&&(e=t[r](n)),e instanceof kt&&n.jumpUpDown(t,e),!0===e))&&void 0}),t}this.onNotify(function(t){("move"===t||"upDown"===t)&&this.show().clearSelection()}),t.escapeDir=function(t,e,n){o(t);var i=this.cursor;return i.parent!==this.root&&n.preventDefault(),i.parent!==this.root?(i.parent.moveOutOf(t,i),this.notify("move")):void 0},Pt.leftRightIntoCmdGoes=function(t){if(t&&"up"!==t&&"down"!==t)throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+t+'"';return t},t.moveDir=function(t){o(t);var e=this.cursor,n=e.options.leftRightIntoCmdGoes;return e.selection?e.insDirOf(t,e.selection.ends[t]):e[t]?e[t].moveTowards(t,e,n):e.parent.moveOutOf(t,e,n),this.notify("move")},t.moveLeft=function(){return this.moveDir(_t)},t.moveRight=function(){return this.moveDir(xt)},t.moveUp=function(){return e(this,"up")},t.moveDown=function(){return e(this,"down")},this.onNotify(function(t){"upDown"!==t&&(this.upDownCache={})}),this.onNotify(function(t){"edit"===t&&this.show().deleteSelection()}),t.deleteDir=function(t){var e,n;return o(t),n=(e=this.cursor).selection,this.notify("edit"),n||(e[t]?e[t].deleteTowards(t,e):e.parent.deleteOutOf(t,e)),e[_t].siblingDeleted&&e[_t].siblingDeleted(e.options,xt),e[xt].siblingDeleted&&e[xt].siblingDeleted(e.options,_t),e.parent.bubble("reflow"),this},t.ctrlDeleteDir=function(t){o(t);var e=this.cursor;return!e[_t]||e.selection?ctrlr.deleteDir():(this.notify("edit"),Tt(e.parent.ends[_t],e[_t]).remove(),e.insAtDirEnd(_t,e.parent),e[_t].siblingDeleted&&e[_t].siblingDeleted(e.options,xt),e[xt].siblingDeleted&&e[xt].siblingDeleted(e.options,_t),e.parent.bubble("reflow"),this)},t.backspace=function(){return this.deleteDir(_t)},t.deleteForward=function(){return this.deleteDir(xt)},this.onNotify(function(t){"select"!==t&&this.endSelection()}),t.selectDir=function(t){var e,n=this.notify("select").cursor,i=n.selection;o(t),n.anticursor||n.startSelection(),(e=n[t])?i&&i.ends[t]===e&&n.anticursor[-t]!==e?e.unselectInto(t,n):e.selectTowards(t,n):n.parent.selectOutOf(t,n),n.clearSelection(),n.select()||n.show()},t.selectLeft=function(){return this.selectDir(_t)},t.selectRight=function(){return this.selectDir(xt)}}),x=function(){function t(t){var e,n=t[0]||M();for(e=1;e<t.length;e+=1)t[e].children().adopt(n,n.ends[xt],0);return n}var e=b.string,n=b.regex,i=b.letter,r=b.any,o=b.optWhitespace,s=b.succeed,a=b.fail,l=i.map(function(t){return D(t)}),u=n(/^[^${}\\_^]/).map(function(t){return T(t)}),c=n(/^[^\\a-eg-zA-Z]/).or(e("\\").then(n(/^[a-z]+/i).or(n(/^\s+/).result(" ")).or(r))).then(function(t){var e=St[t];return e?e(t).parser():a("unknown command: \\"+t)}).or(l).or(u),d=e("{").then(function(){return p}).skip(e("}")),h=o.then(d.or(c.map(function(t){var e=M();return t.adopt(e,0,0),e}))),p=h.many().map(t).skip(o),f=e("[").then(h.then(function(t){return"]"!==t.join("latex")?s(t):a()}).many().map(t).skip(o)).skip(e("]")),g=p;return g.block=h,g.optBlock=f,g}(),Ot.open(function(t,e){t.exportLatex=function(){return this.root.latex().replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},t.writeLatex=function(t){var e=this.notify("edit").cursor,n=b.all,i=b.eof,r=x.skip(i).or(n.result(!1)).parse(t);return r&&!r.isEmpty()&&(r.children().adopt(e.parent,e[_t],e[xt]),r.jQize().insertBefore(e.jQ),e[_t]=r.ends[xt],r.finalizeInsert(e.options,e),r.ends[xt][xt].siblingCreated&&r.ends[xt][xt].siblingCreated(e.options,_t),r.ends[_t][_t].siblingCreated&&r.ends[_t][_t].siblingCreated(e.options,xt),e.parent.bubble("reflow")),this},t.renderLatexMath=function(t){var e,n,i=this.root,r=this.cursor,o=b.all,s=b.eof,a=x.skip(s).or(o.result(!1)).parse(t);i.eachChild("postOrder","dispose"),i.ends[_t]=i.ends[xt]=0,a&&a.children().adopt(i,0,0),e=i.jQ,a?(n=a.join("html"),e.html(n),i.jQize(e.children()),i.finalizeInsert(r.options)):e.empty(),delete r.selection,r.insAtRightEnd(i)},t.renderLatexText=function(t){var e,n,i,r,o,s,a,l,u=this.root,c=this.cursor;if(u.jQ.children().slice(1).remove(),u.eachChild("postOrder","dispose"),u.ends[_t]=u.ends[xt]=0,delete c.selection,c.show().insAtRightEnd(u),e=b.regex,n=b.string,i=b.eof,r=b.all,o=n("$").then(x).skip(n("$").or(i)).map(function(t){var e,n=q(c);return n.createBlocks(),e=n.ends[_t],t.children().adopt(e,0,0),n}),s=n("\\$").result("$").or(e(/^[^$]/)).map(T),a=o.or(s).many().skip(i).or(r.result(!1)).parse(t)){for(l=0;l<a.length;l+=1)a[l].adopt(u,u.ends[xt],0);u.jQize().appendTo(u.jQ),u.finalizeInsert(c.options)}}}),Ot.open(function(e){e.delegateMouseEvents=function(){var e=this.root.jQ;this.container.bind("mousedown.mathquill",function(n){function i(t){o=wt(t.target)}function r(t){l.anticursor||l.startSelection(),a.seek(o,t.pageX,t.pageY).cursor.select(),o=g}var o,s=wt(n.target).closest(".mq-root-block"),a=kt.byId[s.attr(ft)||e.attr(ft)].controller,l=a.cursor,u=l.blink,c=a.textareaSpan,d=a.textarea;a.blurred&&(a.editable||s.prepend(c),d.focus()),n.preventDefault(),n.target.unselectable=!0,l.blink=t,a.seek(wt(n.target),n.pageX,n.pageY).cursor.startSelection(),s.mousemove(i),wt(n.target.ownerDocument).mousemove(r).mouseup(function t(e){l.blink=u,l.selection||(a.editable?l.show():c.detach()),s.unbind("mousemove",i),wt(e.target.ownerDocument).unbind("mousemove",r).unbind("mouseup",t)})})}}),Ot.open(function(t){t.seek=function(t,e,n){var i,o,s,a=this.notify("select").cursor;return t&&((i=t.attr(ft)||t.attr(pt))||(i=(o=t.parent()).attr(ft)||o.attr(pt))),r("nodeId is the id of some Node that exists",s=i?kt.byId[i]:this.root),a.clearSelection().show(),s.seek(e,a),this.scrollHoriz(),this}}),Ot.open(function(t){t.scrollHoriz=function(){var t,e,n,i,r,o=this.cursor,s=o.selection,a=this.root.jQ[0].getBoundingClientRect();if(s)if(i=(n=s.jQ[0].getBoundingClientRect()).left-(a.left+20),r=n.right-(a.right-20),s.ends[_t]===o[xt])if(0>i)e=i;else{if(!(r>0))return;e=n.left-r<a.left+20?i:r}else if(r>0)e=r;else{if(!(0>i))return;e=n.right-i>a.right-20?r:i}else if((t=o.jQ[0].getBoundingClientRect().left)>a.right-20)e=t-(a.right-20);else{if(!(t<a.left+20))return;e=t-(a.left+20)}this.root.jQ.stop().animate({scrollLeft:"+="+e},100)}}),Ot.open(function(t){Ct.p.substituteTextarea=function(){return wt("<textarea autocapitalize=off autocomplete=off autocorrect=off spellcheck=false x-palm-disable-ste-all=true />")[0]},t.createTextarea=function(){var t,e=this.textareaSpan=wt('<span class="mq-textarea"></span>'),n=this.options.substituteTextarea();if(!n.nodeType)throw"substituteTextarea() must return a DOM element, got "+n;n=this.textarea=wt(n).appendTo(e),(t=this).cursor.selectionChanged=function(){t.selectionChanged()},t.container.bind("copy",function(){t.setTextareaSelection()})},t.selectionChanged=function(){var t=this;K(t.container[0]),t.textareaSelectionTimeout===g&&(t.textareaSelectionTimeout=setTimeout(function(){t.setTextareaSelection()}))},t.setTextareaSelection=function(){this.textareaSelectionTimeout=g;var t="";this.cursor.selection&&(t=this.cursor.selection.join("latex"),this.options.statelessClipboard&&(t="$"+t+"$")),this.selectFn(t)},t.staticMathTextareaEvents=function(){function t(){r.detach(),e.blurred=!0}var e=this,n=(e.root,e.cursor),i=e.textarea,r=e.textareaSpan;this.container.prepend('<span class="mq-selectable">$'+e.exportLatex()+"$</span>"),e.blurred=!0,i.bind("cut paste",!1).focus(function(){e.blurred=!1}).blur(function(){n.selection&&n.selection.clear(),setTimeout(t)}),e.selectFn=function(t){i.val(t),t&&i.select()}},t.editablesTextareaEvents=function(){var t=this,e=(t.root,t.cursor),n=t.textarea,i=t.textareaSpan,r=_(n,this);this.selectFn=function(t){r.select(t)},this.container.prepend(i).on("cut",function(n){e.selection&&setTimeout(function(){t.notify("edit"),e.parent.bubble("reflow")})}),this.focusBlurEvents()},t.typedText=function(t){if("\n"===t)return this.handle("enter");var e=this.notify().cursor;e.parent.write(e,t),this.scrollHoriz()},t.paste=function(t){this.options.statelessClipboard&&(t="$"===t.slice(0,1)&&"$"===t.slice(-1)?t.slice(1,-1):"\\text{"+t+"}"),this.writeLatex(t).cursor.show()}}),w=bt(kt,function(t,e){t.finalizeInsert=function(t,e){var n=this;n.postOrder("finalizeTree",t),n.postOrder("contactWeld",e),n.postOrder("blur"),n.postOrder("reflow"),n[xt].siblingCreated&&n[xt].siblingCreated(t,_t),n[_t].siblingCreated&&n[_t].siblingCreated(t,xt),n.bubble("reflow")}}),A=bt(w,function(t,e){t.init=function(t,n,i){var r=this;e.init.call(r),r.ctrlSeq||(r.ctrlSeq=t),n&&(r.htmlTemplate=n),i&&(r.textTemplate=i)},t.replaces=function(t){t.disown(),this.replacedFragment=t},t.isEmpty=function(){return this.foldChildren(!0,function(t,e){return t&&e.isEmpty()})},t.parser=function(){var t=this;return x.block.times(t.numBlocks()).map(function(e){t.blocks=e;for(var n=0;n<e.length;n+=1)e[n].adopt(t,t.ends[xt],0);return t})},t.createLeftOf=function(t){var n=this,i=n.replacedFragment;n.createBlocks(),e.createLeftOf.call(n,t),i&&(i.adopt(n.ends[_t],0,0),i.jQ.appendTo(n.ends[_t].jQ)),n.finalizeInsert(t.options),n.placeCursor(t)},t.createBlocks=function(){var t,e=this,n=e.numBlocks(),i=e.blocks=Array(n);for(t=0;n>t;t+=1)(i[t]=M()).adopt(e,e.ends[xt],0)},t.placeCursor=function(t){t.insAtRightEnd(this.foldChildren(this.ends[_t],function(t,e){return t.isEmpty()?t:e}))},t.moveTowards=function(t,e,n){var i=n&&this[n+"Into"];e.insAtDirEnd(-t,i||this.ends[-t])},t.deleteTowards=function(t,e){this.isEmpty()?e[t]=this.remove()[t]:this.moveTowards(t,e,null)},t.selectTowards=function(t,e){e[-t]=this,e[t]=this[t]},t.selectChildren=function(){return Nt(this,this)},t.unselectInto=function(t,e){e.insAtDirEnd(-t,e.anticursor.ancestors[this.id])},t.seek=function(t,e){function n(t){var e={};return e[_t]=t.jQ.offset().left,e[xt]=e[_t]+t.jQ.outerWidth(),e}var i,r=this,o=n(r);return t<o[_t]?e.insLeftOf(r):t>o[xt]?e.insRightOf(r):(i=o[_t],void r.eachChild(function(s){var a=n(s);return t<a[_t]?(t-i<a[_t]-t?s[_t]?e.insAtRightEnd(s[_t]):e.insLeftOf(r):e.insAtLeftEnd(s),!1):t>a[xt]?void(s[xt]?i=a[xt]:o[xt]-t<t-a[xt]?e.insRightOf(r):e.insAtRightEnd(s)):(s.seek(t,e),!1)}))},t.numBlocks=function(){var t=this.htmlTemplate.match(/&\d+/g);return t?t.length:0},t.html=function(){var t,e,n,i=this,o=i.blocks,s=" mathquill-command-id="+i.id,a=i.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);for(r("no unmatched angle brackets",a.join("")===this.htmlTemplate),t=0,e=a[0];e;e=a[t+=1])if("/>"===e.slice(-2))a[t]=e.slice(0,-2)+s+"/>";else if("<"===e.charAt(0)){r("not an unmatched top-level close tag","/"!==e.charAt(1)),a[t]=e.slice(0,-1)+s+">",n=1;do{r("no missing close tags",e=a[t+=1]),"</"===e.slice(0,2)?n-=1:"<"===e.charAt(0)&&"/>"!==e.slice(-2)&&(n+=1)}while(n>0)}return a.join("").replace(/>&(\d+)/g,function(t,e){return" mathquill-block-id="+o[e].id+">"+o[e].join("html")})},t.latex=function(){return this.foldChildren(this.ctrlSeq,function(t,e){return t+"{"+(e.latex()||" ")+"}"})},t.textTemplate=[""],t.text=function(){var t=this,e=0;return t.foldChildren(t.textTemplate[e],function(n,i){e+=1;var r=i.text();return n&&"("===t.textTemplate[e]&&"("===r[0]&&")"===r.slice(-1)?n+r.slice(1,-1)+t.textTemplate[e]:n+i.text()+(t.textTemplate[e]||"")})}}),k=bt(A,function(e,n){e.init=function(t,e,i){i||(i=t&&t.length>1?t.slice(1):t),n.init.call(this,t,e,[i])},e.parser=function(){return b.succeed(this)},e.numBlocks=function(){return 0},e.replaces=function(t){t.remove()},e.createBlocks=t,e.moveTowards=function(t,e){e.jQ.insDirOf(t,this.jQ),e[-t]=this,e[t]=this[t]},e.deleteTowards=function(t,e){e[t]=this.remove()[t]},e.seek=function(t,e){t-this.jQ.offset().left<this.jQ.outerWidth()/2?e.insLeftOf(this):e.insRightOf(this)},e.latex=function(){return this.ctrlSeq},e.text=function(){return this.textTemplate},e.placeCursor=t,e.isEmpty=function(){return!0}}),T=bt(k,function(t,e){t.init=function(t,n){e.init.call(this,t,"<span>"+(n||t)+"</span>")}}),S=bt(k,function(t,e){t.init=function(t,n,i){e.init.call(this,t,'<span class="mq-binary-operator">'+n+"</span>",i)}}),M=bt(w,function(t,e){t.join=function(t){return this.foldChildren("",function(e,n){return e+n[t]()})},t.html=function(){return this.join("html")},t.latex=function(){return this.join("latex")},t.text=function(){return this.ends[_t]===this.ends[xt]&&0!==this.ends[_t]?this.ends[_t].text():this.join("text")},t.keystroke=function(t,n,i){return!i.options.spaceBehavesLikeTab||"Spacebar"!==t&&"Shift-Spacebar"!==t?e.keystroke.apply(this,arguments):(n.preventDefault(),void i.escapeDir("Shift-Spacebar"===t?_t:xt,t,n))},t.moveOutOf=function(t,e,n){n&&this.parent[n+"Into"]||!this[t]?e.insDirOf(t,this.parent):e.insAtDirEnd(-t,this[t])},t.selectOutOf=function(t,e){e.insDirOf(t,this.parent)},t.deleteOutOf=function(t,e){e.unwrapGramp()},t.seek=function(t,e){var n=this.ends[xt];if(!n||n.jQ.offset().left+n.jQ.outerWidth()<t)return e.insAtRightEnd(this);if(t<this.ends[_t].jQ.offset().left)return e.insAtLeftEnd(this);for(;t<n.jQ.offset().left;)n=n[_t];return n.seek(t,e)},t.chToCmd=function(t){var e;return t.match(/^[a-eg-zA-Z]$/)?D(t):/^\d$/.test(t)?P(t):(e=Mt[t]||St[t])?e(t):T(t)},t.write=function(t,e){var n=this.chToCmd(e);t.selection&&n.replaces(t.replaceSelection()),n.createLeftOf(t.show())},t.focus=function(){return this.jQ.addClass("mq-hasCursor"),this.jQ.removeClass("mq-empty"),this},t.blur=function(){return this.jQ.removeClass("mq-hasCursor"),this.isEmpty()&&this.jQ.addClass("mq-empty"),this}}),qt.StaticMath=function(t){return bt(t.AbstractMathQuill,function(e,n){this.RootBlock=M,e.__mathquillify=function(){return n.__mathquillify.call(this,"mq-math-mode"),this.__controller.delegateMouseEvents(),this.__controller.staticMathTextareaEvents(),this},e.init=function(){n.init.apply(this,arguments),this.__controller.root.postOrder("registerInnerField",this.innerFields=[],t.MathField)},e.latex=function(){var e=n.latex.apply(this,arguments);return arguments.length>0&&this.__controller.root.postOrder("registerInnerField",this.innerFields=[],t.MathField),e}})},E=bt(M,c),qt.MathField=function(e){return bt(e.EditableField,function(e,n){this.RootBlock=E,e.__mathquillify=function(e,i){return this.config(e),i>1&&(this.__controller.root.reflow=t),n.__mathquillify.call(this,"mq-editable-field mq-math-mode"),delete this.__controller.root.reflow,this}})},N=bt(kt,function(t,e){function n(t){var e,n;return t.jQ[0].normalize(),r("only node in TextBlock span is Text node",3===(e=t.jQ[0].firstChild).nodeType),(n=O(e.data)).jQadd(e),t.children().disown(),n.adopt(t,0,0)}t.ctrlSeq="\\text",t.replaces=function(t){t instanceof Tt?this.replacedText=t.remove().jQ.text():"string"==typeof t&&(this.replacedText=t)},t.jQadd=function(t){e.jQadd.call(this,t),this.ends[_t]&&this.ends[_t].jQadd(this.jQ[0].firstChild)},t.createLeftOf=function(t){var n,i=this;if(e.createLeftOf.call(this,t),i[xt].siblingCreated&&i[xt].siblingCreated(t.options,_t),i[_t].siblingCreated&&i[_t].siblingCreated(t.options,xt),i.bubble("reflow"),t.insAtRightEnd(i),i.replacedText)for(n=0;n<i.replacedText.length;n+=1)i.write(t,i.replacedText.charAt(n))},t.parser=function(){var t=this,e=b.string,n=b.regex;return b.optWhitespace.then(e("{")).then(n(/^[^}]*/)).skip(e("}")).map(function(e){return O(e).adopt(t,0,0),t})},t.textContents=function(){return this.foldChildren("",function(t,e){return t+e.text})},t.text=function(){return'"'+this.textContents()+'"'},t.latex=function(){return"\\text{"+this.textContents()+"}"},t.html=function(){return'<span class="mq-text-mode" mathquill-command-id='+this.id+">"+this.textContents()+"</span>"},t.moveTowards=function(t,e){e.insAtDirEnd(-t,this)},t.moveOutOf=function(t,e){e.insDirOf(t,this)},t.unselectInto=t.moveTowards,t.selectTowards=A.prototype.selectTowards,t.deleteTowards=A.prototype.deleteTowards,t.selectOutOf=function(t,e){e.insDirOf(t,this)},t.deleteOutOf=function(t,e){this.isEmpty()&&e.insRightOf(this)},t.write=function(t,n){var i,r;t.show().deleteSelection(),"$"!==n?t[_t]?t[_t].appendText(n):O(n).createLeftOf(t):this.isEmpty()?(t.insRightOf(this),T("\\$","$").createLeftOf(t)):t[xt]?t[_t]?(i=N(),(r=this.ends[_t]).disown(),r.adopt(i,0,0),t.insLeftOf(this),e.createLeftOf.call(i,t)):t.insLeftOf(this):t.insRightOf(this)},t.seek=function(t,e){var i,r,o,s,a,l,u,c;for(e.hide(),i=n(this),r=this.jQ.width()/this.text.length,0>=(o=Math.round((t-this.jQ.offset().left)/r))?e.insAtLeftEnd(this):o>=i.text.length?e.insAtRightEnd(this):e.insLeftOf(i.splitRight(o)),l=a=(s=t-e.show().offset().left)&&0>s?_t:xt;e[a]&&s*l>0;)e[a].moveTowards(a,e),l=s,s=t-e.offset().left;-a*l>a*s&&e[-a].moveTowards(-a,e),e.anticursor?e.anticursor.parent===this&&(u=e[_t]&&e[_t].text.length,this.anticursorPosition===u?e.anticursor=At.copy(e):(this.anticursorPosition<u?(c=e[_t].splitRight(this.anticursorPosition),e[_t]=c):c=e[xt].splitRight(this.anticursorPosition-u),e.anticursor=At(this,c[_t],c))):this.anticursorPosition=e[_t]&&e[_t].text.length},t.blur=function(){M.prototype.blur.call(this),n(this)},t.focus=M.prototype.focus}),O=bt(kt,function(t,e){function n(t,e){return e.charAt(t===_t?0:-1+e.length)}t.init=function(t){e.init.call(this),this.text=t},t.jQadd=function(t){this.dom=t,this.jQ=wt(t)},t.jQize=function(){return this.jQadd(document.createTextNode(this.text))},t.appendText=function(t){this.text+=t,this.dom.appendData(t)},t.prependText=function(t){this.text=t+this.text,this.dom.insertData(0,t)},t.insTextAtDirEnd=function(t,e){o(e),e===xt?this.appendText(t):this.prependText(t)},t.splitRight=function(t){var e=O(this.text.slice(t)).adopt(this.parent,this,this[xt]);return e.jQadd(this.dom.splitText(t)),this.text=this.text.slice(0,t),e},t.moveTowards=function(t,e){var i,r;return o(t),i=n(-t,this.text),(r=this[-t])?r.insTextAtDirEnd(i,t):O(i).createDir(-t,e),this.deleteTowards(t,e)},t.latex=function(){return this.text},t.deleteTowards=function(t,e){this.text.length>1?t===xt?(this.dom.deleteData(0,1),this.text=this.text.slice(1)):(this.dom.deleteData(-1+this.text.length,1),this.text=this.text.slice(0,-1)):(this.remove(),this.jQ.remove(),e[t]=this[t])},t.selectTowards=function(t,e){var i,r,s,a;return o(t),i=e.anticursor,r=n(-t,this.text),i[t]===this?(s=O(r).createDir(t,e),i[t]=s,e.insDirOf(t,s)):((a=this[-t])?a.insTextAtDirEnd(r,t):(s=O(r).createDir(-t,e)).jQ.insDirOf(-t,e.selection.jQ),1===this.text.length&&i[-t]===this&&(i[-t]=this[-t])),this.deleteTowards(t,e)}}),Mt.$=St.text=St.textnormal=St.textrm=St.textup=St.textmd=N,St.em=St.italic=St.italics=St.emph=St.textit=St.textsl=d("\\textit","i",'class="mq-text-mode"'),St.strong=St.bold=St.textbf=d("\\textbf","b",'class="mq-text-mode"'),St.sf=St.textsf=d("\\textsf","span",'class="mq-sans-serif mq-text-mode"'),St.tt=St.texttt=d("\\texttt","span",'class="mq-monospace mq-text-mode"'),St.textsc=d("\\textsc","span",'style="font-variant:small-caps" class="mq-text-mode"'),St.uppercase=d("\\uppercase","span",'style="text-transform:uppercase" class="mq-text-mode"'),St.lowercase=d("\\lowercase","span",'style="text-transform:lowercase" class="mq-text-mode"'),q=bt(A,function(t,e){t.init=function(t){e.init.call(this,"$"),this.cursor=t},t.htmlTemplate='<span class="mq-math-mode">&0</span>',t.createBlocks=function(){e.createBlocks.call(this),this.ends[_t].cursor=this.cursor,this.ends[_t].write=function(t,e){"$"!==e?M.prototype.write.call(this,t,e):this.isEmpty()?(t.insRightOf(this.parent),this.parent.deleteTowards(dir,t),T("\\$","$").createLeftOf(t.show())):t[xt]?t[_t]?M.prototype.write.call(this,t,e):t.insLeftOf(this.parent):t.insRightOf(this.parent)}},t.latex=function(){return"$"+this.ends[_t].latex()+"$"}}),C=bt(E,function(t,e){t.keystroke=function(t){return"Spacebar"!==t&&"Shift-Spacebar"!==t?e.keystroke.apply(this,arguments):void 0},t.write=function(t,e){var n;t.show().deleteSelection(),"$"===e?q(t).createLeftOf(t):("<"===e?n="&lt;":">"===e&&(n="&gt;"),T(e,n).createLeftOf(t))}}),qt.TextField=function(t){return bt(t.EditableField,function(t,e){this.RootBlock=C,t.__mathquillify=function(){return e.__mathquillify.call(this,"mq-editable-field mq-text-mode")},t.latex=function(t){return arguments.length>0?(this.__controller.renderLatexText(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()}})},Mt["\\"]=bt(A,function(t,e){t.ctrlSeq="\\",t.replaces=function(t){this._replacedFragment=t.disown(),this.isEmpty=function(){return!1}},t.htmlTemplate='<span class="mq-latex-command-input mq-non-leaf">\\<span>&0</span></span>',t.textTemplate=["\\"],t.createBlocks=function(){e.createBlocks.call(this),this.ends[_t].focus=function(){return this.parent.jQ.addClass("mq-hasCursor"),this.isEmpty()&&this.parent.jQ.removeClass("mq-empty"),this},this.ends[_t].blur=function(){return this.parent.jQ.removeClass("mq-hasCursor"),this.isEmpty()&&this.parent.jQ.addClass("mq-empty"),this},this.ends[_t].write=function(t,e){t.show().deleteSelection(),e.match(/[a-z]/i)?T(e).createLeftOf(t):(this.parent.renderCommand(t),"\\"===e&&this.isEmpty()||this.parent.parent.write(t,e))},this.ends[_t].keystroke=function(t,n,i){return"Tab"===t||"Enter"===t||"Spacebar"===t?(this.parent.renderCommand(i.cursor),void n.preventDefault()):e.keystroke.apply(this,arguments)}},t.createLeftOf=function(t){if(e.createLeftOf.call(this,t),this._replacedFragment){var n=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("mq-blur").bind("mousedown mousemove",function(t){return wt(t.target=n).trigger(t),!1}).insertBefore(this.jQ).add(this.jQ)}},t.latex=function(){return"\\"+this.ends[_t].latex()+" "},t.renderCommand=function(t){var e,n;this.jQ=this.jQ.last(),this.remove(),this[xt]?t.insLeftOf(this[xt]):t.insAtRightEnd(this.parent),(e=this.ends[_t].latex())||(e=" "),(n=St[e])?(n=n(e),this._replacedFragment&&n.replaces(this._replacedFragment),n.createLeftOf(t)):((n=N()).replaces(e),n.createLeftOf(t),t.insRightOf(n),this._replacedFragment&&this._replacedFragment.remove())}}),St.notin=St.cong=St.equiv=St.oplus=St.otimes=bt(S,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}}),St["≠"]=St.ne=St.neq=i(S,"\\ne ","&ne;"),St.ast=St.star=St.loast=St.lowast=i(S,"\\ast ","&lowast;"),St.therefor=St.therefore=i(S,"\\therefore ","&there4;"),St.cuz=St.because=i(S,"\\because ","&#8757;"),St.prop=St.propto=i(S,"\\propto ","&prop;"),St["≈"]=St.asymp=St.approx=i(S,"\\approx ","&asymp;"),St.isin=St.in=i(S,"\\in ","&isin;"),St.ni=St.contains=i(S,"\\ni ","&ni;"),St.notni=St.niton=St.notcontains=St.doesnotcontain=i(S,"\\not\\ni ","&#8716;"),St.sub=St.subset=i(S,"\\subset ","&sub;"),St.sup=St.supset=St.superset=i(S,"\\supset ","&sup;"),St.nsub=St.notsub=St.nsubset=St.notsubset=i(S,"\\not\\subset ","&#8836;"),St.nsup=St.notsup=St.nsupset=St.notsupset=St.nsuperset=St.notsuperset=i(S,"\\not\\supset ","&#8837;"),St.sube=St.subeq=St.subsete=St.subseteq=i(S,"\\subseteq ","&sube;"),St.supe=St.supeq=St.supsete=St.supseteq=St.supersete=St.superseteq=i(S,"\\supseteq ","&supe;"),St.nsube=St.nsubeq=St.notsube=St.notsubeq=St.nsubsete=St.nsubseteq=St.notsubsete=St.notsubseteq=i(S,"\\not\\subseteq ","&#8840;"),St.nsupe=St.nsupeq=St.notsupe=St.notsupeq=St.nsupsete=St.nsupseteq=St.notsupsete=St.notsupseteq=St.nsupersete=St.nsuperseteq=St.notsupersete=St.notsuperseteq=i(S,"\\not\\supseteq ","&#8841;"),St.N=St.naturals=St.Naturals=i(T,"\\mathbb{N}","&#8469;"),St.P=St.primes=St.Primes=St.projective=St.Projective=St.probability=St.Probability=i(T,"\\mathbb{P}","&#8473;"),St.Z=St.integers=St.Integers=i(T,"\\mathbb{Z}","&#8484;"),St.Q=St.rationals=St.Rationals=i(T,"\\mathbb{Q}","&#8474;"),St.R=St.reals=St.Reals=i(T,"\\mathbb{R}","&#8477;"),St.C=St.complex=St.Complex=St.complexes=St.Complexes=St.complexplane=St.Complexplane=St.ComplexPlane=i(T,"\\mathbb{C}","&#8450;"),St.H=St.Hamiltonian=St.quaternions=St.Quaternions=i(T,"\\mathbb{H}","&#8461;"),St.quad=St.emsp=i(T,"\\quad ","    "),St.qquad=i(T,"\\qquad ","        "),St.diamond=i(T,"\\diamond ","&#9671;"),St.bigtriangleup=i(T,"\\bigtriangleup ","&#9651;"),St.ominus=i(T,"\\ominus ","&#8854;"),St.uplus=i(T,"\\uplus ","&#8846;"),St.bigtriangledown=i(T,"\\bigtriangledown ","&#9661;"),St.sqcap=i(T,"\\sqcap ","&#8851;"),St.triangleleft=i(T,"\\triangleleft ","&#8882;"),St.sqcup=i(T,"\\sqcup ","&#8852;"),St.triangleright=i(T,"\\triangleright ","&#8883;"),St.odot=St.circledot=i(T,"\\odot ","&#8857;"),St.bigcirc=i(T,"\\bigcirc ","&#9711;"),St.dagger=i(T,"\\dagger ","&#0134;"),St.ddagger=i(T,"\\ddagger ","&#135;"),St.wr=i(T,"\\wr ","&#8768;"),St.amalg=i(T,"\\amalg ","&#8720;"),St.models=i(T,"\\models ","&#8872;"),St.prec=i(T,"\\prec ","&#8826;"),St.succ=i(T,"\\succ ","&#8827;"),St.preceq=i(T,"\\preceq ","&#8828;"),St.succeq=i(T,"\\succeq ","&#8829;"),St.simeq=i(T,"\\simeq ","&#8771;"),St.mid=i(T,"\\mid ","&#8739;"),St.ll=i(T,"\\ll ","&#8810;"),St.gg=i(T,"\\gg ","&#8811;"),St.parallel=i(T,"\\parallel ","&#8741;"),St.nparallel=i(T,"\\nparallel ","&#8742;"),St.bowtie=i(T,"\\bowtie ","&#8904;"),St.sqsubset=i(T,"\\sqsubset ","&#8847;"),St.sqsupset=i(T,"\\sqsupset ","&#8848;"),St.smile=i(T,"\\smile ","&#8995;"),St.sqsubseteq=i(T,"\\sqsubseteq ","&#8849;"),St.sqsupseteq=i(T,"\\sqsupseteq ","&#8850;"),St.doteq=i(T,"\\doteq ","&#8784;"),St.frown=i(T,"\\frown ","&#8994;"),St.vdash=i(T,"\\vdash ","&#8870;"),St.dashv=i(T,"\\dashv ","&#8867;"),St.nless=i(T,"\\nless ","&#8814;"),St.ngtr=i(T,"\\ngtr ","&#8815;"),St.longleftarrow=i(T,"\\longleftarrow ","&#8592;"),St.longrightarrow=i(T,"\\longrightarrow ","&#8594;"),St.Longleftarrow=i(T,"\\Longleftarrow ","&#8656;"),St.Longrightarrow=i(T,"\\Longrightarrow ","&#8658;"),St.longleftrightarrow=i(T,"\\longleftrightarrow ","&#8596;"),St.updownarrow=i(T,"\\updownarrow ","&#8597;"),St.Longleftrightarrow=i(T,"\\Longleftrightarrow ","&#8660;"),St.Updownarrow=i(T,"\\Updownarrow ","&#8661;"),St.mapsto=i(T,"\\mapsto ","&#8614;"),St.nearrow=i(T,"\\nearrow ","&#8599;"),St.hookleftarrow=i(T,"\\hookleftarrow ","&#8617;"),St.hookrightarrow=i(T,"\\hookrightarrow ","&#8618;"),St.searrow=i(T,"\\searrow ","&#8600;"),St.leftharpoonup=i(T,"\\leftharpoonup ","&#8636;"),St.rightharpoonup=i(T,"\\rightharpoonup ","&#8640;"),St.swarrow=i(T,"\\swarrow ","&#8601;"),St.leftharpoondown=i(T,"\\leftharpoondown ","&#8637;"),St.rightharpoondown=i(T,"\\rightharpoondown ","&#8641;"),St.nwarrow=i(T,"\\nwarrow ","&#8598;"),St.ldots=i(T,"\\ldots ","&#8230;"),St.cdots=i(T,"\\cdots ","&#8943;"),St.vdots=i(T,"\\vdots ","&#8942;"),St.ddots=i(T,"\\ddots ","&#8945;"),St.surd=i(T,"\\surd ","&#8730;"),St.triangle=i(T,"\\triangle ","&#9651;"),St.ell=i(T,"\\ell ","&#8467;"),St.top=i(T,"\\top ","&#8868;"),St.flat=i(T,"\\flat ","&#9837;"),St.natural=i(T,"\\natural ","&#9838;"),St.sharp=i(T,"\\sharp ","&#9839;"),St.wp=i(T,"\\wp ","&#8472;"),St.bot=i(T,"\\bot ","&#8869;"),St.clubsuit=i(T,"\\clubsuit ","&#9827;"),St.diamondsuit=i(T,"\\diamondsuit ","&#9826;"),St.heartsuit=i(T,"\\heartsuit ","&#9825;"),St.spadesuit=i(T,"\\spadesuit ","&#9824;"),St.parallelogram=i(T,"\\parallelogram ","&#9649;"),St.square=i(T,"\\square ","&#11036;"),St.oint=i(T,"\\oint ","&#8750;"),St.bigcap=i(T,"\\bigcap ","&#8745;"),St.bigcup=i(T,"\\bigcup ","&#8746;"),St.bigsqcup=i(T,"\\bigsqcup ","&#8852;"),St.bigvee=i(T,"\\bigvee ","&#8744;"),St.bigwedge=i(T,"\\bigwedge ","&#8743;"),St.bigodot=i(T,"\\bigodot ","&#8857;"),St.bigotimes=i(T,"\\bigotimes ","&#8855;"),St.bigoplus=i(T,"\\bigoplus ","&#8853;"),St.biguplus=i(T,"\\biguplus ","&#8846;"),St.lfloor=i(T,"\\lfloor ","&#8970;"),St.rfloor=i(T,"\\rfloor ","&#8971;"),St.lceil=i(T,"\\lceil ","&#8968;"),St.rceil=i(T,"\\rceil ","&#8969;"),St.opencurlybrace=St.lbrace=i(T,"\\lbrace ","{"),St.closecurlybrace=St.rbrace=i(T,"\\rbrace ","}"),St.lbrack=i(T,"["),St.rbrack=i(T,"]"),St["∫"]=St.int=St.integral=i(k,"\\int ","<big>&int;</big>"),St.slash=i(T,"/"),St.vert=i(T,"|"),St.perp=St.perpendicular=i(T,"\\perp ","&perp;"),St.nabla=St.del=i(T,"\\nabla ","&nabla;"),St.hbar=i(T,"\\hbar ","&#8463;"),St.AA=St.Angstrom=St.angstrom=i(T,"\\text\\AA ","&#8491;"),St.ring=St.circ=St.circle=i(T,"\\circ ","&#8728;"),St.bull=St.bullet=i(T,"\\bullet ","&bull;"),St.setminus=St.smallsetminus=i(T,"\\setminus ","&#8726;"),St.not=St["¬"]=St.neg=i(T,"\\neg ","&not;"),St["…"]=St.dots=St.ellip=St.hellip=St.ellipsis=St.hellipsis=i(T,"\\dots ","&hellip;"),St.converges=St.darr=St.dnarr=St.dnarrow=St.downarrow=i(T,"\\downarrow ","&darr;"),St.dArr=St.dnArr=St.dnArrow=St.Downarrow=i(T,"\\Downarrow ","&dArr;"),St.diverges=St.uarr=St.uparrow=i(T,"\\uparrow ","&uarr;"),St.uArr=St.Uparrow=i(T,"\\Uparrow ","&uArr;"),St.to=i(S,"\\to ","&rarr;"),St.rarr=St.rightarrow=i(T,"\\rightarrow ","&rarr;"),St.implies=i(S,"\\Rightarrow ","&rArr;"),St.rArr=St.Rightarrow=i(T,"\\Rightarrow ","&rArr;"),St.gets=i(S,"\\gets ","&larr;"),St.larr=St.leftarrow=i(T,"\\leftarrow ","&larr;"),St.impliedby=i(S,"\\Leftarrow ","&lArr;"),St.lArr=St.Leftarrow=i(T,"\\Leftarrow ","&lArr;"),St.harr=St.lrarr=St.leftrightarrow=i(T,"\\leftrightarrow ","&harr;"),St.iff=i(S,"\\Leftrightarrow ","&hArr;"),St.hArr=St.lrArr=St.Leftrightarrow=i(T,"\\Leftrightarrow ","&hArr;"),St.Re=St.Real=St.real=i(T,"\\Re ","&real;"),St.Im=St.imag=St.image=St.imagin=St.imaginary=St.Imaginary=i(T,"\\Im ","&image;"),St.part=St.partial=i(T,"\\partial ","&part;"),St.infty=St.infin=St.infinity=i(T,"\\infty ","&infin;"),St.alef=St.alefsym=St.aleph=St.alephsym=i(T,"\\aleph ","&alefsym;"),St.xist=St.xists=St.exist=St.exists=i(T,"\\exists ","&exist;"),St.and=St.land=St.wedge=i(T,"\\wedge ","&and;"),St.or=St.lor=St.vee=i(T,"\\vee ","&or;"),St.o=St.O=St.empty=St.emptyset=St.oslash=St.Oslash=St.nothing=St.varnothing=i(S,"\\varnothing ","&empty;"),St.cup=St.union=i(S,"\\cup ","&cup;"),St.cap=St.intersect=St.intersection=i(S,"\\cap ","&cap;"),St.deg=St.degree=i(T,"\\degree ","&deg;"),St.ang=St.angle=i(T,"\\angle ","&ang;"),St.measuredangle=i(T,"\\measuredangle ","&#8737;"),P=bt(T,function(t,e){t.createLeftOf=function(t){t.options.autoSubscriptNumerals&&t.parent!==t.parent.parent.sub&&(t[_t]instanceof j&&!1!==t[_t].isItalic||t[_t]instanceof tt&&t[_t][_t]instanceof j&&!1!==t[_t][_t].isItalic)?(St._().createLeftOf(t),e.createLeftOf.call(this,t),t.insRightOf(t.parent.parent)):e.createLeftOf.call(this,t)}}),j=bt(k,function(t,e){t.init=function(t,n){e.init.call(this,t,"<var>"+(n||t)+"</var>")},t.text=function(){var t=this.ctrlSeq;return!this[_t]||this[_t]instanceof j||this[_t]instanceof S||"\\ "===this[_t].ctrlSeq||(t="*"+t),!this[xt]||this[xt]instanceof S||this[xt]instanceof tt||(t+="*"),t}}),Ct.p.autoCommands={_maxLength:0},Pt.autoCommands=function(t){var e,n,i,r,o;if(!/^[a-z]+(?: [a-z]+)*$/i.test(t))throw'"'+t+'" not a space-delimited list of only letters';for(e=t.split(" "),n={},i=0,r=0;r<e.length;r+=1){if((o=e[r]).length<2)throw'autocommand "'+o+'" not minimum length of 2';if(St[o]===z)throw'"'+o+'" is a built-in operator name';n[o]=1,i=mt(i,o.length)}return n._maxLength=i,n},D=bt(j,function(t,e){function n(t){return t instanceof k&&!(t instanceof S)}t.init=function(t){return e.init.call(this,this.letter=t)},t.createLeftOf=function(t){var n,i,r,o=t.options.autoCommands,s=o._maxLength;if(s>0){for(n=this.letter,i=t[_t],r=1;i instanceof D&&s>r;)n=i.letter+n,i=i[_t],r+=1;for(;n.length;){if(o.hasOwnProperty(n)){for(r=2,i=t[_t];r<n.length;r+=1,i=i[_t]);return Tt(i,t[_t]).remove(),t[_t]=i[_t],St[n](n).createLeftOf(t)}n=n.slice(1)}}e.createLeftOf.apply(this,arguments)},t.italicize=function(t){return this.isItalic=t,this.jQ.toggleClass("mq-operator-name",!t),this},t.finalizeTree=t.siblingDeleted=t.siblingCreated=function(t,e){e!==_t&&this[xt]instanceof D||this.autoUnItalicize(t)},t.autoUnItalicize=function(t){var e,i,r,o,s,a,l,u,c,d,h,p=t.autoOperatorNames;if(0!==p._maxLength){for(e=this.letter,i=this[_t];i instanceof D;i=i[_t])e=i.letter+e;for(r=this[xt];r instanceof D;r=r[xt])e+=r.letter;Tt(i[xt]||this.parent.ends[_t],r[_t]||this.parent.ends[xt]).each(function(t){t.italicize(!0).jQ.removeClass("mq-first mq-last"),t.ctrlSeq=t.letter});t:for(o=0,s=i[xt]||this.parent.ends[_t];o<e.length;o+=1,s=s[xt])for(a=gt(p._maxLength,e.length-o);a>0;a-=1)if(l=e.slice(o,o+a),p.hasOwnProperty(l)){for(u=0,c=s;a>u;u+=1,c=c[xt])c.italicize(!1),d=c;h=I.hasOwnProperty(l),s.ctrlSeq=(h?"\\":"\\operatorname{")+s.ctrlSeq,d.ctrlSeq+=h?" ":"}",L.hasOwnProperty(l)&&d[_t][_t][_t].jQ.addClass("mq-last"),n(s[_t])&&s.jQ.addClass("mq-first"),n(d[xt])&&d.jQ.addClass("mq-last"),o+=a-1,s=d;continue t}}}}),I={},F=Ct.p.autoOperatorNames={_maxLength:9},L={limsup:1,liminf:1,projlim:1,injlim:1},function(){var t,e,n,i,r="arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" ");for(t=0;t<r.length;t+=1)I[r[t]]=F[r[t]]=1;for(e="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" "),t=0;t<e.length;t+=1)I[e[t]]=1;for(n="sin cos tan sec cosec csc cotan cot ctg".split(" "),t=0;t<n.length;t+=1)F[n[t]]=F["arc"+n[t]]=F[n[t]+"h"]=F["ar"+n[t]+"h"]=F["arc"+n[t]+"h"]=1;for(i="gcf hcf lcm proj span".split(" "),t=0;t<i.length;t+=1)F[i[t]]=1}(),Pt.autoOperatorNames=function(t){var e,n,i,r,o;if(!/^[a-z]+(?: [a-z]+)*$/i.test(t))throw'"'+t+'" not a space-delimited list of only letters';for(e=t.split(" "),n={},i=0,r=0;r<e.length;r+=1){if((o=e[r]).length<2)throw'"'+o+'" not minimum length of 2';n[o]=1,i=mt(i,o.length)}return n._maxLength=i,n},z=bt(k,function(t,e){t.init=function(t){this.ctrlSeq=t},t.createLeftOf=function(t){var e,n=this.ctrlSeq;for(e=0;e<n.length;e+=1)D(n.charAt(e)).createLeftOf(t)},t.parser=function(){var t,e=this.ctrlSeq,n=M();for(t=0;t<e.length;t+=1)D(e.charAt(t)).adopt(n,n.ends[xt],0);return b.succeed(n.children())}}),F)F.hasOwnProperty(R)&&(St[R]=z);for(Y in St.operatorname=bt(A,function(e){e.createLeftOf=t,e.numBlocks=function(){return 1},e.parser=function(){return x.block.map(function(t){return t.children()})}}),St.f=bt(D,function(t,e){t.init=function(){k.p.init.call(this,this.letter="f",'<var class="mq-f">f</var>')},t.italicize=function(t){return this.jQ.html("f").toggleClass("mq-f",t),e.italicize.apply(this,arguments)}}),St[" "]=St.space=i(T,"\\ ","&nbsp;"),St["'"]=St.prime=i(T,"'","&prime;"),St.backslash=i(T,"\\backslash ","\\"),Mt["\\"]||(Mt["\\"]=St.backslash),St.$=i(T,"\\$","$"),B=bt(k,function(t,e){t.init=function(t,n){e.init.call(this,t,'<span class="mq-nonSymbola">'+(n||t)+"</span>")}}),St["@"]=B,St["&"]=i(B,"\\&","&amp;"),St["%"]=i(B,"\\%","%"),St.alpha=St.beta=St.gamma=St.delta=St.zeta=St.eta=St.theta=St.iota=St.kappa=St.mu=St.nu=St.xi=St.rho=St.sigma=St.tau=St.chi=St.psi=St.omega=bt(j,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}}),St.phi=i(j,"\\phi ","&#981;"),St.phiv=St.varphi=i(j,"\\varphi ","&phi;"),St.epsilon=i(j,"\\epsilon ","&#1013;"),St.epsiv=St.varepsilon=i(j,"\\varepsilon ","&epsilon;"),St.piv=St.varpi=i(j,"\\varpi ","&piv;"),St.sigmaf=St.sigmav=St.varsigma=i(j,"\\varsigma ","&sigmaf;"),St.thetav=St.vartheta=St.thetasym=i(j,"\\vartheta ","&thetasym;"),St.upsilon=St.upsi=i(j,"\\upsilon ","&upsilon;"),St.gammad=St.Gammad=St.digamma=i(j,"\\digamma ","&#989;"),St.kappav=St.varkappa=i(j,"\\varkappa ","&#1008;"),St.rhov=St.varrho=i(j,"\\varrho ","&#1009;"),St.pi=St["π"]=i(B,"\\pi ","&pi;"),St.lambda=i(B,"\\lambda ","&lambda;"),St.Upsilon=St.Upsi=St.upsih=St.Upsih=i(k,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>'),St.Gamma=St.Delta=St.Theta=St.Lambda=St.Xi=St.Pi=St.Sigma=St.Phi=St.Psi=St.Omega=St.forall=bt(T,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}}),H=bt(A,function(t){t.init=function(t){this.latex=t},t.createLeftOf=function(t){var e=x.parse(this.latex);e.children().adopt(t.parent,t[_t],t[xt]),t[_t]=e.ends[xt],e.jQize().insertBefore(t.jQ),e.finalizeInsert(t.options,t),e.ends[xt][xt].siblingCreated&&e.ends[xt][xt].siblingCreated(t.options,_t),e.ends[_t][_t].siblingCreated&&e.ends[_t][_t].siblingCreated(t.options,xt),t.parent.bubble("reflow")},t.parser=function(){var t=x.parse(this.latex).children();return b.succeed(t)}}),St["¹"]=i(H,"^1"),St["²"]=i(H,"^2"),St["³"]=i(H,"^3"),St["¼"]=i(H,"\\frac14"),St["½"]=i(H,"\\frac12"),St["¾"]=i(H,"\\frac34"),G=bt(S,function(t){t.init=T.prototype.init,t.contactWeld=t.siblingCreated=t.siblingDeleted=function(t,e){return e!==xt?(this.jQ[0].className=!this[_t]||this[_t]instanceof S?"":"mq-binary-operator",this):void 0}}),St["+"]=i(G,"+","+"),St["–"]=St["-"]=i(G,"-","&minus;"),St["±"]=St.pm=St.plusmn=St.plusminus=i(G,"\\pm ","&plusmn;"),St.mp=St.mnplus=St.minusplus=i(G,"\\mp ","&#8723;"),Mt["*"]=St.sdot=St.cdot=i(S,"\\cdot ","&middot;","*"),V=bt(S,function(t,e){t.init=function(t,n){this.data=t,this.strict=n;var i=n?"Strict":"";e.init.call(this,t["ctrlSeq"+i],t["html"+i],t["text"+i])},t.swap=function(t){this.strict=t;var e=t?"Strict":"";this.ctrlSeq=this.data["ctrlSeq"+e],this.jQ.html(this.data["html"+e]),this.textTemplate=[this.data["text"+e]]},t.deleteTowards=function(t,n){return t!==_t||this.strict?void e.deleteTowards.apply(this,arguments):(this.swap(!0),void this.bubble("reflow"))}}),U={ctrlSeq:"\\le ",html:"&le;",text:"≤",ctrlSeqStrict:"<",htmlStrict:"&lt;",textStrict:"<"},W={ctrlSeq:"\\ge ",html:"&ge;",text:"≥",ctrlSeqStrict:">",htmlStrict:"&gt;",textStrict:">"},St["<"]=St.lt=i(V,U,!0),St[">"]=St.gt=i(V,W,!0),St["≤"]=St.le=St.leq=i(V,U,!1),St["≥"]=St.ge=St.geq=i(V,W,!1),Q=bt(S,function(t,e){t.init=function(){e.init.call(this,"=","=")},t.createLeftOf=function(t){return t[_t]instanceof V&&t[_t].strict?(t[_t].swap(!1),void t[_t].bubble("reflow")):void e.createLeftOf.apply(this,arguments)}}),St["="]=Q,St["×"]=St.times=i(S,"\\times ","&times;","[x]"),St["÷"]=St.div=St.divide=St.divides=i(S,"\\div ","&divide;","[/]"),Mt["~"]=St.sim=i(S,"\\sim ","~","~"),K=t,J=document.createElement("div").style,{transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1})if(Y in J){Z=Y;break}for(dt in Z?$=function(t,e,n){t.css(Z,"scale("+e+","+n+")")}:"filter"in J?(K=function(t){t.className=t.className},$=function(t,e,n){function i(){t.css("marginRight",(r.width()-1)*(e-1)/e+"px")}var r,o;e/=1+(n-1)/2,t.css("fontSize",n+"em"),t.hasClass("mq-matrixed-container")||t.addClass("mq-matrixed-container").wrapInner('<span class="mq-matrixed"></span>'),r=t.children().css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+e+",SizingMethod='auto expand')"),i(),o=setInterval(i),wt(window).load(function(){clearTimeout(o),i()})}):$=function(t,e,n){t.css("fontSize",n+"em")},X=bt(A,function(t,e){t.init=function(t,n,i){e.init.call(this,t,"<"+n+" "+i+">&0</"+n+">")}}),St.mathrm=i(X,"\\mathrm","span",'class="mq-roman mq-font"'),St.mathit=i(X,"\\mathit","i",'class="mq-font"'),St.mathbf=i(X,"\\mathbf","b",'class="mq-font"'),St.mathsf=i(X,"\\mathsf","span",'class="mq-sans-serif mq-font"'),St.mathtt=i(X,"\\mathtt","span",'class="mq-monospace mq-font"'),St.underline=i(X,"\\underline","span",'class="mq-non-leaf mq-underline"'),St.overline=St.bar=i(X,"\\overline","span",'class="mq-non-leaf mq-overline"'),St.overrightarrow=i(X,"\\overrightarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-right"'),St.overleftarrow=i(X,"\\overleftarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-left"'),St.textcolor=bt(A,function(t,e){t.setColor=function(t){this.color=t,this.htmlTemplate='<span class="mq-textcolor" style="color:'+t+'">&0</span>'},t.latex=function(){return"\\textcolor{"+this.color+"}{"+this.blocks[0].latex()+"}"},t.parser=function(){var t=this,n=b.optWhitespace,i=b.string,r=b.regex;return n.then(i("{")).then(r(/^[#\w\s.,()%-]*/)).skip(i("}")).then(function(n){return t.setColor(n),e.parser.call(t)})}}),St.class=bt(A,function(t,e){t.parser=function(){var t=this,n=b.string,i=b.regex;return b.optWhitespace.then(n("{")).then(i(/^[-\w\s\\\xA0-\xFF]*/)).skip(n("}")).then(function(n){return t.htmlTemplate='<span class="mq-class '+n+'">&0</span>',e.parser.call(t)})}}),tt=bt(A,function(t,e){t.ctrlSeq="_{...}^{...}",t.createLeftOf=function(t){return t[_t]||!t.options.supSubsRequireOperand?e.createLeftOf.apply(this,arguments):void 0},t.contactWeld=function(t){var e,n,i,r,o,s;for(e=_t;e;e=e===_t&&xt)if(this[e]instanceof tt){for(n="sub";n;n="sub"===n&&"sup")i=this[n],r=this[e][n],i&&(r?i.isEmpty()?s=At(r,0,r.ends[_t]):(i.jQ.children().insAtDirEnd(-e,r.jQ),o=i.children().disown(),s=At(r,o.ends[xt],r.ends[_t]),e===_t?o.adopt(r,r.ends[xt],0):o.adopt(r,0,r.ends[_t])):this[e].addBlock(i.disown()),this.placeCursor=function(t,n){return function(i){i.insAtDirEnd(-e,t||n)}}(r,i));this.remove(),t&&t[_t]===this&&(e===xt&&s?s[_t]?t.insRightOf(s[_t]):t.insAtLeftEnd(s.parent):t.insRightOf(this[e]));break}this.respace()},Ct.p.charsThatBreakOutOfSupSub="",t.finalizeTree=function(){this.ends[_t].write=function(t,e){if(t.options.autoSubscriptNumerals&&this===this.parent.sub){if("_"===e)return;var n=this.chToCmd(e);return n instanceof k?t.deleteSelection():t.clearSelection().insRightOf(this.parent),n.createLeftOf(t.show())}t[_t]&&!t[xt]&&!t.selection&&t.options.charsThatBreakOutOfSupSub.indexOf(e)>-1&&t.insRightOf(this.parent),M.p.write.apply(this,arguments)}},t.moveTowards=function(t,n,i){n.options.autoSubscriptNumerals&&!this.sup?n.insDirOf(t,this):e.moveTowards.apply(this,arguments)},t.deleteTowards=function(t,n){if(n.options.autoSubscriptNumerals&&this.sub){var i=this.sub.ends[-t];i instanceof k?i.remove():i&&i.deleteTowards(t,n.insAtDirEnd(-t,this.sub)),this.sub.isEmpty()&&(this.sub.deleteOutOf(_t,n.insAtLeftEnd(this.sub)),this.sup&&n.insDirOf(-t,this))}else e.deleteTowards.apply(this,arguments)},t.latex=function(){function t(t,e){var n=e&&e.latex();return e?t+(1===n.length?n:"{"+(n||" ")+"}"):""}return t("_",this.sub)+t("^",this.sup)},t.respace=t.siblingCreated=t.siblingDeleted=function(t,e){e!==xt&&this.jQ.toggleClass("mq-limit","\\int "===this[_t].ctrlSeq)},t.addBlock=function(t){"sub"===this.supsub?(this.sup=this.upInto=this.sub.upOutOf=t,t.adopt(this,this.sub,0).downOutOf=this.sub,t.jQ=wt('<span class="mq-sup"/>').append(t.jQ.children()).attr(ft,t.id).prependTo(this.jQ)):(this.sub=this.downInto=this.sup.downOutOf=t,t.adopt(this,0,this.sup).upOutOf=this.sup,t.jQ=wt('<span class="mq-sub"></span>').append(t.jQ.children()).attr(ft,t.id).appendTo(this.jQ.removeClass("mq-sup-only")),this.jQ.append('<span style="display:inline-block;width:0">&#8203;</span>'));for(var e=0;2>e;e+=1)!function(t,e,n,i){t[e].deleteOutOf=function(r,o){if(o.insDirOf(this[r]?-r:r,this.parent),!this.isEmpty()){var s=this.ends[r];this.children().disown().withDirAdopt(r,o.parent,o[r],o[-r]).jQ.insDirOf(-r,o.jQ),o[-r]=s}t.supsub=n,delete t[e],delete t[i+"Into"],t[n][i+"OutOf"]=h,delete t[n].deleteOutOf,"sub"===e&&wt(t.jQ.addClass("mq-sup-only")[0].lastChild).remove(),this.remove()}}(this,"sub sup".split(" ")[e],"sup sub".split(" ")[e],"down up".split(" ")[e])}}),St.subscript=St._=bt(tt,function(t,e){t.supsub="sub",t.htmlTemplate='<span class="mq-supsub mq-non-leaf"><span class="mq-sub">&0</span><span style="display:inline-block;width:0">&#8203;</span></span>',t.textTemplate=["_"],t.finalizeTree=function(){this.downInto=this.sub=this.ends[_t],this.sub.upOutOf=h,e.finalizeTree.call(this)}}),St.superscript=St.supscript=St["^"]=bt(tt,function(t,e){t.supsub="sup",t.htmlTemplate='<span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup">&0</span></span>',t.textTemplate=["^"],t.finalizeTree=function(){this.upInto=this.sup=this.ends[xt],this.sup.downOutOf=h,e.finalizeTree.call(this)}}),et=bt(A,function(t,e){t.init=function(t,e){var n='<span class="mq-large-operator mq-non-leaf"><span class="mq-to"><span>&1</span></span><big>'+e+'</big><span class="mq-from"><span>&0</span></span></span>';k.prototype.init.call(this,t,n)},t.createLeftOf=function(t){e.createLeftOf.apply(this,arguments),t.options.sumStartsWithNEquals&&(D("n").createLeftOf(t),Q().createLeftOf(t))},t.latex=function(){function t(t){return 1===t.length?t:"{"+(t||" ")+"}"}return this.ctrlSeq+"_"+t(this.ends[_t].latex())+"^"+t(this.ends[xt].latex())},t.parser=function(){var t,e=b.string,n=b.optWhitespace,i=b.succeed,r=x.block,o=this,s=o.blocks=[M(),M()];for(t=0;t<s.length;t+=1)s[t].adopt(o,o.ends[xt],0);return n.then(e("_").or(e("^"))).then(function(t){var e=s["_"===t?0:1];return r.then(function(t){return t.children().adopt(e,e.ends[xt],0),i(o)})}).many().result(o)},t.finalizeTree=function(){this.downInto=this.ends[_t],this.upInto=this.ends[xt],this.ends[_t].upOutOf=this.ends[xt],this.ends[xt].downOutOf=this.ends[_t]}}),St["∑"]=St.sum=St.summation=i(et,"\\sum ","&sum;"),St["∏"]=St.prod=St.product=i(et,"\\prod ","&prod;"),St.coprod=St.coproduct=i(et,"\\coprod ","&#8720;"),nt=St.frac=St.dfrac=St.cfrac=St.fraction=bt(A,function(t,e){t.ctrlSeq="\\frac",t.htmlTemplate='<span class="mq-fraction mq-non-leaf"><span class="mq-numerator">&0</span><span class="mq-denominator">&1</span><span style="display:inline-block;width:0">&#8203;</span></span>',t.textTemplate=["(",")/(",")"],t.finalizeTree=function(){this.upInto=this.ends[xt].upOutOf=this.ends[_t],this.downInto=this.ends[_t].downOutOf=this.ends[xt]}}),it=St.over=Mt["/"]=bt(nt,function(e,n){e.createLeftOf=function(e){if(!this.replacedFragment){for(var i=e[_t];i&&!(i instanceof S||i instanceof(St.text||t)||i instanceof et||"\\ "===i.ctrlSeq||/^[,;:]$/.test(i.ctrlSeq));)i=i[_t];i instanceof et&&i[xt]instanceof tt&&(i=i[xt])[xt]instanceof tt&&i[xt].ctrlSeq!=i.ctrlSeq&&(i=i[xt]),i!==e[_t]&&(this.replaces(Tt(i[xt]||e.parent.ends[_t],e[_t])),e[_t]=i)}n.createLeftOf.call(this,e)}}),rt=St.sqrt=St["√"]=bt(A,function(t,e){t.ctrlSeq="\\sqrt",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-sqrt-prefix">&radic;</span><span class="mq-non-leaf mq-sqrt-stem">&0</span></span>',t.textTemplate=["sqrt(",")"],t.parser=function(){return x.optBlock.then(function(t){return x.block.map(function(e){var n=ot();return n.blocks=[t,e],t.adopt(n,0,0),e.adopt(n,t,0),n})}).or(e.parser.call(this))},t.reflow=function(){var t=this.ends[xt].jQ;$(t.prev(),1,t.innerHeight()/+t.css("fontSize").slice(0,-2)-.1)}}),St.vec=bt(A,function(t,e){t.ctrlSeq="\\vec",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-vector-prefix">&rarr;</span><span class="mq-vector-stem">&0</span></span>',t.textTemplate=["vec(",")"]}),ot=St.nthroot=bt(rt,function(t,e){t.htmlTemplate='<sup class="mq-nthroot mq-non-leaf">&0</sup><span class="mq-scaled"><span class="mq-sqrt-prefix mq-scaled">&radic;</span><span class="mq-sqrt-stem mq-non-leaf">&1</span></span>',t.textTemplate=["sqrt[","](",")"],t.latex=function(){return"\\sqrt["+this.ends[_t].latex()+"]{"+this.ends[xt].latex()+"}"}}),st=bt(bt(A,p),function(e,n){e.init=function(t,e,i,r,o){n.init.call(this,"\\left"+r,g,[e,i]),this.side=t,this.sides={},this.sides[_t]={ch:e,ctrlSeq:r},this.sides[xt]={ch:i,ctrlSeq:o}},e.numBlocks=function(){return 1},e.html=function(){return this.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-paren'+(this.side===xt?" mq-ghost":"")+'">'+this.sides[_t].ch+'</span><span class="mq-non-leaf">&0</span><span class="mq-scaled mq-paren'+(this.side===_t?" mq-ghost":"")+'">'+this.sides[xt].ch+"</span></span>",n.html.call(this)},e.latex=function(){return"\\left"+this.sides[_t].ctrlSeq+this.ends[_t].latex()+"\\right"+this.sides[xt].ctrlSeq},e.oppBrack=function(t,e,n){return e instanceof st&&e.side&&e.side!==-n&&("|"===this.sides[this.side].ch||e.side===-this.side)&&(!t.restrictMismatchedBrackets||at[this.sides[this.side].ch]===e.sides[e.side].ch||{"(":"]","[":")"}[this.sides[_t].ch]===e.sides[xt].ch)&&e},e.closeOpposing=function(t){t.side=0,t.sides[this.side]=this.sides[this.side],t.delimjQs.eq(this.side===_t?0:1).removeClass("mq-ghost").html(this.sides[this.side].ch)},e.createLeftOf=function(t){var e,i,r;this.replacedFragment||(e=t.options,i=this.oppBrack(e,t[_t],_t)||this.oppBrack(e,t[xt],xt)||this.oppBrack(e,t.parent.parent)),i?(r=this.side=-i.side,this.closeOpposing(i),i===t.parent.parent&&t[r]&&(Tt(t[r],t.parent.ends[r],-r).disown().withDirAdopt(-r,i.parent,i,i[r]).jQ.insDirOf(r,i.jQ),i.bubble("reflow"))):(r=(i=this).side,i.replacedFragment?i.side=0:t[-r]&&(i.replaces(Tt(t[-r],t.parent.ends[-r],r)),t[-r]=0),n.createLeftOf.call(i,t)),r===_t?t.insAtLeftEnd(i.ends[_t]):t.insRightOf(i)},e.placeCursor=t,e.unwrap=function(){this.ends[_t].children().disown().adopt(this.parent,this,this[xt]).jQ.insertAfter(this.jQ),this.remove()},e.deleteSide=function(t,e,n){var i,r,o,s=this.parent,a=this[t],l=s.ends[t];if(t===this.side)return this.unwrap(),void(a?n.insDirOf(-t,a):n.insAtDirEnd(t,s));if(i=n.options,r=!this.side,this.side=-t,this.oppBrack(i,this.ends[_t].ends[this.side],t))this.closeOpposing(this.ends[_t].ends[this.side]),o=this.ends[_t].ends[t],this.unwrap(),o.siblingCreated&&o.siblingCreated(n.options,t),a?n.insDirOf(-t,a):n.insAtDirEnd(t,s);else{if(this.oppBrack(i,this.parent.parent,t))this.parent.parent.closeOpposing(this),this.parent.parent.unwrap();else{if(e&&r)return this.unwrap(),void(a?n.insDirOf(-t,a):n.insAtDirEnd(t,s));this.sides[t]={ch:at[this.sides[this.side].ch],ctrlSeq:at[this.sides[this.side].ctrlSeq]},this.delimjQs.removeClass("mq-ghost").eq(t===_t?0:1).addClass("mq-ghost").html(this.sides[t].ch)}a?(o=this.ends[_t].ends[t],Tt(a,l,-t).disown().withDirAdopt(-t,this.ends[_t],o,0).jQ.insAtDirEnd(t,this.ends[_t].jQ.removeClass("mq-empty")),o.siblingCreated&&o.siblingCreated(n.options,t),n.insDirOf(-t,a)):e?n.insDirOf(t,this):n.insAtDirEnd(t,this.ends[_t])}},e.deleteTowards=function(t,e){this.deleteSide(-t,!1,e)},e.finalizeTree=function(){this.ends[_t].deleteOutOf=function(t,e){this.parent.deleteSide(t,!0,e)},this.finalizeTree=this.intentionalBlur=function(){this.delimjQs.eq(this.side===_t?1:0).removeClass("mq-ghost"),this.side=0}},e.siblingCreated=function(t,e){e===-this.side&&this.finalizeTree()}}),at={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|"},f("("),f("["),f("{","\\{"),St.langle=i(st,_t,"&lang;","&rang;","\\langle ","\\rangle "),St.rangle=i(st,xt,"&lang;","&rang;","\\langle ","\\rangle "),Mt["|"]=i(st,_t,"|","|","|","|"),St.left=bt(A,function(t){t.parser=function(){var t=b.regex,e=b.string,n=(b.succeed,b.optWhitespace);return n.then(t(/^(?:[([|]|\\\{)/)).then(function(i){var r="\\"===i.charAt(0)?i.slice(1):i;return x.then(function(o){return e("\\right").skip(n).then(t(/^(?:[\])|]|\\\})/)).map(function(t){var e="\\"===t.charAt(0)?t.slice(1):t,n=st(0,r,e,i,t);return n.blocks=[o],o.adopt(n,0,0),n})})})}}),St.right=bt(A,function(t){t.parser=function(){return b.fail("unmatched \\right")}}),lt=St.binom=St.binomial=bt(bt(A,p),function(t,e){t.ctrlSeq="\\binom",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-paren mq-scaled">(</span><span class="mq-non-leaf"><span class="mq-array mq-non-leaf"><span>&0</span><span>&1</span></span></span><span class="mq-paren mq-scaled">)</span></span>',t.textTemplate=["choose(",",",")"]}),St.choose=bt(lt,function(t){t.createLeftOf=it.prototype.createLeftOf}),St.editable=St.MathQuillMathField=bt(A,function(t,e){t.ctrlSeq="\\MathQuillMathField",t.htmlTemplate='<span class="mq-editable-field"><span class="mq-root-block">&0</span></span>',t.parser=function(){var t=this,n=b.string,i=b.regex,r=b.succeed;return n("[").then(i(/^[a-z][a-z0-9]*/i)).skip(n("]")).map(function(e){t.name=e}).or(r()).then(e.parser.call(t))},t.finalizeTree=function(){var t=Ot(this.ends[_t],this.jQ,Ct());t.KIND_OF_MQ="MathField",t.editable=!0,t.createTextarea(),t.editablesTextareaEvents(),t.cursor.insAtRightEnd(t.root),c(t.root)},t.registerInnerField=function(t,e){t.push(t[this.name]=e(this.ends[_t].controller))},t.latex=function(){return this.ends[_t].latex()},t.text=function(){return this.ends[_t].text()}}),ut=St.embed=bt(k,function(t,e){t.setOptions=function(t){function e(){return""}return this.text=t.text||e,this.htmlTemplate=t.htmlString||"",this.latex=t.latex||e,this},t.parser=function(){var t=this;return string=b.string,regex=b.regex,succeed=b.succeed,string("{").then(regex(/^[a-z][a-z0-9]*/i)).skip(string("}")).then(function(e){return string("[").then(regex(/^[-\w\s]*/)).skip(string("]")).or(succeed()).map(function(n){return t.setOptions(Dt[e](n))})})}}),ct=u(1))!function(t,e){"function"==typeof e?(l[t]=function(){return a(),e.apply(this,arguments)},l[t].prototype=e.prototype):l[t]=e}(dt,ct[dt])}()},function(t,e,n){var i;
/*!
 * jQuery JavaScript Library v3.3.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2018-01-20T17:24Z
 */
/*!
 * jQuery JavaScript Library v3.3.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2018-01-20T17:24Z
 */!function(e,n){"use strict";"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:this,function(n,r){"use strict";var o=[],s=n.document,a=Object.getPrototypeOf,l=o.slice,u=o.concat,c=o.push,d=o.indexOf,h={},p=h.toString,f=h.hasOwnProperty,g=f.toString,m=g.call(Object),v={},y=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},b=function(t){return null!=t&&t===t.window},_={type:!0,src:!0,noModule:!0};function x(t,e,n){var i,r=(e=e||s).createElement("script");if(r.text=t,n)for(i in _)n[i]&&(r[i]=n[i]);e.head.appendChild(r).parentNode.removeChild(r)}function w(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?h[p.call(t)]||"object":typeof t}var A=function(t,e){return new A.fn.init(t,e)},k=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function T(t){var e=!!t&&"length"in t&&t.length,n=w(t);return!y(t)&&!b(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}A.fn=A.prototype={jquery:"3.3.1",constructor:A,length:0,toArray:function(){return l.call(this)},get:function(t){return null==t?l.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=A.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return A.each(this,t)},map:function(t){return this.pushStack(A.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(l.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:o.sort,splice:o.splice},A.extend=A.fn.extend=function(){var t,e,n,i,r,o,s=arguments[0]||{},a=1,l=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[a]||{},a++),"object"==typeof s||y(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)n=s[e],s!==(i=t[e])&&(u&&i&&(A.isPlainObject(i)||(r=Array.isArray(i)))?(r?(r=!1,o=n&&Array.isArray(n)?n:[]):o=n&&A.isPlainObject(n)?n:{},s[e]=A.extend(u,o,i)):void 0!==i&&(s[e]=i));return s},A.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==p.call(t)||(e=a(t))&&("function"!=typeof(n=f.call(e,"constructor")&&e.constructor)||g.call(n)!==m))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t){x(t)},each:function(t,e){var n,i=0;if(T(t))for(n=t.length;i<n&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},trim:function(t){return null==t?"":(t+"").replace(k,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(T(Object(t))?A.merge(n,"string"==typeof t?[t]:t):c.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:d.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;i<n;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i=[],r=0,o=t.length,s=!n;r<o;r++)!e(t[r],r)!==s&&i.push(t[r]);return i},map:function(t,e,n){var i,r,o=0,s=[];if(T(t))for(i=t.length;o<i;o++)null!=(r=e(t[o],o,n))&&s.push(r);else for(o in t)null!=(r=e(t[o],o,n))&&s.push(r);return u.apply([],s)},guid:1,support:v}),"function"==typeof Symbol&&(A.fn[Symbol.iterator]=o[Symbol.iterator]),A.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){h["[object "+e+"]"]=e.toLowerCase()});var S=
/*!
 * Sizzle CSS Selector Engine v2.3.3
 * https://sizzlejs.com/
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2016-08-08
 */
function(t){var e,n,i,r,o,s,a,l,u,c,d,h,p,f,g,m,v,y,b,_="sizzle"+1*new Date,x=t.document,w=0,A=0,k=st(),T=st(),S=st(),M=function(t,e){return t===e&&(d=!0),0},E={}.hasOwnProperty,N=[],O=N.pop,q=N.push,C=N.push,P=N.slice,j=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},D="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",I="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",L="\\["+I+"*("+F+")(?:"+I+"*([*^$|!~]?=)"+I+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+I+"*\\]",z=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+L+")*)|.*)\\)|)",R=new RegExp(I+"+","g"),B=new RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),H=new RegExp("^"+I+"*,"+I+"*"),G=new RegExp("^"+I+"*([>+~]|"+I+")"+I+"*"),V=new RegExp("="+I+"*([^\\]'\"]*?)"+I+"*\\]","g"),U=new RegExp(z),W=new RegExp("^"+F+"$"),Q={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F+"|[*])"),ATTR:new RegExp("^"+L),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),bool:new RegExp("^(?:"+D+")$","i"),needsContext:new RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},$=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Y=/[+~]/,X=new RegExp("\\\\([\\da-f]{1,6}"+I+"?|("+I+")|.)","ig"),tt=function(t,e,n){var i="0x"+e-65536;return i!=i||n?e:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},et=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,nt=function(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},it=function(){h()},rt=yt(function(t){return!0===t.disabled&&("form"in t||"label"in t)},{dir:"parentNode",next:"legend"});try{C.apply(N=P.call(x.childNodes),x.childNodes),N[x.childNodes.length].nodeType}catch(t){C={apply:N.length?function(t,e){q.apply(t,P.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}function ot(t,e,i,r){var o,a,u,c,d,f,v,y=e&&e.ownerDocument,w=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==w&&9!==w&&11!==w)return i;if(!r&&((e?e.ownerDocument||e:x)!==p&&h(e),e=e||p,g)){if(11!==w&&(d=Z.exec(t)))if(o=d[1]){if(9===w){if(!(u=e.getElementById(o)))return i;if(u.id===o)return i.push(u),i}else if(y&&(u=y.getElementById(o))&&b(e,u)&&u.id===o)return i.push(u),i}else{if(d[2])return C.apply(i,e.getElementsByTagName(t)),i;if((o=d[3])&&n.getElementsByClassName&&e.getElementsByClassName)return C.apply(i,e.getElementsByClassName(o)),i}if(n.qsa&&!S[t+" "]&&(!m||!m.test(t))){if(1!==w)y=e,v=t;else if("object"!==e.nodeName.toLowerCase()){for((c=e.getAttribute("id"))?c=c.replace(et,nt):e.setAttribute("id",c=_),a=(f=s(t)).length;a--;)f[a]="#"+c+" "+vt(f[a]);v=f.join(","),y=Y.test(t)&&gt(e.parentNode)||e}if(v)try{return C.apply(i,y.querySelectorAll(v)),i}catch(t){}finally{c===_&&e.removeAttribute("id")}}}return l(t.replace(B,"$1"),e,i,r)}function st(){var t=[];return function e(n,r){return t.push(n+" ")>i.cacheLength&&delete e[t.shift()],e[n+" "]=r}}function at(t){return t[_]=!0,t}function lt(t){var e=p.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ut(t,e){for(var n=t.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=e}function ct(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function dt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ht(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function pt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&rt(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function ft(t){return at(function(e){return e=+e,at(function(n,i){for(var r,o=t([],n.length,e),s=o.length;s--;)n[r=o[s]]&&(n[r]=!(i[r]=n[r]))})})}function gt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=ot.support={},o=ot.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},h=ot.setDocument=function(t){var e,r,s=t?t.ownerDocument||t:x;return s!==p&&9===s.nodeType&&s.documentElement?(f=(p=s).documentElement,g=!o(p),x!==p&&(r=p.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",it,!1):r.attachEvent&&r.attachEvent("onunload",it)),n.attributes=lt(function(t){return t.className="i",!t.getAttribute("className")}),n.getElementsByTagName=lt(function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length}),n.getElementsByClassName=J.test(p.getElementsByClassName),n.getById=lt(function(t){return f.appendChild(t).id=_,!p.getElementsByName||!p.getElementsByName(_).length}),n.getById?(i.filter.ID=function(t){var e=t.replace(X,tt);return function(t){return t.getAttribute("id")===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n=e.getElementById(t);return n?[n]:[]}}):(i.filter.ID=function(t){var e=t.replace(X,tt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n,i,r,o=e.getElementById(t);if(o){if((n=o.getAttributeNode("id"))&&n.value===t)return[o];for(r=e.getElementsByName(t),i=0;o=r[i++];)if((n=o.getAttributeNode("id"))&&n.value===t)return[o]}return[]}}),i.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},i.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&g)return e.getElementsByClassName(t)},v=[],m=[],(n.qsa=J.test(p.querySelectorAll))&&(lt(function(t){f.appendChild(t).innerHTML="<a id='"+_+"'></a><select id='"+_+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+I+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\["+I+"*(?:value|"+D+")"),t.querySelectorAll("[id~="+_+"-]").length||m.push("~="),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+_+"+*").length||m.push(".#.+[+~]")}),lt(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name"+I+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),f.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")})),(n.matchesSelector=J.test(y=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&lt(function(t){n.disconnectedMatch=y.call(t,"*"),y.call(t,"[s!='']:x"),v.push("!=",z)}),m=m.length&&new RegExp(m.join("|")),v=v.length&&new RegExp(v.join("|")),e=J.test(f.compareDocumentPosition),b=e||J.test(f.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},M=e?function(t,e){if(t===e)return d=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===i?t===p||t.ownerDocument===x&&b(x,t)?-1:e===p||e.ownerDocument===x&&b(x,e)?1:c?j(c,t)-j(c,e):0:4&i?-1:1)}:function(t,e){if(t===e)return d=!0,0;var n,i=0,r=t.parentNode,o=e.parentNode,s=[t],a=[e];if(!r||!o)return t===p?-1:e===p?1:r?-1:o?1:c?j(c,t)-j(c,e):0;if(r===o)return ct(t,e);for(n=t;n=n.parentNode;)s.unshift(n);for(n=e;n=n.parentNode;)a.unshift(n);for(;s[i]===a[i];)i++;return i?ct(s[i],a[i]):s[i]===x?-1:a[i]===x?1:0},p):p},ot.matches=function(t,e){return ot(t,null,null,e)},ot.matchesSelector=function(t,e){if((t.ownerDocument||t)!==p&&h(t),e=e.replace(V,"='$1']"),n.matchesSelector&&g&&!S[e+" "]&&(!v||!v.test(e))&&(!m||!m.test(e)))try{var i=y.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){}return ot(e,p,null,[t]).length>0},ot.contains=function(t,e){return(t.ownerDocument||t)!==p&&h(t),b(t,e)},ot.attr=function(t,e){(t.ownerDocument||t)!==p&&h(t);var r=i.attrHandle[e.toLowerCase()],o=r&&E.call(i.attrHandle,e.toLowerCase())?r(t,e,!g):void 0;return void 0!==o?o:n.attributes||!g?t.getAttribute(e):(o=t.getAttributeNode(e))&&o.specified?o.value:null},ot.escape=function(t){return(t+"").replace(et,nt)},ot.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},ot.uniqueSort=function(t){var e,i=[],r=0,o=0;if(d=!n.detectDuplicates,c=!n.sortStable&&t.slice(0),t.sort(M),d){for(;e=t[o++];)e===t[o]&&(r=i.push(o));for(;r--;)t.splice(i[r],1)}return c=null,t},r=ot.getText=function(t){var e,n="",i=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=r(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[i++];)n+=r(e);return n},(i=ot.selectors={cacheLength:50,createPseudo:at,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(X,tt),t[3]=(t[3]||t[4]||t[5]||"").replace(X,tt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||ot.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&ot.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return Q.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&U.test(n)&&(e=s(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(X,tt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=k[t+" "];return e||(e=new RegExp("(^|"+I+")"+t+"("+I+"|$)"))&&k(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(i){var r=ot.attr(i,t);return null==r?"!="===e:!e||(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&r.indexOf(n)>-1:"$="===e?n&&r.slice(-n.length)===n:"~="===e?(" "+r.replace(R," ")+" ").indexOf(n)>-1:"|="===e&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,l){var u,c,d,h,p,f,g=o!==s?"nextSibling":"previousSibling",m=e.parentNode,v=a&&e.nodeName.toLowerCase(),y=!l&&!a,b=!1;if(m){if(o){for(;g;){for(h=e;h=h[g];)if(a?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[s?m.firstChild:m.lastChild],s&&y){for(b=(p=(u=(c=(d=(h=m)[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[t]||[])[0]===w&&u[1])&&u[2],h=p&&m.childNodes[p];h=++p&&h&&h[g]||(b=p=0)||f.pop();)if(1===h.nodeType&&++b&&h===e){c[t]=[w,p,b];break}}else if(y&&(b=p=(u=(c=(d=(h=e)[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[t]||[])[0]===w&&u[1]),!1===b)for(;(h=++p&&h&&h[g]||(b=p=0)||f.pop())&&((a?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++b||(y&&((c=(d=h[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[t]=[w,b]),h!==e)););return(b-=r)===i||b%i==0&&b/i>=0}}},PSEUDO:function(t,e){var n,r=i.pseudos[t]||i.setFilters[t.toLowerCase()]||ot.error("unsupported pseudo: "+t);return r[_]?r(e):r.length>1?(n=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?at(function(t,n){for(var i,o=r(t,e),s=o.length;s--;)t[i=j(t,o[s])]=!(n[i]=o[s])}):function(t){return r(t,0,n)}):r}},pseudos:{not:at(function(t){var e=[],n=[],i=a(t.replace(B,"$1"));return i[_]?at(function(t,e,n,r){for(var o,s=i(t,null,r,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))}):function(t,r,o){return e[0]=t,i(e,null,o,n),e[0]=null,!n.pop()}}),has:at(function(t){return function(e){return ot(t,e).length>0}}),contains:at(function(t){return t=t.replace(X,tt),function(e){return(e.textContent||e.innerText||r(e)).indexOf(t)>-1}}),lang:at(function(t){return W.test(t||"")||ot.error("unsupported lang: "+t),t=t.replace(X,tt).toLowerCase(),function(e){var n;do{if(n=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:pt(!1),disabled:pt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return K.test(t.nodeName)},input:function(t){return $.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:ft(function(){return[0]}),last:ft(function(t,e){return[e-1]}),eq:ft(function(t,e,n){return[n<0?n+e:n]}),even:ft(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:ft(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:ft(function(t,e,n){for(var i=n<0?n+e:n;--i>=0;)t.push(i);return t}),gt:ft(function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t})}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=dt(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=ht(e);function mt(){}function vt(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function yt(t,e,n){var i=e.dir,r=e.next,o=r||i,s=n&&"parentNode"===o,a=A++;return e.first?function(e,n,r){for(;e=e[i];)if(1===e.nodeType||s)return t(e,n,r);return!1}:function(e,n,l){var u,c,d,h=[w,a];if(l){for(;e=e[i];)if((1===e.nodeType||s)&&t(e,n,l))return!0}else for(;e=e[i];)if(1===e.nodeType||s)if(c=(d=e[_]||(e[_]={}))[e.uniqueID]||(d[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[i]||e;else{if((u=c[o])&&u[0]===w&&u[1]===a)return h[2]=u[2];if(c[o]=h,h[2]=t(e,n,l))return!0}return!1}}function bt(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function _t(t,e,n,i,r){for(var o,s=[],a=0,l=t.length,u=null!=e;a<l;a++)(o=t[a])&&(n&&!n(o,i,r)||(s.push(o),u&&e.push(a)));return s}function xt(t,e,n,i,r,o){return i&&!i[_]&&(i=xt(i)),r&&!r[_]&&(r=xt(r,o)),at(function(o,s,a,l){var u,c,d,h=[],p=[],f=s.length,g=o||function(t,e,n){for(var i=0,r=e.length;i<r;i++)ot(t,e[i],n);return n}(e||"*",a.nodeType?[a]:a,[]),m=!t||!o&&e?g:_t(g,h,t,a,l),v=n?r||(o?t:f||i)?[]:s:m;if(n&&n(m,v,a,l),i)for(u=_t(v,p),i(u,[],a,l),c=u.length;c--;)(d=u[c])&&(v[p[c]]=!(m[p[c]]=d));if(o){if(r||t){if(r){for(u=[],c=v.length;c--;)(d=v[c])&&u.push(m[c]=d);r(null,v=[],u,l)}for(c=v.length;c--;)(d=v[c])&&(u=r?j(o,d):h[c])>-1&&(o[u]=!(s[u]=d))}}else v=_t(v===s?v.splice(f,v.length):v),r?r(null,s,v,l):C.apply(s,v)})}function wt(t){for(var e,n,r,o=t.length,s=i.relative[t[0].type],a=s||i.relative[" "],l=s?1:0,c=yt(function(t){return t===e},a,!0),d=yt(function(t){return j(e,t)>-1},a,!0),h=[function(t,n,i){var r=!s&&(i||n!==u)||((e=n).nodeType?c(t,n,i):d(t,n,i));return e=null,r}];l<o;l++)if(n=i.relative[t[l].type])h=[yt(bt(h),n)];else{if((n=i.filter[t[l].type].apply(null,t[l].matches))[_]){for(r=++l;r<o&&!i.relative[t[r].type];r++);return xt(l>1&&bt(h),l>1&&vt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(B,"$1"),n,l<r&&wt(t.slice(l,r)),r<o&&wt(t=t.slice(r)),r<o&&vt(t))}h.push(n)}return bt(h)}return mt.prototype=i.filters=i.pseudos,i.setFilters=new mt,s=ot.tokenize=function(t,e){var n,r,o,s,a,l,u,c=T[t+" "];if(c)return e?0:c.slice(0);for(a=t,l=[],u=i.preFilter;a;){for(s in n&&!(r=H.exec(a))||(r&&(a=a.slice(r[0].length)||a),l.push(o=[])),n=!1,(r=G.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(B," ")}),a=a.slice(n.length)),i.filter)!(r=Q[s].exec(a))||u[s]&&!(r=u[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return e?a.length:a?ot.error(t):T(t,l).slice(0)},a=ot.compile=function(t,e){var n,r=[],o=[],a=S[t+" "];if(!a){for(e||(e=s(t)),n=e.length;n--;)(a=wt(e[n]))[_]?r.push(a):o.push(a);(a=S(t,function(t,e){var n=e.length>0,r=t.length>0,o=function(o,s,a,l,c){var d,f,m,v=0,y="0",b=o&&[],_=[],x=u,A=o||r&&i.find.TAG("*",c),k=w+=null==x?1:Math.random()||.1,T=A.length;for(c&&(u=s===p||s||c);y!==T&&null!=(d=A[y]);y++){if(r&&d){for(f=0,s||d.ownerDocument===p||(h(d),a=!g);m=t[f++];)if(m(d,s||p,a)){l.push(d);break}c&&(w=k)}n&&((d=!m&&d)&&v--,o&&b.push(d))}if(v+=y,n&&y!==v){for(f=0;m=e[f++];)m(b,_,s,a);if(o){if(v>0)for(;y--;)b[y]||_[y]||(_[y]=O.call(l));_=_t(_)}C.apply(l,_),c&&!o&&_.length>0&&v+e.length>1&&ot.uniqueSort(l)}return c&&(w=k,u=x),b};return n?at(o):o}(o,r))).selector=t}return a},l=ot.select=function(t,e,n,r){var o,l,u,c,d,h="function"==typeof t&&t,p=!r&&s(t=h.selector||t);if(n=n||[],1===p.length){if((l=p[0]=p[0].slice(0)).length>2&&"ID"===(u=l[0]).type&&9===e.nodeType&&g&&i.relative[l[1].type]){if(!(e=(i.find.ID(u.matches[0].replace(X,tt),e)||[])[0]))return n;h&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(o=Q.needsContext.test(t)?0:l.length;o--&&(u=l[o],!i.relative[c=u.type]);)if((d=i.find[c])&&(r=d(u.matches[0].replace(X,tt),Y.test(l[0].type)&&gt(e.parentNode)||e))){if(l.splice(o,1),!(t=r.length&&vt(l)))return C.apply(n,r),n;break}}return(h||a(t,p))(r,e,!g,n,!e||Y.test(t)&&gt(e.parentNode)||e),n},n.sortStable=_.split("").sort(M).join("")===_,n.detectDuplicates=!!d,h(),n.sortDetached=lt(function(t){return 1&t.compareDocumentPosition(p.createElement("fieldset"))}),lt(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||ut("type|href|height|width",function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),n.attributes&&lt(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||ut("value",function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),lt(function(t){return null==t.getAttribute("disabled")})||ut(D,function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),ot}(n);A.find=S,A.expr=S.selectors,A.expr[":"]=A.expr.pseudos,A.uniqueSort=A.unique=S.uniqueSort,A.text=S.getText,A.isXMLDoc=S.isXML,A.contains=S.contains,A.escapeSelector=S.escape;var M=function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&A(t).is(n))break;i.push(t)}return i},E=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},N=A.expr.match.needsContext;function O(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var q=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function C(t,e,n){return y(e)?A.grep(t,function(t,i){return!!e.call(t,i,t)!==n}):e.nodeType?A.grep(t,function(t){return t===e!==n}):"string"!=typeof e?A.grep(t,function(t){return d.call(e,t)>-1!==n}):A.filter(e,t,n)}A.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?A.find.matchesSelector(i,t)?[i]:[]:A.find.matches(t,A.grep(e,function(t){return 1===t.nodeType}))},A.fn.extend({find:function(t){var e,n,i=this.length,r=this;if("string"!=typeof t)return this.pushStack(A(t).filter(function(){for(e=0;e<i;e++)if(A.contains(r[e],this))return!0}));for(n=this.pushStack([]),e=0;e<i;e++)A.find(t,r[e],n);return i>1?A.uniqueSort(n):n},filter:function(t){return this.pushStack(C(this,t||[],!1))},not:function(t){return this.pushStack(C(this,t||[],!0))},is:function(t){return!!C(this,"string"==typeof t&&N.test(t)?A(t):t||[],!1).length}});var P,j=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(A.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||P,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:j.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof A?e[0]:e,A.merge(this,A.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:s,!0)),q.test(i[1])&&A.isPlainObject(e))for(i in e)y(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(r=s.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):y(t)?void 0!==n.ready?n.ready(t):t(A):A.makeArray(t,this)}).prototype=A.fn,P=A(s);var D=/^(?:parents|prev(?:Until|All))/,I={children:!0,contents:!0,next:!0,prev:!0};function F(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}A.fn.extend({has:function(t){var e=A(t,this),n=e.length;return this.filter(function(){for(var t=0;t<n;t++)if(A.contains(this,e[t]))return!0})},closest:function(t,e){var n,i=0,r=this.length,o=[],s="string"!=typeof t&&A(t);if(!N.test(t))for(;i<r;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&A.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?A.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?d.call(A(t),this[0]):d.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(A.uniqueSort(A.merge(this.get(),A(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),A.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return M(t,"parentNode")},parentsUntil:function(t,e,n){return M(t,"parentNode",n)},next:function(t){return F(t,"nextSibling")},prev:function(t){return F(t,"previousSibling")},nextAll:function(t){return M(t,"nextSibling")},prevAll:function(t){return M(t,"previousSibling")},nextUntil:function(t,e,n){return M(t,"nextSibling",n)},prevUntil:function(t,e,n){return M(t,"previousSibling",n)},siblings:function(t){return E((t.parentNode||{}).firstChild,t)},children:function(t){return E(t.firstChild)},contents:function(t){return O(t,"iframe")?t.contentDocument:(O(t,"template")&&(t=t.content||t),A.merge([],t.childNodes))}},function(t,e){A.fn[t]=function(n,i){var r=A.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=A.filter(i,r)),this.length>1&&(I[t]||A.uniqueSort(r),D.test(t)&&r.reverse()),this.pushStack(r)}});var L=/[^\x20\t\r\n\f]+/g;function z(t){return t}function R(t){throw t}function B(t,e,n,i){var r;try{t&&y(r=t.promise)?r.call(t).done(e).fail(n):t&&y(r=t.then)?r.call(t,e,n):e.apply(void 0,[t].slice(i))}catch(t){n.apply(void 0,[t])}}A.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return A.each(t.match(L)||[],function(t,n){e[n]=!0}),e}(t):A.extend({},t);var e,n,i,r,o=[],s=[],a=-1,l=function(){for(r=r||t.once,i=e=!0;s.length;a=-1)for(n=s.shift();++a<o.length;)!1===o[a].apply(n[0],n[1])&&t.stopOnFalse&&(a=o.length,n=!1);t.memory||(n=!1),e=!1,r&&(o=n?[]:"")},u={add:function(){return o&&(n&&!e&&(a=o.length-1,s.push(n)),function e(n){A.each(n,function(n,i){y(i)?t.unique&&u.has(i)||o.push(i):i&&i.length&&"string"!==w(i)&&e(i)})}(arguments),n&&!e&&l()),this},remove:function(){return A.each(arguments,function(t,e){for(var n;(n=A.inArray(e,o,n))>-1;)o.splice(n,1),n<=a&&a--}),this},has:function(t){return t?A.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=s=[],o=n="",this},disabled:function(){return!o},lock:function(){return r=s=[],n||e||(o=n=""),this},locked:function(){return!!r},fireWith:function(t,n){return r||(n=[t,(n=n||[]).slice?n.slice():n],s.push(n),e||l()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},A.extend({Deferred:function(t){var e=[["notify","progress",A.Callbacks("memory"),A.Callbacks("memory"),2],["resolve","done",A.Callbacks("once memory"),A.Callbacks("once memory"),0,"resolved"],["reject","fail",A.Callbacks("once memory"),A.Callbacks("once memory"),1,"rejected"]],i="pending",r={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return A.Deferred(function(n){A.each(e,function(e,i){var r=y(t[i[4]])&&t[i[4]];o[i[1]](function(){var t=r&&r.apply(this,arguments);t&&y(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,r?[t]:arguments)})}),t=null}).promise()},then:function(t,i,r){var o=0;function s(t,e,i,r){return function(){var a=this,l=arguments,u=function(){var n,u;if(!(t<o)){if((n=i.apply(a,l))===e.promise())throw new TypeError("Thenable self-resolution");u=n&&("object"==typeof n||"function"==typeof n)&&n.then,y(u)?r?u.call(n,s(o,e,z,r),s(o,e,R,r)):(o++,u.call(n,s(o,e,z,r),s(o,e,R,r),s(o,e,z,e.notifyWith))):(i!==z&&(a=void 0,l=[n]),(r||e.resolveWith)(a,l))}},c=r?u:function(){try{u()}catch(n){A.Deferred.exceptionHook&&A.Deferred.exceptionHook(n,c.stackTrace),t+1>=o&&(i!==R&&(a=void 0,l=[n]),e.rejectWith(a,l))}};t?c():(A.Deferred.getStackHook&&(c.stackTrace=A.Deferred.getStackHook()),n.setTimeout(c))}}return A.Deferred(function(n){e[0][3].add(s(0,n,y(r)?r:z,n.notifyWith)),e[1][3].add(s(0,n,y(t)?t:z)),e[2][3].add(s(0,n,y(i)?i:R))}).promise()},promise:function(t){return null!=t?A.extend(t,r):r}},o={};return A.each(e,function(t,n){var s=n[2],a=n[5];r[n[1]]=s.add,a&&s.add(function(){i=a},e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),s.add(n[3].fire),o[n[0]]=function(){return o[n[0]+"With"](this===o?void 0:this,arguments),this},o[n[0]+"With"]=s.fireWith}),r.promise(o),t&&t.call(o,o),o},when:function(t){var e=arguments.length,n=e,i=Array(n),r=l.call(arguments),o=A.Deferred(),s=function(t){return function(n){i[t]=this,r[t]=arguments.length>1?l.call(arguments):n,--e||o.resolveWith(i,r)}};if(e<=1&&(B(t,o.done(s(n)).resolve,o.reject,!e),"pending"===o.state()||y(r[n]&&r[n].then)))return o.then();for(;n--;)B(r[n],s(n),o.reject);return o.promise()}});var H=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;A.Deferred.exceptionHook=function(t,e){n.console&&n.console.warn&&t&&H.test(t.name)&&n.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},A.readyException=function(t){n.setTimeout(function(){throw t})};var G=A.Deferred();function V(){s.removeEventListener("DOMContentLoaded",V),n.removeEventListener("load",V),A.ready()}A.fn.ready=function(t){return G.then(t).catch(function(t){A.readyException(t)}),this},A.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--A.readyWait:A.isReady)||(A.isReady=!0,!0!==t&&--A.readyWait>0||G.resolveWith(s,[A]))}}),A.ready.then=G.then,"complete"===s.readyState||"loading"!==s.readyState&&!s.documentElement.doScroll?n.setTimeout(A.ready):(s.addEventListener("DOMContentLoaded",V),n.addEventListener("load",V));var U=function(t,e,n,i,r,o,s){var a=0,l=t.length,u=null==n;if("object"===w(n))for(a in r=!0,n)U(t,e,a,n[a],!0,o,s);else if(void 0!==i&&(r=!0,y(i)||(s=!0),u&&(s?(e.call(t,i),e=null):(u=e,e=function(t,e,n){return u.call(A(t),n)})),e))for(;a<l;a++)e(t[a],n,s?i:i.call(t[a],a,e(t[a],n)));return r?t:u?e.call(t):l?e(t[0],n):o},W=/^-ms-/,Q=/-([a-z])/g;function $(t,e){return e.toUpperCase()}function K(t){return t.replace(W,"ms-").replace(Q,$)}var J=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function Z(){this.expando=A.expando+Z.uid++}Z.uid=1,Z.prototype={cache:function(t){var e=t[this.expando];return e||(e={},J(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,r=this.cache(t);if("string"==typeof e)r[K(e)]=n;else for(i in e)r[K(i)]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][K(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i=t[this.expando];if(void 0!==i){if(void 0!==e){n=(e=Array.isArray(e)?e.map(K):(e=K(e))in i?[e]:e.match(L)||[]).length;for(;n--;)delete i[e[n]]}(void 0===e||A.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!A.isEmptyObject(e)}};var Y=new Z,X=new Z,tt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,et=/[A-Z]/g;function nt(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(et,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:tt.test(t)?JSON.parse(t):t)}(n)}catch(t){}X.set(t,e,n)}else n=void 0;return n}A.extend({hasData:function(t){return X.hasData(t)||Y.hasData(t)},data:function(t,e,n){return X.access(t,e,n)},removeData:function(t,e){X.remove(t,e)},_data:function(t,e,n){return Y.access(t,e,n)},_removeData:function(t,e){Y.remove(t,e)}}),A.fn.extend({data:function(t,e){var n,i,r,o=this[0],s=o&&o.attributes;if(void 0===t){if(this.length&&(r=X.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(i=s[n].name).indexOf("data-")&&(i=K(i.slice(5)),nt(o,i,r[i]));Y.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each(function(){X.set(this,t)}):U(this,function(e){var n;if(o&&void 0===e)return void 0!==(n=X.get(o,t))?n:void 0!==(n=nt(o,t))?n:void 0;this.each(function(){X.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){X.remove(this,t)})}}),A.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=Y.get(t,e),n&&(!i||Array.isArray(n)?i=Y.access(t,e,A.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=A.queue(t,e),i=n.length,r=n.shift(),o=A._queueHooks(t,e);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,function(){A.dequeue(t,e)},o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return Y.get(t,n)||Y.access(t,n,{empty:A.Callbacks("once memory").add(function(){Y.remove(t,[e+"queue",n])})})}}),A.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?A.queue(this[0],t):void 0===e?this:this.each(function(){var n=A.queue(this,t,e);A._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&A.dequeue(this,t)})},dequeue:function(t){return this.each(function(){A.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=A.Deferred(),o=this,s=this.length,a=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(n=Y.get(o[s],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),r.promise(e)}});var it=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rt=new RegExp("^(?:([+-])=|)("+it+")([a-z%]*)$","i"),ot=["Top","Right","Bottom","Left"],st=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&A.contains(t.ownerDocument,t)&&"none"===A.css(t,"display")},at=function(t,e,n,i){var r,o,s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];for(o in r=n.apply(t,i||[]),e)t.style[o]=s[o];return r};function lt(t,e,n,i){var r,o,s=20,a=i?function(){return i.cur()}:function(){return A.css(t,e,"")},l=a(),u=n&&n[3]||(A.cssNumber[e]?"":"px"),c=(A.cssNumber[e]||"px"!==u&&+l)&&rt.exec(A.css(t,e));if(c&&c[3]!==u){for(l/=2,u=u||c[3],c=+l||1;s--;)A.style(t,e,c+u),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),c/=o;c*=2,A.style(t,e,c+u),n=n||[]}return n&&(c=+c||+l||0,r=n[1]?c+(n[1]+1)*n[2]:+n[2],i&&(i.unit=u,i.start=c,i.end=r)),r}var ut={};function ct(t){var e,n=t.ownerDocument,i=t.nodeName,r=ut[i];return r||(e=n.body.appendChild(n.createElement(i)),r=A.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),ut[i]=r,r)}function dt(t,e){for(var n,i,r=[],o=0,s=t.length;o<s;o++)(i=t[o]).style&&(n=i.style.display,e?("none"===n&&(r[o]=Y.get(i,"display")||null,r[o]||(i.style.display="")),""===i.style.display&&st(i)&&(r[o]=ct(i))):"none"!==n&&(r[o]="none",Y.set(i,"display",n)));for(o=0;o<s;o++)null!=r[o]&&(t[o].style.display=r[o]);return t}A.fn.extend({show:function(){return dt(this,!0)},hide:function(){return dt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){st(this)?A(this).show():A(this).hide()})}});var ht=/^(?:checkbox|radio)$/i,pt=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,ft=/^$|^module$|\/(?:java|ecma)script/i,gt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function mt(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&O(t,e)?A.merge([t],n):n}function vt(t,e){for(var n=0,i=t.length;n<i;n++)Y.set(t[n],"globalEval",!e||Y.get(e[n],"globalEval"))}gt.optgroup=gt.option,gt.tbody=gt.tfoot=gt.colgroup=gt.caption=gt.thead,gt.th=gt.td;var yt,bt,_t=/<|&#?\w+;/;function xt(t,e,n,i,r){for(var o,s,a,l,u,c,d=e.createDocumentFragment(),h=[],p=0,f=t.length;p<f;p++)if((o=t[p])||0===o)if("object"===w(o))A.merge(h,o.nodeType?[o]:o);else if(_t.test(o)){for(s=s||d.appendChild(e.createElement("div")),a=(pt.exec(o)||["",""])[1].toLowerCase(),l=gt[a]||gt._default,s.innerHTML=l[1]+A.htmlPrefilter(o)+l[2],c=l[0];c--;)s=s.lastChild;A.merge(h,s.childNodes),(s=d.firstChild).textContent=""}else h.push(e.createTextNode(o));for(d.textContent="",p=0;o=h[p++];)if(i&&A.inArray(o,i)>-1)r&&r.push(o);else if(u=A.contains(o.ownerDocument,o),s=mt(d.appendChild(o),"script"),u&&vt(s),n)for(c=0;o=s[c++];)ft.test(o.type||"")&&n.push(o);return d}yt=s.createDocumentFragment().appendChild(s.createElement("div")),(bt=s.createElement("input")).setAttribute("type","radio"),bt.setAttribute("checked","checked"),bt.setAttribute("name","t"),yt.appendChild(bt),v.checkClone=yt.cloneNode(!0).cloneNode(!0).lastChild.checked,yt.innerHTML="<textarea>x</textarea>",v.noCloneChecked=!!yt.cloneNode(!0).lastChild.defaultValue;var wt=s.documentElement,At=/^key/,kt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Tt=/^([^.]*)(?:\.(.+)|)/;function St(){return!0}function Mt(){return!1}function Et(){try{return s.activeElement}catch(t){}}function Nt(t,e,n,i,r,o){var s,a;if("object"==typeof e){for(a in"string"!=typeof n&&(i=i||n,n=void 0),e)Nt(t,a,n,i,e[a],o);return t}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=Mt;else if(!r)return t;return 1===o&&(s=r,(r=function(t){return A().off(t),s.apply(this,arguments)}).guid=s.guid||(s.guid=A.guid++)),t.each(function(){A.event.add(this,e,r,i,n)})}A.event={global:{},add:function(t,e,n,i,r){var o,s,a,l,u,c,d,h,p,f,g,m=Y.get(t);if(m)for(n.handler&&(n=(o=n).handler,r=o.selector),r&&A.find.matchesSelector(wt,r),n.guid||(n.guid=A.guid++),(l=m.events)||(l=m.events={}),(s=m.handle)||(s=m.handle=function(e){return void 0!==A&&A.event.triggered!==e.type?A.event.dispatch.apply(t,arguments):void 0}),u=(e=(e||"").match(L)||[""]).length;u--;)p=g=(a=Tt.exec(e[u])||[])[1],f=(a[2]||"").split(".").sort(),p&&(d=A.event.special[p]||{},p=(r?d.delegateType:d.bindType)||p,d=A.event.special[p]||{},c=A.extend({type:p,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&A.expr.match.needsContext.test(r),namespace:f.join(".")},o),(h=l[p])||((h=l[p]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(t,i,f,s)||t.addEventListener&&t.addEventListener(p,s)),d.add&&(d.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),r?h.splice(h.delegateCount++,0,c):h.push(c),A.event.global[p]=!0)},remove:function(t,e,n,i,r){var o,s,a,l,u,c,d,h,p,f,g,m=Y.hasData(t)&&Y.get(t);if(m&&(l=m.events)){for(u=(e=(e||"").match(L)||[""]).length;u--;)if(p=g=(a=Tt.exec(e[u])||[])[1],f=(a[2]||"").split(".").sort(),p){for(d=A.event.special[p]||{},h=l[p=(i?d.delegateType:d.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=h.length;o--;)c=h[o],!r&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(h.splice(o,1),c.selector&&h.delegateCount--,d.remove&&d.remove.call(t,c));s&&!h.length&&(d.teardown&&!1!==d.teardown.call(t,f,m.handle)||A.removeEvent(t,p,m.handle),delete l[p])}else for(p in l)A.event.remove(t,p+e[u],n,i,!0);A.isEmptyObject(l)&&Y.remove(t,"handle events")}},dispatch:function(t){var e,n,i,r,o,s,a=A.event.fix(t),l=new Array(arguments.length),u=(Y.get(this,"events")||{})[a.type]||[],c=A.event.special[a.type]||{};for(l[0]=a,e=1;e<arguments.length;e++)l[e]=arguments[e];if(a.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,a)){for(s=A.event.handlers.call(this,a,u),e=0;(r=s[e++])&&!a.isPropagationStopped();)for(a.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(o.namespace)||(a.handleObj=o,a.data=o.data,void 0!==(i=((A.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,l))&&!1===(a.result=i)&&(a.preventDefault(),a.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,a),a.result}},handlers:function(t,e){var n,i,r,o,s,a=[],l=e.delegateCount,u=t.target;if(l&&u.nodeType&&!("click"===t.type&&t.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==t.type||!0!==u.disabled)){for(o=[],s={},n=0;n<l;n++)void 0===s[r=(i=e[n]).selector+" "]&&(s[r]=i.needsContext?A(r,this).index(u)>-1:A.find(r,this,null,[u]).length),s[r]&&o.push(i);o.length&&a.push({elem:u,handlers:o})}return u=this,l<e.length&&a.push({elem:u,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(A.Event.prototype,t,{enumerable:!0,configurable:!0,get:y(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[A.expando]?t:new A.Event(t)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Et()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Et()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&O(this,"input"))return this.click(),!1},_default:function(t){return O(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},A.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},A.Event=function(t,e){if(!(this instanceof A.Event))return new A.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?St:Mt,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&A.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[A.expando]=!0},A.Event.prototype={constructor:A.Event,isDefaultPrevented:Mt,isPropagationStopped:Mt,isImmediatePropagationStopped:Mt,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=St,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=St,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=St,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},A.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&At.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&kt.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},A.event.addProp),A.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){A.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=t.relatedTarget,r=t.handleObj;return i&&(i===this||A.contains(this,i))||(t.type=r.origType,n=r.handler.apply(this,arguments),t.type=e),n}}}),A.fn.extend({on:function(t,e,n,i){return Nt(this,t,e,n,i)},one:function(t,e,n,i){return Nt(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,A(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=Mt),this.each(function(){A.event.remove(this,t,n,e)})}});var Ot=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,qt=/<script|<style|<link/i,Ct=/checked\s*(?:[^=]|=\s*.checked.)/i,Pt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function jt(t,e){return O(t,"table")&&O(11!==e.nodeType?e:e.firstChild,"tr")&&A(t).children("tbody")[0]||t}function Dt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function It(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Ft(t,e){var n,i,r,o,s,a,l,u;if(1===e.nodeType){if(Y.hasData(t)&&(o=Y.access(t),s=Y.set(e,o),u=o.events))for(r in delete s.handle,s.events={},u)for(n=0,i=u[r].length;n<i;n++)A.event.add(e,r,u[r][n]);X.hasData(t)&&(a=X.access(t),l=A.extend({},a),X.set(e,l))}}function Lt(t,e,n,i){e=u.apply([],e);var r,o,s,a,l,c,d=0,h=t.length,p=h-1,f=e[0],g=y(f);if(g||h>1&&"string"==typeof f&&!v.checkClone&&Ct.test(f))return t.each(function(r){var o=t.eq(r);g&&(e[0]=f.call(this,r,o.html())),Lt(o,e,n,i)});if(h&&(o=(r=xt(e,t[0].ownerDocument,!1,t,i)).firstChild,1===r.childNodes.length&&(r=o),o||i)){for(a=(s=A.map(mt(r,"script"),Dt)).length;d<h;d++)l=r,d!==p&&(l=A.clone(l,!0,!0),a&&A.merge(s,mt(l,"script"))),n.call(t[d],l,d);if(a)for(c=s[s.length-1].ownerDocument,A.map(s,It),d=0;d<a;d++)l=s[d],ft.test(l.type||"")&&!Y.access(l,"globalEval")&&A.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?A._evalUrl&&A._evalUrl(l.src):x(l.textContent.replace(Pt,""),c,l))}return t}function zt(t,e,n){for(var i,r=e?A.filter(e,t):t,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||A.cleanData(mt(i)),i.parentNode&&(n&&A.contains(i.ownerDocument,i)&&vt(mt(i,"script")),i.parentNode.removeChild(i));return t}A.extend({htmlPrefilter:function(t){return t.replace(Ot,"<$1></$2>")},clone:function(t,e,n){var i,r,o,s,a,l,u,c=t.cloneNode(!0),d=A.contains(t.ownerDocument,t);if(!(v.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||A.isXMLDoc(t)))for(s=mt(c),i=0,r=(o=mt(t)).length;i<r;i++)a=o[i],"input"===(u=(l=s[i]).nodeName.toLowerCase())&&ht.test(a.type)?l.checked=a.checked:"input"!==u&&"textarea"!==u||(l.defaultValue=a.defaultValue);if(e)if(n)for(o=o||mt(t),s=s||mt(c),i=0,r=o.length;i<r;i++)Ft(o[i],s[i]);else Ft(t,c);return(s=mt(c,"script")).length>0&&vt(s,!d&&mt(t,"script")),c},cleanData:function(t){for(var e,n,i,r=A.event.special,o=0;void 0!==(n=t[o]);o++)if(J(n)){if(e=n[Y.expando]){if(e.events)for(i in e.events)r[i]?A.event.remove(n,i):A.removeEvent(n,i,e.handle);n[Y.expando]=void 0}n[X.expando]&&(n[X.expando]=void 0)}}}),A.fn.extend({detach:function(t){return zt(this,t,!0)},remove:function(t){return zt(this,t)},text:function(t){return U(this,function(t){return void 0===t?A.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return Lt(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||jt(this,t).appendChild(t)})},prepend:function(){return Lt(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=jt(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return Lt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return Lt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(A.cleanData(mt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return A.clone(this,t,e)})},html:function(t){return U(this,function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!qt.test(t)&&!gt[(pt.exec(t)||["",""])[1].toLowerCase()]){t=A.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(A.cleanData(mt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return Lt(this,arguments,function(e){var n=this.parentNode;A.inArray(this,t)<0&&(A.cleanData(mt(this)),n&&n.replaceChild(e,this))},t)}}),A.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){A.fn[t]=function(t){for(var n,i=[],r=A(t),o=r.length-1,s=0;s<=o;s++)n=s===o?this:this.clone(!0),A(r[s])[e](n),c.apply(i,n.get());return this.pushStack(i)}});var Rt=new RegExp("^("+it+")(?!px)[a-z%]+$","i"),Bt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=n),e.getComputedStyle(t)},Ht=new RegExp(ot.join("|"),"i");function Gt(t,e,n){var i,r,o,s,a=t.style;return(n=n||Bt(t))&&(""!==(s=n.getPropertyValue(e)||n[e])||A.contains(t.ownerDocument,t)||(s=A.style(t,e)),!v.pixelBoxStyles()&&Rt.test(s)&&Ht.test(e)&&(i=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=i,a.minWidth=r,a.maxWidth=o)),void 0!==s?s+"":s}function Vt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(c){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",wt.appendChild(u).appendChild(c);var t=n.getComputedStyle(c);i="1%"!==t.top,l=12===e(t.marginLeft),c.style.right="60%",a=36===e(t.right),r=36===e(t.width),c.style.position="absolute",o=36===c.offsetWidth||"absolute",wt.removeChild(u),c=null}}function e(t){return Math.round(parseFloat(t))}var i,r,o,a,l,u=s.createElement("div"),c=s.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",v.clearCloneStyle="content-box"===c.style.backgroundClip,A.extend(v,{boxSizingReliable:function(){return t(),r},pixelBoxStyles:function(){return t(),a},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),l},scrollboxSize:function(){return t(),o}}))}();var Ut=/^(none|table(?!-c[ea]).+)/,Wt=/^--/,Qt={position:"absolute",visibility:"hidden",display:"block"},$t={letterSpacing:"0",fontWeight:"400"},Kt=["Webkit","Moz","ms"],Jt=s.createElement("div").style;function Zt(t){var e=A.cssProps[t];return e||(e=A.cssProps[t]=function(t){if(t in Jt)return t;for(var e=t[0].toUpperCase()+t.slice(1),n=Kt.length;n--;)if((t=Kt[n]+e)in Jt)return t}(t)||t),e}function Yt(t,e,n){var i=rt.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function Xt(t,e,n,i,r,o){var s="width"===e?1:0,a=0,l=0;if(n===(i?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(l+=A.css(t,n+ot[s],!0,r)),i?("content"===n&&(l-=A.css(t,"padding"+ot[s],!0,r)),"margin"!==n&&(l-=A.css(t,"border"+ot[s]+"Width",!0,r))):(l+=A.css(t,"padding"+ot[s],!0,r),"padding"!==n?l+=A.css(t,"border"+ot[s]+"Width",!0,r):a+=A.css(t,"border"+ot[s]+"Width",!0,r));return!i&&o>=0&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-l-a-.5))),l}function te(t,e,n){var i=Bt(t),r=Gt(t,e,i),o="border-box"===A.css(t,"boxSizing",!1,i),s=o;if(Rt.test(r)){if(!n)return r;r="auto"}return s=s&&(v.boxSizingReliable()||r===t.style[e]),("auto"===r||!parseFloat(r)&&"inline"===A.css(t,"display",!1,i))&&(r=t["offset"+e[0].toUpperCase()+e.slice(1)],s=!0),(r=parseFloat(r)||0)+Xt(t,e,n||(o?"border":"content"),s,i,r)+"px"}function ee(t,e,n,i,r){return new ee.prototype.init(t,e,n,i,r)}A.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Gt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,s,a=K(e),l=Wt.test(e),u=t.style;if(l||(e=Zt(a)),s=A.cssHooks[e]||A.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(r=s.get(t,!1,i))?r:u[e];"string"==(o=typeof n)&&(r=rt.exec(n))&&r[1]&&(n=lt(t,e,r),o="number"),null!=n&&n==n&&("number"===o&&(n+=r&&r[3]||(A.cssNumber[a]?"":"px")),v.clearCloneStyle||""!==n||0!==e.indexOf("background")||(u[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,i))||(l?u.setProperty(e,n):u[e]=n))}},css:function(t,e,n,i){var r,o,s,a=K(e);return Wt.test(e)||(e=Zt(a)),(s=A.cssHooks[e]||A.cssHooks[a])&&"get"in s&&(r=s.get(t,!0,n)),void 0===r&&(r=Gt(t,e,i)),"normal"===r&&e in $t&&(r=$t[e]),""===n||n?(o=parseFloat(r),!0===n||isFinite(o)?o||0:r):r}}),A.each(["height","width"],function(t,e){A.cssHooks[e]={get:function(t,n,i){if(n)return!Ut.test(A.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?te(t,e,i):at(t,Qt,function(){return te(t,e,i)})},set:function(t,n,i){var r,o=Bt(t),s="border-box"===A.css(t,"boxSizing",!1,o),a=i&&Xt(t,e,i,s,o);return s&&v.scrollboxSize()===o.position&&(a-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(o[e])-Xt(t,e,"border",!1,o)-.5)),a&&(r=rt.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=A.css(t,e)),Yt(0,n,a)}}}),A.cssHooks.marginLeft=Vt(v.reliableMarginLeft,function(t,e){if(e)return(parseFloat(Gt(t,"marginLeft"))||t.getBoundingClientRect().left-at(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),A.each({margin:"",padding:"",border:"Width"},function(t,e){A.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[t+ot[i]+e]=o[i]||o[i-2]||o[0];return r}},"margin"!==t&&(A.cssHooks[t+e].set=Yt)}),A.fn.extend({css:function(t,e){return U(this,function(t,e,n){var i,r,o={},s=0;if(Array.isArray(e)){for(i=Bt(t),r=e.length;s<r;s++)o[e[s]]=A.css(t,e[s],!1,i);return o}return void 0!==n?A.style(t,e,n):A.css(t,e)},t,e,arguments.length>1)}}),A.Tween=ee,ee.prototype={constructor:ee,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||A.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(A.cssNumber[n]?"":"px")},cur:function(){var t=ee.propHooks[this.prop];return t&&t.get?t.get(this):ee.propHooks._default.get(this)},run:function(t){var e,n=ee.propHooks[this.prop];return this.options.duration?this.pos=e=A.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):ee.propHooks._default.set(this),this}},ee.prototype.init.prototype=ee.prototype,ee.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=A.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){A.fx.step[t.prop]?A.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[A.cssProps[t.prop]]&&!A.cssHooks[t.prop]?t.elem[t.prop]=t.now:A.style(t.elem,t.prop,t.now+t.unit)}}},ee.propHooks.scrollTop=ee.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},A.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},A.fx=ee.prototype.init,A.fx.step={};var ne,ie,re=/^(?:toggle|show|hide)$/,oe=/queueHooks$/;function se(){ie&&(!1===s.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(se):n.setTimeout(se,A.fx.interval),A.fx.tick())}function ae(){return n.setTimeout(function(){ne=void 0}),ne=Date.now()}function le(t,e){var n,i=0,r={height:t};for(e=e?1:0;i<4;i+=2-e)r["margin"+(n=ot[i])]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function ue(t,e,n){for(var i,r=(ce.tweeners[e]||[]).concat(ce.tweeners["*"]),o=0,s=r.length;o<s;o++)if(i=r[o].call(n,e,t))return i}function ce(t,e,n){var i,r,o=0,s=ce.prefilters.length,a=A.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var e=ne||ae(),n=Math.max(0,u.startTime+u.duration-e),i=1-(n/u.duration||0),o=0,s=u.tweens.length;o<s;o++)u.tweens[o].run(i);return a.notifyWith(t,[u,i,n]),i<1&&s?n:(s||a.notifyWith(t,[u,1,0]),a.resolveWith(t,[u]),!1)},u=a.promise({elem:t,props:A.extend({},e),opts:A.extend(!0,{specialEasing:{},easing:A.easing._default},n),originalProperties:e,originalOptions:n,startTime:ne||ae(),duration:n.duration,tweens:[],createTween:function(e,n){var i=A.Tween(t,u.opts,e,n,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(i),i},stop:function(e){var n=0,i=e?u.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)u.tweens[n].run(1);return e?(a.notifyWith(t,[u,1,0]),a.resolveWith(t,[u,e])):a.rejectWith(t,[u,e]),this}}),c=u.props;for(function(t,e){var n,i,r,o,s;for(n in t)if(r=e[i=K(n)],o=t[n],Array.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),(s=A.cssHooks[i])&&"expand"in s)for(n in o=s.expand(o),delete t[i],o)n in t||(t[n]=o[n],e[n]=r);else e[i]=r}(c,u.opts.specialEasing);o<s;o++)if(i=ce.prefilters[o].call(u,t,c,u.opts))return y(i.stop)&&(A._queueHooks(u.elem,u.opts.queue).stop=i.stop.bind(i)),i;return A.map(c,ue,u),y(u.opts.start)&&u.opts.start.call(t,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),A.fx.timer(A.extend(l,{elem:t,anim:u,queue:u.opts.queue})),u}A.Animation=A.extend(ce,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return lt(n.elem,t,rt.exec(e),n),n}]},tweener:function(t,e){y(t)?(e=t,t=["*"]):t=t.match(L);for(var n,i=0,r=t.length;i<r;i++)n=t[i],ce.tweeners[n]=ce.tweeners[n]||[],ce.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var i,r,o,s,a,l,u,c,d="width"in e||"height"in e,h=this,p={},f=t.style,g=t.nodeType&&st(t),m=Y.get(t,"fxshow");for(i in n.queue||(null==(s=A._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,h.always(function(){h.always(function(){s.unqueued--,A.queue(t,"fx").length||s.empty.fire()})})),e)if(r=e[i],re.test(r)){if(delete e[i],o=o||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;g=!0}p[i]=m&&m[i]||A.style(t,i)}if((l=!A.isEmptyObject(e))||!A.isEmptyObject(p))for(i in d&&1===t.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],null==(u=m&&m.display)&&(u=Y.get(t,"display")),"none"===(c=A.css(t,"display"))&&(u?c=u:(dt([t],!0),u=t.style.display||u,c=A.css(t,"display"),dt([t]))),("inline"===c||"inline-block"===c&&null!=u)&&"none"===A.css(t,"float")&&(l||(h.done(function(){f.display=u}),null==u&&(c=f.display,u="none"===c?"":c)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",h.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]})),l=!1,p)l||(m?"hidden"in m&&(g=m.hidden):m=Y.access(t,"fxshow",{display:u}),o&&(m.hidden=!g),g&&dt([t],!0),h.done(function(){for(i in g||dt([t]),Y.remove(t,"fxshow"),p)A.style(t,i,p[i])})),l=ue(g?m[i]:0,i,h),i in m||(m[i]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?ce.prefilters.unshift(t):ce.prefilters.push(t)}}),A.speed=function(t,e,n){var i=t&&"object"==typeof t?A.extend({},t):{complete:n||!n&&e||y(t)&&t,duration:t,easing:n&&e||e&&!y(e)&&e};return A.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in A.fx.speeds?i.duration=A.fx.speeds[i.duration]:i.duration=A.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){y(i.old)&&i.old.call(this),i.queue&&A.dequeue(this,i.queue)},i},A.fn.extend({fadeTo:function(t,e,n,i){return this.filter(st).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=A.isEmptyObject(t),o=A.speed(e,n,i),s=function(){var e=ce(this,A.extend({},t),o);(r||Y.get(this,"finish"))&&e.stop(!0)};return s.finish=s,r||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=A.timers,s=Y.get(this);if(r)s[r]&&s[r].stop&&i(s[r]);else for(r in s)s[r]&&s[r].stop&&oe.test(r)&&i(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(n),e=!1,o.splice(r,1));!e&&n||A.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,n=Y.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=A.timers,s=i?i.length:0;for(n.finish=!0,A.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),A.each(["toggle","show","hide"],function(t,e){var n=A.fn[e];A.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(le(e,!0),t,i,r)}}),A.each({slideDown:le("show"),slideUp:le("hide"),slideToggle:le("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){A.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),A.timers=[],A.fx.tick=function(){var t,e=0,n=A.timers;for(ne=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||A.fx.stop(),ne=void 0},A.fx.timer=function(t){A.timers.push(t),A.fx.start()},A.fx.interval=13,A.fx.start=function(){ie||(ie=!0,se())},A.fx.stop=function(){ie=null},A.fx.speeds={slow:600,fast:200,_default:400},A.fn.delay=function(t,e){return t=A.fx&&A.fx.speeds[t]||t,e=e||"fx",this.queue(e,function(e,i){var r=n.setTimeout(e,t);i.stop=function(){n.clearTimeout(r)}})},function(){var t=s.createElement("input"),e=s.createElement("select").appendChild(s.createElement("option"));t.type="checkbox",v.checkOn=""!==t.value,v.optSelected=e.selected,(t=s.createElement("input")).value="t",t.type="radio",v.radioValue="t"===t.value}();var de,he=A.expr.attrHandle;A.fn.extend({attr:function(t,e){return U(this,A.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){A.removeAttr(this,t)})}}),A.extend({attr:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?A.prop(t,e,n):(1===o&&A.isXMLDoc(t)||(r=A.attrHooks[e.toLowerCase()]||(A.expr.match.bool.test(e)?de:void 0)),void 0!==n?null===n?void A.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:null==(i=A.find.attr(t,e))?void 0:i)},attrHooks:{type:{set:function(t,e){if(!v.radioValue&&"radio"===e&&O(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i=0,r=e&&e.match(L);if(r&&1===t.nodeType)for(;n=r[i++];)t.removeAttribute(n)}}),de={set:function(t,e,n){return!1===e?A.removeAttr(t,n):t.setAttribute(n,n),n}},A.each(A.expr.match.bool.source.match(/\w+/g),function(t,e){var n=he[e]||A.find.attr;he[e]=function(t,e,i){var r,o,s=e.toLowerCase();return i||(o=he[s],he[s]=r,r=null!=n(t,e,i)?s:null,he[s]=o),r}});var pe=/^(?:input|select|textarea|button)$/i,fe=/^(?:a|area)$/i;function ge(t){return(t.match(L)||[]).join(" ")}function me(t){return t.getAttribute&&t.getAttribute("class")||""}function ve(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(L)||[]}A.fn.extend({prop:function(t,e){return U(this,A.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[A.propFix[t]||t]})}}),A.extend({prop:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&A.isXMLDoc(t)||(e=A.propFix[e]||e,r=A.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=A.find.attr(t,"tabindex");return e?parseInt(e,10):pe.test(t.nodeName)||fe.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),v.optSelected||(A.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),A.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){A.propFix[this.toLowerCase()]=this}),A.fn.extend({addClass:function(t){var e,n,i,r,o,s,a,l=0;if(y(t))return this.each(function(e){A(this).addClass(t.call(this,e,me(this)))});if((e=ve(t)).length)for(;n=this[l++];)if(r=me(n),i=1===n.nodeType&&" "+ge(r)+" "){for(s=0;o=e[s++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");r!==(a=ge(i))&&n.setAttribute("class",a)}return this},removeClass:function(t){var e,n,i,r,o,s,a,l=0;if(y(t))return this.each(function(e){A(this).removeClass(t.call(this,e,me(this)))});if(!arguments.length)return this.attr("class","");if((e=ve(t)).length)for(;n=this[l++];)if(r=me(n),i=1===n.nodeType&&" "+ge(r)+" "){for(s=0;o=e[s++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");r!==(a=ge(i))&&n.setAttribute("class",a)}return this},toggleClass:function(t,e){var n=typeof t,i="string"===n||Array.isArray(t);return"boolean"==typeof e&&i?e?this.addClass(t):this.removeClass(t):y(t)?this.each(function(n){A(this).toggleClass(t.call(this,n,me(this),e),e)}):this.each(function(){var e,r,o,s;if(i)for(r=0,o=A(this),s=ve(t);e=s[r++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else void 0!==t&&"boolean"!==n||((e=me(this))&&Y.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Y.get(this,"__className__")||""))})},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+ge(me(n))+" ").indexOf(e)>-1)return!0;return!1}});var ye=/\r/g;A.fn.extend({val:function(t){var e,n,i,r=this[0];return arguments.length?(i=y(t),this.each(function(n){var r;1===this.nodeType&&(null==(r=i?t.call(this,n,A(this).val()):t)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=A.map(r,function(t){return null==t?"":t+""})),(e=A.valHooks[this.type]||A.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))})):r?(e=A.valHooks[r.type]||A.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(ye,""):null==n?"":n:void 0}}),A.extend({valHooks:{option:{get:function(t){var e=A.find.attr(t,"value");return null!=e?e:ge(A.text(t))}},select:{get:function(t){var e,n,i,r=t.options,o=t.selectedIndex,s="select-one"===t.type,a=s?null:[],l=s?o+1:r.length;for(i=o<0?l:s?o:0;i<l;i++)if(((n=r[i]).selected||i===o)&&!n.disabled&&(!n.parentNode.disabled||!O(n.parentNode,"optgroup"))){if(e=A(n).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var n,i,r=t.options,o=A.makeArray(e),s=r.length;s--;)((i=r[s]).selected=A.inArray(A.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),A.each(["radio","checkbox"],function(){A.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=A.inArray(A(t).val(),e)>-1}},v.checkOn||(A.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),v.focusin="onfocusin"in n;var be=/^(?:focusinfocus|focusoutblur)$/,_e=function(t){t.stopPropagation()};A.extend(A.event,{trigger:function(t,e,i,r){var o,a,l,u,c,d,h,p,g=[i||s],m=f.call(t,"type")?t.type:t,v=f.call(t,"namespace")?t.namespace.split("."):[];if(a=p=l=i=i||s,3!==i.nodeType&&8!==i.nodeType&&!be.test(m+A.event.triggered)&&(m.indexOf(".")>-1&&(m=(v=m.split(".")).shift(),v.sort()),c=m.indexOf(":")<0&&"on"+m,(t=t[A.expando]?t:new A.Event(m,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=v.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:A.makeArray(e,[t]),h=A.event.special[m]||{},r||!h.trigger||!1!==h.trigger.apply(i,e))){if(!r&&!h.noBubble&&!b(i)){for(u=h.delegateType||m,be.test(u+m)||(a=a.parentNode);a;a=a.parentNode)g.push(a),l=a;l===(i.ownerDocument||s)&&g.push(l.defaultView||l.parentWindow||n)}for(o=0;(a=g[o++])&&!t.isPropagationStopped();)p=a,t.type=o>1?u:h.bindType||m,(d=(Y.get(a,"events")||{})[t.type]&&Y.get(a,"handle"))&&d.apply(a,e),(d=c&&a[c])&&d.apply&&J(a)&&(t.result=d.apply(a,e),!1===t.result&&t.preventDefault());return t.type=m,r||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(g.pop(),e)||!J(i)||c&&y(i[m])&&!b(i)&&((l=i[c])&&(i[c]=null),A.event.triggered=m,t.isPropagationStopped()&&p.addEventListener(m,_e),i[m](),t.isPropagationStopped()&&p.removeEventListener(m,_e),A.event.triggered=void 0,l&&(i[c]=l)),t.result}},simulate:function(t,e,n){var i=A.extend(new A.Event,n,{type:t,isSimulated:!0});A.event.trigger(i,null,e)}}),A.fn.extend({trigger:function(t,e){return this.each(function(){A.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];if(n)return A.event.trigger(t,e,n,!0)}}),v.focusin||A.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){A.event.simulate(e,t.target,A.event.fix(t))};A.event.special[e]={setup:function(){var i=this.ownerDocument||this,r=Y.access(i,e);r||i.addEventListener(t,n,!0),Y.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=Y.access(i,e)-1;r?Y.access(i,e,r):(i.removeEventListener(t,n,!0),Y.remove(i,e))}}});var xe=n.location,we=Date.now(),Ae=/\?/;A.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new n.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||A.error("Invalid XML: "+t),e};var ke=/\[\]$/,Te=/\r?\n/g,Se=/^(?:submit|button|image|reset|file)$/i,Me=/^(?:input|select|textarea|keygen)/i;function Ee(t,e,n,i){var r;if(Array.isArray(e))A.each(e,function(e,r){n||ke.test(t)?i(t,r):Ee(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,n,i)});else if(n||"object"!==w(e))i(t,e);else for(r in e)Ee(t+"["+r+"]",e[r],n,i)}A.param=function(t,e){var n,i=[],r=function(t,e){var n=y(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(t)||t.jquery&&!A.isPlainObject(t))A.each(t,function(){r(this.name,this.value)});else for(n in t)Ee(n,t[n],e,r);return i.join("&")},A.fn.extend({serialize:function(){return A.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=A.prop(this,"elements");return t?A.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!A(this).is(":disabled")&&Me.test(this.nodeName)&&!Se.test(t)&&(this.checked||!ht.test(t))}).map(function(t,e){var n=A(this).val();return null==n?null:Array.isArray(n)?A.map(n,function(t){return{name:e.name,value:t.replace(Te,"\r\n")}}):{name:e.name,value:n.replace(Te,"\r\n")}}).get()}});var Ne=/%20/g,Oe=/#.*$/,qe=/([?&])_=[^&]*/,Ce=/^(.*?):[ \t]*([^\r\n]*)$/gm,Pe=/^(?:GET|HEAD)$/,je=/^\/\//,De={},Ie={},Fe="*/".concat("*"),Le=s.createElement("a");function ze(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(L)||[];if(y(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function Re(t,e,n,i){var r={},o=t===Ie;function s(a){var l;return r[a]=!0,A.each(t[a]||[],function(t,a){var u=a(e,n,i);return"string"!=typeof u||o||r[u]?o?!(l=u):void 0:(e.dataTypes.unshift(u),s(u),!1)}),l}return s(e.dataTypes[0])||!r["*"]&&s("*")}function Be(t,e){var n,i,r=A.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&A.extend(!0,t,i),t}Le.href=xe.href,A.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:xe.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(xe.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Fe,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":A.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Be(Be(t,A.ajaxSettings),e):Be(A.ajaxSettings,t)},ajaxPrefilter:ze(De),ajaxTransport:ze(Ie),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,r,o,a,l,u,c,d,h,p,f=A.ajaxSetup({},e),g=f.context||f,m=f.context&&(g.nodeType||g.jquery)?A(g):A.event,v=A.Deferred(),y=A.Callbacks("once memory"),b=f.statusCode||{},_={},x={},w="canceled",k={readyState:0,getResponseHeader:function(t){var e;if(c){if(!a)for(a={};e=Ce.exec(o);)a[e[1].toLowerCase()]=e[2];e=a[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return c?o:null},setRequestHeader:function(t,e){return null==c&&(t=x[t.toLowerCase()]=x[t.toLowerCase()]||t,_[t]=e),this},overrideMimeType:function(t){return null==c&&(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)k.always(t[k.status]);else for(e in t)b[e]=[b[e],t[e]];return this},abort:function(t){var e=t||w;return i&&i.abort(e),T(0,e),this}};if(v.promise(k),f.url=((t||f.url||xe.href)+"").replace(je,xe.protocol+"//"),f.type=e.method||e.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(L)||[""],null==f.crossDomain){u=s.createElement("a");try{u.href=f.url,u.href=u.href,f.crossDomain=Le.protocol+"//"+Le.host!=u.protocol+"//"+u.host}catch(t){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=A.param(f.data,f.traditional)),Re(De,f,e,k),c)return k;for(h in(d=A.event&&f.global)&&0==A.active++&&A.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Pe.test(f.type),r=f.url.replace(Oe,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Ne,"+")):(p=f.url.slice(r.length),f.data&&(f.processData||"string"==typeof f.data)&&(r+=(Ae.test(r)?"&":"?")+f.data,delete f.data),!1===f.cache&&(r=r.replace(qe,"$1"),p=(Ae.test(r)?"&":"?")+"_="+we+++p),f.url=r+p),f.ifModified&&(A.lastModified[r]&&k.setRequestHeader("If-Modified-Since",A.lastModified[r]),A.etag[r]&&k.setRequestHeader("If-None-Match",A.etag[r])),(f.data&&f.hasContent&&!1!==f.contentType||e.contentType)&&k.setRequestHeader("Content-Type",f.contentType),k.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Fe+"; q=0.01":""):f.accepts["*"]),f.headers)k.setRequestHeader(h,f.headers[h]);if(f.beforeSend&&(!1===f.beforeSend.call(g,k,f)||c))return k.abort();if(w="abort",y.add(f.complete),k.done(f.success),k.fail(f.error),i=Re(Ie,f,e,k)){if(k.readyState=1,d&&m.trigger("ajaxSend",[k,f]),c)return k;f.async&&f.timeout>0&&(l=n.setTimeout(function(){k.abort("timeout")},f.timeout));try{c=!1,i.send(_,T)}catch(t){if(c)throw t;T(-1,t)}}else T(-1,"No Transport");function T(t,e,s,a){var u,h,p,_,x,w=e;c||(c=!0,l&&n.clearTimeout(l),i=void 0,o=a||"",k.readyState=t>0?4:0,u=t>=200&&t<300||304===t,s&&(_=function(t,e,n){for(var i,r,o,s,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||t.converters[r+" "+l[0]]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==l[0]&&l.unshift(o),n[o]}(f,k,s)),_=function(t,e,n,i){var r,o,s,a,l,u={},c=t.dataTypes.slice();if(c[1])for(s in t.converters)u[s.toLowerCase()]=t.converters[s];for(o=c.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(s=u[l+" "+o]||u["* "+o]))for(r in u)if((a=r.split(" "))[1]===o&&(s=u[l+" "+a[0]]||u["* "+a[0]])){!0===s?s=u[r]:!0!==u[r]&&(o=a[0],c.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}(f,_,k,u),u?(f.ifModified&&((x=k.getResponseHeader("Last-Modified"))&&(A.lastModified[r]=x),(x=k.getResponseHeader("etag"))&&(A.etag[r]=x)),204===t||"HEAD"===f.type?w="nocontent":304===t?w="notmodified":(w=_.state,h=_.data,u=!(p=_.error))):(p=w,!t&&w||(w="error",t<0&&(t=0))),k.status=t,k.statusText=(e||w)+"",u?v.resolveWith(g,[h,w,k]):v.rejectWith(g,[k,w,p]),k.statusCode(b),b=void 0,d&&m.trigger(u?"ajaxSuccess":"ajaxError",[k,f,u?h:p]),y.fireWith(g,[k,w]),d&&(m.trigger("ajaxComplete",[k,f]),--A.active||A.event.trigger("ajaxStop")))}return k},getJSON:function(t,e,n){return A.get(t,e,n,"json")},getScript:function(t,e){return A.get(t,void 0,e,"script")}}),A.each(["get","post"],function(t,e){A[e]=function(t,n,i,r){return y(n)&&(r=r||i,i=n,n=void 0),A.ajax(A.extend({url:t,type:e,dataType:r,data:n,success:i},A.isPlainObject(t)&&t))}}),A._evalUrl=function(t){return A.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},A.fn.extend({wrapAll:function(t){var e;return this[0]&&(y(t)&&(t=t.call(this[0])),e=A(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return y(t)?this.each(function(e){A(this).wrapInner(t.call(this,e))}):this.each(function(){var e=A(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=y(t);return this.each(function(n){A(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){A(this).replaceWith(this.childNodes)}),this}}),A.expr.pseudos.hidden=function(t){return!A.expr.pseudos.visible(t)},A.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},A.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(t){}};var He={0:200,1223:204},Ge=A.ajaxSettings.xhr();v.cors=!!Ge&&"withCredentials"in Ge,v.ajax=Ge=!!Ge,A.ajaxTransport(function(t){var e,i;if(v.cors||Ge&&!t.crossDomain)return{send:function(r,o){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];for(s in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)a.setRequestHeader(s,r[s]);e=function(t){return function(){e&&(e=i=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(He[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=e(),i=a.onerror=a.ontimeout=e("error"),void 0!==a.onabort?a.onabort=i:a.onreadystatechange=function(){4===a.readyState&&n.setTimeout(function(){e&&i()})},e=e("abort");try{a.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}}),A.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),A.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return A.globalEval(t),t}}}),A.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),A.ajaxTransport("script",function(t){var e,n;if(t.crossDomain)return{send:function(i,r){e=A("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),s.head.appendChild(e[0])},abort:function(){n&&n()}}});var Ve,Ue=[],We=/(=)\?(?=&|$)|\?\?/;A.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ue.pop()||A.expando+"_"+we++;return this[t]=!0,t}}),A.ajaxPrefilter("json jsonp",function(t,e,i){var r,o,s,a=!1!==t.jsonp&&(We.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&We.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=y(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(We,"$1"+r):!1!==t.jsonp&&(t.url+=(Ae.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return s||A.error(r+" was not called"),s[0]},t.dataTypes[0]="json",o=n[r],n[r]=function(){s=arguments},i.always(function(){void 0===o?A(n).removeProp(r):n[r]=o,t[r]&&(t.jsonpCallback=e.jsonpCallback,Ue.push(r)),s&&y(o)&&o(s[0]),s=o=void 0}),"script"}),v.createHTMLDocument=((Ve=s.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ve.childNodes.length),A.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(v.createHTMLDocument?((i=(e=s.implementation.createHTMLDocument("")).createElement("base")).href=s.location.href,e.head.appendChild(i)):e=s),r=q.exec(t),o=!n&&[],r?[e.createElement(r[1])]:(r=xt([t],e,o),o&&o.length&&A(o).remove(),A.merge([],r.childNodes)));var i,r,o},A.fn.load=function(t,e,n){var i,r,o,s=this,a=t.indexOf(" ");return a>-1&&(i=ge(t.slice(a)),t=t.slice(0,a)),y(e)?(n=e,e=void 0):e&&"object"==typeof e&&(r="POST"),s.length>0&&A.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){o=arguments,s.html(i?A("<div>").append(A.parseHTML(t)).find(i):t)}).always(n&&function(t,e){s.each(function(){n.apply(this,o||[t.responseText,e,t])})}),this},A.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){A.fn[e]=function(t){return this.on(e,t)}}),A.expr.pseudos.animated=function(t){return A.grep(A.timers,function(e){return t===e.elem}).length},A.offset={setOffset:function(t,e,n){var i,r,o,s,a,l,u=A.css(t,"position"),c=A(t),d={};"static"===u&&(t.style.position="relative"),a=c.offset(),o=A.css(t,"top"),l=A.css(t,"left"),("absolute"===u||"fixed"===u)&&(o+l).indexOf("auto")>-1?(s=(i=c.position()).top,r=i.left):(s=parseFloat(o)||0,r=parseFloat(l)||0),y(e)&&(e=e.call(t,n,A.extend({},a))),null!=e.top&&(d.top=e.top-a.top+s),null!=e.left&&(d.left=e.left-a.left+r),"using"in e?e.using.call(t,d):c.css(d)}},A.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){A.offset.setOffset(this,t,e)});var e,n,i=this[0];return i?i.getClientRects().length?(e=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,i=this[0],r={top:0,left:0};if("fixed"===A.css(i,"position"))e=i.getBoundingClientRect();else{for(e=this.offset(),n=i.ownerDocument,t=i.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===A.css(t,"position");)t=t.parentNode;t&&t!==i&&1===t.nodeType&&((r=A(t).offset()).top+=A.css(t,"borderTopWidth",!0),r.left+=A.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-A.css(i,"marginTop",!0),left:e.left-r.left-A.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===A.css(t,"position");)t=t.offsetParent;return t||wt})}}),A.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n="pageYOffset"===e;A.fn[t]=function(i){return U(this,function(t,i,r){var o;if(b(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===r)return o?o[e]:t[i];o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):t[i]=r},t,i,arguments.length)}}),A.each(["top","left"],function(t,e){A.cssHooks[e]=Vt(v.pixelPosition,function(t,n){if(n)return n=Gt(t,e),Rt.test(n)?A(t).position()[e]+"px":n})}),A.each({Height:"height",Width:"width"},function(t,e){A.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,i){A.fn[i]=function(r,o){var s=arguments.length&&(n||"boolean"!=typeof r),a=n||(!0===r||!0===o?"margin":"border");return U(this,function(e,n,r){var o;return b(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===r?A.css(e,n,a):A.style(e,n,r,a)},e,s?r:void 0,s)}})}),A.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){A.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),A.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),A.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}}),A.proxy=function(t,e){var n,i,r;if("string"==typeof e&&(n=t[e],e=t,t=n),y(t))return i=l.call(arguments,2),(r=function(){return t.apply(e||this,i.concat(l.call(arguments)))}).guid=t.guid=t.guid||A.guid++,r},A.holdReady=function(t){t?A.readyWait++:A.ready(!0)},A.isArray=Array.isArray,A.parseJSON=JSON.parse,A.nodeName=O,A.isFunction=y,A.isWindow=b,A.camelCase=K,A.type=w,A.now=Date.now,A.isNumeric=function(t){var e=A.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},void 0===(i=function(){return A}.apply(e,[]))||(t.exports=i);var Qe=n.jQuery,$e=n.$;return A.noConflict=function(t){return n.$===A&&(n.$=$e),t&&n.jQuery===A&&(n.jQuery=Qe),A},r||(n.jQuery=n.$=A),A})},function(t,e,n){window.jQuery=n(180),n(179),n(178),t.exports=window.MathQuill},function(t,e,n){"use strict";(function(t,e){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=n(0);n(181);var o,s,a=n(20);r.gmath.ui=r.gmath.ui||{},r.gmath.ui.Keyboard=(o=null,s=function(){return function(){var n,o,s,l,u,c,d,h,p,f,g,m,v=t.dispatch("done","cancel","change"),y="",b=!1,_=null,x=null,w=null,A=null,k=900,T=!1,S="center",M=null,E=MathQuill.getInterface(2),N=[],O="num",q=!1,C={spaceBehavesLikeTab:!0,restrictMismatchedBrackets:!0,autoOperatorNames:a.Func.preprogrammedFunctions.join(" ")},P=function(){return f=r.gmath.mtouch_events().on("touch",R).on("release",G).on("drag",j).on("hold",U).hold_time(500),I(),B(O),""!=y&&m.write(y),this};function j(e){if(e.alts){var n=t.event.finger.dist_x,i=t.event.finger.dist_y;if(!(n*n+i*i<36)){var r,o,s=[];t.select("#"+e.id+"-content").selectAll("div").each(function(e){var n=t.mouse(this),i=n[0]-l/2,r=n[1]-u/2;s.push({el:this,dist:Math.sqrt(i*i+r*r)})}),0!==s.length&&(s.sort(function(t,e){return t.dist-e.dist}),r=s[0].el,o=s[0].dist<100,t.select(r.parentNode).selectAll("div").each(function(e){t.select(this).style("background",this===r&&o?"silver":"none")}),g=o?t.select(r).datum():null)}}}function D(t){"change"===t&&!1!==q&&P.caption(q),v[t](m.latex())}P.layout=function(t){return 0==arguments.length?O:(O=t,_&&B(O),this)},P.extra_keys=function(t){return 0==arguments.length?N:(N=t,_&&B(O),this)},P.width=function(t){return 0==arguments.length?k:(k=t,_&&L(),this)},P.height=function(){return s},P.container=function(){return _?_.node():null},P.latex=function(t){return 0==arguments.length?(n&&(y=m.latex()),y):(y=t,n&&m.latex(t),this)},P.visible=function(t){return 0==arguments.length?b:b==t?this:(b=t,_?(b?(_.style("display","block"),m.latex(m.latex()),m.focus(),P.scale_to_fit(),"simple"===O&&B("simple")):(_.style("display","none"),q=!1,P.on("done",null),P.on("change",null),P.on("cancel",null),N=[]),this):this)},P.abort=function(){b&&(D("cancel"),P.visible(!1))},P.scale_to_fit=function(){if(_){var t=document.body.getBoundingClientRect().width;if(t<k){var e=t/k;_.style("transform","scale("+e+")").style("-webkit-transform","scale("+e+")").style("transform-origin",S+" bottom").style("-webkit-transform-origin",S+" bottom")}else _.style("transform",null).style("-webkit-transform",null)}},P.position=function(t){return 0==arguments.length?S:S==t?this:(S=t,_?(_.call(K,S),this):this)},P.caption=function(t,e){return 0===arguments.length?M:(M=t,w?(M?(A.text(t),w.style("display",null)):w.style("display","none"),A.style("color",e||null),this):this)},P.warning=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return P.caption(t,"darkorange"),q=e,P},P.selectAll=function(){m.select()},P.moveToRightEnd=function(){return m.moveToRightEnd()},P.keystroke=function(t){return m.keystroke(t)},P.remove=function(){_&&_.remove()};var I=function(){t.select("#gm-keyboard").remove(),(_=t.select("body").append("div").attr("id","gm-keyboard").style({position:"fixed",bottom:0,"z-index":1e4}).style("display",b?"block":"none")).classed("gm-styles",!0),w=_.append("div").attr("id","caption"),A=w.append("span").text(M),w.append("span").text("x").style({position:"absolute",right:"5px",top:"-3px",color:"silver",cursor:"pointer"}).on("click",function(){P.caption(!1)}),x=_.append("div").classed("keyboard",!0),n=x.append("div").attr("id","formula").append("div").attr("id","mq_div").append("span").attr("id","mq_span"),m=E.MathField(n.node(),C),o=e(n.node()).find("textarea"),b&&m.focus(),t.select(o[0]).on("keyup",function(){13===t.event.keyCode?D("done"):27===t.event.keyCode?D("cancel"):setTimeout(function(){D("change")},1)}),z()},F=function(){var n;x.selectAll(".key").remove(),x.select("#formula").datum(d.formula),(n=x.selectAll(".key").data(d).enter().append("div").classed("key",!0).call(f)).filter(function(t){return"backspace"==t.type}).classed("backspace-key",!0).append("svg").classed("key-icon-svg",!0).append("path"),n.filter(function(t){return"arrow"==t.type}).classed("arrow-key",!0).append("svg").classed("key-icon-svg",!0).append("path"),n.filter(function(t){return t.name}).classed("normal-key",!0).append("span").classed("keylabel",!0).style("font-style",function(t){return t.italic?"italic":null}),n.filter(function(t){return t.alts}).append("span").classed("dots",!0),t.select("html").on("click.gm-keyboard",function(){var n=t.event;e("[data-original-title]").each(function(){e(this).is(n.target)||0!==e(this).has(n.target).length||0!==e(".popover").has(n.target).length||e(this).popover("hide")})}),n.filter(function(t){return t.alts}).attr("id",function(t){return t.id}).each(function(n){n.alts=n.alts.map(function(t){return"object"!==(void 0===t?"undefined":i(t))&&(t={name:t}),t.parent_key=n,t}),e(this).popover({html:!0,content:function(){return"<div id="+n.id+"-content"+(t=n.alts.length,' style="width:'+l*t+"px; height: "+u+'px" ')+"></div>";var t},title:function(){return null},sanitize:!1,trigger:"manual",placement:"top"}),e(this).on("show.bs.popover",function(){e(this).data("bs.popover").tip().css({maxWidth:"none"}).css({borderRadius:0}),t.select(this).datum().popover_visible=!0}),e(this).on("hide.bs.popover",function(){t.select(this).datum().popover_visible=!1}),e(this).on("shown.bs.popover",function(){t.select("#"+n.id+"-content").selectAll("div").data(n.alts).enter().append("div").classed("alt-key",!0).call($,!0).style({width:l+"px",height:u+"px"}).style("display","inline-table").on("click",function(t){e(this).popover("hide"),V(t)}.bind(this)).append("span").text(function(t){return t.name||t}).style("display","table-cell").style("vertical-align","middle").style("text-align","center")})})},L=function(){!function(){var t=[],e=[];d.forEach(function(n){e.push(n.row),t.push(n.col)}),h=Math.max.apply(null,t);var n=((p=Math.max.apply(null,e))+1)*(u=100)+(c=10)+c*(p-1)+2*c+2*c,i=k/((h+1)*(l=130)+h*c+2*c+2*c);l*=i,u*=i,c*=i,s=n*i+1}(),_.call(K,S),x.style("height",s+"px").style("width",k+"px").style({bottom:0,background:"#DDD",padding:0,"text-align":"center",border:"1px solid silver","border-radius":1.5*c+"px "+1.5*c+"px 0 0","border-bottom":"none"}).select("#formula").style("border",c+"px solid #DDD").style("border-radius",c+"px").call(W,c).select("#mq_div").style("border-radius",c+"px").style("width",function(t){return(t.cols||1)*l+((t.cols||1)-1)*c+"px"}).call($).select("#mq_span").style("box-shadow","none").style("-webkit-box-shadow","none").style("-moz-box-shadow","none").style("margin-top",c).style("font-size",u/2+u/10+"px").style("padding-top",3*c-2+"px").style("padding-bottom",2*c+"px").style("border","none").style("min-height",function(t){return(t.rows||1)*u+((t.rows||1)-1)*c-5*c+"px"}).style("width","100%"),x.selectAll(".key").call(W).call(Q).call($),x.selectAll(".backspace-key path").attr("d","m -5.708,-15.7 20.344,0 c 3.669696,0 6.624,2.954304 6.624,6.624 l 0,17.752 c 0,3.669696 -2.954304,6.624 -6.624,6.624 l -20.488,0 -15.408,-15.48 zM -2.18,-6.948 11.716,6.948M -2.18,6.948 11.716,-6.948").style("stroke","black").style("stroke-width","1.2").style("fill","none").attr("transform","translate("+l/2+","+u/2+")scale("+.12*c+")"),x.selectAll(".key-icon-svg").style("width","100%").style("height","100%"),x.selectAll(".arrow-key path").attr("d","M 13.7,16.5 -13.7,16.5 0,-16.5 z").style("stroke","black").style("stroke-linejoin","round").style("stroke-width",3).style("fill","none").attr("transform",function(t){var e={Left:-90,Up:0,Right:90,Down:180}[t.dir];return"translate("+l/2+","+u/2+")scale("+.06*c+")rotate("+e+")"}),x.selectAll(".normal-key span.keylabel").text(function(t){return t.name}).style("display","table-cell").style("vertical-align","middle").style("padding-top",function(t){return t.dy||0}).filter(function(t){return t.html}).html(function(t){return t.html}).filter(function(t){return t.two_lines}).style({"font-size":"0.7em","line-height":"1.2em"}),x.selectAll(".normal-key span.dots").text("…").style({position:"absolute",bottom:"2px",right:"5px","font-size":"0.6em","font-family":'"Helvetica Neue", Arial, Helvetica, sans-serif',"font-weight":400,color:"silver"}),w.style({position:"relative",background:"rgb(244, 244, 244)",padding:"12px","padding-bottom":"8px",border:"1px solid silver","border-radius":"7.6px 7.6px 0 0","border-bottom":"none",width:4*l+3*c+"px","margin-left":8*l+10*c+"px","font-family":"HelveticaNeue-Light",color:"#666","font-size":"17px","text-align":"center",display:M?null:"none"})},z=function(){/iPhone|iPod|iPad|Android|BlackBerry/.test(navigator.userAgent)&&t.select(o[0]).attr("readonly",!0)},R=function(n){e("[data-original-title]").each(function(){e(this).popover("hide")}),t.select(this).style("background","gray"),"formula"!==n.type&&(m.focus(),"load_layout"===n.type?B(n.layout,n.reverse):"shift"===n.type?H(n):"key"!==n.type||n.alts?"backspace"===n.type?(m.keystroke("Backspace"),D("change")):"event"===n.type?D(n.event):"arrow"===n.type&&(m.keystroke(n.dir),D("change")):V(n))},B=function(t,e){T=!1,"greek"===t?((d=[]).keyboard="greek",d.formula={type:"formula",col:2,row:0,cols:6},d.push({name:"Cancel",type:"event",event:"cancel",col:0,row:0,cols:2}),d.push({type:"backspace",col:8,row:0}),d.push({name:"Done",type:"event",event:"done",col:9,row:0,cols:2}),d.push({name:"1",type:"key",col:0,row:1}),d.push({name:"2",type:"key",col:1,row:1}),d.push({name:"3",type:"key",col:2,row:1}),d.push({name:"4",type:"key",col:3,row:1}),d.push({name:"5",type:"key",col:4,row:1}),d.push({name:"6",type:"key",col:5,row:1}),d.push({name:"7",type:"key",col:6,row:1}),d.push({name:"8",type:"key",col:7,row:1}),d.push({name:"9",type:"key",col:8,row:1}),d.push({name:"0",type:"key",col:9,row:1}),d.push({name:"σ",type:"key",col:1,row:2}),d.push({name:"ε",type:"key",col:2,row:2}),d.push({name:"ρ",type:"key",col:3,row:2}),d.push({name:"τ",type:"key",col:4,row:2}),d.push({name:"υ",type:"key",col:5,row:2}),d.push({name:"θ",type:"key",col:6,row:2}),d.push({name:"ι",type:"key",col:7,row:2}),d.push({name:"ο",type:"key",col:8,row:2}),d.push({name:"π",type:"key",col:9,row:2}),d.push({name:"α",type:"key",col:.3,row:3}),d.push({name:"σ",type:"key",col:1.3,row:3}),d.push({name:"δ",type:"key",col:2.3,row:3}),d.push({name:"φ",type:"key",col:3.3,row:3}),d.push({name:"γ",type:"key",col:4.3,row:3}),d.push({name:"η",type:"key",col:5.3,row:3}),d.push({name:"ξ",type:"key",col:6.3,row:3}),d.push({name:"κ",type:"key",col:7.3,row:3}),d.push({name:"λ",type:"key",col:8.3,row:3}),d.push({name:"ζ",type:"key",col:.6,row:4}),d.push({name:"χ",type:"key",col:1.6,row:4}),d.push({name:"ψ",type:"key",col:2.6,row:4}),d.push({name:"ω",type:"key",col:3.6,row:4}),d.push({name:"β",type:"key",col:4.6,row:4}),d.push({name:"ν",type:"key",col:5.6,row:4}),d.push({name:"μ",type:"key",col:6.6,row:4}),d.push({name:"text",html:"long<br>var",two_lines:!0,cmd:"$",type:"key",col:7.6,row:4}),d.push({name:"123",layout:"num",type:"load_layout",col:11,row:0}),d.push({name:"÷",type:"key",val:"/",col:10,row:1}),d.push({name:"*",type:"key",val:"*",col:11,row:1,dy:"0.3em"}),d.push({name:"−",type:"key",val:"-",col:10,row:2}),d.push({name:"+",alts:["+","±"],type:"key",col:11,row:2,id:"plus-key"}),d.push({name:"(",type:"key",col:9.8,cols:.6,row:3}),d.push({name:")",type:"key",col:10.4,cols:.6,row:3}),d.push({name:"=",alts:["<",">","=","≤","≥"],type:"key",col:11,row:3,id:"equal-key"}),d.push({name:"_",html:"x<sub>n</sub>",type:"key",col:9,row:4}),d.push({name:"^n ",val:"^",html:"a<sup>n</sup>",dy:"0.1em",type:"key",col:10,row:4}),d.push({name:"√",alts:["√",{name:"ⁿ√",cmd:"\\nthroot"}],type:"key",col:11,row:4,id:"root-key"}),d.push({name:"⇧",type:"shift",col:0,row:4,cols:.6})):"num"===t?((d=[]).keyboard="num",d.formula={type:"formula",col:2,row:0,cols:6},d.push({name:"Cancel",type:"event",event:"cancel",col:0,row:0,cols:2}),d.push({type:"backspace",col:8,row:0}),d.push({name:"Done",type:"event",event:"done",col:9,row:0,cols:2}),d.push({name:"7",type:"key",col:0,row:1}),d.push({name:"8",type:"key",col:1,row:1}),d.push({name:"9",type:"key",col:2,row:1}),d.push({name:"4",type:"key",col:0,row:2}),d.push({name:"5",type:"key",col:1,row:2}),d.push({name:"6",type:"key",col:2,row:2}),d.push({name:"1",type:"key",col:0,row:3}),d.push({name:"2",type:"key",col:1,row:3}),d.push({name:"3",type:"key",col:2,row:3}),d.push({name:"0",type:"key",col:0,row:4}),d.push({name:".",type:"key",col:1,row:4}),d.push({name:"=",alts:["<",">","=","≤","≥"],type:"key",col:2,row:4,id:"equal-key"}),d.push({name:"÷",type:"key",val:"/",col:3,row:1}),d.push({name:"*",type:"key",val:"*",col:3,row:2,dy:"0.5em"}),d.push({name:"−",type:"key",val:"-",col:3,row:3}),d.push({name:"+",alts:["+","±"],type:"key",col:3,row:4,id:"plus-key"}),d.push({name:"x",type:"key",col:4.5,row:1}),d.push({name:"y",type:"key",col:5.5,row:1}),d.push({name:"(",type:"key",col:4.5,cols:.66,row:2}),d.push({name:")",type:"key",col:5.16,cols:.66,row:2}),d.push({name:"|…|",cmd:"|",type:"key",col:5.82,cols:.66,row:2}),d.push({name:",",type:"key",col:4.5,row:3}),d.push({name:"_",html:"x<sub>n</sub>",type:"key",col:5.5,row:3}),d.push({name:"e",type:"key",col:4.5,row:4}),d.push({name:"i",type:"key",col:5.5,row:4}),d.push({name:"^2",val:"^2",tab:!0,html:"a<sup>2</sup>",dy:"0.2em",type:"key",col:7,row:1}),d.push({name:"^3",val:"^3",tab:!0,html:"a<sup>3</sup>",dy:"0.2em",type:"key",col:8,row:1}),d.push({name:"^n ",val:"^",html:"a<sup>n</sup>",dy:"0.2em",type:"key",col:9,row:1}),d.push({name:"√",type:"key",col:7,row:2}),d.push({name:"n√",cmd:"\\nthroot",html:"<sup>n</sup>√",dy:"0em",type:"key",col:8,row:2}),d.push({name:"log",type:"key",col:7,row:3}),d.push({name:"ln",type:"key",col:8,row:3}),d.push({name:"⬚",type:"key",col:7,row:4}),d.push({name:"text",html:"long<br>var",two_lines:!0,cmd:"$",type:"key",col:8,row:4}),d.push({name:"abc",layout:"alpha",type:"load_layout",col:11,row:0}),d.push({name:"αβγ",layout:"greek",type:"load_layout",col:11,row:1}),d.push({type:"arrow",dir:"Left",col:9,row:4,cols:1,rows:1}),d.push({type:"arrow",dir:"Up",col:10,row:3,cols:1,rows:1}),d.push({type:"arrow",dir:"Down",col:10,row:4,cols:1,rows:1}),d.push({type:"arrow",dir:"Right",col:11,row:4,cols:1,rows:1})):"alpha"===t?function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"num";(d=[]).keyboard="alpha",d.formula={type:"formula",col:2,row:0,cols:6},d.push({name:"Cancel",type:"event",event:"cancel",col:0,row:0,cols:2}),d.push({type:"backspace",col:8,row:0}),d.push({name:"Done",type:"event",event:"done",col:9,row:0,cols:2}),d.push({name:"1",type:"key",col:0,row:1}),d.push({name:"2",type:"key",col:1,row:1}),d.push({name:"3",type:"key",col:2,row:1}),d.push({name:"4",type:"key",col:3,row:1}),d.push({name:"5",type:"key",col:4,row:1}),d.push({name:"6",type:"key",col:5,row:1}),d.push({name:"7",type:"key",col:6,row:1}),d.push({name:"8",type:"key",col:7,row:1}),d.push({name:"9",type:"key",col:8,row:1}),d.push({name:"0",type:"key",col:9,row:1}),d.push({name:"q",type:"key",col:0,row:2}),d.push({name:"w",type:"key",col:1,row:2}),d.push({name:"e",type:"key",col:2,row:2}),d.push({name:"r",type:"key",col:3,row:2}),d.push({name:"t",type:"key",col:4,row:2}),d.push({name:"y",type:"key",col:5,row:2}),d.push({name:"u",type:"key",col:6,row:2}),d.push({name:"i",type:"key",col:7,row:2}),d.push({name:"o",type:"key",col:8,row:2}),d.push({name:"p",type:"key",col:9,row:2}),d.push({name:"a",type:"key",col:.3,row:3}),d.push({name:"s",type:"key",col:1.3,row:3}),d.push({name:"d",type:"key",col:2.3,row:3}),d.push({name:"f",type:"key",col:3.3,row:3}),d.push({name:"g",type:"key",col:4.3,row:3}),d.push({name:"h",type:"key",col:5.3,row:3}),d.push({name:"j",type:"key",col:6.3,row:3}),d.push({name:"k",type:"key",col:7.3,row:3}),d.push({name:"l",type:"key",col:8.3,row:3}),d.push({name:"z",type:"key",col:.6,row:4}),d.push({name:"x",type:"key",col:1.6,row:4}),d.push({name:"c",type:"key",col:2.6,row:4}),d.push({name:"v",type:"key",col:3.6,row:4}),d.push({name:"b",type:"key",col:4.6,row:4}),d.push({name:"n",type:"key",col:5.6,row:4}),d.push({name:"m",type:"key",col:6.6,row:4}),d.push({name:"text",html:"long<br>var",two_lines:!0,cmd:"$",type:"key",col:7.6,row:4}),d.push({name:"123",layout:t,type:"load_layout",col:11,row:0}),d.push({name:"÷",type:"key",val:"/",col:10,row:1}),d.push({name:"*",type:"key",val:"*",col:11,row:1,dy:"0.3em"}),d.push({name:"−",type:"key",val:"-",col:10,row:2}),d.push({name:"+",alts:["+","±"],type:"key",col:11,row:2,id:"plus-key"}),d.push({name:"(",type:"key",col:9.8,cols:.6,row:3}),d.push({name:")",type:"key",col:10.4,cols:.6,row:3}),d.push({name:"=",alts:["<",">","=","≤","≥"],type:"key",col:11,row:3,id:"equal-key"}),d.push({name:"_",html:"x<sub>n</sub>",type:"key",col:9,row:4}),d.push({name:"^n ",val:"^",html:"a<sup>n</sup>",dy:"0.1em",type:"key",col:10,row:4}),d.push({name:"√",alts:["√",{name:"ⁿ√",cmd:"\\nthroot"}],type:"key",col:11,row:4,id:"root-key"}),d.push({name:"⇧",type:"shift",col:0,row:4,cols:.6})}(e):"simple"===t&&((d=[]).keyboard="simple",d.formula={type:"formula",col:2,row:0,cols:6},d.push({name:"Cancel",type:"event",event:"cancel",col:0,row:0,cols:2}),d.push({type:"backspace",col:8,row:0}),d.push({name:"Done",type:"event",event:"done",col:9,row:0,cols:2}),d.push({name:"7",type:"key",col:0,row:1}),d.push({name:"8",type:"key",col:1,row:1}),d.push({name:"9",type:"key",col:2,row:1}),d.push({name:"4",type:"key",col:0,row:2}),d.push({name:"5",type:"key",col:1,row:2}),d.push({name:"6",type:"key",col:2,row:2}),d.push({name:"1",type:"key",col:0,row:3}),d.push({name:"2",type:"key",col:1,row:3}),d.push({name:"3",type:"key",col:2,row:3}),d.push({name:"=",type:"key",col:3,row:1}),d.push({name:".",type:"key",col:3,row:2}),d.push({name:"0",type:"key",col:3,row:3}),d.push({name:"+",type:"key",col:4.5,row:1}),d.push({name:"−",type:"key",val:"-",col:5.5,row:1}),d.push({name:"*",type:"key",col:4.5,row:2,dy:"0.5em"}),d.push({name:"÷",type:"key",val:"/",col:5.5,row:2}),d.push({name:"(",type:"key",col:4.5,row:3}),d.push({name:")",type:"key",col:5.5,row:3}),N&&N.forEach(function(t,e){e<6&&d.push({name:t,italic:!0,type:"key",col:e%2+7,row:1+Math.floor(e/2)})}),d.push({name:"abc",layout:"alpha",reverse:"simple",type:"load_layout",col:10,row:1}),d.push({type:"arrow",dir:"Left",col:9,row:3,cols:1,rows:1}),d.push({type:"arrow",dir:"Right",col:10,row:3,cols:1,rows:1})),F(),L()},H=function(t){T=!T,x.selectAll(".key span.keylabel").text(function(t){return"key"===t.type?T?t.name.toUpperCase():t.name.toLowerCase():t.name})},G=function(n){g?(e(this).popover("hide"),V(g)):"key"===n.type&&n.alts&&!n.popover_visible&&V(n),g=null,"shift"===n.type&&T||t.select(this).style("background","key"==n.type||"formula"==n.type?"white":"silver")};function V(t){if(t.cmd)m.cmd(t.cmd),m.focus();else{var e=t.val||t.name||t;T&&(e=e.toUpperCase()),m.typedText(e),t.tab&&m.keystroke("Tab")}D("change")}var U=function(t){("backspace"===t.type||t.alts)&&(t.alts&&(e("#"+t.id).popover("toggle"),t.popover_visible=!0),"backspace"===t.type&&(m.latex(""),m.focus()))},W=function(t,e){e=e||0,t.style("position","absolute").style("left",function(t){return t.col*(l+c)+2*c-e+"px"}).style("bottom",function(t){return(p-t.row)*(u+c)+(t.row,0)+2*c-e+"px"})},Q=function(t,e,n){e=e||0,n=n||0,t.style("width",function(t){return(t.cols||1)*l+((t.cols||1)-1)*c-2*e+"px"}).style("height",function(t){return(t.rows||1)*u+((t.rows||1)-1)*c-2*n+"px"})},$=function(t,e){t.style("border-radius",c+"px").style("font-size",u/2+"px").style("background",function(t){return e?null:"key"==t.type||"formula"==t.type?"white":"silver"}).style("box-shadow",e?null:"#888 0px 1px 0px").style("font-family","'HelveticaNeue-UltraLight', 'Helvetica Neue UltraLight', 'Helvetica Neue', Arial, Helvetica, sans-serif").style("font-weight",100).style("border","none").style("padding",0).style("-webkit-user-select","none").style("-khtml-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none").style("user-select","none").style("cursor","pointer").style("display",function(t){return"arrow"!==t.type&&"backspace"!==t.type?"table":null})},K=function(t,e){"center"===e?(t.style("margin-left",-k/2+"px"),t.style("left","50%"),t.style("right",null)):"left"===e?(t.style("margin-left",0),t.style("left",0),t.style("right",null)):"right"===e?(t.style("margin-left",0),t.style("left",null),t.style("right",0)):(t.style("margin-left",-k/2+"px"),t.style("left",e),t.style("right",null))};return t.rebind(P,v,"on")}},function(){return o||(o=s()())})}).call(this,n(6),n(8))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(39);Object.defineProperty(e,"GeoGebraCanvasElement",{enumerable:!0,get:function(){return i.GeoGebraCanvasElement}});var r=n(80);Object.defineProperty(e,"GeoGebraPanel",{enumerable:!0,get:function(){return r.GeoGebraPanel}});var o=n(79);Object.defineProperty(e,"GM_GGB_Link",{enumerable:!0,get:function(){return o.GM_GGB_Link}});var s=n(78);Object.defineProperty(e,"GM_GGB_SI_Line_Link",{enumerable:!0,get:function(){return s.GM_GGB_SI_Line_Link}});var a=n(51);Object.defineProperty(e,"GgbTools",{enumerable:!0,get:function(){return a.GgbTools}})},function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.GCService=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(40),s=n(7),a=n(17);e.GCService=function(){function e(n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=(0,s.uid)(),this.gct=(0,s.getURLParameter)("gct"),this.gcsid=(0,s.getURLParameter)("gcsid"),this.loginModal=t.select("#gm-gc-student-login-modal"),this.canvas=n,this.is_processing=!1,this.gmAssignment=null,this.gmSubmission=null,this.gcSubmission=null,o.gcAuth.is_ready?this.init(this.gct,this.gcsid):o.gcAuth.events.on("APIReady."+this.id,function(){return i.init(i.gct,i.gcsid)})}return r(e,[{key:"init",value:function(e,n){var i=this;this.is_processing||(this.loginModal.size()||(t.select("#gm-modal-container").append("div").node().outerHTML=l(),this.loginModal=t.select("#gm-gc-student-login-modal")),a.user.events.on("login."+this.id,function(){return i.init(i.gct,i.gcsid)}),a.user.events.on("logout."+this.id,function(){return i.init(i.gct,i.gcsid)}),this.canvas.events.on("meta_data_change."+this.id,function(t){t.is_new_sheet&&i.init(null,null)}),this.gct=e,this.gcsid=n,this.gmAssignment=null,this.gmSubmission=null,this.gcSubmission=null,this.gcsid&&this.gct?this.initSubmissionCase():this.gct?this.initAssignmentCase():this.canvas.footer.html(""))}},{key:"initAssignmentCase",value:function(){var t=this;console.log("init assignment case"),this.is_processing=!0,this.showMessage("info","Loading Google Classroom assignment..."),this.fetchAssignmentFromGM().then(function(e){if(console.log("teacher",e.teacher,"user",a.user.id),e&&a.user.logged_in&&!t.userIsTeacher())return t.fetchSubmissionFromGM().then(function(e){if(!e)return t.createGCAndGMSubmission()})}).then(function(){if(a.user.logged_in&&!t.userIsTeacher()&&!t.gcSubmission&&t.gmAssignment){var e=t.userIsTeacher()||t.userIsStudent();return t.fetchSubmissionsFromGC(e).then(function(e){console.log("got submissions",e),t.gcSubmission=e[0]})}}).then(function(){return t.ensureCorrectCanvas()}).then(function(){return t.updateCanvasOwnership()}).then(function(){if(t.userIsTeacher())return t.fetchSubmissionInfo()}).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.render(e)}).then(function(){return t.is_processing=!1}).catch(function(e){t.is_processing=!1,console.error(e),t.showMessage("danger","This looks like a Google Classroom assignment, but something went wrong. (See browser console for more details.)")})}},{key:"initSubmissionCase",value:function(){var t=this;console.log("init submission case"),this.is_processing=!0,this.showMessage("info","Loading Google Classroom submission..."),this.fetchSubmissionFromGM().then(function(){return t.ensureCorrectCanvas()}).then(function(){if(!t.gmSubmission)throw"Could not find GM submission entry.";if(t.userIsTeacher()||t.userIsStudent())return t.fetchSubmissionsFromGC().then(function(e){console.log("got submissions",e),t.gcSubmission=e[0]}).then(function(){return t.updateCanvasOwnership()}).then(function(){return t.render()});t.render()}).then(function(){return t.is_processing=!1}).catch(function(e){t.is_processing=!1,console.error(e),t.showMessage("danger","This looks like a Google Classroom assignment, but something went wrong. (See browser console for more details.)")})}},{key:"fetchAssignmentFromGM",value:function(){var t=this;console.log("fetch assignment from GM");var e=this.canvas.settings.get("savefile_server")+"/api/assignments/"+this.gct,n=(0,a.Xhr)(e).contentType("application/json").parseResult(!0);return new Promise(function(e,i){n.run().then(function(n){t.gmAssignment=n.result,console.log("got gmAssignment",t.gmAssignment),e(t.gmAssignment)},i)})}},{key:"fetchSubmissionFromGM",value:function(){var t=this;console.log("fetch submission from GM");var e=this.canvas.settings.get("savefile_server")+"/api/studentSubmissions";this.gcsid?e+="/"+this.gcsid:e+="?gct="+encodeURIComponent(this.gct)+"&user="+encodeURIComponent(a.user.id);var n=(0,a.Xhr)(e).contentType("application/json").parseResult(!0);return new Promise(function(e,i){n.run().then(function(n){t.gmSubmission=t.gcsid?n.result:n.result[0],n.result&&0!==n.result.length?(t.gmAssignment=t.gmSubmission.assignment,t.gcsid=t.gmSubmission.submission_id,console.log("got gmSubmission",t.gmSubmission,"and gmAssignment",t.gmAssignment),e(t.gmSubmission)):e(null)},i)})}},{key:"fetchSubmissionInfo",value:function(){return o.gcAuth.listStudentSubmissions(this.gmAssignment.course_id,this.gmAssignment.assignment_id).then(function(t){return{submission_count:{all:t.length,turned_in:t.filter(function(t){return"TURNED_IN"===t.state}).length}}})}},{key:"createGCAndGMSubmission",value:function(){var t=this;return console.log("creating submission now"),this.fetchSubmissionsFromGC().then(function(e){if(0===e.length)throw"Could not initialize Google Classroom submission.";return t.gcSubmission=e[0],t.gcsid=t.gcSubmission&&t.gcSubmission.id,t.gcSubmission}).then(this.cloneTeacherCanvas.bind(this)).then(this.postGMSubmission.bind(this)).then(this.addGCSubmissionAttachment.bind(this))}},{key:"postGMSubmission",value:function(){var t=this;return new Promise(function(e,n){console.log("posting gm submission");var i=t.canvas.settings.get("savefile_server")+"/api/studentSubmissions";(0,a.Xhr)(i).contentType("application/json").parseResult(!0).requestType("post").body({gct:t.gct,submission_id:t.gcSubmission.id,math_sheet_id:t.canvas.meta_data.save_id,external_link:t.gcSubmission.alternateLink}).run().then(function(n){t.gmSubmission=n.result,console.log("created gmSubmission",t.gmSubmission),e(t.gmSubmission)},n)})}},{key:"addGCSubmissionAttachment",value:function(){var t=this;console.log("creating gc attachment");var e=o.gcAuth.constructCanvasMaterialLink(this.getSubmissionUrl());return o.gcAuth.addAttachment(this.gmAssignment.course_id,this.gmAssignment.assignment_id,this.gmSubmission.submission_id,e).then(function(e){return t.gcSubmission=e,e})}},{key:"cloneTeacherCanvas",value:function(){var t=this;return this.gmAssignment?this.loadCanvas(this.gmAssignment.math_sheet_id).then(function(){console.log("cloning canvas"),t.canvas.save({clone:!0},function(e,n){if(e)throw e;return window.history.pushState({},document.title,t.getSubmissionUrl()),n})}):new Promise(function(t,e){return e()})}},{key:"loadCanvas",value:function(t){var e=this;return new Promise(function(n,i){e.canvas.meta_data.save_id!==t?e.canvas.loadFromFile(t,!0,function(t,r){if(t)i(t);else{var o=e.gmSubmission?e.getSubmissionUrl():e.getAssignmentUrl();window.history.pushState({},document.title,o),n(r)}}):n()})}},{key:"ensureCorrectCanvas",value:function(){if(this.gmAssignment){var t=this.gmSubmission&&this.gmSubmission.math_sheet_id||this.gmAssignment.math_sheet_id;return t!==this.canvas.meta_data.save_id?this.loadCanvas(t):void 0}}},{key:"loginAndRetryOnError",value:function(t,e){var n=this;return e?t().then(function(t){return t},function(e){return n.showGCLoginPrompt().then(function(){return n.hideModal()},function(t){throw n.hideModal(),t}).then(t)}):t()}},{key:"extractAndThrowGCErrorMessage",value:function(t){throw t&&t.result&&t.result.error&&t.result.error?t.result.error.message+" ("+t.result.error.status+")":t}},{key:"fetchSubmissionsFromGC",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];console.log("fetch submission from GC");var e=this.gmAssignment,n=this.gmSubmission&&this.gmSubmission.submission_id,i=n?o.gcAuth.getStudentSubmission.bind(o.gcAuth,e.course_id,e.assignment_id,n):o.gcAuth.listStudentSubmissions.bind(o.gcAuth,e.course_id,e.assignment_id,"me");return this.loginAndRetryOnError(i,t).then(function(t){if(t&&0!==t.length)return Array.isArray(t)?t:[t];throw"No submission found."}).catch(this.extractAndThrowGCErrorMessage)}},{key:"turnInSubmission",value:function(){var t=this,e=this.gmAssignment,n=this.gmSubmission;return this.saveAndTransferCanvasOwnership(e.teacher.user_id,e.teacher.display_name).then(function(){return o.gcAuth.turnInSubmission(e.course_id,e.assignment_id,n.submission_id)}).then(function(){t.gcSubmission.state="TURNED_IN"}).catch(this.extractAndThrowGCErrorMessage)}},{key:"saveAndTransferCanvasOwnership",value:function(t,e){var n=this;return new Promise(function(i,r){if(console.log("transferring canvas ownership"),n.canvas.meta_data.owner!==a.user.user_id)throw"Can't transfer ownership, not owned by current user";n.canvas.save({transferOwnership:{id:t,name:e}},function(t,e){return t?r(t):i(e)})})}},{key:"updateCanvasOwnership",value:function(){var t=this;if(this.gcSubmission&&this.gmAssignment&&this.gmSubmission&&(this.userIsStudent()||this.userIsTeacher())){var e=void 0;if(!this.isTurnedIn()&&this.canvasOwnedByTeacher()?e="return":this.isTurnedIn()&&this.canvasOwnedByStudent()&&(e="turnIn"),e){var n=this.canvas.settings.get("savefile_server")+"/api/studentSubmissions/"+this.gcsid+"/"+e,i=(0,a.Xhr)(n).contentType("application/json");return new Promise(function(e,n){i.run().then(function(n){t.canvas.meta_data.owner=t.isTurnedIn()?t.gmAssignment.teacher.user_id:t.gmSubmission.student.user_id,t.canvas.meta_data.display_name=t.isTurnedIn()?t.gmAssignment.teacher.display_name:t.gmSubmission.student.display_name,t.canvas.updateTitle(),e()},n)})}}}},{key:"onTurnInButtonClick",value:function(t){var e=this;t.attr("disabled","disabled").text("Turning In..."),this.turnInSubmission().then(function(){return e.render()}).catch(function(t){console.error(t),e.showMessage("danger","Could not turn in your work. Please use <a target='_blank' href='"+e.gmSubmission.external_link+"' style='color: inherit; text-decoration: underline; font-weight: bold; cursor: pointer'>Google Classroom</a>, directly.",!0)})}},{key:"reclaimSubmission",value:function(){var t=this,e=this.gmAssignment,n=this.gmSubmission;return this.loginAndRetryOnError(function(){return o.gcAuth.reclaimSubmission(e.course_id,e.assignment_id,n.submission_id)}).then(function(){return t.gcSubmission.state="RECLAIMED_BY_STUDENT"}).then(function(){return t.updateCanvasOwnership()}).catch(this.extractAndThrowGCErrorMessage)}},{key:"onReclaimButtonClick",value:function(t){var e=this;t.attr("disabled","disabled").text("Reclaiming..."),this.reclaimSubmission().then(function(){return e.render()}).catch(function(t){console.error(t),e.showMessage("danger","Could not reclaim your work. Please use <a target='_blank' href='"+e.gmSubmission.external_link+"' style='color: inherit; text-decoration: underline; font-weight: bold; cursor: pointer'>Google Classroom</a>, directly.",!0)})}},{key:"attachment_matcher",value:function(t){var e=this.getSubmissionUrl(null,t);return function(t){return t.link&&t.link.url===e}}},{key:"getSubmissionUrl",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gct,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.gcsid;return this.canvas.getCanvasUrl(window.location.pathname,{load:this.canvas.meta_data.save_id,gct:t,gcsid:e},window.location.origin)}},{key:"getAssignmentUrl",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gct;return this.canvas.getCanvasUrl(window.location.pathname,{load:this.canvas.meta_data.save_id,gct:t},window.location.origin)}},{key:"showGCLoginPrompt",value:function(){var t=this;return new Promise(function(e,n){t.loginModal.select("#gc-login-prompt").style("display",null),t.loginModal.select("#gc-message").style("display","none"),i(t.loginModal.node()).modal("show"),t.loginModal.select("#gc-login").on("click",function(){o.gcAuth.signInAsStudent().then(e,n)})})}},{key:"hideModal",value:function(){i(this.loginModal.node()).modal("hide")}},{key:"userIsTeacher",value:function(){return this.gmAssignment&&a.user.logged_in&&this.gmAssignment.teacher.user_id===a.user.user_id}},{key:"userIsStudent",value:function(){return this.gmSubmission&&a.user.logged_in&&this.gmSubmission.student.user_id===a.user.user_id}},{key:"isTurnedIn",value:function(){return this.gcSubmission&&"TURNED_IN"===this.gcSubmission.state}},{key:"isReturned",value:function(){return this.gcSubmission&&"RETURNED"===this.gcSubmission.state}},{key:"canvasOwnedByTeacher",value:function(){return this.gmAssignment&&this.canvas.meta_data.owner===this.gmAssignment.teacher.user_id}},{key:"canvasOwnedByStudent",value:function(){return this.gmSubmission&&this.canvas.meta_data.owner===this.gmSubmission.student.user_id}},{key:"showMessage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"danger",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"There was a problem communicating with Google Classroom.",n=arguments[2];console.error(e),this.canvas.footer.html("\n      <span class='alert alert-"+t+"' style='margin-bottom: 5px; display: inline-block'></span>\n    "),n?this.canvas.footer.select("span").html(e):this.canvas.footer.select("span").text(e),this.canvas.showFooter()}},{key:"render",value:function(t){var e=this;if(!this.gmAssignment)return this.canvas.footer.html(""),void this.canvas.showFooter(!1);var n=function(t,e){return"<a target='_blank' href='"+t+"' style='color: inherit; text-decoration: underline; font-weight: bold; cursor: pointer'>"+e+"</a>"};if(this.userIsStudent()&&!this.isTurnedIn()){this.canvas.footer.html("\n        <span class='alert "+(this.isReturned()?"alert-success":"alert-info")+"' style='margin-bottom: 5px; display: inline-block'>\n          <span style='vertical-align: middle'>You're working on a "+n(this.gmAssignment.external_link,"Google Classroom")+" assignment.\n            "+(this.isReturned()?"The teacher has returned this work to you.":"")+'\n          </span>\n          <button class="btn btn-primary" style="margin-top:-0.75rem; margin-bottom: -0.75rem; margin-left: 2rem">\n            '+(this.isReturned()?"Turn In Again":"Turn In")+"\n          </button>\n        </span>\n      ");var i=this.canvas.footer.select("button");i.on("click",function(){return e.onTurnInButtonClick(i)})}else if(this.userIsStudent()&&this.isTurnedIn()){this.canvas.footer.html("\n        <span class='alert alert-success' style='margin-bottom: 5px; display: inline-block'>\n          You turned in this "+n(this.gmAssignment.external_link,"Google Classroom")+' assignment.\n          <button class="btn btn-default" style="margin-top:-0.75rem; margin-bottom: -0.75rem; margin-left: 2rem">Unsubmit</button>\n          </span>\n      ');var r=this.canvas.footer.select("button");r.on("click",function(){return e.onReclaimButtonClick(r)})}else if(this.userIsTeacher()&&!this.gmSubmission){var o,s=t&&t.submission_count,l=this.gmAssignment.external_link.replace(/\/details$/,"/submissions");o=s?n(l,s.turned_in+" of "+s.all+" students have turned in their work."):"Check for "+n(l,"student responses"),this.canvas.footer.html("\n        <span class='alert alert-success' style='margin-bottom: 5px; display: inline-block'>\n          Assigned on Google Classroom. "+o+"\n        </span>\n      ")}else if(this.userIsTeacher()&&this.gmSubmission){var u,c=this.gmAssignment.external_link.replace(/\/details$/,"/submissions");u=this.isTurnedIn()?n(c,"Grade and return the work"):this.isReturned()?"You have returned the work.":"The student hasn't submitted the work yet.";var d=this.gmSubmission.student.display_name;this.canvas.footer.html("\n        <span class='alert alert-success' style='margin-bottom: 5px; display: inline-block'>\n          "+d+"'s work on their "+n(this.gmAssignment.external_link,"Google Classroom assignment")+".\n           "+u+"\n        </span>\n      ")}else{var h=this.gmSubmission?"work by "+this.gmSubmission.student.display_name:"assignment by "+this.gmAssignment.teacher.display_name;this.canvas.footer.html("\n        <span class='alert alert-info' style='margin-bottom: 5px; display: inline-block'>\n          This is a Google Classroom "+h+". "+n("","Login")+" with the right teacher or student account to work on it.\n        </span>\n      "),this.canvas.footer.select("a").on("click",function(){return a.user.loginWithGoogle()})}this.canvas.showFooter()}}]),e}();var l=function(){return'\n  <div class="modal fade in" tabindex="-1" role="dialog" id="gm-gc-student-login-modal" style="display: none">\n    <div class="modal-dialog" role="document">\n      <div class="modal-content">\n        <div class="modal-header">\n          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>\n          <h4 class="modal-title">Google Classroom</h4>\n        </div>\n        <div id=\'content\' style=\'margin: 1rem 2rem\'>\n          <div id="gc-login-prompt" style="text-align: center; padding: 2rem">\n            <p>Please click the icon to log in with your Google Classroom student account and give us permission to submit your work.</p>\n            <p><a id="gc-login" style="cursor: pointer"><img src="/shared/imgs/3rd-party/gc-64x64@2x.png" style=\'width:64px\'></a></p>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>'}}).call(this,n(6),n(8))},function(t,e,n){"use strict";(function(t){function n(e,n,i,r,o){this.table=e,this.container=n,this.events=t.dispatch("click","focus","input"),this.row_el=null,this.idx=o,this.x=i,this.x_el=null,this.x_in=null,this.y=r,this.y_el=null,this.y_in=null,this.is_selected=!1,this.is_editable=!1,this.init()}Object.defineProperty(e,"__esModule",{value:!0}),e.TableRow=n,n.prototype.init=function(){this.row_el=this.container.append("div").classed("table-row",!0).style("position","absolute").style("left","0px");var t=this;function e(e){t[e+"_el"]=t.row_el.append("div").classed("table-cell",!0).style("position","absolute").style("top","0px").style("box-sizing","border-box").style("border","1px solid silver").style("background-color","white").on("click",function(){t.events.click()}),t[e+"_in"]=t[e+"_el"].append("span").classed("table-input",!0).style("position","absolute").style("left","4px").style("top","4px").style("text-align","center").style("overflow","hidden").on("click",function(){t.is_editable&&t.events.focus(e)})}e("x"),e("y"),this.setEditable(!1),this.update()},n.prototype.update=function(){var t=this.table,e=this;function n(n){e.dragCol(n,0),e[n+"_el"].style("width",t.column_width+"px").style("height",t.row_height+"px");var i=e[n].toString();i.length>4&&(i=i.substring(0,4)+"..."),e[n+"_in"].html(i).style("width",t.column_width-10+"px").style("height",t.row_height-10+"px").style("line-height",t.row_height-10+"px")}this.dragRow(0,0),this.row_el.style("width",2*t.column_width+"px").style("height",t.row_height+"px"),n("x"),n("y")},n.prototype.setSelected=function(t){this.row_el.selectAll(".table-cell").style("background-color",t?"gainsboro":"white"),this.row_el.selectAll(".table-input").style("background-color",t&&!this.is_editable?"gainsboro":"white"),this.is_selected=t},n.prototype.setEditable=function(t){var e=this.table.row_height-10;this.row_el.selectAll(".table-input").style("border",t?"1px solid silver":"none").style("line-height",t?e-1+"px":e+"px").style("background-color",!t&&this.is_selected?"gainsboro":"white"),this.is_editable=t},n.prototype.setEditing=function(t,e){this[t+"_in"].style("border",e?"1px solid dodgerblue":this.is_editable?"1px solid silver":"none")},n.prototype.setColIndex=function(t){this.x_el.style("z-index","x"==t?1:0),this.y_el.style("z-index","y"==t?1:0)},n.prototype.dragCol=function(t,e){this[t+"_el"].transition().duration(e).style("left",this.table[t+"_pos"]+"px")},n.prototype.dragRow=function(e,n){0===e?this.row_el.style("top",this.table.row_height*this.idx+"px"):this.row_el.style("opacity",.75).transition().delay(n).duration(e).style("top",this.table.row_height*this.idx+"px").each("end",function(){t.select(this).style("opacity",1)})},n.prototype.readInput=function(t){var e=parseFloat(this[t+"_in"].html());isNaN(e)||(this[t]=e,this.events.input(t))}}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(13))&&i.__esModule?i:{default:i},s=n(14),a=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"Math",settingName:"allow_term_flipping",fallbackValue:!0}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"render",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this,i=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this,t);return i.select("input.setting-value").each(function(){n.updateHintText(this.checked)}),this.onChange("setting-form-input",this.updateHintText.bind(this)),i}},{key:"getTitle",value:function(){return"Term Inversion"}},{key:"getHTML",value:function(){return'\n            <div class="checkbox">\n                <label>\n                <input class="setting-value" type="checkbox" '+(this.settings.get()?"checked":"")+"> Allow inverting terms across fraction bars.\n                </label>\n            </div>\n            <div class='setting-preview' style='display: flex; flex-direction: row; align-items: center; justify-content: space-between; margin-bottom: 1em'>\n                <div style='flex: 0'><span style='margin-right: 1em'>Preview:</span></div>\n                <div style='flex: 0'><div class='gm-math1' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n                <div class='eq-arrow' style='flex-grow: 0; color: black; text-align: center; font-family: Kalam; font-size: 25px'>⇒</div>\n                <div style='flex: 1'><div class='gm-math2' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n                <div style='flex: 0'><div class='gm-math3' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n                <div class='eq-arrow2' style='flex-grow: 0; color: black; text-align: center; font-family: Kalam; font-size: 25px'>⇒</div>\n                <div style='flex: 1'><div class='gm-math4' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n            </div>"}},{key:"updateHintText",value:function(t){var e=this.div.select(".gm-math1").node(),n=this.div.select(".gm-math2").node(),i=this.div.select(".eq-arrow"),r=this.div.select(".gm-math3").node(),o=this.div.select(".gm-math4").node(),a=this.div.select(".eq-arrow2");Array.from(e.children).forEach(function(t){return e.removeChild(t)}),Array.from(n.children).forEach(function(t){return n.removeChild(t)}),Array.from(r.children).forEach(function(t){return r.removeChild(t)}),Array.from(o.children).forEach(function(t){return o.removeChild(t)}),s.AlgebraView.createStaticExpression(e,"1/x",{h_align:"left",v_align:"bottom",max_font_size:25}),t?(i.style("color","black"),s.AlgebraView.createStaticExpression(n,"x^-1",{h_align:"left",v_align:"bottom",max_font_size:25})):i.style("color","red"),s.AlgebraView.createStaticExpression(r,"x^2",{h_align:"left",v_align:"bottom",max_font_size:25}),t?(a.style("color","black"),s.AlgebraView.createStaticExpression(o,"1/x^-2",{h_align:"left",v_align:"bottom",max_font_size:25})):a.style("color","red")}}]),e}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(13))&&i.__esModule?i:{default:i},s=n(14),a=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"AlgebraModel",settingName:"auto_simplify_multiplicative_annihilators",fallbackValue:!0}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"render",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this,i=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this,t);return i.select("input.setting-value").each(function(){n.updateHintText(this.checked)}),this.onChange("setting-form-input",this.updateHintText.bind(this)),i}},{key:"getTitle",value:function(){return"Automatic Simplification of *0"}},{key:"getHTML",value:function(){return'\n            <div class="checkbox">\n                <label>\n                <input class="setting-value" type="checkbox" '+(this.settings.get()?"checked":"")+"> *0 will automatically reduce products to 0.\n                </label>\n            </div>\n            <div class='setting-preview' style='display: flex; flex-direction: row; align-items: center; justify-content: space-between; margin-bottom: 1em'>\n                <div style='flex: 0'><span style='margin-right: 1em'>Preview:</span></div>\n                <div style='flex: 0'><div class='gm-math1' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n                <div class='eq-arrow' style='flex-grow: 0; color: black; text-align: center; font-family: Kalam; font-size: 25px'>⇒</div>\n                <div style='flex: 1'><div class='gm-math2' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n            </div>"}},{key:"updateHintText",value:function(t){var e=this.div.select(".gm-math1").node(),n=this.div.select(".gm-math2").node();Array.from(e.children).forEach(function(t){return e.removeChild(t)}),Array.from(n.children).forEach(function(t){return n.removeChild(t)});var i=t?"2x":"2x+0x";s.AlgebraView.createStaticExpression(e,"x*(2+0)",{h_align:"left",v_align:"bottom",max_font_size:25}),s.AlgebraView.createStaticExpression(n,i,{h_align:"left",v_align:"bottom",max_font_size:25})}}]),e}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(13))&&i.__esModule?i:{default:i},s=n(14),a=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"AlgebraModel",settingName:"auto_simplify_additive_identities",fallbackValue:!0}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"render",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this,i=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this,t);return i.select("input.setting-value").each(function(){n.updateHintText(this.checked)}),this.onChange("setting-form-input",this.updateHintText.bind(this)),i}},{key:"getTitle",value:function(){return"Automatic Simplification of +0"}},{key:"getHTML",value:function(){return'\n            <div class="checkbox">\n                <label>\n                <input class="setting-value" type="checkbox" '+(this.settings.get()?"checked":"")+"> +0 will be automatically simplified and hidden.\n                </label>\n            </div>\n            <div class='setting-preview' style='display: flex; flex-direction: row; align-items: center; justify-content: space-between; margin-bottom: 1em'>\n                <div style='flex: 0'><span style='margin-right: 1em'>Preview:</span></div>\n                <div style='flex: 0'><div class='gm-math1' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n                <div class='eq-arrow' style='flex-grow: 0; color: black; text-align: center; font-family: Kalam; font-size: 25px'>⇒</div>\n                <div style='flex: 1'><div class='gm-math2' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n            </div>"}},{key:"updateHintText",value:function(t){var e=this.div.select(".gm-math1").node(),n=this.div.select(".gm-math2").node();Array.from(e.children).forEach(function(t){return e.removeChild(t)}),Array.from(n.children).forEach(function(t){return n.removeChild(t)});var i=t?"1":"1+0";s.AlgebraView.createStaticExpression(e,"1+2-2",{h_align:"left",v_align:"bottom",max_font_size:25}),s.AlgebraView.createStaticExpression(n,i,{h_align:"left",v_align:"bottom",max_font_size:25})}}]),e}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(13))&&i.__esModule?i:{default:i},s=n(14),a=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"AlgebraModel",settingName:"auto_simplify_multiplicative_identities",fallbackValue:!0}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"render",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this,i=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this,t);return i.select("input.setting-value").each(function(){n.updateHintText(this.checked)}),this.onChange("setting-form-input",this.updateHintText.bind(this)),i}},{key:"getTitle",value:function(){return"Automatic Simplification of *1"}},{key:"getHTML",value:function(){return'\n            <div class="checkbox">\n                <label>\n                <input class="setting-value" type="checkbox" '+(this.settings.get()?"checked":"")+"> \"Times ones\" will be automatically simplified and hidden.\n                </label>\n            </div>\n            <div class='setting-preview' style='display: flex; flex-direction: row; align-items: center; justify-content: space-between; margin-bottom: 1em'>\n                <div style='flex: 0'><span style='margin-right: 1em'>Preview:</span></div>\n                <div style='flex: 0'><div class='gm-math1' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n                <div class='eq-arrow' style='flex-grow: 0; color: black; text-align: center; font-family: Kalam; font-size: 25px'>⇒</div>\n                <div style='flex: 1'><div class='gm-math2' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n                <div style='flex: 0'><div class='gm-math3' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n                <div class='eq-arrow' style='flex-grow: 0; color: black; text-align: center; font-family: Kalam; font-size: 25px'>⇒</div>\n                <div style='flex: 1'><div class='gm-math4' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n            </div>"}},{key:"updateHintText",value:function(t){var e=this.div.select(".gm-math1").node(),n=this.div.select(".gm-math2").node(),i=this.div.select(".gm-math3").node(),r=this.div.select(".gm-math4").node();Array.from(e.children).forEach(function(t){return e.removeChild(t)}),Array.from(n.children).forEach(function(t){return n.removeChild(t)}),Array.from(i.children).forEach(function(t){return i.removeChild(t)}),Array.from(r.children).forEach(function(t){return r.removeChild(t)});var o=t?"3/2":"{1*3}/{2*1}",a=t?"a+3a":"1*a+3*a";s.AlgebraView.createStaticExpression(e,"1/2*3/1",{h_align:"left",v_align:"bottom",max_font_size:25}),s.AlgebraView.createStaticExpression(n,o,{h_align:"left",v_align:"bottom",max_font_size:25}),s.AlgebraView.createStaticExpression(i,"a*(1+3)",{h_align:"left",v_align:"bottom",max_font_size:25}),s.AlgebraView.createStaticExpression(r,a,{h_align:"left",v_align:"bottom",max_font_size:25})}}]),e}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(13))&&i.__esModule?i:{default:i},s=n(14),a=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments[2];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"Math",settingName:"enable_polynomial_distribution",fallbackValue:!0}));return r.distributionSettingForm=i,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"render",value:function(){var t=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=this,r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this,n);return r.select("input.setting-value").each(function(){i.updateHintText(this.checked,i.distributionSettingForm.getFormValue())}),this.onChange("setting-form-input",function(e){t.updateHintText(e,t.distributionSettingForm.getFormValue())}),this.distributionSettingForm.onChange("update-polynomial-preview",function(e){t.updateHintText(t.getFormValue(),e)}),r}},{key:"getTitle",value:function(){return"Polynomials"}},{key:"getHTML",value:function(){return'\n            <div class="checkbox">\n                <label>\n                <input class="setting-value" type="checkbox" '+(this.settings.get()?"checked":"")+"> Double-tap to combine polynomials.\n                </label>\n            </div>\n            <div class='setting-preview' style='display: flex; flex-direction: row; align-items: center; justify-content: space-between; margin-bottom: 1em'>\n                <div style='flex: 0'><span style='margin-right: 1em'>Preview:</span></div>\n                <div style='flex: 0'><div class='gm-math1' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n                <div class='eq-arrow' style='flex-grow: 0; color: black; text-align: center; font-family: Kalam; font-size: 25px'>⇒</div>\n                <div style='flex: 1'><div class='gm-math2' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n            </div>"}},{key:"updateHintText",value:function(t,e){var n=this.div.select(".gm-math1").node(),i=this.div.select(".gm-math2").node(),r=this.div.select(".eq-arrow");Array.from(n.children).forEach(function(t){return n.removeChild(t)}),Array.from(i.children).forEach(function(t){return i.removeChild(t)});var o=e?"3a^2 + 2a - 6a - 4":"3*a*a + 2*a - 2*3*a - 2*2";s.AlgebraView.createStaticExpression(n,"(a-2)*(3a+2)",{h_align:"left",v_align:"bottom",max_font_size:25}),t?(r.style("color","black"),s.AlgebraView.createStaticExpression(i,o,{h_align:"left",v_align:"bottom",max_font_size:25})):r.style("color","red")}}]),e}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(13))&&i.__esModule?i:{default:i},s=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"Math",settingName:"use_simple_keyboard_layout",fallbackValue:!1}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"getTitle",value:function(){return"Keypad Layout"}},{key:"getHTML",value:function(){return'\n            <div class="checkbox">\n                <label>\n                <input class="setting-value" type="checkbox" '+(this.settings.get()?"checked":"")+"> Don't show advanced math features.\n                </label>\n            </div>\n            <div class='gm-settings-menu__text--description'>\n                <p>When this setting is active, the keypad for editing expression will have a simpler layout for learners.</p>\n            </div>"}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(13))&&i.__esModule?i:{default:i},s=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"Math",settingName:"enable_shake_trigger_type",fallbackValue:!0}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"getTitle",value:function(){return"Shake for Keypad"}},{key:"getHTML",value:function(){return'\n            <div class="checkbox">\n                <label>\n                <input class="setting-value" type="checkbox" '+(this.settings.get()?"checked":"")+"> Enable the shaking gesture on math expressions.\n                </label>\n            </div>\n            <div class='gm-settings-menu__text--description'>\n                <p>If you shake an expression up and down, the keypad will appear for you to edit that expression.</p>\n            </div>"}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(13))&&i.__esModule?i:{default:i},s=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"Math",settingName:"allow_non_equivalent_keyboard_rewrite",fallbackValue:!0}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"getTitle",value:function(){return"Non-equivalent Keypad Entry"}},{key:"getHTML",value:function(){return'\n            <div class="checkbox">\n                <label>\n                <input class="setting-value" type="checkbox" '+(this.settings.get()?"checked":"")+"> Allow non-equivalent rewrites.\n                </label>\n            </div>\n            <div class='gm-settings-menu__text--description'>\n                <p>Activate this setting if you want to be able to change expressions to anything you want, even if they're not mathematically equivalent to what it replaces.</p>\n            </div>"}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(52))&&i.__esModule?i:{default:i},s=function(){function t(e){var n=e.isUserSetting;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isUserSetting=n}return r(t,[{key:"match",value:function(t){var e=this;t.forEach(function(t){t.active=Object.keys(t.options).every(function(n){var i=(0,o.default)(e.isUserSetting,n),r=t.options[n];return Object.keys(r).every(function(t){return r[t]===i.get(t)})})})}},{key:"configure",value:function(t){var e=this;Object.keys(t).forEach(function(n){e.forEachSettingInType(t,n,function(t,e,n){t.set(e,n)})})}},{key:"revert",value:function(t){var e=this;Object.keys(t).forEach(function(n){e.forEachSettingInType(t,n,function(t,e){t.unset(e)})})}},{key:"forEachSettingInType",value:function(t,e,n){var i=(0,o.default)(this.isUserSetting,e),r=t[e];Object.keys(r).forEach(function(t){return n(i,t,r[t])})}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=s(n(37)),o=s(n(194));function s(t){return t&&t.__esModule?t:{default:t}}var a=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),i(e,[{key:"initSettings",value:function(t){this.settings=new o.default(t)}},{key:"render",value:function(){var t=this,e=this.setHTML(this.compileHTML());return e.select("select").on("change.preset-form-input",function(){t.updateHintText(this.selectedIndex)}),this.updateHintText(0),e}},{key:"getSelection",value:function(){return this.modes[this.div.select("select").node().selectedIndex]}},{key:"onChange",value:function(t,e){var n=this;this.div.select("button").on("click."+t,function(){e(n.getSelection())})}}]),e}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(195))&&i.__esModule?i:{default:i},s=n(7),a=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n}));return i.id=(0,s.uid)(),i.setBackgroundColor("aliceblue"),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"init",value:function(){this.modes=[{name:"select a preset",effects:"Select and load the beginner or advanced preset to adjust all settings for more or less automaticity.",options:{}},{name:"Beginner",effects:"Load the beginner preset if you want to see and work through all mathematical steps manually.",options:{Derivation:{show_area_hints:!0,show_dest_hints:!0,show_action_names:!0,auto_trigger_actions:!1},Math:{allow_term_flipping:!1,allow_drag_across_relation:!0,simplify_after_drag_across_relation:!0,allow_non_equivalent_keyboard_rewrite:!1,cancel_common_terms_after_finding_gcf:!1,factor_after_finding_gcf:!1,auto_simplify_distributions:!1,enable_polynomial_distribution:!1,use_simple_keyboard_layout:!0},AlgebraModel:{hide_implicit_multiplication_setting:"neverHide",auto_simplify_multiplicative_identities:!1,auto_simplify_additive_identities:!1,auto_simplify_multiplicative_annihilators:!1},AlgebraView:{use_arithmetic_multiplication_symbol:!1}}},{name:"Advanced",effects:"Load the advanced preset if you'd like GM to automatically perform substeps like finding the greatest common denominator when factoring.",options:{Derivation:{show_area_hints:!0,show_dest_hints:!0,show_action_names:!0,auto_trigger_actions:!1},Math:{allow_term_flipping:!0,allow_drag_across_relation:!0,simplify_after_drag_across_relation:!1,allow_non_equivalent_keyboard_rewrite:!0,cancel_common_terms_after_finding_gcf:!0,factor_after_finding_gcf:!0,auto_simplify_distributions:!0,enable_polynomial_distribution:!0,use_simple_keyboard_layout:!1},AlgebraModel:{hide_implicit_multiplication_setting:"hideUnlessAmbiguous",auto_simplify_multiplicative_identities:!0,auto_simplify_additive_identities:!0,auto_simplify_multiplicative_annihilators:!0},AlgebraView:{use_arithmetic_multiplication_symbol:!1}}}]}},{key:"getTitle",value:function(){return"Skill Level Presets"}},{key:"getHTML",value:function(){return'\n            <div class="form-group">\n                <select id=\'gm-user-skill-level-preset-'+this.id+'\' class="form-control" style="width: 10em; display: inline-block">\n                    <option value=\'\' style="color: gray">select preset</option>    \n                    <option value=\''+this.modes[1].name+"'>"+this.modes[1].name+"</option>\n                    <option value='"+this.modes[2].name+"'>"+this.modes[2].name+"</option>\n                </select>\n                <button style=\"margin-left: 0.5em\" class=\"btn btn-default\">Load</button>\n            </div>\n            <div style=\"margin-top: -0.5em\" class='gm-settings-menu__text--description'>\n                <p style='font-style: italic' id='mode-info'></p>\n            </div>"}}]),e}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(13))&&i.__esModule?i:{default:i},s=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"Math",settingName:"only_simple_rewrites",fallbackValue:!1}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"getTitle",value:function(){return"Editing in Keypad Mode"}},{key:"getHTML",value:function(){return'\n            <div class="checkbox">\n                <label>\n                <input class="setting-value" type="checkbox" '+(this.settings.get()?"checked":"")+"> Restrict keyboard rewrites.\n                </label>\n            </div>\n            <div class='gm-settings-menu__text--description'>\n                <p>When this setting is active, a term cannot be substituted by more than two terms in the keypad, forcing step-by-step rewriting.</p>\n            </div>"}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(13))&&i.__esModule?i:{default:i},s=n(14),a=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"Math",settingName:"cancel_common_terms_after_finding_gcf",fallbackValue:!0}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"render",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this,i=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this,t);return i.select("input.setting-value").each(function(){n.updateHintText(this.checked)}),this.onChange("setting-form-input",this.updateHintText.bind(this)),i}},{key:"getTitle",value:function(){return"Division"}},{key:"getHTML",value:function(){return'\n            <div class="checkbox">\n                <label>\n                <input class="setting-value" type="checkbox" '+(this.settings.get()?"checked":"")+"> Automatically cancel the greatest common factor.\n                </label>\n            </div>\n            <div class='setting-preview' style='display: flex; flex-direction: row; align-items: center; justify-content: space-between; margin-bottom: 1em'>\n                <div style='flex: 0'><span style='margin-right: 1em'>Preview:</span></div>\n                <div style='flex: 0'><div class='gm-math1' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n                <div class='eq-arrow' style='flex-grow: 0; color: black; text-align: center; font-family: Kalam; font-size: 25px'>⇒</div>\n                <div style='flex: 1'><div class='gm-math2' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n            </div>"}},{key:"updateHintText",value:function(t){var e=this.div.select(".gm-math1").node(),n=this.div.select(".gm-math2").node();Array.from(e.children).forEach(function(t){return e.removeChild(t)}),Array.from(n.children).forEach(function(t){return n.removeChild(t)});var i=t?"5x":"{5*2x}/2";s.AlgebraView.createStaticExpression(e,"{10x}/2",{h_align:"left",v_align:"bottom",max_font_size:25}),s.AlgebraView.createStaticExpression(n,i,{h_align:"left",v_align:"bottom",max_font_size:25})}}]),e}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(13))&&i.__esModule?i:{default:i},s=n(14),a=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"AlgebraModel",settingName:"auto_simplify_distributions",fallbackValue:!0}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"render",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this,t),i=this;return n.select("input.setting-value").each(function(){i.updateHintText(this.checked)}),this.onChange("setting-form-input",this.updateHintText.bind(this)),n}},{key:"getTitle",value:function(){return"Distributing"}},{key:"getHTML",value:function(){return'\n            <div class="checkbox">\n                <label>\n                <input id="distributionSettingCheckbox" class="setting-value" type="checkbox" '+(this.settings.get()?"checked":"")+"> Automatically simplify distributed numbers.\n                </label>\n            </div>\n            <div class='setting-preview' style='display: flex; flex-direction: row; align-items: center; justify-content: space-between; margin-bottom: 1em'>\n                <div style='flex: 0'><span style='margin-right: 1em'>Preview:</span></div>\n                <div style='flex: 0'><div class='gm-math1' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n                <div class='eq-arrow' style='flex-grow: 0; color: black; text-align: center; font-family: Kalam; font-size: 25px'>⇒</div>\n                <div style='flex: 1'><div class='gm-math2' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n            </div>"}},{key:"updateHintText",value:function(t){var e=this.div.select(".gm-math1").node(),n=this.div.select(".gm-math2").node();Array.from(e.children).forEach(function(t){return e.removeChild(t)}),Array.from(n.children).forEach(function(t){return n.removeChild(t)});var i=t?"6x+8x":"2*3x+2*4x";s.AlgebraView.createStaticExpression(e,"2*(3x+4x)",{h_align:"left",v_align:"bottom",max_font_size:25}),s.AlgebraView.createStaticExpression(n,i,{h_align:"left",v_align:"bottom",max_font_size:25})}}]),e}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},s=(i=n(13))&&i.__esModule?i:{default:i},a=n(14),l=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"Math",settingName:"factor_after_finding_gcf",fallbackValue:!0}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),r(e,[{key:"render",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this,i=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this,t);return i.select("input.setting-value").each(function(){n.updateHintText(this.checked)}),this.onChange("setting-form-input",this.updateHintText.bind(this)),i}},{key:"setFormValue",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setFormValue",this).call(this,t)}},{key:"getTitle",value:function(){return"Factoring"}},{key:"getHTML",value:function(){return'\n            <div class="checkbox">\n                <label>\n                <input class="setting-value" type="checkbox" '+(this.settings.get()?"checked":"")+"> Automatically factor the greatest common factor.\n                </label>\n            </div>\n            <div class='setting-preview' style='display: flex; flex-direction: row; align-items: center; justify-content: space-between; margin-bottom: 1em'>\n                <div style='flex: 0'><span style='margin-right: 1em'>Preview:</span></div>\n                <div style='flex: 0'><div class='gm-math1' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n                <div class='eq-arrow' style='flex-grow: 0; color: black; text-align: center; font-family: Kalam; font-size: 25px'>⇒</div>\n                <div style='flex: 1'><div class='gm-math2' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n            </div>"}},{key:"updateHintText",value:function(t){var e=this.div.select(".gm-math1").node(),n=this.div.select(".gm-math2").node();Array.from(e.children).forEach(function(t){return e.removeChild(t)}),Array.from(n.children).forEach(function(t){return n.removeChild(t)});var i=t?"(2x+x)*2":"2*2x+2x";a.AlgebraView.createStaticExpression(e,"4x+2x",{h_align:"left",v_align:"bottom",max_font_size:25}),a.AlgebraView.createStaticExpression(n,i,{h_align:"left",v_align:"bottom",max_font_size:25})}}]),e}();e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(37))&&i.__esModule?i:{default:i},s=n(7),a=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"Derivation"}));return i.id=(0,s.uid)(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"init",value:function(){this.modes=[{name:"Exploration Mode",effects:"Shows trigger hints and destination hints. Triggers actions when you drop terms.",options:{show_area_hints:!0,show_dest_hints:!0,show_action_names:!0,auto_trigger_actions:!1}},{name:"Presentation Mode",effects:"Shows destination hints. Triggers actions when you drop terms.",options:{show_area_hints:!1,show_dest_hints:!0,show_action_names:!1,auto_trigger_actions:!1}},{name:"Work Mode",effects:"Triggers actions automatically when you hold terms over the target.",options:{show_area_hints:!1,show_dest_hints:!1,show_action_names:!1,auto_trigger_actions:!0}}]}},{key:"getTitle",value:function(){return"Algebra Transformation Mode"}},{key:"getHTML",value:function(){return'\n            <div class="form-group">\n                <label class="radio-inline"><input type="radio" class="gm-setting-radio" name="interaction-mode-setting-'+this.id+'">'+this.modes[0].name+'</label>\n                <label class="radio-inline"><input type="radio" class="gm-setting-radio" name="interaction-mode-setting-'+this.id+'">'+this.modes[1].name+'</label>\n                <label class="radio-inline"><input type="radio" class="gm-setting-radio" name="interaction-mode-setting-'+this.id+'">'+this.modes[2].name+"</label>\n            </div>\n            <div style=\"margin-top: -0.5em\" class='gm-settings-menu__text--description'>\n                <p style='font-style: italic' id='mode-info'></p>\n                <p>Use exploration mode if you are new to Graspable Math or are learning about\n                a new algebra topic. It is perfect for self-paced exploration of algebraic\n                rules and strategies.</p\n                <p>Use presentation mode for presenting to a classroom, tutoring,\n                or working in a team.</p>\n                <p>Use Work mode for fast and efficient work when you have learned the Graspable Math gestures.\n            </div>"}}]),e}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(37))&&i.__esModule?i:{default:i},s=n(7),a=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"Math"}));return i.id=(0,s.uid)(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"init",value:function(){this.modes=[{name:"Disable Dragging",effects:"To apply an operation to both sides of an equation, click and hold the equals sign, then enter the desired operation in the keyboard.",options:{allow_drag_across_relation:!1}},{name:"Dragging",effects:"Drag a term across the equals sign to apply the inverse operation to both sides. Will show the inverse terms on both sides of the equation.",options:{allow_drag_across_relation:!0,simplify_after_drag_across_relation:!0}},{name:"Dragging and Simplify",effects:"Drag a term across the equals sign to apply the inverse operation to both sides. Will automatically combine the matching terms.",options:{allow_drag_across_relation:!0,simplify_after_drag_across_relation:!1}}]}},{key:"getTitle",value:function(){return"Rewriting Equations via Dragging"}},{key:"getHTML",value:function(){return'\n            <div class="form-group">\n                <label class="radio-inline"><input type="radio" class="gm-setting-radio" name="allow-operation-inversion-setting-'+this.id+'">'+this.modes[0].name+'</label>\n                <label class="radio-inline"><input type="radio" class="gm-setting-radio" name="allow-operation-inversion-setting-'+this.id+'">'+this.modes[1].name+'</label>\n                <label class="radio-inline"><input type="radio" class="gm-setting-radio" name="allow-operation-inversion-setting-'+this.id+'">'+this.modes[2].name+"</label>\n            </div>\n            <div style=\"margin-top: -0.5em\" class='gm-settings-menu__text--description'>\n                <p style='font-style: italic' id='mode-info'></p>\n            </div>"}}]),e}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(13))&&i.__esModule?i:{default:i},s=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"Derivation",settingName:"scrub_precision",fallbackValue:1}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"getTitle",value:function(){return"Scrubbing Numbers"}},{key:"getHTML",value:function(){return'\n            <div class="form-group">\n                <label for="scrub-prec" class="col-sm-4 control-label">Scrub Decimal Place</label>\n                <div class="col-sm-8">\n                <input type="number" class="form-control setting-value" id="scrub-prec" value='+this.settings.get()+" min=-10 max=10 step=1>\n                </div>\n            </div>\n            <div class='gm-settings-menu__text--description'>\n                <p>Scrubbing changes numbers by 1/10^place. For example, set the decimal place to 0 to scrub 1s,\n                to 1 to scrub 1/10s, and to -2 to scrub 100s. Pick a value from -10 to 10.</p>\n            </div>"}},{key:"getFormValue",value:function(){return Math.round(+this.div.select("input.setting-value").node().value)}},{key:"setFormValue",value:function(t){t.hasOwnProperty(this.settings.getName())&&this.div.select("input.setting-value").attr("value",t[this.settings.getName()])}},{key:"writeData",value:function(){var t=this.getFormValue();isNaN(t)||t<-10||t>10||this.settings.set(t)}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(13))&&i.__esModule?i:{default:i},s=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"AlgebraView",settingName:"number_display_precision",fallbackValue:3}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"getTitle",value:function(){return"Displayed Number Precision"}},{key:"getHTML",value:function(){return'\n            <div class="form-group">\n                <label for="scrub-prec" class="col-sm-4 control-label">Decimal Places Shown</label>\n                <div class="col-sm-8">\n                    <input type="number" class="form-control setting-value" id="scrub-prec" value='+this.settings.get()+" min=0 max=12 step=1>\n                </div>\n            </div>\n            <div class='gm-settings-menu__text--description'>\n                <p>The number of decimal places that Graspable Math will show for all numbers. Internally,\n                Graspable Math uses a higher precision. Pick a value from 0 to 12.</p>\n            </div>"}},{key:"getFormValue",value:function(){return Math.round(+this.div.select("input.setting-value").node().value)}},{key:"setFormValue",value:function(t){t.hasOwnProperty(this.settings.getName())&&this.div.select("input.setting-value").attr("value",t[this.settings.getName()])}},{key:"writeData",value:function(){var t=this.getFormValue();isNaN(t)||t<0||t>12||this.settings.set(t)}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(52))&&i.__esModule?i:{default:i},s=function(){function t(e){var n=e.settingsType,i=e.isUserSetting;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=n,this.isUserSetting=i,this.settings=(0,o.default)(i,n)}return r(t,[{key:"match",value:function(t){var e=this;t.forEach(function(t){t.active=Object.keys(t.options).every(function(n){return t.options[n]===e.settings.get(n)})})}},{key:"configure",value:function(t){var e=this;Object.keys(t).forEach(function(n){e.settings.set(n,t[n])})}},{key:"revert",value:function(t){var e=this;Object.keys(t).forEach(function(t){e.settings.unset(t)})}},{key:"saveCurrentSettingsOntoDocument",value:function(t){if(this.isUserSetting)throw new Exception("saveCurrentSettingsOntoDocument() called on the wrong object");var e=!0,n=!1,i=void 0;try{for(var r,o=t[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var s=r.value;this.settings.set(s,this.settings.get(s))}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},s=(i=n(37))&&i.__esModule?i:{default:i},a=n(7),l=n(14),u=function(t){function e(t,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"AlgebraModel"}));return r.multSymbolSetting=i,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),r(e,[{key:"init",value:function(){this.modes=[{name:"Hide where possible",options:{hide_implicit_multiplication_setting:"hideUnlessAmbiguous"}},{name:"Hide when a variable is on the right and a number or variable is on the left",options:{hide_implicit_multiplication_setting:"hideBetweenNumAndVarAndBetweenVarAndVar"}},{name:"Always show",options:{hide_implicit_multiplication_setting:"neverHide"}}]}},{key:"getTitle",value:function(){return"Multiplication Symbol Visibility"}},{key:"render",value:function(){var t=this;o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this),this.multSymbolSetting.onChange("update-sym-vis-preview",function(e){t.updateHintText(t.getFormValueModeIdx(),e)})}},{key:"updateHintText",value:function(t,n){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateHintText",this).call(this,t),n||(n=this.multSymbolSetting.getFormValue());var i=this.div.select("#multiplicationSettingsPreviewDiv").node();Array.from(i.children).forEach(function(t){return i.removeChild(t)}),l.AlgebraView.createStaticExpression(i,"2ab4c + 3*1/2",(0,a.extend)({font_size:25,use_arithmetic_multiplication_symbol:n},this.modes[t].options))}},{key:"getHTML",value:function(){return'\n<div class="radio"><label><input type="radio" class="gm-setting-radio" name="multiplication-symbol-visibility-setting-'+this.id+'">'+this.modes[0].name+'</label></div>\n<div class="radio"><label><input type="radio" class="gm-setting-radio" name="multiplication-symbol-visibility-setting-'+this.id+'">'+this.modes[1].name+'</label></div>\n<div class="radio"><label><input type="radio" class="gm-setting-radio" name="multiplication-symbol-visibility-setting-'+this.id+'">'+this.modes[2].name+'</label></div>\n<div style="display: flex; align-items: center">\n  <span style="color: black; margin-right: 1em">Preview:</span>\n  <div id="multiplicationSettingsPreviewDiv"></div>\n</div>\n<p></p>\n'}}]),e}();e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return!t.has(e)||!t.parent||t.get(e)!==t.parent.get(e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(i=n(13))&&i.__esModule?i:{default:i},s=n(14),a=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{isUserSetting:n,settingsType:"AlgebraView",settingName:"use_arithmetic_multiplication_symbol",fallbackValue:!1}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"getTitle",value:function(){return"Multiplication Symbol Type"}},{key:"getHTML",value:function(){return'\n      <div>\n        <div class="checkbox">\n          <label>\n            <input id="multiplicationSymbolTypeSettingCheckbox" class="setting-value" type="checkbox" '+(this.settings.get()?"checked":"")+'> Use \'×\' as multiplication symbol.\n          </label>\n        </div>\n        <div style="display: flex; align-items: center">\n          <span style="color: black; margin-right: 1em">Preview:</span>\n          <div id="setting-preview"></div>\n        </div>\n      </div>'}},{key:"writeData",value:function(){var t=this.getFormValue();this.settings.setLibValue("symbol_mappings","*",t?"×":"·"),this.settings.setLibValue("symbol_mappings","/",t?"×":"·"),this.settings.set(t)}},{key:"render",value:function(){var t=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this),n=this;return t.select("input.setting-value").each(function(){n.updateHintText(this.checked)}),this.onChange("setting-form-input",this.updateHintText.bind(this)),t}},{key:"getSettingValueAccordingToTheForm",value:function(){return this.div.select("#multiplicationSymbolTypeSettingCheckbox").property("checked")}},{key:"updateHintText",value:function(t){var e=this.div.select("#setting-preview").node();Array.from(e.children).forEach(function(t){return e.removeChild(t)}),s.AlgebraView.createStaticExpression(e,"a*b",{h_align:"left",v_align:"bottom",max_font_size:25,hide_implicit_multiplication_setting:"neverHide",use_arithmetic_multiplication_symbol:t})}}]),e}();e.default=a},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,i=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var r,o=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?t:(r=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:i+o.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},function(t,e,n){(t.exports=n(29)(!1)).push([t.i,".size-to-page-height {\n    max-height: 70vh;\n    overflow-y: scroll;\n}\n\n#gm-settings-modal h4 {\n    display: inline-block;\n}\n\n.gm-settings-menu__text--description {\n    opacity: 0.67;\n    padding: 15px;\n    padding-bottom: 0;\n}",""])},function(t,e,n){var i=n(210);"string"==typeof i&&(i=[[t.i,i,""]]);n(28)(i,{hmr:!0,transform:void 0,insertInto:void 0}),i.locals&&(t.exports=i.locals)},function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.getDocumentSettingsModal=function(){return M||(M=new S(!1)),M},e.getUserSettingsModal=function(){return E||(E=new S(!0)),E};var o=n(7);n(211);var s=T(n(208)),a=T(n(206)),l=T(n(204)),u=T(n(203)),c=T(n(202)),d=T(n(201)),h=T(n(200)),p=T(n(199)),f=T(n(198)),g=T(n(197)),m=T(n(196)),v=T(n(193)),y=T(n(192)),b=T(n(191)),_=T(n(190)),x=T(n(189)),w=T(n(188)),A=T(n(187)),k=T(n(186));function T(t){return t&&t.__esModule?t:{default:t}}var S=function(){function e(n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.isUserSetting=n,this.id=(0,o.uid)();var i=this.isUserSetting?"gm-user-settings-modal":"gm-document-settings-modal";t.select("#gm-modal-container").append("div").node().outerHTML=function(t,e,n){return'\n        <div class="modal fade in gm-settings-modal" tabindex="-1" role="dialog" id="'+e+'" style="display: none">\n            <div class="modal-dialog" role="document">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>\n                    <h3 class="modal-title">'+(n?"Your Default Settings":"Document Settings")+'</h3>                    \n                </div>\n                <div class="size-to-page-height">\n                    <div class="modal-body" style="padding: 0">\n                        <p class="gm-settings-menu__text--description">\n                            '+(n?"These settings will be used for new documents you create.":"These settings are saved with the document you are currently working on.")+'\n                        </p>\n                        <div id="content'+t+'">\n                        </div>\n                    </div>\n                </div>\n                <div class="modal-footer">\n                    <button class="btn btn-default" data-dismiss="modal">Close</button>\n                    <button id="save-btn'+t+'" class="btn btn-primary">Save changes</button>\n                </div>\n            </div>\n            </div>\n        </div>'}(this.id,i,this.isUserSetting),this.menu=t.select("#"+i),this.initSettingForms()}return r(e,[{key:"initSettingForms",value:function(){var t,e,n=this.getContentSection(),i=this.isUserSetting;this.presetSettingForm=new m.default(n,i),this.settingForms=[],i&&this.settingForms.push(new d.default(n,i)),this.settingForms=this.settingForms.concat([new h.default(n,i),t=new p.default(n,i),new _.default(n,i,t),new f.default(n,i),new x.default(n,i),new w.default(n,i),new A.default(n,i),new k.default(n,i),new b.default(n,i),new v.default(n,i),new g.default(n,i),new y.default(n,i),new c.default(n,i),new u.default(n,i),new l.default(n,i),e=new s.default(n,i),new a.default(n,i,e)])}},{key:"getContentSection",value:function(){return this.select("#content"+this.id)}},{key:"select",value:function(t){return this.menu.select(t)}},{key:"onSave",value:function(t){this.select("#save-btn"+this.id).on("click.save"+this.id,t)}},{key:"show",value:function(){i(this.node()).modal("show")}},{key:"hide",value:function(){i(this.node()).modal("hide")}},{key:"node",value:function(){return this.menu.node()}}]),e}(),M=null,E=null}).call(this,n(6),n(8))},function(t,e,n){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0}),e.addSubmitButton=function(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.appendButtonGroup([{type:"dropdown",label:"submit",data_toggle:"dropdown",pull_right:!0,icon:"glyphicon glyphicon-sunglasses",html_fn:function(e,o){var s={width:346,padding:0,margin:0,border:0},l=function(t,e){var i=2*(e.padding+e.margin+e.border);return n.select(t).append("div").attr("id","gm-submit-dropdown").style({width:e.width+i+"px",padding:e.padding+"px"}).on("click",function(){n.event.stopPropagation()})}(r=o,s);return function(t,e){i=l.append("div").attr("id","gm-submit-panel").classed("panel",!0).style({margin:e.margin+"px",border:e.border?e.border+"px solid silver":"none"}),e.border||i.style("box-shadow","none")}(0,s),a(e),t(l.node().parentElement).on("hidden.bs.dropdown",a.bind(null,e)),l.node()}.bind(null,e)}],null,o)};var i=void 0,r=void 0;function o(e,n){i.selectAll("*").remove();var o="alert alert-dismissable "+(n?"alert-danger":"alert-success");i.append("div").attr("class",o).text(e).style("margin-bottom",0).attr("role","alert").append("button").classed("close",!0).html("&times;").on("click",function(){return t(r).find("button#submit").trigger("click")})}var s=null;function a(t){var e,n,r=(e=function(e){s&&s.abort(),s=function(t,e,n){var i=new XMLHttpRequest;return i.onreadystatechange=function(){if(4===this.readyState)if(200===this.status||301===this.status||302===this.status){var t;try{t=JSON.parse(i.responseText)}catch(t){return void n(t)}n(null,t.length)}else n("Network or server error ("+i.status+").")},i.open("GET",e.settings.get("savefile_server")+"/api/classrooms/"+encodeURIComponent(t)),i.setRequestHeader("Content-Type","application/json"),user.auth_token&&i.setRequestHeader("Authorization","Bearer "+user.auth_token),i.send(),i}(e,t,function(t,e){s=null,t||!e?(d.classed("has-error",!0),d.classed("has-success",!1),f.attr("disabled",!0),p.text(t||"Code not found.")):(d.classed("has-error",!1),d.classed("has-success",!0),f.attr("disabled",null),p.text("Code found."))})},1e3,n=null,function(){var t=this,i=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(t,i)},1e3)});i.selectAll("*").remove();var a=i.append("div").classed("panel-body",!0).append("div").classed("form-horizontal",!0).style("margin-top","0.8em"),l=a.append("div").classed("form-group",!0);l.append("label").text("Your name:").attr("for","name-input").attr("class","col-xs-5 control-label");var u=l.append("div").attr("class","col-xs-7").append("input").attr({type:"text",class:"form-control",id:"name-input"}),c=l.append("span").attr({id:"helpBlock",class:"col-xs-7 col-xs-offset-5 help-block"}).text("Name too short.").style("display","none"),d=a.append("div").classed("form-group",!0);d.append("label").text("Classroom code:").attr("for","code-input").attr("class","col-xs-5 control-label");var h=d.append("div").attr("class","col-xs-7").append("input").attr({type:"text",class:"form-control",id:"code-input"}).on("input",function(){f.attr("disabled",!0),d.classed("has-error has-success",!1),p.text("Checking..."),p.style("display",""===this.value?"none":null),""!==this.value&&r(this.value)}),p=d.append("span").attr({id:"helpBlock",class:"col-xs-7 col-xs-offset-5 help-block"}).style("display","none"),f=a.append("div").classed("form-group",!0).style("margin-bottom",0).append("div").attr("class","col-xs-offset-5 col-xs-7").append("button").classed("btn btn-default",!0).text("Submit").attr("disabled",!0).on("click",function(e){var n=u.node().value,i=h.node().value,r=n.length>=3;c.style("display",r?"none":null),l.classed("has-error",!r),r&&function(t,e,n){t.meta_data||(t.meta_data={}),t.meta_data.context="gm-sidebar-mathxl",t.meta_data.student_name=e,t.meta_data.classroom_code=n,t.meta_data.problemset_name||(t.meta_data.problemset_name="???"),t.save({},function(t){t?o("Sorry, we could not save your work. ("+t.reason+")",!0):o("Your work has been submitted!",!1)})}(t,n,i)})}}).call(this,n(8),n(6))},function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.GoogleClassroomMenu=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(7),s=n(40),a=n(17),l=void 0,u=e.GoogleClassroomMenu=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.menu=t.select("#gm-gc-modal"),this.submitting=!1,0===this.menu.size()&&this.constructMenu()}return r(e,[{key:"constructMenu",value:function(){t.select("#gm-modal-container").append("div").node().outerHTML=l(),this.menu=t.select("#gm-gc-modal")}},{key:"retrieveCourseList",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return s.gcAuth.getCourseList().catch(function(n){if(e)return t.showGCLoginPrompt().then(function(){return t.retrieveCourseList(!1)}).catch(function(e){i(t.menu.node()).modal("hide"),console.error(error)});var r=n.result&&n.result.error&&n.result.error.message;r&&(r+=" ("+n.result.error.status+")"),t.showMessage("Sorry, we can't access your Google Classroom courses.",r||"")})}},{key:"assignTask",value:function(t){var n=e.id,i=this.menu.select("#course-"+n).node().value,r=this.menu.select("#title-"+n).node().value,a=this.menu.select("#instructions-"+n).node().value,l=(0,o.uid)(),u=t.getCanvasUrl(window.location.pathname,{gct:l},window.location.origin),c={title:r,description:a,materials:[s.gcAuth.constructCanvasMaterialLink(u,r)]};return s.gcAuth.createCourseWork(i,c).then(function(t){return{gct:l,work:t}})}},{key:"showMessage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.id;this.menu.select(".modal-footer").style("display","none"),this.menu.select("#gc-login-prompt-"+r).style("display","none"),this.menu.select("#gc-message-"+r).style("display",null),this.menu.select("#gc-message-"+r+" h4").text(t),i?this.menu.select("#gc-message-"+r+" p").html(n):this.menu.select("#gc-message-"+r+" p").text(n)}},{key:"showGCLoginPrompt",value:function(){var t=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=e.id;return new Promise(function(e,r){t.menu.select(".modal-footer").style("display",n?"none":null),t.menu.select("#gc-message-"+i).style("display","none"),t.menu.select("#gc-login-prompt-"+i).style("display",n?null:"none"),t.menu.select("#gc-login-"+i).on("click",n?function(){t.showGCLoginPrompt(!1),s.gcAuth.signInAsTeacher().then(e,r)}:null)})}},{key:"bindMenuToCanvas",value:function(t){var n=this,i=e.id;this.showGCLoginPrompt(!1),this.menu.select("#gc-account-"+i+" a").text(s.gcAuth.getName()).on("click",function(){return s.gcAuth.signInAsTeacher().then(n.bindMenuToCanvas.bind(n,t),n.bindMenuToCanvas.bind(n,t))}),this.menu.select("#course-"+i).selectAll("option").remove(),this.menu.select("#course-"+i).append("option").style("color","gray").property("value","LOADING").text("loading..."),this.retrieveCourseList().then(function(t){var e=n.menu.select("#course-"+i).selectAll("option").data(t);e.exit().remove(),e.enter().append("option"),e.text(function(t){return t.name}).style("color","black").attr("value",function(t){return t.id}),n.updateAssignButton()},function(t){return console.log("error",t)}),this.menu.select("#title-"+i).on("input",this.updateAssignButton.bind(this)).node().value=t.meta_data.title,this.menu.select("#instructions-"+i).node().value=t.meta_data.desc||"",this.menu.select("#assign-btn").on("click",this.onAssignButtonClick.bind(this,t)),this.menu.select("#duplicate-notice").style("display",this.ownsCanvas(t)?"none":null),this.menu.select("#save-notice").style("display",this.ownsCanvas(t)&&t.controller.needsSaving()?null:"none"),this.updateAssignButton()}},{key:"ownsCanvas",value:function(t){return a.user.user_id===t.meta_data.owner}},{key:"updateAssignButton",value:function(){var t=e.id,n=this.menu.select("#assign-btn"),i=!0;this.submitting?i=!1:""===this.menu.select("#title-"+t).node().value?i=!1:"LOADING"===this.menu.select("#course-"+t).node().value&&(i=!1),n.attr("disabled",i?null:"disabled")}},{key:"handleGCError",value:function(t){var e=t.result&&t.result.error&&t.result.error.message;e&&(e+=" ("+t.result.error.status+")"),this.showMessage("Sorry, we could not create the assignment.",e||"")}},{key:"saveCanvas",value:function(t){var e=this;return new Promise(function(n,i){e.ownsCanvas(t)&&t.controller.needsSaving()?(e.showMessage("We're saving your math sheet...",""),t.save({},function(t,e){t?i(t):n()})):n()})}},{key:"onAssignButtonClick",value:function(t){var e=this;this.submitting=!0,this.updateAssignButton();var n=void 0,r=void 0;this.saveCanvas(t).then(function(){return e.showMessage("We're creating the assignment in Google Classroom...","")}).then(function(){return e.assignTask(t)}).then(function(i){return n=i.work,r=i.gct,e.createGMAssignment(r,t,n)},function(t){return e.handleGCError(t)}).then(function(){e.submitting=!1,e.triggerGCService(r,t),i(e.menu.node()).modal("hide")},function(t){e.submitting=!1,e.showMessage("Sorry, we could not reach the GM Server to create the assignment."),s.gcAuth.deleteCourseWork(n.courseId,n.id)})}},{key:"triggerGCService",value:function(t,e){var n=e.getCanvasUrl(window.location.pathname,{load:e.meta_data.save_id,gct:t},window.location.origin);window.history.pushState({},document.title,n),e.gcService&&e.gcService.init(t)}},{key:"createGMAssignment",value:function(t,e,n){var i=e.settings.get("savefile_server")+"/api/assignments";return(0,a.Xhr)(i).contentType("application/json").requestType("post").body({gct:t,course_id:n.courseId,assignment_id:n.id,external_link:n.alternateLink,math_sheet_id:e.meta_data.save_id}).run()}},{key:"show",value:function(t){this.bindMenuToCanvas(t),i(this.menu.node()).modal("show")}}]),e}();u.id=(0,o.uid)(),l=function(){var t=u.id;return'\n  <div class="modal fade in" tabindex="-1" role="dialog" id="gm-gc-modal" style="display: none">\n    <div class="modal-dialog" role="document">\n      <div class="modal-content">\n        <div class="modal-header" style="margin-bottom: 15px">\n          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>\n          <h4 class="modal-title">Assign In Google Classroom</h4>\n        </div>\n        <div id=\'content\' style=\'margin: 0 2rem; position: relative\'>\n          <p id="gc-account-'+t+'" style=\'text-align: right\'>current account: <a style="cursor: pointer">switch</a></p>\n          <form class="form-horizontal">\n            <div class="form-group">\n              <label for=\'course-'+t+'\' class="col-sm-2 control-label">Course</label>\n              <div class="col-sm-10">\n                <select class="form-control" id="course-'+t+'">\n                </select>\n              </div>\n            </div>\n            <div class="form-group">\n              <label for="title-'+t+'" class="col-sm-2 control-label">Title</label>\n              <div class="col-sm-10">\n                <input type="text" class="form-control" id="title-'+t+'">\n              </div>\n            </div>\n            <div class="form-group">\n              <label for="instructions-'+t+'" class="col-sm-2 control-label">Instructions</label>\n              <div class="col-sm-10">\n                <textarea class="form-control" id="instructions-'+t+'" rows="3"></textarea>\n              </div>\n            </div>\n          </form>\n          <div id="gc-login-prompt-'+t+'" style="text-align: center; display:none; position: absolute;height: 100%;width: 100%;background: white;top: 0;padding: 2rem">\n            <p>Please click the icon to log in with your Google Classroom teacher account and give us permission to assign tasks to your courses.</p>\n            <p><a id="gc-login-'+t+'" style="cursor: pointer"><img src="/shared/imgs/3rd-party/gc-64x64@2x.png" style=\'width:64px\'></a></p>\n          </div>\n          <div id="gc-message-'+t+'" style="text-align: center; display:none; position: absolute;height: 100%;width: 100%;background: white;top: 0;padding: 2rem">\n            <h4></h4>\n            <p></p>\n          </div>\n        </div>\n        <div class="modal-footer">\n          <p id=\'duplicate-notice\' style=\'text-align: left; font-style: italic; display: none\'>\n            You don\'t own this math sheet and the owner might change it.\n            You can duplicate the sheet in the save menu before assigning it to avoid that.\n          </p>\n          <p id=\'save-notice\' style=\'text-align: left; font-style: italic; display: none\'>\n            We will save your latest changes when you click "Assign".\n          </p>\n          <button class="btn btn-default" data-dismiss="modal">Close</button>\n          <button id="assign-btn" class="btn btn-primary" disabled>Assign</button>\n        </div>\n      </div>\n    </div>\n  </div>'}}).call(this,n(6),n(8))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.addShareButton=function(t){var e=new a(t,{label:l,require_user:!0});return t.appendButtonGroup([{type:"dropdown",label:l,data_toggle:"dropdown",pull_right:!0,icon:"glyphicon glyphicon-send",html_fn:e.setupMenu.bind(e,t)}])};var r=n(38),o=n(17),s=n(214),a=function(e){function n(){return function(t,e){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,r.ToolbarMenu),i(n,[{key:"loadContent",value:function(t,e,n){this.gcMenu=this.gcMenu||new s.GoogleClassroomMenu,n.meta_data.save_id?this.showShareOptions(t,n.meta_data,n):o.user.logged_in?this.showMessage(t,"Please save your work first!"):this.showMessage(t,"Please log in to save your work first!")}},{key:"showShareOptions",value:function(e,n,i){var r=this,s=i.settings.get("enable_google_classroom");n.save_id,e.selectAll("*").remove();var a=e.append("div").classed("panel-body gm-clear-after",!0),l=a.append("ul").attr("class","nav nav-tabs").style("margin-bottom","1.4em").selectAll("li").data(s?["Social","Link","Email","Embed"]:["Link","Email","Embed"]).enter().append("li").attr("id",function(t){return t+"-tab"});function u(t){l.classed("active",function(e){return e===t}),a.selectAll(".tab-content").style("display",function(e){return e===t?null:"none"}),"Email"===t?i.container.select(".publish-done-btn").style("display","none"):i.container.select(".publish-done-btn").style("display",null)}l.append("a").style("cursor","pointer").text(function(t){return t}).on("click",u),a.selectAll(".tab-content").data(s?["Social","Link","Email","Embed"]:["Link","Email","Embed"]).enter().append("div").attr("class","tab-content").attr("id",function(t){return t}),a.select("div#Social").html("\n<div>\n<a id='gc-link' class='gray_on_hover' style='cursor: pointer; display: block'>\n<img src='/shared/imgs/3rd-party/gc-assign@2x.png' style='height: 48px'>\n</a>\n</div>\n").select("#gc-link").on("click",function(){t("body").trigger("click"),r.gcMenu.show(i)}),u(s?"Social":"Link");var c=a.select("div#Link");c.append("h3").text("Here is your link:");var d=i.getCanvasUrl();c.append("div").classed("share_link",!0).append("input").attr({type:"text"}).on("click",function(){this.select(),this.setSelectionRange(0,this.value.length)}).on("input",function(){this.value=d,this.select(),this.setSelectionRange(0,this.value.length)}).node().value=d,c.append("p").text("Keep this link for yourself or share it with others. It will always point to the latest version of this canvas.");var h=i.getCanvasUrl("/embed.html"),p=a.select("div#Embed");p.append("p").text("To embed the saved GM canvas into your own webpage, put the following snippet into the body of your html file.");var f='<script type="text/javascript">url = parent.document.URL; document.write(\'<iframe style="border: none" src=\\\''+h+"&options={\"use_toolbar\": true, \"vertical_scroll\": true}&parent_url='+url+'\\' width=100% height=500px></iframe>');<\/script>";p.append("div").classed("share_link",!0).append("input").attr({type:"text"}).on("click",function(){this.select(),this.setSelectionRange(0,this.value.length)}).on("input",function(){this.value=f,this.select(),this.setSelectionRange(0,this.value.length)}).node().value=f;var g=a.select("div#Email");g.append("h3").text("Send the share link in an email!"),g.append("p").style("margin-top","1em").text("Subject:"),g.append("div").append("input").attr({type:"text",class:"form-control",id:"email_subject",value:n.title||"Graspable Math Canvas"}),g.append("p").style("margin-top","1em").text("Content:"),g.append("textarea").attr({class:"form-control",id:"email_body"}).style({height:"6em",resize:"vertical"}).text("Click here to load the Graspable Math canvas: "+d),g.append("p").style("margin-top","1em").text("Send to:");var m=g.append("div").classed("input-group",!0);m.append("input").attr({type:"email",class:"form-control",id:"toEmail"}).attr({placeholder:"target@email.com"}),m.append("span").classed("input-group-btn",!0).append("button").attr({type:"button",class:"btn btn-primary",id:"send_btn"}).text("Send Email!").on("click",function(){var t=i.container.select("#toEmail").value,n=i.container.select("#email_subject").value,r=i.container.select("#email_body").value,s=/\S+@\S+\.\S+/.test(t);if(m.classed("has-error",!s),s){var l={};l.toEmail=t,l.subject=n,l.body=r;var u=this,c=new XMLHttpRequest;c.onreadystatechange=function(){200===c.status&&c.readyState<4?u.showWorking(a,"Sending..."):4==c.readyState&&(200==c.status?u.showComplete(a,"Sent."):(console.warn("Error sending email:",c.status,c.responseText,c),u.showMessage(e,"Could not send email.","danger")))},c.open("POST",i.settings.get("email_server")+"/api/send_email_to",!0),c.setRequestHeader("Content-Type","application/json"),o.user.auth_token&&c.setRequestHeader("Authorization","Bearer "+o.user.auth_token),c.send(JSON.stringify(l))}}.bind(this)),a.append("hr"),a.append("button").property("type","button").classed("publish-done-btn",!0).classed("btn btn-primary",!0).text("Done").on("click",function(){t(this.button).trigger("click"),this.close()}.bind(this))}}]),n}(),l="share"}).call(this,n(8))},function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.addLoadButton=function(t){var e=new a(t,{label:l,require_user:!0});return t.appendButtonGroup([{type:"dropdown",label:l,data_toggle:"dropdown",pull_right:!0,icon:"glyphicon glyphicon-open-file",html_fn:e.setupMenu.bind(e,t)}])};var o=n(38),s=n(17),a=function(e){function n(){return function(t,e){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,o.ToolbarMenu),r(n,[{key:"loadContent",value:function(t,e,n){this.showWorking(e,"Loading...");var i=new XMLHttpRequest,r=n.settings.get("savefile_server")+"/api/saves?user_id="+s.user.user_id,o=this;i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){var e=JSON.parse(i.responseText).map(function(t){return t.meta_data.updated_at=new Date(t.updated_at),t.meta_data});e.length>0?(t.selectAll("*").remove(),t.classed("gm-menu-panel",!1),t.classed("gm-load",!0),o.showSaveFiles(t,e,n)):o.showMessage(t,"You have no save files!","info")}else 404===i.status?o.showMessage(t,"Please log in to access save files."):0===i.status?o.showMessage(t,"Are you connected to the internet?"):o.showMessage(t,"We're sorry, there was an error when trying to access your files ("+i.status+").")},i.open("get",r,!0),i.setRequestHeader("Content-Type","application/json"),s.user.auth_token&&i.setRequestHeader("Authorization","Bearer "+s.user.auth_token),i.send()}},{key:"showSaveFiles",value:function(e,n,r){this.dropdown.attr("id","gm-load-dropdown");var o,s,a,l=e.select(".gm-load-append input").node()||(o=e,s=o.insert("div","*").classed("gm-load-append",!0).append("label"),a=s.append("input").attr({type:"checkbox"}),s.append("span").text(" append to current worksheet"),a).node(),u=e.select(".gm-load-list");u.node()||(u=e.append("div").classed("gm-load-list",!0));var c=u.selectAll(".block").data(n),d=c.enter().append("div").classed("block",!0).on("click",function(e){t(this.button).trigger("click"),this.close(),r.loadFromFile(e.save_id,!l.checked,function(){var t=r.getCanvasUrl(location.pathname,{},location.origin);location.href!==t&&window.history.pushState({},document.title,t)})}.bind(this)),h=d.append("p");h.append("span").attr("class","gm-load-title"),h.append("br"),h.append("span").attr("class","gm-load-time"),d.append("span").attr("class","gm-load-delete").on("click",function(t){i.event.stopPropagation(),t.archived?r.unarchiveFile(t):r.archiveFile(t),this.showSaveFiles(e,n,r)}.bind(this)),c.exit().remove(),c.select(".gm-load-title").text(function(t){return t.title}),c.select(".gm-load-time").text(function(t){return(t.archived?"deleted":function(t){var e=Math.abs(t),n=void 0,i=void 0;return e<6e4?(n=Math.round(e/1e3),i="second"):e<36e5?(n=Math.round(e/6e4),i="minute"):e<864e5?(n=Math.round(e/36e5),i="hour"):e<2592e6?(n=Math.round(e/864e5),i="day"):e<31536e6?(n=Math.round(e/2592e6),i="month"):(n=Math.round(e/31536e6),i="year"),0===n?"now":n+" "+i+(n>1?"s":"")+" ago"}(Date.now()-t.updated_at))+(t.save_id===r.meta_data.save_id?" (current file)":"")}),c.select(".gm-load-delete").text(function(t){return t.archived?"undo":"×"}).classed("gm-load-undo",function(t){return t.archived}),c.style("background-color",function(t){return t.archived?"#eee":"white"})}}]),n}(),l="load"}).call(this,n(8),n(6))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.addSaveButton=function(t){var e=new s(t,{label:a,require_user:!0});return t.appendButtonGroup([{type:"dropdown",label:a,data_toggle:"dropdown",pull_right:!0,icon:"glyphicon glyphicon-save-file",html_fn:e.setupMenu.bind(e,t)}])};var r=n(38),o=n(17),s=function(e){function n(){return function(t,e){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,r.ToolbarMenu),i(n,[{key:"loadContent",value:function(e,n,i){var r=this;n.append("h3").text("Save your math!"),n.append("p").text('Click the "Save" button to save your work on the Graspable Math server.'),n.append("p").style("margin-top","1em").text("Title:"),n.append("div").append("input").attr({type:"text",class:"form-control",id:"canvas_title",value:i.meta_data.title||"Graspable Math Canvas"}),n.append("p").style("margin-top","1em").text("Description:"),n.append("textarea").text(i.meta_data.desc||"").attr({class:"form-control",id:"canvas_description"}).style({height:"6em","margin-bottom":"1em",resize:"vertical"});var s=i.meta_data.owner&&o.user.user_id!==i.meta_data.owner,a=void 0,l=void 0,u=n.append("div").style("display",s?"none":null);(l=u.append("input").attr("type","checkbox")).on("change",function(){return a.style("display",l.node().checked?null:"none")}),l.node().checked=i.meta_data&&i.meta_data.public,u.append("span").text(" Publish on GM materials web page."),u.append("br"),a=u.append("span").attr("class","text-muted").style("display",l.node().checked?null:"none").html('(Your math sheet will show up <a target="_blank" href="/materials">here</a> once we have approved it.)'),n.append("p"),n.append("button").property("type","button").classed("btn btn-default",!0).text("Cancel").on("click",function(){t(this.button).trigger("click"),this.close()}.bind(this)),n.append("button").property("type","button").classed("pull-right",!0).property("disabled",s).classed("btn btn-primary",!0).text("Save").on("click",function(){var t=!i.meta_data.save_id;i.meta_data.title=i.container.select("#canvas_title").node().value,i.meta_data.desc=i.container.select("#canvas_description").node().value,i.meta_data.public=l.node().checked,r.showWorking(n),i.save({},r.saveCallback.bind(r,e,n,i,t))}),n.append("button").property("type","button").classed("pull-right",!0).classed("btn btn-primary",!0).property("disabled",!i.meta_data.save_id).style({"margin-right":"1em"}).text("Duplicate").on("click",function(){var t=i.container.select("#canvas_title").node().value;t===i.meta_data.title&&(t+=" (copy)"),i.meta_data.title=t,i.meta_data.desc=i.container.select("#canvas_description").node().value,this.showWorking(n),i.save({clone:!0},this.saveCallback.bind(this,e,n,i,!0))}.bind(this))}},{key:"saveCallback",value:function(t,e,n,i,r){if(r)this.showMessage(t,"Sorry, we could not save the canvas.</br>Reason: "+(r.reason||"?"),"danger");else{if(i){var s=n.getCanvasUrl(location.pathname,{},location.origin);location.href!==s&&window.history.pushState({},document.title,s)}n.updateTitle(),this.showComplete(e,"Saved!"),n.meta_data.public&&function(t,e,n){var i=o.user.display_name||"???",r=!o.user.auto_approved&&e,s=(r?"Approval request":"Check math sheet")+" from "+i,a=i+" "+(e?"created":"updated")+" a mathsheet.\n\nPlease "+(r?"check and approve":"check")+" it.\n\nInstructions:\n\nCheck if the savefile is okay: https://graspablemath.com/canvas?load="+t+".\n";a+=r?"\nIf so, open robomongo, connect to graspablemath.com, and open a shell for the \"gm-save-files\" database.\n\nThen, run the command\ndb.gm_canvas_save_files.update({ 'meta_data.save_id': '"+t+"' }, { $set: { 'meta_data.approved': true }})\n":"\nIf not, open robomongo, connect to graspablemath.com, and open a shell for the \"gm-save-files\" database.\n\nThen, run the command\ndb.gm_canvas_save_files.update({ 'meta_data.save_id': '"+t+"' }, { $set: { 'meta_data.approved': false }})\n\n";var l={toEmail:"contact@graspablemath.com"};l.subject=s,l.body=a;var u=new XMLHttpRequest;u.onreadystatechange=function(){4==u.readyState&&(200==u.status?console.log("Sent approval request."):console.log("Error sending approval request:",u.status,u.responseText))},u.open("POST",n.settings.get("email_server")+"/api/send_email_to",!0),u.setRequestHeader("Content-Type","application/json"),o.user.auth_token&&u.setRequestHeader("Authorization","Bearer "+o.user.auth_token),u.send(JSON.stringify(l))}(n.meta_data.save_id,i,n)}}}]),n}(),a="save"}).call(this,n(8))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.HTMLArrow=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.color=n.color||"silver",this.stroke_width=n.stroke_width||6,this.arrow_width=n.arrow_width||8,this.arrow_length=n.arrow_length||16,this.init(t)}return n(e,[{key:"init",value:function(e){this.div=t.select(e.parentNode).insert("div","*"),this.div.classed("arrow-outer",!0).html(i);var n=e.getBoundingClientRect(),r=e.parentNode.getBoundingClientRect();this.screen_pos={x:n.x+n.width/2,y:n.y+n.height/2};var o={x:this.screen_pos.x-r.x,y:this.screen_pos.y-r.y};console.log(this.screen_pos,o),this.div.style("position","absolute").style("z-index",-1).style("transform","translate("+o.x+"px, "+o.y+"px)"),this.arrow=this.div.select(".arrow-outer"),this.arrow.style("transform-origin","top left"),this.arrow.style("transform","rotate(0deg)"),this.arrow_line=this.div.select(".arrow-line").style({height:this.stroke_width+"px",background:this.color,top:-this.stroke_width/2+"px"}),this.arrow_tip=this.div.select(".arrow-tip").style({"border-bottom":this.arrow_width+"px solid transparent","border-top":this.arrow_width+"px solid transparent","border-left":this.arrow_length+"px solid "+this.color,top:"-"+(this.stroke_width+this.arrow_width)+"px"})}},{key:"pointTo",value:function(t,e){this.render(t-this.screen_pos.x,e-this.screen_pos.y)}},{key:"render",value:function(t,e){var n=Math.atan2(e,t),i=Math.max(0,Math.sqrt(t*t+e*e)-this.arrow_length+1);this.arrow.style("transform","rotate("+n+"rad)"),this.arrow_line.style("width",i+"px"),this.arrow_tip.style("left",i-1+"px")}},{key:"show",value:function(){this.div.style("display",null)}},{key:"hide",value:function(){this.div.style("display","none")}},{key:"remove",value:function(){this.div.remove()}}]),e}();var i='\n<div class="arrow-outer" style="position: absolute; transform-origin: top left">\n  <div class="arrow-line" style="position: relative"></div>\n  <div class="arrow-tip" style="width: 0; height: 0; position: relative"></div>\n</div>\n'}).call(this,n(6))},function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.addFormulaButton=function(t){var e=new h(t,{label:g,require_user:!1});e.canvas=t,t.appendButtonGroup([{type:"dropdown",label:g,data_toggle:"dropdown",pull_right:!0,icon:"glyphicon glyphicon-book",html_fn:e.setupMenu.bind(e,t)}])};var o=n(38),s=n(14),a=n(5),l=n(41),u=n(35),c=n(218),d=[{title:"Quadratic Formula",matches:[{from:"ax^2+bx+c=0",to:"x=(-b±sqrt{b^2-4*a*c})/(2*a)",show:!0},{from:"x^2+x+c=0",to:"x=(-1±sqrt{1^2-4*1*c})/(2*1)"},{from:"x^2-x+c=0",to:"x=(1±sqrt{(-1)^2-4*1*c})/(2*1)"},{from:"-x^2+x+c=0",to:"x=(-1±sqrt{1^2-4*-1*c})/(2*-1)"},{from:"-x^2-x+c=0",to:"x=(1±sqrt{(-1)^2-4*-1*c})/(2*-1)"},{from:"ax^2+x+c=0",to:"x=(-1±sqrt{1^2-4*a*c})/(2*a)"},{from:"ax^2-x+c=0",to:"x=(1±sqrt{(-1)^2-4*a*c})/(2*a)"},{from:"x^2+bx+c=0",to:"x=(-b±sqrt{b^2-4*1*c})/(2*1)"},{from:"-x^2+bx+c=0",to:"x=(-b±sqrt{b^2-4*-1*c})/(2*-1)"}]},{title:"Manually Factoring a Quadratic",one_way:!0,matches:[{from:"x^2+bx+c",to:"(x+⬚)*(x+⬚)",show:!0,from_mapping:{x:"x;x:1","x:1":"x;x:1",b:'⬚;"⬚2"',c:'⬚;"⬚2"'}},{from:"x^2+x+c",to:"(x+⬚)*(x+⬚)",from_mapping:{x:"x;x:1","x:1":"x;x:1",c:'⬚;"⬚2"'}},{from:"x^2-x+c",to:"(x+⬚)*(x+⬚)",from_mapping:{x:"x;x:1","x:1":"x;x:1",c:'⬚;"⬚2"'}}]},{title:"Difference of Squares",eq:"a^2-b^2",eq2:"(a+b)*(a-b)",matches:[{from:"a^2-b^2",to:"(a+b)*(a-b)",show:!0},{from:"-a^2+b^2",to:"(a+b)*(b-a)"},{from:"a^2-1",to:"(a+1)*(a-1)"}]},{title:"Quadratic Binomial",matches:[{from:"a^2-2ab+b^2",to:"(a-b)^2"},{from:"a^2-2ba+b^2",to:"(a-b)^2"},{from:"a^2-2a+1",to:"(a-1)^2"},{from:"a^2-2a+1^2",to:"(a-1)^2"},{from:"a^2+2ab+b^2",to:"(a+b)^2",show:!0},{from:"a^2+2ba+b^2",to:"(a+b)^2"},{from:"a^2+2a+1",to:"(a+1)^2"},{from:"a^2+2a+1^2",to:"(a+1)^2"},{from:"1+2b+b^2",to:"(1+b)^2"},{from:"1^2+2b+b^2",to:"(1+b)^2"},{from:"1+2b+b^2",to:"(1+b)^2"},{from:"1^2-2b+b^2",to:"(1-b)^2"}]}],h=function(e){function n(){return function(t,e){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,o.ToolbarMenu),r(n,[{key:"loadContent",value:function(e,n,i){e.html('<p style="color: gray; font-style: italic">Drag one side of a formula onto a highlighted expression on the canvas to apply it.</p>'),e.style("padding","5px");var r=e.selectAll("div.gm-formula").data(d);r.enter().append("div").classed("gm-formula",!0).html(f).each(function(t){t.el=this}),r.select("label").text(function(t){return t.title}),r.select("div.gm-math1").each(function(t){var e=t.matches.find(function(t){return t.show}).from;t.av1=s.AlgebraView.createStaticExpression(this,e,{h_align:"left",v_align:"bottom",max_font_size:25}),t.av1.main.style("margin","auto")}),r.select("div.eq-arrow").text(function(t){return t.one_way?"⇒":"⇔"}),r.select("div.gm-math2").each(function(t){var e=t.matches.find(function(t){return t.show}).to;t.av2=s.AlgebraView.createStaticExpression(this,e,{h_align:"left",v_align:"bottom",max_font_size:25}),t.av2.main.style("margin","auto")}),r.select(".gm-formula-draggable").call(t.behavior.drag().origin(function(){return{x:0,y:0}}).on("dragstart",this.dragstart.bind(this,i)).on("drag",this.drag.bind(this,i)).on("dragend",this.dragend.bind(this,i)))}},{key:"dragstart",value:function(e,n){n.best_hit=null;var i=t.mouse(n.el)[0]<n.el.getBoundingClientRect().width/2;i?n.av1.interaction_handler.highlight_nodes(n.av1.model.children,!0):n.one_way||n.av2.interaction_handler.highlight_nodes(n.av2.model.children,!0),t.select(n.el).selectAll(".gm-math1,.gm-math2").style("background",function(t,e){return i===(0===e)?"#eee":null}).style("border",function(t,e){return i===(0===e)?"1px solid silver":"1px solid transparent"}),n.arrow=new c.HTMLArrow(t.select(n.el).select(i?".gm-math1":".gm-math2").node()),t.select("html").style("cursor","none"),n.action_infos=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.model.getElementsOfType("derivation").map(function(e){var i=e.getLastRow(),r={der_row:i,actions:[]};return t.forEach(function(t){var e=t.from,o=t.to,s=t.from_mapping,a=t.to_mapping,l=n?p(i.model,e,o,s):p(i.model,o,e,a);r.actions=r.actions.concat(l)}),r})}(n.matches,e,i),n.action_infos.forEach(function(e){var n=e.der_row.view,i=t.mouse(n.main.node());e.offset={x:i[0],y:i[1]},u.HitTester.setTargetRegions(e.actions,n.settings.get("font_size"),n.getBBox({no_padding:!0}),!1),u.HitTester.drawDropAreaHints(n.main,e.actions)})}},{key:"drag",value:function(e,n){var i=[];n.action_infos.forEach(function(e){e.der_row.view;var n={x:t.event.x-.5+e.offset.x,y:t.event.y-.5+e.offset.y,width:1,height:1},r=u.HitTester.getHits(e.actions,n);i=i.concat(r)}),n.arrow.pointTo(t.event.sourceEvent.x,t.event.sourceEvent.y);var r=u.HitTester.getHighestPriorityHit(i,{x:0,y:0,width:0,height:0});n.best_hit=r,n.action_infos.forEach(function(t){r&&-1!==t.actions.indexOf(r)?u.HitTester.drawDestinationHints(t.der_row.view.main,r):u.HitTester.drawDestinationHints(t.der_row.view.main)})}},{key:"dragend",value:function(e,n){if(n.action_infos.forEach(function(t){var e=t.der_row.view;u.HitTester.drawDropAreaHints(e.main),u.HitTester.drawDestinationHints(e.main)}),n.arrow.remove(),t.select("html").style("cursor",null),t.select(n.el).selectAll(".gm-math1,.gm-math2").style("background",null).style("border","1px solid transparent"),n.av1.interaction_handler.highlight_nodes([],!0),n.av2.interaction_handler.highlight_nodes([],!0),n.best_hit){var r=n.best_hit.oldTree;r.startInteraction();var o=r.performAction(n.best_hit);o&&o.newTree&&o.newTree.finishInteraction(),r.for_each(function(t){return t.selected=!1}),r.hide_nodes(),i(this.button).trigger("click"),this.close()}}}]),n}();function p(t,e,n,i){var r=[new a.AlgebraModel(e),new a.AlgebraModel(n)],o=t.getMoveActions(r,[new l.ApplyFormulaAction]);return o.forEach(function(t){return t.settings.mapping=i}),o}var f="<label></label>\n<div class='gm-formula-draggable' style='display: flex; flex-direction: row; align-items: center; justify-content: space-between; margin-bottom: 1em'>\n  <div style='flex: 1'><div class='gm-math1' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n  <div class='eq-arrow' style='flex-grow: 0; color: black; text-align: center; font-family: Kalam; font-size: 22px'></div>\n  <div style='flex: 1'><div class='gm-math2' style='border: 1px solid transparent; margin: 0 0.5rem; padding: 1rem 0'></div></div>\n</div>",g="formulas"}).call(this,n(6),n(8))},function(t,e,n){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.addInsertButton=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new o(t,e,n)};var r={derivation:{label:"Math Expression",value:"derivation",icon:"imgs/menu-icons/sqrt-x.png"},function:{label:"Function",value:"function",icon:"imgs/menu-icons/sqrt-x.png"},homework:{label:"Homework Problem",value:"homework",class:"glyphicon glyphicon-book",cond:function(t){return t.settings.get("homework_btn")}},textbox:{label:"Text",value:"textbox",icon:"imgs/menu-icons/text.png"},video:{label:"Youtube Video",value:"video",class:"glyphicon glyphicon-film"},ggb_graphing:{label:"Graphing",value:"ggb-graphing",icon:"imgs/3rd-party/ggb-graphing.svg"},ggb_geometry:{label:"Geometry",value:"ggb-geometry",icon:"imgs/3rd-party/ggb-geometry.svg"},ggb_3d:{label:"Geometry 3D",value:"ggb-3d",icon:"imgs/3rd-party/ggb-3d.svg"},table:{label:"Table",value:"table",icon:null},"ggb-table":{label:"Table-Graph",value:"ggb-table",icon:"imgs/menu-icons/geogebra.svg"}},o=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(var o in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t,this.resource_path=n,this.menu_items=[{label:"select one:",header:!0}],r)i&&(!i[o]||r[o].cond&&!r[o].cond(this.canvas))||this.menu_items.push(r[o]);this.canvas.appendButtonGroup([{type:"dropdown",label:"insert",icon:"glyphicon glyphicon-plus-sign",html_fn:this.setupInsertMenu.bind(this)}],null,!0).select("button").style("border-radius","3px")}return i(e,[{key:"performAction",value:function(e){"homework"===e.value?setTimeout(function(){return t("button#problems").trigger("click")},0):this.canvas.controller.insertElementFromInsertButton(e.value)}},{key:"setupInsertMenu",value:function(t,e){var i=this,r=n.select(t).append("ul"),o=r.selectAll("li").data(this.menu_items).enter().append("li"),s=o.filter(function(t){return t.header}),a=o.filter(function(t){return!t.header});s.classed("dropdown-header",!0).text(function(t){return t.label});var l=a.append("a").attr("href","#").style("padding","10px 20px").on("click",function(t){n.event.preventDefault(),i.performAction(t)}),u={"vertical-align":"bottom",position:"relative",height:"1.8em",left:"-0.5em",top:"0.15em"};return l.filter(function(t){return t.icon}).append("img").style(u).style("opacity",.5).attr("src",function(t){return i.resource_path+t.icon}),l.filter(function(t){return!t.icon}).append("span").style(u).style("width","1.8em").style("display","inline-block").style("opacity",.5).attr("class",function(t){return t.class||null}),l.append("span").text(function(t){return t.label}),r.node()}}]),e}()}).call(this,n(8),n(6))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.holdUI=void 0;var i=n(7),r=n(5),o=n(14);e.holdUI=function(){var e=function(e,n){this.container=t.select("body"),this.controller=e,this.view=n,this.element=null,this.pos=[0,0],this.visible=!1,this.buttons=[],this.button_els=null,this.colors=t.scale.category10(),this.button_rads=null,this.inner_radius=20,this.outer_radius=80,this.init()};return e.prototype.setPos=function(t){this.pos=t,this.icon.style({left:this.pos[0]+22+"px",top:this.pos[1]-32+"px"}),this.element.style({left:t[0]-this.outer_radius+"px",top:t[1]-this.outer_radius+"px"})},e.prototype.setVisible=function(t){if(this.visible=t,this.icon.style("display",t?null:"none"),this.element.style("display",t?null:"none"),this.visible){var e=this.g.node().getBBox();this.element.style({width:e.width,height:e.height})}},e.prototype.init=function(){var e=this,n={stroke:"black","stroke-width":1,"stroke-linecap":"round",fill:"none"};i.array.includes(this.controller.hold_menu_options(),"derivation")&&this.buttons.push({action:function(t){e.controller.inputDL(t,"holdUI")},icon:function(t){e.icon=e.container.append("div").style("position","absolute").style("z-index",60).style({left:e.pos[0]+25+"px",top:e.pos[1]-35+"px"});var n=new r.AlgebraModel("f_x",{});return new o.AlgebraView(n,e.icon.node(),{font_size:"35",inactive_color:"black",interactive:!1}).init(),e.icon},color:e.colors(0)}),i.array.includes(this.controller.hold_menu_options(),"graph")&&this.buttons.push({action:function(t){e.controller.insertGGB(t,"graphing")},icon:function(t){var e=t.append("g").attr("transform","translate(2,0)").style("cursor","pointer"),i=e.append("g").style("opacity",.5).style("shape-rendering","crispedges");return i.append("line").attr({x1:-15,y1:0,x2:15,y2:0}).style(n),i.append("line").attr({x1:0,y1:-15,x2:0,y2:15}).style(n),i.append("rect").attr({x:-15,y:-15,width:30,height:30}).style(n),e.append("line").attr({x1:-15,y1:8,x2:15,y2:-8}).style(n).style("stroke-width",1.5),e},color:e.colors(1)}),i.array.includes(this.controller.hold_menu_options(),"textbox")&&this.buttons.push({action:function(t){var n={pos:{x:t.x,y:t.y},select_text_on_create:!0};e.view.createElement("textbox",n)},icon:function(t){var e=t.append("g");return e.append("g").style("opacity",.5).append("text").text("Aa").attr({x:0,y:10}).style("text-anchor","middle").style("font-size","30px").style(n).style("stroke","none").style("fill","black").style("pointer-events","none"),e},color:e.colors(2)}),this.button_rads=2*Math.PI/this.buttons.length;var s=this.button_rads,a=this.inner_radius,l=this.outer_radius;this.element=this.container.append("svg").style("overflow","visible").style("display","none").style("position","absolute"),this.g=this.element.append("g").attr("transform","translate("+this.outer_radius+","+this.outer_radius+")");var u=this.element.append("defs").append("filter").attr("id","dropShadow_holdUI");u.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",3),u.append("feOffset").attr("dx",0).attr("dy",4).attr("result","offsetblur"),u.append("feComponentTransfer").append("feFuncA").attr("type","linear").attr("slope",.25);var c=u.append("feMerge");c.append("feMergeNode"),c.append("feMergeNode").attr("in","SourceGraphic"),this.element.attr("filter","url(#dropShadow_holdUI)"),this.button_els=this.g.selectAll(".holdUI").data(this.buttons),this.button_els.enter().append("g").classed("holdUI",!0).append("path").attr("d",function(t,e){var n=Math.cos(s*e)*a,i=-Math.sin(s*e)*a,r=Math.cos(s*e)*l,o=-Math.sin(s*e)*l,u=Math.cos(s*(e+1))*l,c=-Math.sin(s*(e+1))*l,d=Math.cos(s*(e+1))*a,h=-Math.sin(s*(e+1))*a;return"M"+n+","+i+"L"+r+","+o+"A"+l+","+l+" 0 0,0 "+u+","+c+"L"+d+","+h+"A"+a+","+a+" 0 0,1 "+n+","+i+"Z"}).style("fill",function(t){return t.color}).style("opacity",.8).style("cursor","pointer"),this.button_els.each(function(e,n){var i=t.select(this);e.icon(i).attr("transform",function(){return"translate("+Math.cos(s*(n+.5))*(a+(l-a)/2)+", "+-Math.sin(s*(n+.5))*(a+(l-a)/2)+")"})})},e.prototype.detectHit=function(t){var e=this,n=this.button_rads,i=this.inner_radius,r=this.outer_radius,o=-1;return this.button_els.each(function(s,a){var l=Math.sqrt(Math.pow(t[0]-e.pos[0],2)+Math.pow(t[1]-e.pos[1],2)),u=Math.atan2(-t[1]+e.pos[1],t[0]-e.pos[0]);u<0&&(u+=2*Math.PI),l>i&&l<r&&u>n*a&&u<n*(a+1)&&(o=a)}),o},e.prototype.highlight=function(e){var n=this.detectHit(e);this.button_els.each(function(e,i){var r=t.select(this).select("path");n===i?r.transition().duration(30).style("fill",t.rgb(e.color).brighter(.6)):r.transition().duration(30).style("fill",e.color)})},e.prototype.performAction=function(t,e){var n=this.detectHit(t);this.button_els.each(function(t,i){i===n&&t.action({x:e[0],y:e[1]})})},e}()}).call(this,n(6))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.DataLogger=s;var i=n(0),r=n(55),o=n(17);function s(e,n){this.id=i.gmath.uid(),this.events=t.dispatch("interaction"),this.listening=!0,this.log_mouse_trajectories=n,this.trial_id=null,this.canvas_logger=new r.CanvasLogger(this,e),this.canvas=e,i.gmath.TrialLogger.events.on("start_trial."+this.id,this.setTrialInfo.bind(this)),i.gmath.TrialLogger.trial&&this.setTrialInfo(i.gmath.TrialLogger.trial)}i.gmath.DataLogger=s,s.console_logs=!1,s.interaction_id=1,s.prototype.setTrialInfo=function(t){t.id!==this.trial_id&&(s.interaction_id=1),this.trial_id=t.id},s.prototype.listen=function(t){this.listening=!!t},s.prototype.logInteractionWithEvents=function(t,e,n){this.trial_id||this.createMissingTrial(),t.trial_id=this.trial_id,t.interaction_id=s.interaction_id,t.canvas_id=this.canvas.id,t.canvas_save_id=this.canvas.meta_data.save_id,t.user_id||(t.user_id=o.user.logged_in?o.user.user_id:null),e.forEach(function(t,e){t.trial_id=this.trial_id,t.interaction_id=s.interaction_id,t.within_interaction_id=e+1},this),n&&(e=n(e)),s.console_logs&&console.log(t,e),this.listening&&(this.emitReleventSummaryEvents([t],e),i.gmath.ServerComm.postInteractions([t].concat(e))),s.interaction_id++},s.prototype.logInteraction=function(t){this.trial_id||this.createMissingTrial(),t.trial_id=this.trial_id,t.interaction_id=s.interaction_id++,t.canvas_id=this.canvas.id,t.canvas_save_id=this.canvas.meta_data.save_id,t.user_id||(t.user_id=o.user.logged_in?o.user.user_id:null),s.console_logs&&console.log(t),this.listening&&(this.emitReleventSummaryEvents([t]),i.gmath.ServerComm.postInteractions([t]))},s.prototype.logCustomInteraction=function(t,e){this.trial_id||this.createMissingTrial();var n={trial_id:this.trial_id,interaction_id:s.interaction_id++,canvas_id:this.canvas.id,canvas_save_id:this.canvas.meta_data.save_id,user_id:o.user.logged_in?o.user.user_id:null,type:"custom",subtype:t,time:Date.now()};i.gmath.extend(n,e),s.console_logs&&console.log(n),i.gmath.ServerComm.postInteractions([n])},s.prototype.createMissingTrial=function(){console.warn("Should start a trial before logging data! Auto-created a trial."),i.gmath.TrialLogger.startTrial(),i.gmath.TrialLogger.postTrial()},s.prototype.emitReleventSummaryEvents=function(t,e){var n=t.filter(function(t){return"interaction"===t.type});n.length>0&&this.events.interaction(n,e)},s.prototype.simulateStartOfInteraction=function(t,e){var n={type:"start-of-interaction",source:t,time:Date.now()};e&&(n=i.gmath.extend(n,e)),this.canvas_logger.startOfInteractionDetected(n)},s.prototype.simulateEndOfInteraction=function(t,e){var n={type:"end-of-interaction",source:t,time:Date.now()};e&&(n=i.gmath.extend(n,e)),this.canvas_logger.endOfInteractionDetected(n)}}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasLogger=s;var i=n(0),r=n(94),o=n(7);function s(t,e){this.data_logger=t,this.interactionSequence=[],this.dlLoggers=[],this.setupListeners(e)}i.gmath.CanvasLogger=s,s.prototype.startOfInteractionDetected=function(t){this.data_logger.listening&&(t.source&&t.source.settings&&t.source.settings.get("dont_log_events")||(this.containsPendingEvents(this.interactionSequence)&&this.submitCurrentSequence(),this.addEvent(t)))},s.prototype.canvasTouchDetected=function(t){this.data_logger.listening&&(t.source&&t.source.settings&&t.source.settings.get("dont_log_events")||this.addEvent(t))},s.prototype.reset=function(){this.dlLoggers=[]},s.prototype.endOfInteractionDetected=function(t){this.data_logger.listening&&(t.source&&t.source.settings&&t.source.settings.get("dont_log_events")||(this.addEvent(t),this.interactionSequence[0].source&&this.interactionSequence[0].source.type!==this.interactionSequence[this.interactionSequence.length-1].source.type||this.submitCurrentSequence()))},s.prototype.addEvent=function(t){this.data_logger.listening&&(t.source&&t.source.settings&&t.source.settings.get("dont_log_events")||(t.time=Date.now(),t.date=(new Date).toString(),t.source&&t.source.model&&t.source.model.to_ascii&&(t.source.model=t.source.model.to_ascii()),this.interactionSequence.push(t)))},s.prototype.submitCurrentSequence=function(){this.summarizeInteractionSequence(this.interactionSequence).forEach(function(t){this.data_logger.logInteraction(t)},this),this.interactionSequence=[]},s.prototype.summarizeInteractionSequence=function(t){try{return this.isNullSequence(t)?[]:this.isMoveSequence(t)?this.summarizeMoveSequence(t):this.isResizeSequence(t)?this.summarizeResizeSequence(t):this.isCreateSequence(t)?this.summarizeCreateSequence(t):this.isCreateDuringActionSequence(t)?this.summarizeCreateDuringActionSequence(t):this.isGeometryCreateSequence(t)?this.summarizeGeometryCreateSequence(t):this.isDeleteSequence(t)?this.summarizeDeleteSequence(t):this.isGeometryDeleteSequence(t)?this.summarizeGeometryDeleteSequence(t):this.isDrawSequence(t)?this.summarizeDrawSequence(t):this.isEraseSequence(t)?this.summarizeEraseSequence(t):this.isNodeInspectSequence(t)?this.summarizeNodeInspectSequence(t):this.isGraphScrubSequence(t)?this.summarizeGraphScrubSequence(t):this.isPackSequence(t)?this.summarizePackSequence(t):this.isLinkSequence(t)?this.summarizeLinkSequence(t):this.isCloneSequence(t)?this.summarizeCloneSequence(t):this.isGraphPanSequence(t)?this.summarizeGraphPanSequence(t):this.isButtonSequence(t)?this.summarizeButtonSequence(t):this.isGraphZoomSequence(t)?this.summarizeGraphZoomSequence(t):this.isFontSizeSequence(t)?this.summarizeFontSizeSequence(t):this.isTextEditSequence(t)?this.summarizeTextEditSequence(t):(console.warn("(CanvasLogger) Interaction did not match any defined interaction types."),this.interactionSequence=[],[])}catch(t){return console.warn("(CanvasLogger) Error when summarizing interaction sequence:",t),i.gmath.sendErrorReport("Error when summarizing interaction sequence.",(0,o.getStackTrace)()),this.dlLoggers.forEach(function(t){return t.on_error(null,!1)}),this.interactionSequence=[],[]}},s.prototype.containsPendingEvents=function(t){return!!t.length},s.prototype.isDifferentInteraction=function(t,e){if(!t.length)return!1;var n=!1;return e.element.id&&(n=n||t.some(function(t){return!t.element||!t.element.id||t.element.id!==e.element.id})),e.type&&(n=n||t.some(function(t){return!t.type||t.type!==e.type})),n},s.prototype.setupListeners=function(t){this.registerToolbarListeners(t,this.canvasToolbarListener.bind(this)),this.registerCanvasModelViewListeners(t.model,this.canvasModelViewListener.bind(this)),this.registerCanvasControllerListeners(t.controller,this.canvasControllerListener.bind(this))},s.prototype.registerToolbarListeners=function(t,e){t.events.on("button."+this.session_id,e)},s.prototype.canvasToolbarListener=function(t){this.containsPendingEvents(this.interactionSequence)&&this.submitCurrentSequence(),t.type="toolbar_button_press",this.addEvent(t),this.submitCurrentSequence()},s.prototype.registerCanvasModelViewListeners=function(t,e){var n=this;t.on("create."+this.session_id,e).on("remove."+this.session_id,e),t.dls().forEach(function(t){n.setupListenersOnDL(t)})},s.prototype.canvasModelViewListener=function(t){"create"===t.type&&this.objectCreationDetected(t),"remove"===t.type&&this.objectDeletionDetected(t)},s.prototype.registerCanvasControllerListeners=function(t,e){t.on("start-of-interaction."+this.session_id,e).on("touch."+this.session_id,e).on("end-of-interaction."+this.session_id,e)},s.prototype.canvasControllerListener=function(t){t.length&&(t=t[0]),"start-of-interaction"===t.type&&this.startOfInteractionDetected(t),"end-of-interaction"===t.type&&this.endOfInteractionDetected(t),"touch"===t.type&&this.canvasTouchDetected(t)},s.prototype.objectCreationDetected=function(t){if(!(t.target&&t.target.settings&&t.target.settings.get("dont_log_events"))&&"link"!==t.target_type){"derivation"===t.target_type&&this.setupListenersOnDL(t.target),"graph"===t.target_type&&this.setupListenersOnGraph(t.target),"textbox"===t.target_type&&this.setupListenersOnTextBox(t.target);var e={type:"GM_object_created_or_added"};e.method=t.method,e.element={type:t.target_type,id:t.target.id},"derivation"===t.target_type&&(e.element.new_state=t.target.settings.get("eq"),e.element.options=t.target.settings.getModified()),"textbox"===t.target_type&&t.target.settings.get("text")!==t.target.settings.parent.get("text")&&(e.element.new_state=t.target.settings.get("text")),"image"===t.target_type&&t.target.settings.get("url")&&(e.element.new_state=t.target.settings.get("url")),this.addEvent(e),1===this.interactionSequence.length&&this.submitCurrentSequence()}},s.prototype.objectDeletionDetected=function(t){if(!(t.target&&t.target.settings&&t.target.settings.get("dont_log_events"))){var e={type:"GM_object_removed"};e.element={type:t.target_type,id:t.target.id,options:t.target.settings?i.gmath.deepCopy(t.target.settings.getAll()):null},this.addEvent(e),1===this.interactionSequence.length&&(this.interactionSequence=[])}},s.prototype.setupListenersOnDL=function(t){this.registerListenersOnEvents(t.events,this.DLListener.bind(this)),this.dlLoggers.push(new r.DLLogger(this.data_logger,t))},s.prototype.registerListenersOnEvents=function(t,e){t.on("inspect_node."+this.session_id,e).on("pack_state."+this.session_id,e)},s.prototype.DLListener=function(t){t.length&&(t=t[0]),"removed"===t.type&&this.ignoreDerivationInteraction(t),"inspect"===t.type&&this.nodeInspectionDetected(t),"packState"===t.type&&this.packStateDetected(t)},s.prototype.ignoreDerivationInteraction=function(t){var e=this.dlLoggers.find(function(e){return e.dl===t.performee});e&&(e.clearData(),e.interaction="ignore")},s.prototype.nodeInspectionDetected=function(t){var e={type:"node_inspected"};e.element={type:"derivation",id:t.dl.id},e.inspection={row:t.row,model:t.dl.rows[t.row].model.to_ascii(),sel:t.node.get_root().getSelectorOfNodes(t.node)},this.addEvent(e)},s.prototype.packStateDetected=function(t){var e={type:"derivation_list_pack_state_changed"};e.element={type:"derivation",id:t.performee},e.state=t.packState,this.addEvent(e)},s.prototype.setupListenersOnGraph=function(t){this.registerListenersOnGraph(t,this.graphListener.bind(this))},s.prototype.registerListenersOnGraph=function(t,e){t.events.on("create_geom."+this.session_id,e).on("remove_geom."+this.session_id,e).on("geom_attr."+this.session_id,e).on("zoom."+this.session_id,e)},s.prototype.graphListener=function(t){"graphElementCreate"!==t.type&&"graphElementChange"!==t.type||this.graphElementDetected(t),"graphElementRemove"===t.type&&this.graphElementDeletionDetected(t),"zoom"===t.type&&this.graphPanZoomDetected(t)},s.prototype.graphElementDetected=function(t){var e={};e.type="graphElementCreate"===t.type?"graph_element_created":"graph_element_changed",e.element={type:"graph",id:t.graph_id};var n=t.performee_object.summarize();delete n.id,delete n.type,e.graph_element={type:t.performee_type||t.performee_object.type,id:t.performee,attr:n},this.addEvent(e)},s.prototype.graphElementDeletionDetected=function(t){var e={type:"graph_element_removed"};e.element={type:"graph",id:t.graph_id},e.graph_element={type:t.performee_type,id:t.performee,attr:t.performee_object},this.addEvent(e)},s.prototype.graphPanZoomDetected=function(t){var e={type:"graph_pan_zoom"};e.element={type:"graph",id:t.performee,new_state:{pan:t.translate,zoom:t.scale}},this.isDifferentInteraction(this.interactionSequence,e)&&this.submitCurrentSequence(),this.addEvent(e)},s.prototype.setupListenersOnTextBox=function(t){this.registerListenersOnTextBox(t,this.textboxListener.bind(this))},s.prototype.registerListenersOnTextBox=function(t,e){t.events.on("text."+this.session_id,e).on("font_size."+this.session_id,e)},s.prototype.textboxListener=function(t){("text"===t.type&&this.isDifferentInteraction(this.interactionSequence,t)||"font_size"===t.type&&this.containsPendingEvents(this.interactionSequence))&&this.submitCurrentSequence(),this.addEvent(t),"font_size"===t.type&&this.submitCurrentSequence()},s.prototype.isNullSequence=function(t){return!!(t.every(function(t){return"start-of-interaction"===t.type&&"CanvasController"===t.source.type||"end-of-interaction"===t.type})||t.every(function(t){return"start-of-interaction"===t.type&&"AlgebraModel"===t.source.type||"end-of-interaction"===t.type})||t.every(function(t){return"start-of-interaction"===t.type&&"DerivationRow"===t.source.type||"end-of-interaction"===t.type})||t.every(function(t){return"start-of-interaction"===t.type&&("derivation"===t.source.type||"Graph"===t.source.type||"textbox"===t.source.type)||"end-of-interaction"===t.type})&&(this.startAndEndPositionsAreTheSame(t)||this.startAndEndSizesAreTheSame(t))||t.every(function(t){return"start-of-interaction"===t.type&&"Graph"===t.source.type&&"touch"===t.subSource||"end-of-interaction"===t.type})||t.every(function(t){return"start-of-interaction"===t.type&&"DerivationRow"===t.source.type||"GM_object_created_or_added"===t.type&&"textbox"===t.element.type||"end-of-interaction"===t.type})&&t.some(function(t){return"start-of-interaction"===t.type}))},s.prototype.startAndEndPositionsAreTheSame=function(t){var e=t[0],n=t[t.length-1];if(!e.pos||!n.pos)return!1;var i=Array.isArray(e.pos)?e.pos:[e.pos.x,e.pos.y],r=Array.isArray(n.pos)?n.pos:[n.pos.x,n.pos.y];return i[0]===r[0]&&i[1]===r[1]},s.prototype.startAndEndSizesAreTheSame=function(t){var e=t[0],n=t[t.length-1];return!(!e.size||!n.size)&&e.size.width===n.size.width&&n.size.height==n.size.height},s.prototype.isCreateSequence=function(t){return t.every(function(t){return"start-of-interaction"===t.type&&"CanvasController"===t.source.type||"GM_object_created_or_added"===t.type&&"path"!==t.element.type||"end-of-interaction"===t.type})},s.prototype.isCreateDuringActionSequence=function(t){return t.some(function(t){return"start-of-interaction"===t.type&&"AlgebraModel"===t.source.type})&&t.some(function(t){return"GM_object_created_or_added"===t.type&&"path"!==t.element.type})},s.prototype.isGeometryCreateSequence=function(t){return t.every(function(t){return"start-of-interaction"===t.type&&"Graph"===t.source.type||"graph_element_created"===t.type||"graph_element_changed"===t.type||"end-of-interaction"===t.type})&&t.some(function(t){return"graph_element_created"===t.type})},s.prototype.isDeleteSequence=function(t){return t.every(function(t){return"start-of-interaction"===t.type||"GM_object_removed"===t.type&&"path"!==t.element.type||"node_inspected"===t.type||"end-of-interaction"===t.type})&&t.some(function(t){return"GM_object_removed"===t.type})},s.prototype.isGeometryDeleteSequence=function(t){return t.every(function(t){return"start-of-interaction"===t.type&&"Graph"===t.source.type||"graph_element_removed"===t.type||"graph_element_changed"===t.type||"end-of-interaction"===t.type})&&t.some(function(t){return"graph_element_removed"===t.type})},s.prototype.isDrawSequence=function(t){return t.some(function(t){return"touch"===t.type&&"draw"===t.subtype})},s.prototype.isEraseSequence=function(t){return t.some(function(t){return"touch"===t.type&&"erase"===t.subtype})},s.prototype.isNodeInspectSequence=function(t){return t.every(function(t){return"start-of-interaction"===t.type&&"AlgebraModel"===t.source.type||"node_inspected"===t.type||"end-of-interaction"===t.type})},s.prototype.isGraphScrubSequence=function(t){return t.every(function(t){return"start-of-interaction"===t.type&&"Graph"===t.source.type||"model_changed"===t.type&&"number_scrub"===t.change.type||"graph_element_changed"===t.type||"end-of-interaction"===t.type})},s.prototype.isMoveSequence=function(t){return t.every(function(t){return"start-of-interaction"===t.type&&("derivation"===t.source.type||"Graph"===t.source.type||"textbox"===t.source.type||"image"===t.source.type)&&t.pos||"end-of-interaction"===t.type})},s.prototype.isResizeSequence=function(t){return t.every(function(t){return"start-of-interaction"===t.type&&("textbox"===t.source.type||"image"===t.source.type)&&t.size||"end-of-interaction"===t.type})},s.prototype.isPackSequence=function(t){return t.every(function(t){return"start-of-interaction"===t.type||"derivation_list_pack_state_changed"===t.type||"end-of-interaction"===t.type})},s.prototype.isLinkSequence=function(t){return t.every(function(t){return"start-of-interaction"===t.type&&"Graph"===t.source.type||"GM_object_created_or_added"===t.type&&"derivation"===t.element.type||"end-of-interaction"===t.type})||t.every(function(t){return"start-of-interaction"===t.type&&"DerivationRow"===t.source.type||"graph_element_created"===t.type||"end-of-interaction"===t.type})},s.prototype.isCloneSequence=function(t){return t.every(function(t){return"start-of-interaction"===t.type&&"DerivationRow"===t.source.type||"GM_object_created_or_added"===t.type&&(!t.element||"derivation"===t.element.type)||"end-of-interaction"===t.type})},s.prototype.isGraphPanSequence=function(t){return t.every(function(t){return"start-of-interaction"===t.type||"graph_pan_zoom"===t.type||"end-of-interaction"===t.type})&&t.some(function(t){return"start-of-interaction"===t.type})},s.prototype.isButtonSequence=function(t){return t.every(function(t){return"toolbar_button_press"===t.type})||t.some(function(t){return"toolbar_button_press"===t.type&&("undo"===t.button.label||"redo"===t.button.label)})},s.prototype.isGraphZoomSequence=function(t){return t.every(function(t){return"graph_pan_zoom"===t.type})},s.prototype.isFontSizeSequence=function(t){return t.every(function(t){return"font_size"===t.type})},s.prototype.isTextEditSequence=function(t){return t.every(function(t){return"text"===t.type})},s.prototype.fillSummaryWithTimeAndCanvasId=function(t,e,n){t.time=e.time,t.dur=n.time-e.time},s.prototype.summarizeCreateSequence=function(t){for(var e=t[0],n=t[t.length-1],i=[],r=1;r<t.length-1;r++){var o=t[r],s={type:"interaction",subtype:"create",el_id:o.element.id,el_type:o.element.type,method:o.method};o.element.new_state&&(s.new_state=o.element.new_state),o.element.options&&(s.options=o.element.options),this.fillSummaryWithTimeAndCanvasId(s,e,n),i.push(s)}return i},s.prototype.summarizeCreateDuringActionSequence=function(t){var e=this.summarizeCreateSequence(t.filter(function(e,n){return 0===n||n===t.length-1||"GM_object_created_or_added"===e.type})),n=this.dlLoggers.find(function(e){return e.dl.getRowByModel(t[0].source)});return n?(e.forEach(function(t){return n.element_created(t)}),[]):[]},s.prototype.summarizeGeometryCreateSequence=function(t){var e={type:"interaction",subtype:"create"},n=t[0],i=t[t.length-1];this.fillSummaryWithTimeAndCanvasId(e,n,i);var r=t.filter(function(t){return"graph_element_created"===t.type});r=r[r.length-1];var o=t.filter(function(t){return"graph_element_changed"===t.type});return o.length&&(r=o[0]),e.targets=[{type:"graph",id:r.element.id,subtype:r.graph_element.type,subid:r.graph_element.id,new_state:r.graph_element.attr}],"point"===e.targets[0].subtype?e.method="hold":e.method="hold-drag",[e]},s.prototype.summarizeDeleteSequence=function(t){var e=t[0],n=t[t.length-1],r=i.gmath.find(t,function(t){return"GM_object_removed"===t.type}),o={type:"interaction",subtype:"delete",method:"tap",el_id:r.element.id,el_type:r.element.type};return this.fillSummaryWithTimeAndCanvasId(o,e,n),[o]},s.prototype.summarizeGeometryDeleteSequence=function(t){var e={type:"graph",subtype:"delete",method:"tap"},n=t[1],i=(t[t.length-1],t[0]);return this.fillSummaryWithTimeAndCanvasId(e,i,n),delete i.graph_element.attr.id,delete i.graph_element.attr.type,e.element={type:i.element.type,id:i.element.id,subtype:i.graph_element.type,subid:i.graph_element.id,old_state:i.graph_element.attr},[e]},s.prototype.summarizeDrawSequence=function(t){var e={type:"interaction",subtype:"draw",method:"drag"},n=t[0],i=t[t.length-1];this.fillSummaryWithTimeAndCanvasId(e,n,i);var r=t.find(function(t){return"GM_object_created_or_added"===t.type});return e.el_id=r.element.id,e.el_type=r.element.type,[e]},s.prototype.summarizeEraseSequence=function(t){var e={type:"interaction",subtype:"erase",method:"drag"},n=t[0],i=t[t.length-1];return this.fillSummaryWithTimeAndCanvasId(e,n,i),[e]},s.prototype.summarizeNodeInspectSequence=function(t){var e=t[0],n=t[t.length-1],i=t[1],r={type:"interaction",subtype:"inspect",method:"tap",el_id:i.element.id,el_type:"derivation",el_subid:i.inspection.row,el_subtype:"row",sel_ascii:i.inspection.sel};return this.fillSummaryWithTimeAndCanvasId(r,e,n),[r]},s.prototype.summarizeGraphScrubSequence=function(t){var e={type:"graph",subtype:"scrub",method:"drag"},n=t[0],i=t[t.length-1];this.fillSummaryWithTimeAndCanvasId(e,n,i);var r=t.filter(function(t){return"graph_element_changed"===t.type})[0],o=n.source.selection;return delete o.id,delete o.type,e.element={type:"graph",id:r.element.id,subtype:r.graph_element.type,subid:r.graph_element.id,old_state:n.source.selection,new_state:r.graph_element.attr},[e]},s.prototype.summarizeMoveSequence=function(t){var e=t[0],n=t[t.length-1],i={type:"interaction",subtype:"move",method:"drag",el_id:e.source.id,el_type:e.source.type,old_state:JSON.stringify(e.pos),new_state:JSON.stringify(n.pos)};return this.fillSummaryWithTimeAndCanvasId(i,e,n),[i]},s.prototype.summarizeResizeSequence=function(t){var e=t[0],n=t[t.length-1],i={type:"interaction",subtype:"resize",method:"drag",el_id:e.source.id,el_type:e.source.type,old_state:JSON.stringify(e.size),new_state:JSON.stringify(n.size)};return this.fillSummaryWithTimeAndCanvasId(i,e,n),[i]},s.prototype.summarizePackSequence=function(t){var e={type:"interaction",subtype:"pack-dl",method:"drag"},n=t[0],i=t[t.length-1];this.fillSummaryWithTimeAndCanvasId(e,n,i);var r=t[t.length-2];return e.element={type:"derivation",id:r.element.id,subtype:"dl-row",subid:n.source?n.source.row:8675309,old_state:n.source?n.source.packState:i.source.packState,new_state:i.source.packState},[e]},s.prototype.summarizeLinkSequence=function(t){var e={type:"interaction",subtype:"link",method:"drag"},n=t[0],i=t[t.length-1];this.fillSummaryWithTimeAndCanvasId(e,n,i);var r=t[1];return"DerivationRow"===n.source.type?(e.element={type:"derivation",id:n.source.id,subtype:"dl-row",subid:n.source.row,sel:n.source.model},e.targets=[{type:"graph",id:r.element.id,subtype:r.graph_element.type,subid:r.graph_element.id,new_state:r.graph_element.attr}]):(e.element={type:"graph",id:n.source.id,subtype:n.source.selection.type,subid:n.source.selection.id},e.targets=[{type:"derivation",id:r.element.id,new_state:r.element.new_state}]),[e]},s.prototype.summarizeCloneSequence=function(t){var e=t[0],n=t[t.length-1],i=t[1],r={type:"interaction",subtype:"clone",method:"drag",el_id:e.source.id,el_type:"derivation",el_subid:e.source.row,el_subtype:"row",target_id:i.element.id,target_type:i.element.type,new_state:i.element.new_state,pos:i.element.pos};return this.fillSummaryWithTimeAndCanvasId(r,e,n),[r]},s.prototype.summarizeGraphPanSequence=function(t){var e={type:"graph",subtype:"pan",method:"drag"},n=t[0],i=t[t.length-1];this.fillSummaryWithTimeAndCanvasId(e,n,i);var r=t[1],o=t[t.length-2];return e.element={type:"graph",id:n.source.id,old_state:{pan:r.element.new_state.pan,zoom:r.element.new_state.zoom},new_state:{pan:o.element.new_state.pan,zoom:o.element.new_state.zoom}},[e]},s.prototype.summarizeGraphZoomSequence=function(t){var e={type:"graph",subtype:"zoom",method:"scroll"},n=t[0],i=t[t.length-1];return this.fillSummaryWithTimeAndCanvasId(e,n,i),e.element={type:"graph",id:n.element.id,old_state:{pan:n.element.new_state.pan,zoom:n.element.new_state.zoom},new_state:{pan:i.element.new_state.pan,zoom:i.element.new_state.zoom}},[e]},s.prototype.summarizeButtonSequence=function(t){var e={type:"interaction",method:"toolbar"},n=t.filter(function(t){return"toolbar_button_press"===t.type})[0];switch(e.time=n.time,e.dur=0,n.button.label){case"undo":e.subtype="undo";break;case"redo":e.subtype="redo";break;case"clear all":e.subtype="clear_all";break;case"larger":case"smaller":e.subtype="font_size",e.old_state=n.old_state.font_size,e.new_state=n.button.font_size;break;case"save":e.subtype="save";break;case"load":e.subtype="load";break;default:e.subtype="mode_change",e.old_state=n.old_state.mode,e.new_state=n.button.label}return[e]},s.prototype.summarizeFontSizeSequence=function(t){return[{type:"interaction",subtype:"font_size",method:"toolbar",time:t[0].time,dur:0,el_type:t[0].element.type,el_id:t[0].element.id,old_state:JSON.stringify(t[0].element.old_state),new_state:JSON.stringify(t[0].element.new_state)}]},s.prototype.summarizeTextEditSequence=function(t){var e=t[0],n=t[t.length-1],i={type:"interaction",subtype:"edit",method:"keyboard",el_type:"textbox",el_id:e.element.id,old_state:e.element.old_state,new_state:n.element.new_state};return this.fillSummaryWithTimeAndCanvasId(i,e,n),[i]}},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.GoogleAuthStrategy=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"81925747312-vao5h4l5bf2c8cbfssff1bejaut2at9n.apps.googleusercontent.com";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.auth2=null,this.client_id=n,this.events=t.dispatch("statusChange","APIReady"),this.is_ready=!1,"undefined"!=typeof gapi&&this.onGAPILoad()}return n(e,[{key:"onGAPILoad",value:function(){var t=this;gapi.load("client:auth2",function(){console.log("google client and auth2 loaded"),t.initAuth(function(){console.log("google auth2 initialized"),t.is_ready=!0,t.events.APIReady(),t.auth2.currentUser.listen(t.events.statusChange)})})}},{key:"initAuth",value:function(t){var e=this;this.auth2=gapi.auth2.getAuthInstance(),null===this.auth2?gapi.auth2.init({client_id:this.client_id}).then(function(){e.auth2=gapi.auth2.getAuthInstance(),"function"==typeof t&&t(e.auth2)}):"function"==typeof t&&t(this.auth2)}},{key:"signIn",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{prompt:"select_account"};return this.auth2&&this.auth2.signIn(t)}},{key:"signOut",value:function(){return this.auth2&&this.auth2.signOut()}},{key:"getProfile",value:function(){return this.auth2&&this.auth2.currentUser.get().getBasicProfile()}},{key:"getName",value:function(){return this.auth2&&this.auth2.currentUser.get().getBasicProfile()&&this.auth2.currentUser.get().getBasicProfile().getName()}},{key:"getIdToken",value:function(){return this.auth2&&this.auth2.currentUser.get().getAuthResponse().id_token}},{key:"isSignedIn",value:function(){return this.auth2&&this.auth2.isSignedIn.get()}}]),e}()}).call(this,n(6))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.GCAuthStrategy=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(7),o=e.GCAuthStrategy=function(){function e(n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=(0,r.uid)(),this.gauth=n,this.events=t.dispatch("statusChange","APIReady"),this.is_ready=!1,this.init()}return i(e,[{key:"init",value:function(){var t=this;this.gauth.is_ready?window.gapi.client.load("classroom","v1",function(){console.log("classroom api loaded"),t.is_ready=!0,t.events.APIReady()}):this.gauth.events.on("APIReady."+this.id,this.init.bind(this))}},{key:"signInAsStudent",value:function(){return this.gauth.signIn({scope:e.studentScope,prompt:"select_account"})}},{key:"signInAsTeacher",value:function(){return this.gauth.signIn({scope:e.teacherScope,prompt:"select_account"})}},{key:"isSignedIn",value:function(){return this.gauth.isSignedIn()}},{key:"getName",value:function(){return this.gauth.getName()}},{key:"query",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return console.log("querying",t,"with key",e),new Promise(function(n,i){window.gapi.client&&window.gapi.client.classroom?t(window.gapi.client.classroom).then(function(t){200===t.status&&(console.log("got result",t),t.statusText?i(t.statusText):!t.result||e&&!t.result[e]?i("No result."):n(e?t.result[e]:t.result))},i):i("API not ready.")})}},{key:"getCourseList",value:function(){return this.query(function(t){return t.courses.list({pageSize:100})},"courses")}},{key:"createCourseWork",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,r.extend)({workType:"ASSIGNMENT",state:"PUBLISHED"},e);return console.log(n),this.query(function(e){return e.courses.courseWork.create({courseId:t},n)})}},{key:"deleteCourseWork",value:function(t,e){return this.query(function(n){return n.courses.courseWork.delete({courseId:t,id:e})})}},{key:"listStudentSubmissions",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.query(function(i){return i.courses.courseWork.studentSubmissions.list({courseId:t,courseWorkId:e,userId:n})}).then(function(t){return t.studentSubmissions||[]})}},{key:"getStudentSubmission",value:function(t,e,n){return this.query(function(i){return i.courses.courseWork.studentSubmissions.get({courseId:t,courseWorkId:e,id:n})})}},{key:"addAttachment",value:function(t,e,n,i){return this.query(function(r){return r.courses.courseWork.studentSubmissions.modifyAttachments({courseId:t,courseWorkId:e,id:n,resource:{addAttachments:[i]}})})}},{key:"turnInSubmission",value:function(t,e,n){return this.query(function(i){return i.courses.courseWork.studentSubmissions.turnIn({courseId:t,courseWorkId:e,id:n})})}},{key:"reclaimSubmission",value:function(t,e,n){return this.query(function(i){return i.courses.courseWork.studentSubmissions.reclaim({courseId:t,courseWorkId:e,id:n})})}},{key:"constructCanvasMaterialLink",value:function(t,e){var n={url:t};return e&&(n.title=e),{link:n}}}]),e}();o.teacherScope="profile email https://www.googleapis.com/auth/classroom.courses.readonly https://www.googleapis.com/auth/classroom.coursework.students",o.studentScope="profile email https://www.googleapis.com/auth/classroom.courses.readonly https://www.googleapis.com/auth/classroom.coursework.me"}).call(this,n(6))},function(t,e,n){"use strict";function i(t,e){0==arguments.length?(this.x=0,this.y=0):1==arguments.length?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}function r(t,e,n){this.x=t,this.y=e,this.r=n}function o(t,e,n){var i=t.slice((n||e)+1||t.length);t.length=Math.max(0,e<0?t.length+e:e);for(var r=0;r<i.length;r++)t.push(i[r]);return t.length}function s(t){this.pts=[],this.closed=!0,this.max_error=.2,t&&this.add_points(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.Point=i,e.Circle=r,e.Polygon=s,i.norm_angle=function(t){return(t%=2*Math.PI)<-Math.PI?t+=2*Math.PI:t>Math.PI&&(t-=2*Math.PI),t},i.prototype.rotate=function(t){return new i(this.x*Math.cos(t)-this.y*Math.sin(t),this.y*Math.cos(t)+this.x*Math.sin(t))},i.prototype.Rotate=function(t){return this.Set(this.x*Math.cos(t)-this.y*Math.sin(t),this.y*Math.cos(t)+this.x*Math.sin(t))},i.prototype.Set=function(t,e){return 1==arguments.length?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),this},i.prototype.dist=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},i.prototype.dist2=function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},i.len=function(t,e){return Math.sqrt(t*t+e*e)},i.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.prototype.len2=function(){return this.x*this.x+this.y*this.y},i.prototype.add=function(t){return new i(this.x+t.x,this.y+t.y)},i.prototype.Add=function(t){return this.x+=t.x,this.y+=t.y,this},i.prototype.sub=function(t){return new i(this.x-t.x,this.y-t.y)},i.prototype.Sub=function(t){return this.x-=t.x,this.y-=t.y,this},i.prototype.mul=function(t){return this.x*t.x+this.y*t.y},i.prototype.cross=function(t){return this.x*t.y-this.y*t.x},i.prototype.equals=function(t,e){return Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e},i.prototype.normalize=function(){var t=1/this.len();return new i(this.x*t,this.y*t)},i.prototype.Normalize=function(){var t=1/this.len();return this.x*=t,this.y*=t,this},i.prototype.get_perpendicular=function(){return new i(-this.y,this.x)},i.prototype.scale=function(t){return new i(this.x*t,this.y*t)},i.prototype.Scale=function(t){return this.x*=t,this.y*=t,this},i.prototype.toString=function(){return"("+this.x+","+this.y+")"},i.prototype.copy=function(){return new i(this.x,this.y)},i.EPS=1e-6,i.get_closest_point_on_segment=function(t,e,n){var r=e.sub(t),o=r.len();if(o<i.EPS)return t;var s=r.mul(n.sub(t))/o;return s<0?t:s>r.len()?e:t.add(r.scale(s/o))},i.intersect_ray_with_segment=function(t,e,n,r,o,s){void 0===o&&(o=new i),void 0===s&&(s=i.EPS);var a=r.sub(n),l=e.cross(a);if(Math.abs(l)>i.EPS){var u=n.sub(t).cross(e)/l;if(u<-s||u-1>s)return!1;var c=n.add(a.scale(u));o.x=c.x,o.y=c.y}else{if(e.len2()<i.EPS||a.len2()<i.EPS)return!1;var d=t.sub(n).mul(a)/a.mul(a);if(n.add(a.scale(d)).dist(t)>i.EPS)return!1;d<-s?(o.x=n.x,o.y=n.y):d-1>s?(o.x=r.x,o.y=r.y):(o.x=t.x,o.y=t.y)}return o.sub(t).mul(e)>=0},i.intersect_inner_ray_with_rect=function(t,e,n){var o,s,a=new i(n.x,n.y),l=new i(n.x+n.width,n.y),u=new i(n.x,n.y+n.height),c=new i(n.x+n.width,n.y+n.height),d=n.r,h=new i;if(i.intersect_ray_with_segment(t,e,a,u,h))o=new i(0,1);else if(i.intersect_ray_with_segment(t,e,l,c,h))o=new i(0,-1);else if(i.intersect_ray_with_segment(t,e,a,l,h))o=new i(-1,0);else{if(!i.intersect_ray_with_segment(t,e,u,c,h))return null;o=new i(1,0)}return 0===d?{point:h,tangent:o}:(h.x<a.x+d&&h.y<a.y+d?o=(h=(s=new r(a.x+d,a.y+d,d).intersect_with_ray(t,e))[1]||s[0]||h).sub(new i(a.x+d,a.y+d)).get_perpendicular().scale(-1).Normalize():h.x>l.x-d&&h.y<l.y+d?o=(h=(s=new r(l.x-d,l.y+d,d).intersect_with_ray(t,e))[1]||s[0]||h).sub(new i(l.x-d,l.y+d)).get_perpendicular().scale(-1).Normalize():h.x<u.x+d&&h.y>u.y-d?o=(h=(s=new r(u.x+d,u.y-d,d).intersect_with_ray(t,e))[1]||s[0]||h).sub(new i(u.x+d,u.y-d)).get_perpendicular().scale(-1).Normalize():h.x>c.x-d&&h.y>c.y-d&&(o=(h=(s=new r(c.x-d,c.y-d,d).intersect_with_ray(t,e))[1]||s[0]||h).sub(new i(c.x-d,c.y-d)).get_perpendicular().scale(-1).Normalize()),{point:h,tangent:o})},i.prototype.is_inside_rect=function(t,e){return t.x<=this.x&&this.x<=e.x&&t.y>=this.y&&this.y>=e.y},i.intersect_seg_with_rect=function(t,e,n,r){var o=new i(n.x,n.y),s=new i(r.x,n.y),a=new i(n.x,r.y),l=[o,s,new i(r.x,r.y),a];if(t.is_inside_rect(n,r)&&e.is_inside_rect(n,r))return!0;for(var u=0;u<l.length;u++){var c=u+1;if(c>l.length-1&&(c=0),i.intersect_segments(t,e,l[u],l[c]))return!0}return!1},i.intersect_segments=function(t,e,n,i){if(t.x==n.x&&t.y==n.y&&e.x==i.x&&e.y==i.y)return!0;if(t.x==i.x&&t.y==i.y&&e.x==n.x&&e.y==n.y)return!0;var r=((n.y-i.y)*(t.x-n.x)+(i.x-n.x)*(t.y-n.y))/((i.x-n.x)*(t.y-e.y)-(t.x-e.x)*(i.y-n.y)),o=((t.y-e.y)*(t.x-n.x)+(e.x-t.x)*(t.y-n.y))/((i.x-n.x)*(t.y-e.y)-(t.x-e.x)*(i.y-n.y));return r>=0&&r<=1&&o>=0&&o<=1},r.prototype.copy=function(){return new r(this.x,this.y,this.r)},r.prototype.centroid=function(){return new i(this.x,this.y)},r.prototype.area=function(){return Math.PI*this.r*this.r},r.prototype.move_to_origin=function(){this.x=0,this.y=0},r.prototype.bounding_box=function(){return{x:this.x-this.r,y:this.y-this.r,width:2*this.r,height:2*this.r}},r.prototype.intersect_with_ray=function(t,e){var n=t.sub(this),r=e.x*e.x+e.y*e.y,o=2*n.x*e.x+2*n.y*e.y,s=o*o-4*r*(n.x*n.x+n.y*n.y-this.r*this.r);if(s<0)return[];if(s<i.EPS){var a=-o/(2*r);return a<0?[]:[new i(t).add(e.scale(a))]}var l=[],u=(-o-Math.sqrt(s))/(2*r),c=(-o+Math.sqrt(s))/(2*r);if(u>c){var d=u;u=c,c=d}return u>=0&&l.push(new i(t).add(e.scale(u))),c>=0&&l.push(new i(t).add(e.scale(c))),l},r.fromSVGCircle=function(t){var e=t.attributes;return e.cx&&e.cy&&e.r?new r(Number(e.cx.value),Number(e.cy.value),Number(e.r.value)):null},r.fromSVGPath=function(t){"undefined"==typeof exclude_ellipse&&(exclude_ellipse=!0);var e,n,i,o,s=t.lookupNamespaceURI("sodipodi"),a=function(e){var n=t.getAttributeNS(s,e);return null!==n?n:t.getAttribute("sodipodi:"+e)};if("arc"==a("type")&&(e=a("cx"))&&(n=a("cy"))&&(i=a("rx"))&&(o=a("ry"))){var l=a("start"),u=a("end");if(l&&u){var c=Number(u)-Number(l);if(Math.abs(Math.abs(c)-2*Math.PI)>.01&&!(c<0&&c>-.01))return console.log("Warning: this is a circle segment! ||start-end|-2*PI| =",c),null}return i=Number(i),o=Number(o),e=Number(e),n=Number(n),Math.abs(i/o-1)>.05?(console.log("Warning: This is an ellipse! rx",i,"ry",o),null):new r(e,n,(i+o)/2)}return null},r.prototype.renderInSvg=function(t,e){var n=t.createElementNS("http://www.w3.org/2000/svg","circle");return n.setAttribute("cx",this.x),n.setAttribute("cy",this.y),n.setAttribute("r",this.r),n.style.setProperty("stroke","red"),n.style.setProperty("stroke-width",".5px"),n.style.setProperty("fill","none"),e.appendChild(n),n},r.prototype.renderOnCanvas=function(t,e,n){t.beginPath(),t.arc(this.x,this.y,this.r,0,2*Math.PI,!0),e&&t.stroke(),n&&t.fill()},s.prototype.copy=function(){var t=new s;t.closed=this.closed,t.max_error=this.max_error;for(var e=0;e<this.pts.length;e++)t.pts.push(this.pts[e].copy());return t},s.prototype.move_to_origin=function(){for(var t=this.pts.length,e=this.centroid(),n=0;n<t;n++)this.pts[n].Sub(e)},s.prototype.push=function(t){return this.pts.push(t),this.pts},s.prototype.add_points=function(t){for(var e=0;e<t.length;++e)this.pts.push(new i(t[e][0],t[e][1]))},s.prototype.back=function(){return this.pts[this.pts.length-1]},s.prototype.order_vertices=function(){this.area()<0&&this.pts.reverse()},s.prototype.bounding_box=function(){for(var t=this.pts[0].x,e=t,n=this.pts[0].y,i=n,r=1;r<this.pts.length;r++)t=Math.min(t,this.pts[r].x),e=Math.max(e,this.pts[r].x),n=Math.min(n,this.pts[r].y),i=Math.max(i,this.pts[r].y);return{x:t,y:n,width:e-t,height:i-n}},s.prototype.area=function(){for(var t=0,e=this.back(),n=0;n<this.pts.length;n++)t+=e.cross(this.pts[n]),e=this.pts[n];return.5*t},s.prototype.centroid=function(){var t=new i(0,0),e=this.pts.length;if(0===e)return t;var n=this.area();if(!(this.closed&&Math.abs(n)>=i.EPS)){var r=this.bounding_box();return new i(r.x+r.width/2,r.y+r.height/2)}for(var o=this.back(),s=0;s<e;++s)t=t.add(o.add(this.pts[s]).scale(o.cross(this.pts[s]))),o=this.pts[s];return t.scale(1/(6*n))},s.prototype.get_edge_lengths=function(t){for(var e=[],n=this.pts.length,i=0;i<n-1;++i)e.push(this.pts[i].dist(this.pts[i+1]));return this.closed&&n>1&&e.push(this.pts[0].dist(this.pts[n-1])),t&&e.sort(function(t,e){return t-e}),e},s.prototype.is_convex=function(t){var e=this.pts.length;return this.pts[t].sub(this.pts[(t+e-1)%e]).cross(this.pts[(t+1)%e].sub(this.pts[t]))>=0},s.prototype.find_notch=function(){for(var t=this.pts.length,e=0;e<t;++e)if(!this.is_convex(e))return e;return t},s.prototype.find_intersection=function(t,e,n,r,o){var s=this.pts.length,a=s;void 0===r&&(r=s),void 0===o&&(o=s),void 0===n&&(n=new i);for(var l=0;l<s;++l)if(!(r<s&&(l==r||(s+l+1-r)%s==0)||o<s&&(l==o||(s+l+1-o)%s==0))){var u=new i;i.intersect_ray_with_segment(t,e,this.pts[(l+1)%s],this.pts[l],u)&&(a==s||u.dist2(t)<n.dist2(t))&&(n.x=u.x,n.y=u.y,a=l)}return a},s.prototype.is_visible=function(t,e){var n=this.pts.length;if(t==e||t==(e+1)%n||e==(t+1)%n)return!0;var r=this.pts[(n+t-1)%n],o=this.pts[(t+1)%n],s=this.pts[t].sub(r).cross(this.pts[e].sub(this.pts[t]))>=0,a=o.sub(this.pts[t]).cross(this.pts[e].sub(o))>=0;if(this.is_convex(t)){if(!s||!a)return!1}else if(!s&&!a)return!1;var l=new i;return this.find_intersection(this.pts[t],this.pts[e].sub(this.pts[t]),l,t,e)==n||l.dist2(this.pts[t])>this.pts[e].dist2(this.pts[t])},s.prototype.split_at=function(t,e){for(var n=[new s,new s],i=this.pts.length,r=t;r==i&&(r=0),n[0].pts.push(this.pts[r].copy()),r!=e;++r);for(r=e;r==i&&(r=0),n[1].pts.push(this.pts[r].copy()),r!=t;++r);return n},s.prototype.split=function(t){if(t<3)return[];var e=this.pts.length;if(e<=t)return[this];var n=this.find_biggest_angle(),i=(n+Math.round(e/2))%e,r=this.split_at(n,i);return r[0].split(t).concat(r[1].split(t))},s.prototype.angle=function(t){var e=this.pts.length,n=this.pts[(e+t-1)%e],i=this.pts[t],r=this.pts[(t+1)%e],o=Math.acos(n.sub(i).normalize().mul(r.sub(i).normalize()));return this.is_convex(t)?o:2*Math.PI-o},s.prototype.find_biggest_angle=function(){for(var t,e=this.pts.length,n=e,i=0;i<e;++i){var r=this.angle(i);(n==e||t<r)&&(n=i,t=r)}return n},s.prototype.merge_vertices=function(t){for(void 0==t.min_dist&&(t.min_dist=i.EPS),void 0==t.min_vertex_count&&(t.min_vertex_count=3),t.min_vertex_count<1&&(t.min_vertex_count=1);;){var e=!1,n=this.pts.length;if(n<=t.min_vertex_count)return;var r=[];this.pts[0].dist(this.back())<t.min_dist?(r.push(this.back().add(this.pts[0]).scale(.5)),n-=1,e=!0):r.push(this.pts[0]);for(var o=1;o<n;++o)r[r.length-1].dist(this.pts[o])<t.min_dist?(r[r.length-1]=r[r.length-1].add(this.pts[o]).scale(.5),e=!0):r.push(this.pts[o]);if(!e)return;this.pts=r}},s.prototype.remove_superfical_vertices=function(t){for(void 0==t.max_error&&(t.max_error=i.EPS),void 0==t.min_vertex_count&&(t.min_vertex_count=3),t.min_vertex_count<3&&(t.min_vertex_count=3);;){for(var e=!1,n=this.pts.length,r=n-1;;){if(n<=t.min_vertex_count)return;var s,a=this.pts[(n+r-1)%n],l=this.pts[(r+1)%n],u=l.sub(a),c=u.normalize(),d=u.mul(this.pts[r].sub(a));if(d>=0&&d<u.mul(u)){var h=a.add(c.scale(this.pts[r].sub(a).mul(c)));s=this.pts[r].dist(h)}else s=d<0?this.pts[r].dist(a):this.pts[r].dist(l);if(s<=t.max_error&&(o(this.pts,r),n-=1,e=!0),0==r)break;r-=1}if(!e)return}},s.prototype.toString=function(){for(var t=[],e=0;e<this.pts.length;e++)t.push(this.pts[e].x+","+this.pts[e].y);return"("+t.join(" ")+")"},s.prototype.contains_point=function(t){for(var e=t[0],n=t[1],i=this.pts,r=!1,o=0,s=i.length-1;o<i.length;s=o++){var a=i[o].x,l=i[o].y,u=i[s].x,c=i[s].y;l>n!=c>n&&e<(u-a)*(n-l)/(c-l)+a&&(r=!r)}return r},s.prototype.intersects_with_rect=function(t,e){var n=this.pts,r=this.bounding_box();if(t.x>r.x+r.width||r.x>e.x)return!1;if(t.y<r.y||r.y+r.height<e.y)return!1;for(var o=0;o<n.length;o++)if(n[o].is_inside_rect(t,e))return!0;if(this.contains_point(t)||this.contains_point(e)||this.contains_point(new i(e.x,t.y))||this.contains_point(new i(t.x,e.y)))return!0;var s=n.length;for(o=0;o<s;o++)if(i.intersect_seg_with_rect(n[o],n[(o+1)%s],t,e))return!0;return!1}},function(t,e,n){"use strict";var i=n(34),r=n(226),o=n(35),s=n(2),a=n(21);function l(t){if(!t.fixed)return!1;for(var e=t;e.parent&&e.parent.is_leaf_node&&e.parent.has_script("subscript");)e=e.parent;return t!==e.children[0]}function u(t,e){e.source_node.traced&&e.target_node.traced&&t.find(function(t){return t.source_node===e.source_node&&t.target_node===e.target_node||t.source_node===e.target_node&&t.target_node===e.source_node})||t.push(e)}i.Derivation.drawTraces=function(t){var e=t[0].canvas_model.back_svg(),n=t[0].canvas_model.html_container();t.forEach(function(t){return t.clearTraceProperties(!1)}),i.Derivation.hideTermTraces(e,n);var r=[];t.forEach(function(t){var e=t.mapping_nodes.map(function(t){return t.is_leaf_node?t.get_base():t}).filter(function(t){return!t.is_group("sym")});0!==e.length&&e.forEach(function(e){e.traced=!0,e.trace_origin=!0,r=r.concat(t.get_forward_lines([e]).concat(t.get_backward_lines([e])))})});var o={color:t[0].settings.get("trace_color"),active_border:t[0].settings.get("trace_active_border"),joint_width:t[0].settings.get("trace_joint_width"),joint_length:t[0].settings.get("trace_joint_length"),line_thickness:t[0].settings.get("trace_line_thickness"),rect_radius:t[0].rows[0].view.settings.get("trace_rect_radius")};i.Derivation.drawTraceLines(e,r,o),i.Derivation.updateTraceBackgrounds(n,o)},i.Derivation.prototype.drawAllTraces=function(){i.Derivation.drawTraces(this.canvas_model.getElementsOfType("derivation"))},i.Derivation.prototype.hideAllTraces=function(){var t=this.canvas_model.back_svg(),e=this.canvas_model.html_container();i.Derivation.hideTermTraces(t,e)},i.Derivation.hideTermTraces=function(t,e){t.selectAll(".mapping_line").style("visibility","hidden"),e.selectAll(".bg-rect").style("visibility","hidden")},i.Derivation.drawTraceLines=function(t,e,n){var r=n.color,o=t.selectAll(".mapping_line").data(e);o.enter().insert("path",".math"),o.classed("mapping_line",!0).call(i.Derivation.updateOrganicPath.bind(null,n)).style("fill",r).style("stroke",r).style("visibility",function(t){return t.source_node&&t.target_node?t.source_node.hidden||t.target_node.hidden?"hidden":null:"hidden"}),o.exit().remove()},i.Derivation.updateTraceBackgrounds=function(t,e){t.selectAll(".bg-rect").style("border",function(t){return t.trace_origin?e.active_border:"none"}).style("visibility",function(t){return t.hidden||!t.traced?"hidden":null})},i.Derivation.updateOrganicPath=function(t,e){function n(t){return t.x.toFixed(4)+" "+t.y.toFixed(4)+" "}var r=t.rect_radius;e.attr("d",function(e){if(!e.target_node||!e.source_node)return"M 0,0";var o=e.source_row,s=e.target_row,a=o.pos[0]+o.dl.pos.x-o.dl.dims.x,l=o.pos[1]+o.dl.pos.y-o.dl.dims.y,u=s.pos[0]+s.dl.pos.x-s.dl.dims.x,c=s.pos[1]+s.dl.pos.y-s.dl.dims.y,d=e.source_node.sel_box,h=e.source_node,p=e.target_node.sel_box,f=e.target_node,g={x:d.x+h.x+a,y:d.y+h.y+l,width:d.width,height:d.height,r:r},m={x:p.x+f.x+u,y:p.y+f.y+c,width:p.width,height:p.height,r:r},v=i.Derivation.createConnectorPath(g,m,t),y=i.Derivation.createConnectorPath(m,g,t);return v&&y?"M "+n(v.base1)+"C "+n(v.base1_control)+n(v.joint1_control1)+n(v.joint1)+"L"+n(y.joint2)+"C "+n(y.joint2_control1)+n(y.base2_control)+n(y.base2)+"L "+n(y.base1)+"C "+n(y.base1_control)+n(y.joint1_control1)+n(y.joint1)+"L "+n(v.joint2)+"C "+n(v.joint2_control1)+n(v.base2_control)+n(v.base2)+"Z":"M 0 0"})},i.Derivation.createConnectorPath=function(t,e,n){var i=Math.min(n.joint_width,.9*t.width,.9*e.width,.9*t.height,.9*e.height),s=Math.min(i/2,n.line_thickness),a=n.joint_length,l=new r.Point(t.x+t.width/2,t.y+t.height/2),u=new r.Point(e.x+e.width/2,e.y+e.height/2).Sub(l),c=[],d=[];if(o.HitTester.overlaps(t,e))return null;var h=u.get_perpendicular();h.Normalize().Scale(i/2);var p=r.Point.intersect_inner_ray_with_rect(l.add(h),u,t);if(!p)return null;c.push(p.point);var f=p.point.add(p.tangent.scale(i/3));d.push({from:p.point,to:f});var g=r.Point.intersect_inner_ray_with_rect(l.sub(h),u,t);if(!g)return null;c.push(g.point);var m=g.point.add(g.tangent.scale(-i/3));d.push({from:g.point,to:m}),h.Normalize().Scale(s/2);var v=r.Point.intersect_inner_ray_with_rect(l.add(h),u,t);if(!v)return null;var y=v.point.add(u.normalize().Scale(a)),b=r.Point.intersect_inner_ray_with_rect(l.sub(h),u,t);if(!b)return null;var _=b.point.add(u.normalize().Scale(a));c.push(y,_);var x=y.sub(u.normalize().Scale(a/2)),w=y.sub(u.normalize().Scale(-a/2)),A=_.sub(u.normalize().Scale(a/2)),k=_.sub(u.normalize().Scale(-a/2));return d.push({from:y,to:x},{from:y,to:w},{from:_,to:A},{from:_,to:k}),{pts:c,lines:d,base1:p.point,base2:g.point,joint1:y,joint2:_,joint1_control1:x,joint1_control2:w,joint2_control1:A,joint2_control2:k,base1_control:f,base2_control:m}},i.Derivation.prototype.get_next_visible_row=function(t){for(var e=t.idx+1;e<this.rows.length;e++)if(!this.rows[e].hidden)return this.rows[e];return null},i.Derivation.prototype.get_prev_visible_row=function(t){for(var e=t.idx-1;e>=0;e--)if(!this.rows[e].hidden)return this.rows[e];return null},i.Derivation.prototype.get_forward_lines=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=t.filter(function(t){return!l(t)});if(i||(i=o),0===o.length||0===i.length)return[];var c=i[0].get_root(),d=e||this.getRowByModel(c),h=(0,a.linkCoordinator)().links.filter(function(t){return t.source===c&&(n.settings.get("draw_term_traces_across_derivations")||n.getRowByModel(t.target))}),p=this.settings.get("draw_term_traces_across_derivations")?this.canvas_model.getElementsOfType("derivation"):[this],f=[];return h.forEach(function(t){var e=p.find(function(e){return e.getRowByModel(t.target)}),a=e.getRowByModel(t.target),c=r.slice();c.push(t.action);var h=t.action.mapNodes(i);n.settings.get("trace_syms")||h.filter(function(t){return!t.is_group("sym")}),h=h.filter(function(t){return!l(t)}),a.hidden?f=f.concat(e.get_forward_lines(o,d,h,c)):(f=f.concat(function(t,e,n,i,r){var o=[],a=1===t.length?t[0]:s.Action.createComposedAction(t);return e.forEach(function(t){var e=a.mapNodes([t]);0!==e.length||t.traced?e.forEach(function(e){r&&e.is_group("sym")||e.has_children()||l(e)||u(o,{source_node:t,source_row:n,target_node:e,target_row:i})}):o.push({source_node:t,source_row:n}),t.was_removed=0===e.length}),o}(c,o,d,a,!n.settings.get("trace_syms"))).concat(e.get_forward_lines(h,null,null,[])),h.forEach(function(t){return t.traced=!0}))},this),f},i.Derivation.prototype.get_backward_lines=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(i||(i=t),0===t.length||0===i.length)return[];var o=i[0].get_root(),c=this.getRowByModel(o),d=e||c,h=(0,a.linkCoordinator)().links.filter(function(t){return t.target===o&&(n.settings.get("draw_term_traces_across_derivations")||n.getRowByModel(t.source))}),p=this.settings.get("draw_term_traces_across_derivations")?this.canvas_model.getElementsOfType("derivation"):[this],f=[];return h.forEach(function(e){var i=p.find(function(t){return t.getRowByModel(e.source)}),o=i.getRowByModel(e.source),a=r.slice();a.unshift(e.action);var c=1===a.length?a[0]:s.Action.createComposedAction(a),h=[];o.model.children[0].for_each(function(e){if(!e.has_children()&&(this.settings.get("trace_syms")||!e.is_group("sym"))&&!l(e)){var n=!1;c.mapNodes([e]).forEach(function(i){-1!==t.indexOf(i)&&(o.hidden||u(f,{source_node:e,source_row:o,target_node:i,target_row:d}),n=!0)}),n&&h.push(e)}}.bind(n)),o.hidden?f=f.concat(i.get_backward_lines(t,d,h,a)):(f=i.get_backward_lines(h,null,null,[]).concat(f),h.forEach(function(t){return t.traced=!0}))},this),f}},function(t,e,n){"use strict";var i=n(34),r=n(59);function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.Derivation.ChangeEvent=function(t,e,n){this.type="change",this.performee=t,this.performee_type="DL",this.time=Date.now(),this.row=n,this.model=e},i.Derivation.dragEvent=function(t,e){this.type="Drag",this.performee=t,this.performee_type="DL",this.time=Date.now(),this.x=e.x,this.y=e.y},i.Derivation.touchEvent=function(t,e){this.type="Touch",this.performee=t,this.performee_type="DL",this.time=Date.now(),this.fingers=e.fingers.map(function(t){return{pos:[t.pos[0],t.pos[1]]}})},i.Derivation.releaseEvent=function(t,e){this.type="Release",this.performee=t,this.performee_type="DL",this.time=Date.now(),e.altKey&&(this.altKey=e.altKey),e.shiftKey&&(this.shiftKey=e.shiftKey),this.fingers=e.fingers.map(function(t){return{pos:[t.pos[0],t.pos[1]]}})},i.Derivation.holdEvent=function(t,e){this.type="Hold",this.performee=t,this.performee_type="DL",this.time=Date.now(),this.finger={pos:[e.finger.pos[0],e.finger.pos[1]]}},r.DerivationRow.touchEvent=function(t,e,n){this.type="Touch",this.performee=n,this.performee_type="row",this.row=e,this.time=Date.now(),this.fingers=t.fingers.map(function(t){return{pos:[t.pos[0],t.pos[1]]}})},r.DerivationRow.tapEvent=function(t,e,n){this.type="Tap",this.performee=n,this.performee_type="row",this.row=e,this.time=Date.now(),this.fingers=t.fingers.map(function(t){return{pos:[t.pos[0],t.pos[1]]}})},r.DerivationRow.dragEvent=function t(e,n,i){o(this,t),this.type="Drag",this.performee=i,this.performee_type="row",this.row=n,this.time=Date.now(),this.x=e.x,this.dx=e.dx,this.y=e.y,this.dy=e.dy,this.finger={dx:e.finger.dx,dy:e.finger.dy,dist_x:e.finger.dist_x,dist_y:e.finger.dist_y},this.x_offset=Math.abs(e.finger.dist_x),this.y_offset=Math.abs(e.finger.dist_y),this.fingers=e.fingers.map(function(t){return{pos:[t.pos[0],t.pos[1]]}}),this.sourceEvent=e},r.DerivationRow.releaseEvent=function t(e,n,i){o(this,t),this.type="Dragend",this.performee=i,this.performee_type="row",this.row=n,this.time=Date.now(),this.fingers=e.fingers.map(function(t){return{pos:[t.pos[0],t.pos[1]]}}),this.sourceEvent=e},r.DerivationRow.cloneEvent=function(t,e){this.type="Clone",this.performee=t,this.performee_type="row",this.eq=e.eq,this.pos=e.pos,this.dl_id=e.id},r.DerivationRow.stateEvent=function(t){this.type="packState",this.performee=t.id,this.performee_type="row",this.time=Date.now(),this.packState=t.packState}},function(t,e,n){"use strict";(function(t){var e,i=n(0),r=n(19),o=n(5),s=n(14);i.gmath.ui=i.gmath.ui||{},i.gmath.ui.GraphEq=(e=function(t,e,n){r.CanvasElement.call(this,t,e,n),this.vals=i.gmath.object.extendExisting({a:"A",b:"B",c:"C"},n.vals||{}),this.form=0,this.views=[],this.align=null,this.evts=null,this.trans={},this.gestures=[],this.dx=null,this.init()},i.gmath.inherit(r.CanvasElement,e),e.prototype.init=function(){var e=this,n=this.element_div.append("svg").style("position","absolute").style("left","0px").style("top","0px").style("overflow","visible"),r=n.node().getBoundingClientRect(),a=n.append("g"),l=this.vals.a+"x+"+this.vals.b+"y="+this.vals.c,u=new o.AlgebraModel(l),c={h_align:"left",v_align:"top"};this.views.push(new s.AlgebraView(u,a,c)),this.views[0].init(function(){var l="y=-{"+e.vals.a+"/"+e.vals.b+"}x+"+e.vals.c+"/"+e.vals.b,u=new o.AlgebraModel(l);e.views.push(new s.AlgebraView(u,a,c)),e.views[1].init(function(){function o(e){var n=i.gmath.Tree.get_child([0,1],e.model),r=t.select("#"+n.id);return t.transform(r.attr("transform")).translate.slice()}var s=o(e.views[0]),l=o(e.views[1]);e.align=[s[0]-l[0],s[1]-l[1]],e.views[1].main.attr("transform","translate("+e.align.join(",")+")");var u=a.node().getBBox(),c=u.width+60,d=u.height;function h(e,n){var r=i.gmath.Tree.get_child(e,n.model);return t.select("#"+r.id)}function p(e,n){function i(e){var n=e.select("rect").node().getBoundingClientRect(),i={left:n.left-r.left,top:n.top-r.top,width:n.width,height:n.height};return i.right=i.left+i.width,i.bottom=i.top+i.height,{el:e,box:i,pos:t.transform(e.attr("transform")).translate,sel:!1}}return[i(e),i(n)]}e.resizeElement({width:c,height:d}),n.attr("width",c+"px").attr("height",d+"px"),a.attr("transform","translate("+[-u.x,-u.y].join(",")+")"),e.evts=n.append("rect").attr("x",0).attr("y",0).attr("width",c).attr("height",d).attr("fill","none");var f=e.views[0],g=e.views[1],m=[[0,0,0,1,0,1],[0,2,0,1,0,1,1,0,1]];e.vals.a<0&&(e.trans.a_sign=p(h(m[0].concat(0),f),h(m[1].concat(0),g)),m.forEach(function(t){return t.push(1)})),e.trans.a=p(h(m[0],f),h(m[1],g)),e.trans.x=p(h([0,0,0,1,1,1],f),h([0,2,0,1,1,1],g));var v=[[0,0,1,1,0,1],[0,2,0,1,0,1,1,2,1],[0,2,1,1,2,1]];if(e.vals.b<0){var y=h(v[0].concat(0),f),b=t.select(f.main.node().appendChild(y.node().cloneNode(!0)));b.attr("id",y.attr("id")+"_clone").select("text").style("opacity",1),e.trans.b1_sign=p(y,h(v[1].concat(0),g)),e.trans.b2_sign=p(b,h(v[2].concat(0),g)),v.forEach(function(t){return t.push(1)})}var _=h(v[0],f),x=t.select(f.main.node().appendChild(_.node().cloneNode(!0)));x.attr("id",_.attr("id")+"_clone").select("text").style("opacity",1),e.trans.b1=p(_,h(v[1],g)),e.trans.b2=p(x,h(v[2],g)),e.trans.y=p(h([0,0,1,1,1,1],f),h([0,0],g));var w=[[0,2],[0,2,1,1,0,1]];e.vals.c<0&&(e.trans.c_sign=p(h(w[0].concat(0),f),h(w[1].concat(0),g)),w.forEach(function(t){return t.push(1)})),e.trans.c=p(h(w[0],f),h(w[1],g));var A=e.trans.a[0].box,k=e.trans.c[0].box;e.gestures.push({source:[A.left+A.width,A.top+A.height/2],target:[k.left+k.width,k.top+k.height/2]});var T=e.trans.x[1].box,S=e.trans.y[1].box;function M(t){var n=e.gestures[e.form].source[0],i=(t-n)/(e.gestures[e.form].target[0]-n);return i<0&&(i=0),i>1&&(i=1),i}function E(t,e,n){var i=[e[0]+(n[0]-e[0])/2,e[1]+4*(n[1]-e[1])],r=[];e[1]==i[1]&&(i[1]-=100);for(var o=0;o<2;o++)r.push(Math.pow(1-t,2)*e[o]+2*(1-t)*t*i[o]+Math.pow(t,2)*n[o]);return r}function N(n){Object.keys(e.trans).forEach(function(t){if("y"!=t){var i=e.trans[t][e.form],r=e.trans[t][1-e.form],o=i.pos.slice(),s=r.pos.slice();s[0]+=0==e.form?e.align[0]:-e.align[0],s[1]+=0==e.form?e.align[1]:-e.align[1];var a=0==e.form?E(n,o,s):E(1-n,s,o),l=1+n*(r.box.width/i.box.width-1);i.el.attr("transform","translate("+a.join(",")+") scale("+l+")")}}),[[0,2,0,1,0,1,0],[0,2,0,1,0,1,1,1],[0,2,0,1,1,0],[0,2,1,0],[0,2,1,1,1]].forEach(function(r){var o=i.gmath.Tree.get_child(r,e.views[1].model);t.select("#"+o.id).style("opacity",0==e.form?n:1-n)});var r=i.gmath.Tree.get_child([0,0,1,0],e.views[0].model);t.select("#"+r.id).style("opacity",0==e.form?1-n:n)}e.gestures.push({source:[T.left,T.top+T.height/2],target:[S.left,S.top+S.height/2]}),e.views[1].main.selectAll(".math").style("opacity",0);var O=i.gmath.mtouch_events().frame(e.evts.node()).on("touch",function(){t.event.fingers.forEach(function(t){var n=t.pos[0],i=t.pos[1],r=t.id;["a","x","b1","b2","y"].forEach(function(t){var o=e.trans[t][e.form],s=o.box;n>s.left&&n<s.right&&i>s.top&&i<s.bottom&&(o.sel=r)})})}).on("drag",function(){t.event.fingers.forEach(function(t){var n=t.id;(0==e.form?[e.trans.a[0].sel,e.trans.x[0].sel]:[e.trans.a[1].sel,e.trans.b1[1].sel,e.trans.x[1].sel]).indexOf(n)>-1&&(e.dx||(e.dx=e.gestures[e.form].source[0]),e.dx+=t.dx,N(M(e.dx)))})}).on("release",function(){if(e.dx){var n=t.event.finger,i=n.id;e.dx+=n.dx;var r=M(e.dx);["a","x","b1","b2","y"].forEach(function(t){var n=e.trans[t][e.form];if(n.sel==i){var o=setInterval(function(){r>.5?r+=.01:r-=.01,r>1&&(r=1,clearInterval(o),e.dx=null),r<0&&(r=0,clearInterval(o),e.dx=null),N(r),1==r&&(e.form=1-e.form,e.views[0].main.selectAll(".math").style("opacity",0==e.form?1:0),e.views[1].main.selectAll(".math").style("opacity",0==e.form?0:1),Object.keys(e.trans).forEach(function(t){var n=e.trans[t][1-e.form],i=n.pos.slice();n.el.attr("transform","translate("+i.join(",")+") scale(1)")}))},2);n.sel=!1}})}});e.evts.call(O)})})},e)}).call(this,n(6))},function(t,e,n){"use strict";(function(t,e){var i,r=n(0),o=n(19);r.gmath.ui=r.gmath.ui||{},r.gmath.ui.Multichoice=(i=function(e,n,i,s){o.CanvasElement.call(this,e,n,i),this.type="multichoice",this.events=r.gmath.extend(this.events,t.dispatch("select")),this.logger=null,this.choice_els=null,this.selected={},this.initOptions(i),this.init()},r.gmath.inherit(o.CanvasElement,i),i.defaultOptions={choices:["A","B","C"],multichoice:!1,alignment:"horizontal",font_size:20,btn_radius:20,btn_margin:20,resizable:{x:!1,y:!1}},i.prototype.initOptions=function(t){var e=r.gmath.deepCopy(i.defaultOptions);t=r.gmath.object.extendExisting(e,t||{}),this.options=r.gmath.extend(this.options,t)},i.prototype.init=function(){var n=this;this.options.choices.forEach(function(t){n.selected[t]=!1});var i=this.options.btn_radius,r=this.options.btn_margin,o=0,s="vertical"==n.options.alignment,a=this.element_div.append("div").style("position","absolute").style("left","0px").style("top","0px");this.choice_els=a.selectAll(".choice").data(this.options.choices),this.choice_els.enter().append("div").classed("choice",!0).style("position","absolute").each(function(a,l){var u=t.select(this),c=[(2*i+r)*l+i+r,i+r];s?c.reverse():c[1]+=r+n.options.font_size,u.style("left",c[0]+"px").style("top",c[1]+"px");var d=u.append("p").style("position","absolute").style("margin","0px").style("font-size",n.options.font_size+"px").style("text-align",s?"left":"center").style("white-space","nowrap").style("pointer-events","none").html(a);setTimeout(function(){var t=e(d.node()).innerWidth(),n=e(d.node()).innerHeight();d.style("left",(s?i+r:-t/2)+"px").style("top",(s?-i:-(i+r+n/1.2))+"px"),s&&(d.style("height",2*i+"px").style("line-height",2*i+"px"),t>o&&(o=t))},100),u.append("div").style("position","absolute").style("left",-i+"px").style("top",-i+"px").style("width",2*i+"px").style("height",2*i+"px").style("background-color","white").style("border","2px solid gainsboro").style("border-radius",(n.options.multichoice?0:50)+"%").on("click",function(){if(!n.options.multichoice){if(n.selected[a])return;n.choice_els.each(function(e){e!=a&&(t.select(this).select(".selected").transition().duration(200).style("background-color","white"),n.selected[e]=!1)})}n.selected[a]=!n.selected[a],u.select(".selected").transition().duration(200).style("background-color",n.selected[a]?"#84bd43":"white"),n.events.select(a),n.logger&&n.logger.logCustomInteraction("choice",{choice:a,value:n.selected[a]})}),u.append("div").classed("selected",!0).style("position","absolute").style("left",4-i+"px").style("top",4-i+"px").style("width",2*i-8+"px").style("height",2*i-8+"px").style("background-color","white").style("border-radius",(n.options.multichoice?0:50)+"%").style("pointer-events","none")}),setTimeout(function(){var t=(2*i+r)*n.options.choices.length+r,e=2*i+3*r;s?t=(t+=e)-(e=t-e)+o:e+=n.options.font_size,a.style("width",t+"px").style("height",e+"px"),n.resizeElement({width:t,height:e})},100)},i.prototype.setLogger=function(t){this.logger=t},i)}).call(this,n(6),n(8))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(10),o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,null,[{key:"get",value:function(e){return r.SettingsType.get("Canvas",t.getDocumentKey()).get(e)}},{key:"getDocumentKey",value:function(){return Object.keys(r.SettingsType.get("Canvas"))[0]}}]),t}();e.default=o},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),o=n(10),s=(c(n(231)),n(98)),a=n(43),l=c(n(97)),u=n(7);function c(t){return t&&t.__esModule?t:{default:t}}var d=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=(0,u.uid)(),this.active=!1,this.derivations=[],this.events=t.dispatch("done")}return i(e,[{key:"start",value:function(t){Array.isArray(t)||(t=[t]),this.active&&u.array.equals(t,this.derivations)||(this.originalKeypadLayout=r.gmath.ui.Keyboard().layout(),this.confirmSelectionMode=!!t[0]&&t[0].settings.get("keypad_tool_confirm_mode"),this.onTouchDevice=!1,this.active=!0,this.derivations=t,this.setInteractive(!1),this.setupActions(),this.setupEventListeners())}},{key:"setupEventListeners",value:function(){var e=this,n=this.derivations[0];if(n.element_div.on("mousemove.keypad-handler-"+this.id,this.onMouseMove.bind(this)).on("click.keypad-handler-"+this.id,this.onClick.bind(this)),t.select(document).on("keydown.keypad-handler-"+this.id,this.onKeydown.bind(this)),n.canvas_model){var i=n.canvas_model.background_event_layer();i.on("click.keypad-handler-"+this.id,this.clearChosenHit.bind(this)),this.confirmSelectionMode||i.on("mousemove.keypad-handler-"+this.id,function(){e.activeAction||e.clearChosenHit()})}}},{key:"setInteractive",value:function(t,e){this.derivations.forEach(function(e){e.rows.forEach(function(t,n){n<e.rows.length-1&&t.view.interactive(!1)}),e.getLastView().interactive(t,t),e.render(!1)})}},{key:"setupActions",value:function(){var t=this;this.actions=[],this.derivations.forEach(function(e){var n,i=e.getLastModel(),r=l.default.getSelectionsFromModel(i),u=new s.ExpressionRewriteAction;(n=r.map(function(t){return u.createBoundAction(i,{nodes:l.default.getApplicableTerm(l.default.getVariableGroup(t)),only_simple_rewrites:o.SettingsType.get("Math").get("only_simple_rewrites"),use_simple_keyboard_layout:o.SettingsType.get("Math").get("use_simple_keyboard_layout"),triggerType:"keypad-tool",side:"around"})})).forEach(function(t,e){t.target=r[e],t.destination_hints=[],t.addDestinationHint({node:t.nodes,side:"around"})});var c=e.getLastView();a.HitTester.setTargetRegions(n,c.settings.get("font_size"),c.getBBox({no_padding:!0}),!1),t.actions=t.actions.concat(n)})}},{key:"end",value:function(){if(this.active){this.active=!1;var e=this.derivations[0];e.element_div.on("mousemove.keypad-handler-"+this.id,null).on("click.keypad-handler-"+this.id,null),t.select(document).on("keydown.keypad-handler-"+this.id,null),e.canvas_model&&e.canvas_model.background_event_layer().on("mousemove.keypad-handler-"+this.id,null).on("click.keypad-handler-"+this.id,null),this.setInteractive(!0),r.gmath.ui.Keyboard().layout(this.originalKeypadLayout),this.actions=null,this.derivations&&(this.derivations.forEach(function(t){return t.hit=null}),this.derivations.forEach(function(t){return a.HitTester.drawDestinationHints(t.getLastView().main)})),this.derivations=[],this.events.done()}}},{key:"teardownEventListeners",value:function(){var e=this.derivations[0];if(e.element_div.on("mousemove.keypad-handler-"+this.id,null).on("click.keypad-handler-"+this.id,null),t.select(document).on("keydown.keypad-handler-"+this.id,null),e.canvas_model){var n=e.canvas_model.background_event_layer();n.on("click.keypad-handler-"+this.id,null),this.confirmSelectionMode||n.on("mousemove.keypad-handler-"+this.id,null)}}},{key:"onKeydown",value:function(){27===t.event.keyCode&&this.clearChosenHit()}},{key:"clearChosenHit",value:function(){var t=this;this.chosenHit=null,this.derivations.forEach(function(e){e.hit&&(e.hit=null,t.highlightHit(e))})}},{key:"onMouseMove",value:function(){this.chosenHit||this.activeAction||this.detectHits(!0)}},{key:"onClick",value:function(){if(!this.activeAction)if(this.detectHits(this.confirmSelectionMode),this.confirmSelectionMode)if(this.chosenHit&&this.detectedHitConfirmsChosenHit())this.performAction(this.chosenHit);else{var t=this.derivations.find(function(t){return t.hit});this.chosenHit=t?t.hit:null,this.confirmChoice(this.chosenHit)}else if(this.derivations.some(function(t){return t.hit})){var e=this.derivations.find(function(t){return t.hit});this.chosenHit=e?e.hit:null,this.performAction(e.hit)}}},{key:"hasNoDetectedHits",value:function(){return this.derivations.every(function(t){return!t.hit})}},{key:"detectHits",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=[];return this.derivations.forEach(function(r){var o=r.getLastView(),s=r.getLastModel(),l=t.mouse(o.main.node()),u={x:l[0]-.5,y:l[1]-.5,width:1,height:1},c=a.HitTester.getHits(e.actions.filter(function(t){return t.oldTree===s}),u),d=c.length>0?c[0]:null;i.push(d),d?(r.hit=d,d.derivation=r):r.hit=null,n&&e.highlightHit(r)}),i}},{key:"highlightHit",value:function(t){a.HitTester.drawDestinationHints(t.getLastView().main,t.hit)}},{key:"detectedHitConfirmsChosenHit",value:function(){var t=this;return this.derivations.some(function(e){return e.hit&&e.hit.target===t.chosenHit.target})}},{key:"confirmChoice",value:function(t){this.chosenHit=t,t?a.HitTester.drawDestinationHints(t.derivation.getLastView().main,t):this.derivations.forEach(function(t){t.rows.forEach(function(t){return a.HitTester.drawDestinationHints(t.view.main)})})}},{key:"performAction",value:function(t){var e=this;this.activeAction=!0,t.settings.only_simple_rewrites=o.SettingsType.get("Math").get("only_simple_rewrites");var n=t.derivation.getLastView();n.model.startInteraction(),n.model.performAction(t,function(t){e.activeAction=!1,e.derivations.forEach(function(t){t.rows.forEach(function(t){return a.HitTester.drawDestinationHints(t.view.main)})}),n.model.finishInteraction(!t),e.setInteractive(!1),e.setupActions()})}}]),e}();e.default=d}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SumCleanupAction=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=(n(0),n(1)),o=n(2),s=(n(5),n(3)),a=e.SumCleanupAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"SumCleanupAction","sum cleanup action"));return t&&(n.actor=t.actor),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),i(e,[{key:"match",value:function(t){return t.is_group("sum")&&t.children.length<=1}},{key:"doInPlace",value:function(t){this.initNodeMap();var e=this.getNewTreeNode(this.actor);if(0===e.children.length)r.Tree.remove(e);else if(1===e.children.length){var n,i=e.children[0],o=this.actor.children[0];if(i.is_group("add"))n=i.children[1];else if(i.is_group("sub","addsub")){var a=i.is_group("addsub");if(i.children[1].is_group("product")){var l=i.children[1].children[0].children[1],u=l.parent;l.remove();var c=new s.Sign(l,a);u.append(c),n=i.children[1]}else n=new s.Sign(i.children[1],a);this.updateNodeMap(o.children[0],n.children[0])}this.updateNodeMap(o,n),this.updateNodeMap(o.parent,n),r.Tree.replace(i.parent,n),n.parent&&n.parent.is_group("brackets")?s.Brackets.handle(n.parent,!0):s.Brackets.handle(n)}if("function"!=typeof t)return this;t(this)}}]),e}();s.Sum.prototype.cleanupAction=new a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RadicalCleanup=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=(n(0),n(1)),o=n(2),s=(n(5),n(3)),a=e.RadicalCleanup=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"RadicalCleanup","power cleanup action"));return t&&(n.actor=t.actor),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),i(e,[{key:"match",value:function(t){return t.is_group("radical")&&t.children.length<4}},{key:"doInPlace",value:function(t){this.initNodeMap();var e=this.getNewTreeNode(this.actor),n=e.parent;if(this.actor.parent,e.is_group("radical")&&e.children.length<4){var i=e.children[2],o=(this.getOldTreeNode(i),r.Tree.remove(e));this.updateNodeMap(this.actor,n),n.insert(o,i)}if("function"!=typeof t)return this;t(this)}}]),e}();s.Radical.prototype.cleanupAction=new a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProductFractionCleanup=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=(n(0),n(1)),o=n(2),s=(n(5),n(3)),a=e.ProductFractionCleanup=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"ProductFractionCleanup","product-fraction cleanup action"));return t&&(n.actor=t.actor),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),i(e,[{key:"match",value:function(t){var e=t.get_top().length,n=t.get_bottom().length;return 0===e&&0===n||"product"===t.value&&n>0||"fraction"===t.value&&0===n||"fraction"===t.value&&0===e||1===e&&0===n}},{key:"doInPlace",value:function(t){this.initNodeMap();var e,n=this.getNewTreeNode(this.actor),i=this.actor,o=n.get_top().length,a=n.get_bottom().length;if(0===o&&0===a){var l=new s.Num(1);this.updateNodeMap(this.actor,l),r.Tree.replace(n,l),l.parent.is_group("brackets")&&s.Brackets.handle(l.parent,!0),e=!0}if(!e&&"product"===i.value&&a>0&&n.invert(),e||"fraction"!==i.value||0!==a||n.invert(),"fraction"===i.value&&0===o&&(i.children[0]instanceof s.Sym||r.Tree.insert(n,0,new s.Sym("//")),r.Tree.insert(n,0,new s.MulDiv(new s.Num(1)))),1===o&&0===a){var u=n.get_top()[0].children[1];if(this.updateNodeMap(i,u),this.updateNodeMap(i.children[0],u),r.Tree.replace(n,u),u.parent.is_group("brackets"))s.Brackets.handle(u.parent,!0);else{if(u.is_group("brackets"))var c=u.children[1];var d=s.Brackets.handle(u,!0);c&&"removed"===d&&(this.updateNodeMap(i,c),this.updateNodeMap(i.children[0],c))}}if("function"!=typeof t)return this;t(this)}}]),e}();s.ProductFraction.prototype.cleanupAction=new a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PowerCleanup=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=(n(0),n(1)),o=n(2),s=(n(5),n(3)),a=e.PowerCleanup=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"PowerCleanup","power cleanup action"));return t&&(n.actor=t.actor),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),i(e,[{key:"match",value:function(t){return!!e.powerWithoutExponent(t)}},{key:"doInPlace",value:function(t){this.initNodeMap();var n=this.getNewTreeNode(this.actor),i=n.parent;if(this.actor.parent,e.powerWithoutExponent(n)){var o=n.children[0],s=(this.getOldTreeNode(o),r.Tree.remove(n));this.updateNodeMap(this.actor,i),i.insert(s,o)}if("function"!=typeof t)return this;t(this)}}],[{key:"powerWithoutExponent",value:function(t){return!(!t.is_group("power")||1!==t.children.length)}}]),e}();s.Power.prototype.cleanupAction=new a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MulDivCleanup=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=(n(0),n(1)),o=(n(5),n(2)),s=n(3),a=e.MulDivCleanup=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"MulDivCleanup","muldiv cleanup action"));return t&&(n.actor=t.actor),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),i(e,[{key:"match",value:function(t){return!!e.hasProductChild(t)||!(!t.parent.cleanupAction||!t.parent.cleanupAction.match(t.parent))}},{key:"doInPlace",value:function(t){this.initNodeMap();var n=this.getNewTreeNode(this.actor),i=n.parent;if(this.actor.parent,e.hasProductChild(n)){var o=n.children[1],s=this.getOldTreeNode(o),a=r.Tree.remove(n);this.updateNodeMap(this.actor,i),this.updateNodeMap(s,o.children),this.actor.is_group("div")&&o.children.forEach(function(t){t.invert()}),i.insert_range(a,o.children)}if("function"!=typeof t)return this;t(this)}}],[{key:"hasProductChild",value:function(t){return(t.is_group("mul")||t.is_group("div"))&&t.children[1]&&t.children[1].is_group("product")}}]),e}();s.MulDiv.prototype.cleanupAction=new a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CommutativeGroupCleanup=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=(n(0),n(1)),o=(n(5),n(2)),s=n(3),a=e.CommutativeGroupCleanup=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"CommutativeGroupCleanup","group cleanup action"));return t&&(n.group=t.actor),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),i(e,[{key:"match",value:function(t){return t.is_group()&&(!t.has_children()||1===t.children.length)}},{key:"doInPlace",value:function(t){this.initNodeMap();var e=this.getNewTreeNode(this.group);if(0===e.children.length)r.Tree.remove(e);else if(1===e.children.length){var n=e.children[0],i=this.group.children[0],o=n.children[1];this.updateNodeMap(i.children[0],o),this.updateNodeMap(i,o),this.updateNodeMap(i.parent,o),r.Tree.replace(n.parent,o),o.parent.parent&&s.Brackets.handle(o.parent,!0),s.Brackets.handle(o,!0)}if("function"!=typeof t)return this;t(this)}}]),e}();s.Conjunction.prototype.cleanupAction=new a,s.Disjunction.prototype.cleanupAction=new a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddSubCleanUp=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=(n(0),n(1)),o=(n(5),n(2)),s=n(3),a=e.AddSubCleanUp=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"AddSubCleanUp","addsub cleanup action"));return t&&(n.addsub=t.actor),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),i(e,[{key:"match",value:function(t){return t.is_group("add","sub")&&t.children[1].is_group("sum")}},{key:"doInPlace",value:function(t){this.initNodeMap();var e=this.getNewTreeNode(this.addsub);if(e.is_group("add","sub")&&e.children[1].is_group("sum")){var n=e.is_group("sub"),i=e.parent,o=e.children[1],s=this.addsub.children[1];this.updateNodeMap(this.addsub,i),this.updateNodeMap(s,o.children);var a=r.Tree.remove(e);if(n)for(var l=0;l<o.children.length;l++)o.children[l].invert();i.insert_range(a,o.children)}if("function"!=typeof t)return this;t(this)}}]),e}();s.AddSub.prototype.cleanupAction=new a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(239);Object.defineProperty(e,"AddSubCleanUp",{enumerable:!0,get:function(){return i.AddSubCleanUp}});var r=n(238);Object.defineProperty(e,"CommutativeGroupCleanup",{enumerable:!0,get:function(){return r.CommutativeGroupCleanup}});var o=n(237);Object.defineProperty(e,"MulDivCleanup",{enumerable:!0,get:function(){return o.MulDivCleanup}});var s=n(236);Object.defineProperty(e,"PowerCleanup",{enumerable:!0,get:function(){return s.PowerCleanup}});var a=n(235);Object.defineProperty(e,"ProductFractionCleanup",{enumerable:!0,get:function(){return a.ProductFractionCleanup}});var l=n(234);Object.defineProperty(e,"RadicalCleanup",{enumerable:!0,get:function(){return l.RadicalCleanup}});var u=n(233);Object.defineProperty(e,"SumCleanupAction",{enumerable:!0,get:function(){return u.SumCleanupAction}})},function(t,e,n){"use strict";var i,r=n(0),o=n(1),s=n(2),a=(n(5),n(3));r.gmath.actions.SplitProductAction=(i=function(t){s.Action.call(this,"SplitProductAction","n*x => (n-1)*x + x"),this.priority=1,this.triggerType="split",t&&(this.actor=t.actor,"priority"in t&&(this.priority=t.priority))},r.gmath.inherit(s.Action,i),i.prototype.match=function(t){return t.is_group("mul")&&t.children[1]instanceof a.Num&&t.children[1].value>1&&t.rs},i.prototype.transform=function(t){var e=this.getNewTreeNode(this.actor),n=e.parent,i=e.children[1];this.addTouchedNodes(this.actor),i.value--;var r,s=n.children.slice(n.children.indexOf(e)),l=this.getOldTreeNode(s),u=o.Tree.remove_range(s),c=a.AddSub.prototype.createParentGroup(),d=a.MulDiv.prototype.createParentGroup(),h=a.MulDiv.prototype.createParentGroup();1===i.value?(s=s.slice(1),d.insert_range(0,s),r=o.Tree.clone(s),h.insert_range(0,r),this.extendNodeMap(o.Tree.get_mapping_between(l.slice(1),r))):(d.insert_range(0,s),r=o.Tree.clone(s),h.insert_range(0,r),h.children[0].remove(),this.extendNodeMap(o.Tree.get_mapping_between(l,r))),c.append(new a.AddSub(d)),c.append(new a.AddSub(h));var p=new a.MulDiv(c);n.insert(u,p),this.cleanup(d),this.cleanup(h);var f=n.parent;return this.cleanup(n)&&this.cleanup(f),"function"==typeof t&&t(this),!0},i.prototype.mapIndex=function(){return map={},function(t){return map[t]}},new i)},function(t,e,n){"use strict";var i,r=n(0),o=n(1),s=n(2),a=(n(5),n(3));r.gmath.actions.SplitPowerAction=(i=function(t){s.Action.call(this,"SplitPowerAction","x^n => x^(n-1) * x"),this.priority=2,this.triggerType="split",t&&(this.actor=t.actor,"priority"in t&&(this.priority=t.priority))},r.gmath.inherit(s.Action,i),i.prototype.match=function(t){return t.is_group("exponent")&&t.children[0]instanceof a.Num&&t.children[0].value>=1},i.prototype.transform=function(t){var e=this.getNewTreeNode(this.actor),n=e.parent,i=n.parent;this.addTouchedNodes(this.actor);var r=n.remove(),s=a.MulDiv.prototype.createParentGroup();s.append(new a.MulDiv(n));var l=o.Tree.clone(n.children[0]);this.extendNodeMap(this.actor.parent.children[0].get_mapping_to(l)),s.append(new a.MulDiv(l));var u=e.children[0];if(u.value--,this.extendNodeMap(this.actor.children[0],l.parent),1===u.value){var c=n.children[0];n.remove(),s.children[0].append(c),this.extendNodeMap(this.actor.children[0],c.parent)}else 0===u.value&&s.children[0].remove();return this.resultNodes=s.children.slice(),i.insert(r,s),this.cleanup(i),"function"==typeof t&&t(this),!0},new i)},function(t,e,n){"use strict";var i,r=n(0),o=n(1),s=n(2),a=(n(5),n(3));r.gmath.actions.SplitPowerSumAction=(i=function(t){s.Action.call(this,"SplitPowerSumAction","x^(n1+n2+...+nm) => x^(n1+n2+...) * x^(nm)"),this.priority=3,this.triggerType="split",t&&(this.actor=t.actor)},r.gmath.inherit(s.Action,i),i.prototype.match=function(t){return t.is_group("exponent")&&(t.children[0].is_group("brackets")&&t.children[0].children[1].is_group("sum")||t.children[0].is_group("sum"))},i.prototype.transform=function(t){var e=this.getNewTreeNode(this.actor),n=e.parent,i=n.parent,r=e.children[0];r.is_group("brackets")&&(r=r.children[1]);var s=r.children[r.children.length-1],l=this.getOldTreeNode(s.children[0]);this.addTouchedNodes(this.actor.parent);var u=n.remove(),c=a.MulDiv.prototype.createParentGroup();c.append(new a.MulDiv(n));var d=o.Tree.clone(n);c.append(new a.MulDiv(d)),d.children[1].children[0].remove(),s.remove();var h=s.createParentGroup();return h.append(s),d.children[1].append(h),i.insert(u,c),l.parent.is_group("add")?this.updateNodeMap(l,c.children[1].children[0]):this.extendNodeMap(l,c.children[1].children[0]),this.cleanup(s.parent),this.cleanup(r),this.cleanup(i),"function"==typeof t&&t(this),!0},new i)},function(t,e,n){"use strict";var i,r=n(0),o=(n(1),n(2)),s=(n(5),n(3));r.gmath.actions.SplitNumberAction=(i=function(t){o.Action.call(this,"SplitNumberAction","n => (n-1) + 1"),this.priority=0,this.triggerType="split",t&&(this.actor=t.actor)},r.gmath.inherit(o.Action,i),i.prototype.match=function(t){return t instanceof s.Num&&t.value>1},i.prototype.transform=function(t){var e=this.getNewTreeNode(this.actor);this.addTouchedNodes(this.actor);var n=e.parent,i=e.remove();e.value--;var r=s.AddSub.prototype.createParentGroup();return r.append(new s.AddSub(e)),r.append(new s.AddSub(new s.Num(1))),this.resultNodes=r.children.slice(),this.updateNodeMap(this.actor.get_mapping_to(r)),n.insert(i,r),s.Brackets.handle(r),this.cleanup(n),"function"==typeof t&&t(this),!0},new i)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FactorOutOfBracketsAction=c;var i,r=n(0),o=n(1),s=n(2),a=n(5),l=(i=n(4))&&i.__esModule?i:{default:i},u=n(3);function c(t){s.Action.call(this,"FactorOutOfBracketsAction","factor out"),this.priority=0,this.triggerType="drag",this.settings={reset_x:!0,margin:{}},t&&(this.setActorAndTarget(t),this.settings.side=t.side,this.settings.margin["right-of"===t.side?"x2":"x1"]=-1.5)}r.gmath.inherit(s.Action,c),c.prototype.getAllAvailableActions=function(t){if(0===t.length)return[];for(var e=[],n=t[0];n.parent&&!n.is_group("brackets");)n=n.parent;return this.match(t)&&(e.push(this.bindLeftSideAction(n,t)),e.push(this.bindRightSideAction(n,t))),e},c.prototype.nodesAreAllAddends=function(t,e){return!!t.is_group("sum")&&t.children.length===e.length},c.prototype.bindLeftSideAction=function(t,e){var n=e[0].get_root();return this.createBoundAction(n,{nodes:e,target:t.children[0],side:"left-of"})},c.prototype.bindRightSideAction=function(t,e){var n=e[0].get_root();return this.createBoundAction(n,{nodes:e,target:t.children[2],side:"right-of"})},c.prototype.getContainingBrackets=function(t){try{for(var e=null,n=0;n<t.length;n++){var i=t[n][0],r=i.is_group("mul")?i.get_parent(4):i.get_parent(3);if(!r||!r.is_group("brackets")||u.Brackets.areHidden(r))return null;if(e){if(e!==r)return null}else e=r}return e}catch(t){return null}},c.prototype.match=function(t,e){var n=a.AlgebraModel.groupNodeRanges(t),i=this.getContainingBrackets(n);if(!i)return!1;if(e&&i.children[0]!==e&&i.children[2]!==e)return!1;if(!this.nodesAreAllAddends(i.children[1],n))return!1;var r=n[0].length;n.forEach(function(t){if(t.length!==r)return!1});for(var s=0;s<r;s++){var l;l="mul"===n[0][s].value?n[0][s].children[1].to_ascii():n[0][s].to_ascii();for(var u=0;u<n.length;u++)if(("mul"===n[u][s].value?n[u][s].children[1].to_ascii():n[u][s].to_ascii())!==l)return!1}var c=o.Tree.get_cca(t);return c.is_group("sum")&&c.parent===i},c.prototype.transform=function(t){var e=this.getNewTreeNode(this.nodes),n=this.findBracketGroup(e),i=a.AlgebraModel.groupNodeRanges(e),r=i.map(this.getOldTreeNode.bind(this));this.removeRangesFromSum(i);var o=this.factor(n,i,r);if(o.is_group("brackets")&&u.Brackets.is_optional(o)){var s=o.parent;u.Brackets.handle(o,!0),o=s}if(o.cleanupAction&&this.cleanup(o),"function"!=typeof t)return!0;t(this)},c.prototype.findBracketGroup=function(t){var e=t[0];if(e&&e.parent&&e.parent.parent&&e.parent.parent.is_group("sum")&&e.parent.parent.parent&&e.parent.parent.parent.is_group("brackets"))return e.parent.parent.parent;if(e&&e.parent&&e.parent.is_group("product")&&e.parent.parent&&e.parent.parent.parent&&e.parent.parent.parent.is_group("sum")&&e.parent.parent.parent.parent&&e.parent.parent.parent.parent.is_group("brackets"))return e.parent.parent.parent.parent;throw"Attempting to factor from invalid structure."},c.prototype.removeRangesFromSum=function(t){for(var e=0;e<t.length;e++){var n=t[e],i=t[e][0].parent;if(n.length===i.children.length){var r=i.parent;i.remove(),o.Tree.remove_range(n),r.append(new u.Num(1)),this.cleanup(r)}else"add"===i.value||"sub"===i.value&&1===n.length?(n[0].remove(),i.append(new u.Num(1))):(o.Tree.remove_range(t[e]),this.cleanup(i))}},c.prototype.factor=function(t,e,n){return this.replaceBracketGroupWithFactoredProduct(t,e,n)},c.prototype.replaceBracketGroupWithFactoredProduct=function(t,e,n){var i,r=u.MulDiv.prototype.createParentGroup(),s=t.parent,a=t.remove();if("left-of"===this.settings.side){1===(i=e[0]).length&&"mul"!==i[0].value&&(i=[new u.MulDiv(i[0])]),r.append_range(i),r.append(new u.MulDiv(t));for(var l=0;l<n.length;l++)1!==n[l].length||n[l][0].is_group("mul")?this.updateNodeMap(o.Tree.get_mapping_between(n[l],i)):this.updateNodeMap(n[l][0],i[0])}else for(1===(i=e[e.length-1]).length&&"mul"!==i[0].value&&(i=[new u.MulDiv(i[0])]),r.append(new u.MulDiv(t)),r.append_range(i),l=0;l<n.length;l++)1!==n[l].length||n[l][0].is_group("mul")?this.updateNodeMap(o.Tree.get_mapping_between(n[l],i)):this.updateNodeMap(n[l][0],i[0]);return o.Tree.insert(s,a,r),s},c.prototype.mapIndex=function(){return function(){}},(0,l.default)(c)},function(t,e,n){"use strict";var i,r=n(0),o=(n(1),n(2)),s=n(5),a=n(3);s.AlgebraModel.prototype.hideNodesAction=(i=function(t){o.Action.call(this,"HideNodesAction","apply hide rules")},r.gmath.inherit(o.Action,i),i.prototype.doInPlace=function(t,e){var n=!1;if(t.children.length>0){var r={hide_implicit_multiplication_setting:t.settings.get("hide_implicit_multiplication_setting")};t.children[0].for_each(function(e){var o=e.hidden,s=e.hide_afer_drop;if(e.hidden=!1,e.hide_after_drop=!1,t.settings.get("hide_leading_op")&&e instanceof a.Sym&&e.parent&&e.parent.commutative&&(e.parent.associative&&!e.parent.ls||"div"==e.parent.value&&e.parent.ls&&"//"==e.parent.ls.value)&&(e.parent.dragging?e.hide_after_drop=!0:e.hidden=!0),e instanceof a.Sym&&e.parent.is_group("fraction")&&a.ProductFraction.is_lone_fraction_part(e)&&(e.hidden=!0),("("===e.value||")"===e.value)&&!i.bracketsAreEssentialElementsToExpressionType(e.parent)){var l=e.parent;if(l.parent.vertical_notation||l.parent.parent&&l.parent.parent.vertical_notation){for(var u=l;u.is_group("brackets");)u=u.children[1];!a.Brackets.is_optional(u,l.parent)&&i.isLoneMulDivInNumeratorOrDenominator(l.parent)&&(e.parent.dragging?e.hide_after_drop=!0:e.hidden=!0)}}"("!==e.value&&")"!==e.value||!e.get_parent(2).is_group("radical")||3!==e.get_parent(1).get_idx()||(e.hidden=!0);for(var c=0;c<t.hide_rules.length&&!e.hidden;c++){var d=t.hide_rules[c];d.disabled||d.apply(e,r)}n=n||e.hidden!=o||e.hide_after_drop!=s})}if("function"!=typeof e)return n;e(this)},i.isLoneMulDivInNumeratorOrDenominator=function(t){return!(t.ls&&t.ls.is_group(t.value)||t.rs&&t.rs.is_group(t.value))},i.bracketsAreEssentialElementsToExpressionType=function(t){return t.is_group("brackets")&&t.children[1].is_group("tuple")},new i)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InequalityRewriteAction=d;var i=n(0),r=n(1),o=n(2),s=n(5),a=c(n(4)),l=n(3),u=c(n(23));function c(t){return t&&t.__esModule?t:{default:t}}function d(t){o.Action.call(this,"InequalityRewriteAction","rewrite inequality"),this.priority=1,this.triggerType="hold",this.settings={asynchronous:!0},t&&(this.actor=t.actor)}i.gmath.inherit(o.Action,d),d.prototype.toJSON=function(){var t=o.Action.prototype.toJSON.call(this);return this.latex&&(t.latex=this.latex),t},d.prototype.match=function(t){return!(!i.gmath.ui||!i.gmath.ui.Keyboard)&&l.Inequality.is_inequality(t)},d.prototype.transform=function(t){var e=this.getNewTreeNode(this.actor);if(this.latex){var n=new s.AlgebraModel(this.latex).children[0];return this.invertInequalityIfInputIsNegative(n,e),this.replaceSideWithInput(e.children[0],n),this.replaceSideWithInput(e.children[2],n),"function"==typeof t&&t(this),this}var r=i.gmath.ui.Keyboard();function o(){return this.endKeyboardInteraction(r),"function"==typeof t&&t(!1),!1}function a(t,e,n){r.warning(e,n),this.oldTree.events.mistake({selection:this.actor,model:this.oldTree,target:t,method:"keypad"})}r.caption("Enter an operation to apply to both sides of the equation.").on("done",function(n){var i;this.latex=n;try{i=this.newTree.parse(n,!0)}catch(t){return console.log(t),void a.call(this,null,"Could not parse expression.")}return i?s.AlgebraModel.getNodes("E",0,i)?"E"===i.to_ascii()?(a.call(this,i,'You made no changes. Try adding something to "E."'),this.pressed_done_with_same_expression&&o(),void(this.pressed_done_with_same_expression=!0)):l.Inequality.is_relation(i)?(i.is_group("equals")?a.call(this,i,'You should not type an equation now. Try typing something like "E + 2" or "sin(E)" instead.'):a.call(this,i,'You should not type an inequality now. Try typing something like "E + 2" or "sin(E)" instead.'),void(this.pressed_done_with_same_expression=!1)):(this.invertInequalityIfInputIsNegative(i,e),this.replaceSideWithInput(e.children[0],i),this.replaceSideWithInput(e.children[2],i),this.endKeyboardInteraction(r),"function"==typeof t&&t(this),this):(a.call(this,i,'There needs to be an "E" in the expression.'),void(this.pressed_done_with_same_expression=!1)):(a.call(this,i,'Please enter an expression with one or more "E"s.'),void(this.pressed_done_with_same_expression=!1))}.bind(this)).on("cancel",o.bind(this)),(0,u.default)(r,"E")},d.prototype.invertInequalityIfInputIsNegative=function(t,e){var n=!1,i=!1;t.is_group("product","fraction")&&function t(e){e.is_group("power")&&l.Num.is_num(e.get_child([1,0]))&&l.Num.get_value(e.get_child([1,0]))%2==0||(e.is_group("sign")?(n=!n,t(e.get_child([1]))):0!==e.children.length||l.Num.is_num(e)||e instanceof l.Sym||"E"===e.to_ascii()?e.children.length&&e.children.forEach(t):i=!0)}(t),n&&e.invert(),i&&(this.settings.restraint="All new terms must evaluate to a positive number.")},d.prototype.replaceSideWithInput=function(t,e){var n=e.clone(),i=s.AlgebraModel.getNodes("E",0,n);r.Tree.replace(t,n),r.Tree.replace(i,t),l.Brackets.handle(t),this.cleanup(t.parent)},(0,a.default)(d,!1,l.Inequality)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FractionRewriteAction=u;var i=n(0),r=(n(1),n(2)),o=l(n(4)),s=n(3),a=l(n(23));function l(t){return t&&t.__esModule?t:{default:t}}function u(t){r.Action.call(this,"FractionRewriteAction","extend fraction"),this.priority=0,this.triggerType="hold",this.settings={asynchronous:!0},this.latex=null,t&&(this.actor=t.actor)}i.gmath.inherit(r.Action,u),u.prototype.toJSON=function(){var t=r.Action.prototype.toJSON.call(this);return this.latex&&(t.latex=this.latex),t},u.prototype.match=function(t){return!(!i.gmath.ui||!i.gmath.ui.Keyboard)&&t.is_group("fraction")},u.prototype.transform=function(t){var e;if(this.latex)return e=this.newTree.parse(this.latex,!0),this.extendFraction(this.getNewTreeNode(this.actor),e),"function"==typeof t&&t(this),this;var n=i.gmath.ui.Keyboard();function r(t,e,i){n.warning(e,i),this.oldTree.events.mistake({selection:this.actor,model:this.oldTree,target:t,method:"keypad"})}n.caption("Enter a term with which to multiply the numerator and denominator of this fraction.").on("done",function(i){try{e=this.newTree.parse(i,!0),this.latex=i}catch(t){return console.log(t),void r.call(this,null,"Could not parse expression.")}e?u.acceptTerm(e)?(this.extendFraction(this.getNewTreeNode(this.actor),e),this.endKeyboardInteraction(n),t(this)):r.call(this,e,"You can't extend the fraction with this expression."):r.call(this,e,"Please enter an expression.")}.bind(this)).on("cancel",function(){this.endKeyboardInteraction(n),t(!1)}.bind(this)),(0,a.default)(n,"")},u.acceptTerm=function(t){return!(t.is_group("brackets")&&t.get_child([1]).is_group("tuple")||t.is_group("equals"))},u.prototype.extendFraction=function(t,e){var n=new s.MulDiv(e,"mul"),i=new s.MulDiv(e.clone(),"div");t.append(n),t.append(i),this.cleanup(n),this.cleanup(i)},(0,o.default)(u,!1,s.ProductFraction)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FirstLineRewriteAction=l;var i=n(0),r=(n(1),n(2)),o=a(n(4)),s=(n(3),a(n(23)));function a(t){return t&&t.__esModule?t:{default:t}}function l(t){r.Action.call(this,"FirstLineRewriteAction","rewrite dl line"),this.settings={asynchronous:!0},this.priority=0,t&&(this.actor=t.actor)}i.gmath.inherit(r.Action,l),l.prototype.match=function(){return i.gmath.ui&&i.gmath.ui.Keyboard},l.prototype.removeAllNodesFromNodeMap=function(){for(var t in this.newTree.select_all(),this.node_map)this.node_map[t]=[]},l.prototype.transform=function(t){var e=i.gmath.ui.Keyboard(),n=this.newTree.to_latex();n=n.replace(/\\dottedsquare/g,"⬚"),e.caption("Correct any mistakes you made in this expression.").on("done",function(n){var i=this.newTree,r=i.parse(n,!0);r&&(i.children[0].remove(),i.append(r),this.removeAllNodesFromNodeMap(),this.endKeyboardInteraction(e),t(this))}.bind(this)).on("cancel",function(){this.endKeyboardInteraction(e),t(!1)}.bind(this)),(0,s.default)(e,n)},(0,o.default)(l,!1)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EquationRewriteAction=d;var i=n(0),r=n(1),o=n(2),s=n(5),a=c(n(4)),l=n(3),u=c(n(23));function c(t){return t&&t.__esModule?t:{default:t}}function d(t){o.Action.call(this,"EquationRewriteAction","rewrite equation"),this.priority=1,this.triggerType="hold",this.settings={asynchronous:!0},this.latex=null,t&&(this.actor=t.actor)}i.gmath.inherit(o.Action,d),d.prototype.toJSON=function(){var t=o.Action.prototype.toJSON.call(this);return this.latex&&(t.latex=this.latex),t},d.prototype.match=function(t){return!(!i.gmath.ui||!i.gmath.ui.Keyboard)&&t.is_group("equals")},d.prototype.transform=function(t){var e=this.getNewTreeNode(this.actor);if(this.latex){var n=new s.AlgebraModel(this.latex).children[0];return this.replaceSideWithInput(e.children[0],n),this.replaceSideWithInput(e.children[2],n),"function"==typeof t&&t(this),this}var r=i.gmath.ui.Keyboard();function o(){return this.endKeyboardInteraction(r),"function"==typeof t&&t(!1),!1}function a(t,e){r.warning(e),this.oldTree.events.mistake({selection:this.actor,target:t,model:this.oldTree,method:"keypad"})}r.caption("Enter an operation to apply to both sides of the equation.").on("done",function(n){var i;this.latex=n;try{i=this.newTree.parse(n,!0)}catch(t){return console.log(t),void a.call(this,null,"Could not parse expression.")}return i?s.AlgebraModel.getNodes("E",0,i)?"E"===i.to_ascii()?(a.call(this,i,'You made no changes. Try adding something to "E".'),this.pressed_done_with_same_expression&&o(),void(this.pressed_done_with_same_expression=!0)):l.Inequality.is_relation(i)?(i.is_group("equals")?a.call(this,i,'You should not type an equation now. Try typing something like "E + 2" or "sin(E)" instead.'):a.call(this,i,'You should not type an inequality now. Try typing something like "E + 2" or "sin(E)" instead.'),void(this.pressed_done_with_same_expression=!1)):(this.replaceSideWithInput(e.children[0],i),this.replaceSideWithInput(e.children[2],i),this.endKeyboardInteraction(r),"function"==typeof t&&t(this),this):(a.call(this,i,'There needs to be an "E" in the expression.'),void(this.pressed_done_with_same_expression=!1)):(a.call(this,i,'Please enter an expression with one or more "E"s.'),void(this.pressed_done_with_same_expression=!1))}.bind(this)).on("cancel",o.bind(this)),(0,u.default)(r,"E")},d.prototype.replaceSideWithInput=function(t,e){var n=e.clone(),i=s.AlgebraModel.getNodes("E",0,n);r.Tree.replace(t,n),i.is_group("tuple")&&(i=i.get_child([0,1])),r.Tree.replace(i,t),l.Brackets.handle(t),this.cleanup(t.parent)},(0,a.default)(d,!1,l.Equals)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CombinationRewriteAction=d;var i=n(0),r=n(1),o=n(2),s=n(5),a=c(n(4)),l=n(3),u=c(n(23));function c(t){return t&&t.__esModule?t:{default:t}}function d(t){o.Action.call(this,"CombinationRewriteAction","combine equations"),this.settings={asynchronous:!0,side:"below",margin:{y1:.2,y2:-1},layout_hint:"new-line"},t&&(this.nodes=t.nodes,this.target=t.target,this.source_am=this.nodes[0]),this.new_derivation=!0}i.gmath.inherit(o.Action,d),d.prototype.toJSON=function(){var t=o.Action.prototype.toJSON.call(this);return this.latex&&(t.latex=this.latex),t},d.prototype.rebind=function(t,e,n){if(this.source_am===n)this.nodes[0]=t,this.source_am=t;else{if(this.oldTree!==n)throw"wrong old tree during rebinding an action!";var i=new o.Action;i.node_map=e,this.oldTree=t,this.target=i.mapNodes(this.target)[0],this.new_derivation=!this.target.is_group("equals")}},d.prototype.rematch=function(){if(!(this.nodes&&this.nodes.length>0&&this.target))return!1;var t=this.getAllAvailableActions(this.source_am,this.target);return this.target===t[0].target},d.prototype.getAllAvailableActions=function(t,e){return t.children[0].is_group("equals")&&!e.is_group("equals")?[]:[this.createBoundAction(e.parent,{nodes:[t],target:e})]},d.prototype.transform=function(t){var e=this.getNewTreeNode(this.target),n=this.source_am.children[0].clone();if(this.new_derivation=!this.target.is_group("equals"),this.latex){var r=this.newTree.parse(this.latex,!0);return e.is_group("equals")?(this.combineEquations(r,e,n),e.children[0].children.forEach(function(t){this.cleanup(t)},this),e.children[2].children.forEach(function(t){this.cleanup(t)},this)):(this.combineExpressions(r,e,n),e.children.forEach(function(t){this.cleanup(t)},this)),"function"==typeof t&&t(this),this}var o=i.gmath.ui.Keyboard();function a(t,i){o.warning(i),this.oldTree.events.mistake({selection:n,target:t,model:e,method:"keypad"})}o.caption("Combine the "+(n.is_group("equals")?"equations":"expressions")+" E₁ and E₂.").on("done",function(i){this.latex=i;try{var r=this.newTree.parse(i,!0)}catch(t){return console.log(t),void a.call(this,null,"Could not parse expression.")}if(r)if(s.AlgebraModel.getNodes("E_1",0,r)||s.AlgebraModel.getNodes("E_2",0,r))if(s.AlgebraModel.getNodes("E_1",0,r))if(s.AlgebraModel.getNodes("E_2",0,r)){if(e.is_group("equals")){this.combineEquations(r,e,n);for(var l=e.children[0].children,u=e.children[2].children,c=l.length-1;c>=0;c--)this.cleanup(l[c]);for(var d=u.length-1;d>=0;d--)this.cleanup(u[d])}else{this.combineExpressions(r,e,n);for(var h=e.children.length-1;h>=0;h--)this.cleanup(e.children[h])}this.endKeyboardInteraction(o),t(this)}else a.call(this,r,"Your entered expression is missing E₂.");else a.call(this,r,"Your entered expression is missing E₁.");else a.call(this,r,"Your entered expression must contain both E₁ and E₂.");else a.call(this,r,"Please enter an expression containing E₁ and E₂.")}.bind(this)).on("cancel",function(){this.endKeyboardInteraction(o),t(!1)}.bind(this)),(0,u.default)(o,"E_1+E_2")},d.prototype.combineEquations=function(t,e,n){var i=e.children[0],o=this.target.children[0],s=e.children[2],a=this.target.children[2],l=n.is_group("equals")?n.children[0]:n,u=n.is_group("equals")?this.source_am.children[0].children[0]:this.source_am.children[0],c=n.is_group("equals")?n.children[2]:n,d=n.is_group("equals")?this.source_am.children[0].children[2]:this.source_am.children[0],h=t.clone(),p=t.clone();r.Tree.replace(i,h),r.Tree.replace(s,p),this.replaceAll("E_1",h,i,o),this.replaceAll("E_2",h,l,u),this.replaceAll("E_1",p,s,a),this.replaceAll("E_2",p,c,d)},d.prototype.combineExpressions=function(t,e,n){var i=this.target,o=this.source_am.children[0];r.Tree.replace(e,t),this.replaceAll("E_1",t,e,i),this.replaceAll("E_2",t,n,o)},d.prototype.replaceAll=function(t,e,n,i){s.AlgebraModel.getNodes(t,"all",e).forEach(function(t){var e=n.clone();r.Tree.replace(t,e),this.updateNodeMap(i.get_mapping_to(e)),l.Brackets.handle(e)},this)},(0,a.default)(d,!1)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DirectSubstitutionAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),s=n(1),a=n(2),l=n(5),u=(i=n(4))&&i.__esModule?i:{default:i},c=n(3),d=e.DirectSubstitutionAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"DirectSubstitutionAction","substitution"));return n.triggerType="drag",n.priority=10,n.settings={delay:400,on_release:!0,side:"inside"},t&&(n.nodes=t.nodes,n.target=t.target,n.source_am=t.nodes[0].get_root()),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.Action),r(e,[{key:"getAllAvailableActions",value:function(t,e){var n=h(t);if(!n)return[];var i=p(n,e);return this.bindActionForEachTarget(t,i,e)}},{key:"bindActionForEachTarget",value:function(t,e,n){var i=this;return e.map(function(e){return i.createBoundAction(n,{nodes:t,target:e,side:"around"})})}},{key:"getTargetsForHighlighting",value:function(){if(!this.nodes||!this.target)return[];try{var t=h(this.nodes,this.target);return t.use_equality?o.gmath.array.flatten(f(t.nodes,this.target[0].get_root())):o.gmath.array.flatten(f(this.target))}catch(t){throw"[DirectSubstitutionAction] The action's settings were corrupted."}}},{key:"rebind",value:function(t,e,n){if(this.source_am===n)(i=new a.Action).node_map=e,this.nodes=i.mapNodes(this.nodes),this.source_am=t;else{if(this.oldTree!==n)throw"wrong old tree during rebinding an action!";var i;(i=new a.Action).node_map=e,this.target=i.mapNodes(this.target),this.oldTree=t}}},{key:"rematch",value:function(){if(!(this.nodes&&this.nodes.length>0&&this.target&&this.target.length>0))return!1;var t=h(this.nodes);if(!t)return!1;var e=p(t,this.oldTree),n=m(g(this.target));return e.some(n)}},{key:"transform",value:function(t){var e=this,n=this.getNewTreeNode(this.target),i=h(this.nodes,n),r=i.substitutes,o=f(i.use_equality?i.nodes:n,n[0].get_root()),a=f(i.use_equality?i.nodes:n,this.target[0].get_root());return o.forEach(function(t,n){var o=t[0].parent,u=s.Tree.remove_range(t),d=l.AlgebraModel.cloneNodes(r),h=void 0;e.extendNodeMap(s.Tree.get_mapping_between(r,d)),1===d.length?h=d[0]:(d[0].is_group("div")&&d.forEach(function(t){return t.invert()}),(h=d[0].createParentGroup()).append_range(d)),1===t.length&&t[0].is_group("sub")&&!i.nodes[0].is_group("add","sub")&&(h=new c.AddSub(h)),t.length>1&&(h=new t[0].constructor(h)).is_group("mul")&&t[0].is_group("div")&&h.invert(),o.insert(u,h),i.is_neg&&c.Sign.invertTerm(h),a[n].forEach(function(t){e.updateNodeMap(t,h),e.updateNodeMap(s.Tree.get_leaf_nodes(t),s.Tree.get_leaf_nodes(h))});var p=e.applyInnerAction("AddSubCombineSigns",{actor:h});p||"AlgebraModel"===o.type||(!(p=e.applyInnerAction("AddSubCombineSigns",{actor:o}))&&o.parent.parent&&(p=e.applyInnerAction("AddSubCombineSigns",{actor:o.parent.parent})),p||e.applyInnerAction("SignDoubleNegAction",{actor:o})),!e.cleanup(h)&&h.parent&&c.Brackets.handle(h),e.cleanup(o)}),t&&t(this),!0}}]),e}();function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!s.Tree.is_range(t))return!1;if(c.Inequality.is_relation(t[0]))return!1;var n=t.slice();if(1===t.length){if(t[0].parent&&t[0].parent.is_group("func"))return!1;t[0].is_group("add","sub","addsub","param","mul","div")?n[0]=n[0].children[1]:t[0].is_group("exponent","degree")&&(n[0]=n[0].children[0])}if(n[0].is_group("placeholder"))return!1;var i=1===t.length&&t[0].is_group("sub")||t[0].parent.is_group("product")&&0===t[0].get_idx&&t[0].parent.parent.is_group("sign","sub"),r=!1,o=n.slice(),a=c.Inequality.is_relation(t[0].parent)&&c.Equals.getOppositeSide(t[0]),l=v(t);return!a||l||v([a])||e&&!m(g(n))(e)||(r=!0,o=[a]),{dragged_nodes:t,nodes:n,substitutes:o,use_equality:r,contains_placeholder:l,is_neg:i}}function p(t,e){var n=[],i=m(g(t.nodes));t.use_equality&&(n=t.nodes.length>1||t.nodes[0].is_group("sum","product")?e.filterRange(i):e.filter(function(t){return i([t])}).map(function(t){return[t]}));var r=s.Tree.filter(function(t){return t.is_group("var")},t.nodes);return n.concat(e.filter(function(e){return!e.fixed&&!(e.parent&&e.parent.is_group("func"))&&(t.contains_placeholder?e.is_group("placeholder"):e.is_group("placeholder","var"))&&!r.find(function(t){return function(t,e){return t.to_ascii()===e.to_ascii()}(e,t)})}).map(function(t){return[t]}))}function f(t,e){var n=m(g(t));return e=e||t[0].get_root(),t.length>1||t[0].is_group("sum","product")?e.filterRange(n,!0):e.filter(function(t){return n([t])}).map(function(t){return[t]})}function g(t){return 1===t.length&&(t[0].hidden||t[0].is_group("tuple"))?"":t.map(function(t){return t.to_ascii()}).join("")}function m(t){return function(e){if(0===e.length)return!1;if(e[0].fixed)return!1;if(!e[0].parent)return!1;if(e[0].parent.parent&&function(t){return t[0]&&t[0].parent&&!t[0].parent.is_group("exponent")&&t.length===t[0].parent.children.length}(e))return!1;if(1===e.length&&e[0].parent.is_group("func"))return!1;var n=function(t){return t.length<2?"":t[0].is_group("div")?t.map(function(t){return t.to_ascii()}).join("").replace(/\//g,"*"):""}(e);return g(e)===t||function(t){if(0===t.length)return"";if(1===t.length&&(t[0].hidden||t[0].is_group("tuple")))return"";var e,n=t.map(function(t){return t.to_ascii()}).join("");return 1===t.length?n:(e=t[0]).is_group()&&e.commutative&&e.associative?n.substring(t[0].children[0].to_ascii().length):n}(e)===t||function(t){if(1!==t.length)return"";if(!t[0].is_group("fraction"))return"";var e=t[0].to_ascii();return"("===e.slice(0,1)&&")"===e.slice(e.length-1,e.length)&&(e=e.substr(1,e.length-2)),e}(e)===t||n===t||n.substr(1)===t}}function v(t){return s.Tree.select_first(function(t){return t.is_group("placeholder")},t)}(0,u.default)(d,!1)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SplitExponentsAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"SplitExponentsAction","split exponents"),this.triggerType="drag",this.settings={margin:{}},t&&(this.nodes=t.nodes,this.target=t.target,this.settings.side=t.side,this.settings.margin="right-of"===t.side?{x2:-1,x1:.25}:{x1:-1})}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){if(!this.match(t[0]))return[];if(t.length===t[0].parent.children.length)return[];var e=t[0].get_root(),n=t[0].parent.parent.parent.parent;return[this.createBoundAction(e,{nodes:t,target:n,side:"left-of"}),this.createBoundAction(e,{nodes:t,target:n,side:"right-of"})]},u.prototype.match=function(t){return t.is_group("add","sub")&&t.get_parent(3)&&t.get_parent(3).is_group("exponent")},u.prototype.transform=function(t){var e=this.getSourceAndTarget(!0);this.addTouchedNodes(e.target);var n=this.getNewTreeNode(e.source),i=n[0].parent,r=this.getNewTreeNode(e.target),s=r.parent,a=r.remove();o.Tree.remove_range(n);var u=r.children[0].clone(),c=new l.Sum;c.append_range(n);var d=new l.Power(u,c);this.extendMapFromPowerToPower(e.target,d);var h=new l.ProductFraction;h.append(new l.MulDiv(r));var p=new l.MulDiv(d);if(h.insert("left-of"===this.settings.side?0:1,p),this.setNodesToReselectAfterAction(p),s.insert(a,h),this.cleanNodes(i,c),this.cleanup(s),d.children[1].simplify=!0,"function"!=typeof t)return!0;t(this)},u.prototype.extendMapFromPowerToPower=function(t,e){this.extendNodeMap(t.children[0].get_mapping_to(e.children[0])),this.extendNodeMap(t.children[1],e.children[1]),this.extendNodeMap(t.get_child([1,0]),e.get_child([1,0])),this.extendNodeMap(t.get_child([1,0,0]),e.get_child([1,0,0])),this.extendNodeMap(t.get_child([1,0,2]),e.get_child([1,0,2])),this.extendNodeMap(t.get_child([1,0,1]),e.get_child([1,0,1]))},u.prototype.cleanNodes=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(this.cleanup.bind(this))},(0,a.default)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SignZeroAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"SignZeroAction","-0=0"),this.priority=0,this.triggerType="tap",t&&(this.actor=t.actor)}r.gmath.inherit(s.Action,u),u.prototype.match=function(t){return t.children[1]instanceof l.Num&&0===t.children[1].value},u.prototype.transform=function(t){var e=this.getNewTreeNode(this.actor),n=e.children[1];if(this.addTouchedNodes(this.actor),this.updateNodeMap(this.actor.get_mapping_to(n)),o.Tree.replace(e,n),"function"!=typeof t)return this;t(this)},(0,a.default)(u,!1,l.Sign)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MoveSignIntoBracketsAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"MoveSignIntoBracketsAction","move sign into brackets"),this.priority=0,this.triggerType="tap",t&&(this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.match=function(t){return!!t.is_group("sign")&&!!t.children[1].is_group("brackets")&&t.children[1].children[1].is_group("product","sum")},l.prototype.transform=function(t){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor),n=e.children[1],i=n.children[1],r=e.parent,o=e.remove();if(n.remove(),i.remove(),i.is_group("product")?this.applySignToProductFraction(i,e):this.applySignToSum(i,e),r.insert(o,i),this.cleanup(i),a.Brackets.handle(i),this.cleanup(r),"function"!=typeof t)return!0;t(this)},l.prototype.applySignToProductFraction=function(t,e){var n=t.children[0].children[1];n.remove(),e.append(n),t.children[0].append(e),n.is_group("sign")&&(this.followup=r.gmath.actions.SignDoubleNegAction.createBoundAction(this.newTree,{actor:e}))},l.prototype.applySignToSum=function(t,e){t.children.forEach(function(t){t.invert()})},(0,s.default)(l,!1,a.Sign)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SignInEvenPowerAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(n(0),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3),l=e.SignInEvenPowerAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"SignInEvenPowerAction","remove a sign inside an even power"));return n.priority=0,n.triggerType="tap",t&&n.initSettings(t),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),r(e,[{key:"match",value:function(t){return t.is_group("sign","plusminus")&&t.parent.is_group("brackets")&&a.Power.hasEvenExponent(t.parent.parent)}},{key:"transform",value:function(t){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor),n=e.parent;if(e.replace_with(e.children[1]),a.Brackets.handle(n,!0),"function"!=typeof t)return!0;t(this)}}]),e}();(0,s.default)(l,!1,a.Sign)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SignDoubleNegAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"SignDoubleNegAction","--x=x"),this.priority=0,this.triggerType="tap",t&&(this.actor=t.actor)}r.gmath.inherit(s.Action,u),u.prototype.match=function(t){return!(!t.is_group("sign","plusminus")||!t.children[1].is_group("sign","plusminus"))||!(!t.is_group("sign","plusminus")||!t.parent.is_group("sign","plusminus"))},u.prototype.transform=function(t){this.getNewTreeNode(this.actor);var e=this.actor.parent.is_group("sign","plusminus")?this.actor.parent:this.actor,n=this.actor.parent.is_group("sign","plusminus")?this.actor:this.actor.children[1],i=this.getNewTreeNode(e),r=this.getNewTreeNode(n),s=r.children[1];if(this.addTouchedNodes(e),this.addTouchedNodes(n),e.is_group("sign")&&n.is_group("sign")?o.Tree.replace(i,s):i.is_group("plusminus")?(o.Tree.replace(r,s),this.updateNodeMap(n,i)):r.is_group("plusminus")&&(o.Tree.replace(i,r),this.updateNodeMap(e,r)),"function"!=typeof t)return!0;t(this)},(0,a.default)(u,!1,l.Sign)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.showRoundedAction=a;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i};function a(t){o.Action.call(this,"showRoundedAction","show rounded"),this.priority=1,this.triggerType="hold",t&&(this.actor=t.actor)}n(3),r.gmath.inherit(o.Action,a),a.prototype.match=function(t){return!!t.is_group("num")&&(null===t.precision||t.decimal_count()>t.precision)},a.prototype.transform=function(t){var e=this.getNewTreeNode(this.actor);return null===e.precision?e.precision=2:e.precision=null,"function"==typeof t&&t(this),this},(0,s.default)(a,!1)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScaleTupleAction=c;var r,o=i(0),s=i(1),a=i(2),l=(r=i(4))&&r.__esModule?r:{default:r},u=i(3);function c(t){a.Action.call(this,"ScaleTupleAction","multiply a tuple by a number"),this.priority=1,this.triggerType="tap",this.settings={delay:300,side:"inside",reset_x:!0,reset_y:!0},t&&("drag"===t.triggerType?(this.triggerType=t.triggerType,this.nodes=t.nodes,this.target=t.target):this.actor=t.actor)}o.gmath.inherit(a.Action,c),c.prototype.isTupleMul=function(t){return t&&t.is_group("mul")&&t.children[1].is_group("brackets")&&t.children[1].children[1].is_group("tuple")},c.prototype.getAllAvailableActions=function(t){if(!t.every(this.isScalarMul.bind(this)))return[];var e=this,n=t[0].parent.children.filter(this.isTupleMul.bind(this)),i=t[0].get_root();return n.map(function(n){return e.createBoundAction(i,{nodes:t,target:n,triggerType:"drag"})})},c.prototype.getTupleFactorsInSum=function(t){var e=this;return re,sum.children.filter(function(t){return t!==n&&e.isTupleAddend(t,len)})},c.prototype.isScalarMul=function(t){return t&&t.is_group("mul","div")&&!t.select_first(function(t){return t.is_group("tuple")})},c.prototype.extract=function(t){return!!t&&(this.isTupleMul(t)&&this.isScalarMul(t.ls)?{scalars:[t.ls],tuple:t}:!(!this.isTupleMul(t.ls)||!this.isScalarMul(t))&&{scalars:[t],tuple:t.ls})},c.prototype.match=function(t){if(t.is_group("fraction")){var e=t.get_top(),n=t.get_bottom();if(1===e.length&&this.isTupleMul(e[0])&&n.every(this.isScalarMul))return!0}else if(t.is_group("mul","div"))return!!this.extract(t);return!1},c.prototype.getTupleAndScalars=function(){var t={};if("tap"===this.triggerType){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor);if(this.actor.is_group("fraction"))t.parent_product=e,t.tuple=e.get_child([0,1,1]),t.scalar_muldivs=e.get_bottom();else{var n=this.extract(e);t.scalars_were_on_the_left=n.scalars[0].get_idx()<n.tuple.get_idx(),t.parent_product=e.parent,t.tuple=n.tuple.get_child([1,1]),t.scalar_muldivs=n.scalars}}else{this.addTouchedNodes(this.nodes),this.addTouchedNodes(this.target);var i=this.getNewTreeNode(this.nodes),r=this.getNewTreeNode(this.target);t.scalars_were_on_the_left=i[0].get_idx()<r.get_idx(),t.parent_product=i[0].parent,t.scalar_muldivs=i,t.tuple=r.get_child([1,1])}return t},c.prototype.transform=function(t){for(var e=this.getTupleAndScalars(),n=e.scalars_were_on_the_left,i=e.parent_product,r=e.scalar_muldivs,o=e.tuple,a=0;a<o.children.length;a++)this.scale_parameter(n,o.children[a],r);for(s.Tree.remove_range(r),this.cleanup(i),a=0;a<o.children.length;a++)this.cleanup_nested_products(o.children[a].children[1]);return"function"==typeof t&&t(this),this},c.prototype.scale_parameter=function(t,e,n){var i=e.children[1],r=i.is_group("fraction")?i:new u.ProductFraction,o=s.Tree.clone(n);this.extendNodeMap(s.Tree.get_mapping_between(this.nodes||this.getOldTreeNode(n),o)),i.remove(),r.is_group("product")?(r.append(new u.MulDiv(i)),r.insert_range(t?0:1,o)):t?o.forEach(function(t){t.is_group("div")?r.insert_into_denominator(0,t):r.insert(0,t)}):o.forEach(function(t){r.append(t)}),r.simplify=!0,e.append(r)},c.prototype.cleanup_nested_products=function(t){for(var e=0;e<t.children.length;e++)this.cleanup(t.children[e])},(0,l.default)(c,!0,u.MulDiv,u.ProductFraction)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RadicalSplitAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(n(0),n(1)),s=n(2),a=n(5),l=(i=n(4))&&i.__esModule?i:{default:i},u=n(3),c=n(57),d=e.RadicalSplitAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"RadicalSplitAction","turn a radical that has a product radicand into a product of radicals"));return n.priority=1,n.triggerType="drag",n.settings={target_group:!0,group_side:"outside",margin:{x2:-.2,y:-.75}},n.elements=[],t&&(t.target&&"AlgebraModel"!==t.target.type&&(t.drop_area={node:t.target.parent.parent},t.drop_area_hint={margin:"left-of"===t.side?{x1:-.5,x2:.1}:{x1:.1,x2:-.5}},t.destination_hint=[{node:t.target.parent.parent,margin:"left-of"===t.side?{y1:-.1}:{x1:.15,x2:-.15,y1:-.1}}]),n.initSettings(t)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.Action),r(e,[{key:"getAllAvailableActions",value:function(t){var e=function(t){if(!o.Tree.is_range(t))return!1;var e=t[0];if(!e.is_group("mul","div"))return!1;if(!e.parent.parent||!e.parent.parent.parent||!e.get_parent(3).is_group("radical"))return!1;var n=(0,c.evalExpression)(t),i=(0,c.evalExpression)(u.Group.get_siblings(t).filter(function(t){return t.is_group("mul","div")}));return!!(isNaN(n)||n>=0||isNaN(i)||i>=0)&&{nodes:t,radicand:e.parent}}(t);if(!e)return[];var n=[e.radicand];return this.bindActionForEachTarget(t,n,!0)}},{key:"rematch",value:function(){return"AlgebraModel"===this.target.type||this.getAllAvailableActions(this.nodes).length>0}},{key:"rebind",value:function(t,e,n){if(this.oldTree!==n)throw"wrong old tree during rebinding an action!";var i=new s.Action;i.node_map=e,this.oldTree=t,this.nodes=i.mapNodes(this.nodes),!this.target||this.target instanceof a.AlgebraModel?this.target={type:"AlgebraModel"}:this.target=i.mapNodes(this.target)[0]}},{key:"transform",value:function(t){return this.target&&"AlgebraModel"===this.target.type?this.transformUpdate(t):this.transformInitial(t)}},{key:"transformInitial",value:function(t){this.addTouchedNodes(this.target.parent);var e=this.getNewTreeNode(this.nodes);isNaN((0,c.evalExpression)(e))&&this.elements.push(this.defineRestrictionExpression(e));var n=u.Group.get_siblings(e).filter(function(t){return t.is_group("mul","div")});isNaN((0,c.evalExpression)(n))&&this.elements.push(this.defineRestrictionExpression(n));var i=e[0].parent,r=i.get_parent(2),s=r.parent,a=r.remove();o.Tree.remove_range(e);var l=r.clone(!1);l.set_radicand(null);var d=!1,h=new u.ProductFraction;1===e.length&&u.ProductFraction.is_fraction_with_identity_numerator(e[0].children[1])&&(e=e[0].children[1].get_bottom(),o.Tree.remove_range(e)),e.forEach(function(t){t.is_group("div")&&(d=!0,t.invert()),h.append(t)},this),l.set_radicand(h);var p=new u.ProductFraction;p.append(new u.MulDiv(r));var f=new u.MulDiv(l,d?"div":"mul");return p.insert("left-of"===this.settings.side?0:1,f),s.insert(a,p),this.nodes[0].get_parent(3).map_to_radical(this,l),this.setNodesToReselectAfterAction(f),this.cleanup(i),this.cleanup(h),this.cleanup(p),this.cleanup_cascade(s),"function"==typeof t&&t(this),this}},{key:"transformUpdate",value:function(t){return this.node_map={},this.createRestrictionModel(this.newTree,this.nodes),this.target=this.newTree,"function"==typeof t&&t(this),!0}},{key:"createRestrictionModel",value:function(t,e){var n=this;t.children[0].remove();var i=a.AlgebraModel.cloneNodes(e),r=void 0;1===e.length?r=i[0].children[1]:(r=new u.ProductFraction,i.forEach(function(t){return r.append(t)}));var o=new u.Inequality(r,new u.Num(0),"gte");return t.append(o),t.hide_nodes(),1===e.length?this.updateNodeMap(e[0].children[1].get_mapping_to(r)):e.forEach(function(t,e){return n.updateNodeMap(t.get_mapping_to(r.children[e]))}),t}}]),e}();(0,l.default)(d)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RadicalInsertExponentAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){if(s.Action.call(this,"RadicalInsertExponentAction","factor power"),this.interactionType="drag",this.settings={side:"inside",reset_x:!0,reset_y:!0},t){var e=t.target.children[3],n={node:e},i=[{node:e,side:"right-of",margin:{y2:.5}}];this.initSettings(r.gmath.extend(t,{drop_area_hint:n,destination_hint:i}))}}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n)},u.prototype.matchSource=function(t){if(!o.Tree.is_range(t))return!1;if(!(t[0].is_group("exponent")||t[0].is_group("mul","div")&&l.Brackets.areHidden(t[0].get_parent(2))&&t[0].get_parent(3).is_group("exponent")))return!1;var e=t[0].parent.is_group("power")?t[0].parent:t[0].get_parent(4);return!(!e.children[0].is_group("brackets")||!e.children[0].children[1].is_group("radical"))&&{nodes:t,radical:e.get_child([0,1])}},u.prototype.getTargets=function(t){return[t.radical]},u.prototype.transform=function(t){this.addTouchedNodes(this.target.parent);var e=this.getNewTreeNode(this.nodes),n=e[0].is_group("exponent")?e[0]:e[0].get_parent(3),i=n.parent,r=i.get_child([0,1]),s=r.get_radicand();if(i.parent,e[0]===n){i.replace_with(r),s.remove();var a=new l.Power(s,n);r.set_radicand(a)}else{o.Tree.remove_range(e);var u=new l.ProductFraction;u.append_range(e);var c=new l.Exponent(u);s.remove(),a=new l.Power(s,c),r.set_radicand(a),this.cleanup_cascade(n.get_child([0,1])),l.Num.is_equal_to(n.children[0],1)&&(n.remove(),this.cleanup(i)),this.cleanup_cascade(e[0].parent)}if("function"!=typeof t)return!0;t(this)},(0,a.default)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RadicalExtractExponentAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){if(o.Action.call(this,"RadicalExtractExponentAction","factor power"),this.interactionType="drag",this.settings={side:"right-of",reset_x:!0,reset_y:!0},t){var e={node:t.target.parent.parent,margin:{y2:.5,y1:-.3,x1:.1,x2:-.6}},n={node:t.target.parent.parent,margin:{y2:.5,y1:-.3,x1:.1,x2:-.6}},i=[{node:t.target.parent.parent,margin:{y2:.6,y1:-.2,x1:.1,x2:-.1}}];this.initSettings(r.gmath.extend(t,{drop_area:e,drop_area_hint:n,destination_hint:i}))}}r.gmath.inherit(o.Action,l),l.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n)},l.prototype.matchSource=function(t){return 1===t.length&&!!t[0].is_group("exponent")&&!!(t[0].parent.parent&&t[0].parent.parent.parent&&t[0].get_parent(3).is_group("radical"))&&{nodes:t,power:t[0].parent}},l.prototype.getTargets=function(t){return[t.power]},l.prototype.transform=function(t){this.addTouchedNodes(this.target.parent);var e=this.getNewTreeNode(this.nodes)[0],n=e.parent,i=n.get_parent(2),r=i.parent,o=n.children[0];n.replace_with(o),a.Brackets.handle(o),a.Brackets.handle(o.parent,!0);var s=i.remove();if(e.remove(),r.insert(s,new a.Power(i,e)),"function"!=typeof t)return!0;t(this)},(0,s.default)(l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RootEvaluateAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"RootEvaluateAction","evaluate a root"),this.priority=0,this.triggerType="tap",t&&(this.actor=t.actor)}r.gmath.inherit(s.Action,u),u.prototype.match=function(t){if(!t.is_group("radical"))return!1;var e=t.get_degree().get_term(),n=t.get_radicand();return l.Num.is_inequal_to(n,"gte",0)&&l.Num.is_num(e)&&0!==l.Num.get_value(e)||l.Num.is_inequal_to(n,"lt",0)&&l.Num.is_inequal_to(e,"gt",0)&&l.Num.get_value(e)%2==1},u.prototype.transform=function(t){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor),n=Math.pow(Math.abs(l.Num.get_value(e.get_radicand())),1/l.Num.get_value(e.get_degree().get_term())),i=new l.Num(n);if(this.updateNodeMap(this.actor.get_mapping_to(i)),o.Tree.replace(e,i),l.Num.get_value(e.get_radicand())<0){var r=i.parent,s=i.remove(),a=new l.Sign(i);r.insert(s,a)}if("function"!=typeof t)return!0;t(this)},(0,a.default)(u,!1,l.Radical)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RelationOfAbsValAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(n(0),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3),l=e.RelationOfAbsValAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"RelationOfAbsValAction","resolve the cases for the absolute value"));return n.priority=0,n.triggerType="dbltap",n.settings={delay:1500,on_release:!0,side:"inside",makes_no_changes:!0},n.elements=[],t&&(t.actor?n.actor=t.actor:(n.triggerType="drag",n.nodes=t.nodes,n.target=t.target),"inverted_case"in t&&(n.settings.inverted_case=t.inverted_case)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),r(e,[{key:"match",value:function(t){return t.is_group("abs-val")&&u(t.parent)}},{key:"getAllAvailableActions",value:function(t){var e=function(t){if(t.length>1)return!1;var e=t[0];return!(!e.is_group("abs-val")||!u(e.parent))&&{nodes:t,relation:e.parent,rel_sym:e.parent.children[1]}}(t);if(!e)return[];var n=[e.rel_sym];return this.bindActionForEachTarget(t,n)}},{key:"rebind",value:function(t,e,n){if(this.oldTree!==n)throw"wrong old tree during rebinding an action!";var i=new o.Action;i.node_map=e,this.oldTree=t,this.nodes&&(this.nodes=i.mapNodes(this.nodes)),this.actor&&(this.actor=i.mapNodes(this.actor)[0])}},{key:"rematch",value:function(){return this.actor?this.match(this.actor):1===this.nodes.length&&this.match(this.nodes[0])}},{key:"transform",value:function(t){return this.target&&"AlgebraModel"===this.target.type?this.transform_update(t):this.transform_initial(t)}},{key:"transform_initial",value:function(t){var e=this.getSourceAndTarget();this.addTouchedNodes(e.source.parent);var n=this.getNewTreeNode(e.source),i=n.parent,r=0===n.get_idx()?i.children[2]:i.children[0];r=i.is_group("lt","lte")&&0===n.get_idx()?"and":i.is_group("gt","gte")&&2===n.get_idx()?"and":"or",this.node_map={};var o=this.transform_case(this.oldTree.clone(),!0),s=(new this.constructor).createBoundAction(this.oldTree,{nodes:[e.source],target:o,inverted_case:!0});s.node_map=this.node_map,this.node_map={};var a=this.transform_case(this.oldTree.clone(),!1),l=(new this.constructor).createBoundAction(this.oldTree,{nodes:[e.source],target:a,inverted_case:!1});return l.node_map=this.node_map,this.node_map={},this.elements.push({type:"derivation",model:a,action:l}),this.elements.push({type:"textbox",text:r}),this.elements.push({type:"derivation",model:o,action:s}),this.setNodesToReselectAfterAction([n]),"function"==typeof t&&t(this),!0}},{key:"transform_update",value:function(t){return this.node_map={},this.transform_case(this.newTree,this.settings.inverted_case),this.target=this.newTree,"function"==typeof t&&t(this),!0}},{key:"transform_case",value:function(t,e){var n=t.children[0],i=t.get_child([0,(this.actor||this.nodes[0]).get_idx()]),r=0===i.get_idx()?n.children[2]:n.children[0];return this.extendNodeMap(this.oldTree.get_mapping_to(t)),i.replace_with(i.children[1]),e&&a.Inequality.is_inequality(n)&&n.invert(),e&&a.Sign.invertTerm(r),t}}]),e}();function u(t){return t.is_group("equals","lt","gt","lte","gte")}(0,s.default)(l,!0,a.AbsVal)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ReorderSumInFractionDenominatorAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"ReorderSumInFractionDenominatorAction","reorder sum in a fraction's denominator"),this.priority=2,this.triggerType="dbltap",t&&(this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.match=function(t){if(!t)return!1;if(!t.is_group("add","sub"))return!1;if(!t.ls)return!1;var e=t.ls;return!(!e.children[1].is_group("fraction")||!t.children[1].is_group("fraction"))&&this.denominatorsHaveMatchingSums(e.children[1],t.children[1])},l.prototype.denominatorsHaveMatchingSums=function(t,e){var n=t.get_bottom(),i=e.get_bottom();if(1!==n.length||1!==i.length)return!1;if(!a.Brackets.areHidden(n[0].children[1])||!n[0].children[1].children[1].is_group("sum"))return!1;if(!a.Brackets.areHidden(i[0].children[1])||!i[0].children[1].children[1].is_group("sum"))return!1;var o=n[0].children[1].children[1],s=i[0].children[1].children[1];if(o.to_ascii()===s.to_ascii())return!1;var l=function(t){return t.to_ascii()};return r.gmath.array.isPermutation(o.children.map(l),s.children.map(l))},l.prototype.transform=function(t){this.addTouchedNodes(this.actor),this.addTouchedNodes(this.actor.ls);var e=this.getNewTreeNode(this.actor.ls).children[1],n=this.getNewTreeNode(this.actor).children[1];if(this.sortDenominatorsToMatch(e,n),"function"!=typeof t)return!0;t(this)},l.prototype.sortDenominatorsToMatch=function(t,e){for(var n=t.get_bottom()[0].children[1].children[1],i=e.get_bottom()[0].children[1].children[1],r=n.children.slice(),o=i.children.slice(),s=0;s<r.length;s++)if(r[s].to_ascii()!==o[s].to_ascii())for(var a=s;a<o.length;a++)if(r[s].to_ascii()===o[a].to_ascii()){var l=o[a];l.remove(),i.insert(s,l),o=i.children.slice()}},(0,s.default)(l,!1,a.AddSub)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CrossMultiplyFractionsAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"CrossMultiplyFractionsAction","cross multiply fractions"),this.priority=1,this.triggerType="dbltap",t&&(this.actor=t.actor)}r.gmath.inherit(s.Action,u),u.prototype.match=function(t){return!!t&&!!t.is_group("add","sub")&&!!t.ls&&t.ls.children[1].is_group("fraction")&&t.children[1].is_group("fraction")},u.prototype.transform=function(t){this.addTouchedNodes(this.actor),this.addTouchedNodes(this.actor.ls);var e=this.getNewTreeNode(this.actor.ls).children[1],n=this.getNewTreeNode(this.actor).children[1],i=this.getUncommonDenominatorFactors(e,n),r=this.getUncommonDenominatorFactors(this.actor.ls.children[1],this.actor.children[1]);if(i.leftUncommonFactors.forEach(o.Tree.remove),i.rightUncommonFactors.forEach(o.Tree.remove),this.sortDenominatorsToMatch(e,n),i.leftUncommonFactors.length>0){var s=this.extendFractionWithFactors(e,i.leftUncommonFactors),a=this.extendFractionWithFactors(n,i.leftUncommonFactors,!0,!0);this.mapOldFactorsToNewFactors(r.leftUncommonFactors,s,a)}if(i.rightUncommonFactors.length>0){var l=this.extendFractionWithFactors(e,i.rightUncommonFactors,!0),u=this.extendFractionWithFactors(n,i.rightUncommonFactors);this.mapOldFactorsToNewFactors(r.rightUncommonFactors,l,u)}if("function"!=typeof t)return!0;t(this)},u.prototype.getUncommonDenominatorFactors=function(t,e){for(var n=t.get_bottom().slice(),i=e.get_bottom().slice(),r=0;r<n.length;){for(var o=n[r],s=!1,a=0;a<i.length;a++){var l=i[a];if(o.to_ascii()===l.to_ascii()){i.splice(a,1),s=!0;break}}s?n.splice(r,1):r++}return{leftUncommonFactors:n,rightUncommonFactors:i}},u.prototype.sortDenominatorsToMatch=function(t,e){for(var n=t.get_bottom().slice(),i=e.get_bottom().slice(),r=0;r<n.length;r++)if(n[r].to_ascii()!==i[r].to_ascii())for(var o=r;o<i.length;o++)if(n[r].to_ascii()===i[o].to_ascii()){var s=i[o];s.remove(),e.insert(e.get_top().length+r+1,s),i=e.get_bottom().slice();break}},u.prototype.extendFractionWithFactors=function(t,e,n,i){var r=[];return n&&1===t.get_top().length&&l.Num.is_num(t.children[0].children[1])&&1===l.Num.get_value(t.children[0].children[1])&&t.children[0].remove(),e.forEach(function(o){var s=[],a=o.clone();s.push(a),t.append(a),n&&((a=o.clone()).invert(),s.push(a),i?t.insert(e.indexOf(o),a):t.append(a)),r.push(s)}),r},u.prototype.mapOldFactorsToNewFactors=function(t,e,n){for(var i=0;i<t.length;i++)for(var r=t[i],o=e[i].concat(n[i]),s=0;s<o.length;s++)this.extendNodeMap(r.get_mapping_to(o[s]))},(0,a.default)(u,!1,l.AddSub)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddFractionsAction=c;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3),u=n(12);function c(t){s.Action.call(this,"AddFractionsAction","add fractions"),this.priority=1.1,this.triggerType="tap",this.settings={delay:250,side:"inside"},t&&(this.settings.simplify_sum_in_numerator_after_adding_fractions=u.MathSettings.get("simplify_sum_in_numerator_after_adding_fractions"),this.initSettings(t))}r.gmath.inherit(s.Action,c),c.prototype.getAllAvailableActions=function(t){if(1!==t.length)return[];var e=t[0];if(!e.parent.is_group("sum"))return[];if(!e.children[1].is_group("fraction"))return[];var n=e.parent.children.filter(this.match2.bind(this,e)),i=e.get_root(),r=this;return n.map(function(e){return r.createBoundAction(i,{nodes:t,target:e,triggerType:"drag"})})},c.prototype.match=function(t){return this.match2(t.ls,t)},c.prototype.match2=function(t,e){if(!t||!e||t===e)return!1;if(!t.parent.is_group("sum"))return!1;if(t.parent!==e.parent)return!1;var n=t.children[1],i=e.children[1];if(!n.is_group("fraction")||!i.is_group("fraction"))return!1;var r=function(t){return t.to_ascii()},o=n.get_bottom(),s=i.get_bottom();return o.map(r).join("")===s.map(r).join("")},c.prototype.transform=function(t){var e="drag"===this.triggerType?this.nodes[0]:this.actor,n="drag"===this.triggerType?this.target:this.actor.ls;this.addTouchedNodes(e),this.addTouchedNodes(n);var i=this.getNewTreeNode(e),r=this.getNewTreeNode(n),s=i.get_idx()<r.get_idx(),a=s?e:n,u=s?i:r,c=s?n:e,d=s?r:i,h=d.parent,p=u.children[1],f=d.children[1];this.mapOldFractionPartsToFraction(c.children[1],p),o.Tree.remove(i);var g=o.Tree.remove(r),m=!1;if(this.numeratorIsASingleNumber(p)&&this.numeratorIsASingleNumber(f))m=this.replaceLeftFractionNumeratorWithTheSum(a,c,u,d);else{u=this.putNumeratorTermsIntoAddSubAndMapFromOldAddSub(p.get_top(),a),d=this.putNumeratorTermsIntoAddSubAndMapFromOldAddSub(f.get_top(),c);var v=this.putAddendsIntoNewSumAndMakeNumeratorTerm(u,d);p.append(v)}var y=new l.AddSub(p,m?"sub":"add");if(o.Tree.insert(h,g,y),this.updateNodeMap(e,y),this.updateNodeMap(n,y),this.cleanup(u),this.cleanup(d),this.cleanup(h),"function"!=typeof t)return!0;t(this)},c.prototype.mapOldFractionPartsToFraction=function(t,e){this.updateNodeMap(t.get_fraction_bar(),e.get_fraction_bar());for(var n=t.get_bottom(),i=e.get_bottom(),r=0;r<n.length;r++)this.updateNodeMap(n[r].get_mapping_to(i[r]))},c.prototype.numeratorIsASingleNumber=function(t){var e=t.get_top();return 1===e.length&&l.Num.is_num(e[0].children[1])},c.prototype.replaceLeftFractionNumeratorWithTheSum=function(t,e,n,i){var r=t.get_child([1,0,1]),o=e.get_child([1,0,1]),s=n.is_group("sub"),a=i.is_group("sub"),u=n.get_child([1,0,1]),c=i.get_child([1,0,1]),d=(s?-1:1)*l.Num.get_value(u)+(a?-1:1)*l.Num.get_value(c),h=d<0;h&&(d*=-1);var p=u.parent,f=u.remove(),g=new l.Num(d);return this.updateNodeMap(r.get_mapping_to(g)),this.updateNodeMap(o.get_mapping_to(g)),p.insert(f,g),h},c.prototype.putNumeratorTermsIntoAddSubAndMapFromOldAddSub=function(t,e){var n;if(o.Tree.remove_range(t),1==t.length)n=new l.AddSub(t[0].children[1],e.value);else{var i=new l.ProductFraction;o.Tree.insert_range(i,0,t),n=new l.AddSub(i,e.value)}return l.Brackets.handle(n.children[1],!0),this.updateNodeMap(e,n),this.updateNodeMap(e.children[0],n.children[0]),n},c.prototype.putAddendsIntoNewSumAndMakeNumeratorTerm=function(t,e){var n=l.AddSub.prototype.createParentGroup();n.append(t),n.append(e);var i=new l.MulDiv;return o.Tree.append(i,new l.Sym("*")),o.Tree.append(i,n),l.Brackets.handle(n),i},(0,a.default)(c,!0,l.AddSub)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.xToZeroAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"xToZeroAction","x^0=1"),this.priority=0,this.triggerType="tap",t&&(this.actor=t.actor)}r.gmath.inherit(s.Action,u),u.prototype.match=function(t){return t.children[0]instanceof l.Num&&0===t.children[0].value&&"0"!==t.ls.to_ascii()},u.prototype.transform=function(t){var e=this.getNewTreeNode(this.actor);this.addTouchedNodes(this.actor.parent);var n=new l.Num(1);if(this.updateNodeMap(this.actor.parent.get_mapping_to(n)),o.Tree.replace(e.parent,n),"function"!=typeof t)return!0;t(this)},(0,a.default)(u,!1,l.Exponent)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CombineStackedExponentsUpAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"CombineStackedExponentsUpAction","combine stacked exponents up"),this.interactionType="drag",this.settings={side:"around",reset_y:!0},t&&(this.nodes=t.nodes,this.target=t.target)}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){if(t.length<1)return[];if(!this.validStructure(t))return[];var e=this.getBaseOfOuterPowerFromInnerExponentTerm(t);if(!e)return[];var n=e.parent.children[1];return[this.createBoundAction(t[0].get_root(),{nodes:t,target:n})]},u.prototype.transform=function(t){var e=this.getNewTreeNode(this.nodes),n=this.getNewTreeNode(this.target).parent.children[0];this.addTouchedNodes(this.target.parent),this.extractSelectedExponentTermsFromInnerPower(e);var i=this.extendOuterExponentWithSelectedExponentTerms(n,e);if(this.mapSelectedExponentsTermsToNewExponentTerms(this.nodes,i),n.simplify=!0,"function"!=typeof t)return!0;t(this)},u.prototype.validStructure=function(t){return this.nodesAreASingleExponent(t)?this.termsBelongToAPowerWithinAPower(t):!(!this.nodesAreAllMulDivs(t)||!this.nodesAreAConsecutiveRange(t))&&this.termsBelongToAPowerWithinAPower(t)},u.prototype.nodesAreASingleExponent=function(t){return 1===t.length&&t[0].is_group("exponent")},u.prototype.nodesAreAllMulDivs=function(t){for(var e=0;e<t.length;e++)if(!t[e].is_group("mul","div"))return!1;return!0},u.prototype.nodesAreAConsecutiveRange=function(t){if(1===t.length)return!0;for(var e=t[0],n=1;n<t.length;n++){if(e.rs!==t[n]||e!==t[n].ls)return!1;e=t[n]}return!0},u.prototype.termsBelongToAPowerWithinAPower=function(t){var e,n,i,r;return t[0].is_group("exponent")?((n=(e=t[0]).parent)&&(i=n.parent),i&&(r=i.parent)):((e=t[0].get_parent(3))&&(n=e.parent),n&&(i=n.parent),i&&(r=i.parent)),!!(e&&e.is_group("exponent")&&n&&n.is_group("power")&&i&&i.is_group("brackets")&&r&&r.is_group("power"))},u.prototype.getBaseOfOuterPowerFromInnerExponentTerm=function(t){return t[0].is_group("exponent")?t[0].get_parent(2):t[0].get_parent(5)},u.prototype.extractSelectedExponentTermsFromInnerPower=function(t){if(t[0].is_group("exponent")){var e=t[0].parent,n=t[0],i=e.children[0],r=e.parent,s=e.remove();i.remove(),n.remove(),r.insert(s,i)}else{var a=t[0].parent;a.parent,o.Tree.remove_range(t),this.cleanup(a)}},u.prototype.extendOuterExponentWithSelectedExponentTerms=function(t,e){var n=t.parent.children[1],i=l.MulDiv.prototype.createParentGroup(),r=this.getContentMulsFromExponent(n),o=e[0].is_group("exponent")?this.getContentMulsFromExponent(e[0]):e;if(o.some(function(t){return t.is_group("mul")})&&o.some(function(t){return t.is_group("div")})){var s=l.MulDiv.prototype.createParentGroup();this.appendAllContentsToProduct(s,o),o=[new l.MulDiv(s)]}return this.appendAllContentsToProduct(i,r),this.appendAllContentsToProduct(i,o),n.append(i),this.cleanup(i),l.Brackets.handle(i),o},u.prototype.appendAllContentsToProduct=function(t,e){for(var n=0;n<e.length;n++)t.append(e[n])},u.prototype.getContentMulsFromExponent=function(t){var e=t.children[0];if(l.Brackets.areHidden(e)&&e.children[1].is_group("product","fraction")){var n=e.get_child([1]),i=n.get_top().concat(n.get_bottom());return o.Tree.remove_range(e.children[1].children),e.remove(),i}if(l.Brackets.areHidden(e)){var r=e.children[1];return r.remove(),e.remove(),[new l.MulDiv(r)]}return e.remove(),[new l.MulDiv(e)]},u.prototype.mapSelectedExponentsTermsToNewExponentTerms=function(t,e){for(var n=0;n<t.length;n++)for(var i=0;i<e.length;i++)0===i?this.updateNodeMap(t[n],e[i]):this.extendNodeMap(t[n],e[i])},(0,a.default)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PolynomialExpansionAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"PolynomialExpansionAction","polynomial expansion"),this.priority=0,this.triggerType="dbltap",t&&(this.actor=t.actor)}r.gmath.inherit(s.Action,u),u.prototype.match=function(t){if(!t.is_group("exponent"))return!1;if(!t.children[0]||!l.Num.is_num(t.children[0]))return!1;if(2!==l.Num.get_value(t.children[0])&&3!==l.Num.get_value(t.children[0]))return!1;var e=t.parent.children[0];return!!e.is_group("brackets")&&!!e.children[1].is_group("sum")},u.prototype.transform=function(t){var e=this.getNewTreeNode(this.actor);this.addTouchedNodes(this.actor);var n=e.parent,i=this.analyzeStructure(e),r=this.formAddendsForExpandedPolynomial(i);if(r.sort(function(t,e){return t.firstOrder===e.firstOrder&&t.degreeOfFirstOrder>=e.degreeOfFirstOrder?0:t.firstOrder===e.firstOrder&&t.degreeOfFirstOrder<e.degreeOfFirstOrder?1:t.firstOrder<e.firstOrder?-1:t.firstOrder>e.firstOrder?1:void 0}),this.replacePowerWithExpandedPolynomialSum(n,r),"function"!=typeof t)return!0;t(this)},u.prototype.analyzeStructure=function(t){var e={},n=t.parent.children[0].children[1];return e.degree=l.Num.get_value(t.children[0]),e.terms=n.children.slice(),e},u.prototype.formAddendsForExpandedPolynomial=function(t){var e;return 2===t.degree?e=this.formAddendsForDegreeOfTwo(t.terms):3===t.degree&&(e=this.formAddendsForDegreeOfThree(t.terms)),e},u.prototype.formAddendsForDegreeOfTwo=function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n].children[1],r=o.Tree.clone(i);this.extendNodeMap(this.getOldTreeNode(i).get_mapping_to(r)),(h={}).addend=new l.AddSub(new l.Power(r,new l.Num(2))),h.firstOrder=n,h.degreeOfFirstOrder=2,e.push(h)}for(n=0;n<t.length-1;n++)for(var s=n+1;s<t.length;s++){var a=l.MulDiv.prototype.createParentGroup();a.append(new l.MulDiv(new l.Num(2)));var u=0,c=t[n].children[1],d=o.Tree.clone(c);this.extendNodeMap(this.getOldTreeNode(c).get_mapping_to(d)),t[n].is_group("sub")&&(u=(u+1)%2);var h,p=t[s].children[1],f=o.Tree.clone(p);this.extendNodeMap(this.getOldTreeNode(p).get_mapping_to(f)),t[s].is_group("sub")&&(u=(u+1)%2),1!==l.Num.get_value(d)&&a.append(new l.MulDiv(d)),1!==l.Num.get_value(f)&&a.append(new l.MulDiv(f)),(h={}).addend=new l.AddSub(a,u?"sub":"add"),h.firstOrder=n,h.degreeOfFirstOrder=1,e.push(h)}return e},u.prototype.formAddendsForDegreeOfThree=function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n].children[1],r=o.Tree.clone(i);this.extendNodeMap(this.getOldTreeNode(i).get_mapping_to(r)),(k={}).addend=new l.AddSub(new l.Power(r,new l.Num(3)),t[n].value),k.firstOrder=n,k.degreeOfFirstOrder=3,e.push(k)}for(n=0;n<t.length-1;n++)for(var s=n+1;s<t.length;s++){var a=t[n].children[1],u=t[s].children[1],c=o.Tree.clone(a),d=o.Tree.clone(u);this.extendNodeMap(this.getOldTreeNode(a).get_mapping_to(c)),this.extendNodeMap(this.getOldTreeNode(u).get_mapping_to(d));var h=l.MulDiv.prototype.createParentGroup();h.append(new l.MulDiv(new l.Num(3))),h.append(new l.MulDiv(new l.Power(c,new l.Num(2)))),1!==l.Num.get_value(d)&&h.append(new l.MulDiv(d));var p={};p.addend=new l.AddSub(h,u.parent.value),p.firstOrder=n,p.degreeOfFirstOrder=2,e.push(p);var f=o.Tree.clone(a),g=o.Tree.clone(u);this.extendNodeMap(this.getOldTreeNode(a).get_mapping_to(f)),this.extendNodeMap(this.getOldTreeNode(u).get_mapping_to(g));var m=l.MulDiv.prototype.createParentGroup();m.append(new l.MulDiv(new l.Num(3))),1!==l.Num.get_value(f)&&m.append(new l.MulDiv(f)),m.append(new l.MulDiv(new l.Power(g,new l.Num(2))));var v={};v.addend=new l.AddSub(m,a.parent.value),v.firstOrder=n,v.degreeOfFirstOrder=1,e.push(v)}for(n=0;n<t.length-2;n++)for(s=n+1;s<t.length-1;s++)for(var y=s+1;y<t.length;y++){a=t[n].children[1],u=t[s].children[1];var b=t[y].children[1],_=o.Tree.clone(a),x=o.Tree.clone(u),w=o.Tree.clone(b);this.extendNodeMap(this.getOldTreeNode(a).get_mapping_to(_)),this.extendNodeMap(this.getOldTreeNode(u).get_mapping_to(x)),this.extendNodeMap(this.getOldTreeNode(b).get_mapping_to(w));var A=l.MulDiv.prototype.createParentGroup();A.append(new l.MulDiv(new l.Num(6))),1!==l.Num.get_value(_)&&A.append(new l.MulDiv(_)),1!==l.Num.get_value(x)&&A.append(new l.MulDiv(x)),1!==l.Num.get_value(w)&&A.append(new l.MulDiv(w));var k,T=0;t[n].is_group("sub")&&(T=(T+1)%2),t[s].is_group("sub")&&(T=(T+1)%2),t[y].is_group("sub")&&(T=(T+1)%2),(k={}).addend=new l.AddSub(A,T?"sub":"add"),k.firstOrder=n,k.degreeOfFirstOrder=1,e.push(k)}return e},u.prototype.replacePowerWithExpandedPolynomialSum=function(t,e){for(var n=t.parent,i=t.remove(),r=l.AddSub.prototype.createParentGroup(),o=0;o<e.length;o++)r.append(e[o].addend);n.insert(i,r),this.applyPowers(e),this.cleanupAddends(e),l.Brackets.handle(r,!0),this.cleanup_cascade(r.parent)},u.prototype.applyPowers=function(t){for(var e=0;e<t.length;e++){var n=t[e].addend?t[e].addend.children[1]:t[e].children[1];n.is_group("power")?this.applyPower(t[e].addend?t[e].addend:t[e]):n.is_group("product")&&this.applyPowers(n.children.slice())}},u.prototype.applyPower=function(t){var e=t.children[1],n=(e.children[0],e.children[1]),i=r.gmath.actions.DistributePowerAction.getAllAvailableActions([n]);if(i.length>0&&(i[0].doInPlace(),this.compose(i[0],!1),t.children[1].is_group("brackets"))){var o=t.children[1].children[1];o.remove(),t.children[1].remove(),t.append(o)}for(var s=i[0]?i[0].mapNodes(n):[n],a=0;a<s.length;a++){var l=s[a].getBestMatchingAction("tap");if(l&&"polynomial expansion"!==l.name){var u=l.createBoundAction(this.newTree,{actor:s[a]});u.doInPlace(),this.compose(u,!1)}}},u.prototype.cleanupAddends=function(t){for(var e=0;e<t.length;e++)if(t[e].addend.children[1].is_group("product"))for(var n=t[e].addend.children[1].children.slice(),i=0;i<n.length;i++)this.cleanup(n[i])},(0,a.default)(u,!1,l.Exponent)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FactorPowerAction=d;var i,r=n(0),o=n(1),s=n(2),a=n(5),l=(i=n(4))&&i.__esModule?i:{default:i},u=n(3),c=n(99);function d(t){if(s.Action.call(this,"FactorPowerAction","factor power"),this.interactionType="drag",this.settings={side:"outside",reset_y:!0},t){var e={},n={};t.margin&&(e.margin=t.margin,n.margin=t.margin),this.initSettings(r.gmath.extend(t,{drop_area:e,drop_area_hint:n,destination_hint:[{side:"right-of",margin:{y2:.6,y1:-.2}}]}))}}r.gmath.inherit(s.Action,d),d.prototype.getAllAvailableActions=function(t){var e,n=this.getEncompassingRange(t);if(this.thereIsALonePower(t)){if(this.transformationWouldLeaveExponentOfOne(t))return[];e=this.bindActionForLonePowerCases(t,n.length-1)}else{if(!(n.length>0))return[];e=this.bindActionForMultiplePowerCases(t,n)}return e},d.prototype.transform=function(t){if(Array.isArray(this.target))for(var e=0;e<this.target.length;e++)this.addTouchedNodes(this.target[e]);else this.addTouchedNodes(this.target);var n,i=a.AlgebraModel.groupNodeRanges(this.nodes),r=this.getNewTreeNode(this.nodes),o=a.AlgebraModel.groupNodeRanges(r);if(n=this.thereIsOneRange(o)?this.factorFromALonePower(r):this.factorFromMultiplePowers(o),this.mapOldRangesToNewRange(i,n),"function"!=typeof t)return!0;t(this)},d.prototype.factorFromALonePower=function(t){var e=this.extractRangeFromExponent(t);return this.wrapTermInPower(e,t)},d.prototype.factorFromMultiplePowers=function(t){var e=this.getParentGroupOfPowers(t[0][0]);return this.productFractionHasUnaffectedTerms(e,t)?this.performTransformationWithUnaffectedTerms(t,e):this.performTransformationWithoutUnaffectedTerms(t,e)},d.prototype.productFractionHasUnaffectedTerms=function(t,e){return t.is_group("product")?t.children.length>e.length:t.children.length-1>e.length},d.prototype.performTransformationWithoutUnaffectedTerms=function(t,e){for(var n=0;n<t.length;n++)this.extractRangeFromExponent(t[n]);return this.wrapTermInPower(e,t[0])},d.prototype.performTransformationWithUnaffectedTerms=function(t,e){var n=this.getAffectedTerms(t),i=this.getIDXForFactoredStructure(n),r=this.putAffectedTermsIntoASeparateProduct(n);if(r.is_group("product"))e.insert(i,new u.MulDiv(r,e.is_group("fraction")&&i>e.get_top().length?"div":"mul"));else{var o=e.parent,s=e.remove(),a=u.MulDiv.prototype.createParentGroup();a.append(new u.MulDiv(e)),a.append(new u.MulDiv(r)),o.insert(s,a),this.cleanup(e),this.cleanup(a.children[0])}for(var l=0;l<t.length;l++)this.extractRangeFromExponent(t[l]);return this.wrapTermInPower(r,t[0])},d.prototype.getIDXForFactoredStructure=function(t){for(var e,n=0;n<t.length;n++){var i=t[n],r=i.parent.children.indexOf(i);e||0===e?r<e&&(e=r):e=r}return e},d.prototype.putAffectedTermsIntoASeparateProduct=function(t){var e=u.MulDiv.prototype.createParentGroup();t.forEach(function(t){t.remove()}),t.every(function(t){return t.is_group("div")})&&t.forEach(function(t){t.invert()});for(var n=0;n<t.length;n++)e.append(t[n]);return e},d.prototype.mapOldRangesToNewRange=function(t,e){for(var n=0;n<t.length;n++)for(var i=t[n],r=0;r<i.length;r++)i[r].is_group("exponent")?this.updateNodeMap(i[r].get_mapping_to(e)):i[r].is_group("mul")&&(e.children[0].is_group("brackets")&&e.children[0].children[1].is_group("product")?this.updateNodeMap(i[r].get_mapping_to(e.children[0].children[1].children[r])):(this.updateNodeMap(i[r],e),this.newTree!==this.oldTree&&this.updateNodeMap(i[r].children[1],e.children[0])))},d.prototype.extractRangeFromExponent=function(t){if(t[0].is_group("exponent")){var e=t[0].parent.parent,n=(s=t[0].parent).children[0],i=t[0],r=s.remove();return n.remove(),i.remove(),e.insert(r,n),n}var s,a=(s=t[0].get_parent(4)).get_child([1,0,1]);return o.Tree.remove_range(t),this.cleanup(a),s},d.prototype.wrapTermInPower=function(t,e){var n,i,r,o,s;if(t.parent.is_group("brackets")?(i=(n=t.parent).parent,r=n.remove()):(i=t.parent,r=t.remove(),n=new u.Brackets(t)),e[0].is_group("exponent"))o=e[0];else if(e[0].is_group("mul")&&1===e.length)(o=e[0].children[1]).remove(),o=new u.Exponent(o);else{s=u.MulDiv.prototype.createParentGroup();for(var a=0;a<e.length;a++)s.append(e[a]);o=new u.Exponent(s)}var l=new u.Power(n,o);return n.is_group("brackets")&&(n.simplify=!0),i.insert(r,l),u.Brackets.handle(l),s&&this.cleanup(s),o},d.prototype.getParentGroupOfPowers=function(t){return t.is_group("exponent")?t.parent.parent.parent:t.parent.parent.parent.parent.parent.parent},d.prototype.getAffectedTerms=function(t){for(var e=[],n=0;n<t.length;n++)e.push(this.getParentMulFromExponentTerm(t[n][0]));return e},d.prototype.getParentMulFromExponentTerm=function(t){return t.is_group("exponent")?t.parent.parent:t.parent.parent.parent.parent.parent},d.prototype.thereIsOneRange=function(t){return 1===t.length},d.prototype.thereIsALonePower=function(t){return 1===t.length&&t[0].is_group("exponent")||this.allNodesAreMulsWithinSameProduct(t)},d.prototype.transformationWouldLeaveExponentOfOne=function(t){if(!t[0].is_group("mul","div"))return!1;var e=t[0].parent;if(e.is_group("product")&&t.length+1===e.children.length){for(var n=0;n<e.children.length;n++){var i=e.children[n];if(-1===t.indexOf(i))break}if(1===u.Num.get_value(i.children[1]))return!0}else if(e.is_group("fraction")&&t.every(function(t){return t.is_group("div")})){var r=e.get_top();if(1===r.length&&1===u.Num.get_value(r[0].children[1]))return!0}return!1},d.prototype.allNodesAreMulsWithinSameProduct=function(t){for(var e,n=0;n<t.length;n++){var i=t[n];if(!i.is_group("mul","div"))return!1;if(e){if(i.parent!==e)return!1}else e=i.parent}return!0},d.prototype.bindActionForLonePowerCases=function(t,e){var n,i={all:-.3},r=t[0];if(r.is_group("exponent")){var o=r.get_parent(2);if(!o)return[];if(!o.is_group("brackets")||o.parent.is_group("power","radical"))return[];n=this.createBoundAction(r.get_root(),{nodes:t,target:o})}else{if(!r.is_group("mul","div"))return[];var s,a=r.get_parent(2),l=a&&a.parent,u=l&&l.parent,c=u&&u.parent;if(!(a&&l&&u&&c))return[];if(!a.is_group("brackets")||!l.is_group("exponent")||!u.is_group("power"))return[];if(c.is_group("brackets","mul","div"))if(c.is_group("brackets")&&!c.parent.is_group("power","radical"))s=c;else if(c.is_group("mul","div")&&e>0)i.all=-1,s=c.parent;else{if(!(c.is_group("mul","div")&&e<=0))return[];s=u}else s=u;n=this.createBoundAction(r.get_root(),{nodes:t,target:s,margin:i||null})}return[n]},d.prototype.bindActionForMultiplePowerCases=function(t,e){if(0===e.length)return[];var n=this.getBestTarget(e);return[this.createBoundAction(t[0].get_root(),{nodes:t,target:n})]},d.prototype.getEncompassingRange=function(t){t[0].get_root();var e=(0,c.analyzeNodeStructure)(t);if(0===e.length)return[];for(var n=e[0].prod,i=[],r=0;r<n.children.length;r++){var s=n.get_child([r,1,1]);s&&this.getTargetRangesInExponent(s,e).forEach(function(t){i=i.concat(t)})}return o.Tree.nodes_to_range(i)},d.prototype.getTargetRangesInExponent=function(t,e){var n=t.get_root();if(!t.is_group("exponent"))return[];var i=e[0].ascii,r=n.getRanges(i,null,t.children);return 0===r.length?[]:(r=r.filter(function(e){var n=e[0];return n.parent===t||n.parent.is_group("brackets")&&n.ls.hidden&&n.get_parent(2)===t||n.is_group("mul","div")&&n.get_parent(3)===t||n.parent.is_group("mul","div")&&n.get_parent(4)===t})).map(function(t){if(1===t.length){if(t[0].is_group("fraction")&&u.Brackets.areHidden(t[0].parent)&&t[0].get_parent(2).is_group("exponent"))return[t[0].get_parent(2)];if(t[0].parent.is_group("exponent","mul"))return[t[0].parent]}return t})},d.prototype.getBestTarget=function(t){var e,n=t[0].parent;if(n.is_group("product")&&n.children.length>t.length||n.is_group("fraction")&&n.children.length-1>t.length)e=t;else{var i=t[0].parent.parent;e=i.is_group("brackets")&&!u.Brackets.areHidden(i)?i:t[0].parent}return e},(0,l.default)(d)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PowerFactorAndCombineStackedExponentsAction=u;var i,r=n(0),o=(n(1),n(2)),s=n(5),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){o.Action.call(this,"PowerFactorAndCombineStackedExponentsAction","factor power and combine stacked exponent up"),this.triggerType="drag",this.settings={side:"inside"},t&&(this.nodes=t.nodes,this.target=t.target)}r.gmath.inherit(o.Action,u),u.prototype.getAllAvailableActions=function(t){if(t.length<2)return[];var e=r.gmath.actions.FactorPowerAction.getAllAvailableActions(t);if(0===e.length)return[];var n=e[0];if(Array.isArray(n.target))return[];if(!n.target.is_group("brackets"))return[];if(!this.nodesAccountForEveryTermInProduct(n.target.children[1],t))return[];if(!n.target.parent.is_group("power"))return[];var i=n.target.parent.children[1];return[this.createBoundAction(t[0].get_root(),{nodes:t,target:i})]},u.prototype.nodesAccountForEveryTermInProduct=function(t,e){for(var n=[],i=0;i<e.length;i++){for(var r=e[i].parent;!r.is_group("power")&&!s.AlgebraModel.is_top_most(r);)r=r.parent;n.every(function(t){return t!==r})&&n.push(r)}return n.length===t.get_top().concat(t.get_bottom()).length},u.prototype.doInPlace=function(t){this.initNodeMap();var e=this.target.parent;this.addTouchedNodes(e);var n=this.getNewTreeNode(this.nodes),i=r.gmath.actions.FactorPowerAction.getAllAvailableActions(n)[0];i.doInPlace(),this.compose(i,!1);var o=i.mapNodes(n),s=r.gmath.actions.CombineStackedExponentsUpAction.getAllAvailableActions(o)[0];if(s.doInPlace(),this.compose(s,!1),e=this.mapNodes(e)[0],l.Brackets.handle(e.children[0],!0),this.removeDeletedNodesFromNodeMap(),"function"!=typeof t)return!0;t(this)},(0,a.default)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DistributePowerAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=(n(5),n(4)))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"DistributePowerAction","distribute power"),this.triggerType="drag",this.settings={side:"inside",reset_x:!0,reset_y:!0},t&&this.initSettings(r.gmath.extend(t,{destination_hint:[{side:"right-of",margin:{y2:.5}}]}))}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){var e,n,i,r=t[0].get_root();if(this.nodesAreASingleExponent(t))i=(e=(n=t[0]).parent).children[0];else{if(!this.nodesAreAllMulDivs(t)||!this.nodesAreAConsecutiveRange(t))return[];if(!(n=t[0].get_parent(3))||!n.parent)return[];i=(e=n.parent).children[0]}return n&&e&&i&&n.is_group("exponent")&&e.is_group("power")&&i.is_group("brackets")&&(!(i=i.children[1]).is_group()||i.is_group("power")||i.is_group("brackets")||i.is_group("product")||i.is_group("fraction"))?[this.createBoundAction(r,{nodes:t,target:i})]:[]},u.prototype.transform=function(t){var e,n=this,i=this.getNewTreeNode(this.nodes[0].is_group("exponent")?this.nodes[0]:this.nodes[0].parent.parent.parent),r=this.getNewTreeNode(this.nodes),s=this.getNewTreeNode(this.target),a=i.parent,u=a.parent;if(this.addTouchedNodes(this.getOldTreeNode(a)),o.Tree.remove_range(r),this.nodes.forEach(function(t){return n.updateNodeMap(t,[])}),s.is_group("product")||s.is_group("fraction")?(e=s.get_top().concat(s.get_bottom()),this.applyPowersToMulDivs(e,r)):s=(e=[this.applyPowerToSingleTerm(s,r)])[0],a.children[1])this.cleanup(a.children[1].children[0].children[1]),l.Brackets.handle(a.children[1].children[0],!0);else{var c=a.remove(),d=new l.Brackets(s);u.insert(c,d),d.simplify=!0}if("function"!=typeof t)return!0;t(this)},u.prototype.nodesAreASingleExponent=function(t){return 1===t.length&&t[0].is_group("exponent")},u.prototype.nodesAreAllMulDivs=function(t){for(var e=0;e<t.length;e++)if(!t[e].is_group("mul","div"))return!1;return!0},u.prototype.nodesAreAConsecutiveRange=function(t){if(1===t.length)return!0;for(var e=t[0],n=1;n<t.length;n++){if(e.rs!==t[n]||e!==t[n].ls)return!1;e=t[n]}return!0},u.prototype.applyPowersToMulDivs=function(t,e){for(var n=0;n<t.length;n++){var i=t[n].children[1];this.applyPowerToSingleTerm(i,e)}},u.prototype.applyPowerToSingleTerm=function(t,e){return t.is_group("power")?this.applyPowerToPower(t,e):this.applyPowerToNonPower(t,e)},u.prototype.applyPowerToPower=function(t,e){var n=t,i=o.Tree.clone(e),r=this.extendPowerWithSelectedExponentTerms(n,i);return this.extendNodeMap(this.nodes[0],r),n},u.prototype.applyPowerToNonPower=function(t,e){var n,i,r;if(n=t.parent,i=t.remove(),e[0].is_group("exponent"))r=o.Tree.clone(e[0]);else{var s=l.MulDiv.prototype.createParentGroup(),a=o.Tree.clone(e);this.appendAllContentsToProduct(s,a),r=new l.Exponent(s)}var u=new l.Power(t,r);return n.insert(i,u),s&&(this.cleanup(s),l.Brackets.handle(r.children[0],!0)),this.mapDraggedExponentTermsToNewExponent(this.nodes,u.children[1]),u},u.prototype.mapDraggedExponentTermsToNewExponent=function(t,e){for(var n=0;n<t.length;n++)t[n].is_group("exponent")?this.extendNodeMap(t[n].get_mapping_to(e)):e.children[0].is_group("brackets")&&e.children[0].children[1].is_group("product")?this.extendNodeMap(t[n].get_mapping_to(e.children[0].children[1].children[n])):(this.extendNodeMap(t[n],e),this.extendNodeMap(t[n].children[1].get_mapping_to(e.children[0])))},u.prototype.takeContentsOfBrackets=function(t){return t.is_group("brackets")&&(t=t.children[1]).remove(),t},u.prototype.extendPowerWithSelectedExponentTerms=function(t,e){var n=t.children[1],i=l.MulDiv.prototype.createParentGroup(),r=this.getContentMulsFromExponent(n),o=e[0].is_group("exponent")?this.getContentMulsFromExponent(e[0]):e;return this.appendAllContentsToProduct(i,r),this.appendAllContentsToProduct(i,o),n.append(i),this.cleanup(i),l.Brackets.handle(i,!0),this.mapDraggedExponentTermsToNewExponentTerms(this.nodes,n,o),o},u.prototype.appendAllContentsToProduct=function(t,e){for(var n=0;n<e.length;n++)t.append(e[n])},u.prototype.mapDraggedExponentTermsToNewExponentTerms=function(t,e,n){if(t[0].is_group("mul"))for(var i=0;i<t.length;i++)this.extendNodeMap(t[i].get_mapping_to(n[i]));else if(t[0].is_group("exponent")){var r=t[0].children[0];if(r.is_group("brackets")&&r.children[1].is_group("product"))for(i=0;i<r.children[1].children.length;i++){var o=r.children[1].children[i];this.extendNodeMap(t[0],n[i]),this.extendNodeMap(o.get_mapping_to(n[i]))}else r.is_group("brackets")&&!n[0].children[1].is_group("brackets")?this.extendNodeMap(r.children[1].get_mapping_to(n[0].children[1])):this.extendNodeMap(r.get_mapping_to(n[0].children[1]))}},u.prototype.getContentMulsFromExponent=function(t){var e=t.children[0];if(l.Brackets.areHidden(e)&&e.children[1].is_group("product")){var n=e.children[1].children.slice();return o.Tree.remove_range(e.children[1].children),e.remove(),n}if(l.Brackets.areHidden(e)){var i=e.children[1];return i.remove(),e.remove(),[new l.MulDiv(i)]}return e.remove(),[new l.MulDiv(e)]},(0,a.default)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CollectExponentsForFactoring=l;var i,r=n(0),o=(n(1),n(2)),s=(i=(n(5),n(4)))&&i.__esModule?i:{default:i},a=(n(3),n(99));function l(t){o.Action.call(this,"CollectExponentsForFactoring","collect exponents"),this.settings={makes_no_changes:!0,side:"inside",no_delay:!0},t&&(this.nodes=t.nodes,this.target=t.target)}r.gmath.inherit(o.Action,l),l.prototype.getAllAvailableActions=function(t){var e=t[0].get_root(),n=this,i=(0,a.analyzeNodeStructure)(t);if(0===i.length)return[];for(var r=i[0].prod,o=[],s=0;s<r.children.length;s++){var l=r.get_child([s,1,1]);l&&this.getTargetRangesInExponent(l,i).forEach(function(i){o.push(n.createBoundAction(e,{nodes:t,target:i[0].is_group("product")?[i[0].parent.parent]:i}))})}return o},l.prototype.transform=function(t){var e=this.getNewTreeNode(this.nodes[0]),n=this.getNewTreeNode(this.target);if(this.updateNodeMap(this.nodes[0],[e].concat(n)),"function"!=typeof t)return!0;t(this)},l.prototype.getTargetRangesInExponent=function(t,e){var n=t.get_root();if(!t.is_group("exponent"))return[];for(var i=e[0].ascii,r=0;r<e.length;r++)if(e[r].exp===t)return[];var o=n.getRanges(i,null,t.children);return 0===o.length?[]:(o=o.filter(function(e){var n=e[0];return n.parent===t||n.parent.is_group("brackets")&&n.ls.hidden&&n.get_parent(2)===t||n.is_group("mul","div")&&n.get_parent(3)===t||n.parent.is_group("mul")&&n.get_parent(4)===t})).map(function(t){return 1===t.length&&t[0].parent.is_group("exponent","mul")?[t[0].parent]:t})},(0,s.default)(l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CalculatePowerAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(1),s=(n(0),n(2)),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3),u=e.CalculatePowerAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"CalculatePowerAction","calculate a power"));return n.priority=0,n.triggerType="tap",t&&(n.actor=t.actor),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.Action),r(e,[{key:"match",value:function(t){var e=t;if(e.is_group("power")||(e=t.parent),!e.is_group("power"))return!1;var n=e.children[0],i=e.get_exponent_term();return n.is_group("brackets")&&(n=n.children[1]),!(!l.Num.is_num(n,!0)||!l.Num.is_num(i)||l.Num.is_equal_to(i,0)||Math.round(l.Num.get_value(i))!==l.Num.get_value(i)&&n.is_group("plusminus","sign"))}},{key:"transform",value:function(t){var e=this.getNewTreeNode(this.actor);e.is_group("power")||(e=e.parent);var n=e.children[0],i=e.children[1].children[0];this.addTouchedNodes(this.getOldTreeNode(e)),n.is_group("brackets")&&(n=n.children[1]),i.is_group("brackets")&&(i=i.children[1]);var r=this.getOldTreeNode(e),s=this.getOldTreeNode(i),a=this.getOldTreeNode(n.is_group("sign","plusminus")?n.children[1]:n),u=this.getOldTreeNode(n.is_group("sign","plusminus")?n.children[0]:n),c=new l.Num(Math.pow(l.Num.get_value(n,!0),l.Num.get_value(i)));return n.is_group("plusminus")&&!l.Power.hasEvenExponent(e)&&(c=new l.Sign(c,!0)),c.is_leaf_node?this.updateNodeMap(r.get_mapping_to(c)):(this.updateNodeMap(s.get_mapping_to(c.children[1])),this.updateNodeMap(a.get_mapping_to(c.children[1])),this.updateNodeMap(u.get_mapping_to(c.children[0]))),o.Tree.replace(e,c),l.Brackets.handle(c),"function"==typeof t&&t(this),!0}}]),e}();(0,a.default)(u,!1,l.Exponent,l.Power)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PostInteractionSimplificationAction=u;var i,r=n(0),o=(n(1),n(2)),s=n(5),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){o.Action.call(this,"PostInteractionSimplificationAction","simplify terms after interaction"),this.priority=0,this.triggerType="auto",this.settings={simplify_products:!0,simplify_sums:!0,simplify_multiplicative_identities:!0,simplify_additive_identities:!0,simplify_multiplicative_annihilators:!0},t&&(this.nodes=t.nodes,"auto_simplify_distributions"in t&&(this.settings.simplify_products=t.auto_simplify_distributions),"auto_simplify_vector_additions"in t&&(this.settings.simplify_sums=t.auto_simplify_vector_additions),"auto_simplify_multiplicative_identities"in t&&(this.settings.simplify_multiplicative_identities=t.auto_simplify_multiplicative_identities),"auto_simplify_additive_identities"in t&&(this.settings.simplify_additive_identities=t.auto_simplify_additive_identities),"auto_simplify_multiplicative_annihilators"in t&&(this.settings.simplify_multiplicative_annihilators=t.auto_simplify_multiplicative_annihilators))}r.gmath.inherit(o.Action,u),u.prototype.match=function(t){return!0},u.prototype.rematch=function(){return!0},u.prototype.transform=function(t){this.changed=!1;for(var e=this.getNewTreeNode(this.nodes),n=0;n<e.length;n++){var i=this.mapNodes(this.nodes[n])[0];if(i){var o=i.parent;if(i.is_group("brackets"))l.Brackets.handle(i,!0)&&(this.changed=!0),this.cleanup_cascade(o)&&(this.changed=!0);else if(this.prodFracContainingAMulZero(i)&&this.settings.simplify_multiplicative_annihilators){var a=r.gmath.find(i.get_top(),function(t){var e=t.get_child([1]);return l.Num.is_num(e)&&0===l.Num.get_value(e)});if(i.get_top().filter(function(t){return t!==a}).concat(i.get_bottom().filter(function(t){return 0!==l.Num.get_value(t.get_child([1]))})).forEach(function(t){t.remove()}),this.cleanup(i),o.is_group("add","sub")){var u=o.parent;o.remove(),this.cleanup(u)}this.changed=!0}else if(i.is_group("product")&&this.settings.simplify_products||i.is_group("sum")&&this.settings.simplify_sums){var c=this.getNumberOperatorsFromGroup(i);if(c.length>1){var d=i.is_group("product")?r.gmath.actions.MultiplyNumbersAction:r.gmath.actions.AddSubNumbersAction;this.applyOperators(c,d),i.is_group("product")&&this.applyNegatives(o),this.changed=!0}}else if(this.muldiv1(i)&&this.settings.simplify_multiplicative_identities||this.addsub0(i)&&this.settings.simplify_additive_identities)i.is_group("num")&&(o=(i=o).parent),i.do_not_map_on_simplify||this.updateNodeMap(this.nodes[n].select_all(),i.ls||i.rs),i.remove(),this.cleanup_cascade(o),this.changed=!0;else if(this.muldivNeg1(i)){var h=o.parent,p=i.children[1];p.remove();var f=p.children[1];this.updateNodeMap(this.nodes[n],i.ls||i.rs),this.updateNodeMap(this.nodes[n].children[1].children[1].get_mapping_to(i.ls||i.rs));var g=i.ls||i.rs;f.remove();var m=g.children[1];m.is_group("sign")?(m.remove(),(m=m.children[1]).remove(),g.append(m)):(m.remove(),p.append(m),g.append(p)),i.remove(),this.cleanup(o),this.cleanup(h),s.AlgebraModel.is_top_most(h)||l.Brackets.handle(h,!0),this.changed=!0}else if(this.exp1(i)){var v=i.parent,y=v.children[0],b=(o=v.parent,v.remove());y.remove(),o.insert(b,y),this.changed=!0}this.changed&&this.removeDeletedNodesFromNodeMap()}}return"function"==typeof t&&t(this),this.changed},u.prototype.getNumberOperatorsFromGroup=function(t){for(var e=[],n=0;n<t.children.length;n++){var i=t.children[n];l.Num.is_num(i.children[1])&&e.push(i)}return e},u.prototype.applyOperators=function(t,e){for(var n=t[0],i=t.slice(1),r=0;r<i.length;r++)n=this.runAction(e,n,i[r])},u.prototype.runAction=function(t,e,n){var i=t.createBoundAction(this.newTree,{target:e,nodes:[n],triggerType:"drag"});return i.doInPlace(),this.compose(i,!1),i.mapNodes([e])[0]},u.prototype.applyNegatives=function(t){var e=r.gmath.actions.AddSubCombineSigns;e.match(t)&&this.compose(e.createAndDoInPlace(this.newTree,{actor:t}),!1)},u.prototype.muldiv1=function(t){var e=t.is_group("num")&&t.parent?t.parent:t;return l.Num.is_equal_to(e.children[1],1)&&(e.is_group("div")||e.is_group("mul")&&!(e.parent.is_group("fraction")&&1===e.parent.get_top().length))},u.prototype.muldivNeg1=function(t){return t.is_group("mul","div")&&l.Num.is_num(t.children[1])&&-1===l.Num.get_value(t.children[1])},u.prototype.addsub0=function(t){var e=t.is_group("num")&&t.parent?t.parent:t;return e.is_group("add","sub")&&l.Num.is_num(e.children[1])&&0===l.Num.get_value(e.children[1])},u.prototype.prodFracContainingAMulZero=function(t){return t.is_group("product","fraction")&&t.get_top().some(function(t){var e=t.get_child([1]);return l.Num.is_num(e)&&0===l.Num.get_value(e)})},u.prototype.getSumAncestor=function(t){for(var e=t.parent;e&&!e.is_group("sum");)e=e.parent;return e},u.prototype.exp1=function(t){return t.is_group("exponent")&&l.Num.is_num(t.children[0])&&1===l.Num.get_value(t.children[0])},(0,a.default)(u,!1)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlusMinusInProductAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(n(0),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3),l=e.PlusMinusInProductAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"SignInEvenPowerAction","remove redundant ± in a product or fraction"));return n.priority=0,n.triggerType="tap",t&&n.initSettings(t),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),r(e,[{key:"match",value:function(t){return t.is_group("plusminus")&&t.parent.is_group("mul","div")&&a.ProductFraction.getFactors(t.get_parent(2)).some(function(e){return e.children[1]!==t&&e.children[1].is_group("plusminus")})}},{key:"transform",value:function(t){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor),n=e.parent;if(e.replace_with(e.children[1]),a.Brackets.handle(n,!0),"function"!=typeof t)return!0;t(this)}}]),e}();(0,s.default)(l,!1,a.Sign)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MulDivRadicalsAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),s=(n(1),n(2)),a=n(5),l=(i=n(4))&&i.__esModule?i:{default:i},u=n(3),c=n(57),d=e.MulDivRadicalsAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"MulDivRadicalsAction","muliply or divide a radicals"));if(n.triggerType="tap",n.priority=0,n.settings={target_group:!0,group_side:"around",delay:300,reset_y:!0},n.elements=[],t){var i={};t.target&&(n.priority=1,i.drop_area_hint={side:"around"}),n.initSettings(o.gmath.extend(t,i))}return n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.Action),r(e,[{key:"getAllAvailableActions",value:function(t){var e=function(t){if(1!==t.length)return!1;if(!t[0].is_group("mul","div")||!t[0].children[1].is_group("radical"))return!1;var e=(0,c.evalExpression)(t[0].children[1].get_radicand());return{nodes:t,degree_val:t[0].children[1].get_degree_term().to_ascii(),group:t[0].parent,is_negative:!isNaN(e)&&e<0}}(t);if(!e)return[];var n=function(t){return t.group.get_top().concat(t.group.get_bottom()).filter(function(e){if(-1!==t.nodes.indexOf(e)||!e.children[1].is_group("radical")||e.children[1].get_degree_term().to_ascii()!==t.degree_val)return!1;if(t.is_negative){var n=(0,c.evalExpression)(e.children[1].get_radicand());if(!isNaN(n)&&n<0)return!1}return!0})}(e);return this.bindActionsForEachTarget(t,n)}},{key:"bindActionsForEachTarget",value:function(t,e){var n=[];return e.forEach(function(e){var i=e.children[1].children[3];n=n.concat(this.bindActionForEachTarget(t,[i],!0))},this),n}},{key:"match",value:function(t){if(!t.ls||t.ls instanceof u.Sym)return!1;if(!t.is_group("mul","div")||t.ls.value!==t.value)return!1;var e=t.ls.children[1],n=t.children[1];if(!e.is_group("radical")||!n.is_group("radical")||e.children[0].to_ascii()!==n.children[0].to_ascii())return!1;var i=(0,c.evalExpression)(e.get_radicand()),r=(0,c.evalExpression)(n.get_radicand());return isNaN(i)||i>=0||isNaN(r)||r>=0}},{key:"rematch",value:function(){var t=this;return!(!this.target||"AlgebraModel"!==this.target.type)||(this.actor?this.match(this.actor):this.getAllAvailableActions(this.nodes).some(function(e){return e.target===t.target}))}},{key:"rebind",value:function(t,e,n){if(this.oldTree!==n)throw"wrong old tree during rebinding an action!";var i=new s.Action;i.node_map=e,this.oldTree=t,this.nodes&&(this.nodes=i.mapNodes(this.nodes)),this.actor&&(this.actor=i.mapNodes(this.actor)[0]),!this.target||this.target instanceof a.AlgebraModel?this.target&&(this.target={type:"AlgebraModel"}):this.target=i.mapNodes(this.target)[0]}},{key:"transform",value:function(t){return this.target&&"AlgebraModel"===this.target.type?this.transformUpdate(t):this.transformInitial(t)}},{key:"transformInitial",value:function(t){var e=this.getSourceAndTarget();this.addTouchedNodes(e.source),this.addTouchedNodes(e.target);for(var n=this.getNewTreeNode(e.source),i=this.getNewTreeNode(e.target),r=n.parent,o=this.getOldTreeNode(n);!i.is_group("mul","div");)i=i.parent;if(i.is_group("div")&&n.is_group("mul")){var s=i;i=n,n=s}var a=n.children[1].get_radicand(),l=i.children[1].get_radicand();isNaN((0,c.evalExpression)(a))&&this.elements.push(this.defineRestrictionExpression([a])),isNaN((0,c.evalExpression)(l))&&this.elements.push(this.defineRestrictionExpression([l])),n.remove(),l.remove();var d=new u.ProductFraction;return d.append(new u.MulDiv(l)),d.insert("left-of"===this.settings.side?0:1,new u.MulDiv(a,i.value===n.value?"mul":n.value),!0),i.children[1].set_radicand(d),o.map_group_and_sym(this,i,!0),o.children[1].map_to_radical(this,i.children[1],!0),this.cleanup(l.parent),this.cleanup(a.parent),this.cleanup(d),this.cleanup(r),"function"==typeof t&&t(this),this}},{key:"transformUpdate",value:function(t){return this.node_map={},this.createRestrictionModel(this.newTree,this.nodes||[this.actor]),this.target=this.newTree,"function"==typeof t&&t(this),!0}},{key:"createRestrictionModel",value:function(t,e){t.children[0].remove();var n=a.AlgebraModel.cloneNodes(e)[0],i=new u.Inequality(n,new u.Num(0),"gte");return t.append(i),t.hide_nodes(),this.updateNodeMap(e[0].get_mapping_to(i.children[0])),t}}]),e}();(0,l.default)(d,!0,u.ProductFraction,u.MulDiv)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MultiplyPowersAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"MultiplyPowersAction","Multiply powers"),this.triggerType="tap",this.priority=0,this.settings={delay:250,side:"inside"},t&&("drag"===t.triggerType?(this.triggerType=t.triggerType,this.nodes=t.nodes,this.target=t.target):this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.areLikeTerms=function(t,e){return(t.is_group("power")?t.children[0].to_ascii({normalizeSynonymsForFunctionLabels:!0}):t.to_ascii({normalizeSynonymsForFunctionLabels:!0}))===(e.is_group("power")?e.children[0].to_ascii({normalizeSynonymsForFunctionLabels:!0}):e.to_ascii({normalizeSynonymsForFunctionLabels:!0}))},l.prototype.match=function(t,e){if(t.is_group("power")&&(t=a.Sign.ascendToNonSignAncestor(t.parent)),arguments.length<2&&(e=t.ls),!e)return!1;if(!t.is_group("mul","div")||!e.is_group("mul","div"))return!1;var n=a.Sign.analyzeSignStructure(t.children[1]),i=a.Sign.analyzeSignStructure(e.children[1]);return!(n.count>1||i.count>1)&&this.areLikeTerms(n.descendent,i.descendent)},l.prototype.getSiblings=function(t){return t.parent.children.filter(function(e){return e!==t&&e.value===t.value})},l.prototype.getAllAvailableActions=function(t){var e=[];if(1!==t.length)return e;var n=t[0];if(!n.is_group("mul","div"))return e;for(var i=this.getSiblings(n),r=n.get_root(),o=0;o<i.length;o++)this.match(n,i[o])&&e.push(this.createBoundAction(r,{nodes:t,target:i[o],triggerType:"drag"}));return e},l.prototype.transform=function(t){var e=this.nodes&&this.nodes[0]||this.actor;e.is_group("power")&&(e=a.Sign.ascendToNonSignAncestor(e.parent));var n=this.target||e.ls;this.addTouchedNodes(e),this.addTouchedNodes(n);var i=this.analyzeStructure(e),o=this.analyzeStructure(n),s=(e=this.getNewTreeNode(e)).parent;n=this.getNewTreeNode(n);var l=this.performProductOfPowersProperty(e,n);if(this.mapOldSourceStructureToTarget(i,n),n=n.children[1],this.cleanup(s),this.simplify_exponent&&this.shouldSimplifyExponent(n)){var u=this.getExtendablesFromExponent(n);this.followup=r.gmath.actions.AddSubNumbersAction.createBoundAction(this.newTree,{actor:u.children[1]})}else this.simplify_exponent=!1,this.setNodesToReselectAfterAction(l);if(1===i.signCount+o.signCount||i.containsPlusMinus||o.containsPlusMinus){var c=i.containsPlusMinus||o.containsPlusMinus;a.Sign.wrapTerm(n,c)}if("function"!=typeof t)return!0;t(this)},l.prototype.analyzeStructure=function(t){var e={};e.muldiv=t;var n=a.Sign.analyzeSignStructure(t.children[1]);e.signCount=n.count,e.containsPlusMinus=n.containsPlusMinus;var i=n.descendent;return i.is_group("power")?(e.base=i.children[0],e.exponent=i.children[1]):(e.base=i,e.exponent=null),e},l.prototype.performProductOfPowersProperty=function(t,e){var n=a.Sign.analyzeSignStructure(t.children[1]),i=a.Sign.analyzeSignStructure(e.children[1]),r=n.descendent,o=i.descendent;1===n.count&&a.Sign.invertTerm(t),1===i.count&&a.Sign.invertTerm(e),r.is_group("power")||(r=this.reinterpretTermAsPowerWithExponentOfOne(r),this.simplify_exponent=!0),o.is_group("power")||(o=this.reinterpretTermAsPowerWithExponentOfOne(o),this.simplify_exponent=!0);var s=t.parent.children.indexOf(t)<e.parent.children.indexOf(e),l=this.extendTargetPowerWithSourcePower(o,r,s);return t.remove(),l},l.prototype.reinterpretTermAsPowerWithExponentOfOne=function(t){var e=t.parent,n=t.remove(),i=new a.Power(t,new a.Num(1));return e.insert(n,i),i},l.prototype.extendTargetPowerWithSourcePower=function(t,e,n){var i=this.getExtendablesFromExponent(e,!0),r=this.getExtendablesFromExponent(t,!1);return this.combineTermsIntoSum(r,i,n)},l.prototype.getExtendablesFromExponent=function(t,e){var n=t.children[1].children[0];return a.Brackets.areHidden(n)&&(n=n.children[1]),e&&n.remove(),n.is_group("brackets")?n.children[1]:n},l.prototype.combineTermsIntoSum=function(t,e,n){var i=[],r=t.parent,o=t.remove(),s=a.AddSub.prototype.createParentGroup(),l=new a.AddSub(e),u=new a.AddSub(t);return e.is_group("sum")?i=e.children.slice():i.push(l),s.append(u),s.insert(n?0:1,l),r.insert(o,s),a.Brackets.handle(s),this.cleanup(u),this.cleanup(l),i},l.prototype.mapOldSourceStructureToTarget=function(t,e){this.updateNodeMap(t.muldiv,e),this.updateNodeMap(t.muldiv.children[0],e.children[0]);var n=e.children[1].children[0];if(t.base.is_group("brackets")&&n.is_group("brackets"))this.updateNodeMap(t.base.get_mapping_to(n));else{var i=t.base.is_group("brackets")?t.base.children[1]:t.base,r=n.is_group("brackets")?n.children[1]:n;this.updateNodeMap(i.get_mapping_to(r))}if(t.exponent){var o=e.children[1].children[1];this.updateNodeMap(t.exponent,o)}},l.prototype.shouldSimplifyExponent=function(t){var e=this.getExtendablesFromExponent(t);return 2===e.children.length&&e.children.every(function(t){return a.Num.is_num(t.children[1])})},(0,s.default)(l,!0,a.MulDiv,a.Power)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MultiplyNumbersAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(n(0),n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3),l=e.MultiplyNumbersAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"MultiplyNumbersAction","Multiply numbers"));return n.triggerType="tap",n.priority=1,n.settings={is_join_action:!0,delay:250,side:"inside"},t&&n.initSettings(t),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),r(e,[{key:"getAllAvailableActions",value:function(t){if(t.length>1)return[];if(!t[0].is_group("mul","div"))return[];if(!a.Num.is_num(t[0].children[1],!0))return[];var e=this.getOtherNumberMulsInProduct(t[0]);return this.bindActionForEachTarget(t,e)}},{key:"getOtherNumberMulsInProduct",value:function(t){var e=t.parent;return e.filter(function(n){return n!==t&&n.is_group(t.value)&&a.Num.is_num(n.children[1],!0)&&n.parent===e})}},{key:"match",value:function(t){return this._matchHelper(t,!1)}},{key:"_matchHelper",value:function(t,e){if(!t.ls)return!1;if(t.ls.value!=t.value)return!1;var n=t.ls.children[1],i=t.children[1];return e?u(n)&&u(i):a.Num.is_num(n,!0)&&a.Num.is_num(i,!0)}},{key:"rematch",value:function(){return this.actor?this._matchHelper(this.actor,!0):function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rematch",this).call(this)}},{key:"transform",value:function(t){"drag"===this.triggerType?(this.sourceMul=this.nodes[0],this.targetMul=this.target):(this.sourceMul=this.actor,this.targetMul=this.actor.ls),this.addTouchedNodes(this.sourceMul),this.addTouchedNodes(this.targetMul);var e,n=this.getNewTreeNode(this.sourceMul),i=this.getNewTreeNode(this.targetMul),r=n.parent,o=i.children[1],s=n.children[1],l=a.Num.get_value(o,!0)*a.Num.get_value(s,!0);e=a.Sign.containsPlusMinus(o)||a.Sign.containsPlusMinus(s)?new a.MulDiv(new a.Sign(new a.Num(Math.abs(l)),!0),n.value):new a.MulDiv(new a.Num(l),n.value),this.updateNodeMap(this.sourceMul,e),this.updateNodeMap(this.sourceMul.children[0],e.children[0]),!this.sourceMul.children[1].is_group("sign","plusminus")&&e.children[1].is_group("sign","plusminus")?this.updateNodeMap(this.sourceMul.children[1].get_mapping_to(e.children[1].children[1])):this.updateNodeMap(this.sourceMul.children[1].get_mapping_to(e.children[1])),this.updateNodeMap(this.targetMul,e),this.updateNodeMap(this.targetMul.children[0],e.children[0]),!this.targetMul.children[1].is_group("sign","plusminus")&&e.children[1].is_group("sign","plusminus")?this.updateNodeMap(this.targetMul.children[1].get_mapping_to(e.children[1].children[1])):this.updateNodeMap(this.targetMul.children[1].get_mapping_to(e.children[1]));var u=i.remove();return r.insert(u,e),n.remove(),this.cleanup(r),"function"==typeof t&&t(this),this}}]),e}();function u(t){for(;t.is_group("sign","plusminus");)t=t.children[1];return a.Num.is_num(t,!0)}(0,s.default)(l,!0,a.MulDiv)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NegationAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(n(0),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3),l=e.NegationAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"NegationAction","apply a *(-1)"));return n.priority=0,n.triggerType="tap",n.settings={side:"inside",delay:300},t&&(t.nodes&&(n.priority=0),n.initSettings(t)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),r(e,[{key:"getAllAvailableActions",value:function(t){if(1!==t.length)return[];var e=u(t[0]);if(!e)return[];var n=function(t){return a.ProductFraction.getFactors(t.node.parent).filter(function(e){if(e===t.node)return!1;if(t.is_neg1||t.is_pm1)return!0;var n=u(e);return n.is_neg1||n.is_pm1})}(e);return this.bindActionForEachTarget(t,n)}},{key:"match",value:function(t){var e=u(t),n=u(t.ls);return e.is_neg1||e.is_pm1||n.is_neg1||n.is_pm1}},{key:"transform",value:function(t){var e=this.getSourceAndTarget();this.addTouchedNodes(e.source),this.addTouchedNodes(e.target);var n=u(e.source);if(!n.is_neg1&&!n.is_pm1){var i=[e.target,e.source];e.source=i[0],e.target=i[1],n=u(e.source)}var r=this.getNewTreeNode(e.source),o=this.getNewTreeNode(e.target);r.remove();var s=o.parent,a=o.children[1];return a.replace_with(r.children[1]),o.children[1].children[1].replace_with(a),this.applyInnerAction("SignDoubleNegAction",{actor:o.children[1]}),this.cleanup(s),"function"==typeof t&&t(this),this}}]),e}();function u(t){return!(!t||!t.is_group("mul","div"))&&{node:t,is_neg1:-1===a.Num.get_value(t.children[1]),is_pm1:t.children[1].is_group("plusminus")&&1===a.Num.get_value(t.children[1],!0)}}(0,s.default)(l,!0,a.MulDiv)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MultiplyFractionsAction=c;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3),u=n(12);function c(t){s.Action.call(this,"MultiplyFractionsAction","multiply fractions"),this.priority=1,this.triggerType="tap",this.settings={delay:250,side:"inside"},t&&(this.settings.auto_simplify_signs=u.MathSettings.get("auto_simplify_signs"),t.nodes?(this.triggerType="drag",this.nodes=t.nodes,this.target=t.target):this.actor=t.actor)}r.gmath.inherit(s.Action,c),c.prototype.getAllAvailableActions=function(t){if(1!==t.length)return[];var e=t[0];if(!e.parent.is_group("product","fraction"))return[];var n=e.parent.children.filter(this.match2.bind(this,e));return this.bindActionForEachTarget(t,n)},c.prototype.match=function(t){return this.match2(t.ls,t)},c.prototype.match2=function(t,e){if(!t||!e||t===e)return!1;if(t.value!==e.value)return!1;var n=t.children[1],i=e.children[1];return n.is_group("plusminus","sign")&&(n=n.children[1]),i.is_group("plusminus","sign")&&(i=i.children[1]),!(!n.is_group("fraction")||!i.is_group("fraction")||!t.parent.is_group("fraction","product"))},c.prototype.transform=function(t){var e=this.getSourceAndTarget();this.sourceMul=e.source,this.targetMul=e.target,this.addTouchedNodes(this.sourceMul),this.addTouchedNodes(this.targetMul);var n,i=this.getNewTreeNode(this.targetMul),r=this.getNewTreeNode(this.sourceMul),s=i.parent,a=i.children[1],u=r.children[1];a.is_group("plusminus","sign")&&(a=a.children[1]),u.is_group("plusminus","sign")&&(n=u,u=u.children[1]);var c=this.getOldTreeNode(u);this.updateNodeMap(c.get_fraction_bar(),a.get_fraction_bar()),this.updateNodeMap(this.sourceMul,i),this.updateNodeMap(this.sourceMul.children[0],i.children[0]),o.Tree.remove(r);for(var d=u.get_top(),h=u.get_bottom(),p=0;p<d.length;p++)a.append(d[p]);for(p=0;p<h.length;p++)a.append(h[p]);for(p=0;p<a.children.length;p++){var f=a.children[p];f.has_children()&&l.Brackets.handle(f.children[1])}return n&&(a.replace_with(n),n.children[1].replace_with(a),this.settings.auto_simplify_signs&&this.applyInnerAction("SignDoubleNegAction",{actor:n,tree:n.parent})),a.children.forEach(function(t){t.is_group("mul","div")&&1===l.Num.get_value(t.children[1])&&(t.simplify=!0)}),this.cleanup(s),"function"==typeof t&&t(this),this},(0,a.default)(c,!0,l.MulDiv)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MulDivLogarithmsAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){if(s.Action.call(this,"MulDivLogarithmsAction","muliply or divide a logarithm by a number"),this.priority=1,this.triggerType="tap",this.settings={delay:300,reset_y:!0,no_target_box_expansion:!0},t){var e={};t.target&&(e.destination_hint=[{node:t.target.children[1],side:"right-of",margin:{y2:.5}}]),this.initSettings(r.gmath.extend(t,e))}}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionsForEachTarget(t,n)},u.prototype.matchSource=function(t){return!!t[0].is_group("mul","div")&&(1===t.length?{nodes:t,only_match_logarithms:!l.Func.Logs.is_log_func(t[0].children[1]),do_not_cross_frac:!(l.Func.Logs.is_log_func(t[0].children[1])&&t[0].is_group("mul")||!l.Func.Logs.is_log_func(t[0].children[1])&&t[0].is_group("div")),group:t[0].parent}:!!o.Tree.is_range(t)&&{nodes:t,only_match_logarithms:!0,do_not_cross_frac:t[0].is_group("mul"),group:t[0].parent})},u.prototype.getTargets=function(t){var e=t.nodes[0].is_group("mul")?t.group.get_top():t.group.get_bottom();return(e=e.concat(t.do_not_cross_frac?[]:t.nodes[0].is_group("mul")?t.group.get_bottom():t.group.get_top())).filter(function(e){return-1===t.nodes.indexOf(e)&&(!t.only_match_logarithms||l.Func.Logs.is_log_func(e.children[1]))},this)},u.prototype.bindActionsForEachTarget=function(t,e){var n=[];return e.forEach(function(e){var i=l.Func.Logs.is_log_func(e.children[1])?e.children[1].children[1]:e.children[1];n=n.concat(this.bindActionForEachTarget(t,[i]))},this),n},u.prototype.match=function(t){if(!t.ls||t.ls instanceof l.Sym)return!1;if(!t.is_group("mul","div")||t.ls.value!==t.value)return!1;var e=t.ls.children[1],n=t.children[1];return l.Func.Logs.is_log_func(e)||l.Func.Logs.is_log_func(n)},u.prototype.transform=function(t){var e,n,i,r,s,a,u=this.getSourceAndTarget(!0);if(this.addTouchedNodes(u.source),this.addTouchedNodes(u.target),u.source[0].is_group("fraction"))n=(e=this.getNewTreeNode(u.source[0])).get_bottom(),i=e.get_top()[0];else for(n=this.getNewTreeNode(u.source),i=this.getNewTreeNode(u.target),e=n[0].parent;!i.is_group("mul","div");)i=i.parent;n.length>1||l.Func.Logs.is_log_func(i.children[1])?(r=n,s=i,a=!1):(r=[i],s=n[0],a=!0);var c=r.map(this.getOldTreeNode.bind(this));o.Tree.remove_range(r),r[0].is_group("div")&&r[0].value===s.value&&r.forEach(function(t){t.invert()});var d=s.children[1].get_arg(),h=d.parent,p=d.remove(),f=new l.Power;f.append(d),l.Brackets.handle(d);var g=new l.ProductFraction;g.append_range(r);var m=new l.Exponent(g);return f.append(m),h.insert(p,f),l.Brackets.handle(s.children[1].children[1]),c.forEach(function(t){t.map_group_and_sym(this,s,!0)},this),this.setNodesToReselectAfterAction(a?s:m),this.cleanup(g),this.cleanup(e),"function"==typeof t&&t(this),this},(0,a.default)(u,!0,l.ProductFraction,l.MulDiv)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LogarithmSplitAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){if(s.Action.call(this,"LogarithmSplitAction","turn a log into a sum of logs"),this.priority=1,this.triggerType="drag",this.settings={target_group:!0,group_side:"outside"},t){var e={node:t.target.parent.parent,margin:"left-of"===t.side?{x1:-.5,x2:.1}:{x1:.1,x2:-.5}},n={nodes:[t.target.parent.parent]};this.initSettings(r.gmath.extend(t,{drop_area_hint:e,destination_hint:n}))}}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n,!0)},u.prototype.matchSource=function(t){if(!o.Tree.is_range(t))return!1;var e=t[0];if(!e.is_group("mul","div"))return!1;var n=e.get_parent(2);return!!n.is_group("param")&&(n=n.get_parent(3),!!l.Func.Logs.is_log_func(n)&&{nodes:t,tuple:e.get_parent(3)})},u.prototype.getTargets=function(t){return[t.tuple]},u.prototype.transform=function(t){this.addTouchedNodes(this.target.parent);var e=this.getNewTreeNode(this.nodes),n=e[0].parent,i=e[0].get_parent(5),r=i.parent,s=i.remove();o.Tree.remove_range(e);var a=i.clone(!1);a.get_arg().remove();var u=!1,c=new l.ProductFraction;1===e.length&&l.ProductFraction.is_fraction_with_identity_numerator(e[0].children[1])&&(e=e[0].children[1].get_bottom(),o.Tree.remove_range(e)),e.forEach(function(t){t.is_group("div")&&(u=!0,t.invert()),c.append(t)},this),a.get_child([1,1,0]).append(c);var d=new l.Sum;d.append(new l.AddSub(i));var h=new l.AddSub(a,u?"sub":"add");return d.insert("left-of"===this.settings.side?0:1,h),r.insert(s,d),this.nodes[0].get_parent(5).map_to_func(this,a),l.Brackets.handle(d),this.setNodesToReselectAfterAction(h),this.cleanup(c),this.cleanup(n),this.cleanup_cascade(r),"function"==typeof t&&t(this),this},(0,a.default)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LogSimplifyAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"LogSimplifyAction","simplify a log with a power as the argument"),this.priority=0,this.triggerType="tap",this.settings={},t&&(this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.match=function(t){if(!a.Func.Logs.is_log_func(t))return!1;var e=a.Func.Logs.get_log_base(t),n=t.get_arg();return!!n.is_group("power")&&e.to_ascii()===n.children[0].to_ascii()},l.prototype.transform=function(t){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor),n=e.get_arg().get_exponent_term();return e.replace_with(n),a.Brackets.handle(n),this.cleanup_cascade(n.parent),"function"==typeof t&&t(this),this},(0,s.default)(l,!1,a.Func)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LogSimplifyPowerAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"LogSimplifyPowerAction","simplify a power with a log exponent"),this.priority=0,this.triggerType="tap",this.settings={},t&&(this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.match=function(t){if(!a.Func.Logs.is_log_func(t))return!1;if(!t.parent.is_group("exponent"))return!1;var e=t.get_parent(2).children[0];return a.Func.Logs.get_log_base(t).to_ascii()===e.to_ascii()},l.prototype.transform=function(t){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor),n=e.get_arg();return e.get_parent(2).replace_with(n),a.Brackets.handle(n),this.cleanup_cascade(n.parent),"function"==typeof t&&t(this),this},(0,s.default)(l,!1,a.Func)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LogarithmInvertAction=l;var i,r=n(0),o=n(2),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"LogarithmInvertAction","move the base of a logarithm across an equation"),this.priority=1,this.triggerType="drag",this.settings={side:"around",reset_y:!0,margin:{}},t&&(this.nodes=t.nodes,this.target=t.target,this.settings.margin=0===t.nodes[0].get_parent(2).get_idx()?{x1:-.5}:{x2:-.5})}r.gmath.inherit(o.Action,l),l.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n)},l.prototype.matchSource=function(t){if(1!==t.length)return!1;var e=t[0],n=e.get_parent(3);return!(!n||!a.Func.Logs.is_log_func(n)||a.Func.Logs.get_log_base(n)!==e)&&!!n.parent.is_group("equals")&&{nodes:t,func:n}},l.prototype.getTargets=function(t){var e=t.func.parent,n=0===t.func.get_idx()?2:0;return[e.children[n]]},l.prototype.transform=function(t){this.addTouchedNodes(this.target.parent);var e=this.getNewTreeNode(this.nodes)[0],n=this.getNewTreeNode(this.target),i=e.get_parent(3),r=i.get_arg(),o=n.parent;i.replace_with(r);var s=n.remove(),l=new a.Power(e,n);return o.insert(s,l),this.setNodesToReselectAfterAction(l),"function"==typeof t&&t(this),this},(0,s.default)(l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LogarithmExtractExponentOfArgumentAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){if(s.Action.call(this,"LogarithmExtractExponentOfArgumentAction","move the exponent of the argument outside of the logarithm"),this.priority=1,this.triggerType="drag",this.settings={target_group:!0,group_side:"outside",reset_y:!0},t){var e="left-of"===t.side?{x1:-.5,x2:.1}:{x1:.1,x2:-.5};t.drop_area_hint={node:t.target.parent.parent,margin:e},t.destination_hint={nodes:[t.target.parent.parent]},this.initSettings(t)}}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n,!0)},u.prototype.matchSource=function(t){if(1!==t.length)return!1;var e=t[0];if(!e.is_group("exponent","degree"))return!1;var n=e.get_parent(2);return!!n.is_group("param")&&(n=n.get_parent(3),!!l.Func.Logs.is_log_func(n)&&{nodes:t,tuple:e.get_parent(3)})},u.prototype.getTargets=function(t){return[t.tuple]},u.prototype.transform=function(t){this.addTouchedNodes(this.target.parent);var e=this.getNewTreeNode(this.nodes),n=e[0].parent,i=e[0].get_parent(5),r=i.parent,s=i.remove();o.Tree.remove_range(e);var a=e[0].children[0],u=!1;l.Brackets.areHidden(a)&&l.ProductFraction.is_fraction_with_identity_numerator(a.children[1])?(a=a.children[1].get_bottom(),o.Tree.remove_range(a),e[0].is_group("degree")&&a.forEach(function(t){t.invert()}),u=!0):l.Brackets.areHidden(a)&&a.children[1].is_group("product")&&(a=a.children[1].children.slice(),o.Tree.remove_range(a),e[0].is_group("degree")&&a.forEach(function(t){t.invert()}),u=!0);var c=new l.ProductFraction;c.append(new l.MulDiv(i));var d=u?a:[new l.MulDiv(a,e[0].is_group("degree")?"div":"mul")];return d[0].is_group("div")?d.forEach(c.append.bind(c)):c.insert_range("left-of"===this.settings.side?0:1,d),r.insert(s,c),u||l.Brackets.handle(d[0].children[1],!0),this.updateNodeMap(this.nodes[0],d),l.Brackets.handle(c),this.cleanup(n),this.cleanup_cascade(r),l.Brackets.handle(i.get_arg(),!0),"function"==typeof t&&t(this),this},(0,a.default)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LogarithmEvaluateAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"LogarithmEvaluateAction","move the exponent of the argument outside of the logarithm"),this.priority=1,this.triggerType="tap",this.settings={},t&&(this.actor=t.actor)}r.gmath.inherit(s.Action,u),u.prototype.match=function(t){if(!l.Func.Logs.is_log_func(t))return!1;var e=l.Func.Logs.get_log_base(t),n=t.get_arg();return!!n.is_leaf_node&&l.Func.Logs.within_domain(n)&&l.Func.Logs.within_domain(e)},u.prototype.transform=function(t){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor),n=new l.Num(l.Func.Logs.evaluate(e));return o.Tree.replace(e,n),this.actor.map_to_group(this,n),"function"==typeof t&&t(this),this},(0,a.default)(u,!1,l.Func)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LogarithmEvaluateSameArgAsBaseAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"LogarithmEvaluateSameArgAsBaseAction","move the exponent of the argument outside of the logarithm"),this.priority=1,this.triggerType="tap",this.settings={},t&&(this.actor=t.actor)}r.gmath.inherit(s.Action,u),u.prototype.match=function(t){if(!l.Func.Logs.is_log_func(t))return!1;var e=l.Func.Logs.get_log_base(t),n=t.get_arg();return e.to_ascii()===n.to_ascii()},u.prototype.transform=function(t){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor),n=new l.Num(1);return o.Tree.replace(e,n),this.actor.map_to_group(this,n),"function"==typeof t&&t(this),this},(0,a.default)(u,!1,l.Func)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InvertedFunctionCancelAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(2),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(20),l=n(1),u=e.InvertedFunctionCancelAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"InvertedFunctionCancelAction","cancel out a function inside the inverse of that function"));return n.priority=0,n.triggerType="tap",t&&(n.actor=t.actor),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),r(e,[{key:"match",value:function(t){return!(!t.is_group("func")||!c(t)&&!d(t))}},{key:"transform",value:function(t){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor),n=void 0,i=void 0;if(c(e))n=e,i=e.get_arg().get_arg();else{if(!d(e))throw"[InvertedFunctionCancelAction] Unexpected expression structure found in transform.";n=a.Func.getImmediateParentFunctionIfExists(e),i=e.get_arg()}return l.Tree.replace(n,i),"function"==typeof t&&t(this),!0}}]),e}();function c(t){return t.isInverseOf(t.get_arg())}function d(t){var e=a.Func.getImmediateParentFunctionIfExists(t);return e&&t.isInverseOf(e)}(0,s.default)(u,!1,a.Func)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IndexSimplifyAction=c;var i=n(0),r=n(2),o=u(n(25)),s=n(5),a=u(n(4)),l=n(3);function u(t){return t&&t.__esModule?t:{default:t}}function c(t){r.Action.call(this,"IndexSimplifyAction","when the inverse index forms are nested and have the same index, they cancel"),this.settings={},this.interactionType="tap",t&&(this.actor=t.actor)}i.gmath.inherit(r.Action,c),c.prototype.match=function(t){if(!t.is_group("power"))return!1;var e=t.children[0];if(!e.is_group("brackets")||!e.children[1].is_group("radical"))return!1;var n=e.children[1].get_degree_term(),i=t.get_exponent_term();return n.to_ascii()===i.to_ascii()},c.prototype.match=function(t){var e,n;if(t.is_group("power")){var i=t.children[0];if(!i.is_group("brackets")||!i.children[1].is_group("radical"))return!1;e=i.children[1].get_degree_term(),n=t.get_exponent_term()}else if(t.is_group("radical")){var r=t.get_radicand();if(!r.is_group("power"))return!1;e=t.get_degree_term(),n=r.get_exponent_term()}return e&&n&&e.to_ascii()===n.to_ascii()},c.prototype.isGreaterOrEqualsZero=function(t){var e=s.AlgebraModel.evalExpression(t);return Number.isNaN(e)?o.default?"1"===(e=o.default.run(i.gmath.termsToAlgebriteString(t)+" >= 0"))||"0"!==e&&null:null:e>=0},c.prototype.getNumVal=function(t){var e=s.AlgebraModel.evalExpression(t);return Number.isNaN(e)?o.default?"1"===(e=o.default.run(i.gmath.termsToAlgebriteString(t)+" >= 0"))||"0"!==e&&null:null:e>=0},c.prototype.transform=function(t){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor),n=e.is_group("power")?e.get_child([0,1]):e.get_radicand(),i=n.is_group("power")?n.children[0]:n.get_radicand(),r=e.is_group("power")?e.get_exponent_term():e.get_degree_term(),o=s.AlgebraModel.evalExpression(r),a=(Math.round(o),!isNaN(o));if(n.is_group("radical"))o%2==1?e.replace_with(i):(!1!==(h=this.isGreaterOrEqualsZero(i))&&e.replace_with(i),null===h&&a&&(this.settings.restraint=i.to_ascii()+"≥0"));else if(n.is_group("power"))if(o%2==0){if(e.replace_with(i),!(h=this.isGreaterOrEqualsZero(i))){var u=i.parent,c=i.remove(),d=new l.AbsVal(i);u.insert(c,d)}}else if(o%2==1)e.replace_with(i);else{var h;!1!==(h=this.isGreaterOrEqualsZero(i))&&e.replace_with(i),null===h&&a&&(this.settings.restraint=i.to_ascii()+"≥0")}var p=i.is_group("brackets")?i.children[1]:i;if(l.Brackets.handle(i,!0),this.cleanup(p.parent),"function"!=typeof t)return!0;t(this)},(0,a.default)(c,!1,l.Radical,l.Power)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IndexInvertAction=c;var i=n(0),r=n(2),o=u(n(25)),s=n(5),a=u(n(4)),l=n(3);function u(t){return t&&t.__esModule?t:{default:t}}function c(t){r.Action.call(this,"IndexInvertAction","invert an index across an equation"),this.triggerType="drag",this.settings.side="around",t&&this.initSettings(t)}i.gmath.inherit(r.Action,c),c.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n)},c.prototype.matchSource=function(t){return 1===t.length&&!!t[0].is_group("exponent","degree")&&0!==l.Num.get_value(t[0].children[0])&&!(!t[0].parent.parent||!t[0].parent.parent.is_group("equals"))&&{nodes:t[0],idx_of_index_group:t[0].parent.get_idx(),equation:t[0].get_parent(2)}},c.prototype.getTargets=function(t){return[t.equation.children[0===t.idx_of_index_group?2:0]]},c.prototype.transform=function(t){this.addTouchedNodes(this.nodes[0].get_root());var e=this.getSourceAndTarget(),n=this.getNewTreeNode(e.source),i=n.is_group("exponent")?n.parent.children[0]:n.parent.children[3],r=n.parent,o=this.getNewTreeNode(e.target);n.remove();var s=n.is_group("exponent")&&this.termIsEven(n.get_term()),a=this.wrapTermInIndexGroup(o,n,s);if(this.updateNodeMap(e.source,a),l.Brackets.areHidden(i)&&l.Brackets.handle(i,!0),this.cleanup(r),"function"!=typeof t)return!0;t(this)},c.prototype.termIsEven=function(t){var e=s.AlgebraModel.evalExpression(t);return Number.isNaN(e)?o.default?o.default.eval(i.gmath.termsToAlgebriteString(t)).toString()%2==0:null:e%2==0},c.prototype.wrapTermInIndexGroup=function(t,e,n){var i,r,o=t.parent,s=t.remove(),a=e.get_term();return a.remove(),e.is_group("exponent")&&Number.isInteger(l.Num.get_value(a))&&l.Num.get_value(a)>1?r=(i=new l.Radical(t,a)).get_degree():(i=new l.Power(t,a),e.is_group("exponent")&&l.ProductFraction.convert_to_reciprocal(a),l.Brackets.handle(i.children[1].children[0],!0),r=i.children[1]),n&&(i=new l.Sign(i,!0)),o.insert(s,i),r},(0,a.default)(c)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IndexIdentityAction=l;var i,r=n(0),o=n(2),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"IndexIdentityAction","an index of 1 leaves the base unchanged"),this.priority=0,this.triggerType="tap",t&&(this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.match=function(t){return!(!t.is_group("power")||!a.Num.is_equal_to(t.children[1].children[0],1))||!(!t.is_group("radical")||!a.Num.is_equal_to(t.children[0].children[0],1))},l.prototype.transform=function(t){this.addTouchedNodes(this.actor);var e=this.actor.is_group("power")?this.actor.children[1]:this.actor.children[0],n=this.getNewTreeNode(e).parent,i=n.is_group("power")?n.children[0]:n.get_radicand();if(n.replace_with(i),a.Brackets.handle(i,!0),this.updateNodeMap(e.parent,i),this.updateNodeMap(e,i),this.updateNodeMap(e.children[0],i),"function"!=typeof t)return!0;t(this)},(0,s.default)(l,!1,a.Power,a.Radical)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IndexFormConversionAction=l;var i,r=n(0),o=n(2),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"IndexFormConversionAction","convert a power or radical to its other representation"),this.priority=0,this.triggerType="drag",this.settings={delay:1500,on_release:!0,reset_y:!0,no_target_box_expansion:!0},t&&(this.nodes=t.nodes,this.target=t.target,this.settings.side=this.target.is_group("radical")?"right-of":"left-of",this.settings.margin=this.target.is_group("radical")?{x2:-.4,y2:.7,y1:-.4}:{x1:-.4,y2:.5,y1:-.2})}r.gmath.inherit(o.Action,l),l.prototype.getAllAvailableActions=function(t){return this.matchSource(t)?this.bindActionForEachTarget(t,[t[0].parent]):[]},l.prototype.matchSource=function(t){return 1===t.length&&(t[0].is_group("degree")||t[0].is_group("exponent"))},l.prototype.transform=function(t){this.addTouchedNodes(this.target);var e=this.getNewTreeNode(this.nodes)[0],n=e.parent,i=n.is_group("radical")?n.get_radicand():n.children[0],r=n.parent,o=n.remove();i.remove(),e.remove();var s=e.get_term();s.remove();var l=n.is_group("radical")?new a.Exponent(s):new a.Degree(s);s=a.ProductFraction.convert_to_reciprocal(s),a.Brackets.handle(l.children[0],!0);var u=n.is_group("radical")?new a.Power(i,l):new a.Radical(i,l);return r.insert(o,u),this.updateNodeMap(this.nodes[0],l),this.updateNodeMap(this.nodes[0].parent,u),"function"==typeof t&&t(this),this},(0,s.default)(l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ImaginarySqrtOfNegativeOneAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"ImaginarySqrtOfNegativeOneAction","calculate a power of an imaginary number"),this.priority=0,this.triggerType="tap",t&&(this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.match=function(t){if(t.is_group("radical")&&a.Num.is_equal_to(t.get_radicand(),-1)&&a.Num.is_equal_to(t.get_degree_term(),2))return!0;var e=t.get_parent(1);if(!e.is_group("power"))return!1;var n=e.children[0];if(!n.is_group("brackets"))return!1;var i=a.Num.get_value(n.children[1]);return!isNaN(i)&&-1===i&&!!a.Num.is_equal_to(e.get_child([1,0]),.5)},l.prototype.transform=function(t){var e=void 0,n=void 0,i=void 0,r=void 0;this.actor.is_group("radical")?(this.addTouchedNodes(this.actor),e=this.actor,i=(n=this.getNewTreeNode(this.actor)).parent,r=n.remove()):(this.addTouchedNodes(this.actor.parent),e=this.actor.parent,i=(n=this.getNewTreeNode(e)).parent,r=n.remove());var o=new a.Var("i");if(i.insert(r,o),this.cleanup_cascade(i),this.updateNodeMap(e.get_mapping_to(o)),"function"!=typeof t)return!0;t(this)},(0,s.default)(l,!1,a.Radical,a.Exponent)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ImaginaryEvaluateIntegerPowerAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"ImaginaryEvaluateIntegerPowerAction","calculate a power of an imaginary number"),this.priority=1,this.triggerType="tap",t&&(this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.match=function(t){var e=t.get_parent(1);if(!e.is_group("power"))return!1;var n=e.children[0];if(!a.Var.is_constant(n)||"i"!==n.value)return!1;var i=e.get_child([1,0]);i.is_group("brackets")&&i.children[0].hidden&&(i=i.children[1]);var r=a.Num.get_value(i);return!isNaN(r)&&Math.round(r)===r},l.prototype.transform=function(t){this.addTouchedNodes(this.actor.parent);var e=this.getNewTreeNode(this.actor),n=(this.actor.get_parent(1),e.parent),i=n.children[0],r=e.children[0];r.is_group("brackets")&&(r=r.children[1]);var o=a.Num.get_value(r);i.remove();var s=this.getEvaluateBase(i,o);if(n.replace_with(s),"function"!=typeof t)return!0;t(this)},l.prototype.getEvaluateBase=function(t,e){var n,i=e%4;return 0===i?n=new a.Num(1):-3===i||1===i?n=t:-2===i||2===i?n=new a.Num(-1):-1!==i&&3!==i||(n=new a.Sign(t)),n},(0,s.default)(l,!1,a.Exponent)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ImaginaryAssociateOutOfSqrtAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"ImaginaryAssociateOutOfSqrtAction","calculate a power of an imaginary number"),this.priority=1,this.triggerType="drag",this.settings={target_group:!0,group_side:"outside",margin:{x:-.1,y:-.1}},t&&(this.nodes=t.nodes,this.target=t.target,this.settings.side=t.side)}r.gmath.inherit(o.Action,l),l.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n,!0)},l.prototype.matchSource=function(t){if(1!==t.length)return!1;var e=t[0];return!!a.Num.is_equal_to(e.children[1],-1)&&!(!e.parent.parent||!this.withinSqrt(e.get_parent(2)))&&{nodes:t,group:e.parent,power:e.get_parent(3)}},l.prototype.getTargets=function(t){return[t.group]},l.prototype.withinSqrt=function(t){return t.is_group("brackets")&&t.parent.is_group("power")&&t.parent.is_square_root()},l.prototype.transform=function(t){this.addTouchedNodes(this.nodes);var e=this.getNewTreeNode(this.nodes)[0],n=e.parent,i=n.get_parent(2),r=i.parent,o=i.remove(),s=new a.ProductFraction;e.remove();var l=e.children[1],u=new a.Var("i");if(l.replace_with(u),this.updateNodeMap(this.nodes[0].children[1].get_mapping_to(u)),e.is_group("div")&&e.invert(),s.append(new a.MulDiv(i)),s.insert("left-of"===this.settings.side?0:1,e),r.insert(o,s),this.cleanup(n),this.cleanup_cascade(r),"function"!=typeof t)return!0;t(this)},(0,s.default)(l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ImaginaryAssociateNegOneOutOfSqrtAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"ImaginaryAssociateNegOneOutOfSqrtAction","calculate a power of an imaginary number"),this.priority=1,this.triggerType="drag",this.settings={side:"outside"},t&&(this.nodes=t.nodes,this.target=t.target)}r.gmath.inherit(o.Action,l),l.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n)},l.prototype.matchSource=function(t){if(1!==t.length)return!1;var e=t[0];return!!a.Num.is_equal_to(e,-1)&&!!this.withinSqrt(e.parent)&&{nodes:t,power:e.get_parent(2)}},l.prototype.getTargets=function(t){return[t.nodes[0].parent]},l.prototype.withinSqrt=function(t){return t.is_group("brackets")&&t.parent.is_group("power")&&t.parent.is_square_root()},l.prototype.transform=function(t){this.addTouchedNodes(this.nodes);var e=this.getNewTreeNode(this.nodes)[0].get_parent(2),n=e.parent,i=this.getOldTreeNode(e),r=e.remove(),o=new a.Var("i");if(n.insert(r,o),this.updateNodeMap(i.get_mapping_to(o)),this.cleanup_cascade(n),"function"!=typeof t)return!0;t(this)},(0,s.default)(l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SplitNumeratorAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"SplitNumeratorAction","split numerator into new fractions with same denominators"),this.priority=-2,this.triggerType="drag",this.settings={margin:{y:.25}},t&&(this.nodes=t.nodes,this.target=t.target,this.settings.side=Array.isArray(this.target)?"around":t.side,this.settings.target_is_left="left-of"===t.side,this.settings.margin["right-of"===t.side?"x2":"x1"]=-1,this.settings.margin["right-of"===t.side?"x1":"x2"]=.2)}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){if(0===t.length)return[];var e=t[0];return e.parent&&e.parent.parent&&e.parent.parent.parent&&e.parent.parent.parent.parent&&e.is_group("add","sub","addsub")&&e.parent.parent.parent.is_group("mul")&&e.parent.parent.parent.parent.is_group("fraction")?e.parent.parent.parent.parent.get_top().length>1?[]:this.match(t,e.parent.parent.parent.parent)?[this.bindAction(t,"left-of"),this.bindAction(t,"right-of")]:[]:[]},u.prototype.bindAction=function(t,e){var n=t[0].get_root(),i=[];return this.fractionIsPartOfProduct(t)&&(i=this.getSiblingsOfFraction(t,e)),this.createBoundAction(n,{nodes:t,target:i.length>0?i:t[0].parent.parent.parent.parent,side:e})},u.prototype.fractionIsPartOfProduct=function(t){var e=t[0].parent;return e.parent&&e.parent.is_group("sum")},u.prototype.getSiblingsOfFraction=function(t,e){var n=t[0].parent.parent,i=n.parent;return"left-of"===e?i.children.slice(0,i.children.indexOf(n)):i.children.slice(i.children.indexOf(n)+1)},u.prototype.match=function(t,e){return 0!==t.length&&t[0]&&t[0].is_group("add","sub","addsub")&&t[0].parent.parent.parent.parent===e&&e.is_group("fraction")},u.prototype.transform=function(t){var e=this.getNewTreeNode(this.nodes);this.addTouchedNodes(this.nodes[0].parent.parent.parent.parent);var n=this.nodes[0].parent.parent.parent.parent.get_bottom(),i=this.nodes[0].parent.parent.parent.parent.children[1],r=e[0].parent.parent.parent.parent;o.Tree.remove_range(e);var s=l.AddSub.prototype.createParentGroup();r.replace_with(s),s.append(new l.AddSub(r));var a=r.get_bottom(),u=new l.ProductFraction;u.invert();var c=l.AddSub.prototype.createParentGroup();c.append_range(e),u.insert(0,new l.MulDiv(c));for(var d=0;d<a.length;d++){var h=o.Tree.clone(a[d]);u.append(h),this.extendNodeMap(n[d].get_mapping_to(h))}this.extendNodeMap(i,u.children[1]);var p=new l.AddSub(u),f=this.settings.target_is_left;s.insert(f?0:1,p);var g=this.rearrangeSumIfNumeratorIsASingleTerm(s,0),m=this.rearrangeSumIfNumeratorIsASingleTerm(s,1);if(f&&!g||!f&&!m)for(d=0;d<e.length;d++)this.updateNodeMap(e[d],p);var v=r.get_top(),y=u.get_top();if(1===v.length&&this.cleanup(v[0]),1===y.length&&this.cleanup(y[0]),this.cleanup(s.parent),l.Brackets.handle(s),"function"!=typeof t)return!0;t(this)},u.prototype.rearrangeSumIfNumeratorIsASingleTerm=function(t,e){var n=t.children[e],i=n.children[1];if(1===i.children[0].children[1].children[1].children.length){var r=i.children[0].children[1].children[1],o=r.children[0],s=o.children[1],a=r.parent.parent;return r.parent.remove(),o.remove(),s.remove(),r.remove(),i.remove(),n.remove(),t.insert(e,o),o.append(i),a.append(s),!0}return!1},(0,a.default)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FractionMoveOuterNested=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){if(s.Action.call(this,"FractionMoveOuterNested","move a term across a nested fraction"),this.priority=1,this.triggerType="drag",this.settings={delay:1500,reset_y:!0,target_group:!0,group_side:"around",no_target_box_expansion:!0},t){var e=t.target.is_group("mul")?{y1:.2,x:-.1}:{y2:.2,x:-.1},n={node:l.ProductFraction.get_whole_range(t.target),side:"around",margin:e},i={margin:e};this.initSettings(r.gmath.extend(t,{drop_area:n,drop_area_hint:i}))}}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n,!0)},u.prototype.matchSource=function(t){if(!o.Tree.is_range(t))return!1;var e=t[0];return!!e.parent.is_group("fraction")&&{nodes:t,frac:e.parent}},u.prototype.getTargets=function(t){var e=[];return(t.nodes[0].is_group("mul")?t.frac.get_bottom():t.frac.get_top()).forEach(function(t){var n=t.children[1];n.is_group("fraction")&&(e=e.concat(n.get_bottom()))}),e},u.prototype.adjustTargetBoxes=function(t){return t.forEach(function(t){t.target.is_group("div")?t.settings.margin={y1:.3}:t.settings.margin={y2:.3}},this),t},u.prototype.transform=function(t){this.addTouchedNodes(this.nodes);var e=this.matchSource(this.getNewTreeNode(this.nodes)).nodes,n=e[0].parent,i=this.getNewTreeNode(this.target);o.Tree.remove_range(e),i.value!==e[0].value&&e.forEach(function(t){return t.invert()});var r=i.get_idx()+("left-of"===this.settings.side?0:1);return i.parent.insert_range(r,e),this.cleanup_cascade(n),"function"==typeof t&&t(this),this},(0,a.default)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FractionMoveInnerNested=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){if(s.Action.call(this,"FractionMoveInnerNested","move a term across a nested fraction"),this.priority=1,this.triggerType="drag",this.settings={delay:1500,reset_y:!0,target_group:!0,group_side:"around",no_target_box_expansion:!0},t){var e=t.target.is_group("div")?{y1:.2,x:-.1}:{y2:.2,x:-.1},n={node:l.ProductFraction.get_whole_range(t.target),side:"around",margin:e},i={margin:e};this.initSettings(r.gmath.extend(t,{drop_area:n,drop_area_hint:i}))}}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n.inner,!0).concat(this.bindActionForEachTarget(t,n.outer,!0))},u.prototype.matchSource=function(t){if(!o.Tree.is_range(t))return!1;var e=t[0],n=e.parent,i=n.get_parent(2);if(!(e.is_group("mul","div")&&n.is_group("fraction")&&i&&i.is_group("fraction")))return!1;var r=e.children[1];return!(1===l.Num.get_value(r)&&e.is_group("mul")&&!e.ls&&e.rs&&"//"===e.rs.value)&&{nodes:t,inner_frac:n,outer_frac:i}},u.prototype.getTargets=function(t){var e=t.nodes[0].is_group("mul"),n={outer:[],inner:[]};return(t.inner_frac.parent.is_group("mul")?t.outer_frac.get_bottom():t.outer_frac.get_top()).forEach(function(t){var i=t.children[1];i.is_group("fraction")&&(n.inner=n.inner.concat(e?i.get_bottom():i.get_top())),e||n.outer.push(t)}),n},u.prototype.adjustTargetBoxes=function(t){return t.forEach(function(t){t.target.is_group("div")?t.settings.margin={y1:.3}:t.settings.margin={y2:.3}},this),t},u.prototype.transform=function(t){this.addTouchedNodes(this.nodes);var e=this.matchSource(this.getNewTreeNode(this.nodes)).nodes,n=e[0].parent,i=this.getNewTreeNode(this.target);o.Tree.remove_range(e),i.value!==e[0].value&&e.forEach(function(t){return t.invert()});var r=i.get_idx()+("left-of"===this.settings.side?0:1);return i.parent.insert_range(r,e),this.cleanup_cascade(n),"function"==typeof t&&t(this),this},(0,a.default)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FractionMatchExtendAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),s=n(1),a=n(2),l=(i=n(4))&&i.__esModule?i:{default:i},u=n(3),c=n(24),d=e.FractionMatchExtendAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"FractionMatchExtendAction","associative property of multiplication--move into fraction"));if(n.priority=0,n.triggerType="drag",n.settings={delay:1500,on_release:!1,target_group:!0,no_target_box_expansion:!0},t){var i=e.getDestinationHints(t);n.initSettings(o.gmath.extend(t,{drop_area_hint:{side:"around"},destination_hint:i}))}return n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.Action),r(e,[{key:"bindActionForEachTarget",value:function(t,e){var n=this,i=[],r=t[0].get_root();return e.forEach(function(e){i.push(n.createBoundAction(r,{nodes:t,target:e,side:"left-of"})),i.push(n.createBoundAction(r,{nodes:t,target:e,side:"right-of"}))}),i}},{key:"getAllAvailableActions",value:function(t){var e=function(t){if(!t[0].is_group("div")||!s.Tree.is_range(t))return!1;var e=t[0].get_parent(2);return e&&e.is_group("sign")&&(e=e.parent),!!(e&&e.parent&&e.parent.is_group("sum"))&&{nodes:t,addend:e,sum:e.parent}}(t);if(!e)return[];var n=function(t){return t.sum.children.filter(function(e){return e.get_idx()!==t.addend.get_idx()}).map(function(t){return t.children[1].is_group("sign")?t.children[1].children[1]:t.children[1]}).filter(function(e){return!function(t,e){var n=(0,c.bypassNegatives)(t);if(!n.is_group("fraction"))return!1;var i=o.gmath.actions.FactorCommonTermsAction,r=i.getAsciiRangeFromNodes(e);return i.getMatchingTargetRangesFromFraction(n,r,!0).length>0}(e,t.nodes)})}(e);return this.bindActionForEachTarget(t,n,!0)}},{key:"transform",value:function(t){var e=this,n=this.getSourceAndTarget(!0);this.addTouchedNodes(n.source),this.addTouchedNodes(n.target);var i=this.getNewTreeNode(n.source),r=this.getNewTreeNode(n.target),o=i.map(function(t){return new u.MulDiv(t.children[1].clone())}),s=i.map(function(t){return new u.MulDiv(t.children[1].clone(),"div")});n.source.forEach(function(t,n){e.extendNodeMap(t.get_mapping_to(o[n])),e.extendNodeMap(t.get_mapping_to(s[n]))}),this.setNodesToReselectAfterAction(o.concat(s));var a=null;r.is_group("fraction")?a=r:(a=new u.ProductFraction,r.replace_with(a),a.append(new u.MulDiv(r)),this.cleanup(a.children[0]));var l=a.get_top(),c=a.get_bottom();if(1===l.length&&u.Num.is_equal_to(l[0].children[1],1)&&l[0].remove(),1===c.length&&u.Num.is_equal_to(c[0].children[1],1)&&c[0].remove(),"left-of"===this.settings.side?(a.insert_range(0,o),a.insert_range(0,s,!0)):(a.append_range(o),a.append_range(s,!0)),"function"!=typeof t)return!0;t(this)}}],[{key:"getDestinationHints",value:function(t){var e=t.target,n=t.side,i="left-of"===n;if(e.is_group("fraction")){var r=e.get_top(),o=e.get_bottom();return[{node:i?r[0]:r[r.length-1],side:n,margin:{y:.1}},{node:i?o[0]:o[o.length-1],side:n,margin:{y:.1}}]}return[{node:e,side:n,margin:{y:.2}},{node:e,side:"around",margin:{y1:1.1,y2:-.7,x:1}}]}}]),e}();(0,l.default)(d)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FractionDivideToNonInteger=u;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3),l=n(12);function u(t){o.Action.call(this,"FractionDivideToNonInteger","cancel numerator and denominator"),this.priority=-1,this.triggerType="dbltap",t&&(this.settings.only_integer_division=l.MathSettings.get("only_integer_division"),this.actor=t.actor)}r.gmath.inherit(o.Action,u),u.prototype.inContext=function(t){return t in this.settings?this.settings[t]:l.MathSettings.get(t)},u.prototype.match=function(t){if(this.inContext("only_integer_division"))return!1;var e=a.ProductFraction.matchSource(t);if(!e)return!1;if(e.fraction.get_top().length>1)return!1;var n=a.Num.get_value(e.mul.children[1]),i=a.Num.get_value(e.div.children[1]);return!isNaN(n)&&!isNaN(i)&&0!==i&&!(i<=n&&n%i==0||0===n)},u.prototype.transform=function(t){var e=a.ProductFraction.getSourceAndTarget.call(this);this.addTouchedNodes(e.source.parent);var n=this.getNewTreeNode(e.source),i=this.getNewTreeNode(e.target),r=n.parent,o=r.parent,s=a.Num.get_value(i.children[1])/a.Num.get_value(n.children[1]),l=new a.Num(s);i.children[1]instanceof a.Sign||n.children[1]instanceof a.Sign?(this.updateNodeMap(e.target.children[1].get_mapping_to(l)),this.updateNodeMap(e.source.children[1].get_mapping_to(l))):this.updateNodeMap(e.source.parent.get_mapping_to(l));var u=r.remove();if(o.insert(u,l),o.parent&&a.Brackets.handle(o,!0),"function"!=typeof t)return!0;t(this)},(0,s.default)(u,!1,a.ProductFraction,a.MulDiv)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FractionDivideToInteger=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"FractionDivideToInteger","cancel numerator and denominator"),this.priority=1,this.triggerType="tap",t&&(this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.match=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=a.ProductFraction.matchSource(t);if(!n)return!1;if(n.fraction.get_top().length>1)return!1;var i=a.Num.get_value(n.mul.children[1]),r=a.Num.get_value(n.div.children[1]);return!isNaN(i)&&!isNaN(r)&&0!==r&&(!e||r<=i&&i%r==0||0===i)},l.prototype.rematch=function(){return this.match(this.actor,!1)},l.prototype.transform=function(t){var e=a.ProductFraction.getSourceAndTarget.call(this);this.addTouchedNodes(e.source.parent);var n=this.getNewTreeNode(e.source),i=this.getNewTreeNode(e.target),r=n.parent,o=r.parent,s=a.Num.get_value(i.children[1])/a.Num.get_value(n.children[1]),l=new a.Num(s);i.children[1]instanceof a.Sign||n.children[1]instanceof a.Sign?(this.updateNodeMap(e.target.children[1].get_mapping_to(l)),this.updateNodeMap(e.source.children[1].get_mapping_to(l))):this.updateNodeMap(e.source.parent.get_mapping_to(l));var u=r.remove();if(o.insert(u,l),o.parent&&a.Brackets.handle(o,!0),"function"!=typeof t)return!0;t(this)},(0,s.default)(l,!1,a.ProductFraction,a.MulDiv)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DivideRationalNumbersAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"DivideRationalNumbersAction","division of numbers"),this.triggerType="drag",this.priority=2.1,this.settings={delay:400,side:"inside"},t&&(this.nodes=t.nodes,this.target=t.target)}function u(t,e,n){n.updateNodeMap(t,e),n.updateNodeMap(t.children[0],e.children[0]),!t.children[1].is_group("sign")&&e.children[1].is_group("sign")?n.updateNodeMap(t.children[1].get_mapping_to(e.children[1].children[1])):n.updateNodeMap(t.children[1].get_mapping_to(e.children[1]))}r.gmath.inherit(o.Action,l),l.prototype.getAllAvailableActions=function(t){if(1!==t.length)return[];var e=t[0].parent.match("{n: ±\\NUM} / {d: ±\\NUM}");return e&&(this.isRational(e.n)||this.isRational(e.d))?t[0]!==e.d.parent?[]:[this.createBoundAction(t[0].get_root(),{nodes:t,target:e.n.parent})]:[]},l.prototype.isRational=function(t){return a.Num.get_value(t)!==(0|a.Num.get_value(t))},l.prototype.transform=function(t){this.old_dragged_term=this.nodes[0],this.old_target_term=this.target,this.addTouchedNodes(this.old_dragged_term),this.addTouchedNodes(this.old_target_term);var e=this.getNewTreeNode(this.old_dragged_term),n=this.getNewTreeNode(this.old_target_term),i=e.children[1],r=n.children[1],o=e.parent,s=a.Num.get_value(r)/a.Num.get_value(i);n.is_group("div")&&(s=1/s);var l=new a.MulDiv(new a.Num(s),n.value);u(this.old_dragged_term,l,this),u(this.old_target_term,l,this);var c=n.remove();return o.insert(c,l),e.remove(),this.cleanup(o),"function"==typeof t&&t(this),this},(0,s.default)(l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FractionDistributeDenominatorAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(n(0),n(1)),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3),u=e.FractionDistributeDenominatorAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"FractionDistributeDenominatorAction","drag the absolute value bar to the left to produce a negative sign"));return n.priority=1,n.triggerType="drag",n.settings={delay:300,side:"around"},t&&(n.addDestinationHints(t),n.initSettings(t)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.Action),r(e,[{key:"getAllAvailableActions",value:function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n)}},{key:"matchSource",value:function(t){if(t.some(function(t){return!t.is_group("div")})||!o.Tree.is_range(t))return!1;var e=t[0].parent;if(e.get_bottom().length!==t.length)return!1;var n=e.get_top();return!(n.length>1||!n[0].get_child([1]).is_group("brackets")||!n[0].get_child([1,1]).is_group("sum"))&&{nodes:t,fraction:e}}},{key:"getTargets",value:function(t){return t.fraction.get_top()}},{key:"addDestinationHints",value:function(t){var e=t.target.get_child([1,1]);t.destination_hint=e.children.map(function(t){return{node:t.children[1],side:"below",margin:{y1:-.1}}})}},{key:"transform",value:function(t){var e=this,n=this.getSourceAndTarget(!0);this.addTouchedNodes(n.source),this.addTouchedNodes(n.target);var i=this.getNewTreeNode(n.source),r=this.getNewTreeNode(n.target),o=r.parent,s=o.parent,a=o.remove(),u=r.get_child([1,1]);return u.remove(),s.insert(a,u),u.children.forEach(function(t){var r=e.divideTerm(t.children[1],i);n.source.forEach(function(t,n){return e.extendNodeMap(t.get_mapping_to(r[n]))})}),this.cleanup(s),l.Brackets.handle(u),"function"==typeof t&&t(this),this}},{key:"divideTerm",value:function(t,e){var n=t.parent,i=t.remove(),r=new l.ProductFraction;r.append(new l.MulDiv(t));var s=o.Tree.clone(e);return r.append_range(s),n.insert(i,r),this.cleanup(t.parent),s}}]),e}();(0,a.default)(u,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FractionCancelRangeAction=d;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3),u=n(24),c=n(12);function d(t){s.Action.call(this,"FractionCancelRangeAction","cancel a range of terms in a fraction"),this.triggerType="tap",this.priority=-1,this.settings={delay:400,side:"inside",reset_x:!0,reset_y:!0},t&&(this.settings.tap_to_cancel=c.MathSettings.get("tap_to_cancel"),t.nodes?(this.priority=2,this.triggerType="drag",this.nodes=t.nodes,this.target=t.target):this.actor=t.actor)}r.gmath.inherit(s.Action,d),d.prototype.inContext=function(t){return t in this.settings?this.settings[t]:c.MathSettings.get(t)},d.prototype.match=function(t){if(!this.inContext("tap_to_cancel"))return!1;var e=l.ProductFraction.matchSource(t,!1);if(!e)return!1;if(e.numerator.length!==e.denominator.length)return!1;var n={normalizeSynonymsForFunctionLabels:!0};return e.numerator.every(function(t,i){var r=t.children[1],o=e.denominator[i].children[1];return r.to_ascii(n)===o.to_ascii(n)})},d.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n)},d.prototype.getTargetsForHighlighting=function(){return this.target?this.target:[]},d.prototype.matchSource=function(t){if(!o.Tree.is_range(t))return!1;if(!t[0].is_group("mul","div"))return!1;var e=t;if(1===t.length&&(e=this.getBracketedCommGroupNodes(t[0])).length<2)return!1;var n=(0,u.findTopLevelGroupForCanceling)(t);return!!n&&{nodes:t,inner_nodes:e,top_level_group:n}},d.prototype.getTargets=function(t){var e=t.inner_nodes,n=e[0],i=e[e.length-1];return o.Tree.filterRange(function(t){if(!t[0].is_group("mul","div"))return!1;var r=1===t.length?this.getBracketedCommGroupNodes(t[0]):t;return r.some(function(t){return t===n||t===i})?void 0:(0,u.operatorRangesArePermutations)(e,r,!0,!1)||(0,u.operatorRangesArePermutations)(e,r,!1,!0)}.bind(this),t.top_level_group)},d.prototype.containsCommGroupNodes=function(t){return this.getBracketedCommGroupNodes(t).length>0},d.prototype.getBracketedCommGroupNodes=function(t){for(var e=t.children[1];e.is_group("brackets");)e=e.children[1];return e.is_group()&&e.children[0].commutative?e.children:[]},d.prototype.transform=function(t){var e=this.getSourceAndTarget(!0);if(!e.target){var n=e.source[0];e.source=n.get_top(),e.target=n.get_bottom()}this.addTouchedNodes(e.source),this.addTouchedNodes(e.target);var i=this.getNewTreeNode(e.source),r=this.getNewTreeNode(e.target),s=this.matchSource(i),a=1===r.length?this.getBracketedCommGroupNodes(r[0]):r,c=(0,u.operatorRangesArePermutations)(s.inner_nodes,a,!1,!0),d=i[0].parent;if(o.Tree.remove_range(i),o.Tree.remove_range(r),c&&d.append(new l.MulDiv(new l.Num(-1))),d.is_group("fraction")&&d.parent.is_group("mul")&&d.get_parent(2).is_group("product")&&1===d.children.length&&d.parent.remove(),this.setNodesToReselectAfterAction(s.top_level_group),this.cleanStructure(s.top_level_group),"function"!=typeof t)return!0;t(this)},d.prototype.cleanStructure=function(t){var e=!1;t.is_group("product")&&t.children.forEach(function(t){t.children[1].is_group("fraction")&&(e=this.cleanup_cascade(t.children[1]))},this),e||this.cleanup_cascade(t)},(0,a.default)(d,!0,l.ProductFraction)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FractionCancelTermsAction=h;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3),u=n(58),c=n(24),d=n(12);function h(t){s.Action.call(this,"FractionCancelTermsAction","cancel numbers in a fraction"),this.triggerType="tap",this.priority=0,this.settings={delay:400,side:"inside",reset_x:!0,reset_y:!0,prev_branch:null},t&&(this.initSettings(t),this.settings.tap_to_cancel=d.MathSettings.get("tap_to_cancel"),this.settings.cancel_common_terms_after_finding_gcf=d.MathSettings.get("cancel_common_terms_after_finding_gcf"),"drag"===this.triggerType&&(this.priority=2,this.drop_area_hint.node=this.target.children[1]))}r.gmath.inherit(s.Action,h);var p={normalizeSynonymsForFunctionLabels:!0};h.prototype.inContext=function(t){return t in this.settings?this.settings[t]:d.MathSettings.get(t)},h.prototype.getAllAvailableActions=function(t){return h.getAllAvailableActions.call(this,t)},h.getAllAvailableActions=function(t){if(1!==t.length)return[];if(!t.every(function(t){return t.is_group("mul","div")}))return[];var e=(0,c.findTopLevelGroupForCanceling)(t);if(!e)return[];var n=h.findOtherContendersInStructure(t,e);if(0===n.length)return[];n=n.filter(function(e){return!!this.getBoundTransformation(t[0],e,!0)},this);var i=t[0].get_root();return n.map(function(e){return this.createBoundAction(i,{nodes:t,target:e})},this)},h.prototype.getTargetsForHighlighting=function(){return this.target?[this.target]:[]},h.findOtherContendersInStructure=function(t,e){var n=t[0].is_group("mul")?"div":"mul";return e.filter(function(i){return i.is_group(n)&&(i.parent===e||i.parent.parent.parent===e)&&!(0,c.nodeIsAncestorOfNodes)(i,t)})},h.prototype.match=function(t){return h.match.call(this,t)},h.match=function(t){if(!this.inContext("tap_to_cancel"))return!1;var e=l.ProductFraction.matchSource(t);return!!e&&!!this.getBoundTransformation(e.mul,e.div,!0)},h.prototype.transform=function(t){h.transform.call(this,t)},h.transform=function(t){var e=l.ProductFraction.getSourceAndTarget.call(this);this.oldSourceOp=e.source,this.addTouchedNodes(e.source),this.addTouchedNodes(e.target);var n=this.getNewTreeNode(e.source),i=this.getNewTreeNode(e.target),r=(0,c.findTopLevelGroupForCanceling)([n]);if(h.performCancel.call(this,n,i),h.cleanStructure.call(this,r),"function"!=typeof t)return!0;t(this)},h.performCancel=function(t,e){var n=this.getBoundTransformation(t,e,!1);if(!n)throw"Failed to find canceling transformation in transform function.";n()},h.cleanStructure=function(t){var e=!1,n=[];t.is_group("product")&&t.children.forEach(function(t){t.children[1].is_group("fraction")&&(n.push(t),e=this.cleanup_cascade(t.children[1]))},this),e||this.cleanup_cascade(t),n.forEach(function(t){t.simplify=!0})},h.prototype.getBoundTransformation=function(t,e,n){var i=this,r=t.is_group("mul")?t:e,o=e.is_group("div")?e:t,s=l.Num.is_num(r.children[1]),a=l.Num.is_num(o.children[1]),u=s&&!this.numberContainsDecimalTerm(r.children[1]),d=a&&!this.numberContainsDecimalTerm(o.children[1]);if(a&&(0===l.Num.get_value(o.children[1])||-0===l.Num.get_value(o.children[1])))return!1;if(this.settings.prev_branch)if("rem-both"===this.settings.prev_branch){if(l.Num.is_num(r.children[1])&&l.Num.is_num(o.children[1]))return function(){i.removeBoth(r,o)}}else if("rem-div"===this.settings.prev_branch){if(l.Num.is_num(o.children[1]))return function(){i.removeDiv(r,o)}}else{if("split-both"===this.settings.prev_branch)return function(){1!==(0,c.getGCF)(l.Num.get_value(r.children[1]),l.Num.get_value(o.children[1]))?i.factorizeTerms(r,o,!0):i.splitBoth(r,o)};if("split-mul"===this.settings.prev_branch)return function(){(0,c.numbersAreMultiples)(r.get_child([1]),o.get_child([1]),!0)?i.factorizeTerms(r,o):i.splitMul(r,o)};if("split-div"===this.settings.prev_branch)return function(){(0,c.numbersAreMultiples)(r.get_child([1]),o.get_child([1]),!0)?i.factorizeTerms(r,o):i.splitDiv(r,o)}}return r.children[1].to_ascii(p)===o.children[1].to_ascii(p)?(n||this.settings.prev_branch||(this.settings.prev_branch="rem-both"),function(){i.cancelTerms(r,o)}):d&&1===l.Num.get_value(o.children[1])?(n||this.settings.prev_branch||(this.settings.prev_branch="rem-div"),function(){i.removeDiv(r,o)}):d&&-1===l.Num.get_value(o.children[1])?(n||this.settings.prev_branch||(this.settings.prev_branch="rem-div"),function(){i.applyNegativeToMulNum(r,o)}):this.termIsNegativeXOfX(r.children[1],o.children[1])?(n||this.settings.prev_branch||(this.settings.prev_branch="rem-both"),function(){i.cancelTermsAndReplaceMulDiv1NumWithNegativeOne(r,o)}):this.termIsNegativeXOfX(o.children[1],r.children[1])?(n||this.settings.prev_branch||(this.settings.prev_branch="rem-both"),function(){i.cancelTermsAndReplaceMulDiv1NumWithNegativeOne(o,r)}):u&&d&&(0,c.numbersAreMultiples)(r.get_child([1]),o.get_child([1]))?function(){i.factorizeTerms(r,o)}:!!this.bothTermsAreNegative(r,o)&&(n||this.settings.prev_branch||(this.settings.prev_branch="split-both"),function(){i.extractSigns(r,o)})},h.prototype.removeBoth=function(t,e){var n=l.Num.get_value(t.children[1])/l.Num.get_value(e.children[1]),i=t.parent;t.remove(),e.remove(),1!==n&&(0,u.applyCoefficient)(i,n)},h.prototype.removeDiv=function(t,e){var n=1/l.Num.get_value(e.children[1]),i=t.parent;e.remove(),1!==n&&(0,u.applyCoefficient)(i,n)},h.prototype.splitBoth=function(t,e){this.splitMul(t,e),this.splitDiv(t,e)},h.prototype.splitMul=function(t,e){var n=t.parent;t.children[1].is_group("sign")?(n.insert(t.get_idx()+1,new l.MulDiv(new l.Num(-1))),t.children[1].replace_with(t.children[1].children[1])):n.insert(t.get_idx()+1,new l.MulDiv(new l.Num(1)))},h.prototype.splitDiv=function(t,e){var n=e.parent;e.children[1].is_group("sign")?(n.insert(e.get_idx()+1,new l.MulDiv(new l.Num(-1),"div")),e.children[1].replace_with(e.children[1].children[1])):n.insert(e.get_idx()+1,new l.MulDiv(new l.Num(1),"div"))},h.prototype.cancelTerms=function(t,e){this.setNodesToReselectAfterAction(t.parent),t.remove(),e.remove()},h.prototype.applyNegativeToMulNum=function(t,e){if(this.updateNodeMap(this.getOldTreeNode(e),t),t.children[1].is_group("sign"))t.children[1].replace_with(t.children[1].children[1]);else{var n=e.children[1];n.remove(),n.children[1].remove();var i=t.children[1];i.remove(),t.append(n),n.append(i)}e.remove()},h.prototype.termIsNegativeXOfX=function(t,e){return t.is_group("sign")&&t.children[1].to_ascii(p)===e.to_ascii(p)},h.prototype.cancelTermsAndReplaceMulDiv1NumWithNegativeOne=function(t,e){var n=t.children[1].children[1],i=e.children[1],r=new l.Num(1);this.updateNodeMap(this.getOldTreeNode(e),t),this.updateNodeMap(this.getOldTreeNode(i).get_mapping_to(r)),this.updateNodeMap(this.getOldTreeNode(n).get_mapping_to(r)),n.replace_with(r),e.remove()},h.prototype.factorizeTerms=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t.get_root(),!l.Num.is_num(t.children[1])||!l.Num.is_num(e.children[1]))return!1;var i=l.Num.get_value(t.children[1]),o=l.Num.get_value(e.children[1]),s=this.getOldTreeNode(t),a=this.getOldTreeNode(e),u=this.relativePositionOfMulWithRespectToDiv(t,e);if((0,c.val1IsAMultipleOfVal2)(i,o)&&!n){this.settings.prev_branch||(this.settings.prev_branch="split-mul");var d="left"===u?this.splitIntoFactors(t,s,Math.floor(i/o),o)[1]:this.splitIntoFactors(t,s,o,Math.floor(i/o))[0];this.oldSourceOp.is_group("mul")&&this.setNodesToReselectAfterAction(d),this.settings.cancel_common_terms_after_finding_gcf&&(this.oldSourceOp.is_group("mul")?this.followup=r.gmath.actions.FractionCancelTermsAction.createBoundAction(this.newTree,{nodes:[d],target:e}):this.followup=r.gmath.actions.FractionCancelTermsAction.createBoundAction(this.newTree,{nodes:[e],target:d}))}else if((0,c.val1IsAMultipleOfVal2)(o,i)&&!n)this.settings.prev_branch||(this.settings.prev_branch="split-div"),d="left"===u?this.splitIntoFactors(e,a,i,Math.floor(o/i))[0]:this.splitIntoFactors(e,a,Math.floor(o/i),i)[1],this.oldSourceOp.is_group("div")&&this.setNodesToReselectAfterAction(d),this.settings.cancel_common_terms_after_finding_gcf&&(this.oldSourceOp.is_group("div")?this.followup=r.gmath.actions.FractionCancelTermsAction.createBoundAction(this.newTree,{nodes:[d],target:t}):this.followup=r.gmath.actions.FractionCancelTermsAction.createBoundAction(this.newTree,{nodes:[t],target:d}));else{this.settings.prev_branch||(this.settings.prev_branch="split-both");var h,p,f,g=(0,c.getGCF)(i,o);switch(u){case"left":h=this.splitIntoFactors(t,s,Math.floor(i/g),g)[1],p=this.splitIntoFactors(e,a,g,Math.floor(o/g))[0];break;case"same":h=this.splitIntoFactors(t,s,Math.floor(i/g),g)[1],p=this.splitIntoFactors(e,a,Math.floor(o/g),g)[1];break;case"right":h=this.splitIntoFactors(t,s,g,Math.floor(i/g))[0],p=this.splitIntoFactors(e,a,Math.floor(o/g),g)[1]}f=this.target&&this.target.is_group("mul")?p:this.actor&&this.actor.is_group("div")?p:h,this.setNodesToReselectAfterAction(f),this.settings.cancel_common_terms_after_finding_gcf&&(this.followup=r.gmath.actions.FractionCancelTermsAction.createBoundAction(this.newTree,{nodes:[p],target:h}))}},h.prototype.relativePositionOfMulWithRespectToDiv=function(t,e){if(t.parent===e.parent){var n=t.parent.get_top(),i=t.parent.get_bottom();return this.positionComparison(n.indexOf(t),i.indexOf(e))}var r,o;r=t.parent.is_group("product")?t:t.parent.parent,o=e.parent.parent;var s=r.parent;return this.positionComparison(s.children.indexOf(r),s.children.indexOf(o))},h.prototype.positionComparison=function(t,e){var n=t-e;return n<0?"left":0===n?"same":"right"},h.prototype.splitIntoFactors=function(t,e,n,i){var r=new l.MulDiv(isNaN(n)?o.Tree.clone(t.children[1].children[1]):new l.Num(n),t.value),s=new l.MulDiv(isNaN(i)?o.Tree.clone(t.children[1].children[1]):new l.Num(i),t.value);this.updateNodeMap(e.get_mapping_to(r)),this.extendNodeMap(e.get_mapping_to(s));var a=t.parent,u=t.remove();return a.insert(u,s),a.insert(u,r),[r,s]},h.prototype.bothTermsAreNegative=function(t,e){return t.children[1].is_group("sign")&&e.children[1].is_group("sign")},h.prototype.extractSigns=function(t,e){var n=t.get_root(),i=this.getOldTreeNode(t),o=this.getOldTreeNode(e),s=this.splitIntoFactors(t,i,n.numeric_value(t.children[1])/-1,-1)[1],a=this.splitIntoFactors(e,o,n.numeric_value(e.children[1])/-1,-1)[1];this.oldSourceOp.is_group("mul")?this.setNodesToReselectAfterAction(s):this.setNodesToReselectAfterAction(a),this.settings.cancel_common_terms_after_finding_gcf&&(this.followup=r.gmath.actions.FractionCancelTermsAction.createBoundAction(this.newTree,{nodes:[s],target:a}))},h.prototype.numberContainsDecimalTerm=function(t){return l.Num.get_value(t)!==Math.floor(l.Num.get_value(t))},(0,a.default)(h,!0,l.ProductFraction,l.MulDiv)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FractionCancelPowersAction=u;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3),l=n(12);function u(t){o.Action.call(this,"FractionCancelPowersAction","cancel powers in a fraction"),this.triggerType="tap",this.priority=0,this.settings={delay:400,side:"inside",reset_x:!0,reset_y:!0},t&&(this.settings.cancel_powers=l.MathSettings.get("cancel_powers"),this.settings.simplify_sum_after_canceling_powers=l.MathSettings.get("simplify_sum_after_canceling_powers"),t.nodes?(this.priority=2,this.triggerType="drag",this.nodes=t.nodes,this.target=t.target):this.actor=t.actor)}r.gmath.inherit(o.Action,u),u.prototype.inContext=function(t){return t in this.settings?this.settings[t]:l.MathSettings.get(t)},u.prototype.getAllAvailableActions=function(t){return this.inContext("cancel_powers")?r.gmath.actions.FractionCancelTermsAction.getAllAvailableActions.call(this,t):[]},u.prototype.getTargetsForHighlighting=function(){return this.target?[this.target]:[]},u.prototype.match=function(t){return!!this.inContext("cancel_powers")&&r.gmath.actions.FractionCancelTermsAction.match.call(this,t)},u.prototype.transform=function(t){r.gmath.actions.FractionCancelTermsAction.transform.call(this,t)},u.prototype.getBoundTransformation=function(t,e){var n=this,i=t.is_group("mul")?t:e,r=e.is_group("div")?e:t,o=i.get_child([1]),s=r.get_child([1]);return!(!o.is_group("power")&&!s.is_group("power"))&&(a.Power.haveSameBase(o,s)?function(){n.factorizePowers(i,r)}:void 0)},u.prototype.factorizePowers=function(t,e){var n=this.oldSourceOp.is_group("mul")?t:e,i=this.oldSourceOp.is_group("mul")?e:t,r=n.children[1],o=i.children[1],s=this.getOldTreeNode(n),a=this.getOldBase(r),l=(this.getOldExponentTermFromPower(o),this.getOldExponentTermFromPower(r));this.sourceIsLeftOfTarget(n,i),r.is_group("power")||(r=this.reinterpretTermAsPower(r)),o.is_group("power")||(o=this.reinterpretTermAsPower(o));var u=r.get_child([1,0]),c=o.get_child([1,0]);u.is_group("brackets")&&(u=u.children[1]),c.is_group("brackets")&&(c=c.children[1]),n.remove(),this.convertTargetExponentIntoSum(c,l,u),this.updateNodeMap(s,i),this.updateNodeMap(a.get_mapping_to(o.get_child([0]))),this.setNodesToReselectAfterAction(i)},u.prototype.sourceIsLeftOfTarget=function(t,e){if(t.parent===e.parent)return!0;var n,i;n=t.parent.is_group("product")?t:t.parent.parent,i=e.parent.is_group("product")?e:e.parent.parent;var r=n.parent;return r.children.indexOf(n)<=r.children.indexOf(i)},u.prototype.getOldBase=function(t){return t.is_group("power")?this.getOldTreeNode(t.get_child([0])):this.getOldTreeNode(t)},u.prototype.getOldExponentTermFromPower=function(t){if(!t.is_group("power"))return null;var e=this.getOldTreeNode(t).get_child([1,0]);return e.is_group("brackets")&&(e=e.get_child([1])),e},u.prototype.reinterpretTermAsPower=function(t){var e=t.parent,n=t.remove(),i=a.Exponent.prototype.createParentGroup();return i.append(t),i.append(new a.Exponent(new a.Num(1))),this.updateNodeMap(t,i),e.insert(n,i),i},u.prototype.convertTargetExponentIntoSum=function(t,e,n){var i=t.parent,o=t.remove(),s=a.AddSub.prototype.createParentGroup();if(i.insert(o,s),s.append(new a.AddSub(t)),s.append(new a.AddSub(n,"sub")),e&&e.is_group("sum"))for(var l=0;l<e.children.length;l++)this.extendNodeMap(e.children[e.children.length-l-1].get_mapping_to(s.children[s.children.length-l-1]));else e&&this.extendNodeMap(e.get_mapping_to(s.children[s.children.length-1].children[1]));this.applyInnerAction("AddSubCombineSigns",{actor:s.children[0]}),this.applyInnerAction("AddSubCombineSigns",{actor:s.children[1]}),this.cleanup(s.get_child([1])),this.cleanup(s.get_child([0])),a.Brackets.handle(s),this.settings.simplify_sum_after_canceling_powers&&2===s.children.length&&r.gmath.actions.AddSubNumbersAction.getAllAvailableActions([s.children[1]]).length>0&&(this.followup=r.gmath.actions.AddSubNumbersAction.createBoundAction(this.newTree,{nodes:[s.children[1]],target:s.children[0]})),i.is_group("exponent")&&(i.simplify=!0)},(0,s.default)(u,!0,a.ProductFraction,a.MulDiv)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FractionAbsorbTermAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"FractionAbsorbTermAction","associative property of multiplication--move into fraction"),this.priority=0,this.triggerType="drag",this.settings={delay:250,side:"around"},t&&(this.nodes=t.nodes,this.target=t.target)}r.gmath.inherit(o.Action,l),l.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n)},l.prototype.matchSource=function(t){return 1===t.length&&t[0].is_group("mul","div")&&t[0].children[1].is_group("fraction")&&{nodes:t,group:t[0].parent,fraction:t[0].children[1]}},l.prototype.getTargets=function(t){return(t.nodes[0].is_group("mul")?t.group.get_top():t.group.get_bottom()).filter(function(e){return!e.children[1].is_group("fraction")&&t.nodes[0]!==e},this)},l.prototype.transform=function(t){this.addTouchedNodes(this.nodes),this.addTouchedNodes(this.target);var e=this.getNewTreeNode(this.nodes[0]),n=this.getNewTreeNode(this.target),i=n.get_idx()<e.get_idx(),r=e.children[1];n.remove(),n.is_group("div")&&n.invert();var o=r.get_top();if(1===o.length&&a.Num.is_equal_to(o[0].children[1],1)&&(o[0].simplify=!0),r.insert(i?0:r.get_top().length,n),this.cleanup_cascade(e.parent),"function"!=typeof t)return!0;t(this)},(0,s.default)(l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FlipTermAction=c;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3),u=n(12);function c(t){s.Action.call(this,"FlipTermAction","flip a term into a denominator"),this.priority=0,this.triggerType="drag",this.settings={delay:1500,on_release:!0,side:"below",reset_y:!0,margin:{y1:.1,y2:-.25}},t&&(this.settings.allow_term_flipping=u.MathSettings.get("allow_term_flipping"),this.settings.flip_powers_only=u.MathSettings.get("flip_powers_only"),this.nodes=t.nodes,this.target=t.target)}r.gmath.inherit(s.Action,c),c.prototype.inContext=function(t){return t in this.settings?this.settings[t]:u.MathSettings.get(t)},c.prototype.getAllAvailableActions=function(t){return this.matchSource(t)?this.bindActionForEachTarget(t,t):[]},c.prototype.matchSource=function(t){if(!this.inContext("allow_term_flipping"))return!1;if(1!==t.length)return!1;var e=t[0];return e.is_group("exponent","degree")?e=e.get_term():e.is_group("mul","div","add","sub")&&(e=e.children[1]),!e.is_group("param")&&!l.Inequality.is_relation(e)&&(!this.inContext("flip_powers_only")||e.is_group("power"))},c.prototype.transform=function(t){this.addTouchedNodes(this.nodes);var e=this.getNewTreeNode(this.target);e.is_group("exponent","degree")&&(e=e.get_term()),e.is_group("mul","div","add","sub")&&(e=e.children[1]);var n=this.getTransformFunction(e);return this.replaceWithFlippedFraction(e,n.bind(this)),"function"==typeof t&&t(this),this},c.prototype.getTransformFunction=function(t){return t.is_group("power")?this.flipPower:t.is_group("radical")?this.flipRadical:t.is_group("fraction")?this.flipFraction:l.Num.is_equal_to(t,1,-1)?this.flipIdentity:t.is_group("plusminus")&&1===l.Num.get_value(t,!0)?this.flipIdentity:this.flipTerm},c.prototype.replaceWithFlippedFraction=function(t,e){var n=t.get_parent(1),i=t.remove(),r=new l.ProductFraction;r.append(new l.MulDiv(new l.Num(1)));var o=e(t),s=new l.MulDiv(o,"div");r.append(s),this.setNodesToReselectAfterAction(s),n.insert(i,r),this.cleanup(s.children[1]),l.Brackets.handle(r)},c.prototype.flipIdentity=function(t){return t},c.prototype.flipPower=function(t){return this.flipExponent(t.get_child([1])),t},c.prototype.flipRadical=function(t){return this.flipExponent(t.get_degree()),t},c.prototype.flipExponent=function(t){var e=t.get_child([0]);l.Brackets.areHidden(e)&&(e=e.children[1]),e.is_group("product")&&(e=e.get_child([0,1])),this.makeTermNegative(e),l.Brackets.handle(t.children[0],!0),l.Num.is_equal_to(t.get_term(),1)&&t.remove()},c.prototype.makeTermNegative=function(t){if(t.is_group("sum"))t.children.forEach(function(t){t.invert()});else if(t.is_group("sign"))t.replace_with(t.get_child([1]));else{var e=t.get_parent(1),n=t.remove(),i=new l.Sign(t);e.insert(n,i)}},c.prototype.flipFraction=function(t){var e=t.get_top(),n=t.get_bottom();return o.Tree.remove_range(e),o.Tree.remove_range(n),n.forEach(function(e){e.invert(),t.append(e)}),e.forEach(function(e){e.invert(),t.append(e)}),t},c.prototype.flipTerm=function(t){var e=this.convertToEquivalentPowerForm(t);return this.flipPower(e)},c.prototype.convertToEquivalentPowerForm=function(t){return new l.Power(t,new l.Num(1))},(0,a.default)(c)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FlipTermAcrossFractionAction=c;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3),u=n(12);function c(t){s.Action.call(this,"FlipTermAcrossFractionAction","flip a term into a denominator"),this.priority=1,this.triggerType="drag",this.settings={delay:1500,reset_y:!0,target_group:!0,group_side:"around",no_target_box_expansion:!0},t&&(this.settings.allow_term_flipping=u.MathSettings.get("allow_term_flipping"),this.nodes=t.nodes,this.target=t.target,this.settings.side=t.side)}r.gmath.inherit(s.Action,c),c.prototype.inContext=function(t){return t in this.settings?this.settings[t]:u.MathSettings.get(t)},c.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.adjustTargetBoxes(this.bindActionForEachTarget(t,n,!0))},c.prototype.matchSource=function(t){if(!this.inContext("allow_term_flipping"))return!1;if(!o.Tree.is_range(t))return!1;var e=t[0];if(!e.is_group("mul","div")||!e.parent.is_group("fraction"))return!1;var n=e.children[1];return!(1===l.Num.get_value(n)&&e.is_group("mul")&&!e.ls&&e.rs&&"//"===e.rs.value)&&{nodes:t,frac:t[0].parent}},c.prototype.getTargets=function(t){return t.nodes[0].is_group("mul")?t.frac.get_bottom():t.frac.get_top()},c.prototype.adjustTargetBoxes=function(t){return t.forEach(function(t){t.target.is_group("div")?t.settings.margin={y1:.3}:t.settings.margin={y2:.3}},this),t},c.prototype.transform=function(t){this.addTouchedNodes(this.nodes);var e=this.getNewTreeNode(this.nodes),n=this.getNewTreeNode(this.target),i=e[0].get_parent(1);if(o.Tree.remove_range(e),e[0].is_group("div")){var s=i.get_top();1===s.length&&1===l.Num.get_value(s[0].get_child([1]))&&s[0].remove()}e.forEach(function(t){var e=t.get_child([1]),n=r.gmath.actions.FlipTermAction.getTransformFunction(e).bind(r.gmath.actions.FlipTermAction);e.remove(),e=n(e),t.append(e),t.invert()},this);var a=-1===n.get_idx()?0:n.get_idx()+("right-of"===this.settings.side?1:0);i.insert_range(a,e);var u=!1;return e.forEach(function(t){u=u||this.cleanup_cascade(t.children[1])},this),u||this.cleanup_cascade(i),"function"==typeof t&&t(this),this},(0,a.default)(c)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GreatestCommonFactorAction=c;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3),l=n(24),u=n(12);function c(t){o.Action.call(this,"GreatestCommonFactorAction","find the greatest common factor between two terms"),this.priority=0,this.triggerType="drag",this.settings={delay:1e3,side:"inside",reset_x:!0,reset_y:!0},t&&(this.nodes=t.nodes,this.target=t.target,this.settings.factor_after_finding_gcf=u.MathSettings.get("factor_after_finding_gcf"))}r.gmath.inherit(o.Action,c),c.prototype.getAllAvailableActions=function(t){var e,n,i,r=t[0];if(1!==t.length)return[];if(!r.is_group("add","sub","mul","div"))return[];if(r.is_group("add","sub"))e=r.get_parent(1),n=r.get_idx(),i=!1;else{var o=(0,l.factorableMulDiv)(r);if(!o)return[];e=o.ancestor_sum,n=o.addsub_idx,i=r.is_group("div")}var s=[];e.children.forEach(function(t,e){e!==n&&(s=s.concat(this.getPotentialTargets(t,i)))},this);var a=[];return s.forEach(function(t){this.matchTarget(r,t)&&a.push(t)},this),this.bindActionForEachTarget(t,a)},c.prototype.getPotentialTargets=function(t,e,n){var i=[],r=t.get_child([1]);return r.is_group("product")&&!n?r.children.forEach(function(t){i=i.concat(this.getPotentialTargets(t,e))},this):r.is_group("fraction")&&!n?(e?r.get_bottom():r.get_top()).forEach(function(t){i=i.concat(this.getPotentialTargets(t,e,!0))},this):!n&&e||i.push(t),i},c.prototype.matchTarget=function(t,e){var n=t.get_child([1]),i=e.get_child([1]),r=n.is_group("sign"),o=i.is_group("sign");return r&&(n=n.get_child([1])),o&&(i=i.get_child([1])),!(n.to_ascii()===i.to_ascii()||!this.matchNumberMultiples(n,i)&&!this.matchPowers(n,i)&&!(r&&o&&this.matchUnidenticalInnerTerms(n,i)))},c.prototype.matchNumberMultiples=function(t,e){return!!(a.Num.is_num(t)&&a.Num.is_num(e)&&a.Num.get_value(t)&&a.Num.get_value(e)&&Math.abs(a.Num.get_value(t))!==Math.abs(a.Num.get_value(e))&&(0,l.numbersAreMultiples)(t,e))},c.prototype.matchPowers=function(t,e){return!(!t.is_group("power")&&!e.is_group("power")||!a.Power.haveSameBase(t,e))},c.prototype.matchUnidenticalInnerTerms=function(t,e){return(0,l.bypassNegatives)(t).to_ascii()!==(0,l.bypassNegatives)(e).to_ascii()},c.prototype.transform=function(t){this.addTouchedNodes(this.nodes),this.addTouchedNodes(this.target);for(var e=this.nodes[0],n=this.target,i=this.getNewTreeNode(e),o=this.getNewTreeNode(n),s=i;!s.parent.is_group("sum");)s=s.parent;for(var u=o;!u.parent.is_group("sum");)u=u.parent;var c,d=s.get_idx()>u.get_idx(),h=i.get_child([1]),p=o.get_child([1]),f=h.is_group("sign"),g=p.is_group("sign");if(f&&(h=h.get_child([1])),g&&(p=p.get_child([1])),a.Num.is_num(h)&&a.Num.is_num(p)&&(0,l.numbersAreMultiples)(h,p))c=this.factorizeNumbers(e,i,n,o,d);else if(this.matchPowers(h,p))c=this.factorizePowers(e,i,n,o,d);else{if(!f||!g)throw"(GreatestCommonFactorAction) There is a case mis-match between the match and transform functions.";c={matching_nodes_factor:this.splitNegativeFromNode(e,i,d),matching_target_factor:this.splitNegativeFromNode(n,o,d)},this.setNodesToReselectAfterAction(c.matching_nodes_factor)}if(this.settings.factor_after_finding_gcf&&(this.followup=r.gmath.actions.FactorCommonTermsAction.createBoundAction(this.newTree,{nodes:[c.matching_nodes_factor],target:[c.matching_target_factor]})),"function"!=typeof t)return!0;t(this)},c.prototype.splitNegativeFromNode=function(t,e,n){var i=t.get_child([1]),r=e.get_child([1]);if(!r.is_group("sign"))throw"Expected term to be 'sign', but was "+r.to_ascii();var o=(r=r.replace_with(r.children[1])).remove(),s=new a.ProductFraction,l=new a.Sign(new a.Num(1)),u=new a.MulDiv(l),c=new a.MulDiv(r);return s.append(c),s.insert(n?0:1,u),e.insert(o,s),this.extendNodeMap(i.children[1].get_mapping_to(r)),this.cleanup_cascade(e),u},c.prototype.factorizeNumbers=function(t,e,n,i,r){var o,s=e.get_child([1]),u=i.get_child([1]),c=a.Num.get_value(s),d=a.Num.get_value(u);if((0,l.val1IsAMultipleOfVal2)(c,d)){var h=c/d,p=d,f=this.splitIntoFactors(t.get_child([1]),s,h,p,r).factor2.parent;this.setNodesToReselectAfterAction(f),o=i}else if((0,l.val1IsAMultipleOfVal2)(d,c))h=d/c,p=c,f=e,o=this.splitIntoFactors(n.get_child([1]),u,h,p,r).factor2.parent;else{var g=(0,l.getGCF)(c,d);f=this.splitIntoFactors(t.get_child([1]),s,g,c/g,r).factor1.parent,o=this.splitIntoFactors(n.get_child([1]),u,g,d/g,r).factor1.parent,this.setNodesToReselectAfterAction(f)}return{matching_nodes_factor:f,matching_target_factor:o}},c.prototype.splitIntoFactors=function(t,e,n,i,r){var o=e.parent,s=e.remove(),l=new a.ProductFraction,u=new a.Num(n),c=new a.Num(i),d=new a.MulDiv(u),h=new a.MulDiv(c);return l.append(h),l.insert(r?0:1,d),o.insert(s,l),this.mapNumber(t,u),this.mapNumber(t,c,!0),this.cleanup_cascade(o),{factor1:u,factor2:c}},c.prototype.mapNumber=function(t,e,n){var i=n?this.extendNodeMap.bind(this):this.updateNodeMap.bind(this);!t.is_group("sign")&&e.is_group("sign")?i(t,e.get_child([1])):t.is_group("sign")&&!e.is_group("sign")?i(t.get_child([1]),e):i(t.get_mapping_to(e))},c.prototype.factorizePowers=function(t,e,n,i,r){var o=e.children[1],s=t.children[1],l=i.children[1],u=n.children[1];o.is_group("sign")&&(o=o.children[1],s=s.children[1]),l.is_group("sign")&&(l=l.children[1],u=u.children[1]);var c,d=a.Power.getNumericalValueOfExponent(o),h=a.Power.getNumericalValueOfExponent(l);if(o.is_group("power"))if(l.is_group("power"))d>h?(c=i,p=this.splitPower(s,o,u,l,r),this.setNodesToReselectAfterAction(p)):(p=e,c=this.splitPower(u,l,s,o,r));else{c=i;var p=this.splitOffBase(s,o,r);this.setNodesToReselectAfterAction(p)}else c=this.splitOffBase(u,l,r),p=e;return{matching_nodes_factor:p,matching_target_factor:c}},c.prototype.splitOffBase=function(t,e,n){var i=e.parent.is_group("sign")?e.parent:null;i&&i.replace_with(e);var r=new a.ProductFraction;e.replace_with(r);var o=new a.MulDiv(e.children[0].clone());this.extendNodeMap(t.children[0].get_mapping_to(o.children[1])),r.append(new a.MulDiv(e)),r.insert(n?0:1,o);var s=e.get_exponent_term();if(!s.is_group("sum")){var l=s.parent,u=s.remove(),c=new a.Sum;c.append(new a.AddSub(s)),l.insert(u,c),a.Brackets.handle(c),s=c}var d=new a.AddSub(new a.Num(1),"sub");if(s.append(d),this.applyInnerAction("AddSubNumbersAction",{actor:d})){var h=s.children[s.children.length-1];0===a.Num.get_value(h)&&(h.remove(),this.cleanup(s))}else this.applyInnerAction("AddSubCombineSigns",{actor:d.ls});return 1===e.get_exponent_value()&&(e=e.replace_with(e.children[0])),i&&(e.replace_with(i),i.append(e)),this.cleanup(r.parent),o},c.prototype.splitPower=function(t,e,n,i,r){var o=e.parent.is_group("sign")?e.parent:null;o&&o.replace_with(e);var s=new a.ProductFraction;e.replace_with(s);var l=new a.MulDiv(i.clone());this.extendNodeMap(t.children[0].get_mapping_to(l.children[1].children[0])),this.extendNodeMap(n.children[1].get_mapping_to(l.children[1].children[1])),s.append(new a.MulDiv(e)),s.insert(r?0:1,l);var u=e.get_exponent_term();if(!u.is_group("sum")){var c=u.parent,d=u.remove(),h=new a.Sum;h.append(new a.AddSub(u)),c.insert(d,h),a.Brackets.handle(h),u=h}var p=i.get_exponent_term(),f=new a.AddSub(p.clone(),"sub");return this.extendNodeMap(n.get_exponent_term().get_mapping_to(f.children[1])),u.append(f),this.cleanup(f),2===u.children.length&&this.applyInnerAction("AddSubNumbersAction",{actor:f})?this.extendNodeMap(t.children[1].get_mapping_to(l.children[1].children[1])):(this.applyInnerAction("AddSubCombineSigns",{actor:f.ls}),this.applyInnerAction("AddSubCombineSigns",{actor:f})),1===e.get_exponent_value()&&(e=e.replace_with(e.children[0])),o&&(e.replace_with(o),o.append(e)),this.cleanup(s.parent),l},(0,s.default)(c)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FactorCommonTermsAction=h;var i,r=n(0),o=n(1),s=n(2),a=n(5),l=(i=n(4))&&i.__esModule?i:{default:i},u=n(3),c=n(58),d=n(24);function h(t){s.Action.call(this,"FactorCommonTermsAction","factor out matching term ranges"),this.priority=0,this.triggerType="drag",this.settings={delay:600,side:"inside",reset_x:!0,reset_y:!0},this.initSettings(t)}r.gmath.inherit(s.Action,h),h.prototype.getAllAvailableActions=function(t){if(t[0].is_group("add","sub","addsub")&&1!==t.length)return[];if(t[0].is_group("mul","div")&&!o.Tree.is_range(t))return[];var e,n,i;if(t[0].is_group("add","sub","addsub"))e=t[0].get_parent(1),n=t[0].get_idx(),i=!1;else{var r=(0,d.factorableMulDiv)(t[0]);if(!r)return[];e=r.ancestor_sum,n=r.addsub_idx,i=t[0].is_group("div")}var s=this.getAsciiRangeFromNodes(t),a=[];return e.children.forEach(function(t,e){e!==n&&(a=a.concat(this.getMatchingTargetRanges(t,s,i)))},this),this.bindActionForEachRange(t,a)},h.prototype.rematch=function(){var t=this;return!(!this.nodes||!this.target)&&(!!this.getAllAvailableActions(this.nodes).some(function(e){return r.gmath.array.equals(e.target,t.target)})||this.nodes.length>0&&this.target.length>0&&1===this.nodes.length&&u.Num.is_num(this.nodes[0].children[1]))},h.prototype.getAsciiRangeFromNodes=function(t){var e=[];if(1===t.length&&t[0].is_group("add","sub","addsub")){for(var n=t[0].get_child([1]);n.is_group("sign");)n=n.get_child([1]);n.is_group("product")?n.children.forEach(function(t){e.push((0,d.bypassNegatives)(t.get_child([1])).to_ascii())},this):e.push(n.to_ascii())}else t.forEach(function(t){e.push((0,d.bypassNegatives)(t.get_child([1])).to_ascii())},this);return e},h.prototype.getMatchingTargetRanges=function(t,e,n){var i=[],r=t.get_child([1]);return this.rangeAsciisMatch(e,[(0,d.bypassNegatives)(r).to_ascii()])&&!n&&i.push([t]),r.is_group("product")?(n||(i=i.concat(this.matchRangeOfOperators(r.children,e))),r.children.forEach(function(t){var r=t.get_child([1]);(r=(0,d.bypassNegatives)(r)).is_group("fraction")&&(i=i.concat(this.getMatchingTargetRangesFromFraction(r,e,n)))},this)):r.is_group("fraction")&&(i=i.concat(this.getMatchingTargetRangesFromFraction(r,e,n))),i},h.prototype.getMatchingTargetRangesFromFraction=function(t,e,n){return n?this.matchRangeOfOperators(t.get_bottom(),e):this.matchRangeOfOperators(t.get_top(),e)},h.prototype.matchRangeOfOperators=function(t,e){var n=[],i=e.length,r=t.map(function(t){return(0,d.bypassNegatives)(t.get_child([1])).to_ascii()},this);if(t.length===i&&this.rangeAsciisMatch(e,r)&&t[0].get_parent(1).is_group("product"))return[[t[0].get_parent(2)]];for(var o=0;o<t.length-i+1;o++){var s=r.slice(o,o+i);this.rangeAsciisMatch(e,s)&&n.push(t.slice(o,o+i))}return n},h.prototype.rangeAsciisMatch=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0},h.prototype.bindActionForEachRange=function(t,e){var n=t[0].get_root();return e.map(function(e){return this.createBoundAction(n,{nodes:t,target:e})},this)},h.prototype.transform=function(t){this.addTouchedNodes(this.nodes),this.addTouchedNodes(this.target);var e=this.nodes,n=this.target,i=this.analyzeOldStructure(e),r=this.analyzeOldStructure(n),o=this.getNewTreeNode(n),s=this.getNewTreeNode(e);s[0].is_group("add","sub","addsub")&&(s=this.insertCoefficientOfOneIntoAddend(s)),o[0].is_group("add","sub","addsub")&&(o=this.insertCoefficientOfOneIntoAddend(o));var l=this.analyzeStructure(s),u=this.analyzeStructure(o);l.left_of_target=l.idx_of_addend<u.idx_of_addend;var h=this.stripNegatives(l),p=this.stripNegatives(u);this.nodesProductIsInMidFactoring(l)?(l.addend.remove(),l.sum_of_coefficients=l.left_of_target?l.product.get_child([0,1,1]):l.product.get_child([l.product.children.length-1,1,1])):l=this.reinterpretNodesStructureForFactoring(l),this.reinterpretTargetStructureForMergingWithNodes(u),this.insertTargetCoefficientsIntoCoefficientsSum(u,l),u.sum.insert(l.left_of_target?u.idx_of_addend-1:u.idx_of_addend,l.addend),this.reapplyNegatives(s,i,l,r,u,h,p),this.mapOldTargetFactorsToNewFactors(r,s);var f=[{node:e[0],node_no_neg:(0,d.bypassNegatives)(e[0].children[1])},{node:n[0],node_no_neg:(0,d.bypassNegatives)(n[0].children[1])}];if(!(s.length>1||o.length>1||l.range.length>1||u.range.length>1)&&f[0].node_no_neg.to_ascii()!==f[1].node_no_neg.to_ascii()){f.forEach(function(t){return t.val=a.AlgebraModel.get_numeric_value(t.node.children[1])});var g=Math.abs(f[1].val)>Math.abs(f[0].val)?1:0,m=Math.abs(f[1-g].val/f[g].val),v=l.sum_of_coefficients;l.left_of_target?(f[0].addends=v.children.slice(0,v.children.length-1),f[1].addends=[v.children[v.children.length-1]]):(f[0].addends=v.children.slice(1),f[1].addends=[v.children[0]]);var y=l.range[0];y=y.children[1].is_group("product")?y.get_child([1,0,1]):y.children[1].is_group("fraction")?y.get_child([1,1,1]):y.children[1];var b=f[g].val;y.is_group("sign")?y.children[1].value=Math.abs(b):y.value=Math.abs(b),f[1-g].addends.forEach(function(t){return(0,c.applyCoefficient)(t,m,s[0].is_group("div"))})}if(this.cleanupTermsInCoefficientsSum(l),this.cleanupTermsInProductOfCoefficentsSumAndVariables(l),this.cleanup_cascade(u.sum),this.setNodesToReselectAfterAction(s[0].children[1]?s:l.range),"function"!=typeof t)return!0;t(this)},h.prototype.analyzeOldStructure=function(t){var e,n=[],i=[];function r(t){for(;t.is_group("sign");)n.push(t),t=t.get_child([1]);i.push(t)}if(t[0].is_group("add","sub","addsub")){e=t[0];var o=t[0].get_child([1]);o.is_group("product")?o.children.forEach(function(t){r(t.get_child([1]))}):r(o)}else{for(e=t[0];!e.is_group("add","sub","addsub");)e=e.get_parent(1);t.forEach(function(t){r(t.get_child([1]))})}return{addend:e,negative_groups:n,factors:i}},h.prototype.insertCoefficientOfOneIntoAddend=function(t){for(var e=t[0];!e.is_group("add","sub","addsub");)e=e.get_parent(1);var n=e.get_child([1]);n.remove();var i=u.MulDiv.prototype.createParentGroup();return i.append(new u.MulDiv(new u.Num(1))),i.append(new u.MulDiv(n)),e.append(i),this.cleanup(i.get_child([1])),i.children.slice(1)},h.prototype.analyzeStructure=function(t){var e={};e.range=t;var n=t[0];if(n.parent.is_group("product"))e.product=n.get_parent(1),e.addend=e.product.get_parent(1);else{if(!n.get_parent(1).is_group("fraction"))throw"Can't identify structure for direct factoring.";e.fraction=n.get_parent(1),e.fraction.get_parent(1).is_group("mul")?(e.product=e.fraction.get_parent(2),e.addend=e.product.get_parent(1)):e.addend=e.fraction.get_parent(1)}return e.sum=e.addend.get_parent(1),e.idx_of_addend=e.sum.children.indexOf(e.addend),e},h.prototype.stripNegatives=function(t){var e=0;return t.addend.is_group("sub")&&(t.addend.invert(),e++),t.range.forEach(function(t){for(var n=0,i=t.get_child([1]);i.is_group("sign");)i=i.get_child([1]),n++;n&&(t.get_child([1]).remove(),i.remove(),t.append(i)),e+=n},this),e},h.prototype.nodesProductIsInMidFactoring=function(t){if(t.fraction)return!1;if(t.addend.is_group("sub"))return!1;var e=t.product.get_child([0,1]),n=t.product.get_last_child().children[1];return!(t.left_of_target&&-1!==t.range.indexOf(e.parent)||!t.left_of_target&&-1!==t.range.indexOf(n.parent)||!(e.is_group("brackets")&&e.children[1].is_group("sum")||!t.left_of_target)||!(n.is_group("brackets")&&n.children[1].is_group("sum")||t.left_of_target)||t.product.children.length-1!==t.range.length)},h.prototype.reinterpretNodesStructureForFactoring=function(t){return t.range.forEach(function(t){t.remove()}),this.rearrangeStructure(t)},h.prototype.rearrangeStructure=function(t){var e=u.MulDiv.prototype.createParentGroup();t.range.forEach(function(t){e.append(t)});var n=new u.MulDiv(e);this.cleanupProductOfCoefficients(t);var i=u.AddSub.prototype.createParentGroup();t.addend.remove(),t.addend.dragging=!1,t.addend.selected=!1,i.append(t.addend);var r=t.addend.get_idx(),o=new u.Brackets(i),s=u.MulDiv.prototype.createParentGroup();t.left_of_target?(s.append(new u.MulDiv(o)),s.append(n)):(s.append(n),s.append(new u.MulDiv(o)));var a=new u.AddSub(s),l={};return l.idx_of_addend=r,l.addend=a,l.product=s,l.sum_of_coefficients=i,l.left_of_target=t.left_of_target,l.range=[n],l},h.prototype.cleanupProductOfCoefficients=function(t){var e,n;t.fraction&&(e=t.fraction.parent,this.cleanup(t.fraction),e.is_group("mul")&&1===u.Num.get_value(e.children[1])&&(e.remove(),n=!0)),t.product&&(e&&!n&&this.cleanup(e),this.cleanup(t.product))},h.prototype.reinterpretTargetStructureForMergingWithNodes=function(t){t.addend.remove(),t.range.forEach(function(t){t.remove()});var e,n=t.fraction;n&&1===(e=n).get_top().length&&0===e.get_bottom().length&&1===u.Num.get_value(e.children[0].children[1])&&n.parent.is_group("mul")&&n.parent.remove()},h.prototype.insertTargetCoefficientsIntoCoefficientsSum=function(t,e){e.left_of_target?e.sum_of_coefficients.append(t.addend):e.sum_of_coefficients.insert(0,t.addend)},h.prototype.reapplyNegatives=function(t,e,n,i,r,o,s){if(o%2==1&&s%2==1){var a=t[0],l=a.get_child([1]);l.remove(),l=new u.Sign(l),a.append(l),e.addend.is_group("sub")?this.extendNodeMap(e.addend.get_child([0]),l.get_child([0])):e.negative_groups.forEach(function(t,e){0===e&&this.updateNodeMap(t.get_child([0]),l.get_child([0]))},this),i.addend.is_group("sub")?this.extendNodeMap(i.addend.get_child([0]),l.get_child([0])):i.negative_groups.forEach(function(t,e){0===e&&this.updateNodeMap(t.get_child([0]),l.get_child([0]))},this)}else if(o!==s&&Math.abs(o-s)%2==1){var c=n.left_of_target?n.sum_of_coefficients.children.length-1:0,d=n.sum_of_coefficients.get_child([c]);o%2==1?n.sum_of_coefficients.children.forEach(function(t,n){n!==c&&(t.invert(),e.addend.is_group("sub")?this.extendNodeMap(e.addend.get_child([0]),t.get_child([0])):e.negative_groups.forEach(function(e,n){0===n&&this.extendNodeMap(e.get_child([0]),t.get_child([0]))},this))},this):(d.invert(),i.addend.is_group("sub")?this.updateNodeMap(i.addend.get_child([0]),d.get_child([0])):i.negative_groups.forEach(function(t,e){0===e&&this.updateNodeMap(t.get_child([0]),d.get_child([0]))},this))}},h.prototype.mapOldTargetFactorsToNewFactors=function(t,e){t.factors.forEach(function(t,n){this.updateNodeMap(t.get_mapping_to((0,d.bypassNegatives)(e[n].children[1])))},this)},h.prototype.cleanupTermsInCoefficientsSum=function(t){for(var e=t.sum_of_coefficients,n=0;n<e.children.length;n++)(i=e.get_child([n,1])).is_group("product")&&i.children.forEach(function(t){var e=t.get_child([1]);e.is_group("fraction")&&this.cleanup(e)},this),this.cleanup(i);for(n=0;n<e.children.length;n++){var i=e.get_child([n]);u.Brackets.handle(i,!0),this.cleanup(i)}},h.prototype.cleanupTermsInProductOfCoefficentsSumAndVariables=function(t){for(var e=t.product,n=0;n<e.children.length;n++)this.cleanup(e.children[n].children[1]);for(n=0;n<e.children.length;n++)this.cleanup(e.children[n])},(0,l.default)(h,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EvalTrigAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"EvalTrigAction","evaluate trig functions"),this.priority=1,this.triggerType="tap",this.settings={},t&&(this.actor=t.actor)}r.gmath.inherit(s.Action,u),u.prototype.match=function(t){if(!l.Func.Trig.is_trig_func(t))return!1;var e=t.get_arg();if(e&&l.Num.is_num(e)){var n=l.Func.Trig.evaluate(t);return!Number.isNaN(n)}return!1},u.prototype.transform=function(t){var e=this.getNewTreeNode(this.actor);this.addTouchedNodes(this.actor);var n=l.Func.Trig.evaluate(e);if(!Number.isNaN(n)){var i=new l.Num(n);o.Tree.replace(e,i),l.Brackets.handle(i),this.updateNodeMap(this.actor,i)}return"function"==typeof t&&t(this),this},(0,a.default)(u,!1,l.Func)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SwitchAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"SwitchAction","switch terms in a flat representation"),this.priority=0,this.triggerType="drag",this.settings={side:"around"},t&&(this.node=t.node,this.target=t.target)}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){if(0===t.length)return[];var e,n=t[0].get_root(),i=[];if(!t[0].parent.is_group("flat"))return[];if(!t[0].commutative||!o.Tree.is_range(t))return[];for(e=t[0].ls;e&&"//"!==e.value;e=e.ls)this.match(t[0],e)&&i.push(this.createBoundAction(n,{node:t[0],target:e}));for(e=t[t.length-1].rs;e&&"//"!==e.value;e=e.rs)this.match(t[0],e)&&i.push(this.createBoundAction(n,{node:t[0],target:e}))},u.prototype.match=function(t,e){return!(t.parent!==e.parent||t===e||e instanceof l.Sym||t instanceof l.Sym)},u.prototype.transform=function(t){var e=tree===this.target.get_root(),n=e?this.node:tree.get_child(this.node.get_path()),i=e?this.target:tree.get_child(this.target.get_path());if(o.Tree.switch_siblings(n,i),"function"!=typeof t)return!0;t(this)},(0,a.default)(u,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EqInvertAndCommuteTermAction=h;var i,r=n(0),o=(n(1),n(2)),s=n(5),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3),u=n(12),c=n(100),d=n(102);function h(t){if(o.Action.call(this,"EqInvertAndCommuteTermAction","composed action of inverting terms across an equation and commuting"),this.priority=0,this.triggerType="drag",this.settings.margin={y:-1},t){this.settings.simplify_after_drag_across_relation=u.MathSettings.get("simplify_after_drag_across_relation"),this.settings.allow_drag_across_relation=u.MathSettings.get("allow_drag_across_relation");var e=this.getDestinationHints(t);this.initSettings(r.gmath.extend(t,{destination_hint:e}))}}r.gmath.inherit(o.Action,h),h.prototype.inContext=function(t){return t in this.settings?this.settings[t]:u.MathSettings.get(t)},h.prototype.getAllAvailableActions=function(t){if(this.inContext("simplify_after_drag_across_relation"))return[];var e=t[0].get_root(),n=this.getAndPerformAvailableInversionActionOnClone(e,t);if(!n)return[];var i=this.getAvailableCommuteActionsOnInversionResult(n);if(0===i.length)return[];var r=this.unmapToGetTargets(e,n,i).sort(function(t,e){return t.parent.get_idx()-e.parent.get_idx()});return this.adjustTargets(this.bindActionForEachTarget(t,r,!0))},h.prototype.applyMathSettings=function(t){var e="simplify_after_drag_across_relation";t.settings[e]=e in this.settings?this.settings[e]:u.MathSettings.get(e);var n="allow_drag_across_relation";return t.settings[n]=n in this.settings?this.settings[n]:u.MathSettings.get(n),t},h.prototype.getAndPerformAvailableInversionActionOnClone=function(t,e){var n=t.clone(),i=[];e.forEach(function(t){i.push(n.get_child(t.get_path()))});var r=this.applyMathSettings(new c.MulDivInvertAction).getAllAvailableActions(i);if(0===r.length)return!1;var o=r[0];return n.performAction(o,null,!1,!0),o.newTree!==o.oldTree&&o},h.prototype.getAvailableCommuteActionsOnInversionResult=function(t){var e=[],n=t.nodes;1===n.length&&n[0].is_group("sum")&&(n=n[0].children.slice());for(var i=0;i<n.length;i++){var o=n[i],s=this.getTheNodesOnTheSameSideAsTheTarget(t.mapNodes(o),t.target);e.push(this.getCommutativeTermFromNode(s)[0])}return r.gmath.actions.CommuteAction.getAllAvailableActions(e).filter(function(t){return!t.target.is_group("sym")})},h.prototype.getTheNodesOnTheSameSideAsTheTarget=function(t,e){var n=[],i=e.get_path()[1];return t.forEach(function(t){t.get_path()[1]===i&&n.push(t)}),n},h.prototype.unmapToGetTargets=function(t,e,n){var i=[];n.forEach(function(t){i.push(t.target)});var r=this,o=[];i.forEach(function(t){o.push(r.getCommuteTargetBeforeInversion(t,e))});var s=[];return o.forEach(function(e){s.push(t.get_child(e.get_path()))}),s},h.prototype.getCommuteTargetBeforeInversion=function(t,e){t.is_group("brackets")&&t.parent.is_group("mul")&&(t=t.parent);var n=e.unmapNodes(t);if(1===n.length)return n[0];if(t.is_group("mul")&&t.children[1].is_group("brackets")&&t.children[1].children[1].is_group("sum")){var i=t.children[1];if(0!==(n=e.unmapNodes(i)).length)return n[0];var r=i.children[1];return(n=e.unmapNodes(r))[0]}if(t.is_group("add","sub","mul")){var o=t.children[1];return e.unmapNodes(o)[0]}},h.prototype.getCommutativeTermFromNode=function(t){if(1!==t.length)throw"What's happening here?";return t[0].parent.commutative?[t[0].parent]:t[0].is_group("sum")&&t[0].parent.is_group("brackets")&&t[0].parent.parent&&t[0].parent.parent.commutative?[t[0].parent.parent]:t},h.prototype.adjustTargets=function(t){for(var e=0;e<t.length;e++){var n=t[e];(!n.target.ls&&"left-of"===n.side||(!n.target.rs||n.target.rs instanceof l.Sym)&&"right-of"===n.side)&&n.target.parent.is_group("fraction")&&(n.target=n.target.parent),0===e?n.settings.margin.x1=-.5:e===t.length-1&&(n.settings.margin.x2=-.5)}return t.filter(function(e,n){for(var i=t.slice(0,n),r=0;r<i.length;r++)if(i[r].target===e.target&&i[r].settings.side===e.settings.side)return!1;return!0})},h.prototype.getDestinationHints=function(t){for(var e=[],n=t.nodes[0];!n.is_group("add","sub","addsub")&&!s.AlgebraModel.is_top_most(n);)n=n.parent;return(n.is_group("add","sub","addsub")?l.Group.get_siblings(n).map(function(t){return t.children[1]}):[]).forEach(function(t){return e.push({node:t,side:"below",margin:{x:-.2}})}),e.push({node:t.target,side:t.side}),e},h.prototype.doInPlace=function(t){this.initNodeMap();var e=this.settings.side;if(this.target.is_group("fraction")&&this.nodes[0].is_group("div")){var n=this.target.get_top();this.target="left-of"===e?n[0]:n[n.length-1]}var i=this;this.nodes.forEach(function(t){i.addTouchedNodes(t)});var o,s=this.getNewTreeNode(this.nodes),a=this.getNewTreeNode(this.target);o=s[0].is_group("mul","div")?this.applyMathSettings(new c.MulDivInvertAction).getAllAvailableActions(s)[0]:this.applyMathSettings(new d.AddSubInvertAction).getAllAvailableActions(s)[0],this.applyMathSettings(o),o.doInPlace(),this.compose(o,!1);var l=this.getTheNodesOnTheSameSideAsTheTarget(o.mapNodes(1===s.length&&s[0].is_group("sum")?s[0].children.slice():s),o.mapNodes(a)[0]);a=o.mapNodes(a),1===l.length&&(l=this.getCommutativeTermFromNode(l)),a=this.getCommutativeTermFromNode(a)[0];var u,h=r.gmath.actions.CommuteAction.getAllAvailableActions(l).filter(function(t){return!t.target.is_group("sym")});if("right-of"!==e||this.target.parent.rs)for(var p=0;p<h.length;p++){var f=h[p];if("right-of"===e&&"right-inside"===f.settings.side&&a===f.target.parent){u=f,f.doInPlace(),this.compose(f,!1);break}if("left-of"===e&&"left-inside"===f.settings.side&&a===f.target.parent){u=f,f.doInPlace(),this.compose(f,!1);break}}if(this.setNodesToReselectAfterAction(u?this.getTheNodesOnTheSameSideAsTheTarget(u.mapNodes(l),a):this.getTheNodesOnTheSameSideAsTheTarget(l,a)),this.removeDeletedNodesFromNodeMap(),"function"!=typeof t)return!0;t(this)},(0,a.default)(h,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flipEquationAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"flipEquationAction","flip equation"),this.priority=1,this.triggerType="tap",t&&(this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.match=function(t){return a.Inequality.is_relation(t)},l.prototype.transform=function(t){var e=this.getNewTreeNode(this.actor);this.addTouchedNodes(u(this.actor)),this.addTouchedNodes(c(this.actor));var n=u(e),i=c(e);return n.remove(),i.remove(),e.insert(0,i),e.insert(2,n),a.Inequality.is_inequality(e)&&e.invert(),"function"==typeof t&&t(this),this};var u=function(t){return t.children[0]},c=function(t){return t.children[2]};(0,s.default)(l,!1,a.Equals,a.Inequality)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CommuteAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),s=n(1),a=n(2),l=(i=n(4))&&i.__esModule?i:{default:i},u=n(3),c=e.CommuteAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"CommuteAction","commute terms"));return n.priority=-1,n.triggerType="drag",t&&(t.priority&&(n.priority=t.priority),t.dummy&&(n.settings.dummy=!0),t.drop_area&&o.gmath.extend(t.drop_area.margin,{y:-1}),n.initSettings(t)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.Action),r(e,[{key:"getAllAvailableActions",value:function(t){var e=function(t){return!!s.Tree.is_range(t)&&!!t[0].commutative&&{nodes:t,type:t[0].name}}(t);if(!e)return[];var n=function(t){return u.Group.get_siblings(t.nodes).filter(function(e){return"add-sub"===t.type||e.is_group(t.nodes[0].value)})}(e);return this.bindActionsForEachTarget(t,n)}},{key:"bindActionsForEachTarget",value:function(t,e){var n=this,i=[],r=t[0].get_root(),o=t[0],s=t[t.length-1],a=o.ls,l=s.rs,u=e[0],c=e[e.length-1];return e.forEach(function(e){i.push(n.bindTermRightAction(r,t,e.children[1],e===a,e===c&&e.get_idx()>s.get_idx())),e.children[0].hidden||i.push(n.bindOperatorAction(r,t,e.children[0],e===l)),i.push(n.bindTermLeftAction(r,t,e.children[1],e===l,e===u&&e.get_idx()<o.get_idx()))}),i.forEach(function(t){t.target.get_parent(2).is_group("fraction")?(t.drop_area.margin||(t.drop_area.margin={}),t.target.parent.is_group("mul")?d(t.drop_area.margin,"up"):d(t.drop_area.margin,"down")):t.target.parent.is_group("add","sub","addsub")&&t.target.get_parent(5)&&t.target.get_parent(5).is_group("fraction")&&(t.drop_area.margin||(t.drop_area.margin={}),t.target.get_parent(4).is_group("mul")?d(t.drop_area.margin,"up"):d(t.drop_area.margin,"down"))}),i}},{key:"bindOperatorAction",value:function(t,e,n,i){var r={nodes:e,target:n,priority:100};return n.parent.is_group("add","sub","addsub")?(r.drop_area={margin:{x:.1}},r.drop_area_hint={margin:{x:.1}}):r.drop_area_hint={margin:{x:.05}},i?r.dummy=!0:r.destination_hint={nodes:[n.parent],side:"left-of"},this.createBoundAction(t,r)}},{key:"bindTermLeftAction",value:function(t,e,n,i,r){var o={nodes:e,target:n,side:"left-inside"};return r?(o.drop_area={margin:{x1:-.5}},o.drop_area_hint={node:n.parent,side:"left-of",margin:{x1:-.2,x2:.1}}):o.drop_area_hint={hidden:!0},i?o.dummy=!0:o.destination_hint={nodes:[n.parent],side:"left-of"},this.createBoundAction(t,o)}},{key:"bindTermRightAction",value:function(t,e,n,i,r){var o={nodes:e,target:n,side:"right-inside"};return r?(o.drop_area={margin:{x2:-.5}},o.drop_area_hint={node:n.parent,side:"right-of",margin:{x1:.1,x2:-.2}}):o.drop_area_hint={hidden:!0},i?o.dummy=!0:o.destination_hint={nodes:[n.parent],side:"right-of"},this.createBoundAction(t,o)}},{key:"transform",value:function(t){var e,n=this.getSourceAndTarget(!0);e=n.target.is_group("sym")?"left-of":"left-inside"===this.settings.side?"left-of":"right-of",n.target=n.target.parent,this.addTouchedNodes(n.source),this.addTouchedNodes(n.target);var i=this.getNewTreeNode(n.source),r=this.getNewTreeNode(n.target),o=r.parent,a=r.get_idx();"right-of"===e&&a++;var l=s.Tree.remove_range(i);if(o.insert_range(l<a?a-i.length:a,i),"function"!=typeof t)return!0;t(this)}}]),e}();function d(t,e){"up"===e?(t.y1=-1,t.y2=.1):"down"===e&&(t.y1=.1,t.y2=-1)}(0,l.default)(c,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DragSplitNegativesAction=l;var i,r=n(0),o=n(2),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){if(o.Action.call(this,"DragSplitNegativesAction","drag a negative sign to the left to extract a negative 1"),this.priority=1,this.triggerType="drag",this.settings={delay:1e3,side:"left-of"},t){var e={node:t.nodes[0],side:"around",margin:{x1:-.15,x2:.25,y1:.5,y2:.4}},n={node:t.nodes[0],side:"around",margin:{x1:.25,y1:.5,y2:.4}};this.initSettings(r.gmath.extend(t,{drop_area_hint:e,destination_hint:n}))}}r.gmath.inherit(o.Action,l),l.prototype.getAllAvailableActions=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return 1!==t.length?[]:n&&!t[0].ls&&t[0].parent.is_group("sub","sign","addsub","plusminus")&&1!==t[0].rs.value?this.bindActionForEachTarget(t,t):n?[]:this.bindActionForEachTarget(t,t)},l.prototype.rematch=function(){var t=this;return!!(this.nodes&&this.nodes.length>0&&this.target)&&this.getAllAvailableActions(this.nodes,null,!1).some(function(e){return e.target===t.target})},l.prototype.transform=function(t){this.addTouchedNodes(this.target.parent);var e=this.target.is_group("sign","sub","add","addsub","plusminus")?this.target.children[0]:this.target;if(e.parent.is_group("add","sub","sign","addsub","plusminus")){var n,i=this.getNewTreeNode(e.parent),r=i.parent,o=i.remove(),s=new a.ProductFraction,l=i.children[1];l.remove(),i.is_group("add")&&(n=new a.Num(1)),i.is_group("sub","sign")&&(n=new a.Num(-1)),i.is_group("addsub","plusminus")&&(n=new a.Sign(new a.Num(1),!0)),this.extendNodeMap(e.parent,n),this.updateNodeMap(e,n.children[0]);var u=new a.MulDiv(n);s.append(u),l.is_group("product")?s.append_range(l.children):s.append(new a.MulDiv(l));var c=i.is_group("add","sub","addsub")?new a.AddSub(s):s;r.insert(o,c),this.cleanup_cascade(r),this.setNodesToReselectAfterAction(u)}else{var d=this.getNewTreeNode(e),h=d.parent,p=d.remove();(s=new a.ProductFraction).append(new a.MulDiv(new a.Num(1))),s.append(new a.MulDiv(d)),h.insert(p,s),this.cleanup(s.children[1]),this.cleanup(h)}return"function"==typeof t&&t(this),this},(0,s.default)(l,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DragNegativeSymReselectGroupAction=a;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i};function a(t){o.Action.call(this,"DragNegativeSymReselectGroupAction","drag a negative sign to the left to extract a negative 1"),this.priority=2,this.triggerType="drag",this.settings={makes_no_changes:!0,no_delay:!0,update_node_positions:!0,side:"outside"},t&&this.initSettings(r.gmath.extend(t,{drop_area:{margin:{y1:.4,y2:.4}},drop_area_hint:{hidden:!0}}))}n(3),r.gmath.inherit(o.Action,a),a.prototype.getAllAvailableActions=function(t){if(1!==t.length)return[];var e=t[0];if(!e.is_group("sym")||"-"!==e.value&&"±"!==e.value)return[];var n=e.get_root(),i=this.createBoundAction(n,{nodes:[e],target:e});return e.rs&&1===e.rs.value&&(i.settings.side="inside"),[i]},a.prototype.transform=function(t){return this.addTouchedNodes(this.target.parent),this.setNodesToReselectAfterAction(this.target.parent),"function"==typeof t&&t(this),this},(0,s.default)(a,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DistributePolynomialsAction=c;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3),l=n(101),u=(n(24),n(12));function c(t){o.Action.call(this,"DistributePolynomialsAction","multiply two sums"),this.priority=1,this.triggerType="dbltap",t&&(this.settings.enable_polynomial_distribution=u.MathSettings.get("enable_polynomial_distribution"),this.settings.auto_simplify_distributions=t.auto_simplify_distributions,this.actor=t.actor)}r.gmath.inherit(o.Action,c),c.prototype.inContext=function(t){if("enable_polynomial_distribution"===t)return t in this.settings?this.settings[t]:u.MathSettings.get(t);if("auto_simplify_distributions"===t){if(t in this.settings)return this.settings[t];if(this.oldTree)return this.oldTree.settings.get(t);throw"[DistributePolynomialsAction] Attempting to access irrelevant setting."}throw"[DistributePolynomialsAction] Attempting to access irrelevant setting."},c.prototype.match=function(t){return!!this.inContext("enable_polynomial_distribution")&&!!t.ls&&!!(t.is_group("mul")&&t.ls.is_group("mul")||t.is_group("div")&&t.ls.is_group("div"))&&(t.ls.children[1].is_group("brackets")||t.children[1].is_group("brackets"))},c.prototype.transform=function(t){var e=this,n=this.getSourceAndTarget(),i=this.getNewTreeNode(n.source),r=this.getNewTreeNode(n.target);this.addTouchedNodes(i),this.addTouchedNodes(r);var o=r.children[1].is_group("brackets")?r.children[1].children[1]:r.children[1],s=i.children[1].is_group("brackets")?i.children[1].children[1]:i.children[1],u=o.is_group("sum")?o.children:[o],c=s.is_group("sum")?s.children:[s],d=this.getFoilPairs(u,c),h=new a.Sum;return d.forEach(function(t){var n,i=e.getFactors(t.term1).concat(e.getFactors(t.term2)),r=e.getFactors(t.oldTerm1).concat(e.getFactors(t.oldTerm2));n=e.inContext("auto_simplify_distributions")?(0,l.reduceProduct)(i,r,t.isNeg,t.oldSigns,e):(0,l.arrangeProduct)(i,t.isNeg,t.oldSigns,e),h.append(new a.AddSub(n))}),i.remove(),r.children[1].remove(),r.append(h),h.children.forEach(function(t){return e.applyInnerAction("AddSubCombineSigns",{actor:t})}),a.Brackets.handle(h),h.children.forEach(function(t){var n=t.children[1];if(n.is_group("product","fraction")){for(var i=n.children.length-1;i>=0;i--)e.cleanup(n.children[i]);e.cleanup(n)}}),this.cleanup(h),this.cleanup_cascade(r),"function"==typeof t&&t(this),this},c.prototype.getFoilPairs=function(t,e){var n=[];return t.forEach(function(t){e.forEach(function(e){var i=t.is_group("sign","sub")!==e.is_group("sign","sub"),r=[],o=t.is_group("sign","sub","add")?t.clone().children[1]:t.clone(),s=e.is_group("sign","sub","add")?e.clone().children[1]:e.clone(),a=this.getOldTreeNode(t.is_group("sign","sub","add")?t.children[1]:t),l=this.getOldTreeNode(e.is_group("sign","sub","add")?e.children[1]:e);t.is_group("sign","sub")&&r.push(this.getOldTreeNode(t.children[0])),e.is_group("sign","sub")&&r.push(this.getOldTreeNode(e.children[0])),this.extendNodeMap(a.get_mapping_to(o)),this.extendNodeMap(l.get_mapping_to(s)),n.push({isNeg:i,term1:o,term2:s,oldTerm1:a,oldTerm2:l,oldSigns:r})},this)},this),n},c.prototype.getFactors=function(t){return t.is_group("product")?t.children.map(function(t){return t.children[1]}):[t]},(0,s.default)(c,!1,a.MulDiv)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DistributeIntoBracketsAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),s=n(1),a=n(2),l=(i=n(4))&&i.__esModule?i:{default:i},u=n(3),c=e.DistributeIntoBracketsAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"DistributeIntoBracketsAction","distribute"));if(n.triggerType="drag",n.settings={reset_x:!0,reset_y:!0,delay:300},n.priority=2,t){var i={nodes:t.target.children.map(function(t){return t.children[1]})};n.initSettings(o.gmath.extend(t,{destination_hint:i}))}return n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.Action),r(e,[{key:"getAllAvailableActions",value:function(t){var e=function(t){return!!s.Tree.is_range(t)&&!!t[0].is_group("mul","div")&&{nodes:t,type:t[0].value}}(t);if(!e)return[];var n=function(t){return u.Group.get_siblings(t.nodes).filter(function(e){return e.is_group(t.type)&&e.children[1].is_group("brackets")&&e.get_child([1,1]).is_group("sum")}).map(function(t){return t.get_child([1,1])})}(e);return this.bindActionsForEachTarget(t,n)}},{key:"bindActionsForEachTarget",value:function(t,e){var n=this,i=[],r=t[0].get_root();return e.forEach(function(e){i.push(n.createBoundAction(r,{nodes:t,target:e,side:"left-inside"})),i.push(n.createBoundAction(r,{nodes:t,target:e,side:"right-inside"}))}),i}},{key:"transform",value:function(t){var e=this.getSourceAndTarget(!0);this.addTouchedNodes(e.source),this.addTouchedNodes(e.target);var n=this.getNewTreeNode(e.source),i=this.getNewTreeNode(e.target),r=i.parent,o=e.target.parent.children[0],a=e.target.parent.children[2],l=r.get_parent(2);s.Tree.remove_range(n),this.distributeIntoSum(i,n),this.cleanup(l);var c=i.parent;if(!c.is_group("brackets")||c.is_group("brackets")&&c.parent.is_group("mul","div")&&c.parent.parent.is_group("fraction")&&(c.parent.is_group("mul")?1===c.parent.parent.get_top().length:1===c.parent.parent.get_bottom().length)){var d=i.remove(),h=new u.Brackets(i);s.Tree.insert(c,d,h),this.updateNodeMap(o.parent,h),this.updateNodeMap(o,h.children[0]),this.updateNodeMap(a,h.children[2]),h.simplify=!0}if("function"!=typeof t)return!0;t(this)}},{key:"distributeIntoSum",value:function(t,e){for(var n=this.settings.side,i=t.children.length,r=function(t){t.is_group("div")&&t.invert()},o=0;o<i;o++){var a,l=t.children[o].children[1],c=void 0;l.remove(),l.is_group("product")?c=l:(c=new u.ProductFraction).append(new u.MulDiv(l)),(a="left-inside"===n&&0===o||"right-inside"===n&&o===i-1?e:s.Tree.clone(e)).forEach(r),this.extendNodeMap(s.Tree.get_mapping_between(this.nodes,a));var p="left-inside"===n?1:c.children.length-1;c.children[p]&&(c.children[p].simplify=!0);var f="left-inside"===n?0:c.children.length;c.insert_range(f,a),t.children[o].append(c),h(e)&&(d(e)||c.children.some(function(t){return t.is_group("mul")&&u.Num.is_num(t.children[1])&&0===u.Num.get_value(t.children[1])}))&&(c.children.forEach(function(t){t.simplify=!1}),c.simplify=!0)}}}]),e}();function d(t){return t.some(function(t){return t.is_group("mul")&&u.Num.is_num(t.children[1])})}function h(t){return!t.some(function(t){return t.is_group("mul")&&0===u.Num.get_value(t.children[1])})}(0,l.default)(c,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CloneAction=a;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i};function a(){o.Action.call(this,"CloneAction","clone"),this.triggerType="drag"}n(3),r.gmath.inherit(o.Action,a),a.prototype.rematch=function(){return!0},a.prototype.transform=function(t){if("function"!=typeof t)return!0;t(this)},(0,s.default)(a,!1)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RemoveBracketsAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"RemoveBracketsAction","remove optional brackets"),this.priority=-1,this.triggerType="tap",t&&(this.actor=t.actor)}r.gmath.inherit(s.Action,u),u.prototype.match=function(t){return t.is_group("brackets")&&l.Brackets.is_optional(t)||t.is_group("mul","div","add","sub")&&t.children[1].is_group("brackets")&&l.Brackets.is_optional(t.children[1])},u.prototype.transform=function(t){var e=this.actor;e.is_group("brackets")||(e=e.children[1]);var n=this.getNewTreeNode(e);this.addTouchedNodes(e.children[0]),this.addTouchedNodes(e.children[2]);var i=o.Tree.replace(n,n.children[1]);if(this.cleanup(i.parent),"function"!=typeof t)return!0;t(this)},(0,a.default)(u,!1,l.Brackets,l.MulDiv,l.AddSub)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BreakingBracketsOutAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"BreakingBracketsOutAction","automatic out of bracket handling"),this.interactionType="drag",this.settings.margin={},t&&(this.nodes=t.nodes,this.target=t.target,this.settings.side=t.side,this.settings.margin["right-of"===t.side?"x2":"x1"]=-1.75)}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){if(0===t.length)return[];var e,n=t[0].get_root(),i=[];return o.Tree.is_range(t)?(t[0].parent.parent&&t[0].parent.parent.is_group("brackets")?e=t[0].parent.parent:t[0].parent.is_group("brackets")&&(e=t[0].parent),e&&(this.match(t,e,"right-of")&&i.push(this.createBoundAction(n,{nodes:t,target:e,side:"right-of"})),this.match(t,e,"left-of")&&i.push(this.createBoundAction(n,{nodes:t,target:e,side:"left-of"}))),i):[]},u.prototype.match=function(t,e,n){return!(!l.Brackets.is_optional(e)&&!e.parent.is_group("sub")||(t[0].parent!==e||t[0].is_group("sym"))&&(e!==t[0].parent.parent||!t[0].commutative||"left-of"===n&&e.ls===t[t.length-1]||"right-of"===n&&e.rs===t[0]))},u.prototype.transform=function(t){var e=this.getNewTreeNode(this.nodes),n=this.getNewTreeNode(this.target),i=this.settings.side;if(e[0].parent!==n||e[0].is_group("sym")){if(n.parent.group_name!==e[0].group_name){var r=n.replace_with(e[0].createParentGroup());o.Tree.remove_range(e),r.append(e[0].createSameNode(n)),r.insert_range("left-of"===i?0:1,e),n.children[1].children<2&&l.Brackets.handle(n,!0)}else{o.Tree.remove_range(e);var s=n.parent.get_idx();n.parent.is_group("div")&&e[0].is_group("mul")&&e.forEach(function(t){return t.invert()}),n.parent.is_group("sub")&&e[0].is_group("add","sub")&&e.forEach(function(t){return t.invert()}),n.parent.parent.insert_range("left-of"===i?s:s+1,e)}if(n.children[1].children.length<2){var a=n.replace_with(n.children[1]);this.cleanup(a)}}else l.Brackets.handle(e[0].parent,!0),this.cleanup(e[0].parent);if("function"!=typeof t)return!0;t(this)},(0,a.default)(u,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BreakingBracketsInAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){if(s.Action.call(this,"BreakingBracketsInAction","automatic into bracket handling"),this.interactionType="drag",this.settings={no_target_box_expansion:!0},t){var e=[{node:t.target.children[1]}];this.initSettings(r.gmath.extend(t,{destination_hint:e}))}}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){var e=function(t){return!!o.Tree.is_range(t)&&!!t[0].commutative&&{nodes:t,type:t[0].name}}(t);if(!e)return[];var n=function(t){var e=t.nodes[0].value;return l.Group.get_siblings(t.nodes).filter(function(n){return"add-sub"===t.type||n.is_group(e)}).map(function(t){return t.children[1]}).filter(function(e){return!(!e.is_group("brackets")||!e.children[1].is_group("brackets","abs-val")&&e.children[1].bp<t.nodes[0].bp)})}(e);return this.bindActionsForEachTarget(t,n)},u.prototype.bindActionsForEachTarget=function(t,e){var n=this,i=[],r=t[0].get_root();return e.forEach(function(e){i.push(n.createBoundAction(r,{nodes:t,target:e,side:"left-inside"})),i.push(n.createBoundAction(r,{nodes:t,target:e,side:"right-inside"}))}),i},u.prototype.transform=function(t){var e=this.getNewTreeNode(this.nodes),n=this.getNewTreeNode(this.target),i=this.settings.side;if(o.Tree.remove_range(e),!n.children[1].is_group(e[0].group_name)){var r=n.children[1];n.children[1].remove();var s=e[0].createParentGroup();s.insert(0,e[0].createSameNode(r)),n.insert(1,s)}n.parent.is_group("div")&&n.children[1].is_group("product")&&e.forEach(function(t){return t.invert()}),n.parent.is_group("sub")&&e[0].is_group("add","sub")&&e.forEach(function(t){return t.invert()});var a="left-inside"===i?0:n.children[1].children.length;if(n.children[1].insert_range(a,e),n.parent.parent&&this.cleanup(n.parent.parent),"function"!=typeof t)return!0;t(this)},(0,a.default)(u,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AssociateIntoDenominatorAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){if(s.Action.call(this,"AssociateIntoDenominatorAction","associative property of denominator--move into denominator"),this.priority=-2,this.triggerType="drag",this.settings={no_target_box_expansion:!0},t){var e={side:"around",margin:{y1:.25,x:-.1}};t.target&&(t.target.parent.is_group("fraction")?e.node=l.ProductFraction.get_whole_range(t.target):e.node=t.target),this.initSettings(r.gmath.extend(t,{drop_area:e,drop_area_hint:{margin:{y1:.1,x:-.1}}}))}}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return r.gmath.array.flatten(n.map(function(e){return this.bindActionForEachTarget(t,e,!!e[0].is_group("div"))},this))},u.prototype.matchSource=function(t){if(!t[0].is_group("div"))return!1;var e=t[0].parent,n=e.parent;return n.is_group("sign","plusminus")&&(n=n.parent),!!n.is_group("mul","div")&&{nodes:t,frac:e,op:n,group:n.parent}},u.prototype.getTargets=function(t){for(var e=[],n=0;n<t.group.children.length;n++){var i=t.group.children[n];if(i.value===t.op.value&&i!==t.op){var r=this.operatorContainsFraction(i);r?e.push(r.get_bottom()):e.push([i.children[1]])}}return e},u.prototype.operatorContainsFraction=function(t){var e=t.children[1];return e.is_group("sign","plusminus")&&(e=e.children[1]),!!e.is_group("fraction")&&e},u.prototype.transform=function(t){this.addTouchedNodes(this.nodes),this.addTouchedNodes(this.target);var e=this.settings.side,n=this.getNewTreeNode(this.nodes),i=n[0].parent,r=this.getNewTreeNode(this.target);if(o.Tree.remove_range(n),this.insertDivsInNewLocation(n,r,e),this.cleanupSourceFraction(i),"function"!=typeof t)return this;t(this)},u.prototype.insertDivsInNewLocation=function(t,e,n){e.is_group("div")?this.insertDivRangeIntoDenominator(t,e,n):this.replaceTargetWithFractionContainingTargetAndDivs(t,e)},u.prototype.insertDivRangeIntoDenominator=function(t,e,n){var i=e.parent;i.insert_range(i.children.indexOf(e)+("left-of"===n?0:1),t)},u.prototype.replaceTargetWithFractionContainingTargetAndDivs=function(t,e){e.parent;var n=new l.ProductFraction;e.replace_with(n),n.append(new l.MulDiv(e)),t.forEach(function(t){n.append(t)})},u.prototype.cleanupSourceFraction=function(t){var e=t.parent;e.is_group("sign","plusminus")&&(e=e.parent);var n=e.parent;this.cleanup(t),!this.cleanup(e)&&l.Num.is_num(e.children[1])&&1===l.Num.get_value(e.children[1])&&(e.remove(),this.cleanup(n))},(0,a.default)(u,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AssociateOutOfDenominatorAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"AssociateOutOfDenominatorAction","associative property of division--move out of fraction denominator"),this.priority=-2,this.triggerType="drag",this.settings={delay:100,margin:{y:.5}},t&&(this.setActorAndTarget(t),this.settings.side=t.side,this.settings.margin["right-of"===t.side?"x2":"x1"]=-1,this.settings.margin["right-of"===t.side?"x1":"x2"]=.2)}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n,!0)},u.prototype.matchSource=function(t){if(!o.Tree.is_range(t)||!t[0].is_group("div"))return!1;var e=t[0].parent;return!(l.ProductFraction.is_fraction_with_identity_numerator(e)&&t.length===e.get_bottom().length&&(1!==t.length||!t[0].children[1].is_group("fraction")))&&!!e.is_group("fraction")&&{nodes:t,fraction:e}},u.prototype.getTargets=function(t){return[t.fraction]},u.prototype.transform=function(t){this.addTouchedNodes(this.nodes[0].parent);var e=this.getNewTreeNode(this.nodes),n=e[0].parent,i=this.getNewTreeNode(this.target),r=l.ProductFraction.is_fraction_with_identity_numerator(n)&&1===this.nodes.length;o.Tree.remove_range(e),e.forEach(function(t){t.invert()});var s=this.groupNonFractionRanges(e),a=this.replaceTargetWithProductContainingTargetAndTerms(i,s,this.settings.side);if(s.forEach(function(t){l.ProductFraction.convert_to_reciprocal(t.children[1])}),this.cleanup_cascade(n),r){var u=this.mapNodes(this.nodes[0].parent.children[0])[0];u&&(u.simplify=!0)}for(;a.parent.is_group("sign","plusminus");){var c=a.parent;c.replace_with(a);var d=a.get_child([0,1]);d.replace_with(c),c.append(d)}if(this.cleanup(a.parent),this.setNodesToReselectAfterAction(s),"function"!=typeof t)return this;t(this)},u.prototype.groupNonFractionRanges=function(t){if(1===t.length)return t;if(2===t.length&&t.some(function(t){return l.ProductFraction.is_fraction(t.children[1])}))return t;for(var e=[],n=[],i=[],r=0;r<t.length;r++){var o=t[r];l.ProductFraction.is_fraction(o.children[1])||l.Num.is_equal_to(o.children[1],1,-1)?(i.length&&n.push(i),n.push([o]),i=[]):i.push(o)}for(i.length&&n.push(i),r=0;r<n.length;r++){var s=n[r];if(s.length>1){var a=new l.MulDiv(new l.ProductFraction);s.forEach(function(t){a.children[1].append(t)}),e.push(a)}else e.push(s[0])}return e},u.prototype.replaceTargetWithProductContainingTargetAndTerms=function(t,e,n){var i=new l.ProductFraction,r=t.is_group("mul")?t.children[1]:t;return r.replace_with(i),i.append(new l.MulDiv(r)),e.forEach(function(t,e){"right-of"===n?i.append(t):i.insert(e,t)}),i},(0,a.default)(u,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AssociateOutOfFractionAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"AssociateOutOfFractionAction","associative property of multiplication--move out of fraction"),this.priority=-2,this.triggerType="drag",this.settings={margin:{y:.5}},t&&(this.setActorAndTarget(t),this.settings.side=Array.isArray(this.target)?"around":t.side,this.settings.target_is_left="left-of"===t.side,this.settings.margin["right-of"===t.side?"x2":"x1"]=-1,this.settings.margin["right-of"===t.side?"x1":"x2"]=.2)}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){if(0===t.length)return[];var e=t[0];return e.is_group("mul")&&e.parent.is_group("fraction")&&this.match(t,e.parent)?[this.bindAction(t,"left-of"),this.bindAction(t,"right-of")]:[]},u.prototype.bindAction=function(t,e){var n=t[0].get_root(),i=[];return this.fractionIsPartOfProduct(t)&&(i=this.getSiblingsOfFraction(t,e)),this.createBoundAction(n,{nodes:t,target:i.length>0?i:t[0].parent,side:e})},u.prototype.fractionIsPartOfProduct=function(t){var e=t[0].parent;return e.parent&&e.parent.is_group("mul")},u.prototype.getSiblingsOfFraction=function(t,e){var n=t[0].parent.parent,i=n.parent;return"left-of"===e?i.children.slice(0,i.children.indexOf(n)):i.children.slice(i.children.indexOf(n)+1)},u.prototype.match=function(t,e){return!(0===t.length||!t[0]||t[0].parent!==e||!e.is_group("fraction")||1===t.length&&1===t[0].children[1].value&&1===e.get_top().length||!this.allNodesAreMuls(t)||!o.Tree.is_range(t))},u.prototype.allNodesAreMuls=function(t){for(var e=0;e<t.length;e++)if(!t[e].is_group("mul"))return!1;return!0},u.prototype.transform=function(t){var e=this.getNewTreeNode(this.nodes),n=e[0].parent,i=this.settings.target_is_left;o.Tree.remove_range(e);var r=new l.ProductFraction;for(n.replace_with(r),r.append(new l.MulDiv(n)),r.insert_range(i?0:1,e);r.parent.is_group("sign","plusminus");){var s=r.parent;s.replace_with(r);var a=r.get_child([0,1]);a.replace_with(s),s.append(a)}if(this.cleanup(n),this.cleanup(r.parent),"function"!=typeof t)return!0;t(this)},(0,a.default)(u,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AssociateIntoFractionAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),s=n(1),a=n(2),l=(i=n(4))&&i.__esModule?i:{default:i},u=n(3),c=e.AssociateIntoFractionAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"AssociateIntoFractionAction","associative property of multiplication--move into fraction"));if(n.priority=0,n.triggerType="tap",n.settings={no_target_box_expansion:!0},t){var i={node:t.target?u.ProductFraction.get_whole_range(t.target):null,side:"around",margin:{y2:.25,x:-.1}};n.initSettings(o.gmath.extend(t,{drop_area:i,drop_area_hint:{margin:{y2:.1,x:-.1}}}))}return n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.Action),r(e,[{key:"getAllAvailableActions",value:function(t){var e=this,n=function(t){return!!s.Tree.is_range(t)&&!!t[0].is_group("mul","div")&&{nodes:t,type:t[0].value}}(t);if(!n)return[];var i=function(t){return u.Group.get_siblings(t.nodes).filter(function(e){return e.is_group(t.type)&&d(e)}).map(function(t){return d(t).get_top()})}(n);return o.gmath.array.flatten(i.map(function(n){return e.bindActionForEachTarget(t,n,!0)}))}},{key:"match",value:function(t){return!!t.is_group("mul","div")&&t.ls&&t.ls.value===t.value&&(d(t)||d(t.ls))}},{key:"transform",value:function(t){var e=void 0,n=void 0;if(this.nodes)e=this.nodes,n=this.target;else{this.settings.side=d(this.actor)?"left-of":"right-of",e="left-of"===this.settings.side?[this.actor.ls]:[this.actor];var i=("left-of"===this.settings.side?d(this.actor):d(this.actor.ls)).get_top();n="left-of"===this.settings.side?i[0]:i[i.length-1]}this.addTouchedNodes(e),this.addTouchedNodes(n);var r=this.getNewTreeNode(e),o=r[0].parent,a=this.getNewTreeNode(n),l=a.parent,c=l.children.indexOf(a);if("right-of"===this.settings.side&&c++,1===l.get_top().length&&1===u.Num.get_value(l.get_child([0,1]))&&(l.get_child([0]).simplify=!0),s.Tree.remove_range(r),r[0].is_group("div")&&r.forEach(function(t){t.invert()}),l.insert_range(c,r),this.cleanup(o),"function"!=typeof t)return!0;t(this)}}]),e}();function d(t){for(var e=t.children[1];e.is_group("sign","plusminus");)e=e.children[1];return!!e.is_group("fraction")&&e}(0,l.default)(c,!0,u.MulDiv)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AssociateIdentityIntoDenominatorAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){if(s.Action.call(this,"AssociateIdentityIntoDenominatorAction","associative property of multiplication--move into fraction"),this.priority=2,this.triggerType="drag",this.settings={no_target_box_expansion:!0},t){var e={side:"around",margin:{y1:.25,x:-.1}};t.target&&(t.target.parent.is_group("fraction")?e.node=l.ProductFraction.get_whole_range(t.target):e.node=t.target),this.initSettings(r.gmath.extend(t,{drop_area:e,drop_area_hint:{margin:{y1:.1,x:-.1}}}))}}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){if(!t.length)return[];var e=[];if(!o.Tree.is_range(t))return[];var n=t[0].value;if("mul"!==n&&"div"!==n)return[];if(!t.every(function(t){return t.is_group(n)&&(-1===l.Num.get_value(t.children[1])||1===l.Num.get_value(t.children[1]))}))return[];var i=t[0].parent,r=t[0].parent.children.indexOf(t[0]),s=t[0].parent.children.indexOf(t[t.length-1]);return i.children.forEach(function(i,o){(o<r||o>s)&&i.value===n&&i.children[1].is_group("fraction")&&(e=e.concat(this.bindActionForEachTarget(t,i.get_child([1]).get_bottom(),!0)))},this),e},u.prototype.transform=function(t){this.nodes.forEach(function(t){this.addTouchedNodes(t)},this),this.addTouchedNodes(this.target.parent);var e=this.getNewTreeNode(this.nodes),n=e[0].parent,i=this.getNewTreeNode(this.target),r=i.parent,s=r.children.indexOf(i);if("right-of"===this.settings.side&&s++,o.Tree.remove_range(e),e.forEach(function(t){t.is_group("mul")&&t.invert()}),r.insert_range(s,e),this.cleanup(r),this.cleanup(n),"function"!=typeof t)return!0;t(this)},(0,a.default)(u,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddSubResolveCasesAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(n(0),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3),l=e.AddSubResolveCasesAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"AddSubResolveCasesAction","resolve the cases for a plus-minus"));return n.priority=0,n.triggerType="dbltap",n.elements=[],n.settings={makes_no_changes:!0},t&&(n.settings.positive_case=t.positive_case,n.initSettings(t)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),r(e,[{key:"match",value:function(t){return t.is_group("plusminus","addsub")}},{key:"rebind",value:function(t,e,n){if(this.oldTree!==n)throw"wrong old tree during rebinding an action!";var i=new o.Action;i.node_map=e,this.oldTree=t,this.actor&&(this.actor=i.mapNodes(this.actor)[0]),this.nodes&&(this.nodes=i.mapNodes(this.nodes))}},{key:"rematch",value:function(){return this.match(this.actor||this.nodes[0])}},{key:"transform",value:function(t){return this.target&&"AlgebraModel"===this.target.type?this.transform_update(t):this.transform_initial(t)}},{key:"transform_initial",value:function(t){var e=this.getSourceAndTarget();this.addTouchedNodes(e.source),this.node_map={};var n=this.transform_case(this.oldTree.clone(),!1),i=this.createBoundAction(this.oldTree,{nodes:[e.source],target:n,positive_case:!1});i.node_map=this.node_map,this.node_map={};var r=this.transform_case(this.oldTree.clone(),!0),o=this.createBoundAction(this.oldTree,{nodes:[e.source],target:r,positive_case:!0});return o.node_map=this.node_map,this.node_map={},this.elements.push({type:"derivation",model:r,action:o}),this.elements.push({type:"textbox",text:"or"}),this.elements.push({type:"derivation",model:n,action:i}),"function"==typeof t&&t(this),!0}},{key:"transform_update",value:function(t){return this.node_map={},this.transform_case(this.newTree,this.settings.positive_case),this.target=this.newTree,"function"==typeof t&&t(this),!0}},{key:"transform_case",value:function(t,e){this.extendNodeMap(this.oldTree.get_mapping_to(t));var n=t.get_child((this.actor||this.nodes[0]).get_path()),i=n.children[1],r=void 0;return n.is_group("addsub")?r=e?new a.AddSub(i,"add"):new a.AddSub(i,"sub"):n.is_group("plusminus")&&(r=e?i:new a.Sign(i)),n.replace_with(r),t}}]),e}();(0,s.default)(l,!1,a.Sign,a.AddSub)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddVariablesAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"AddVariablesAction","add variables"),this.priority=1,this.triggerType="tap",this.settings={is_join_action:!0,delay:300,side:"inside"},t&&("drag"===t.triggerType?(this.triggerType=t.triggerType,this.nodes=t.nodes,this.target=t.target):this.actor=t.actor)}function c(t){return t.map(function(t){return t.to_ascii({normalizeSynonymsForFunctionLabels:!0})}).join("")}function d(t){return t.is_group()&&t.commutative&&t.associative}function h(t){if(0===t.length)return"";var e=t.map(function(t){return t.to_ascii({normalizeSynonymsForFunctionLabels:!0})}).join("");return d(t[0])?e.substring(t[0].children[0].to_ascii({normalizeSynonymsForFunctionLabels:!0}).length):e}function p(t){return function(e){return!(0===e.length||!e[0].parent||e[0].parent.parent&&function(t){return t.length===t[0].parent.children.length}(e)||c(e)!==t&&function(t){if(0===t.length)return"";var e=t.map(function(t){return t.to_ascii({normalizeSynonymsForFunctionLabels:!0})}).join("");return 1===t.length?e:d(t[0])?e.substring(t[0].children[0].to_ascii({normalizeSynonymsForFunctionLabels:!0}).length):e}(e)!==t)}}function f(t){return function(e){return!(!e.parent||!e.parent.is_group("add")&&!e.parent.is_group("sub")||e.to_ascii({normalizeSynonymsForFunctionLabels:!0})!==t&&function(t){return t.is_group("product")&&t.children[0].children[1].is_group("sign")?t.children[0].children[1].children[1].to_ascii({normalizeSynonymsForFunctionLabels:!0})+t.children.slice(1).map(function(t){return t.to_ascii({normalizeSynonymsForFunctionLabels:!0})}).join(""):""}(e)!==t)}}function g(t){var e=t.parent;return function(n){var i,r;try{if(Array.isArray(n)?(i=o.Tree.get_parent(3,n[0]),r=o.Tree.get_parent(2,n[0])):(i=o.Tree.get_parent(2,n),r=o.Tree.get_parent(1,n)),!e.is_group("sum")||!i.is_group("sum")||e!==i||r===t)return!1}catch(t){if("invalid path"===t)return!1;throw t}return!0}}function m(t){return function(t){if(!Array.isArray(t))return!0;var e=t[0].parent;if(e.children.length!==t.length+1)return!1;for(var n=0;n<e.children.length;n++){var i=e.children[n];if(-1===t.indexOf(i)&&!l.Num.is_num(i.children[1]))return!1}return!0}}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){if(t.length>1)return[];var e=t[0];if(!e.is_group("add","sub"))return[];var n=e.parent,i=this.analyzeAddendStructure(e);if(Array.isArray(i.range)&&i.range.length<1)return[];var r,s=this.prepareRangeForSearch(i.range);return s.length<1?[]:(r=(r=(r=(r=o.Tree.filterRange(p(c(s)),n)).concat(o.Tree.filter(f(h(s)),n))).filter(g(e))).filter(m()),this.bindActionForEachTarget(t,r))},u.prototype.match=function(t){if(!t.ls)return!1;var e=t;if(!e.is_group("add","sub"))return!1;var n=this.analyzeAddendStructure(e);if(Array.isArray(n.range)&&n.range.length<1)return!1;var i,r=this.prepareRangeForSearch(n.range);return!(r.length<1)&&1===(i=(i=o.Tree.filterRange(p(c(r)),e.ls)).concat(o.Tree.filter(f(h(r)),e.ls))).length&&1===(i=(i=i.filter(g(e))).filter(m())).length},u.prototype.prepareRangeForSearch=function(t){return Array.isArray(t)?t:[new l.MulDiv(o.Tree.clone(t))]},u.prototype.analyzeAddendStructure=function(t){var e=t.children[1];return e.is_group("product")?this.analyzeProductStructure(e):l.Num.is_num(e)?{range:[]}:{range:e,coefficientLocation:"none"}},u.prototype.analyzeProductStructure=function(t){var e,n,i,r=[t.children[0].children[1],t.children[t.children.length-1].children[1]];if(l.Num.is_num(r[0])&&l.Num.is_num(r[1]))return{range:[]};"none"==(e=l.Num.is_num(r[0])||l.Num.is_num(r[1])?l.Num.is_num(r[0])?"front":"back":"none")?(n=0,i=t.children.length):"front"===e?(n=1,i=t.children.length):(n=0,i=t.children.length-1);for(var o=[],s=n;s<i;s++){var a=t.children[s].children[1];if(l.Num.is_num(a))return{range:[]};o.push(a.parent)}return{range:o,coefficientLocation:e}},u.prototype.bindActionForEachTarget=function(t,e){for(var n=[],i=t[0].get_root(),r=0;r<e.length;r++){var o={triggerType:"drag"};o.nodes=t;var s=e[r];Array.isArray(s)?(o.target=s[0].parent.parent,o.range=s):o.target=s.parent,n.push(this.createBoundAction(i,o))}return n},u.prototype.transform=function(t){"drag"===this.triggerType?(this.sourceAddend=this.nodes[0],this.targetAddend=this.target):(this.sourceAddend=this.actor,this.targetAddend=this.actor.ls),this.addTouchedNodes(this.sourceAddend),this.addTouchedNodes(this.targetAddend);var e=this.analyzeAddendStructure(this.sourceAddend),n=this.analyzeAddendStructure(this.targetAddend);e.addend=this.sourceAddend,n.addend=this.targetAddend;var i=this.getNewTreeNode(this.sourceAddend),r=this.getNewTreeNode(this.targetAddend),o=i.parent,s=i.children[1],a=r.children[1];"none"===e.coefficientLocation&&(s=this.reinterpretTermAsProductWithCoefficientOfOne(s)),"none"===n.coefficientLocation&&(a=this.reinterpretTermAsProductWithCoefficientOfOne(a)),0===r.parent.children.indexOf(r)&&"none"===n.coefficientLocation&&a.children[1].children[1].is_group("sign")&&this.absorbNegativeIntoAddend(r);var u=this.splitProduct(s),c=this.splitProduct(a),d=u.coefficient*(i.is_group("sub")?-1:1)+c.coefficient*(r.is_group("sub")?-1:1),h=l.MulDiv.prototype.createParentGroup();h.append(new l.MulDiv(new l.Num(Math.abs(d)))),h.append_range(u.variables);var p=d<0?new l.AddSub(h,"sub"):new l.AddSub(h,"add"),f=r.remove();o.insert(f,p),i.remove();var g={parentOfSum:p.parent.parent,idxOfSum:p.parent.get_idx(),resultingAddend:p,idxOfResultingAddend:p.get_idx(),resultingProduct:h};return 1===Math.abs(d)&&(h.children[0].simplify=!0),h.simplify=!0,this.mapOldStructureToNewStructure(e,g),this.mapOldStructureToNewStructure(n,g),this.cleanup_cascade(p.parent),"function"==typeof t&&t(this),!0},u.prototype.reinterpretTermAsProductWithCoefficientOfOne=function(t){if(t.is_group("product"))return t.insert(0,new l.MulDiv(new l.Num(1))),t;var e=t.parent;t.remove();var n=l.MulDiv.prototype.createParentGroup();return n.append(new l.MulDiv(new l.Num(1))),n.append(new l.MulDiv(t)),e.append(n),n},u.prototype.splitProduct=function(t){var e=this.findIndexOfCoefficient(t);return{coefficient:l.Num.get_value(t.children[e].children[1]),variables:0===e?o.Tree.clone(t.children.slice(1)):o.Tree.clone(t.children.slice(0,e))}},u.prototype.findIndexOfCoefficient=function(t){for(var e=t.children,n=0;n<e.length;n++)if(l.Num.is_num(e[n].children[1]))return n},u.prototype.absorbNegativeIntoAddend=function(t){var e=t.children[1].children[1].children[1],n=e.parent,i=e.remove(),r=e.children[1];r.remove(),n.insert(i,r),t.invert()},u.prototype.mapOldStructureToNewStructure=function(t,e){var n,i=e.parentOfSum.children[e.idxOfSum];if(n=i.is_group("sum")?i.children[e.idxOfResultingAddend]:i,l.Num.is_num(n))this.updateNodeMap(t.addend.get_mapping_to(n));else{this.mapAddendGroup(t.addend,n);var r=this.mapNegatives(t.addend,t.coefficientLocation,n);this.mapCoefficients(t.addend,t.coefficientLocation,n),this.mapVariables(t.range,n,r)}},u.prototype.mapAddendGroup=function(t,e){e.is_group("add","sub")&&(this.updateNodeMap(t,e),this.updateNodeMap(t.children[0],e.children[0]))},u.prototype.mapNegatives=function(t,e,n){if(n.is_group("add","sub","sign","product")){var i,r,o;t.is_group("sub")&&(i=t.children[0]);var s="front"===e||"none"===e&&t.children[1].children[0]?t.children[1].children[0]:t.children[1].children[t.children[1].children.length-1];if(s&&s.children[1]&&s.children[1].is_group("sign")&&(r=s.children[1].children[0],o="none"===e),!(i&&r||!i&&!r))if(n.is_group("sub")&&r)this.updateNodeMap(r,n.children[0]);else{if(n.is_group("sign"))return i&&this.updateNodeMap(i,n.children[0]),void(r&&this.updateNodeMap(r,n.children[0]));if(n.is_group("add")&&(n=n.children[1]),n.is_group("product")&&n.children[0].children[1].is_group("sign")){var a=n.children[0].children[1].children[0];return i&&this.updateNodeMap(i,a),r&&(this.updateNodeMap(r.parent,a.parent),this.updateNodeMap(r,a)),o}}}},u.prototype.mapCoefficients=function(t,e,n){var i,r,o,s;"none"!==e&&("front"===e?i=t.children[1].children[0]:"back"===e&&(i=t.children[1].children[t.children[1].children.length-1]),(r=i.children[1]).is_group("sign")&&(r=r.children[1]),n.is_group("add","sub")&&(n=n.children[1]),n.is_group("product")&&l.Num.is_num(n.children[0].children[1])&&(o=n.children[0],(s=n.children[0].children[1]).is_group("sign")&&(s=s.children[1]),this.updateNodeMap(i,o),this.updateNodeMap(r,s)))},u.prototype.mapVariables=function(t,e,n){if(e.is_group("add","sub")&&(e=e.children[1]),e.is_group("product")){var i=l.Num.is_num(e.children[0].children[1])?e.children.slice(1):e.children.slice();if(Array.isArray(t))for(var r=0;r<t.length;r++){var o=0===r&&n?t[r].children[1].children[1]:t[r].children[1],s=i[r].children[1].is_group("sign")?i[r].children[1].children[1]:i[r].children[1];this.updateNodeMap(t[r],i[r]),this.updateNodeMap(t[r].children[0],i[r].children[0]),this.updateNodeMap(o.get_mapping_to(s))}else s=i[0].children[1].is_group("sign")?i[0].children[1].children[1]:i[0].children[1],this.updateNodeMap(t.get_mapping_to(s))}else o=Array.isArray(t)?t[0]:t,this.updateNodeMap(o.get_mapping_to(e.is_group("sign")?e.children[1]:e))},u.prototype.reselectNodes=function(t){if(!t.parentOfSum.children[t.idxOfSum].is_group("sum"))if(t.parentOfSum.children[t.idxOfSum].is_group("add","sub"))this.setNodesToReselectAfterAction(t.parentOfSum.children[t.idxOfSum]);else{var e=t.resultingProduct.children;e[0].parent===t.resultingProduct?this.setNodesToReselectAfterAction(t.resultingProduct):this.setNodesToReselectAfterAction(e)}},(0,a.default)(u,!0,l.AddSub)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddSubNumbersAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"AddSubNumbersAction","add or subtract numbers"),this.priority=6,this.triggerType="tap",this.settings={is_join_action:!0,delay:300,side:"inside"},t&&this.initSettings(r.gmath.extend(t,{drop_area:{margin:{x1:.1}}}))}function u(t,e){return a.Num.is_num(t.children[1])&&!t.is_group("addsub")&&!(e&&t.is_group("sub")&&t.children[1].is_group("sign"))}r.gmath.inherit(o.Action,l),l.prototype.getAllAvailableActions=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t.length>1)return[];if(!t[0].is_group("add","sub"))return[];if(!u(t[0],n))return[];var i=this.getOtherNumberAddendsInSum(t[0],n);return this.bindActionForEachTarget(t,i)},l.prototype.getOtherNumberAddendsInSum=function(t,e){return t.parent.children.filter(function(n){return n!==t&&u(n,e)})},l.prototype.match=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!!t.parent.is_group("sum")&&!!t.ls&&u(t.ls,e)&&u(t,e)},l.prototype.rematch=function(){var t=this;return this.actor?this.match(this.actor,!1):!!(this.nodes&&this.nodes.length>0&&this.target)&&this.getAllAvailableActions(this.nodes,null,!1).some(function(e){return e.target===t.target})},l.prototype.transform=function(t){"drag"===this.triggerType?(this.sourceAddend=this.nodes[0],this.targetAddend=this.target):(this.sourceAddend=this.actor,this.targetAddend=this.actor.ls),this.addTouchedNodes(this.sourceAddend),this.addTouchedNodes(this.targetAddend);var e=this.getNewTreeNode(this.sourceAddend),n=this.getNewTreeNode(this.targetAddend),i=e.parent,r=e.children[1],o=n.children[1],s=(e.is_group("sub")?-1:1)*a.Num.get_value(r)+(n.is_group("sub")?-1:1)*a.Num.get_value(o),l=n.is_group("add")&&n.children[1].is_group("sign"),u=new a.AddSub(new a.Num(s));0===s&&(u.simplify=!0);var c=n.remove();return i.insert(c,u),e.remove(),l||this.applyInnerAction("AddSubCombineSigns",{actor:u}),this.updateNodeMap(this.sourceAddend,u),this.updateNodeMap(this.sourceAddend.children[0],u.children[0]),this.updateNodeMap(this.sourceAddend.children[1].get_mapping_to(u.children[1])),this.updateNodeMap(this.targetAddend,u),this.updateNodeMap(this.targetAddend.children[0],u.children[0]),this.updateNodeMap(this.targetAddend.children[1].get_mapping_to(u.children[1])),this.cleanup(i),"function"==typeof t&&t(this),this},(0,s.default)(l,!0,a.AddSub)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddSubLogarithmsAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){if(o.Action.call(this,"AddSubLogarithmsAction","add or subtract numbers"),this.priority=1,this.triggerType="tap",this.settings={target_group:!0,group_side:"around",delay:300,reset_y:!0,no_target_box_expansion:!0},t){var e={};t.target&&(e.drop_area_hint={side:"around"},e.destination_hint=[{node:t.target.children[1]}]),this.initSettings(r.gmath.extend(t,e))}}r.gmath.inherit(o.Action,l),l.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionsForEachTarget(t,n)},l.prototype.matchSource=function(t){if(1!==t.length)return!1;var e=t[0];if(!e.is_group("add","sub"))return!1;var n=e.children[1];return!!a.Func.Logs.is_log_func(n)&&{nodes:t,base:a.Func.Logs.get_log_base(n),group:e.parent}},l.prototype.getTargets=function(t){var e=t.base.to_ascii();return t.group.children.filter(function(n){return n!==t.nodes[0]&&a.Func.Logs.is_log_func(n.children[1])&&a.Func.Logs.get_log_base(n.children[1]).to_ascii()===e},this)},l.prototype.bindActionsForEachTarget=function(t,e){var n=[];return e.forEach(function(e){var i=e.children[1].children[1];n=n.concat(this.bindActionForEachTarget(t,[i],!0))},this),n},l.prototype.match=function(t){if(!t.is_group("add","sub"))return!1;if(!t.ls)return!1;var e=t.ls.children[1],n=t.children[1];return a.Func.Logs.is_log_func(e)&&a.Func.Logs.is_log_func(n)&&a.Func.Logs.get_log_base(e).to_ascii()==a.Func.Logs.get_log_base(n).to_ascii()},l.prototype.transform=function(t){var e=this.getSourceAndTarget();this.addTouchedNodes(e.source),this.addTouchedNodes(e.target);for(var n=this.getNewTreeNode(e.source),i=this.getNewTreeNode(e.target),r=n.parent;!i.is_group("add","sub");)i=i.parent;n.remove();var o=n.children[1],s=i.children[1],l=o.get_arg(),u=s.get_arg(),c=u.parent,d=u.remove(),h=new a.ProductFraction,p=new a.MulDiv(u,i.is_group("sub")?"div":"mul"),f=new a.MulDiv(l,n.is_group("sub")?"div":"mul");return h.append(p),h.insert("left-of"===this.settings.side?0:1,f,!0),c.insert(d,h),a.Brackets.handle(s.children[1]),i.is_group("sub")&&i.invert(),e.source.map_group_and_sym(this,i,!0),e.source.children[1].map_to_func(this,s,!0),this.setNodesToReselectAfterAction(l.is_group("product")?l.children.slice():f),this.cleanup(p),this.cleanup(f),this.cleanup(h),this.cleanup(r),"function"==typeof t&&t(this),this},(0,s.default)(l,!0,a.AddSub)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddSubTupleAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"AddSubTupleAction","add or subtract tuples"),this.priority=1,this.triggerType="tap",this.settings={is_join_action:!0,delay:300,side:"inside"},t&&(t.nodes?(this.triggerType="drag",this.nodes=t.nodes,this.target=t.target):this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.getAllAvailableActions=function(t){if(1!==t.length)return[];var e=t[0];if(!this.isTupleAddend(e))return[];var n=this.getOtherTupleAddendsInSum(e);return this.bindActionForEachTarget(t,n)},l.prototype.isTupleAddend=function(t,e){return t.is_group("add","sub")&&t.children[1].is_group("brackets")&&t.children[1].children[1].is_group("tuple")&&(!e||t.children[1].children[1].children.length===e)},l.prototype.getTupleAddendLen=function(t){return t.children[1].children[1].children.length},l.prototype.getOtherTupleAddendsInSum=function(t){var e=t.parent,n=t.children[1].children[1].children.length;return e.children.filter(function(e){return e!==t&&this.isTupleAddend(e,n)},this)},l.prototype.match=function(t){return this.isTupleAddend(t)&&t.ls&&this.isTupleAddend(t.ls,this.getTupleAddendLen(t))},l.prototype.transform=function(t){var e,n;"drag"===this.triggerType?(e=this.nodes[0],n=this.target):(e=this.actor.ls,n=this.actor),this.addTouchedNodes(e),this.addTouchedNodes(n);var i=e.get_idx()<n.get_idx(),r=this.getNewTreeNode(e),o=this.getNewTreeNode(n),s=r.parent,l=r.children[1].children[1].children.length,u=o.remove();r.remove();var c=new a.Tuple,d=new a.AddSub(c);s.insert(u,d);for(var h=0;h<l;h++){var p=new a.Sum;p.simplify=!0;var f=new a.Param(p);c.append(f),this.updateNodeMap(r.get_child([1,1,h]),f),this.updateNodeMap(o.get_child([1,1,h]),f),p.append(new a.AddSub(r.get_child([1,1,h,1]),r.value)),p.insert(i?1:0,new a.AddSub(o.get_child([1,1,h,1]),o.value)),this.applyInnerAction("AddSubCombineSigns",{actor:p.children[0]}),this.applyInnerAction("AddSubCombineSigns",{actor:p.children[1]}),this.cleanup(p.children[1]),this.cleanup(p.children[0])}return this.updateNodeMap(e,d),this.updateNodeMap(e.get_child([1]),d.get_child([1])),this.updateNodeMap(e.get_child([1,0]),d.get_child([1,0])),this.updateNodeMap(e.get_child([1,1]),d.get_child([1,1])),this.updateNodeMap(e.get_child([1,2]),d.get_child([1,2])),this.updateNodeMap(n,d),this.updateNodeMap(n.get_child([1]),d.get_child([1])),this.updateNodeMap(n.get_child([1,0]),d.get_child([1,0])),this.updateNodeMap(n.get_child([1,1]),d.get_child([1,1])),this.updateNodeMap(n.get_child([1,2]),d.get_child([1,2])),this.cleanup(s),"function"==typeof t&&t(this),this},(0,s.default)(l,!0,a.AddSub)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddSubInverseAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"AddSubInverseAction","cancel terms that are the inverse of each other"),this.priority=5,this.triggerType="tap",this.settings={side:"around",is_join_action:!0,delay:300},t&&(t.nodes?(this.triggerType="drag",this.nodes=t.nodes,this.target=t.target):this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.getAllAvailableActions=function(t){var e=this.matchSource(t);if(!e)return[];var n=this.getTargets(e);return this.bindActionForEachTarget(t,n)},l.prototype.matchSource=function(t){return 1===t.length&&!!t[0].is_group("add","sub")&&{nodes:t,group:t[0].parent}},l.prototype.getTargets=function(t){return t.group.children.filter(function(e){return e.get_idx()!==t.nodes[0].get_idx()&&this.addendsAreInverses(t.nodes[0],e)},this)},l.prototype.match=function(t){return t.is_group("add","sub")&&t.ls&&this.addendsAreInverses(t,t.ls)},l.prototype.addendsAreInverses=function(t,e){var n=this.getAddendTypeAndTermAscii(t),i=this.getAddendTypeAndTermAscii(e);if(n.ascii!==i.ascii)return!1;var r=n.num_of_signs+i.num_of_signs;return(1===r||3===r)&&!(n.num_of_brackets>2||i.num_of_brackets>2||Math.abs(n.num_of_brackets-i.num_of_brackets)>1)},l.prototype.getAddendTypeAndTermAscii=function(t){for(var e=t.is_group("add")?0:1,n=0,i=t.children[1];i.is_group("sign","brackets");)i.is_group("brackets")?n++:i.is_group("sign")&&e++,i=i.children[1];return{num_of_signs:e,num_of_brackets:n,ascii:i.is_group("product")&&i.get_child([0,1]).is_group("sign")?i.to_ascii().slice(1):i.to_ascii()}},l.prototype.transform=function(t){var e=this.getSourceAndTarget();this.addTouchedNodes(e.source),this.addTouchedNodes(e.target);var n=this.getNewTreeNode(e.source),i=this.getNewTreeNode(e.target);n.remove();var r=i.parent,o=i.remove(),s=new a.Num(0),l=new a.AddSub(s);return l.simplify=!0,l.do_not_map_on_simplify=!0,r.insert(o,l),this.updateNodeMap(e.source,l),this.updateNodeMap(e.target,l),this.updateNodeMap(e.source.children[0],s),this.updateNodeMap(e.target.children[0],s),this.updateNodeMap(e.source.children[1].get_mapping_to(s)),this.updateNodeMap(e.target.children[1].get_mapping_to(s)),this.cleanup_cascade(r),"function"==typeof t&&t(this),this},(0,s.default)(l,!0,a.AddSub)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConvertAddendToFractionAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"ConvertAddendToFractionAction","convert addend to a fraction to allow adding"),this.priority=1,this.triggerType="dbltap",t&&(this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.match=function(t){if(!t)return!1;if(!t.is_group("add","sub"))return!1;if(!t.ls)return!1;var e=t.ls.children[1],n=t.children[1];return e.is_group("fraction")&&!n.is_group("fraction")||!e.is_group("fraction")&&n.is_group("fraction")},l.prototype.transform=function(t){this.addTouchedNodes(this.actor),this.addTouchedNodes(this.actor.ls);var e=this.getNewTreeNode(this.actor.ls),n=this.getNewTreeNode(this.actor),i=((e.children[1].is_group("fraction")?e:n).children[1],(e.children[1].is_group("fraction")?n:e).children[1]),o=i.parent;i.remove();var s=a.MulDiv.prototype.createParentGroup();if(s.append(new a.MulDiv(i)),s.append(new a.MulDiv(new a.Num(1),"div")),o.append(s),s.get_bottom()[0].simplify=!0,this.cleanup(s.get_top()[0]),this.followup=r.gmath.actions.CrossMultiplyFractionsAction.createBoundAction(this.newTree,{actor:n}),"function"!=typeof t)return!0;t(this)},(0,s.default)(l,!1,a.AddSub)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddSubCombineSigns=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"AddSubCombineSigns","combine signs in a sum"),this.triggerType="tap",this.priority=7,t&&(this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.match=function(t){return!!this.getInnerTerm(t)},l.prototype.getInnerTerm=function(t){return t.is_group("add","sub","addsub")?t.children[1].is_group("sign","plusminus")?t.children[1]:t.children[1].is_group("product")&&t.get_child([1,0,1]).is_group("sign","plusminus")?t.get_child([1,0,1]):null:null},l.prototype.rematch=function(){return this.actor.is_group("add","sub","addsub")},l.prototype.transform=function(t){var e=this.getNewTreeNode(this.actor),n=this.getInnerTerm(e),i=!1;if(n){var r=this.getOldTreeNode(n);n.is_group("plusminus")?e.setValue("addsub"):n.is_group("sign")&&e.invert(),this.updateNodeMap(r,e),this.updateNodeMap(r.children[0],e.children[0]),n.replace_with(n.children[1]),i=!0}if("function"!=typeof t)return i;t(this)},(0,s.default)(l,!1,a.AddSub)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddSubBracketsAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"AddSubBracketsAction","add or subtract a bracketed sum"),this.priority=4,this.triggerType="tap",t&&(this.actor=t.actor)}r.gmath.inherit(s.Action,u),u.prototype.match=function(t){return!(!t.is_group("add")&&!t.is_group("sub"))&&!!t.children[1].is_group("brackets")&&(t.children[1].children[1].is_group("sum")||l.Brackets.is_optional(t.children[1]))},u.prototype.transform=function(t){var e=this.getNewTreeNode(this.actor),n=this.actor.children[0];this.addTouchedNodes(this.actor);var i=e.children[1],r=e.children[1].children[1];if(o.Tree.replace(i,r),e.is_group("sub")&&r.is_group("sum")){e.invert();for(var s=[],a=0;a<r.children.length;a++)r.children[a].invert(),s.push(r.children[a].children[0]);this.updateNodeMap(n,s)}if(this.cleanup(e),"function"!=typeof t)return this;t(this)},(0,a.default)(u,!1,l.AddSub)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbsValVarPowerAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"AbsValVarPowerAction","real even powers are positive"),this.priority=4,this.triggerType="tap",this.settings={restraint:"The power base must be real."},t&&(this.actor=t.actor)}r.gmath.inherit(s.Action,u),u.prototype.match=function(t){return t.is_group("abs-val")&&t.get_child([1]).is_group("power")&&l.Var.is_var(t.get_child([1,0]))&&this.exponentIsAnEvenNumber(t.get_child([1,1,0]))},u.prototype.exponentIsAnEvenNumber=function(t){return l.Num.is_num(t)&&l.Num.get_value(t)%2==0},u.prototype.transform=function(t){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor),n=e.get_child([1]);if(o.Tree.replace(e,n),"function"!=typeof t)return!0;t(this)},(0,a.default)(u,!1,l.AbsVal)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbsValReselectGroupAction=a;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i};function a(t){o.Action.call(this,"AbsValReselectGroupAction","drag the left absolute value bar to reselect the whole group"),this.priority=2,this.triggerType="drag",this.settings={makes_no_changes:!0,no_delay:!0,update_node_positions:!0,side:"outside",margin:{y1:.4,y2:.4}},t&&(this.nodes=t.nodes,this.target=t.target)}n(3),r.gmath.inherit(o.Action,a),a.prototype.getAllAvailableActions=function(t){if(1!==t.length)return[];var e=t[0];if(!e.is_group("sym")||"|"!==e.value)return[];var n=e.get_root();return[this.createBoundAction(n,{nodes:[e],target:e})]},a.prototype.transform=function(t){return this.addTouchedNodes(this.target.parent),this.setNodesToReselectAfterAction(this.target.parent),"function"==typeof t&&t(this),this},(0,s.default)(a,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbsValNegVarAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"AbsValNegVarAction","absolute value of a negative variable"),this.priority=4,this.triggerType="tap",t&&(this.actor=t.actor)}r.gmath.inherit(s.Action,u),u.prototype.match=function(t){return!!t.match("|-\\VAR|")||!(!t.is_group("abs-val")||!this.prodFracContainingNegativeTerms(t.get_child([1])))},u.prototype.prodFracContainingNegativeTerms=function(t){return!!t.is_group("product","fraction")&&t.get_top().concat(t.get_bottom()).some(function(t){return t.get_child([1]).is_group("sign")})},u.prototype.transform=function(t){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor),n=e.match("|{neg:-{var:\\VAR}}|");if(n)o.Tree.replace(n.neg,n.var);else{var i=e.get_child([1]);i.get_top().concat(i.get_bottom()).forEach(function(t){var e=t.get_child([1]);e.is_group("sign")&&o.Tree.replace(e,e.get_child([1]))})}if("function"!=typeof t)return!0;t(this)},(0,a.default)(u,!1,l.AbsVal)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbsValInsertPosNumAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"AbsValInsertPosNumAction","move a range of positive numbers inside an absolute value group"),this.priority=4,this.triggerType="drag",this.settings={margin:{x:-.25}},t&&(this.nodes=t.nodes,this.target=t.target,this.settings.side=t.side)}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){if(!o.Tree.is_range(t))return[];if(!t[0].is_group("mul","div"))return[];if(!t.every(this.isPosNum))return[];var e=this.getOtherAbsValMulDivsInGroup(t[0]);return this.bindActionsForEachTarget(t,e)},u.prototype.isPosNum=function(t){var e=t.children[1];return e&&l.Num.is_num(e)&&l.Num.get_value(e)>=0},u.prototype.isAbsVal=function(t){return t.get_child([1]).is_group("abs-val")},u.prototype.getOtherAbsValMulDivsInGroup=function(t){var e=t.get_parent(1);return e.get_top().concat(e.get_bottom()).filter(function(e){return e.value===t.value&&this.isAbsVal(e)},this)},u.prototype.bindActionsForEachTarget=function(t,e){var n=[];return t[0].get_root(),e.forEach(function(e){var i=e.get_child([1,1]);i=i.is_group("product")?i.children.slice():[i],n=n.concat(this.bindActionForEachTarget(t,i,!0))},this),n},u.prototype.transform=function(t){this.addTouchedNodes(this.nodes),this.addTouchedNodes(this.target);var e=this.getNewTreeNode(this.nodes),n=this.getNewTreeNode(this.target),i=e[0].get_parent(1);if(o.Tree.remove_range(e),e[0].is_group("div")&&e.forEach(function(t){t.invert()}),n.is_group("mul"))n.get_parent(1).insert_range(n.get_idx()+("left-of"===this.settings.side?0:1),e);else{var r=n.get_parent(1),s=n.remove(),a=new l.ProductFraction;a.append(new l.MulDiv(n)),a.insert_range("left-of"===this.settings.side?0:1,e),r.insert(s,a)}if(this.cleanup_cascade(i),"function"!=typeof t)return!0;t(this)},(0,a.default)(u,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbsValFracSplitAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"AbsValFracSplitAction","isolating the absolute value to the numerator and denominator"),this.priority=4,this.triggerType="drag",this.settings={},t&&(this.nodes=t.nodes,this.target=t.target,this.settings.side=t.side)}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){if(!o.Tree.is_range(t))return[];var e=t[0].get_parent(1);if(!e.is_group("fraction"))return[];if(t[0].is_group("mul")&&t.length!==e.get_top().length)return[];if(t[0].is_group("div")&&t.length!==e.get_bottom().length)return[];var n=e.get_parent(1);if(!n.is_group("abs-val"))return[];var i=t[0].get_root(),r=t[0].is_group("mul")?"above":"below";return[this.createBoundAction(i,{nodes:t,target:n,side:r})]},u.prototype.transform=function(t){this.addTouchedNodes(this.nodes),this.addTouchedNodes(this.target);var e=this.getNewTreeNode(this.target),n=e.get_child([1]),i=e.get_parent(1),r=e.remove();n.remove();var s=n.get_top();o.Tree.remove_range(s);var a=new l.ProductFraction;a.append_range(s);var u=new l.AbsVal(a),c=n.get_bottom();o.Tree.remove_range(c);var d=new l.ProductFraction;c.forEach(function(t){t.invert()}),d.append_range(c);var h=new l.AbsVal(d);if(n.append(new l.MulDiv(u)),n.append(new l.MulDiv(h,"div")),i.insert(r,n),this.cleanup(a),this.cleanup(d),this.cleanup_cascade(i),"function"!=typeof t)return!0;t(this)},(0,a.default)(u,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbsValFracJoinAction=l;var i,r=n(0),o=(n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){o.Action.call(this,"AbsValFracJoinAction","combining an absolute value numerator and an absolute value denominator into an absolute valued fraction"),this.priority=4,this.triggerType="tap",this.settings={},t&&(this.actor=t.actor)}r.gmath.inherit(o.Action,l),l.prototype.match=function(t){return!(!t.is_group("fraction")||1!==t.get_top().length||!t.get_child([0,1]).is_group("abs-val")||1!==t.get_bottom().length||!t.get_child([2,1]).is_group("abs-val"))},l.prototype.transform=function(t){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor),n=e.get_child([0]),i=n.get_child([1,1]),r=e.get_child([2]),o=r.get_child([1,1]);i.remove(),o.remove(),n.get_child([1]).remove(),r.get_child([1]).remove(),n.append(i),r.append(o);var s=e.get_parent(1),l=e.remove(),u=new a.AbsVal(e);if(s.insert(l,u),this.cleanup(n),this.cleanup(r),this.cleanup_cascade(e),"function"!=typeof t)return!0;t(this)},(0,s.default)(l,!1,a.ProductFraction)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbsValExtractVarAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"AbsValExtractVarAction","pull a variable out of an absolute value"),this.priority=4,this.triggerType="drag",this.settings={margin:{}},t&&(this.nodes=t.nodes,this.target=t.target,this.settings.side=t.side,this.settings.margin["right-of"===t.side?"x2":"x1"]=-1)}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){if(!o.Tree.is_range(t))return[];if(!t[0].is_group("mul"))return[];if(!t[0].get_parent(1).is_group("product"))return[];if(!t[0].get_parent(2).is_group("abs-val"))return[];if(!t.some(function(t){return!l.Num.is_num(t.get_child([1]))}))return[];var e=t[0].get_root(),n=t[0].get_parent(2);return[this.createBoundAction(e,{nodes:t,target:n,side:"left-of"}),this.createBoundAction(e,{nodes:t,target:n,side:"right-of"})]},u.prototype.transform=function(t){this.addTouchedNodes(this.nodes),this.addTouchedNodes(this.target);var e=this.getNewTreeNode(this.target),n=this.getNewTreeNode(this.nodes),i=n[0].get_parent(1),r=e.get_parent(1),s=e.remove(),a=new l.ProductFraction,u=new l.AbsVal(new l.ProductFraction),c=u.get_child([1]),d=new l.MulDiv(u);if(a.append(new l.MulDiv(e)),"left-of"===this.settings.side?a.insert(0,d):a.append(d),o.Tree.remove_range(n),c.append_range(n),r.insert(s,a),this.cleanup(i),this.cleanup(c),this.cleanup_cascade(a.get_parent(1)),this.setNodesToReselectAfterAction(d),"function"!=typeof t)return!0;t(this)},(0,a.default)(u,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbsValExtractNumAction=u;var i,r=n(0),o=n(1),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3);function u(t){s.Action.call(this,"AbsValExtractNumAction","pull a number out of an absolute value"),this.priority=4,this.triggerType="drag",this.settings={margin:{}},t&&(this.nodes=t.nodes,this.target=t.target,this.settings.side=t.side,this.settings.margin["right-of"===t.side?"x2":"x1"]=-1)}r.gmath.inherit(s.Action,u),u.prototype.getAllAvailableActions=function(t){if(!o.Tree.is_range(t))return[];if(!t[0].is_group("mul"))return[];if(!t[0].get_parent(2).is_group("abs-val"))return[];if(!t.every(function(t){return l.Num.is_num(t.get_child([1]))}))return[];var e=t[0].get_root(),n=t[0].get_parent(2);return[this.createBoundAction(e,{nodes:t,target:n,side:"left-of"}),this.createBoundAction(e,{nodes:t,target:n,side:"right-of"})]},u.prototype.transform=function(t){this.addTouchedNodes(this.nodes),this.addTouchedNodes(this.target);var e=this.getNewTreeNode(this.target),n=this.getNewTreeNode(this.nodes),i=n[0].get_parent(1),r=e.get_parent(1),s=e.remove(),a=new l.ProductFraction;if(n.forEach(function(t){var e=t.get_child([1]);e.is_group("sign")&&e.replace_with(e.get_child([1]))}),o.Tree.remove_range(n),a.append(new l.MulDiv(e)),"left-of"===this.settings.side?a.insert_range(0,n):a.append_range(n),r.insert(s,a),this.cleanup(i),this.cleanup_cascade(a.get_parent(1)),"function"!=typeof t)return!0;t(this)},(0,a.default)(u,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbsValAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(n(0),n(1)),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3),u=e.AbsValAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"AbsValAction","evaluate absolute value"));return n.priority=4,n.triggerType="tap",t&&(n.actor=t.actor),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.Action),r(e,[{key:"match",value:function(t){return!!t.match("|±\\NUM|")||!(!t.is_group("abs-val")||!this.prodFracContainingNumbers(t.get_child([1])))}},{key:"prodFracContainingNumbers",value:function(t){return!!t.is_group("product","fraction")&&t.get_top().concat(t.get_bottom()).every(function(t){return l.Num.is_num(t.get_child([1]))})}},{key:"transform",value:function(t){var e=this.getNewTreeNode(this.actor);this.addTouchedNodes(this.actor);var n=e.match("|±{n:\\NUM}|");if(n){var i=n.n;o.Tree.replace(e,i),this.cleanup(i.parent)}else{var r=e.get_child([1]);o.Tree.replace(e,r),r.get_top().concat(r.get_bottom()).forEach(function(t){var e=t.get_child([1]);e.is_group("sign")&&o.Tree.replace(e,e.get_child([1]))}),this.cleanup(r.parent)}if("function"!=typeof t)return!0;t(this)}}]),e}();(0,a.default)(u,!1,l.AbsVal)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbsValDoubleAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(n(0),n(1)),s=n(2),a=(i=n(4))&&i.__esModule?i:{default:i},l=n(3),u=e.AbsValDoubleAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"AbsValDoubleAction","nested absolute values"));return n.priority=4,n.triggerType="tap",t&&(n.actor=t.actor),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.Action),r(e,[{key:"match",value:function(t){return t&&t.match("||±\\ANY||")}},{key:"transform",value:function(t){this.addTouchedNodes(this.actor);var e=this.getNewTreeNode(this.actor),n=e.match("|{n:|±\\ANY|}|").n;return o.Tree.replace(e,n),"function"==typeof t&&t(this),!0}}]),e}();(0,a.default)(u,!1,l.AbsVal)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbsValCreateNegativeAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(n(0),n(1),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3),l=e.AbsValCreateNegativeAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"AbsValCreateNegativeAction","drag the absolute value bar to the left to produce a negative sign"));return n.priority=1,n.triggerType="drag",n.settings={delay:1e3,side:"left-of"},t&&(n.nodes=t.nodes,n.target=t.target),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),r(e,[{key:"getAllAvailableActions",value:function(t){return 1!==t.length?[]:t[0]instanceof a.Sym&&"|"===t[0].to_ascii()?this.absValTermIsNegative(t[0].get_parent(1).get_child([1]))?[]:this.bindActionForEachTarget(t,t):[]}},{key:"absValTermIsNegative",value:function(t){return!!(a.Num.is_num(t)&&a.Num.get_value(t)<0)||!!t.is_group("sign")||!(!t.is_group("product")||!t.get_child([0,1]).is_group("sign"))}},{key:"transform",value:function(t){this.addTouchedNodes(this.target.parent);var e=this.getNewTreeNode(this.target.parent),n=e.get_child([1]);if(n.is_group("product")){var i=n.get_child([0]),r=i.get_child([1]),o=r.remove();i.insert(o,new a.Sign(r))}else n.remove(),e.insert(1,new a.Sign(n));return this.setNodesToReselectAfterAction(e),"function"==typeof t&&t(this),this}}]),e}();(0,s.default)(l,!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbsValCombineAction=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=(n(0),n(2)),s=(i=n(4))&&i.__esModule?i:{default:i},a=n(3);function l(t){var e=t.get_child([1,1]);return e.remove(),new a.MulDiv(e)}var u=e.AbsValCombineAction=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"AbsValCombineAction","combine two absolute value terms into one"));return n.priority=4,n.triggerType="tap",n.settings={delay:300,side:"inside"},t&&(t.actor?n.actor=t.actor:(n.triggerType="drag",n.nodes=t.nodes,n.target=t.target)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Action),r(e,[{key:"getAllAvailableActions",value:function(t){if(1!==t.length)return[];if(!t[0].is_group("mul","div")||!t[0].get_child([1]).is_group("abs-val"))return[];var e,n,i=(n=(e=t[0]).get_parent(1)).get_top().concat(n.get_bottom()).filter(function(t){return t!==e&&t.value===e.value&&t.get_child([1]).is_group("abs-val")});return this.bindActionForEachTarget(t,i)}},{key:"match",value:function(t){return!(!t.ls||t.ls.value!==t.value)&&t.ls.get_child([1]).is_group("abs-val")&&t.get_child([1]).is_group("abs-val")}},{key:"transform",value:function(t){this.addTouchedNodes(this.nodes||this.actor),this.target&&this.addTouchedNodes(this.target);var e=this.getNewTreeNode(this.nodes||this.actor),n=this.getNewTreeNode(this.target||this.actor.ls);Array.isArray(e)&&(e=e[0]);var i=this.getOldTreeNode(e),r=this.getOldTreeNode(n),o=e.get_idx()<n.get_idx(),s=e.get_parent(1);e.remove();var u=n.remove(),c=l(e),d=l(n),h=new a.ProductFraction;h.append(d),o?h.insert(0,c):h.append(c);var p=new a.AbsVal(h),f=new a.MulDiv(p,i.value);return this.mapOpAndSym(i,f),this.mapBars(i.get_child([1]),p),this.mapOpAndSym(r,f),this.mapBars(r.get_child([1]),p),s.insert(u,f),this.setNodesToReselectAfterAction(c.children[1].is_group("product")?c.children[1].children:c),this.cleanup(c),this.cleanup(d),this.cleanup_cascade(s),"function"==typeof t&&t(this),!0}},{key:"mapOpAndSym",value:function(t,e){this.updateNodeMap(t,e),this.updateNodeMap(t.get_child([1]),e.get_child([1]))}},{key:"mapBars",value:function(t,e){this.updateNodeMap(t.get_child([0]),e.get_child([0])),this.updateNodeMap(t.get_child([2]),e.get_child([2]))}}]),e}();(0,s.default)(u,!0,a.MulDiv)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Action=e.InequalityRewriteAction=e.FractionRewriteAction=e.FirstLineRewriteAction=e.ExpressionRewriteAction=e.EquationRewriteAction=e.CombinationRewriteAction=e.DirectSubstitutionAction=e.SplitExponentsAction=e.SignZeroAction=e.MoveSignIntoBracketsAction=e.SignInEvenPowerAction=e.SignDoubleNegAction=void 0,e.showRoundedAction=e.ScaleTupleAction=e.RadicalSplitAction=e.RadicalInsertExponentAction=e.RadicalExtractExponentAction=e.RootEvaluateAction=e.RelationOfAbsValAction=e.ReorderSumInFractionDenominatorAction=e.CrossMultiplyFractionsAction=e.AddFractionsAction=e.xToZeroAction=e.CombineStackedExponentsUpAction=e.PolynomialExpansionAction=e.FactorPowerAction=e.PowerFactorAndCombineStackedExponentsAction=e.DistributePowerAction=e.CollectExponentsForFactoring=e.CalculatePowerAction=e.PostInteractionSimplificationAction=e.PlusMinusInProductAction=e.MulDivRadicalsAction=e.MultiplyPowersAction=e.MultiplyNumbersAction=e.NegationAction=e.MultiplyFractionsAction=e.MulDivLogarithmsAction=e.MulDivInvertAction=e.LogarithmSplitAction=e.LogSimplifyAction=e.LogSimplifyPowerAction=e.LogarithmInvertAction=e.LogarithmExtractExponentOfArgumentAction=e.LogarithmEvaluateAction=e.LogarithmEvaluateSameArgAsBaseAction=e.InvertedFunctionCancelAction=e.IndexSimplifyAction=e.IndexInvertAction=e.IndexIdentityAction=e.IndexFormConversionAction=e.ImaginarySqrtOfNegativeOneAction=e.ImaginaryEvaluateIntegerPowerAction=e.ImaginaryAssociateOutOfSqrtAction=e.ImaginaryAssociateNegOneOutOfSqrtAction=e.SplitNumeratorAction=e.FractionMoveOuterNested=e.FractionMoveInnerNested=e.FractionMatchExtendAction=e.FractionDivideToNonInteger=e.FractionDivideToInteger=e.DivideRationalNumbersAction=e.FractionDistributeDenominatorAction=e.FractionCancelRangeAction=e.FractionCancelTermsAction=e.FractionCancelPowersAction=e.FractionAbsorbTermAction=e.FlipTermAction=e.FlipTermAcrossFractionAction=e.GreatestCommonFactorAction=e.FactorCommonTermsAction=e.EvalTrigAction=e.SwitchAction=e.EqInvertAndCommuteTermAction=e.flipEquationAction=e.CommuteAction=e.DragSplitNegativesAction=e.DragNegativeSymReselectGroupAction=e.DistributePolynomialsAction=e.DistributeIntoBracketsAction=e.CloneAction=e.RemoveBracketsAction=e.BreakingBracketsOutAction=e.BreakingBracketsInAction=e.AssociateIntoDenominatorAction=e.AssociateOutOfDenominatorAction=e.AssociateOutOfFractionAction=e.AssociateIntoFractionAction=e.AssociateIdentityIntoDenominatorAction=e.ApplyFormulaAction=e.AddSubResolveCasesAction=e.AddVariablesAction=e.AddSubNumbersAction=e.AddSubLogarithmsAction=e.AddSubTupleAction=e.AddSubInvertAction=e.AddSubInverseAction=e.ConvertAddendToFractionAction=e.AddSubCombineSigns=e.AddSubBracketsAction=e.AbsValVarPowerAction=e.AbsValReselectGroupAction=e.AbsValNegVarAction=e.AbsValInsertPosNumAction=e.AbsValFracSplitAction=e.AbsValFracJoinAction=e.AbsValExtractVarAction=e.AbsValExtractNumAction=e.AbsValAction=e.AbsValDoubleAction=e.AbsValCreateNegativeAction=e.AbsValCombineAction=void 0;var i=n(354);Object.defineProperty(e,"AbsValCombineAction",{enumerable:!0,get:function(){return i.AbsValCombineAction}});var r=n(353);Object.defineProperty(e,"AbsValCreateNegativeAction",{enumerable:!0,get:function(){return r.AbsValCreateNegativeAction}});var o=n(352);Object.defineProperty(e,"AbsValDoubleAction",{enumerable:!0,get:function(){return o.AbsValDoubleAction}});var s=n(351);Object.defineProperty(e,"AbsValAction",{enumerable:!0,get:function(){return s.AbsValAction}});var a=n(350);Object.defineProperty(e,"AbsValExtractNumAction",{enumerable:!0,get:function(){return a.AbsValExtractNumAction}});var l=n(349);Object.defineProperty(e,"AbsValExtractVarAction",{enumerable:!0,get:function(){return l.AbsValExtractVarAction}});var u=n(348);Object.defineProperty(e,"AbsValFracJoinAction",{enumerable:!0,get:function(){return u.AbsValFracJoinAction}});var c=n(347);Object.defineProperty(e,"AbsValFracSplitAction",{enumerable:!0,get:function(){return c.AbsValFracSplitAction}});var d=n(346);Object.defineProperty(e,"AbsValInsertPosNumAction",{enumerable:!0,get:function(){return d.AbsValInsertPosNumAction}});var h=n(345);Object.defineProperty(e,"AbsValNegVarAction",{enumerable:!0,get:function(){return h.AbsValNegVarAction}});var p=n(344);Object.defineProperty(e,"AbsValReselectGroupAction",{enumerable:!0,get:function(){return p.AbsValReselectGroupAction}});var f=n(343);Object.defineProperty(e,"AbsValVarPowerAction",{enumerable:!0,get:function(){return f.AbsValVarPowerAction}});var g=n(342);Object.defineProperty(e,"AddSubBracketsAction",{enumerable:!0,get:function(){return g.AddSubBracketsAction}});var m=n(341);Object.defineProperty(e,"AddSubCombineSigns",{enumerable:!0,get:function(){return m.AddSubCombineSigns}});var v=n(340);Object.defineProperty(e,"ConvertAddendToFractionAction",{enumerable:!0,get:function(){return v.ConvertAddendToFractionAction}});var y=n(339);Object.defineProperty(e,"AddSubInverseAction",{enumerable:!0,get:function(){return y.AddSubInverseAction}});var b=n(102);Object.defineProperty(e,"AddSubInvertAction",{enumerable:!0,get:function(){return b.AddSubInvertAction}});var _=n(338);Object.defineProperty(e,"AddSubTupleAction",{enumerable:!0,get:function(){return _.AddSubTupleAction}});var x=n(337);Object.defineProperty(e,"AddSubLogarithmsAction",{enumerable:!0,get:function(){return x.AddSubLogarithmsAction}});var w=n(336);Object.defineProperty(e,"AddSubNumbersAction",{enumerable:!0,get:function(){return w.AddSubNumbersAction}});var A=n(335);Object.defineProperty(e,"AddVariablesAction",{enumerable:!0,get:function(){return A.AddVariablesAction}});var k=n(334);Object.defineProperty(e,"AddSubResolveCasesAction",{enumerable:!0,get:function(){return k.AddSubResolveCasesAction}});var T=n(41);Object.defineProperty(e,"ApplyFormulaAction",{enumerable:!0,get:function(){return T.ApplyFormulaAction}});var S=n(333);Object.defineProperty(e,"AssociateIdentityIntoDenominatorAction",{enumerable:!0,get:function(){return S.AssociateIdentityIntoDenominatorAction}});var M=n(332);Object.defineProperty(e,"AssociateIntoFractionAction",{enumerable:!0,get:function(){return M.AssociateIntoFractionAction}});var E=n(331);Object.defineProperty(e,"AssociateOutOfFractionAction",{enumerable:!0,get:function(){return E.AssociateOutOfFractionAction}});var N=n(330);Object.defineProperty(e,"AssociateOutOfDenominatorAction",{enumerable:!0,get:function(){return N.AssociateOutOfDenominatorAction}});var O=n(329);Object.defineProperty(e,"AssociateIntoDenominatorAction",{enumerable:!0,get:function(){return O.AssociateIntoDenominatorAction}});var q=n(328);Object.defineProperty(e,"BreakingBracketsInAction",{enumerable:!0,get:function(){return q.BreakingBracketsInAction}});var C=n(327);Object.defineProperty(e,"BreakingBracketsOutAction",{enumerable:!0,get:function(){return C.BreakingBracketsOutAction}});var P=n(326);Object.defineProperty(e,"RemoveBracketsAction",{enumerable:!0,get:function(){return P.RemoveBracketsAction}});var j=n(325);Object.defineProperty(e,"CloneAction",{enumerable:!0,get:function(){return j.CloneAction}});var D=n(324);Object.defineProperty(e,"DistributeIntoBracketsAction",{enumerable:!0,get:function(){return D.DistributeIntoBracketsAction}});var I=n(323);Object.defineProperty(e,"DistributePolynomialsAction",{enumerable:!0,get:function(){return I.DistributePolynomialsAction}});var F=n(322);Object.defineProperty(e,"DragNegativeSymReselectGroupAction",{enumerable:!0,get:function(){return F.DragNegativeSymReselectGroupAction}});var L=n(321);Object.defineProperty(e,"DragSplitNegativesAction",{enumerable:!0,get:function(){return L.DragSplitNegativesAction}});var z=n(320);Object.defineProperty(e,"CommuteAction",{enumerable:!0,get:function(){return z.CommuteAction}});var R=n(319);Object.defineProperty(e,"flipEquationAction",{enumerable:!0,get:function(){return R.flipEquationAction}});var B=n(318);Object.defineProperty(e,"EqInvertAndCommuteTermAction",{enumerable:!0,get:function(){return B.EqInvertAndCommuteTermAction}});var H=n(317);Object.defineProperty(e,"SwitchAction",{enumerable:!0,get:function(){return H.SwitchAction}});var G=n(316);Object.defineProperty(e,"EvalTrigAction",{enumerable:!0,get:function(){return G.EvalTrigAction}});var V=n(315);Object.defineProperty(e,"FactorCommonTermsAction",{enumerable:!0,get:function(){return V.FactorCommonTermsAction}});var U=n(314);Object.defineProperty(e,"GreatestCommonFactorAction",{enumerable:!0,get:function(){return U.GreatestCommonFactorAction}});var W=n(313);Object.defineProperty(e,"FlipTermAcrossFractionAction",{enumerable:!0,get:function(){return W.FlipTermAcrossFractionAction}});var Q=n(312);Object.defineProperty(e,"FlipTermAction",{enumerable:!0,get:function(){return Q.FlipTermAction}});var $=n(311);Object.defineProperty(e,"FractionAbsorbTermAction",{enumerable:!0,get:function(){return $.FractionAbsorbTermAction}});var K=n(310);Object.defineProperty(e,"FractionCancelPowersAction",{enumerable:!0,get:function(){return K.FractionCancelPowersAction}});var J=n(309);Object.defineProperty(e,"FractionCancelTermsAction",{enumerable:!0,get:function(){return J.FractionCancelTermsAction}});var Z=n(308);Object.defineProperty(e,"FractionCancelRangeAction",{enumerable:!0,get:function(){return Z.FractionCancelRangeAction}});var Y=n(307);Object.defineProperty(e,"FractionDistributeDenominatorAction",{enumerable:!0,get:function(){return Y.FractionDistributeDenominatorAction}});var X=n(306);Object.defineProperty(e,"DivideRationalNumbersAction",{enumerable:!0,get:function(){return X.DivideRationalNumbersAction}});var tt=n(305);Object.defineProperty(e,"FractionDivideToInteger",{enumerable:!0,get:function(){return tt.FractionDivideToInteger}});var et=n(304);Object.defineProperty(e,"FractionDivideToNonInteger",{enumerable:!0,get:function(){return et.FractionDivideToNonInteger}});var nt=n(303);Object.defineProperty(e,"FractionMatchExtendAction",{enumerable:!0,get:function(){return nt.FractionMatchExtendAction}});var it=n(302);Object.defineProperty(e,"FractionMoveInnerNested",{enumerable:!0,get:function(){return it.FractionMoveInnerNested}});var rt=n(301);Object.defineProperty(e,"FractionMoveOuterNested",{enumerable:!0,get:function(){return rt.FractionMoveOuterNested}});var ot=n(300);Object.defineProperty(e,"SplitNumeratorAction",{enumerable:!0,get:function(){return ot.SplitNumeratorAction}});var st=n(299);Object.defineProperty(e,"ImaginaryAssociateNegOneOutOfSqrtAction",{enumerable:!0,get:function(){return st.ImaginaryAssociateNegOneOutOfSqrtAction}});var at=n(298);Object.defineProperty(e,"ImaginaryAssociateOutOfSqrtAction",{enumerable:!0,get:function(){return at.ImaginaryAssociateOutOfSqrtAction}});var lt=n(297);Object.defineProperty(e,"ImaginaryEvaluateIntegerPowerAction",{enumerable:!0,get:function(){return lt.ImaginaryEvaluateIntegerPowerAction}});var ut=n(296);Object.defineProperty(e,"ImaginarySqrtOfNegativeOneAction",{enumerable:!0,get:function(){return ut.ImaginarySqrtOfNegativeOneAction}});var ct=n(295);Object.defineProperty(e,"IndexFormConversionAction",{enumerable:!0,get:function(){return ct.IndexFormConversionAction}});var dt=n(294);Object.defineProperty(e,"IndexIdentityAction",{enumerable:!0,get:function(){return dt.IndexIdentityAction}});var ht=n(293);Object.defineProperty(e,"IndexInvertAction",{enumerable:!0,get:function(){return ht.IndexInvertAction}});var pt=n(292);Object.defineProperty(e,"IndexSimplifyAction",{enumerable:!0,get:function(){return pt.IndexSimplifyAction}});var ft=n(291);Object.defineProperty(e,"InvertedFunctionCancelAction",{enumerable:!0,get:function(){return ft.InvertedFunctionCancelAction}});var gt=n(290);Object.defineProperty(e,"LogarithmEvaluateSameArgAsBaseAction",{enumerable:!0,get:function(){return gt.LogarithmEvaluateSameArgAsBaseAction}});var mt=n(289);Object.defineProperty(e,"LogarithmEvaluateAction",{enumerable:!0,get:function(){return mt.LogarithmEvaluateAction}});var vt=n(288);Object.defineProperty(e,"LogarithmExtractExponentOfArgumentAction",{enumerable:!0,get:function(){return vt.LogarithmExtractExponentOfArgumentAction}});var yt=n(287);Object.defineProperty(e,"LogarithmInvertAction",{enumerable:!0,get:function(){return yt.LogarithmInvertAction}});var bt=n(286);Object.defineProperty(e,"LogSimplifyPowerAction",{enumerable:!0,get:function(){return bt.LogSimplifyPowerAction}});var _t=n(285);Object.defineProperty(e,"LogSimplifyAction",{enumerable:!0,get:function(){return _t.LogSimplifyAction}});var xt=n(284);Object.defineProperty(e,"LogarithmSplitAction",{enumerable:!0,get:function(){return xt.LogarithmSplitAction}});var wt=n(100);Object.defineProperty(e,"MulDivInvertAction",{enumerable:!0,get:function(){return wt.MulDivInvertAction}});var At=n(283);Object.defineProperty(e,"MulDivLogarithmsAction",{enumerable:!0,get:function(){return At.MulDivLogarithmsAction}});var kt=n(282);Object.defineProperty(e,"MultiplyFractionsAction",{enumerable:!0,get:function(){return kt.MultiplyFractionsAction}});var Tt=n(281);Object.defineProperty(e,"NegationAction",{enumerable:!0,get:function(){return Tt.NegationAction}});var St=n(280);Object.defineProperty(e,"MultiplyNumbersAction",{enumerable:!0,get:function(){return St.MultiplyNumbersAction}});var Mt=n(279);Object.defineProperty(e,"MultiplyPowersAction",{enumerable:!0,get:function(){return Mt.MultiplyPowersAction}});var Et=n(278);Object.defineProperty(e,"MulDivRadicalsAction",{enumerable:!0,get:function(){return Et.MulDivRadicalsAction}});var Nt=n(277);Object.defineProperty(e,"PlusMinusInProductAction",{enumerable:!0,get:function(){return Nt.PlusMinusInProductAction}});var Ot=n(276);Object.defineProperty(e,"PostInteractionSimplificationAction",{enumerable:!0,get:function(){return Ot.PostInteractionSimplificationAction}});var qt=n(275);Object.defineProperty(e,"CalculatePowerAction",{enumerable:!0,get:function(){return qt.CalculatePowerAction}});var Ct=n(274);Object.defineProperty(e,"CollectExponentsForFactoring",{enumerable:!0,get:function(){return Ct.CollectExponentsForFactoring}});var Pt=n(273);Object.defineProperty(e,"DistributePowerAction",{enumerable:!0,get:function(){return Pt.DistributePowerAction}});var jt=n(272);Object.defineProperty(e,"PowerFactorAndCombineStackedExponentsAction",{enumerable:!0,get:function(){return jt.PowerFactorAndCombineStackedExponentsAction}});var Dt=n(271);Object.defineProperty(e,"FactorPowerAction",{enumerable:!0,get:function(){return Dt.FactorPowerAction}});var It=n(270);Object.defineProperty(e,"PolynomialExpansionAction",{enumerable:!0,get:function(){return It.PolynomialExpansionAction}});var Ft=n(269);Object.defineProperty(e,"CombineStackedExponentsUpAction",{enumerable:!0,get:function(){return Ft.CombineStackedExponentsUpAction}});var Lt=n(268);Object.defineProperty(e,"xToZeroAction",{enumerable:!0,get:function(){return Lt.xToZeroAction}});var zt=n(267);Object.defineProperty(e,"AddFractionsAction",{enumerable:!0,get:function(){return zt.AddFractionsAction}});var Rt=n(266);Object.defineProperty(e,"CrossMultiplyFractionsAction",{enumerable:!0,get:function(){return Rt.CrossMultiplyFractionsAction}});var Bt=n(265);Object.defineProperty(e,"ReorderSumInFractionDenominatorAction",{enumerable:!0,get:function(){return Bt.ReorderSumInFractionDenominatorAction}});var Ht=n(264);Object.defineProperty(e,"RelationOfAbsValAction",{enumerable:!0,get:function(){return Ht.RelationOfAbsValAction}});var Gt=n(263);Object.defineProperty(e,"RootEvaluateAction",{enumerable:!0,get:function(){return Gt.RootEvaluateAction}});var Vt=n(262);Object.defineProperty(e,"RadicalExtractExponentAction",{enumerable:!0,get:function(){return Vt.RadicalExtractExponentAction}});var Ut=n(261);Object.defineProperty(e,"RadicalInsertExponentAction",{enumerable:!0,get:function(){return Ut.RadicalInsertExponentAction}});var Wt=n(260);Object.defineProperty(e,"RadicalSplitAction",{enumerable:!0,get:function(){return Wt.RadicalSplitAction}});var Qt=n(259);Object.defineProperty(e,"ScaleTupleAction",{enumerable:!0,get:function(){return Qt.ScaleTupleAction}});var $t=n(258);Object.defineProperty(e,"showRoundedAction",{enumerable:!0,get:function(){return $t.showRoundedAction}});var Kt=n(257);Object.defineProperty(e,"SignDoubleNegAction",{enumerable:!0,get:function(){return Kt.SignDoubleNegAction}});var Jt=n(256);Object.defineProperty(e,"SignInEvenPowerAction",{enumerable:!0,get:function(){return Jt.SignInEvenPowerAction}});var Zt=n(255);Object.defineProperty(e,"MoveSignIntoBracketsAction",{enumerable:!0,get:function(){return Zt.MoveSignIntoBracketsAction}});var Yt=n(254);Object.defineProperty(e,"SignZeroAction",{enumerable:!0,get:function(){return Yt.SignZeroAction}});var Xt=n(253);Object.defineProperty(e,"SplitExponentsAction",{enumerable:!0,get:function(){return Xt.SplitExponentsAction}});var te=n(252);Object.defineProperty(e,"DirectSubstitutionAction",{enumerable:!0,get:function(){return te.DirectSubstitutionAction}});var ee=n(251);Object.defineProperty(e,"CombinationRewriteAction",{enumerable:!0,get:function(){return ee.CombinationRewriteAction}});var ne=n(250);Object.defineProperty(e,"EquationRewriteAction",{enumerable:!0,get:function(){return ne.EquationRewriteAction}});var ie=n(98);Object.defineProperty(e,"ExpressionRewriteAction",{enumerable:!0,get:function(){return ie.ExpressionRewriteAction}});var re=n(249);Object.defineProperty(e,"FirstLineRewriteAction",{enumerable:!0,get:function(){return re.FirstLineRewriteAction}});var oe=n(248);Object.defineProperty(e,"FractionRewriteAction",{enumerable:!0,get:function(){return oe.FractionRewriteAction}});var se=n(247);Object.defineProperty(e,"InequalityRewriteAction",{enumerable:!0,get:function(){return se.InequalityRewriteAction}});var ae=n(2);Object.defineProperty(e,"Action",{enumerable:!0,get:function(){return ae.Action}}),n(246),n(245),n(244),n(243),n(242),n(241)},function(t,e,n){"use strict";var i=n(0),r=n(3),o=n(15);i.gmath.rules=i.gmath.rules||{},i.gmath.rules.init_all=function(){i.gmath.rules.identity_element(r.AddSub,new o.Num(0),"AddSubIdAction"),i.gmath.rules.identity_element(r.MulDiv,new o.Num(1),"MulDivIdAction"),i.gmath.rules.zero_element(r.MulDiv,new o.Num(0),"MulDivZeroAction"),i.gmath.rules.identity_element(r.And,new r.Bool("T"),"TrueIdAction"),i.gmath.rules.zero_element(r.And,new r.Bool("F"),"FalseZeroAction"),i.gmath.rules.identity_element(r.Or,new r.Bool("F"),"FalseIdAction"),i.gmath.rules.zero_element(r.Or,new r.Bool("T"),"TrueZeroAction")},i.gmath.rules.init_all()},function(t,e,n){"use strict";var i=n(0),r=n(2),o=n(5);i.gmath.rules=i.gmath.rules||{},i.gmath.rules.zero_element=function(t,e,n){t.prototype.zero_element=e;var s=e.to_ascii(),a=s+" is the zero element of "+t.prototype.value,l=function(t){r.Action.call(this,n,a),this.triggerType="tap",this.priority=5,this.settings={delay:250,margin:{x:.1},side:"inside"},t&&("drag"===t.triggerType?(this.triggerType=t.triggerType,this.nodes=t.nodes,this.target=t.target,this.priority=1):this.actor=t.actor)};i.gmath.inherit(r.Action,l),l.prototype.isZeroElement=function(e){return e instanceof t&&e.children[1].to_ascii()==s},l.prototype.match=function(t,e){return arguments.length<2&&(e=t.ls),("mul"===t.value||t.value===e.value)&&(this.isZeroElement(t)||this.isZeroElement(e))},l.prototype.getSiblings=function(e){return e.parent.children.filter(function(n){return n!==e&&n instanceof t})},l.prototype.getAllAvailableActions=function(e){var n=[];if(1!==e.length)return n;var i=e[0];if(!(i instanceof t))return n;for(var r=this.getSiblings(i),o=i.get_root(),s=0;s<r.length;s++)this.match(i,r[s])&&n.push(this.createBoundAction(o,{nodes:e,target:r[s],triggerType:"drag"}));return n},l.prototype.transform=function(t){var e,n,i=this.nodes&&this.nodes[0]||this.actor,r=this.target||this.actor&&(this.actor.ls||this.actor.rs);this.addTouchedNodes(i),this.addTouchedNodes(r),this.isZeroElement(i)?(e=i,n=r):(e=r,n=i);var o=e.get_parent(1);if(e=this.getNewTreeNode(e),"tap"===this.triggerType?o.get_top().concat(o.get_bottom()).map(this.getNewTreeNode.bind(this)).forEach(function(t){t!==e&&t.remove()}):this.getNewTreeNode(n).remove(),(this.actor&&!this.isZeroElement(this.actor)||this.nodes&&!this.isZeroElement(this.nodes[0]))&&this.setNodesToReselectAfterAction(e.children[1]),this.cleanup_cascade(e.parent),"function"!=typeof t)return!0;t(this)};var u=new l;i.gmath.actions[n]=u,t.prototype.add_action_handler(u),o.AlgebraModel.prototype.move_actions.push(i.gmath.actions[n])}},function(t,e,n){"use strict";var i=n(0),r=n(2),o=n(5);n(3),i.gmath.rules=i.gmath.rules||{},i.gmath.rules.identity_element=function(t,e,n){t.prototype.identity_element=e;var s=e.to_ascii()+" is the identity element of "+t.prototype.value,a=e.to_ascii(),l=function(t){r.Action.call(this,n,s),this.triggerType="tap",this.priority=0,this.settings={delay:250,margin:{x:.1},side:"inside"},t&&("drag"===t.triggerType?(this.triggerType=t.triggerType,this.nodes=t.nodes,this.target=t.target):this.actor=t.actor)};i.gmath.inherit(r.Action,l),l.prototype.isIdentityElement=function(e){return e instanceof t&&e.children[1].to_ascii()==a},l.prototype.match=function(t,e){return arguments.length<2&&(e=t.ls||t.rs),"//"===e.value&&(e=e.ls),(!t.get_parent(1).is_group("fraction")||!(this.isIdentityElement(t)&&t.is_group("mul")&&e.is_group("div")||this.isIdentityElement(e)&&e.is_group("mul")&&t.is_group("div")))&&(this.isIdentityElement(t)||this.isIdentityElement(e))},l.prototype.getSiblings=function(e){return e.parent.children.filter(function(n){return n!==e&&n instanceof t})},l.prototype.getAllAvailableActions=function(e){var n=[];if(1!==e.length)return n;var i=e[0];if(!(i instanceof t))return n;for(var r=this.getSiblings(i),o=i.get_root(),s=0;s<r.length;s++)this.match(i,r[s])&&n.push(this.createBoundAction(o,{nodes:e,target:r[s],triggerType:"drag"}));return n},l.prototype.transform=function(t){var e,n,i=this.nodes&&this.nodes[0]||this.actor,r=this.target||this.actor&&(this.actor.ls||this.actor.rs);if(this.addTouchedNodes(i),this.addTouchedNodes(r),this.isIdentityElement(i)?(e=i,n=r):(e=r,n=i),n=this.getNewTreeNode(n),this.setNodesToReselectAfterAction(n),(e=this.getNewTreeNode(e)).remove(),n.parent.get_path(),this.cleanup_cascade(n.parent),"function"!=typeof t)return!0;t(this)};var u=new l;i.gmath.actions[n]=u,t.prototype.add_action_handler(u),o.AlgebraModel.prototype.move_actions.push(i.gmath.actions[n])}},function(t,e,n){"use strict";n(358),n(357),n(356)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlgebraModelLink=o;var i=n(0),r=n(21);function o(t,e,n,r){this.id=r||i.gmath.uid(),this.source=t,this.target=e,this.action=n,this.action.broken=!1,this.model_before_broken=null,this.source.events.on("change."+this.id,this.onChange.bind(this)),this.target.events.on("change."+this.id,this.onTargetChange.bind(this))}n(1),i.gmath.AlgebraModelLink=o,o.prototype.toJSON=function(){return{id:this.id,type:"AlgebraModelLink",source:this.source.id,target:this.target.id,action:this.action}},o.fromJSON=function(t,e){var n=new o(e[t.source],e[t.target],t.action,t.id);return n.id=t.id,n},o.prototype.onChange=function(t){if(t.old_model!==this.source)throw"wrong old_model";t.new_model!==t.old_model&&(this.source.events.on("change."+this.id,null),this.source=t.new_model,(0,r.linkCoordinator)().replaceNode(t.old_model,t.new_model),this.source.events.on("change."+this.id,this.onChange.bind(this)));var e=this.action.nodes,n=this.action.target,o=this.action.actor;try{if(this.action.broken)try{var s=this.model_before_broken.children[0].get_1to1_mapping_to(t.new_model.children[0],!1);this.action.rebind(t.new_model,s,t.old_model)}catch(e){return void console.log("scrubbing broke, can't reapply",this.action.name,"to",t.new_model.to_ascii())}else this.action.rebind(t.new_model,t.node_map,t.old_model);this.action.rematch()?(this.action.broken=!1,this.model_before_broken=null,this.action.run(),this.action.newTree.hide_nodes(),this.action.newTree.for_each(function(t){t.selected=!1}),this.target.replace_with(this.action.newTree)):this.brokenAction(e,n,o,t.old_model)}catch(r){console.warn("An error occurred when trying to rematch "+this.action.name),i.gmath.sendErrorReport("An error occurred when trying to rematch "+(this.action&&this.action.name)+"\n from "+(t.old_model&&t.old_model.to_ascii())+"\n to "+(t.new_model&&t.new_model.to_ascii())),this.brokenAction(e,n,o,t.old_model)}},o.prototype.brokenAction=function(t,e,n,i){this.action.nodes=t,this.action.target=e,this.action.actor=n,this.action.broken||(this.action.broken=!0,this.model_before_broken=i),console.log("scrubbing broke, can't reapply",this.action.name,"to",this.source.to_ascii())},o.prototype.onTargetChange=function(t){if(t.old_model!==this.target)throw"wrong old_model";t.new_model!==t.old_model&&(this.target.events.on("change."+this.id,null),this.target=t.new_model,(0,r.linkCoordinator)().replaceNode(t.old_model,t.new_model),this.target.events.on("change."+this.id,this.onTargetChange.bind(this)))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeEvent=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="change",this.old_model_ascii=e.old_model_ascii,this.old_model_string=e.old_model_string,this.old_model=e.model,this.new_model=e.new_model||e.model,this.node_map=e.node_map||e.action&&e.action.node_map||[],this.action=e.action,this.sel=e.sel,this.no_anim=e.no_anim,this.sender=e.sender}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SplitHandler=o;var i=n(0),r=n(1);function o(t,e){this.view=t,this.nodes=null,this.splitted=!1,this.new_state=null,this.prevDist=null,this.interaction_handler=e,this.actions=[i.gmath.actions.SplitNumberAction,i.gmath.actions.SplitProductAction,i.gmath.actions.SplitPowerAction,i.gmath.actions.SplitPowerSumAction,i.gmath.actions.RemoveBracketsAction]}o.prototype.check=function(t){return t.dist-t.dist0>15},o.prototype.start=function(t,e){return this.prevDist=null,this.nodes=e,this.nodes||[]},o.prototype.end=function(){this.node=null,this.splitted=!1},o.prototype.getBestAction=function(t,e,n){var i=n;this.actions.forEach(function(n){i&&n.priority<=i.priority||n.match(e)&&(i=n.createBoundAction(t,{actor:e}))});for(var r=e.children.length-1;r>=0;r--){var o=e.children[r],s=this.getBestAction(t,o,i);s&&(i=s)}return i},o.prototype.split=function(t,e){for(var n,i=e.length-1;i>=0;i--)n=this.getBestAction(t,e[i],n);return!!n&&(t.performAction(n),r.Tree.nodes_to_range(n.mapNodes(n.actor)))},o.prototype.update=function(t){if(this.nodes&&!(null!==this.prevDist&&t.dist-this.prevDist<=30)){var e=this.split(this.view.model,this.nodes);e&&(this.prevDist=t.dist,this.nodes=e,this.interaction_handler.highlight_nodes(this.nodes))}},i.gmath.SplitHandler=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.JoinHandler=o;var i=n(0),r=n(1);function o(t){this.view=t,this.alm=this.view.model,this.nodes=[],this.node_ids=[],this.joined=!1,this.unjoined_state=null}o.prototype.check=function(t){return t.dist-t.dist0<-15},o.prototype.start=function(t,e){return this.nodes=this.proccess_selection(e),this.node_ids=this.nodes.map(function(t){return t.id}),this.nodes},o.prototype.update=function(t){if(this.joined)t.dist>3*t.dist0/4+10&&this.unjoin();else if(!(this.nodes.length<1||t.dist>3*t.dist0/4)){var e=this.nodes[0].commutative?1:0;this.unjoined_state=r.Tree.clone(this.alm.children[0],!0),this.unjoined_state.parent=this.alm,this.joined=!0;var n=this;!function t(e){n.alm.process_operator(n.nodes[e],function(){e+1<n.nodes.length?t(e+1):n.nodes=[]})}(e)}},o.prototype.unjoin=function(){var t=this.alm;this.joined=!1,t.children[0]=this.unjoined_state,t.changed(),this.nodes=this.node_ids.map(function(e){return r.Tree.get_by_id(e,t.children)})},o.prototype.end=function(){this.nodes=[],this.node_ids=[],this.unjoined_state=null,this.joined=!1},o.prototype.proccess_selection=function(t){return 2!==t.length?t:t[0].parent.commutative&&t[1].is_group()?t[1].children.slice():t},i.gmath.JoinHandler=o},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionHandler=o;var i=n(0),r=n(1);function o(t,e){this.view=t,this.alm=this.view.model,this.interaction_handler=e,this.initial_nodes=[],this.nodes=[],this.pos0=null,this.pos=null,this.box_el=null}o.prototype.check=function(t){return t.shiftKey},o.prototype.start=function(t,e){return this.pos0=t.slice(),this.pos=t.slice(),this.initBox(),this.initial_nodes=e,e},o.prototype.update=function(t){this.pos[0]+=t.dx,this.pos[1]+=t.dy,this.updateBox();var e=this.getNodesInRect(this.pos0[0],this.pos0[1],this.pos[0],this.pos[1]);i.gmath.array.isPermutation(e,this.nodes)||(this.nodes=e,this.highlight())},o.prototype.initBox=function(){var e=t.rgb(this.view.settings.get("selection_color")),n="rgba("+e.r+", "+e.g+", "+e.b+", 0.33)";this.box_el=this.view.main.append("div").style({transform:"translate("+this.pos0[0]+"px,"+this.pos0[1]+"px)","-webkit-transform":"translate("+this.pos0[0]+"px,"+this.pos0[1]+"px)",border:"1px solid "+this.view.settings.get("selection_color"),background:n})},o.prototype.updateBox=function(){var t="translate("+Math.min(this.pos0[0],this.pos[0])+"px,"+Math.min(this.pos0[1],this.pos[1])+"px)";this.box_el.style({width:Math.abs(this.pos[0]-this.pos0[0])+"px",height:Math.abs(this.pos[1]-this.pos0[1])+"px",transform:t,"-webkit-transform":t})},o.prototype.getNodesInRect=function(t,e,n,i){var o=Math.min(t,n),s=Math.max(t,n),a=Math.min(e,i),l=Math.max(e,i);return r.Tree.get_leaf_nodes(this.view.model).filter(function(t){return!t.hidden&&t.sel_box&&o<=t.x+t.sel_box.x+t.sel_box.width&&s>=t.x+t.sel_box.x&&a<=t.y+t.sel_box.y+t.sel_box.height&&l>=t.y+t.sel_box.y})},o.prototype.updatedSelection=function(){return i.gmath.array.mergedNew(this.initial_nodes,this.nodes).filter(o.nodeIsNotFractionBar)},o.nodeIsNotFractionBar=function(t){return"//"!==t.value},o.prototype.highlight=function(){this.interaction_handler.highlight_nodes(this.updatedSelection())},o.prototype.end=function(){return this.box_el.remove(),this.updatedSelection()}}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GMLHLGMPlaceholder=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(2),o=(n(1),n(3));e.GMLHLGMPlaceholder=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"GMLHLGMPlaceholder","marks when the user crosses the equals sign"));return n.triggerType="drag",n.settings={on_release:!0,side:"inside"},t&&(n.nodes=t.nodes,n.target=t.target),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.Action),i(e,[{key:"getAllAvailableActions",value:function(t){var e=this.matchSource(t);return e?this.bindActionForEachTarget(t,this.getTargets(e)):[]}},{key:"matchSource",value:function(t){if(2!=t.length)return!1;if(t[0].rs!=t[1])return!1;if(!(t[0].squished&&t[1].squished&&t[0].crossedEq&&t[1].crossedEq))return!1;var e=t[0].parent,n=e.parent;return!!n.is_group("equals")&&{nodes:t,group:e,equals:n}}},{key:"getTargets",value:function(t){return o.Equals.getOppositeSide(t.group).children.filter(function(t){return"_"==t.children[1].value||t.children[1].is_group("placeholder")})}},{key:"transform",value:function(t){var e=this.getSourceAndTarget(!0),n=this.getNewTreeNode(e.source),i=this.getNewTreeNode(e.target);return this.applyInnerAction("AddSubInvertAction",{nodes:n,target:i,side:"right-of",target_group:!0,group_side:"around"}),this.removeDeletedNodesFromNodeMap(),n=this.mapNodes(e.source),(i=this.mapNodes(e.target))[0].remove(),this.applyInnerAction("AddSubNumbersAction",{nodes:[n[0]],target:n[1]}),"function"==typeof t&&t(this),this}}]),e}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GMLHLGMCrossEquals=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(2),o=n(3);e.GMLHLGMCrossEquals=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"GMLHLGMCrossEquals","marks when the user crosses the equals sign"));return n.triggerType="drag",n.settings={no_delay:!0,side:"around",makes_no_changes:!0,margin:{y:-2}},t&&(n.nodes=t.nodes,n.target=t.target,Object.assign(n.settings.margin,t.margin)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.Action),i(e,[{key:"getAllAvailableActions",value:function(t){var e=this.matchSource(t);if(e){var n=t[0].get_root();if(!o.Equals.getOppositeSide(e.group).filter(function(t){return t.is_group("placeholder")||"_"==t.value}))return[];var i={};return 0===e.group.get_idx()&&(i.x1=.5),[this.createBoundAction(n,{nodes:t,target:e.equals.children[1],margin:i})]}return[]}},{key:"matchSource",value:function(t){if(2!=t.length)return!1;if(t[0].rs!=t[1])return!1;if(!t[0].squished||!t[1].squished||t[0].crossedEq||t[1].crossedEq)return!1;var e=t[0].parent,n=e.parent;return!!n.is_group("equals")&&{nodes:t,group:e,equals:n}}},{key:"transform",value:function(t){var e=this.getSourceAndTarget(!0);return this.addTouchedNodes(e.source),this.addTouchedNodes(e.target),this.getNewTreeNode(e.source).forEach(function(t){t.crossedEq=!0}),"function"==typeof t&&t(this),this}}]),e}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GMLHLGMSquishAction=o;var i=n(0),r=n(2);function o(t){r.Action.call(this,"GMLHLGMSquishAction","set a flag on the nodes"),this.triggerType="drag",this.settings={makes_no_changes:!0,side:"squish",no_delay:!0},t&&(this.nodes=t.nodes,this.target=t.target)}i.gmath.inherit(r.Action,o),o.prototype.getAllAvailableActions=function(t){return 2!=t.length?[]:t.every(function(t){return t.is_group("add","sub")})?t.some(function(t){return t.squished})?[]:t[0].rs!=t[1]?[]:[this.createBoundAction(t[0].get_root(),{nodes:t,target:t[1]})]:[]},o.prototype.transform=function(t){if(this.getNewTreeNode(this.nodes).forEach(function(t){return t.squished=!0}),"function"!=typeof t)return!0;t(this)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InterDerivationHandler=s;var i=n(0),r=n(43),o=n(12);function s(t,e){this.type="InterDerivationHandler",this.interaction_handler=e,this.derivation=t.derivation,this.view=t,this.line={A:{},B:{}},this.bbox=null,this.targets=[],this.pending_ce_target,this.sub_visible=!0,this.sub_enabled=!0,this.eq_target_area_style={background:"rgba(0,0,0,0)",border:"1px dashed steelblue","border-radius":"4px"},this.eq_target_area_style_active={background:"rgba(0,0,0,0.15)"}}s.prototype.check=function(t,e){return o.MathSettings.get("substitution_on")&&1===t.fingers.length},s.prototype.start=function(t,e){return this.row=t,this.targets=this.collectTargets(),this.targets.forEach(function(t){this.initTargetVisualization(t)},this),this.initializeControlLine(e),this.sub_visible=!0,this.sub_enabled=!0,this.pending_ce_target=null,[]},s.prototype.update=function(t){return this.updateControlLine(t),this.targets.forEach(function(t){this.handleEndpointHits(t,this.targets)},this),this.pending_ce_target||this.targets.some(function(t){return t.hit_substitution_actions.length>0})},s.prototype.end=function(){var t=this;this.pending_ce_target?this.triggerEquationCombination(this.pending_ce_target):this.sub_enabled&&this.targets.forEach(function(e){e.hit_substitution_actions.length>0&&t.performSubstitution(e)}),this.eraseInfoAndCleanBoard()},s.prototype.abort=function(){this.eraseInfoAndCleanBoard()},s.prototype.enableSubstitution=function(t){this.sub_enabled!==t&&(this.sub_enabled=t,this.sub_enabled?this.showSubstitutionLines(!this.pending_ce_target):this.showSubstitutionLines(!1))},s.prototype.collectTargets=function(){var t=this.derivation.getAllDLs().slice();return i.gmath.array.remove(t,this.derivation),t.map(function(t){var e=this.getAllAvailableActions(t);return{derivation:t,view:t.getLastView(),substitution_actions:e.filter(function(t){return"SubstitutionAction"===t.name}),hit_substitution_actions:[],lines:[],combine_equations_action:e.filter(function(t){return"CombinationRewriteAction"===t.name})}},this)},s.prototype.getAllAvailableActions=function(t){var e=t.getLastModel(),n=i.gmath.actions.SubstitutionAction.getAllAvailableActions(this.view.model,e).concat(i.gmath.actions.CombinationRewriteAction.getAllAvailableActions(this.view.model,e.children[0])),o=this.derivation.getRowByView(this.view),s=this.derivation.pos.x-this.derivation.dims.x+o.pos[0],a=this.derivation.pos.y-this.derivation.dims.y+o.pos[1];return n.forEach(function(e){var n=t.getLastRow();if(this.derivation.coordinator&&t.coordinator){var i=this.derivation.coordinator.getOffset(this.derivation,t);e.settings.offset={x:t.pos.x-t.dims.x+n.pos[0]-s+i[0],y:t.pos.y-t.dims.y+n.pos[1]-a+i[1]}}else e.settings.offset={x:t.pos.x-t.dims.x+n.pos[0]-s,y:t.pos.y-t.dims.y+n.pos[1]-a}},this),r.HitTester.setTargetRegions(n,this.view.settings.get("font_size")),n},s.prototype.initTargetVisualization=function(t){this.highlightSubstitutionTargetNodes(t,!0),this.displayCombineEquationTargetArea(t,!0)},s.prototype.highlightSubstitutionTargetNodes=function(t,e){if(e){var n=t.substitution_actions.reduce(function(t,e){return t.concat(e.target)},[]);t.view.interaction_handler.highlight_nodes(n)}else t.view.interaction_handler.highlight_nodes([])},s.prototype.displayCombineEquationTargetArea=function(t,e){e&&t.combine_equations_action.length>0?this.drawCombineEquationTargetArea(t.view.main,t.combine_equations_action[0]):this.drawCombineEquationTargetArea(t.view.main,!1)},s.prototype.drawCombineEquationTargetArea=function(t,e){var n=t.selectAll(".combine_equation_target_area").data(e?[e]:[]);n.enter().append("div").classed("combine_equation_target_area",!0).style(this.eq_target_area_style),n.style("transform",function(t){return"translate("+Math.round(t.x-t.settings.offset.x)+"px,"+Math.round(t.y-t.settings.offset.y)+"px)"}).style("-webkit-transform",function(t){return"translate("+Math.round(t.x-t.settings.offset.x)+"px,"+Math.round(t.y-t.settings.offset.y)+"px)"}).style("width",function(t){return t.width+"px"}).style("height",function(t){return t.height+"px"}),n.exit().remove()},s.prototype.displayCombineEquationTargetAreaHit=function(t,e){t.view.main.selectAll(".combine_equation_target_area").transition().style(e?this.eq_target_area_style_active:this.eq_target_area_style)},s.prototype.initializeControlLine=function(t){var e=this.derivation.getRowByView(this.view).getHandlePos();this.line.A.x=e[0],this.line.A.y=e[1],this.line.B.x=t[0],this.line.B.y=t[1],this.bbox={x:this.line.B.x+10-2,y:this.line.B.y+10-2,width:4,height:4}},s.prototype.updateControlLine=function(t){this.line.B.x+=t.dx,this.line.B.y+=t.dy,this.bbox={x:this.line.B.x+10-2,y:this.line.B.y+10-2,width:4,height:4}},s.prototype.updateLineElement=function(t,e){t.attr("x1",e.A.x).attr("y1",e.A.y).attr("x2",e.B.x).attr("y2",e.B.y)},s.prototype.showSubstitutionLines=function(t){var e=this;this.sub_visible!==t&&(this.sub_visible=t,this.targets.forEach(function(n){e.highlightSubstitutionTargetNodes(n,t),e.hideLines(n,!t)}))},s.prototype.handleEndpointHits=function(t,e){var n=r.HitTester.getBestHit(t.substitution_actions,this.bbox);n?(i.gmath.array.remove(t.substitution_actions,n),t.hit_substitution_actions.push(n),this.highlightSubstitutionTargetNodes(t,!0),this.drawLine(n,t)):(n=r.HitTester.getBestHit(t.combine_equations_action,this.bbox))&&!this.pending_ce_target?(this.pending_ce_target=t,this.displayCombineEquationTargetAreaHit(t,!0),this.showSubstitutionLines(!1)):n||this.pending_ce_target!==t||(this.pending_ce_target=null,this.displayCombineEquationTargetAreaHit(t,!1),this.showSubstitutionLines(!0))},s.prototype.drawLine=function(t,e){var n={A:{x:this.line.A.x,y:this.line.A.y},B:{x:t.x,y:t.y+t.height/2}};e.lines.push(this.row.createLinkVis([n.A.x,n.A.y],[n.B.x,n.B.y],!1))},s.prototype.hideLines=function(t,e){t.lines.forEach(function(t){t.transition().style("opacity",e?.001:1)},this)},s.prototype.performSubstitution=function(t){var e=this.concatenateActionTargetsIntoOneAction(t.hit_substitution_actions);t.view.model.startInteraction(),t.view.model.performAction(e),t.view.model.finishInteraction()},s.prototype.concatenateActionTargetsIntoOneAction=function(t){return t[0].target=t.reduce(function(t,e){return t.concat(e.target)},[]),t[0]},s.prototype.triggerEquationCombination=function(t){this.displayEquationIdentities(t,!0),t.view.model.startInteraction(),t.view.interaction_handler.performAction(t.combine_equations_action[0],!1,function(){this.displayEquationIdentities(t,!1)}.bind(this))},s.prototype.displayEquationIdentities=function(t,e){e?(this.drawEquationIdentity(this.view,"E₂"),this.drawEquationIdentity(t.view,"E₁")):(this.view.main.select("#combine_equation_identifier").remove(),t.view.main.select("#combine_equation_identifier").remove())},s.prototype.drawEquationIdentity=function(t,e){var n=t.getBBox(),i="translate("+(n.x-15)+"px,"+(n.y-15)+"px)";t.main.append("div").attr("id","combine_equation_identifier").style("transform",i).style("-webkit-transform",i).style({background:"none","border-color":"steelblue","border-width":"2px","border-style":"solid",width:"40px",height:"40px","border-radius":"50%",position:"absolute",color:"steelblue","text-align":"center","vertical-align":"middle","font-size":"24px"}).text(e)},s.prototype.eraseInfoAndCleanBoard=function(){this.targets.forEach(function(t){t.lines.forEach(function(t){t.remove()}),this.highlightSubstitutionTargetNodes(t,!1),this.displayCombineEquationTargetArea(t,!1)},this),this.targets=[]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Reselector=void 0;var i=n(0),r=e.Reselector={};function o(){r.Rule.call(this,"reselect whole power",1)}i.gmath.Reselector=r,r.rules=[],r.getNewSelection=function(t){var e=this.getBestRule(t);return!!e&&e.apply(t)},r.getBestRule=function(t){for(var e=null,n=0;n<this.rules.length;n++){var i=this.rules[n];i.match(t)&&(!e||e.priority<i.priority)&&(e=i)}return e},r.hasMatchingRule=function(t){for(var e=0;e<this.rules.length;e++)if(rules[e].match(t))return!0;return!1},r.Rule=function(t,e){this.name=t,this.priority=e||0},r.Rule.prototype.match=function(t){throw"override match function!"},r.Rule.prototype.apply=function(t){throw"override apply function!"},i.gmath.inherit(o,r.Rule),o.prototype.match=function(t){if(1!==t.length)return!1;var e=t[0],n=e.parent;return!!e.is_group("exponent")&&!!n.parent.is_group("mul","div")&&n.parent.parent.children.some(function(t){if("//"===t.to_ascii())return!1;var e=t.children[1];return e!==n&&i.gmath.actions.MultiplyPowersAction.areLikeTerms(n,e)})},o.prototype.apply=function(t){return[t[0].parent.parent]},r.rules.push(new o)},function(t,e,n){"use strict";n(0).gmath.expressions.latex={registerAtParser:function(t){t.registerSymbol("\\quad").nud=function(){return t.parseExpression(0)}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbsVal=l;var i=n(1),r=n(11),o=n(9),s=n(16),a=n(22);function l(t){o.Group.call(this),t&&(i.Tree.append(this,new s.Sym("|")),i.Tree.append(this,t),i.Tree.append(this,new s.Sym("|")))}r.asOperator.call(l,"abs-val",{bp:0}),l.prototype.to_latex=function(t){return"\\left"+this.children[0].value+this.children[1].to_latex(t)+"\\right"+this.children[2].value},l.prototype.to_ascii=function(t){return t&&t.absval_as_fn?"abs("+this.children[1].to_ascii(t)+")":"|"+this.children[1].to_ascii(t)+"|"},l.registerAtParser=function(t){l.parserSymbol=t.registerSymbol("|",1),l.parserSymbol.nud=function(){var e=t.parseExpression(1);return t.advance("\\right",!0),t.advance("|"),new l(e)},l.parserSymbol.led=function(e){var n=t.parseExpression(a.MulDiv.prototype.bp,this);return a.MulDiv.createProduct(e,n)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Conjunction=a,e.Or=l;var i=n(1),r=n(11),o=n(9),s=n(16);function a(){o.Group.call(this)}function l(t){o.Group.call(this),t&&(i.Tree.append(this,new s.Sym("∨")),i.Tree.append(this,t),Brackets.handle(t))}r.asOperator.call(a,"conjunction",{bp:30}),r.asOperator.call(l,"or",{group_name:"conjunction",group_class:a,bp:20,associative:!0,commutative:!0}),l.registerAtParser=function(t){t.registerSymbol("+",l.prototype.bp).led=function(e){var n=t.parseExpression(l.prototype.bp);if(e.is_group("conjunction"))return e.append(new l(n)),e;var i=l.prototype.createParentGroup();return i.append(new l(e)),i.append(new l(n)),i}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Disjunction=l,e.And=u;var i=n(1),r=n(11),o=n(9),s=n(18),a=n(16);function l(){o.Group.call(this)}function u(t){o.Group.call(this),t&&(i.Tree.append(this,new a.Sym("∧")),i.Tree.append(this,t),s.Brackets.handle(t))}r.asOperator.call(l,"disjunction",{bp:30}),r.asOperator.call(u,"and",{group_name:"disjunction",group_class:l,bp:30,associative:!0,commutative:!0}),u.registerAtParser=function(t){t.registerSymbol("*",u.prototype.bp).led=function(e){var n=t.parseExpression(u.prototype.bp);if(e.is_group("disjunction"))return e.append(new u(n)),e;var i=u.prototype.createParentGroup();return i.append(new u(e)),i.append(new u(n)),i}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Bool=o;var i=n(0),r=n(1);function o(t){r.Tree.Node.call(this),this.value=1===t||"T"===t||"t"===t||!0===t?"T":"F",this.id=i.gmath.uid()}i.gmath.inherit(r.Tree.Node,o),o.prototype.name="bool",o.prototype.to_string=function(){return this.value},o.prototype.to_ascii=o.prototype.to_string,o.prototype.is_group=function(){return!1},o.registerAtParser=function(t){t.registerSymbol("(number)").nud=function(){return new o(this.value)}},i.gmath.expressions=i.gmath.expressions||{},i.gmath.expressions[o.prototype.name]=o},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.DragHandler=l;var i=n(0),r=n(3),o=n(5),s=n(1),a=n(35);function l(t,e){this.id=i.gmath.uid(),this.view=t,this.interaction_handler=e,this.derivation=t.derivation,this.dx=0,this.dy=0,this.dy0=0,this.finger_delta={x:0,y:0},this.dx_queue=[],this.dy_queue=[],this.x_offset=0,this.nodes=[],this.leaf_nodes=[],this.smooshedNodes=[],this.smooshing=!1,this.rubberband_dir=0,this.bbox=null,this.actions=[],this.on_release_action=null,this.target_areas=null,this.active=!1,this.bestHit=null,this.actionCount=0,this.indicator=this.view.settings.get("show_drag_indicator")?l.Indicator():null}function u(t){return 1===t.length&&t[0].is_group("add","sub","addsub","mul","div")?[t[0].children[1]]:t}function c(t,e){return t.x*t.x+t.y*t.y>e*e}function d(t){t.settings.shakes=0,t.settings.current_direction="up",t.settings.distance=0}l.debug_draw=!1,l.prototype.check=function(t,e){var n=t.pos0[0]-t.pos[0],i=t.pos0[1]-t.pos[1];return(1!==t.fingers.length||0!==e.length)&&n*n+i*i>=64},l.prototype.isActive=function(){return this.active},l.prototype.on_keydown=function(t){18!==t.keyCode&&32!==t.keyCode||this.selectNodesOneLevelUp(!0)},l.prototype.start=function(e,n){var i=this;return this.actionCount=0,!0===this.view.settings.get("hide_mouse_cursor")&&t.select("html").style("cursor","none"),this.derivation&&this.derivation.setLastHandleVisibility(!1),this.active=!0,this.setDragNodes(l.process_selection(n)),this.rubberband_dir=0,this.center=this.getCenter(this.nodes),this.indicator&&this.indicator.move_to(this.center,!0),this.interaction_handler.events.on("keydown."+this.id,function(t){18!==t.keyCode&&32!==t.keyCode||i.selectNodesOneLevelUp(!0)}),this.view.model.hide_nodes()&&(this.view.renderer.set_style(this.nodes),this.view.update_style()),this.indicator&&this.view.main.call(this.indicator),this.view.enter_and_exit(!1,"shadow"),this.setupActions(),this.derivation&&this.derivation.canvas_model&&this.indicator&&(this.indicator.setOffset(this.getCenterOffset(this.view.input_mode)),this.derivation.canvas_model.on("input_mode."+this.id,function(t){this.indicator.setOffset(this.getCenterOffset(t.mode))}.bind(this))),this.nodes},l.prototype.getCenter=function(t){var e=a.HitTester.getBoundingBox(u(t));return[e.x+e.width/2,e.y+e.height/2]},l.prototype.getCenterOffset=function(t){return"touch"===t?{x:0,y:this.view.settings.get("drag_dy_on_touch")*this.view.model.children[0].size}:{x:0,y:0}},l.prototype.setDragNodes=function(t){this.nodes.forEach(function(t){t.dragging=!1}),this.nodes=t,this.nodes.forEach(function(t){t.dragging=!0}),this.leaf_nodes=s.Tree.filter(function(t){return!t.has_children()},t)},l.prototype.selectNodesOneLevelUp=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.stopAllTimeouts(),!this.nodes[0].parent.is_root()){this.smooshing&&this.cancelSmooshing();var e=[];return this.nodes[0].is_group("mul","div")?((e=r.MulDiv.groupWithSiblings(this.nodes,!0)).length===this.nodes.length&&(e=r.MulDiv.groupWithSiblings(this.nodes)),e.length===this.nodes.length&&(e=[this.nodes[0].parent])):this.nodes.forEach(function(n){var i=!t&&n.parent.is_group("param","equals","gt","gte","lt","lte")?n:n.parent;i.is_group("param")&&(i=i.parent),e.push(i)}),this.updateSelection(e)}},l.prototype.onTap=function(t){t&&t.is_group("equals","gt","gte","lt","lte")||this.updateSelection(s.Tree.nodes_to_range(this.nodes.concat([t])))},l.prototype.updateSelection=function(t){var e=l.process_selection(t),n=this.nodes[0].x-this.nodes[0].x0,i=this.nodes[0].y-this.nodes[0].y0;this.setDragNodes(e),this.view.model.hide_nodes()&&(this.view.renderer.set_style(this.nodes),this.view.update_style()),this.interaction_handler.highlight_nodes(this.nodes),this.view.renderer.set_position(this.view.model,!1);for(var r=0;r<this.nodes.length;r++)this.nodes[r].for_each(function(t){t.x+=n,t.y+=i});return this.view.enter_and_exit(!1,"shadow"),this.view.update_existing(!1,"shadow"),this.view.updateDraggedNodes(this.leaf_nodes),this.setupActions(),this.center=this.getCenter(this.nodes),this.indicator&&this.indicator.move_to(this.center),this.nodes},l.prototype.update=function(t){var e=t.dx,n=t.dy;if(this.dy+=n,this.dx+=e,this.view.settings.get("rubber_band_selection")){var i=3.5*this.view.settings.get("font_size");if(0!==this.dy&&Math.abs(this.dy-this.dy0)>i){var r=this.dy>this.dy0?1:-1;0!==this.rubberband_dir&&r!==this.rubberband_dir||(this.dy0=this.dy,this.rubberband_dir=r,this.selectNodesOneLevelUp())}}this.finger_delta.x+=e,this.finger_delta.y+=n,this.pushToDeltaQueue(e,n),c(this.finger_delta,3)&&this.bestHit&&this.derivation.settings.get("auto_trigger_actions")&&this.stopAllTimeouts(),this.smooshing?this.smooshedNodes.forEach(function(t){s.Tree.for_each(function(t){t.x+=e,t.y+=n},t)}):s.Tree.for_each(function(t){t.x+=e,t.y+=n},this.nodes),this.bbox.x+=e,this.bbox.y+=n,this.center[0]+=e,this.center[1]+=n,this.updateActions(),this.smooshing?this.view.updateSmooshed(this.smooshedNodes):this.view.updateDraggedNodes(this.leaf_nodes),l.debug_draw&&this.debugDraw(!0)},l.prototype.pushToDeltaQueue=function(t,e){this.dx_queue.push(t),this.dy_queue.push(e),this.dx_queue.length>4&&this.dx_queue.shift(),this.dy_queue.length>4&&this.dy_queue.shift()},l.prototype.reduceDeltaQueues=function(){return{x:this.dx_queue.reduce(function(t,e){return t+e},0),y:this.dy_queue.reduce(function(t,e){return t+e},0)}},l.prototype.setupActions=function(){this.bestHit=null,this.dx_queue=[],this.dy_queue=[],this.finger_delta={x:0,y:0},this.view_box=this.view.getBBox({no_padding:!0});var t=this.nodes.length>0?.1*this.nodes[0].size:.1*this.view.settings.get("font_size");this.smooshing?this.bbox={x:this.center[0]-t,y:this.center[1]-t,width:2*t,height:2*t}:(this.bbox=a.HitTester.getBoundingBox(u(this.nodes),0),this.bbox.x-=t,this.bbox.width=2*t,this.bbox.y-=1.5*t,this.bbox.height=3*t);var e=this.view.model.getMoveActions(this.nodes);this.interaction_handler.only_synchronous_actions?this.shake_actions=[]:this.shake_actions=e.filter(function(t){return"shake"===t.settings.side}),this.actions=e.filter(function(t){return"shake"!==t.settings.side}),this.view.settings.get("enable_drag_to_join")||(this.actions=this.actions.filter(function(t){return!t.settings.is_join_action})),this.interaction_handler.only_synchronous_actions&&(this.actions=this.actions.filter(function(t){return!t.settings.asynchronous})),this.actions=this.actions.concat(this.getSubstitutionActions()),a.HitTester.setTargetRegions(this.actions,this.view.settings.get("font_size"),this.view_box),l.debug_draw&&this.debugDraw(!0),this.derivation.settings.get("show_area_hints")&&a.HitTester.drawDropAreaHints(this.view.main,this.actions),this.indicator&&(this.indicator.animate(0,0),this.indicator.move_to(this.center))},l.prototype.getSubstitutionActions=function(){var t=this;if(!this.derivation)return[];var e=this.derivation.getRowByView(this.view);e||(e=this.derivation.getLastRow());var n=this.derivation.pos.x-this.derivation.dims.x+e.pos[0],r=this.derivation.pos.y-this.derivation.dims.y+e.pos[1],o=[];return this.derivation.getAllDLs().forEach(function(e){var s=e.getLastRow(),a=s.model;if(a.id!==t.view.model.id){var l=a.getMoveActions(t.nodes,[i.gmath.actions.DirectSubstitutionAction]);l.forEach(function(t){t.target_ih=s.view.interaction_handler,t.settings.offset={x:e.pos.x-e.dims.x+s.pos[0]-n,y:e.pos.y-e.dims.y+s.pos[1]-r}},t),o=o.concat(l)}}),o},l.prototype.updateActions=function(){var t=this.applyShakeToShakeActions();t.length>0&&(this.end(!1),this.interaction_handler.performAction(t[0],!1));var e=this.getBestHit();e?this.handleTargetHit(e):this.handleTargetMiss(),this.indicator&&this.indicator.move_to(this.center)},l.prototype.handleTargetHit=function(t){if(this.derivation.settings.get("auto_trigger_actions")?t.settings.no_delay?this.performAction(t):t.timeoutID||this.applyTimeout(t):!t.settings.makes_no_changes||!t.settings.no_delay&&t.settings.on_release?this.on_release_action=t:this.performAction(t),this.bestHit!==t)if(this.bestHit=t,this.derivation.settings.get("show_area_hints")&&a.HitTester.drawDropAreaHints(this.view.main),this.derivation.settings.get("show_dest_hints"))a.HitTester.drawDestinationHints(this.view.main,t);else if(t.target_ih)t.target_ih.highlight_nodes(t.getTargetsForHighlighting(),!1,!0);else{var e=t.getTargetsForHighlighting();e.length>0&&this.view.interaction_handler.highlight_nodes(this.nodes.concat(e),!1,!0)}},l.prototype.handleTargetMiss=function(){this.bestHit&&(this.bestHit=null,this.derivation.settings.get("show_area_hints")&&a.HitTester.drawDropAreaHints(this.view.main,this.actions),this.derivation.settings.get("show_dest_hints")?a.HitTester.drawDestinationHints(this.view.main):this.unhighlightTargetNodes(),this.derivation.settings.get("auto_trigger_actions")?this.stopAllTimeouts():this.on_release_action=null)},l.prototype.getBestHit=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=a.HitTester.getHits(this.actions,this.bbox);t&&(e=e.filter(function(t){return!t.settings.delay})),this.isTooFarFromAView()&&(e=e.filter(function(t){return t.source_am}));var n=a.HitTester.getHighestPriorityHit(e,this.bbox);return n&&n.settings&&n.settings.dummy&&(n=null),n},l.prototype.isTooFarFromAView=function(){if(!this.bbox)return!1;var t=this.bbox.x+this.bbox.width/2,e=this.bbox.y+this.bbox.height/2,n=this.view_box,i=2*this.view.settings.get("font_size");return t<n.x-i||t>n.x+n.width+i||e<n.y-i||e>n.y+n.height+i},l.prototype.performAction=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.derivation.settings.get("auto_trigger_actions")&&this.stopAllTimeouts(),this.derivation.settings.get("show_dest_hints")&&a.HitTester.drawDestinationHints(this.view.main),l.debug_draw&&this.debugDraw(!1),this.dy=0,this.dx=0;var n={};s.Tree.for_each(function(t){n[t.id]={x:t.x,y:t.y}},this.nodes);var i=t.oldTree,r=i!==this.view.model;r&&i.startInteraction(),t=t.oldTree.performAction(t),this.actionCount++,r&&(i.finishInteraction(),i.for_each(function(t){return t.selected=!1}),i.hide_nodes(),this.view.render(!1)),this.derivation&&this.derivation.setLastHandleVisibility(!1);var o=l.getNewSelectionAfterAction(t,this.nodes);if(!e){if(0===o.length)return console.warn("No follow-up nodes selected! Check node_maps of action "+t.name+"!"),void this.interaction_handler.abort_interaction();var u,c,d=a.Reselector.getNewSelection(o);o=d||o,t.settings.is_join_action&&!d||(t.settings.is_join_action=!1,this.smooshing&&this.cancelSmooshing()),t.settings.is_join_action&&!d||(t.settings.is_join_action=!1,this.smooshing&&this.cancelSmooshing()),this.interaction_handler.highlight_nodes(o),this.setDragNodes(o),this.correctNodePositions(this.nodes,t,n),this.view.model.hide_nodes(),t.settings.is_join_action&&(this.updateSmooshAnimation(t,n),u=t.nodes,c=this.nodes,s.Tree.for_each(function(t){return t.smooshing=!1},u),s.Tree.for_each(function(t){t.smooshing=!0,t.x=t.x0,t.y=t.y0},c)),(t.settings.reset_x||t.settings.reset_y)&&this.resetPositionOfDraggedNodes(t.settings.reset_x,t.settings.reset_y),t.settings.makes_no_changes||this.alignExpressionAroundDraggedNodes(t.settings.is_join_action),this.smooshing||(this.center=this.getCenter(this.nodes)),this.view.enter_and_exit(!1,"shadow"),this.view.update_existing(!0,"both"),this.view.updateDraggedNodes(this.leaf_nodes),this.setupActions()}},l.getNewSelectionAfterAction=function(t,e){var n=t.new_selection?t.new_selection:t.mapNodes(e);return function(t){if(t.length<2)return t;var e=0;t[0].get_root().for_each(function(t){t.order_num=e++}),t.sort(function(t,e){return t.order_num-e.order_num})}(n),l.process_each_selection(n)},l.prototype.updateSmooshAnimation=function(t,e){this.view.hideExitingNodes(),this.addSmooshedNodes(t,e),this.view.enterSmooshed(this.smooshedNodes),this.shrinkNewSmooshedNodes(),this.positionSmooshedNodesInWheel(),this.view.updateSmooshed(this.smooshedNodes,!1)},l.prototype.addSmooshedNodes=function(t,e){var n=t.nodes[0],i=t.target,r=function(t){var e=s.Tree.clone(t,!1,["id","value","name","bp","associative","commutative","vertical_notation","selected","dragging","locked","fixed","hidden","simplify","deleted","precision","color","size","width","height","x","y","x0","y0","rel_x","rel_y","lmar","rmar","scale_y"]);return e.children[0]&&e.symIsHidden()&&(e.children[0].hidden=!1),e};if(this.smooshing=!0,0===this.smooshedNodes.length){var o=r(n),a=e[n.id],l=a?a.x-o.x:0,u=a?a.y-o.y:0,c=this.view.settings.get("selection_color");s.Tree.for_each(function(t){t.x+=l,t.y+=u,t.color=c},o),this.smooshedNodes.push(o)}var d=r(i),h=e[i.id],p=h?h.x-d.x:0,f=h?h.y-d.y:0,g=this.view.settings.get("color");s.Tree.for_each(function(t){t.x+=p,t.y+=f,t.color=g},d),this.smooshedNodes.push(d)},l.prototype.shrinkNewSmooshedNodes=function(){2===this.smooshedNodes.length?this.smooshedNodes.forEach(this.shrinkSmooshedNodesGroup.bind(this)):this.shrinkSmooshedNodesGroup(this.smooshedNodes[this.smooshedNodes.length-1])},l.prototype.shrinkSmooshedNodesGroup=function(t){t.size=t.size*this.view.settings.get("smooshed_nodes_shrink_factor"),s.Tree.for_each(function(e){e.size=t.size},t),this.view.renderer.set_position(t)},l.prototype.positionSmooshedNodesInWheel=function(){for(var t=this.smooshedNodes.length,e=this.calculatePositionOnCircleForEachGroup(t),n=0;n<this.smooshedNodes.length;n++){var i=this.smooshedNodes[n],r=this.center[0]+i.width/2+e[n][0],o=this.center[1]-i.height/2+e[n][1],s=r-i.x,a=o-i.y;i.for_each(function(t){t.x+=s,t.y+=a})}},l.prototype.calculatePositionOnCircleForEachGroup=function(t){for(var e=this.view.settings.get("font_size"),n=360/t,i=270,r=[270],o=0;o<t-1;o++)i=((i+=n)+360)%360,r.push(i);var s=function(t){return t*Math.PI/180};return r.map(function(t){return[e*Math.cos(s(t)),e*Math.sin(s(t))]})},l.prototype.cancelSmooshing=function(){s.Tree.for_each(function(t){return t.smooshing=!1},this.nodes),this.smooshing=!1,this.smooshedNodes=[],this.view.exitSmooshed()},l.prototype.correctNodePositions=function(t,e,n){var i;if((!e.settings.makes_no_changes||e.settings.update_node_positions)&&(s.Tree.select_first(function(n){if(!n.has_children()){var r=e.mapNodes(n);if(1!==r.length||r[0].has_children())return!1;var o=s.Tree.select_first(function(t){return t===r[0]},t);return!!o&&(i={old:n,new:o},!0)}},e.nodes),i)){var r=n[i.old.id].x-i.new.x0,o=n[i.old.id].y-i.new.y0;s.Tree.for_each(function(t){t.x=t.x0+r,t.y=t.y0+o},t)}},l.prototype.resetPositionOfDraggedNodes=function(t,e){this.nodes.forEach(function(n){n.for_each(function(n){t&&(n.x=n.x0),e&&(n.y=n.y0)})})},l.prototype.alignExpressionAroundDraggedNodes=function(t){if(!a.HitTester.boxIsLeftOrRightOfViewBox(a.HitTester.getBoundingBox(this.nodes),this.view_box)){if(t){for(var e=0,n=0;n<this.nodes[0].children.length;n++)e+=this.nodes[0].children[n].sel_box.width;this.x_offset=this.center[0]+e/2-this.nodes[0].x0}else this.x_offset=this.nodes[0].x-this.nodes[0].x0;this.applyHorizontalShiftToRestingNodes(this.x_offset),t?s.Tree.for_each(function(t){t.x0+=this.x_offset,t.x+=this.x_offset}.bind(this),this.nodes):s.Tree.for_each(function(t){t.x0+=this.x_offset}.bind(this),this.nodes)}},l.prototype.applyHorizontalShiftToRestingNodes=function(t){var e=this.view.model.filter(function(t){return!t.dragging});(e=e.filter(function(t){for(var e=t;e=e.parent;)if(e.dragging)return!1;return!0})).forEach(function(e){e.x+=t,e.x0+=t})},l.prototype.debugDraw=function(t){t?a.HitTester.draw(this.view.main,this.actions,this.bbox):a.HitTester.draw(this.view.main)},l.prototype.end=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.select("html").style("cursor",null),this.indicator&&this.indicator.remove(),this.interaction_handler.events.on("keydown."+this.id,null),this.unhighlightTargetNodes(),this.cancelSmooshing(),this.setDragNodes([]),this.view.enter_and_exit(!0,"shadow");var n=!0;if(e){var i=this.on_release_action||this.getBestHit(!1);i&&(this.performAction(i,!0),this.actionCount++,n=i.settings&&i.settings.makes_no_changes)}return n&&(this.view.model.hide_nodes(),this.view.render()),this.derivation&&this.derivation.setLastHandleVisibility(!0),this.stopAllTimeouts(),this.actions=[],this.bestHit=null,this.bbox=null,this.active=!1,this.dy=0,this.dy0=0,this.dx=0,l.debug_draw&&this.debugDraw(!1),this.derivation.settings.get("show_area_hints")&&a.HitTester.drawDropAreaHints(this.view.main),this.derivation.settings.get("show_dest_hints")&&a.HitTester.drawDestinationHints(this.view.main),this.actionCount},l.prototype.applyTimeout=function(t){var e=this.view.settings.get("trigger_delay_factor"),n=this.view.settings.get("trigger_delay_minimum"),i=t.settings.delay?Math.max(t.settings.delay*e,n):null;this.indicator&&this.indicator.animate(1,i),this.finger_delta.x=0,this.finger_delta.y=0,t.timeoutID=setTimeout(function(){t.settings.on_release?(this.on_release_action=t,this.indicator&&this.indicator.fill(),this.finger_delta={x:0,y:0}):this.performAction(t)}.bind(this),Math.max(i,n))},l.prototype.stopAllTimeouts=function(){this.indicator&&this.indicator.animate(0,0),this.on_release_action=null;for(var t=0;t<this.actions.length;t++){var e=this.actions[t];e.timeoutID&&this.clearActionTimeout(e)}},l.prototype.clearActionTimeout=function(t){clearTimeout(t.timeoutID),delete t.timeoutID,delete t.dx,delete t.dy},l.prototype.unhighlightTargetNodes=function(){this.actions.forEach(function(t){t.target_ih&&t.target_ih.highlight_nodes([],!1,!0)})},l.prototype.applyShakeToShakeActions=function(){var t=this.reduceDeltaQueues();if(!c(t,3))return[];var e=this.view.settings.get("font_size");return Math.abs(this.dx)>2*e||Math.abs(this.dy)>3*e?(this.shake_actions.forEach(d),[]):Math.abs(t.x)>Math.abs(t.y)?(this.shake_actions.forEach(function(t){t.settings.non_shakes||(t.settings.non_shakes=0),++t.settings.non_shakes>2&&d(t)}),[]):function(t,e){var n=[],i=e.y<0?"up":"down";return t.forEach(function(t){t.settings.shakes||(t.settings.shakes=0),t.settings.current_direction||(t.settings.current_direction="up",t.settings.distance=0),i===t.settings.current_direction?(t.settings.distance+=e.y,Math.abs(t.settings.distance)>100&&(t.settings.shakes++,t.settings.current_direction="up"===i?"down":"up",t.settings.distance=0)):i!==t.settings.current_direction&&(t.settings.distance=0),t.settings.shakes>=4&&n.push(t),t.settings.non_shakes=0}),n}(this.shake_actions,t)},l.process_each_selection=function(t){if(0===t.length)return[];var e=[];return o.AlgebraModel.groupNodeRanges(t).map(function(t){return l.process_selection(t)}).forEach(function(t){e=i.gmath.array.mergedNew(e,t)}),e},l.process_selection=function(t){var e=t.slice();if(0===e.length)return[];if(l.special_selection(e))return l.special_selection(e);if(e[0].commutative){var n=e[0].parent;if(e.length<n.children.length)return e;e=[n]}for(var i=e[0];!o.AlgebraModel.is_top_most(i)&&!i.parent.is_group("equals","gte","lte","gt","lt")&&!i.commutative&&!i.is_group("exponent","degree")&&!i.parent.is_group("param")&&(!i.parent.is_group("radical")||i.parent.children[3]!==i)&&(!i.is_group()||i.is_group("tuple")||1!==i.get_idx()||!i.parent.is_group("brackets")||r.Brackets.areHidden(i.parent));)i=i.parent;return 1===i.get_idx()&&i.parent&&r.Inequality.is_relation(i.parent)&&(i=i.parent),[i]},l.special_selection=function(t){if(1!==t.length)return!1;var e=t[0];return!e.fixed&&e.parent.is_group("subscript","superscript")?t:"-"===e.to_ascii()||"±"===e.to_ascii()?t:"|"===e.to_ascii()&&0===e.get_idx()?t:(r.Num.is_num(e)&&e.parent.is_group("sign")&&(e=e.parent),!!(r.Num.is_equal_to(e,-1)&&e.parent.is_group("brackets")&&e.get_parent(2).is_group("power")&&e.get_parent(2).is_square_root())&&[e])},l.Indicator=function(){var e,n,i,r,o=0,s=0,a=12,l={x:0,y:0},u=!0,c=t.svg.arc().innerRadius(9.5).outerRadius(a).startAngle(0),d=2*Math.PI,h=function(t){e=t.insert("svg","*").style("width","24px").style("height","24px").style("position","absolute").style("left",o-a+l.x+"px").style("top",s-a+l.y+"px").style("display",u?null:"none"),n=e.append("g").attr("transform","translate(12,12)"),r=n.append("circle").attr("r",a).style({stroke:"none",fill:"orange",opacity:.4}),i=n.append("path").style({fill:"red",stroke:"none",opacity:.5}).datum({endAngle:0}).attr("d",c)};return h.setOffset=function(t){l=t},h.remove=function(){e.remove()},h.visible=function(t){if(0===arguments.length)return u;u=t,e&&e.style("display",u?null:"none")},h.move_to=function(t,n){o=t[0],s=t[1],e&&(n?e.style({left:o-a+l.x+"px",top:s-a+l.y+"px"}):e.transition().duration(300).ease("circle-out").style({left:o-a+l.x+"px",top:s-a+l.y+"px"}))},h.animate=function(e,n){var o,s=0===n?0:150;i.transition().delay(s).duration(Math.max(0,n-s-50)).ease("linear").attrTween("d",(o=e*d,function(e){var n=t.interpolate(e.endAngle,o);return function(t){return e.endAngle=n(t),c(e)}})),r&&r.style("fill","orange"),i.style("fill","red")},h.fill=function(){i.transition().style("fill","green"),r&&r.transition().style("fill","green")},h},i.gmath.DragHandler=l}).call(this,n(6))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeNumberHandler=o;var i=n(0),r=n(15);function o(t,e){this.interaction_handler=e,this.derivation=this.interaction_handler.dl,this.precision=null,this.view=t,this.dy=0,this.dx=0,this.pixels_per_unit=5,this.pixels_per_precision=400,this.node=null,this.value=null,this.value0=null}o.prototype.getDefaultPrecision=function(){if(this.derivation)return this.derivation.settings.getIfExists("scrub_precision",1)},o.prototype.check=function(t){if(this.view.model.settings.get("locked"))return!1;var e=t.pos0[1]-t.pos[1];return Math.abs(e)>=10},o.prototype.start=function(t,e){return this.old_anim_dur=this.view.settings.get("dur"),this.view.settings.set("dur",0),this.node=this.process_selection(e),this.node?(this.precision=this.getDefaultPrecision(),this.dy=0,this.dx=0,this.value=this.value0=this.view.model.numeric_value(this.node),[this.node]):[]},o.prototype.update=function(t){if(this.node&&(t.dy||t.dx)){this.dx+=t.dx,this.dy+=t.dy,this.updatePrecision();var e=Math.pow(10,this.precision),n=-this.dy/this.pixels_per_unit/e;n=Math.round(n*e)/e,this.set_value(this.value0+n)}},o.prototype.updatePrecision=function(){var t=Math.round(this.dx/this.pixels_per_precision),e=this.getDefaultPrecision()+t;e!==this.precision&&(this.precision=e,this.dy=0,this.value0=this.value,console.log("precision is",this.precision))},o.prototype.set_value=function(t){if(t!==this.value){this.value=t;var e=this.view.model.numeric_value(this.node,t);e instanceof r.Num?(e.scrubbingThisNum=!0,e.scrub_precision=this.precision):e.is_group("add","sub","sign")&&(e.children[1].scrubbingThisNum=!0,e.children[1].scrub_precision=this.precision),e!==this.node&&(this.node=this.process_selection([e]),this.value=this.value0=this.view.model.numeric_value(this.node),this.interaction_handler.highlight_nodes([this.node]))}},o.prototype.end=function(){this.node&&(this.node instanceof r.Num&&delete this.node.scrubbingThisNum,this.node.is_group("add","sub","sign")&&delete this.node.children[1].scrubbingThisNum,this.view.render()),this.view.settings.set("dur",this.old_anim_dur),this.node=null},o.prototype.process_selection=function(t){var e=function(t){return t.is_group("sign")||t.is_group("add")||t.is_group("sub")};if(0===t.length||t.length>2)return null;if(2===t.length){var n=t[1];return n instanceof r.Num&&e(n)?n.parent:null}var i=t[0];return i instanceof r.Num?e(i.parent)?i.parent:i:e(i)?i:null},i.gmath.ChangeNumberHandler=o},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){(function(t){var n,i=function(t){"use strict";var e=1e7,n=7,r=9007199254740992,o=d(r),s=Math.log(r);function a(t,e){return void 0===t?a[0]:void 0!==e?10==+e?Q(t):B(t,e):Q(t)}function l(t,e){this.value=t,this.sign=e,this.isSmall=!1}function u(t){this.value=t,this.sign=t<0,this.isSmall=!0}function c(t){return-r<t&&t<r}function d(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function h(t){p(t);var n=t.length;if(n<4&&E(t,o)<0)switch(n){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*e;default:return t[0]+(t[1]+t[2]*e)*e}return t}function p(t){for(var e=t.length;0===t[--e];);t.length=e+1}function f(t){for(var e=new Array(t),n=-1;++n<t;)e[n]=0;return e}function g(t){return t>0?Math.floor(t):Math.ceil(t)}function m(t,n){var i,r,o=t.length,s=n.length,a=new Array(o),l=0,u=e;for(r=0;r<s;r++)l=(i=t[r]+n[r]+l)>=u?1:0,a[r]=i-l*u;for(;r<o;)l=(i=t[r]+l)===u?1:0,a[r++]=i-l*u;return l>0&&a.push(l),a}function v(t,e){return t.length>=e.length?m(t,e):m(e,t)}function y(t,n){var i,r,o=t.length,s=new Array(o),a=e;for(r=0;r<o;r++)i=t[r]-a+n,n=Math.floor(i/a),s[r]=i-n*a,n+=1;for(;n>0;)s[r++]=n%a,n=Math.floor(n/a);return s}function b(t,n){var i,r,o=t.length,s=n.length,a=new Array(o),l=0,u=e;for(i=0;i<s;i++)(r=t[i]-l-n[i])<0?(r+=u,l=1):l=0,a[i]=r;for(i=s;i<o;i++){if(!((r=t[i]-l)<0)){a[i++]=r;break}r+=u,a[i]=r}for(;i<o;i++)a[i]=t[i];return p(a),a}function _(t,n,i){var r,o,s=t.length,a=new Array(s),c=-n,d=e;for(r=0;r<s;r++)o=t[r]+c,c=Math.floor(o/d),o%=d,a[r]=o<0?o+d:o;return"number"==typeof(a=h(a))?(i&&(a=-a),new u(a)):new l(a,i)}function x(t,n){var i,r,o,s,a=t.length,l=n.length,u=f(a+l),c=e;for(o=0;o<a;++o){s=t[o];for(var d=0;d<l;++d)i=s*n[d]+u[o+d],r=Math.floor(i/c),u[o+d]=i-r*c,u[o+d+1]+=r}return p(u),u}function w(t,n){var i,r,o=t.length,s=new Array(o),a=e,l=0;for(r=0;r<o;r++)i=t[r]*n+l,l=Math.floor(i/a),s[r]=i-l*a;for(;l>0;)s[r++]=l%a,l=Math.floor(l/a);return s}function A(t,e){for(var n=[];e-- >0;)n.push(0);return n.concat(t)}function k(t,n,i){return new l(t<e?w(n,t):x(n,d(t)),i)}function T(t){var n,i,r,o,s=t.length,a=f(s+s),l=e;for(r=0;r<s;r++){o=t[r];for(var u=0;u<s;u++)n=o*t[u]+a[r+u],i=Math.floor(n/l),a[r+u]=n-i*l,a[r+u+1]+=i}return p(a),a}function S(t,n){var i,r,o,s,a=t.length,l=f(a),u=e;for(o=0,i=a-1;i>=0;--i)o=(s=o*u+t[i])-(r=g(s/n))*n,l[i]=0|r;return[l,0|o]}function M(t,n){var i,r,o=Q(n),s=t.value,c=o.value;if(0===c)throw new Error("Cannot divide by zero");if(t.isSmall)return o.isSmall?[new u(g(s/c)),new u(s%c)]:[a[0],t];if(o.isSmall){if(1===c)return[t,a[0]];if(-1==c)return[t.negate(),a[0]];var m=Math.abs(c);if(m<e){r=h((i=S(s,m))[0]);var v=i[1];return t.sign&&(v=-v),"number"==typeof r?(t.sign!==o.sign&&(r=-r),[new u(r),new u(v)]):[new l(r,t.sign!==o.sign),new u(v)]}c=d(m)}var y=E(s,c);if(-1===y)return[a[0],t];if(0===y)return[a[t.sign===o.sign?1:-1],a[0]];r=(i=s.length+c.length<=200?function(t,n){var i,r,o,s,a,l,u,c=t.length,d=n.length,p=e,g=f(n.length),m=n[d-1],v=Math.ceil(p/(2*m)),y=w(t,v),b=w(n,v);for(y.length<=c&&y.push(0),b.push(0),m=b[d-1],r=c-d;r>=0;r--){for(i=p-1,y[r+d]!==m&&(i=Math.floor((y[r+d]*p+y[r+d-1])/m)),o=0,s=0,l=b.length,a=0;a<l;a++)o+=i*b[a],u=Math.floor(o/p),s+=y[r+a]-(o-u*p),o=u,s<0?(y[r+a]=s+p,s=-1):(y[r+a]=s,s=0);for(;0!==s;){for(i-=1,o=0,a=0;a<l;a++)(o+=y[r+a]-p+b[a])<0?(y[r+a]=o+p,o=0):(y[r+a]=o,o=1);s+=o}g[r]=i}return y=S(y,v)[0],[h(g),h(y)]}(s,c):function(t,n){for(var i,r,o,s,a,l=t.length,u=n.length,c=[],d=[],f=e;l;)if(d.unshift(t[--l]),p(d),E(d,n)<0)c.push(0);else{o=d[(r=d.length)-1]*f+d[r-2],s=n[u-1]*f+n[u-2],r>u&&(o=(o+1)*f),i=Math.ceil(o/s);do{if(E(a=w(n,i),d)<=0)break;i--}while(i);c.push(i),d=b(d,a)}return c.reverse(),[h(c),h(d)]}(s,c))[0];var _=t.sign!==o.sign,x=i[1],A=t.sign;return"number"==typeof r?(_&&(r=-r),r=new u(r)):r=new l(r,_),"number"==typeof x?(A&&(x=-x),x=new u(x)):x=new l(x,A),[r,x]}function E(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var n=t.length-1;n>=0;n--)if(t[n]!==e[n])return t[n]>e[n]?1:-1;return 0}function N(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(25)||void 0))}l.prototype=Object.create(a.prototype),u.prototype=Object.create(a.prototype),l.prototype.add=function(t){var e=Q(t);if(this.sign!==e.sign)return this.subtract(e.negate());var n=this.value,i=e.value;return e.isSmall?new l(y(n,Math.abs(i)),this.sign):new l(v(n,i),this.sign)},l.prototype.plus=l.prototype.add,u.prototype.add=function(t){var e=Q(t),n=this.value;if(n<0!==e.sign)return this.subtract(e.negate());var i=e.value;if(e.isSmall){if(c(n+i))return new u(n+i);i=d(Math.abs(i))}return new l(y(i,Math.abs(n)),n<0)},u.prototype.plus=u.prototype.add,l.prototype.subtract=function(t){var e=Q(t);if(this.sign!==e.sign)return this.add(e.negate());var n=this.value,i=e.value;return e.isSmall?_(n,Math.abs(i),this.sign):function(t,e,n){var i;return E(t,e)>=0?i=b(t,e):(i=b(e,t),n=!n),"number"==typeof(i=h(i))?(n&&(i=-i),new u(i)):new l(i,n)}(n,i,this.sign)},l.prototype.minus=l.prototype.subtract,u.prototype.subtract=function(t){var e=Q(t),n=this.value;if(n<0!==e.sign)return this.add(e.negate());var i=e.value;return e.isSmall?new u(n-i):_(i,Math.abs(n),n>=0)},u.prototype.minus=u.prototype.subtract,l.prototype.negate=function(){return new l(this.value,!this.sign)},u.prototype.negate=function(){var t=this.sign,e=new u(-this.value);return e.sign=!t,e},l.prototype.abs=function(){return new l(this.value,!1)},u.prototype.abs=function(){return new u(Math.abs(this.value))},l.prototype.multiply=function(t){var n,i,r,o=Q(t),s=this.value,u=o.value,c=this.sign!==o.sign;if(o.isSmall){if(0===u)return a[0];if(1===u)return this;if(-1===u)return this.negate();if((n=Math.abs(u))<e)return new l(w(s,n),c);u=d(n)}return new l(-.012*(i=s.length)-.012*(r=u.length)+15e-6*i*r>0?function t(e,n){var i=Math.max(e.length,n.length);if(i<=30)return x(e,n);i=Math.ceil(i/2);var r=e.slice(i),o=e.slice(0,i),s=n.slice(i),a=n.slice(0,i),l=t(o,a),u=t(r,s),c=v(v(l,A(b(b(t(v(o,r),v(a,s)),l),u),i)),A(u,2*i));return p(c),c}(s,u):x(s,u),c)},l.prototype.times=l.prototype.multiply,u.prototype._multiplyBySmall=function(t){return c(t.value*this.value)?new u(t.value*this.value):k(Math.abs(t.value),d(Math.abs(this.value)),this.sign!==t.sign)},l.prototype._multiplyBySmall=function(t){return 0===t.value?a[0]:1===t.value?this:-1===t.value?this.negate():k(Math.abs(t.value),this.value,this.sign!==t.sign)},u.prototype.multiply=function(t){return Q(t)._multiplyBySmall(this)},u.prototype.times=u.prototype.multiply,l.prototype.square=function(){return new l(T(this.value),!1)},u.prototype.square=function(){var t=this.value*this.value;return c(t)?new u(t):new l(T(d(Math.abs(this.value))),!1)},l.prototype.divmod=function(t){var e=M(this,t);return{quotient:e[0],remainder:e[1]}},u.prototype.divmod=l.prototype.divmod,l.prototype.divide=function(t){return M(this,t)[0]},u.prototype.over=u.prototype.divide=l.prototype.over=l.prototype.divide,l.prototype.mod=function(t){return M(this,t)[1]},u.prototype.remainder=u.prototype.mod=l.prototype.remainder=l.prototype.mod,l.prototype.pow=function(t){var e,n,i,r=Q(t),o=this.value,s=r.value;if(0===s)return a[1];if(0===o)return a[0];if(1===o)return a[1];if(-1===o)return r.isEven()?a[1]:a[-1];if(r.sign)return a[0];if(!r.isSmall)throw new Error("The exponent "+r.toString()+" is too large.");if(this.isSmall&&c(e=Math.pow(o,s)))return new u(g(e));for(n=this,i=a[1];!0&s&&(i=i.times(n),--s),0!==s;)s/=2,n=n.square();return i},u.prototype.pow=l.prototype.pow,l.prototype.modPow=function(t,e){if(t=Q(t),(e=Q(e)).isZero())throw new Error("Cannot take modPow with modulus 0");for(var n=a[1],i=this.mod(e);t.isPositive();){if(i.isZero())return a[0];t.isOdd()&&(n=n.multiply(i).mod(e)),t=t.divide(2),i=i.square().mod(e)}return n},u.prototype.modPow=l.prototype.modPow,l.prototype.compareAbs=function(t){var e=Q(t),n=this.value,i=e.value;return e.isSmall?1:E(n,i)},u.prototype.compareAbs=function(t){var e=Q(t),n=Math.abs(this.value),i=e.value;return e.isSmall?n===(i=Math.abs(i))?0:n>i?1:-1:-1},l.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=Q(t),n=this.value,i=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:E(n,i)*(this.sign?-1:1)},l.prototype.compareTo=l.prototype.compare,u.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=Q(t),n=this.value,i=e.value;return e.isSmall?n==i?0:n>i?1:-1:n<0!==e.sign?n<0?-1:1:n<0?1:-1},u.prototype.compareTo=u.prototype.compare,l.prototype.equals=function(t){return 0===this.compare(t)},u.prototype.eq=u.prototype.equals=l.prototype.eq=l.prototype.equals,l.prototype.notEquals=function(t){return 0!==this.compare(t)},u.prototype.neq=u.prototype.notEquals=l.prototype.neq=l.prototype.notEquals,l.prototype.greater=function(t){return this.compare(t)>0},u.prototype.gt=u.prototype.greater=l.prototype.gt=l.prototype.greater,l.prototype.lesser=function(t){return this.compare(t)<0},u.prototype.lt=u.prototype.lesser=l.prototype.lt=l.prototype.lesser,l.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},u.prototype.geq=u.prototype.greaterOrEquals=l.prototype.geq=l.prototype.greaterOrEquals,l.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},u.prototype.leq=u.prototype.lesserOrEquals=l.prototype.leq=l.prototype.lesserOrEquals,l.prototype.isEven=function(){return 0==(1&this.value[0])},u.prototype.isEven=function(){return 0==(1&this.value)},l.prototype.isOdd=function(){return 1==(1&this.value[0])},u.prototype.isOdd=function(){return 1==(1&this.value)},l.prototype.isPositive=function(){return!this.sign},u.prototype.isPositive=function(){return this.value>0},l.prototype.isNegative=function(){return this.sign},u.prototype.isNegative=function(){return this.value<0},l.prototype.isUnit=function(){return!1},u.prototype.isUnit=function(){return 1===Math.abs(this.value)},l.prototype.isZero=function(){return!1},u.prototype.isZero=function(){return 0===this.value},l.prototype.isDivisibleBy=function(t){var e=Q(t),n=e.value;return 0!==n&&(1===n||(2===n?this.isEven():this.mod(e).equals(a[0])))},u.prototype.isDivisibleBy=l.prototype.isDivisibleBy,l.prototype.isPrime=function(){var t=N(this);if(void 0!==t)return t;for(var e,n,r,o,s=this.abs(),l=s.prev(),u=[2,3,5,7,11,13,17,19],c=l;c.isEven();)c=c.divide(2);for(r=0;r<u.length;r++)if(!(o=i(u[r]).modPow(c,s)).equals(a[1])&&!o.equals(l)){for(n=!0,e=c;n&&e.lesser(l);e=e.multiply(2))(o=o.square().mod(s)).equals(l)&&(n=!1);if(n)return!1}return!0},u.prototype.isPrime=l.prototype.isPrime,l.prototype.isProbablePrime=function(t){var e=N(this);if(void 0!==e)return e;for(var n=this.abs(),r=void 0===t?5:t,o=0;o<r;o++)if(!i.randBetween(2,n.minus(2)).modPow(n.prev(),n).isUnit())return!1;return!0},u.prototype.isProbablePrime=l.prototype.isProbablePrime,l.prototype.modInv=function(t){for(var e,n,r,o=i.zero,s=i.one,a=Q(t),l=this.abs();!l.equals(i.zero);)e=a.divide(l),n=o,r=a,o=s,a=l,s=n.subtract(e.multiply(s)),l=r.subtract(e.multiply(l));if(!a.equals(1))throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===o.compare(0)&&(o=o.add(t)),this.isNegative()?o.negate():o},u.prototype.modInv=l.prototype.modInv,l.prototype.next=function(){var t=this.value;return this.sign?_(t,1,this.sign):new l(y(t,1),this.sign)},u.prototype.next=function(){var t=this.value;return t+1<r?new u(t+1):new l(o,!1)},l.prototype.prev=function(){var t=this.value;return this.sign?new l(y(t,1),!0):_(t,1,this.sign)},u.prototype.prev=function(){var t=this.value;return t-1>-r?new u(t-1):new l(o,!0)};for(var O=[1];2*O[O.length-1]<=e;)O.push(2*O[O.length-1]);var q=O.length,C=O[q-1];function P(t){return("number"==typeof t||"string"==typeof t)&&+Math.abs(t)<=e||t instanceof l&&t.value.length<=1}function j(t,e,n){e=Q(e);for(var r=t.isNegative(),o=e.isNegative(),s=r?t.not():t,a=o?e.not():e,l=0,u=0,c=null,d=null,h=[];!s.isZero()||!a.isZero();)l=(c=M(s,C))[1].toJSNumber(),r&&(l=C-1-l),u=(d=M(a,C))[1].toJSNumber(),o&&(u=C-1-u),s=c[0],a=d[0],h.push(n(l,u));for(var p=0!==n(r?1:0,o?1:0)?i(-1):i(0),f=h.length-1;f>=0;f-=1)p=p.multiply(C).add(i(h[f]));return p}l.prototype.shiftLeft=function(t){if(!P(t))throw new Error(String(t)+" is too large for shifting.");if((t=+t)<0)return this.shiftRight(-t);for(var e=this;t>=q;)e=e.multiply(C),t-=q-1;return e.multiply(O[t])},u.prototype.shiftLeft=l.prototype.shiftLeft,l.prototype.shiftRight=function(t){var e;if(!P(t))throw new Error(String(t)+" is too large for shifting.");if((t=+t)<0)return this.shiftLeft(-t);for(var n=this;t>=q;){if(n.isZero())return n;n=(e=M(n,C))[1].isNegative()?e[0].prev():e[0],t-=q-1}return(e=M(n,O[t]))[1].isNegative()?e[0].prev():e[0]},u.prototype.shiftRight=l.prototype.shiftRight,l.prototype.not=function(){return this.negate().prev()},u.prototype.not=l.prototype.not,l.prototype.and=function(t){return j(this,t,function(t,e){return t&e})},u.prototype.and=l.prototype.and,l.prototype.or=function(t){return j(this,t,function(t,e){return t|e})},u.prototype.or=l.prototype.or,l.prototype.xor=function(t){return j(this,t,function(t,e){return t^e})},u.prototype.xor=l.prototype.xor;var D=1<<30,I=(e&-e)*(e&-e)|D;function F(t){var n=t.value,i="number"==typeof n?n|D:n[0]+n[1]*e|I;return i&-i}function L(t,e){return t=Q(t),e=Q(e),t.greater(e)?t:e}function z(t,e){return t=Q(t),e=Q(e),t.lesser(e)?t:e}function R(t,e){if(t=Q(t).abs(),e=Q(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var n,i,r=a[1];t.isEven()&&e.isEven();)n=Math.min(F(t),F(e)),t=t.divide(n),e=e.divide(n),r=r.multiply(n);for(;t.isEven();)t=t.divide(F(t));do{for(;e.isEven();)e=e.divide(F(e));t.greater(e)&&(i=e,e=t,t=i),e=e.subtract(t)}while(!e.isZero());return r.isUnit()?t:t.multiply(r)}var B=function(t,e){for(var n=t.length,i=Math.abs(e),r=0;r<n;r++)if("-"!==(c=t[r].toLowerCase())&&/[a-z0-9]/.test(c)){if(/[0-9]/.test(c)&&+c>=i){if("1"===c&&1===i)continue;throw new Error(c+" is not a valid digit in base "+e+".")}if(c.charCodeAt(0)-87>=i)throw new Error(c+" is not a valid digit in base "+e+".")}if(2<=e&&e<=36&&n<=s/Math.log(e)){var o=parseInt(t,e);if(isNaN(o))throw new Error(c+" is not a valid digit in base "+e+".");return new u(parseInt(t,e))}e=Q(e);var a=[],l="-"===t[0];for(r=l?1:0;r<t.length;r++){var c,d=(c=t[r].toLowerCase()).charCodeAt(0);if(48<=d&&d<=57)a.push(Q(c));else if(97<=d&&d<=122)a.push(Q(c.charCodeAt(0)-87));else{if("<"!==c)throw new Error(c+" is not a valid character");var h=r;do{r++}while(">"!==t[r]);a.push(Q(t.slice(h+1,r)))}}return H(a,e,l)};function H(t,e,n){var i,r=a[0],o=a[1];for(i=t.length-1;i>=0;i--)r=r.add(t[i].times(o)),o=o.times(e);return n?r.negate():r}function G(t){return t<=35?"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t):"<"+t+">"}function V(t,e){if((e=i(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t)).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var n=Array.apply(null,Array(+t-1)).map(Array.prototype.valueOf,[0,1]);return n.unshift([1]),{value:[].concat.apply([],n),isNegative:!1}}var r=!1;if(t.isNegative()&&e.isPositive()&&(r=!0,t=t.abs()),e.equals(1))return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(+t)).map(Number.prototype.valueOf,1),isNegative:r};for(var o,s=[],a=t;a.isNegative()||a.compareAbs(e)>=0;){a=(o=a.divmod(e)).quotient;var l=o.remainder;l.isNegative()&&(l=e.minus(l).abs(),a=a.next()),s.push(l.toJSNumber())}return s.push(a.toJSNumber()),{value:s.reverse(),isNegative:r}}function U(t,e){var n=V(t,e);return(n.isNegative?"-":"")+n.value.map(G).join("")}function W(t){if(c(+t)){var e=+t;if(e===g(e))return new u(e);throw"Invalid integer: "+t}var i="-"===t[0];i&&(t=t.slice(1));var r=t.split(/e/i);if(r.length>2)throw new Error("Invalid integer: "+r.join("e"));if(2===r.length){var o=r[1];if("+"===o[0]&&(o=o.slice(1)),(o=+o)!==g(o)||!c(o))throw new Error("Invalid integer: "+o+" is not a valid exponent.");var s=r[0],a=s.indexOf(".");if(a>=0&&(o-=s.length-a-1,s=s.slice(0,a)+s.slice(a+1)),o<0)throw new Error("Cannot include negative exponent part for integers");t=s+=new Array(o+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);for(var d=[],h=t.length,f=n,m=h-f;h>0;)d.push(+t.slice(m,h)),(m-=f)<0&&(m=0),h-=f;return p(d),new l(d,i)}function Q(t){return"number"==typeof t?function(t){if(c(t)){if(t!==g(t))throw new Error(t+" is not an integer.");return new u(t)}return W(t.toString())}(t):"string"==typeof t?W(t):t}l.prototype.toArray=function(t){return V(this,t)},u.prototype.toArray=function(t){return V(this,t)},l.prototype.toString=function(t){if(void 0===t&&(t=10),10!==t)return U(this,t);for(var e,n=this.value,i=n.length,r=String(n[--i]);--i>=0;)e=String(n[i]),r+="0000000".slice(e.length)+e;return(this.sign?"-":"")+r},u.prototype.toString=function(t){return void 0===t&&(t=10),10!=t?U(this,t):String(this.value)},l.prototype.toJSON=u.prototype.toJSON=function(){return this.toString()},l.prototype.valueOf=function(){return parseInt(this.toString(),10)},l.prototype.toJSNumber=l.prototype.valueOf,u.prototype.valueOf=function(){return this.value},u.prototype.toJSNumber=u.prototype.valueOf;for(var $=0;$<1e3;$++)a[$]=new u($),$>0&&(a[-$]=new u(-$));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=L,a.min=z,a.gcd=R,a.lcm=function(t,e){return t=Q(t).abs(),e=Q(e).abs(),t.divide(R(t,e)).multiply(e)},a.isInstance=function(t){return t instanceof l||t instanceof u},a.randBetween=function(t,n){var i=z(t=Q(t),n=Q(n)),r=L(t,n).subtract(i).add(1);if(r.isSmall)return i.add(Math.floor(Math.random()*r));for(var o=[],s=!0,a=r.value.length-1;a>=0;a--){var c=s?r.value[a]:e,d=g(Math.random()*c);o.unshift(d),d<c&&(s=!1)}return o=h(o),i.add("number"==typeof o?new u(o):new l(o,!1))},a.fromArray=function(t,e,n){return H(t.map(Q),Q(e||10),n)},a}();void 0!==t&&t.hasOwnProperty("exports")&&(t.exports=i),void 0===(n=function(){return i}.apply(e,[]))||(t.exports=n)}).call(this,n(377)(t))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Subscript=e.Superscript=void 0;var i=n(1),r=n(11),o=n(9),s=n(18);function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=e.Superscript=function(t){function e(t){a(this,e);var n=l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"superscript",51));return t&&i.Tree.append(n,t),n}return u(e,o.Group),e}();h(c,"^"),r.asOperator.call(c,"superscript",{vertical_notation:!0});var d=e.Subscript=function(t){function e(t){a(this,e);var n=l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"subscript",51));return t&&i.Tree.append(n,t),n}return u(e,o.Group),e}();function h(t,e){t.prototype.to_ascii=function(t){if(0===this.children.length)return"";var n=this.children[0].to_ascii(t);return e+(n.length>1?"{"+n+"}":""+n)},t.prototype.to_latex=function(t){if(0===this.children.length)return"";var n=this.children[0].to_latex(t);return n.length<2||this.children[0].is_group("brackets","abs-val")&&!s.Brackets.areHidden(this.children[0])?e+n:e+"{"+n+"}"},t.prototype.to_string=function(){return this.children[0]?this.children[0].to_string():""}}h(d,"_"),r.asOperator.call(d,"subscript",{vertical_notation:!0})},function(t,e,n){"use strict";function i(t){return function(t){for(var e=0,n=t.stringify(),i=0;3!==(i=n.indexOf("div[/,0]",i)+4);)e++;return e}(t)+function(t){return t.matchInner("0^-\\NUM").length}(t)+function(t){return t.matchInner("0^0").length}(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.checkUndefinedTransformation=function(t,e){var n=i(t);return i(e)<n},n(5)},function(t,e,n){var i={version:"1.3.5"};e.Tree=i,i.parse=function(t){var e,n=new i.Node,r=n.append(new i.Node);for(r.value="",e=0;e<t.length;e++){var o=t[e];if("["==o)(r=r.append(new i.Node)).value="";else if("]"==o){if((r=r.parent)===n)throw"parse error"}else","==o?(r=r.parent.append(new i.Node)).value="":r.value+=o}for(e=0;e<n.children.length;e++)n.children[e].parent=null;return 1===n.children.length?n.children[0]:n.children},i.stringify=function(t){var e=function(t){var n="";return"value"in t&&(n+=t.value),t.children&&t.children[0]&&(n+="["+t.children.map(e).join(",")+"]"),n};return Array.isArray(t)||(t=[t]),t.map(e).join(",")},function(){var t=4294967296,e=15,n=[],r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];i.uid=function(){var i=0,o=Math.random()*t;return n[i++]=r[o&e],n[i++]=r[o>>>4&e],n[i++]=r[o>>>8&e],n[i++]=r[o>>>12&e],n[i++]=r[o>>>16&e],n[i++]=r[o>>>20&e],n[i++]=r[o>>>24&e],n[i++]=r[o>>>28&e],o=Math.random()*t,n[i++]=r[o&e],n[i++]=r[o>>>4&e],n[i++]=r[o>>>8&e],n[i++]=r[o>>>12&e],n[i++]=r[o>>>16&e],n[i++]=r[o>>>20&e],n[i++]=r[o>>>24&e],n[i++]=r[o>>>28&e],"_"+n.join("")}}(),i.clone=function(t,e,n){var r=function(t){var o,s=new t.constructor;if(n)for(o=0;o<n.length;o++)s[n[o]]=t[n[o]];else for(var a in t)"_"!==a[0]&&(s[a]=t[a]);if(delete s.ls,delete s.rs,delete s.parent,t.id&&!e&&(s.id=i.uid()),t.children){for(s.children=[],o=0;o<t.children.length;o++)s.children.push(r(t.children[o])),s.children[o].parent=s;for(o=0;o<t.children.length;o++)s.children[o].ls=s.children[o-1],s.children[o].rs=s.children[o+1]}return s};if(!Array.isArray(t))return r(t);var o=t.map(r);if(t.length>1)for(var s=0;s<t.length;s++)s>0&&t[s].ls===t[s-1]&&(o[s].ls=o[s-1]),s<t.length-1&&t[s].rs===t[s+1]&&(o[s].rs=o[s+1]);return o},i.get_mapping_between=function(t,e){var n={};function i(t,e){if(t.id in n)throw"duplicate id in source tree";if(n[t.id]=[e],t.children.length!==e.children.length)if(t.has_children()){if(e.has_children())throw"tree structures don't match";t.for_each(function(t){n[t.id]=[e]})}else n[t.id]=e.select_all();else for(var r=0;r<t.children.length;r++)i(t.children[r],e.children[r])}if(Array.isArray(t)){if(t.length!==e.length)throw"tree structures don't match";for(var r=0;r<t.length;r++)i(t[r],e[r])}else i(t,e);return n},i.get_1to1_mapping_between=function(t,e,n){var i={};function r(t,e){if(n&&t.id in i)throw"duplicate id in source tree";if(i[t.id]=[e],n&&t.children.length!==e.children.length)throw"tree structures don't match";for(var o=t.children.length,s=e.children.length,a=0;a<o;a++)a<s?r(t.children[a],e.children[a]):t.children[a].for_each(function(t){i[t.id]=[]})}if(arguments.length<3&&(n=!0),Array.isArray(t)){if(n&&t.length!==e.length)throw"tree structures don't match";for(var o=t.length,s=e.length,a=0;a<o;a++)a<s?r(t[a],e[a]):t[a].for_each(function(t){i[t.id]=[]})}else r(t,e);return i},i.nodes_to_range=function(t){var e=t.length;if(0===e)return[];if(1===e)return[t[0]];for(var n=t[0];n.parent;)n=n.parent;for(var r=t.map(function(t){return i.get_path(t)}),o=function(t){for(var e=r[0][t],n=0;n<r.length;n++){if(r[n].length<=t+1)return!1;if(r[n][t]!==e)return!1}return!0},s=0;o(s);)s++;var a,l=i.get_child(r[0].slice(0,s),n),u=-1,c=l.children.length;for(a=0;a<e;a++){var d=i.get_child(r[a].slice(0,s+1),n),h=l.children.indexOf(d);h>u&&(u=h),h<c&&(c=h)}var p=[];for(a=c;a<=u;a++)p.push(l.children[a]);return p},i.insert=function(t,e,n){return n.ls=t.children[e-1],t.children[e-1]&&(t.children[e-1].rs=n),n.rs=t.children[e],t.children[e]&&(t.children[e].ls=n),n.parent=t,t.children.splice(e,0,n),n},i.insert_range=function(t,e,n){var i=n.length;if(0!==i){n[0].ls=t.children[e-1],t.children[e-1]&&(t.children[e-1].rs=n[0]),n[i-1].rs=t.children[e],t.children[e]&&(t.children[e].ls=n[i-1]);for(var r=0;r<i;r++)n[r].parent=t;return t.children=t.children.slice(0,e).concat(n,t.children.slice(e)),n}},i.append_range=function(t,e){var n=e.length;if(0!==n){var i=t.children[t.children.length-1];i&&(i.rs=e[0]),e[0].ls=i,e[n-1].rs=null;for(var r=0;r<n;r++)e[r].parent=t;return t.children=t.children.concat(e),e}},i.filterRange=function(t,e,n){for(var i=[],r=Array.isArray(e)?e:[e],o=function(e,r){for(var s=[],a=e[r],l=r;l<e.length;l++)if(s.push(e[l]),t(s)&&(i.push(s.slice()),n))return l-r;if(a.children)for(l=0;l<a.children.length;l++)l+=o(a.children,l);return 0},s=0;s<r.length;s++)s+=o(r,s);return i},i.append=function(t,e){var n=t.children[t.children.length-1];return n&&(n.rs=e),e.ls=n,e.rs=null,e.parent=t,t.children.push(e),e},i.remove=function(t){var e,n=t.parent.children;return n[(e=n.indexOf(t))-1]&&(n[e-1].rs=t.rs),n[e+1]&&(n[e+1].ls=t.ls),n.splice(e,1),t.parent=null,e},i.remove_range=function(t){var e=t.length;if(0!==e){var n=t[0].parent.children,i=n.indexOf(t[0]);n[i-1]&&(n[i-1].rs=t[e-1].rs),n[i+e]&&(n[i+e].ls=t[0].ls),n.splice(i,e);for(var r=0;r<t.length;r++)t[r].parent=null;return i}},i.replace=function(t,e){e.parent&&i.remove(e);var n=t.parent,r=i.remove(t);return i.insert(n,r,e)},i.switch_siblings=function(t,e){if(t.parent!=e.parent)throw"Called switch_siblings on nodes that are no siblings!";var n,i=t.parent,r=i.children.indexOf(t),o=i.children.indexOf(e);i.children[r]=e,i.children[o]=t,t.rs==e?(t.ls&&(t.ls.rs=e),e.rs&&(e.rs.ls=t),t.rs=e.rs,e.ls=t.ls,t.ls=e,e.rs=t):t.ls==e?(t.rs&&(t.rs.ls=e),e.ls&&(e.ls.rs=t),t.ls=e.ls,e.rs=t.rs,t.rs=e,e.ls=t):(t.ls&&(t.ls.rs=e),t.rs&&(t.rs.ls=e),e.ls&&(e.ls.rs=t),e.rs&&(e.rs.ls=t),n=t.ls,t.ls=e.ls,e.ls=n,n=t.rs,t.rs=e.rs,e.rs=n)},i.validate=function(t){var e=function(t,n){if(t.parent!=n)throw"wrong parent information";if(t.children)for(var i=0;i<t.children.length;i++){var r=t.children[i];if(r.ls!=t.children[i-1])throw"wrong ls information";if(r.rs!=t.children[i+1])throw"wrong rs information";e(r,t)}};Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++)e(t[n],null)},i.get_idx=function(t){return t.parent?t.parent.children.indexOf(t):-1},i.get_child=function(t,e){for(var n=0;n<t.length;n++){if(!e.children||e.children.length<=t[n])return null;e=e.children[t[n]]}return e},i.get_parent=function(t,e){for(var n=0;n<t;n++){if(!e.parent)return null;e=e.parent}return e},i.get_path=function(t){for(var e=[];t.parent;)e.unshift(t.parent.children.indexOf(t)),t=t.parent;return e},i.for_each=function(t,e){for(var n=Array.isArray(e)?e:[e],i=function(e){if(t(e),e.children)for(var n=0;n<e.children.length;n++)i(e.children[n])},r=0;r<n.length;r++)i(n[r])},i.map=function(t,e){for(var n=Array.isArray(e)?e:[e],i=[],r=function(e){if(i.push(t(e)),e.children)for(var n=0;n<e.children.length;n++)r(e.children[n])},o=0;o<n.length;o++)r(n[o]);return i},i.filter=function(t,e){for(var n=[],i=Array.isArray(e)?e:[e],r=function(e){if(t(e)&&n.push(e),e.children)for(var i=0;i<e.children.length;i++)r(e.children[i])},o=0;o<i.length;o++)r(i[o]);return n},i.select_all=function(t){return i.filter(function(){return!0},t)},i.select_first=function(t,e){for(var n=function(e){for(var n=e;;){if(t(n))return n;if(n.children&&n.children[0])n=n.children[0];else{if(n===e)return null;for(;!n.rs;)if((n=n.parent)===e)return null;n=n.rs}}},i=Array.isArray(e)?e:[e],r=0;r<i.length;r++){var o=n(i[r]);if(o)return o}return null},i.get_cca=function(t){for(var e=t.map(function(t){return i.get_path(t)}),n=function(t){for(var n=e[0][t],i=0;i<e.length;i++){if(e[i].length<=t+1)return!1;if(e[i][t]!==n)return!1}return!0},r=0;n(r);)r++;for(var o=e[0].length-r,s=t[0],a=0;a<o;a++)s=s.parent;return s},i.get_leaf_nodes=function(t){return i.filter(function(t){return!(t.children&&t.children.length)},t)},i.is_root=function(t){return!t.parent},i.is_range=function(t){for(var e=1;e<t.length;e++)if(t[e-1].rs!==t[e])return!1;return!0},i.get_root=function(t){for(;t.parent;)t=t.parent;return t},i.get_by_value=function(t,e){return i.filter(function(e){return e.value===t},e)},i.get_by_id=function(t,e){return i.select_first(function(e){return e.id===t},e)},i.Node=function(){this.children=[],this.parent=null,this.ls=null,this.rs=null,this.id=i.uid()},i.Node.prototype.stringify=function(){return i.stringify(this)},i.Node.prototype.clone=function(t,e){return i.clone(this,t,e)},i.Node.prototype.get_mapping_to=function(t){return i.get_mapping_between(this,t)},i.Node.prototype.get_1to1_mapping_to=function(t,e){return i.get_1to1_mapping_between(this,t,e)},i.Node.prototype.insert=function(t,e){return i.insert(this,t,e)},i.Node.prototype.insert_range=function(t,e){return i.insert_range(this,t,e)},i.Node.prototype.append_range=function(t){return i.append_range(this,t)},i.Node.prototype.append=function(t){return i.append(this,t)},i.Node.prototype.remove=function(){return i.remove(this)},i.Node.prototype.remove_range=function(t){return i.remove_range(t)},i.Node.prototype.replace_with=function(t){return i.replace(this,t)},i.Node.prototype.switch_with_sibling=function(t){return i.switch_siblings(this,t)},i.Node.prototype.validate=function(){return i.validate(this)},i.Node.prototype.get_child=function(t){return i.get_child(t,this)},i.Node.prototype.get_parent=function(t){return i.get_parent(t,this)},i.Node.prototype.get_path=function(){return i.get_path(this)},i.Node.prototype.for_each=function(t){return i.for_each(t,this)},i.Node.prototype.map=function(t){return i.map(t,this)},i.Node.prototype.filter=function(t){return i.filter(t,this)},i.Node.prototype.filterRange=function(t,e){return i.filterRange(t,this,e)},i.Node.prototype.select_all=function(){return i.select_all(this)},i.Node.prototype.select_first=function(t){return i.select_first(t,this)},i.Node.prototype.get_leaf_nodes=function(){return i.get_leaf_nodes(this)},i.Node.prototype.is_root=function(){return i.is_root(this)},i.Node.prototype.get_root=function(){return i.get_root(this)},i.Node.prototype.get_by_value=function(t){return i.get_by_value(t,this)},i.Node.prototype.get_by_id=function(t){return i.get_by_id(t,this)},i.Node.prototype.has_children=function(){return this.children&&this.children.length>0},i.Node.prototype.get_idx=function(){return i.get_idx(this)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.session_id=e.Tree=e.gmifyPage=e.IdentificationModal=e.TrialLogger=e.svg_play_button=e.setupLogging=e.ServerComm=e.EventRecorder=e.GMEventRecorder=e.DataLogger=e.CanvasLogger=e.DLLogger=e.CanvasEventRecorder=e.Derivation=e.DerivationRow=e.rules=e.canceling=e.factoring=e.AlgebraModelLink=e.KeypadSelections=e.DragHandler=e.Reselector=e.HitTester=e.ChangeNumberHandler=e.FontLoader=e.AlgebraRegExp=e.AlgebraParser=e.tokenize=e.CanvasElementClass=e.Timeline=e.transform_behavior=e.d3_eventDispatch=e.mtouch_events=e.mtouch_defaults=e.options=e.ui=e.getImplicitFactorGroup=e.applyCoefficient=e.AlgebraModel=e.linkCoordinator=e.evalExpression=e.gcAuth=e.googleAuth=e.showUserSettingsModal=e.AppSetting=e.GgbTools=e.getHelpEntries=e.insertCanvas=e.CanvasImage=e.TextBox=e.CanvasController=e.CanvasModelView=e.Canvas=e.reduceProduct=e.Algebrite=e.MathSettings=e.dont_catch_exceptions=e.SettingsType=e.loadFromJSON=e.user=e.expressions=e.Action=e.actions=e.version=e.preloadFonts=e.AlgebraView=void 0;var i=n(117);Object.defineProperty(e,"AlgebraView",{enumerable:!0,get:function(){return i.AlgebraView}}),Object.defineProperty(e,"preloadFonts",{enumerable:!0,get:function(){return i.preloadFonts}});var r=n(30);Object.defineProperty(e,"actions",{enumerable:!0,get:function(){return r.actions}});var o=n(2);Object.defineProperty(e,"Action",{enumerable:!0,get:function(){return o.Action}}),Object.defineProperty(e,"expressions",{enumerable:!0,get:function(){return r.expressions}});var s=n(17);Object.defineProperty(e,"user",{enumerable:!0,get:function(){return s.user}});var a=n(55);Object.defineProperty(e,"loadFromJSON",{enumerable:!0,get:function(){return a.loadFromJSON}});var l=n(10);Object.defineProperty(e,"SettingsType",{enumerable:!0,get:function(){return l.SettingsType}}),Object.defineProperty(e,"dont_catch_exceptions",{enumerable:!0,get:function(){return l.dont_catch_exceptions}});var u=n(12);Object.defineProperty(e,"MathSettings",{enumerable:!0,get:function(){return u.MathSettings}});var c=n(101);Object.defineProperty(e,"reduceProduct",{enumerable:!0,get:function(){return c.reduceProduct}});var d=n(54);Object.defineProperty(e,"Canvas",{enumerable:!0,get:function(){return d.Canvas}}),Object.defineProperty(e,"CanvasModelView",{enumerable:!0,get:function(){return d.CanvasModelView}}),Object.defineProperty(e,"CanvasController",{enumerable:!0,get:function(){return d.CanvasController}}),Object.defineProperty(e,"TextBox",{enumerable:!0,get:function(){return d.TextBox}}),Object.defineProperty(e,"CanvasImage",{enumerable:!0,get:function(){return d.CanvasImage}}),Object.defineProperty(e,"insertCanvas",{enumerable:!0,get:function(){return d.insertCanvas}}),Object.defineProperty(e,"getHelpEntries",{enumerable:!0,get:function(){return d.getHelpEntries}}),Object.defineProperty(e,"GgbTools",{enumerable:!0,get:function(){return d.GgbTools}});var h=n(163);Object.defineProperty(e,"AppSetting",{enumerable:!0,get:function(){return h.AppSetting}}),Object.defineProperty(e,"showUserSettingsModal",{enumerable:!0,get:function(){return h.showUserSettingsModal}});var p=n(40);Object.defineProperty(e,"googleAuth",{enumerable:!0,get:function(){return p.googleAuth}}),Object.defineProperty(e,"gcAuth",{enumerable:!0,get:function(){return p.gcAuth}});var f=n(57);Object.defineProperty(e,"evalExpression",{enumerable:!0,get:function(){return f.evalExpression}}),Object.defineProperty(e,"linkCoordinator",{enumerable:!0,get:function(){return r.linkCoordinator}}),Object.defineProperty(e,"AlgebraModel",{enumerable:!0,get:function(){return r.AlgebraModel}});var g=n(58);Object.defineProperty(e,"applyCoefficient",{enumerable:!0,get:function(){return g.applyCoefficient}});var m=n(96);Object.defineProperty(e,"getImplicitFactorGroup",{enumerable:!0,get:function(){return k(m).default}});var v=n(7);Object.keys(v).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return v[t]}})});var y=n(73);Object.keys(y).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return y[t]}})});var b=n(97);Object.defineProperty(e,"KeypadSelections",{enumerable:!0,get:function(){return k(b).default}}),n(162),n(156),n(151),n(149),n(147),n(146),n(125),n(123);var _=k(n(25)),x=n(1),w=n(0);n(7),n(73),n(30);var A=n(120);function k(t){return t&&t.__esModule?t:{default:t}}n(119),w.gmath.Tree=x.Tree,w.gmath.session_id=w.gmath.uid(),w.gmath.version=A.gmVersion,e.version=A.gmVersion,e.Algebrite=_.default,e.ui=w.gmath.ui,e.options=w.gmath.options,e.mtouch_defaults=w.gmath.mtouch_defaults,e.mtouch_events=w.gmath.mtouch_events,e.d3_eventDispatch=w.gmath.d3_eventDispatch,e.transform_behavior=w.gmath.transform_behavior,e.Timeline=w.gmath.Timeline,e.CanvasElementClass=w.gmath.CanvasElementClass,e.tokenize=w.gmath.tokenize,e.AlgebraParser=w.gmath.AlgebraParser,e.AlgebraRegExp=w.gmath.AlgebraRegExp,e.FontLoader=w.gmath.FontLoader,e.ChangeNumberHandler=w.gmath.ChangeNumberHandler,e.HitTester=w.gmath.HitTester,e.Reselector=w.gmath.Reselector,e.DragHandler=w.gmath.DragHandler,e.AlgebraModelLink=w.gmath.AlgebraModelLink,e.factoring=w.gmath.factoring,e.canceling=w.gmath.canceling,e.rules=w.gmath.rules,e.DerivationRow=w.gmath.DerivationRow,e.Derivation=w.gmath.Derivation,e.CanvasEventRecorder=w.gmath.CanvasEventRecorder,e.DLLogger=w.gmath.DLLogger,e.CanvasLogger=w.gmath.CanvasLogger,e.DataLogger=w.gmath.DataLogger,e.GMEventRecorder=w.gmath.GMEventRecorder,e.EventRecorder=w.gmath.EventRecorder,e.ServerComm=w.gmath.ServerComm,e.setupLogging=w.gmath.setupLogging,e.svg_play_button=w.gmath.svg_play_button,e.TrialLogger=w.gmath.TrialLogger,e.IdentificationModal=w.gmath.IdentificationModal,e.gmifyPage=w.gmath.gmifyPage,e.Tree=x.Tree,e.session_id=w.gmath.session_id}])});